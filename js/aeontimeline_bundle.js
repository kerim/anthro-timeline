(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function BuildApp(e){var i=new ATTimeline,n=new ATInspectorModel({timeline:i}),l={timeline:i,inspectorModel:n,timelineViewModel:new ATTimelineViewModel({timeline:i,inspectorModel:n})},r=new ATCanvasManager(l,e);return new ATMainTimelineApp("mac",l,r)}var ATMainTimelineApp=require("./timeline/controller/ATMainTimelineApp"),ATTimeline=require("./timeline/model/ATTimeline"),ATTimelineViewModel=require("./timeline/model/ATTimelineViewModel"),ATInspectorModel=require("./timeline/model/ATInspectorModel"),ATCanvasManager=require("./timeline/view/desktop/ATCanvasManager_Mac");module.exports=BuildApp;

},{"./timeline/controller/ATMainTimelineApp":17,"./timeline/model/ATInspectorModel":37,"./timeline/model/ATTimeline":41,"./timeline/model/ATTimelineViewModel":42,"./timeline/view/desktop/ATCanvasManager_Mac":58}],2:[function(require,module,exports){
(function (global){
window.performance=window.performance||{},window.performance.now=window.performance.now||window.performance.mozNow||window.performance.msNow||window.performance.oNow||window.performance.webkitNow||Date.now;var shim=require("browserify-shim");global.$=global.jQuery=require("jquery"),require("bselect");var _=require("lodash"),Backbone=require("backbone");Backbone.$=$,Backbone._=_;var bootstrap=require("bootstrap");require("./lib/popover-extra-placements"),require("./lib/jquery.ui.pos");var d3=require("d3"),Opentip=require("./lib/opentip"),mobiscroll=require("./lib/mobiscroll.custom-3.2.6.min.js"),slipjs=require("./lib/slip.js"),ignoreCrap=require("./lib/spectrum"),dhtmlxslider=require("./lib/dhtmlxslider"),dhtmlxmenu=require("./lib/dhtmlxmenu"),winToolbar=require("./winToolbar.js"),webToolbar=require("./webToolbar.js"),winMenu=require("./winMenu.js"),jstree=require("jstree"),BuildAppFunction=require("./ATBuildApp_Mac");ATWelcomeScreen=require("./welcome/ATWelcomeScreen"),window.isAeonWebExport=!1,function(e,n){"use strict";var i=document.createElement("i");i.className="syncBinder-item-status",e.jstree.defaults.questionmark=e.noop,e.jstree.plugins.questionmark=function(e,n){this.bind=function(){n.bind.call(this)},this.teardown=function(){this.settings.questionmark&&this.element.find(".syncBinder-item-status").remove(),n.teardown.call(this)},this.redraw_node=function(e,o,r,t){this.get_node(e);if(e=n.redraw_node.call(this,e,o,r,t)){var w=i.cloneNode(!0);e.insertBefore(w,e.childNodes[2])}return e}}}(jQuery),jQuery.fn.blurOnEnter=function(){return this.bind("keypress",function(e){13==e.keyCode&&this.blur()}),this},window.checkApplicationReady=function(){window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.ApplicationInterface&&window.installIOSInterface(),window.ApplicationInterface&&window.ApplicationInterface.readyForData(window.timelineDocumentId)},window.createToolbar=function(){window.welcomeScreen?window.welcomeScreen.createToolbar():window.mainApp&&window.mainApp.createToolbar()},window.configureWebExport=function(){window.isAeonWebExport=!0,window.mainApp.createWebToolbar(),window.mainApp.disableNonWebElements(),window.mainApp.timelineView.resizeWindow()},window.setTimelineDocumentId=function(e){window.timelineDocumentId=e},window.ATConsoleLog=function(e){console.log(e),window.ApplicationInterface&&window.ApplicationInterface.consoleLog&&window.ApplicationInterface.consoleLog(window.timelineDocumentId,e)},window.ATConsoleDir=function(e){console.dir(e),window.ApplicationInterface&&window.ApplicationInterface.consoleLog&&window.ApplicationInterface.consoleLog(window.timelineDocumentId,JSON.stringify(e))},window.onerror=function(e,n,i,o,r){var t="Error: "+e+"\nScript: "+n+" Line: "+i+" Column: "+o+"\nStackTrace: "+r;window.ApplicationInterface&&window.ApplicationInterface.javaScriptErrorOccurred&&window.ApplicationInterface.javaScriptErrorOccurred(t)},window.buildWelcome=function(){window.mainApp&&(window.mainApp=null),window.welcomeScreen=new ATWelcomeScreen},window.buildApp=function(e){window.welcomeScreen=null,window.mainApp=BuildAppFunction(e)},window.currentMobiscrollTheme=function(e){var n="ios_blue";return window.mainApp&&window.mainApp.displaySettings&&window.mainApp.displaySettings.skin&&(n=window.mainApp.displaySettings.skin),"ios_blue"===n?e?"aeon-ios-modal-blue":"aeon-ios-blue":"ios_dark"===n?"aeon-ios-dark":"ios_green"===n?"aeon-ios-green":"ios_red"===n?e?"aeon-ios-modal-red":"aeon-ios-red":"ios_light"===n?e?"aeon-ios-modal-light":"aeon-ios-light":"ios"},Opentip.styles.eventDragTooltipStyle={extends:"dark",delay:0,removeElementsOnHide:!0,stem:!1,offset:[0,0],tipJoint:"left"},Opentip.styles.welcomeTooltipStyle={extends:"glass",background:"#fff",borderColor:"#038ED9",delay:0,target:!0,removeElementsOnHide:!0},Opentip.styles.laneNodeTooltipStyle={extends:"dark",delay:0,removeElementsOnHide:!0,target:!0,tipJoint:"right",targetJoint:"left middle"},window.timelineDocumentId=0,window.toolbarCommands=winToolbar,window.menuCommands=winMenu,window.webToolbarCommands=webToolbar,checkApplicationReady();

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./ATBuildApp_Mac":1,"./lib/dhtmlxmenu":5,"./lib/dhtmlxslider":6,"./lib/jquery.ui.pos":8,"./lib/mobiscroll.custom-3.2.6.min.js":9,"./lib/opentip":11,"./lib/popover-extra-placements":12,"./lib/slip.js":13,"./lib/spectrum":14,"./webToolbar.js":215,"./welcome/ATWelcomeScreen":216,"./winMenu.js":218,"./winToolbar.js":219,"backbone":220,"bootstrap":222,"browserify-shim":235,"bselect":317,"d3":320,"jquery":331,"jstree":332,"lodash":333}],3:[function(require,module,exports){
(function (global){
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=global.window&&global.window.$?t(global.window.$):function(e){if(!e.$&&!e.fn)throw new Error("Tokenfield requires a window object with jQuery or a jQuery instance");return t(e.$||e)}:t(jQuery,window)}(function(t,e){"use strict";var i=function(i,n){var s=this;this.$element=t(i),this.textDirection=this.$element.css("direction"),this.options=t.extend(!0,{},t.fn.tokenfield.defaults,{tokens:this.$element.val()},this.$element.data(),n),this._delimiters="string"==typeof this.options.delimiter?[this.options.delimiter]:this.options.delimiter,this._triggerKeys=t.map(this._delimiters,function(t){return t.charCodeAt(0)}),this._firstDelimiter=this._delimiters[0];var r=t.inArray(" ",this._delimiters),a=t.inArray("-",this._delimiters);r>=0&&(this._delimiters[r]="\\s"),a>=0&&(delete this._delimiters[a],this._delimiters.unshift("-"));var o=["\\","$","[","{","^",".","|","?","*","+","(",")"];t.each(this._delimiters,function(e,i){t.inArray(i,o)>=0&&(s._delimiters[e]="\\"+i)});var h,p=e&&"function"==typeof e.getMatchedCSSRules?e.getMatchedCSSRules(i):null,l=i.style.width,u=this.$element.width();p&&t.each(p,function(t,e){e.style.width&&(h=e.style.width)});var d="rtl"===t("body").css("direction")?"right":"left",c={position:this.$element.css("position")};c[d]=this.$element.css(d),this.$element.data("original-styles",c).data("original-tabindex",this.$element.prop("tabindex")).css("position","absolute").css(d,"-10000px").prop("tabindex",-1),this.$wrapper=t('<div class="tokenfield form-control" />'),this.$element.hasClass("input-lg")&&this.$wrapper.addClass("input-lg"),this.$element.hasClass("input-sm")&&this.$wrapper.addClass("input-sm"),"rtl"===this.textDirection&&this.$wrapper.addClass("rtl");var f=this.$element.prop("id")||(new Date).getTime()+""+Math.floor(100*(1+Math.random()));this.$input=t('<input type="'+this.options.inputType+'" class="token-input" autocomplete="off" />').appendTo(this.$wrapper).prop("placeholder",this.$element.prop("placeholder")).prop("id",f+"-tokenfield").prop("tabindex",this.$element.data("original-tabindex"));var $=t('label[for="'+this.$element.prop("id")+'"]');if($.length&&$.prop("for",this.$input.prop("id")),this.$copyHelper=t('<input type="text" />').css("position","absolute").css(d,"-10000px").prop("tabindex",-1).prependTo(this.$wrapper),l?this.$wrapper.css("width",l):h?this.$wrapper.css("width",h):this.$element.parents(".form-inline").length&&this.$wrapper.width(u),(this.$element.prop("disabled")||this.$element.parents("fieldset[disabled]").length)&&this.disable(),this.$element.prop("readonly")&&this.readonly(),this.$mirror=t('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>'),this.$input.css("min-width",this.options.minWidth+"px"),t.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(t,e){s.$mirror[0].style[e]=s.$input.css(e)}),this.$mirror.appendTo("body"),this.$wrapper.insertBefore(this.$element),this.$element.prependTo(this.$wrapper),this.update(),this.setTokens(this.options.tokens,!1,!this.$element.val()&&this.options.tokens),this.listen(),!t.isEmptyObject(this.options.autocomplete)){var v="rtl"===this.textDirection?"right":"left",m=t.extend({minLength:this.options.showAutocompleteOnFocus?0:null,position:{my:v+" top",at:v+" bottom",of:this.$wrapper}},this.options.autocomplete);this.$input.autocomplete(m)}if(!t.isEmptyObject(this.options.typeahead)){var g=this.options.typeahead,k={minLength:this.options.showAutocompleteOnFocus?0:null},y=t.isArray(g)?g:[g,g];y[0]=t.extend({},k,y[0]),this.$input.typeahead.apply(this.$input,y),this.$hint=this.$input.prev(".tt-hint"),this.typeahead=!0}};i.prototype={constructor:i,createToken:function(e,i){var n=this;if(e="string"==typeof e?{value:e,label:e}:t.extend({},e),void 0===i&&(i=!0),e.value=t.trim(e.value.toString()),e.label=e.label&&e.label.length?t.trim(e.label):e.value,e.value.length&&e.label.length&&!(e.label.length<=this.options.minLength)&&!(this.options.limit&&this.getTokens().length>=this.options.limit)){var s=t.Event("tokenfield:createtoken",{attrs:e});if(this.$element.trigger(s),s.attrs&&!s.isDefaultPrevented()){var r=t('<div class="token" />').append('<span class="token-label" />').append('<a href="#" class="close" tabindex="-1">&times;</a>').data("attrs",e);this.$input.hasClass("tt-input")?this.$input.parent().before(r):this.$input.before(r),this.$input.css("width",this.options.minWidth+"px");var a=r.find(".token-label"),o=r.find(".close");return this.maxTokenWidth||(this.maxTokenWidth=this.$wrapper.width()-o.outerWidth()-parseInt(o.css("margin-left"),10)-parseInt(o.css("margin-right"),10)-parseInt(r.css("border-left-width"),10)-parseInt(r.css("border-right-width"),10)-parseInt(r.css("padding-left"),10)-parseInt(r.css("padding-right"),10),parseInt(a.css("border-left-width"),10),parseInt(a.css("border-right-width"),10),parseInt(a.css("padding-left"),10),parseInt(a.css("padding-right"),10),parseInt(a.css("margin-left"),10),parseInt(a.css("margin-right"),10)),a.text(e.label).css("max-width",this.maxTokenWidth),r.on("mousedown",function(t){if(n._disabled||n._readonly)return!1;n.preventDeactivation=!0}).on("click",function(t){return!n._disabled&&!n._readonly&&(n.preventDeactivation=!1,t.ctrlKey||t.metaKey?(t.preventDefault(),n.toggle(r)):void n.activate(r,t.shiftKey,t.shiftKey))}).on("dblclick",function(t){if(n._disabled||n._readonly||!n.options.allowEditing)return!1;n.edit(r)}),o.on("click",t.proxy(this.remove,this)),this.$element.trigger(t.Event("tokenfield:createdtoken",{attrs:e,relatedTarget:r.get(0)})),i&&this.$element.val(this.getTokensList()).trigger(t.Event("change",{initiator:"tokenfield"})),this.update(),this.$element.get(0)}}},setTokens:function(e,i,n){if(e){i||this.$wrapper.find(".token").remove(),void 0===n&&(n=!0),"string"==typeof e&&(e=this._delimiters.length?e.split(new RegExp("["+this._delimiters.join("")+"]")):[e]);var s=this;return t.each(e,function(t,e){s.createToken(e,n)}),this.$element.get(0)}},getTokenData:function(e){var i=e.map(function(){return t(this).data("attrs")}).get();return 1==i.length&&(i=i[0]),i},getTokens:function(e){var i=this,n=[],s=e?".active":"";return this.$wrapper.find(".token"+s).each(function(){n.push(i.getTokenData(t(this)))}),n},getTokensList:function(e,i,n){var s=(e=e||this._firstDelimiter)+((i=void 0!==i&&null!==i?i:this.options.beautify)&&" "!==e?" ":"");return t.map(this.getTokens(n),function(t){return t.value}).join(s)},getInput:function(){return this.$input.val()},listen:function(){var i=this;this.$element.on("change",t.proxy(this.change,this)),this.$wrapper.on("mousedown",t.proxy(this.focusInput,this)),this.$input.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("paste",t.proxy(this.paste,this)).on("keydown",t.proxy(this.keydown,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.$copyHelper.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keydown",t.proxy(this.keydown,this)).on("keyup",t.proxy(this.keyup,this)),this.$input.on("keypress",t.proxy(this.update,this)).on("keyup",t.proxy(this.update,this)),this.$input.on("autocompletecreate",function(){var e=t(this).data("ui-autocomplete").menu.element,n=i.$wrapper.outerWidth()-parseInt(e.css("border-left-width"),10)-parseInt(e.css("border-right-width"),10);e.css("min-width",n+"px")}).on("autocompleteselect",function(t,e){return i.createToken(e.item)&&(i.$input.val(""),i.$input.data("edit")&&i.unedit(!0)),!1}).on("typeahead:selected typeahead:autocompleted",function(t,e,n){i.createToken(e)&&(i.$input.typeahead("val",""),i.$input.data("edit")&&i.unedit(!0))}),t(e).on("resize",t.proxy(this.update,this))},keydown:function(e){function i(t){if(s.$input.is(document.activeElement)){if(s.$input.val().length>0)return;t+="All";var i=s.$input.hasClass("tt-input")?s.$input.parent()[t](".token:first"):s.$input[t](".token:first");if(!i.length)return;s.preventInputFocus=!0,s.preventDeactivation=!0,s.activate(i),e.preventDefault()}else s[t](e.shiftKey),e.preventDefault()}function n(i){if(e.shiftKey){if(s.$input.is(document.activeElement)){if(s.$input.val().length>0)return;var n=s.$input.hasClass("tt-input")?s.$input.parent()[i+"All"](".token:first"):s.$input[i+"All"](".token:first");if(!n.length)return;s.activate(n)}var r="prev"===i?"next":"prev",a="prev"===i?"first":"last";s.$firstActiveToken[r+"All"](".token").each(function(){s.deactivate(t(this))}),s.activate(s.$wrapper.find(".token:"+a),!0,!0),e.preventDefault()}}if(this.focused){var s=this;switch(e.keyCode){case 8:if(!this.$input.is(document.activeElement))break;this.lastInputValue=this.$input.val();break;case 37:i("rtl"===this.textDirection?"next":"prev");break;case 38:n("prev");break;case 39:i("rtl"===this.textDirection?"prev":"next");break;case 40:n("next");break;case 65:if(this.$input.val().length>0||!e.ctrlKey&&!e.metaKey)break;this.activateAll(),e.preventDefault();break;case 9:case 13:if(this.$input.data("ui-autocomplete")&&this.$input.data("ui-autocomplete").menu.element.find("li:has(a.ui-state-focus), li.ui-state-focus").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-cursor").length)break;if(this.$input.hasClass("tt-input")&&this.$wrapper.find(".tt-hint").val()&&this.$wrapper.find(".tt-hint").val().length)break;if(this.$input.is(document.activeElement)&&this.$input.val().length||this.$input.data("edit"))return this.createTokensFromInput(e,this.$input.data("edit"));if(13===e.keyCode){if(!this.$copyHelper.is(document.activeElement)||1!==this.$wrapper.find(".token.active").length)break;if(!s.options.allowEditing)break;this.edit(this.$wrapper.find(".token.active"))}}this.lastKeyDown=e.keyCode}},keypress:function(e){if(-1!==t.inArray(e.which,this._triggerKeys)&&this.$input.is(document.activeElement))return this.$input.val()&&this.createTokensFromInput(e),!1},keyup:function(t){if(this.preventInputFocus=!1,this.focused){switch(t.keyCode){case 8:if(this.$input.is(document.activeElement)){if(this.$input.val().length||this.lastInputValue.length&&8===this.lastKeyDown)break;this.preventDeactivation=!0;var e=this.$input.hasClass("tt-input")?this.$input.parent().prevAll(".token:first"):this.$input.prevAll(".token:first");if(!e.length)break;this.activate(e)}else this.remove(t);break;case 46:this.remove(t,"next")}this.lastKeyUp=t.keyCode}},focus:function(t){this.focused=!0,this.$wrapper.addClass("focus"),this.$input.is(document.activeElement)&&(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null,this.options.showAutocompleteOnFocus&&this.search())},blur:function(t){this.focused=!1,this.$wrapper.removeClass("focus"),this.preventDeactivation||this.$element.is(document.activeElement)||(this.$wrapper.find(".active").removeClass("active"),this.$firstActiveToken=null),!this.preventCreateTokens&&(this.$input.data("edit")&&!this.$input.is(document.activeElement)||this.options.createTokensOnBlur)&&this.createTokensFromInput(t),this.preventDeactivation=!1,this.preventCreateTokens=!1},paste:function(t){var e=this;e.options.allowPasting&&setTimeout(function(){e.createTokensFromInput(t)},1)},change:function(t){"tokenfield"!==t.initiator&&this.setTokens(this.$element.val())},createTokensFromInput:function(t,e){if(!(this.$input.val().length<this.options.minLength)){var i=this.getTokensList();return this.setTokens(this.$input.val(),!0),i==this.getTokensList()&&this.$input.val().length?!1:(this.$input.hasClass("tt-input")?this.$input.typeahead("val",""):this.$input.val(""),this.$input.data("edit")&&this.unedit(e),!1)}},next:function(t){if(t){var e=this.$wrapper.find(".active:first");if(!(!e||!this.$firstActiveToken)&&e.index()<this.$firstActiveToken.index())return this.deactivate(e)}var i=this.$wrapper.find(".active:last").nextAll(".token:first");i.length?this.activate(i,t):this.$input.focus()},prev:function(t){if(t){var e=this.$wrapper.find(".active:last");if(!(!e||!this.$firstActiveToken)&&e.index()>this.$firstActiveToken.index())return this.deactivate(e)}var i=this.$wrapper.find(".active:first").prevAll(".token:first");i.length||(i=this.$wrapper.find(".token:first")),i.length||t?this.activate(i,t):this.$input.focus()},activate:function(e,i,n,s){if(e){if(void 0===s)s=!0;if(n)i=!0;if(this.$copyHelper.focus(),i||(this.$wrapper.find(".active").removeClass("active"),s?this.$firstActiveToken=e:delete this.$firstActiveToken),n&&this.$firstActiveToken){var r=this.$firstActiveToken.index()-2,a=e.index()-2,o=this;this.$wrapper.find(".token").slice(Math.min(r,a)+1,Math.max(r,a)).each(function(){o.activate(t(this),!0)})}e.addClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select()}},activateAll:function(){var e=this;this.$wrapper.find(".token").each(function(i){e.activate(t(this),0!==i,!1,!1)})},deactivate:function(t){t&&(t.removeClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},toggle:function(t){t&&(t.toggleClass("active"),this.$copyHelper.val(this.getTokensList(null,null,!0)).select())},edit:function(e){if(e){var i=e.data("attrs"),n={attrs:i,relatedTarget:e.get(0)},s=t.Event("tokenfield:edittoken",n);if(this.$element.trigger(s),!s.isDefaultPrevented()){e.find(".token-label").text(i.value);var r=e.outerWidth(),a=this.$input.hasClass("tt-input")?this.$input.parent():this.$input;e.replaceWith(a),this.preventCreateTokens=!0,this.$input.val(i.value).select().data("edit",!0).width(r),this.update(),this.$element.trigger(t.Event("tokenfield:editedtoken",n))}}},unedit:function(t){if((this.$input.hasClass("tt-input")?this.$input.parent():this.$input).appendTo(this.$wrapper),this.$input.data("edit",!1),this.$mirror.text(""),this.update(),t){var e=this;setTimeout(function(){e.$input.focus()},1)}},remove:function(e,i){if(!(this.$input.is(document.activeElement)||this._disabled||this._readonly)){var n="click"===e.type?t(e.target).closest(".token"):this.$wrapper.find(".token.active");if("click"!==e.type){if(!i)i="prev";if(this[i](),"prev"===i)var s=0===n.first().prevAll(".token:first").length}var r={attrs:this.getTokenData(n),relatedTarget:n.get(0)},a=t.Event("tokenfield:removetoken",r);if(this.$element.trigger(a),!a.isDefaultPrevented()){var o=t.Event("tokenfield:removedtoken",r),h=t.Event("change",{initiator:"tokenfield"});n.remove(),this.$element.val(this.getTokensList()).trigger(o).trigger(h),this.$wrapper.find(".token").length&&"click"!==e.type&&!s||this.$input.focus(),this.$input.css("width",this.options.minWidth+"px"),this.update(),e.preventDefault(),e.stopPropagation()}}},update:function(t){var e=this.$input.val(),i=parseInt(this.$input.css("padding-left"),10)+parseInt(this.$input.css("padding-right"),10);if(this.$input.data("edit")){if(e||(e=this.$input.prop("placeholder")),e===this.$mirror.text())return;this.$mirror.text(e);var n=this.$mirror.width()+10;if(n>this.$wrapper.width())return this.$input.width(this.$wrapper.width());this.$input.width(n),this.$hint&&this.$hint.width(n)}else{var s="rtl"===this.textDirection?this.$input.offset().left+this.$input.outerWidth()-this.$wrapper.offset().left-parseInt(this.$wrapper.css("padding-left"),10)-i-1:this.$wrapper.offset().left+this.$wrapper.width()+parseInt(this.$wrapper.css("padding-left"),10)-this.$input.offset().left-i;isNaN(s)?this.$input.width("100%"):this.$input.width(s),this.$hint&&(isNaN(s)?this.$hint.width("100%"):this.$hint.width(s))}},focusInput:function(e){if(!(t(e.target).closest(".token").length||t(e.target).closest(".token-input").length||t(e.target).closest(".tt-dropdown-menu").length)){var i=this;setTimeout(function(){i.$input.focus()},0)}},search:function(){this.$input.data("ui-autocomplete")&&this.$input.autocomplete("search")},disable:function(){this.setProperty("disabled",!0)},enable:function(){this.setProperty("disabled",!1)},readonly:function(){this.setProperty("readonly",!0)},writeable:function(){this.setProperty("readonly",!1)},setProperty:function(t,e){this["_"+t]=e,this.$input.prop(t,e),this.$element.prop(t,e),this.$wrapper[e?"addClass":"removeClass"](t)},destroy:function(){this.$element.val(this.getTokensList()),this.$element.css(this.$element.data("original-styles")),this.$element.prop("tabindex",this.$element.data("original-tabindex"));var e=t('label[for="'+this.$input.prop("id")+'"]');e.length&&e.prop("for",this.$element.prop("id")),this.$element.insertBefore(this.$wrapper),this.$element.removeData("original-styles").removeData("original-tabindex").removeData("bs.tokenfield"),this.$wrapper.remove(),this.$mirror.remove();return this.$element}};var n=t.fn.tokenfield;return t.fn.tokenfield=function(e,n){var s,r=[];Array.prototype.push.apply(r,arguments);var a=this.each(function(){var a=t(this),o=a.data("bs.tokenfield"),h="object"==typeof e&&e;"string"==typeof e&&o&&o[e]?(r.shift(),s=o[e].apply(o,r)):o||"string"==typeof e||n||(a.data("bs.tokenfield",o=new i(this,h)),a.trigger("tokenfield:initialize"))});return void 0!==s?s:a},t.fn.tokenfield.defaults={minWidth:60,minLength:0,allowEditing:!0,allowPasting:!0,limit:0,autocomplete:{},typeahead:{},showAutocompleteOnFocus:!1,createTokensOnBlur:!1,delimiter:",",beautify:!0,inputType:"text"},t.fn.tokenfield.Constructor=i,t.fn.tokenfield.noConflict=function(){return t.fn.tokenfield=n,this},i});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],4:[function(require,module,exports){
function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function dhtmlXToolbarObject(t,e){var n=this;for(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxtoolbar")||"dhx_skyblue",align:"left",align_autostart:"left",icons_path:"",iconSize:18,sel_ofs_x:0,sel_ofs_y:0,xml_autoload:null,items_autoload:null},"object"==typeof t&&null!=t&&void 0===t.tagName&&(null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.icons_size&&(this.conf.icons_size_autoload=t.icons_size),null!=t.json&&(this.conf.json_autoload=t.json),null!=t.xml&&(this.conf.xml_autoload=t.xml),null!=t.onload&&(this.conf.onload_autoload=t.onload),null==t.onclick&&null==t.onClick||(this.conf.auto_onclick=t.onclick||t.onClick),null!=t.items&&(this.conf.items_autoload=t.items),null!=t.skin&&(this.conf.skin=t.skin),null!=t.align&&(this.conf.align_autostart=t.align),t=t.parent),this.cont="object"!=typeof t?document.getElementById(t):t;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);return t=null,this.cont.dir="ltr",this.base=document.createElement("DIV"),this.base.className="dhxtoolbar_float_left",this.cont.appendChild(this.base),window.dhx4.isIPad&&(this.cont.ontouchstart=function(t){return t=t||event,"input"==String(t.target.tagName||"").toLowerCase()||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1)}),this.setSkin(this.conf.skin),this.objPull={},this.anyUsed="none",this._genStr=function(t){for(var e="",n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=0;i<t;i++)e+=n.charAt(Math.round(Math.random()*(n.length-1)));return e},this.rootTypes=new Array("button","buttonSelect","buttonTwoState","separator","label","slider","text","buttonInput"),this.idPrefix=this._genStr(12),window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson","toolbar",{struct:!0}),window.dhx4._eventable(this),this._getObj=function(t,e){for(var n=null,i=0;i<t.childNodes.length;i++)null!=t.childNodes[i].tagName&&String(t.childNodes[i].tagName).toLowerCase()==String(e).toLowerCase()&&(n=t.childNodes[i]);return n},this._addImgObj=function(t){var e=document.createElement("IMG");return t.childNodes.length>0?t.insertBefore(e,t.childNodes[0]):t.appendChild(e),e},this._setItemImage=function(t,e,n){if(1==n?t.imgEn=e:t.imgDis=e,!(!t.state&&1==n||t.state&&0==n)){var i=this._getObj(t.obj,"img");null==i&&(i=this._addImgObj(t.obj)),i.src=this.conf.icons_path+e}},this._clearItemImage=function(t,e){if(1==e?t.imgEn="":t.imgDis="",!(!t.state&&1==e||t.state&&0==e)){var n=this._getObj(t.obj,"img");null!=n&&n.parentNode.removeChild(n)}},this._setItemText=function(t,e){var n=this._getObj(t.obj,"div");null!=e&&0!=e.length?(null==n&&((n=document.createElement("DIV")).className="dhxtoolbar_text",t.obj.appendChild(n)),n.innerHTML=e):null!=n&&n.parentNode.removeChild(n)},this._getItemText=function(t){var e=this._getObj(t.obj,"div");return null!=e?e.innerHTML:""},this._enableItem=function(t){if(!t.state){t.state=!0,"buttonTwoState"==this.objPull[t.id].type&&1==this.objPull[t.id].obj.pressed?(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",t.obj.renderAs=t.obj.className),t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgEn?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgEn):null!=e&&e.parentNode.removeChild(e)}},this._disableItem=function(t){if(t.state){t.state=!1,t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+("buttonTwoState"==this.objPull[t.id].type&&t.obj.pressed?"pres_":"")+"dis",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgDis?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgDis):null!=e&&e.parentNode.removeChild(e),null!=t.polygon&&"none"!=t.polygon.style.display&&(window.dhx4.zim.clear(t.polygon._idd),t.polygon.style.display="none",t.polygon._ie6cover&&(t.polygon._ie6cover.style.display="none"),"dhx_terrace"==this.conf.skin&&this._improveTerraceButtonSelect(t.id,!0)),this.anyUsed="none"}},this.clearAll=function(){for(var t in this.objPull)this._removeItem(String(t).replace(this.idPrefix,""))},this._doOnClick=function(t){n&&n.forEachItem&&n.forEachItem(function(t){if("buttonSelect"==n.objPull[n.idPrefix+t].type){var e=n.objPull[n.idPrefix+t];!0===e.arw._skip?e.arw._skip=!1:"none"!=e.polygon.style.display&&(e.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",e.obj.className=e.obj.renderAs,e.arw.className=String(e.obj.renderAs).replace("btn","arw"),n.anyUsed="none",window.dhx4.zim.clear(e.polygon._idd),e.polygon.style.display="none",e.polygon._ie6cover&&(e.polygon._ie6cover.style.display="none"),"dhx_terrace"==n.conf.skin&&n._improveTerraceButtonSelect(e.id,!0))}})},window.dhx4.isIPad?document.addEventListener("touchstart",this._doOnClick,!1):void 0!==window.addEventListener?window.addEventListener("mousedown",this._doOnClick,!1):document.body.attachEvent("onmousedown",this._doOnClick),null!=this.conf.icons_size_autoload&&(this.setIconSize(this.conf.icons_size_autoload),this.conf.icons_size_autoload=null),null!=this.conf.items_autoload?(this.loadStruct(this.conf.items_autoload,this.conf.onload_autoload),this.conf.items_autoload=null):null!=this.conf.json_autoload?(this.loadStruct(this.conf.json_autoload,this.conf.onload_autoload),this.conf.json_autoload=null):null!=this.conf.xml_autoload&&(this.loadStruct(this.conf.xml_autoload,this.conf.onload_autoload),this.conf.xml_autoload=null),this.conf.align_autostart!=this.conf.align&&(this.setAlign(this.conf.align_autostart),this.conf.align_autostart=null),"function"==typeof this.conf.auto_onclick?this.attachEvent("onClick",this.conf.auto_onclick):"string"==typeof this.conf.auto_onclick&&"function"==typeof window[this.conf.auto_onclick]&&this.attachEvent("onClick",window[this.conf.auto_onclick]),this}if(void 0===window.dhx4&&(window.dhx4={version:"4.2",skin:null,skinDetect:function(t){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(t+"_skin_detect")]||null},readFromCss:function(t,e){var n=document.createElement("DIV");n.className=t,null!=document.body.firstChild?document.body.insertBefore(n,document.body.firstChild):document.body.appendChild(n);var i=n[e||"offsetWidth"];return n.parentNode.removeChild(n),n=null,i},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var t=this.first();for(var e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(t){return this.data[t]=this.last()+this.step,this.data[t]},clear:function(t){null!=this.data[t]&&(this.data[t]=null,delete this.data[t])}},s2b:function(t){return"string"==typeof t&&(t=t.toLowerCase()),1==t||1==t||"true"==t||"1"==t||"yes"==t||"y"==t},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(t){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).left},absTop:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).top},_aOfs:function(t){for(var e=0,n=0;t;)e+=parseInt(t.offsetTop),n+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:n}},_aOfsRect:function(t){var e=t.getBoundingClientRect(),n=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||n.scrollTop,l=window.pageXOffset||i.scrollLeft||n.scrollLeft,s=i.clientTop||n.clientTop||0,a=i.clientLeft||n.clientLeft||0,r=e.top+o-s,d=e.left+l-a;return{top:Math.round(r),left:Math.round(d)}},getOffset:function(t){return t.getBoundingClientRect?this._aOfsRect(t):this._aOfs(t)},_isObj:function(t){return null!=t&&"object"==typeof t&&void 0===t.length},_copyObj:function(t){if(this._isObj(t)){var e={};for(var n in t)"object"==typeof t[n]&&null!=t[n]?e[n]=this._copyObj(t[n]):e[n]=t[n]}else for(e=[],n=0;n<t.length;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=this._copyObj(t[n]):e[n]=t[n];return e},screenDim:function(){var t=navigator.userAgent.indexOf("MSIE")>=0,e={};return e.left=document.body.scrollLeft,e.right=e.left+(window.innerWidth||document.body.clientWidth),e.top=Math.max((t?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),e.bottom=e.top+(t?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),e},selectTextRange:function(t,e,n){var i=(t="string"==typeof t?document.getElementById(t):t).value.length;if(e=Math.max(Math.min(e,i),0),n=Math.min(n,i),t.setSelectionRange)try{t.setSelectionRange(e,n)}catch(t){}else if(t.createTextRange){var o=t.createTextRange();o.moveStart("character",e),o.moveEnd("character",n-i);try{o.select()}catch(t){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData},_xmlNodeValue:function(t){for(var e="",n=0;n<t.childNodes.length;n++)e+=null!=t.childNodes[n].nodeValue?t.childNodes[n].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return e}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0,window.dhx4.isKHTML=navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0),void 0===window.dhx4.template&&(window.dhx4.trim=function(t){return String(t).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(t,e,n){return t.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var t=arguments[1],i=window.dhx4.trim(arguments[3]),o=null,l=[e[t]];if(i.length>0){i=i.split(":");for(var s=[],a=0;a<i.length;a++)a>0&&null!=s[s.length-1].match(/\\$/)?s[s.length-1]=s[s.length-1].replace(/\\$/,"")+":"+i[a]:s.push(i[a]);o=s[0];for(a=1;a<s.length;a++)l.push(s[a])}return"string"==typeof o&&"function"==typeof window.dhx4.template[o]?window.dhx4.template[o].apply(window.dhx4.template,l):t.length>0&&void 0!==e[t]?1==n?window.dhx4.trim(e[t]):String(e[t]):""})},window.dhx4.template.date=function(t,e){return null!=t?t instanceof Date?window.dhx4.date2str(t,e):null!=(t=t.toString()).match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(t)),e):t:""},window.dhx4.template.maxlength=function(t,e){return String(t).substr(0,e)},window.dhx4.template.number_format=function(t,e,n,i){var o=window.dhx4.template._parseFmt(e,n,i);return 0==o?t:window.dhx4.template._getFmtValue(t,o)},window.dhx4.template.lowercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toLowerCase()},window.dhx4.template.uppercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toUpperCase()},window.dhx4.template._parseFmt=function(t,e,n){var i=t.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(null==i||4!=i.length)return!1;var o={i_len:!1,i_sep:"string"==typeof e?e:",",d_len:!1,d_sep:"string"==typeof n?n:".",s_bef:"string"==typeof i[1]?i[1]:"",s_aft:"string"==typeof i[3]?i[3]:""},l=i[2].split(".");null!=l[1]&&(o.d_len=l[1].length);var s=l[0].split(",");return s.length>1&&(o.i_len=s[s.length-1].length),o},window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){var v0="";if(null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,!1!==fmt.i_len){for(var i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(!1!==fmt.d_len){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=r[4].match(dhx4.temp);null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft}return value}),void 0===window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(t,e,n){if(null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=n&&"undefnied"!=typeof n||(n=window.dhx4.dateStrings[window.dhx4.dateLang]),t instanceof Date)var i=function(t){return 1==String(t).length?"0"+String(t):t},o=function(e){switch(e){case"%d":return i(t.getDate());case"%j":return t.getDate();case"%D":return n.dayShortName[t.getDay()];case"%l":return n.dayFullName[t.getDay()];case"%m":return i(t.getMonth()+1);case"%n":return t.getMonth()+1;case"%M":return n.monthShortName[t.getMonth()];case"%F":return n.monthFullName[t.getMonth()];case"%y":return i(t.getYear()%100);case"%Y":return t.getFullYear();case"%g":return(t.getHours()+11)%12+1;case"%h":return i((t.getHours()+11)%12+1);case"%G":return t.getHours();case"%H":return i(t.getHours());case"%i":return i(t.getMinutes());case"%s":return i(t.getSeconds());case"%a":return t.getHours()>11?"pm":"am";case"%A":return t.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return t.getMilliseconds();case"%P":if(null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz)return window.dhx4.temp_calendar.tz;var o=t.getTimezoneOffset(),l=Math.abs(Math.floor(o/60)),s=Math.abs(o)-60*l;return(o>0?"-":"+")+i(l)+":"+i(s);default:return e}},l=String(e||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,o);return l||String(t)},window.dhx4.str2date=function(t,e,n){null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=n&&"undefnied"!=typeof n||(n=window.dhx4.dateStrings[window.dhx4.dateLang]);var i=[],o=[];e=(e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&")).replace(/%[a-z]/gi,function(t){switch(t){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return o.push(t),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return o.push(t),"([a-zéûäа-яё]{1,})";case"%j":case"%n":case"%g":case"%G":return o.push(t),"(\\d{1,2})";case"%Y":return o.push(t),"(\\d{4})";case"%a":return o.push(t),"([am|pm])";case"%A":return o.push(t),"([AM|PM])";case"%u":return o.push(t),"(\\d{1,6})";case"%P":return o.push(t),"([+-]\\d{1,2}:\\d{1,2})"}return t});var l=new RegExp(e,"i"),s=t.match(l);if(null==s||s.length-1!=o.length)return"Invalid Date";for(var a=1;a<s.length;a++)i.push(s[a]);var r={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},d={},h={};for(a=0;a<o.length;a++)if(void 0!==r[o[a]]){var u=r[o[a]];d[u]||(d[u]=[],h[u]=[]),d[u].push(i[a]),h[u].push(o[a])}i=[],o=[];for(a=1;a<=7;a++)if(null!=d[a])for(var c=0;c<d[a].length;c++)i.push(d[a][c]),o.push(h[a][c]);var p=new Date;p.setDate(1),p.setHours(0),p.setMinutes(0),p.setSeconds(0),p.setMilliseconds(0);var b=function(t,e){for(var n=0;n<e.length;n++)if(e[n].toLowerCase()==t)return n;return-1};for(a=0;a<i.length;a++)switch(o[a]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(i[a])||p[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[o[a]]](Number(i[a])+("%m"==o[a]||"%n"==o[a]?-1:0));break;case"%M":case"%F":var m=b(i[a].toLowerCase(),n[{"%M":"monthShortName","%F":"monthFullName"}[o[a]]]);m>=0&&p.setMonth(m);break;case"%y":if(!isNaN(i[a])){var f=Number(i[a]);p.setFullYear(f+(f>50?1900:2e3))}break;case"%g":case"%h":if(!isNaN(i[a])){(f=Number(i[a]))<=12&&f>=0&&p.setHours(f+(b("pm",i)>=0?12==f?0:12:12==f?-12:0))}break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=i[a])}return p}),void 0===window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(t){if("string"!=typeof t)return t;if(t=t.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE)var e=(new window.DOMParser).parseFromString(t,"text/xml");else if(window.ActiveXObject!==window.undefined){(e=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)}return e},xmltop:function(t,e,n){if((void 0===e.status||e.status<400)&&(xml=e.responseXML?e.responseXML||e:dhx4.ajax.parse(e.responseText||e),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(t)[0]}catch(t){}return-1!==n&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],n]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),!dhx4.isIE){for(var n,i=[],o=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);n=o.iterateNext();)i.push(n);return i}try{return e.selectNodes(t)||[]}catch(t){return[]}},query:function(t){dhx4.ajax._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,null,t.headers)},get:function(t,e){return this._call("GET",t,null,!0,e)},getSync:function(t){return this._call("GET",t,null,!1)},put:function(t,e,n){return this._call("PUT",t,e,!0,n)},del:function(t,e,n){return this._call("DELETE",t,e,!0,n)},post:function(t,e,n){return 1==arguments.length?e="":2!=arguments.length||"function"!=typeof e&&"function"!=typeof window[e]?e=String(e):(n=e,e=""),this._call("POST",t,e,!0,n)},postSync:function(t,e){return e=null==e?"":String(e),this._call("POST",t,e,!1)},getLong:function(t,e){this._call("GET",t,null,!0,e,{url:t})},postLong:function(t,e,n){2!=arguments.length||"function"!=typeof e&&(window[e],0)||(n=e,e=""),this._call("POST",t,e,!0,n,{url:t,postData:e})},_call:function(t,e,n,i,o,l,s){var a=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==i&&(a.onreadystatechange=function(){if(4==a.readyState||1==r&&3==a.readyState){if((200!=a.status||""==a.responseText)&&!dhx4.callEvent("onAjaxError",[a]))return;window.setTimeout(function(){"function"==typeof o&&o.apply(window,[{xmlDoc:a,filePath:e,async:i}]),null!=l&&(void 0!==l.postData?dhx4.ajax.postLong(l.url,l.postData,o):dhx4.ajax.getLong(l.url,o)),o=null,a=null},1)}}),"GET"==t&&1!=this.cache&&(e+=(e.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),a.open(t,e,i),null!=s)for(var d in s)a.setRequestHeader(d,s[d]);else"POST"==t||"PUT"==t||"DELETE"==t?a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==t&&(n=null);return a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(n),{xmlDoc:a,filePath:e,async:i}}}),void 0===window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(t,e,n,i,o){if("clear"==o){for(var l in t._dhxdataload)t._dhxdataload[l]=null,delete t._dhxdataload[l];return t._loadData=null,t._dhxdataload=null,t.load=null,t.loadStruct=null,void(t=null)}if(t._dhxdataload={initObj:e,xmlToJson:n,xmlRootTag:i,onBeforeXLS:null},t._loadData=function(t,e,n){2==arguments.length&&(n=e,e=null);var i=null;if(3==arguments.length&&(n=arguments[2]),"string"==typeof t){var o=t.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");if(new RegExp("^<"+this._dhxdataload.xmlRootTag).test(o.replace(/^<\?xml[^\?]*\?>\s*/,""))&&null!=(i=dhx4.ajax.parse(t))&&(i=this[this._dhxdataload.xmlToJson].apply(this,[i])),null!=i||null==o.match(/^\{.*\}$/)&&null==o.match(/^\[.*\]$/)||(i=dhx4.s2j(o)),null==i){this.callEvent("onXLS",[]);var l=[];if("function"==typeof this._dhxdataload.onBeforeXLS){if(null!=(o=this._dhxdataload.onBeforeXLS.apply(this,[t]))&&"object"==typeof o&&(null!=o.url&&(t=o.url),null!=o.params))for(var s in o.params)l.push(s+"="+encodeURIComponent(o.params[s]))}var a=this,r=function(e){var i=null;null!=(i=(e.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=e.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?a[a._dhxdataload.xmlToJson].apply(a,[e.xmlDoc.responseXML]):dhx4.s2j(e.xmlDoc.responseText))&&a[a._dhxdataload.initObj].apply(a,[i,t]),a.callEvent("onXLE",[]),null!=n&&("function"==typeof n?n.apply(a,[]):"function"==typeof window[n]&&window[n].apply(a,[])),r=n=null,i=e=a=null};return l=l.join("&")+("string"==typeof e?"&"+e:""),void("post"==dhx4.ajax.method?dhx4.ajax.post(t,l,r):"get"==dhx4.ajax.method&&dhx4.ajax.get(t+(l.length>0?(t.indexOf("?")>0?"&":"?")+l:""),r))}}else i="object"==typeof t.documentElement||void 0!==t.tagName&&void 0!==t.getElementsByTagName&&t.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[t]):window.dhx4._copyObj(t);null!=i&&this[this._dhxdataload.initObj].apply(this,[i]),null!=n&&("function"==typeof n?n.apply(this,[]):"function"==typeof window[n]&&window[n].apply(this,[]),n=null)},null!=o){var s={struct:"loadStruct",data:"load"};for(var l in o)1==o[l]&&(t[s[l]]=function(){return this._loadData.apply(this,arguments)})}t=null}),void 0===window.dhx4._eventable&&(window.dhx4._eventable=function(t,e){if("clear"==e)return t.detachAllEvents(),t.dhxevs=null,t.attachEvent=null,t.detachEvent=null,t.checkEvent=null,t.callEvent=null,t.detachAllEvents=null,void(t=null);t.dhxevs={data:{}},t.attachEvent=function(t,e){t=String(t).toLowerCase(),this.dhxevs.data[t]||(this.dhxevs.data[t]={});var n=window.dhx4.newId();return this.dhxevs.data[t][n]=e,n},t.detachEvent=function(t){for(var e in this.dhxevs.data){var n=0;for(var i in this.dhxevs.data[e])i==t?(this.dhxevs.data[e][i]=null,delete this.dhxevs.data[e][i]):n++;0==n&&(this.dhxevs.data[e]=null,delete this.dhxevs.data[e])}},t.checkEvent=function(t){return t=String(t).toLowerCase(),null!=this.dhxevs.data[t]},t.callEvent=function(t,e){if(t=String(t).toLowerCase(),null==this.dhxevs.data[t])return!0;var n=!0;for(var i in this.dhxevs.data[t])n=this.dhxevs.data[t][i].apply(this,e)&&n;return n},t.detachAllEvents=function(){for(var t in this.dhxevs.data){for(var e in this.dhxevs.data[t])this.dhxevs.data[t][e]=null,delete this.dhxevs.data[t][e];this.dhxevs.data[t]=null,delete this.dhxevs.data[t]}},t=null},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(t){return""==t},isNotEmpty:function(t){return t instanceof Array?t.length>0:""==!t},isValidBoolean:function(t){return!!t.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(t){return!!t.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(t){return!!t.toString().match(/(^-?\d+$)/)},isValidNumeric:function(t){return!!t.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(t){return!!t.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31&&e[4]<=59&&e[5]<=59&&e[6]<=59)||!1},isValidDate:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31)||!1},isValidTime:function(t){var e=t.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return e&&!!(e[1]<=24&&e[2]<=59&&e[3]<=59)||!1},isValidIPv4:function(t){var e=t.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return e&&!!(e[1]<=255&&e[2]<=255&&e[3]<=255&&e[4]<=255)||!1},isValidCurrency:function(t){return!!t.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)},isValidSSN:function(t){return!!t.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)},isValidSIN:function(t){return!!t.toString().match(/^\d{9}$/)}},dhtmlxValidation=new dhtmlxValidation),void 0===window.dhtmlx&&(window.dhtmlx={extend:function(t,e){for(var n in e)t[n]||(t[n]=e[n]);return t},extend_api:function(t,e,n){var i=window[t];i&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var n=i.apply(this,e._init?e._init(t):arguments);for(var o in dhtmlx)e[o]&&this[e[o]](dhtmlx[o]);for(var o in t)e[o]?this[e[o]](t[o]):0===o.indexOf("on")&&this.attachEvent(o,t[o])}else n=i.apply(this,arguments);return e._patch&&e._patch(this),n||this},window[t].prototype=i.prototype,n&&dhtmlx.extend(window[t].prototype,n))},url:function(t){return-1!=t.indexOf("?")?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){if(!t&&!window.event||2!=(t||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),!(!t||!t.preventDefault)&&(t.preventDefault(),!1))},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var n=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var i=document.createElement("Div");i.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=i.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),n.dhtmlDragAndDrop.dragNode=dragger.dragNode}if(dragger.dragNode.style.left=t.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",t.srcElement)o=t.srcElement;else var o=t.target;dragger.checkLanding(o,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,n=0,i=0;e;)n+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var o=parent.dhtmlDragAndDrop.calculateFramePosition(1);n+=1*o.split("_")[0],i+=1*o.split("_")[1]}if(t)return n+"_"+i;this.fx=n,this.fy=i}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var n=dragger.lastLanding;dragger.lastLanding=null,n&&n.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,n,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(t){}for(var n=0;n<window.frames.length;n++)try{window.frames[n]!=t&&window.frames[n].dhtmlDragAndDrop&&window.frames[n].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(t){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),void 0===window.dhtmlxEvent)function dhtmlxEvent(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),void 0===dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){function t(){if(n){var t=document.createEvent("HTMLEvents");t.initEvent("dblclick",!0,!0),n.dispatchEvent(t),e=n=null}}var e,n,i,o;dhtmlxEvent(document.body,"touchstart",function(l){n=l.touches[0].target,i=l.touches[0].clientX,o=l.touches[0].clientY,e=window.setTimeout(t,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(t){e&&(Math.abs(t.touches[0].clientX-i)>50||Math.abs(t.touches[0].clientY-o)>50)&&(window.clearTimeout(e),e=n=!1)}),dhtmlxEvent(document.body,"touchend",function(t){e&&(window.clearTimeout(e),e=n=!1)}),dhtmlxEvent.initTouch=function(){}}),dhtmlXToolbarObject.prototype.addSpacer=function(t){var e=this.idPrefix+t;if(null!=this._spacer){if(this._spacer.idd==t)return;if(this._spacer==this.objPull[e].obj.parentNode){for(var n=!0;n;){var i=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]),i!=t&&0!=this._spacer.childNodes.length||(null!=this.objPull[e].arw&&this.base.appendChild(this.objPull[e].arw),n=!1)}return this._spacer.idd=t,void this._fixSpacer()}if(this.base==this.objPull[e].obj.parentNode){n=!0;for(var o=null!=this.objPull[e].arw;n;){var l=this.base.childNodes.length-1;1==o&&this.base.childNodes[l]==this.objPull[e].arw&&(n=!1),this.base.childNodes[l].idd==t&&(n=!1),n&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[l],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[l]))}return this._spacer.idd=t,void this._fixSpacer()}}else{var s=null;for(l=0;l<this.base.childNodes.length;l++)this.base.childNodes[l]==this.objPull[this.idPrefix+t].obj&&(s=l,null!=this.objPull[this.idPrefix+t].arw&&(s=l+1));if(null!=s){for(this._spacer=document.createElement("DIV"),this._spacer.className="right"==this.conf.align?" dhxtoolbar_float_left":" dhxtoolbar_float_right",this._spacer.dir="ltr",this._spacer.idd=t;this.base.childNodes.length>s+1;)this._spacer.appendChild(this.base.childNodes[s+1]);this.cont.appendChild(this._spacer),this._fixSpacer()}}"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer),this._spacer=null,"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()}},dhtmlXToolbarObject.prototype._fixSpacer=function(){if(void 0===window.addEventListener&&null!=this._spacer){this._spacer.style.borderLeft="1px solid #a4bed4";var t=this._spacer;window.setTimeout(function(){t.style.borderLeft="0px solid #a4bed4",t=null},1)}},dhtmlXToolbarObject.prototype.getType=function(t){var e=this.getParentId(t);if(null!=e){var n=null,i=this.objPull[this.idPrefix+e]._listOptions[t];return null!=i&&(n=null!=i.sep?"buttonSelectSeparator":"buttonSelectButton"),n}return null==this.objPull[this.idPrefix+t]?null:this.objPull[this.idPrefix+t].type},dhtmlXToolbarObject.prototype.getTypeExt=function(t){var e=this.getType(t);return"buttonSelectButton"==e||"buttonSelectSeparator"==e?e="buttonSelectButton"==e?"button":"separator":null},dhtmlXToolbarObject.prototype.inArray=function(t,e){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},dhtmlXToolbarObject.prototype.getParentId=function(t){var e=null;for(var n in this.objPull)if(this.objPull[n]._listOptions)for(var i in this.objPull[n]._listOptions)i==t&&(e=String(n).replace(this.idPrefix,""));return e},dhtmlXToolbarObject.prototype._addItem=function(t,e){"string"==typeof t.text&&(t.text=window.dhx4.trim(t.text),0==t.text.length&&(t.text=null)),this._addItemToStorage(t,e),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.addButton=function(t,e,n,i,o){this._addItem({id:t,type:"button",text:n,img:i,imgdis:o},e)},dhtmlXToolbarObject.prototype.addText=function(t,e,n){this._addItem({id:t,type:"text",text:n},e)},dhtmlXToolbarObject.prototype.addButtonSelect=function(t,e,n,i,o,l,s,a,r,d){for(var h=[],u=0;u<i.length;u++){var c={};i[u]instanceof Array?(c.id=i[u][0],c.type="obj"==i[u][1]?"button":"separator",c.text=i[u][2]||null,c.img=i[u][3]||null):i[u]instanceof Object&&null!=i[u]&&void 0!==i[u].id&&void 0!==i[u].type&&(c.id=i[u].id,c.type="obj"==i[u].type?"button":"separator",c.text=i[u].text,c.img=i[u].img),h.push(c)}this._addItem({id:t,type:"buttonSelect",text:n,img:o,imgdis:l,renderSelect:s,openAll:a,options:h,maxOpen:r,mode:d},e)},dhtmlXToolbarObject.prototype.addButtonTwoState=function(t,e,n,i,o){this._addItem({id:t,type:"buttonTwoState",img:i,imgdis:o,text:n},e)},dhtmlXToolbarObject.prototype.addSeparator=function(t,e){this._addItem({id:t,type:"separator"},e)},dhtmlXToolbarObject.prototype.addSlider=function(t,e,n,i,o,l,s,a,r){this._addItem({id:t,type:"slider",length:n,valueMin:i,valueMax:o,valueNow:l,textMin:s,textMax:a,toolTip:r},e)},dhtmlXToolbarObject.prototype.addInput=function(t,e,n,i){this._addItem({id:t,type:"buttonInput",value:n,width:i},e)},dhtmlXToolbarObject.prototype.forEachItem=function(t){for(var e in this.objPull)this.inArray(this.rootTypes,this.objPull[e].type)&&t(this.objPull[e].id.replace(this.idPrefix,""))},function(){for(var t="isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),e=[!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],n=function(t,e){return function(n,i,o){return n=this.idPrefix+n,null!=this.objPull[n][t]?this.objPull[n][t].call(this.objPull[n],i,o):e}},i=0;i<t.length;i++){var o=t[i],l=e[i];dhtmlXToolbarObject.prototype[o]=n(o,l)}}(),dhtmlXToolbarObject.prototype.showItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].showItem&&(this.objPull[t].showItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.hideItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].hideItem&&(this.objPull[t].hideItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.getPosition=function(t){return this._getPosition(t)},dhtmlXToolbarObject.prototype._getPosition=function(t,e){if(null==this.objPull[this.idPrefix+t])return null;for(var n=null,i=0,o=0;o<this.base.childNodes.length;o++)null!=this.base.childNodes[o].idd&&(this.base.childNodes[o].idd==t&&(n=i),i++);if(!n&&null!=this._spacer)for(o=0;o<this._spacer.childNodes.length;o++)null!=this._spacer.childNodes[o].idd&&(this._spacer.childNodes[o].idd==t&&(n=i),i++);return n},dhtmlXToolbarObject.prototype.setPosition=function(t,e){this._setPosition(t,e)},dhtmlXToolbarObject.prototype._setPosition=function(t,e){if(null!=this.objPull[this.idPrefix+t]){isNaN(e)&&(e=this.base.childNodes.length),e<0&&(e=0);var n=null;this._spacer&&(n=this._spacer.idd,this.removeSpacer());var i=this.objPull[this.idPrefix+t];this.base.removeChild(i.obj),i.arw&&this.base.removeChild(i.arw);var o=this._getIdByPosition(e,!0);null==o[0]?(this.base.appendChild(i.obj),i.arw&&this.base.appendChild(i.arw)):(this.base.insertBefore(i.obj,this.base.childNodes[o[1]]),i.arw&&this.base.insertBefore(i.arw,this.base.childNodes[o[1]+1])),null!=n&&this.addSpacer(n)}},dhtmlXToolbarObject.prototype._getIdByPosition=function(t,e){for(var n=null,i=0,o=0,l=0;l<this.base.childNodes.length;l++)null!=this.base.childNodes[l].idd&&null==n&&i++==t&&(n=this.base.childNodes[l].idd),null==n&&o++;return o=null==n?null:o,1==e?new Array(n,o):n},dhtmlXToolbarObject.prototype.removeItem=function(t){this._removeItem(t),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._removeItem=function(t){var e=this.getType(t);t=this.idPrefix+t;var n=this.objPull[t];if("button"==e&&(n.obj._doOnMouseOver=null,n.obj._doOnMouseOut=null,n.obj._doOnMouseUp=null,n.obj._doOnMouseUpOnceAnywhere=null,n.obj.onclick=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmouseup=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.renderAs=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.state=null,n.img=null,n.imgEn=null,n.imgDis=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null),"buttonTwoState"==e&&(n.obj._doOnMouseOver=null,n.obj._doOnMouseOut=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.renderAs=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.state=null,n.img=null,n.imgEn=null,n.imgDis=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null,n.setItemState=null,n.getItemState=null),"buttonSelect"==e){for(var i in n._listOptions)this.removeListOption(t,i);n._listOptions=null,n.polygon._ie6cover&&(document.body.removeChild(n.polygon._ie6cover),n.polygon._ie6cover=null),n.p_tbl.removeChild(n.p_tbody),n.polygon.removeChild(n.p_tbl),n.polygon.onselectstart=null,document.body.removeChild(n.polygon),n.p_tbody=null,n.p_tbl=null,n.polygon=null,n.obj.onclick=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmouseup=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.idd=null,n.obj.iddPrefix=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.arw.onclick=null,n.arw.onmouseover=null,n.arw.onmouseout=null,n.arw.onmouseup=null,n.arw.onmousedown=null,n.arw.onselectstart=null,n.arw.parentNode.removeChild(n.arw),n.arw=null,n.renderSelect=null,n.state=null,n.type=null,n.id=null,n.img=null,n.imgEn=null,n.imgDis=null,n.openAll=null,n._isListButton=null,n._separatorButtonSelectObject=null,n._buttonButtonSelectObject=null,n.setWidth=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null,n.addListOption=null,n.removeListOption=null,n.showListOption=null,n.hideListOption=null,n.isListOptionVisible=null,n.enableListOption=null,n.disableListOption=null,n.isListOptionEnabled=null,n.setListOptionPosition=null,n.getListOptionPosition=null,n.setListOptionImage=null,n.getListOptionImage=null,n.clearListOptionImage=null,n.setListOptionText=null,n.getListOptionText=null,n.setListOptionToolTip=null,n.getListOptionToolTip=null,n.forEachListOption=null,n.getAllListOptions=null,n.setListOptionSelected=null,n.getListOptionSelected=null}if("buttonInput"==e&&(n.obj.childNodes[0].onkeydown=null,n.obj.removeChild(n.obj.childNodes[0]),n.obj.w=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemToolTip=null,n.getItemToolTip=null,n.setWidth=null,n.getWidth=null,n.setValue=null,n.getValue=null,n.setItemText=null,n.getItemText=null),"slider"==e){for(window.dhx4.isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):"function"==typeof window.addEventListener?(window.removeEventListener("mousemove",n.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",n.pen._doOnMouseMoveEnd,!1)):(document.body.detachEvent("onmousemove",n.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",n.pen._doOnMouseMoveEnd)),n.pen.allowMove=null,n.pen.initXY=null,n.pen.maxX=null,n.pen.minX=null,n.pen.nowX=null,n.pen.newNowX=null,n.pen.valueMax=null,n.pen.valueMin=null,n.pen.valueNow=null,n.pen._definePos=null,n.pen._detectLimits=null,n.pen._doOnMouseMoveStart=null,n.pen._doOnMouseMoveEnd=null,n.pen.onmousedown=null,n.obj.removeChild(n.pen),n.pen=null,n.label.tip=null,document.body.removeChild(n.label),n.label=null,n.obj.onselectstart=null,n.obj.idd=null;n.obj.childNodes.length>0;)n.obj.removeChild(n.obj.childNodes[0]);n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.state=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.setItemToolTipTemplate=null,n.getItemToolTipTemplate=null,n.setMaxValue=null,n.setMinValue=null,n.getMaxValue=null,n.getMinValue=null,n.setValue=null,n.getValue=null,n.showItem=null,n.hideItem=null,n.isVisible=null}"separator"==e&&(n.obj.onselectstart=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.showItem=null,n.hideItem=null,n.isVisible=null),"text"==e&&(n.obj.onselectstart=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setWidth=null,n.setItemText=null,n.getItemText=null),e=null,n=null,this.objPull[this.idPrefix+t]=null,delete this.objPull[this.idPrefix+t]},function(){for(var t="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),e=function(t){return function(e,n,i,o,l,s){if(e=this.idPrefix+e,null!=this.objPull[e]&&"buttonSelect"==this.objPull[e].type)return this.objPull[e][t].call(this.objPull[e],n,i,o,l,s)}},n=0;n<t.length;n++){var i=t[n];dhtmlXToolbarObject.prototype[i]=e(i)}}(),dhtmlXToolbarObject.prototype._rtlParseBtn=function(t,e){return t+e},dhtmlXToolbarObject.prototype._separatorObject=function(t,e,n){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_sep",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},window.dhx4.isIPad&&(this.obj.ontouchstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this},dhtmlXToolbarObject.prototype._textObject=function(t,e,n){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_text",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},window.dhx4.isIPad&&(this.obj.ontouchstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),this.obj.innerHTML=n.text||"",t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(t){this.obj.innerHTML=t},this.getItemText=function(){return this.obj.innerHTML},this.setWidth=function(t){this.obj.style.width=t+"px"},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null==n.enabled,this.imgEn=n.img||"",this.imgDis=n.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.allowClick=!1,this.obj.extAction=n.action||null,this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=n.text?"<div class='dhxtoolbar_text'>"+n.text+"</div>":"");var i=this;return this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){this.allowClick=!0,0!=i.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className)},this.obj._doOnMouseOut=function(){this.allowClick=!1,0!=i.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.renderAs)},this.obj.onclick=function(e){if(0!=i.state&&0!=this.allowClick){e=e||event;var n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n)}catch(e){}t&&t.callEvent&&t.callEvent("onClick",[n])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){if(0==i.state)return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,e.cancelBubble=!0,!1;if("none"==t.anyUsed)return t.anyUsed=this.idd,this.className="dhx_toolbar_btn dhxtoolbar_btn_pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){t.anyUsed="none",this._doOnMouseOut()},!1},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(e){if(0!=i.state&&("none"==t.anyUsed||t.anyUsed==this.idd)){var n=t.anyUsed;this._doOnMouseUp(),window.dhx4.isIPad&&"none"!=n&&t.callEvent("onClick",[this.idd.replace(t.idPrefix,"")])}},window.dhx4.isIPad&&(this.obj.ontouchmove=function(t){this._doOnMouseUp()}),this.obj._doOnMouseUp=function(){t.anyUsed="none",this.className=this.renderAs,this.pressed=!1},this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp(),this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){this._doOnMouseOut()}},t.base.appendChild(this.obj),this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonSelectObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null==n.enabled||"true"==n.enabled,this.imgEn=n.img||"",this.imgDis=n.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.mode=n.mode||"button","select"==this.mode?(this.openAll=!0,this.renderSelect=!1,n.text&&0!=n.text.length||(n.text="&nbsp;")):(this.openAll=1==window.dhx4.s2b(n.openAll),this.renderSelect=null==n.renderSelect||window.dhx4.s2b(n.renderSelect)),this.maxOpen=isNaN(n.maxOpen?n.maxOpen:"")?null:n.maxOpen,this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!t._sbw){var e=document.createElement("DIV");e.className="dhxtoolbar_maxopen_test",document.body.appendChild(e);var n=document.createElement("DIV");n.className="dhxtoolbar_maxopen_test2",e.appendChild(n),t._sbw=e.offsetWidth-n.offsetWidth,e.removeChild(n),n=null,document.body.removeChild(e),e=null}},this._maxOpenTest(),this.obj=document.createElement("DIV"),this.obj.allowClick=!1,this.obj.extAction=n.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed=!1,this.callEvent=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=n.text?"<div class='dhxtoolbar_text'>"+n.text+"</div>":""),t.base.appendChild(this.obj),this.arw=document.createElement("DIV"),this.arw.className="dhx_toolbar_arw dhxtoolbar_btn_"+(this.state?"def":"dis"),this.arw.style.display=this.obj.style.display,this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>",this.arw.title=this.obj.title,this.arw.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},t.base.appendChild(this.arw);var i=this;if(this.obj.onmouseover=function(e){e=e||event,"none"==t.anyUsed&&i.state&&(i.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"))},this.obj.onmouseout=function(){i.obj.allowClick=!1,"none"==t.anyUsed&&i.state&&(i.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),i.callEvent=!1)},this.arw.onmouseover=this.obj.onmouseover,this.arw.onmouseout=this.obj.onmouseout,1==this.openAll||(this.obj.onclick=function(e){if(e=e||event,i.obj.allowClick&&i.state&&"none"==t.anyUsed){var n=i.obj.idd.replace(t.idPrefix,"");if(i.obj.extAction)try{window[i.obj.extAction](n)}catch(e){}t.callEvent("onClick",[n])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event,"none"==t.anyUsed&&i.state&&(i.obj.allowClick=!0,i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",i.callEvent=!0)},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(e){if(e=e||event,e.cancelBubble=!0,"none"==t.anyUsed&&i.state&&(i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),window.dhx4.isIPad&&i.callEvent)){var n=i.obj.idd.replace(t.idPrefix,"");t.callEvent("onClick",[n])}}),window.dhx4.isIPad&&(this.obj.ontouchmove=this.obj.onmouseout),this.arw[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event;var n=0===this.className.indexOf("dhx_toolbar_arw")?this:this.nextSibling;if(n._skip?(e=e||event).cancelBubble=!0:n._skip=!0,n=null,i.state){if(t.anyUsed==i.obj.idd)i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),t.anyUsed="none",window.dhx4.zim.clear(i.polygon._idd),i.polygon.style.display="none",i.polygon._ie6cover&&(i.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(i.id,!0);else{if("none"!=t.anyUsed&&"buttonSelect"==t.objPull[t.idPrefix+t.anyUsed].type){var o=t.objPull[t.idPrefix+t.anyUsed];"none"!=o.polygon.style.display&&(o.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",o.obj.className=o.obj.renderAs,o.arw.className=String(i.obj.renderAs).replace("btn","arw"),window.dhx4.zim.clear(o.polygon._idd),o.polygon.style.display="none",o.polygon._ie6cover&&(o.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(o.id,!0))}i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over",i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",t.anyUsed=i.obj.idd,i.polygon.style.top="0px",i.polygon.style.visibility="hidden",i.polygon.style.zIndex=window.dhx4.zim.reserve(i.polygon._idd),i.polygon.style.display="","dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(i.id,!1),i._fixMaxOpenHeight(i.maxOpen||null),t._autoDetectVisibleArea();var l=window.dhx4.absTop(i.obj)+i.obj.offsetHeight+t.conf.sel_ofs_y,s=i.polygon.offsetHeight;if(l+s>t.tY2){var a=null!=i.maxOpen?Math.floor((t.tY2-l)/22):0;a>=1?i._fixMaxOpenHeight(a):(l=window.dhx4.absTop(i.obj)-s-t.conf.sel_ofs_y)<0&&(l=0)}if(i.polygon.style.top=l+"px",t.rtl)i.polygon.style.left=window.dhx4.absLeft(i.obj)+i.obj.offsetWidth-i.polygon.offsetWidth+t.conf.sel_ofs_x+"px";else{var r=document.body.scrollLeft+(window.innerWidth||document.body.clientWidth),d=window.dhx4.absLeft(i.obj)+t.conf.sel_ofs_x;d+i.polygon.offsetWidth>r&&(d=window.dhx4.absLeft(i.arw)+i.arw.offsetWidth-i.polygon.offsetWidth),i.polygon.style.left=Math.max(d,5)+"px"}i.polygon.style.visibility="visible",i.polygon._ie6cover&&(i.polygon._ie6cover.style.left=i.polygon.style.left,i.polygon._ie6cover.style.top=i.polygon.style.top,i.polygon._ie6cover.style.width=i.polygon.offsetWidth+"px",i.polygon._ie6cover.style.height=i.polygon.offsetHeight+"px",i.polygon._ie6cover.style.display="")}return!1}},this.arw.onclick=function(t){(t=t||event).cancelBubble=!0},this.arw[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(t){(t=t||event).cancelBubble=!0},!0===this.openAll&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,window.dhx4.isIPad&&(this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend)),this.obj.iddPrefix=t.idPrefix,this._listOptions={},this._fixMaxOpenHeight=function(e){var n="auto",o=!1;if(null!==e){var l=0;for(var s in this._listOptions)l++;l>e?(this._ph=22*e,n=this._ph+"px"):o=!0}this.polygon.style.width="auto",this.polygon.style.height="auto",o||null==i.maxOpen||(this.polygon.style.width=this.p_tbl.offsetWidth+t._sbw+"px",this.polygon.style.height=n)},this._separatorButtonSelectObject=function(t,e,n){return this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.className="tr_sep",this.obj.tr.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td=document.createElement("TD"),this.obj.td.colSpan="2",this.obj.td.className="td_btn_sep",this.obj.td.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},isNaN(n)?n=i.p_tbody.childNodes.length+1:n<1&&(n=1),n>i.p_tbody.childNodes.length?i.p_tbody.appendChild(this.obj.tr):i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[n-1]),this.obj.tr.appendChild(this.obj.td),this.obj.sep=document.createElement("DIV"),this.obj.sep.className="btn_sep",this.obj.sep.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td.appendChild(this.obj.sep),i._listOptions[t]=this.obj,this},this._buttonButtonSelectObject=function(e,n,o){var l=!0;void 0!==n.enabled?l=window.dhx4.s2b(n.enabled):void 0!==n.disabled&&(l=window.dhx4.s2b(n.disabled)),this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.en=l,this.obj.tr.extAction=n.action||null,this.obj.tr._selected=null!=n.selected,this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&i.renderSelect?" tr_btn_selected":"":" tr_btn_disabled"),this.obj.tr.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.tr.idd=String(e),isNaN(o)?o=i.p_tbody.childNodes.length+1:o<1&&(o=1),o>i.p_tbody.childNodes.length?i.p_tbody.appendChild(this.obj.tr):i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[o-1]),this.obj.td_a=document.createElement("TD"),this.obj.td_a.className="td_btn_img",this.obj.td_a.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td_b=document.createElement("TD"),this.obj.td_b.className="td_btn_txt",this.obj.td_b.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},t.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b)),null!=n.img?(this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+t.conf.icons_path+n.img+"' border='0'>",this.obj.tr._img=n.img):this.obj.td_a.innerHTML="&nbsp;";var s=null!=n.text?n.text:n.itemText||"";return this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+s+"</div>",this.obj.tr[window.dhx4.isIPad?"ontouchstart":"onmouseover"]=function(){!this.en||this._selected&&i.renderSelect||(this.className="tr_btn tr_btn_over")},this.obj.tr.onmouseout=function(){this.en&&(this._selected&&i.renderSelect?-1==String(this.className).search("tr_btn_selected")&&(this.className="tr_btn tr_btn_selected"):this.className="tr_btn")},this.obj.tr.onclick=function(t){return t=t||event,t.cancelBubble=!0,t.preventDefault&&t.preventDefault(),!1},this.obj.tr[window.dhx4.isIPad?"ontouchend":"onmousedown"]=function(e){if(e=e||event,e.cancelBubble=!0,e.preventDefault&&e.preventDefault(),this.en){i.setListOptionSelected(this.idd.replace(t.idPrefix,"")),i.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),window.dhx4.zim.clear(i.polygon._idd),i.polygon.style.display="none",i.polygon._ie6cover&&(i.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(i.id,!0),t.anyUsed="none";var n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n)}catch(e){}return t.callEvent("onClick",[n]),!1}},i._listOptions[e]=this.obj,this},this.polygon=document.createElement("DIV"),this.polygon.dir="ltr",this.polygon.style.display="none",this.polygon.className="dhx_toolbar_poly_"+t.conf.skin+" dhxtoolbar_icons_"+t.conf.iconSize,this.polygon.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.polygon.onmousedown=function(t){(t=t||event).cancelBubble=!0},this.polygon.style.overflowY="auto",this.polygon._idd=window.dhx4.newId(),window.dhx4.isIPad&&(this.polygon.ontouchstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),this.p_tbl=document.createElement("TABLE"),this.p_tbl.className="buttons_cont",this.p_tbl.cellSpacing="0",this.p_tbl.cellPadding="0",this.p_tbl.border="0",this.polygon.appendChild(this.p_tbl),this.p_tbody=document.createElement("TBODY"),this.p_tbl.appendChild(this.p_tbody),null!=n.options)for(var o=0;o<n.options.length;o++){var l="_"+(n.options[o].type||"")+"ButtonSelectObject";null==n.options[o].id&&(n.options[o].id=t._genStr(24)),"function"==typeof this[l]&&new this[l](n.options[o].id,n.options[o])}return document.body.appendChild(this.polygon),window.dhx4.isIE6&&(this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor="#000000",this.polygon._ie6cover.style.filter="alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover)),this.setWidth=function(t){this.obj.style.width=t-this.arw.offsetWidth+"px",this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px",this.p_tbl.style.width=this.polygon.style.width},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display="",this.arw.style.display=""},this.hideItem=function(){this.obj.style.display="none",this.arw.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t,this.arw.title=t},this.getItemToolTip=function(){return this.obj.title},this.addListOption=function(t,e,n,i,o){if("button"==n||"separator"==n){var l={id:t,type:n,text:i,img:o};new this["_"+n+"ButtonSelectObject"](t,l,e)}},this.removeListOption=function(t){if(this._isListButton(t,!0)){var e=this._listOptions[t];if(null!=e.td_a&&null!=e.td_b){for(e.td_a.onselectstart=null,e.td_b.onselectstart=null;e.td_a.childNodes.length>0;)e.td_a.removeChild(e.td_a.childNodes[0]);for(;e.td_b.childNodes.length>0;)e.td_b.removeChild(e.td_b.childNodes[0]);for(e.tr.onselectstart=null,e.tr.onmouseover=null,e.tr.onmouseout=null,e.tr.onclick=null;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.td_a=null,e.td_b=null,e.tr=null}else{for(e.sep.onselectstart=null,e.td.onselectstart=null,e.tr.onselectstart=null;e.td.childNodes.length>0;)e.td.removeChild(e.td.childNodes[0]);for(;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.sep=null,e.td=null,e.tr=null}e=null,this._listOptions[t]=null;try{delete this._listOptions[t]}catch(t){}}},this.showListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="")},this.hideListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="none")},this.isListOptionVisible=function(t){if(this._isListButton(t,!0))return"none"!=this._listOptions[t].tr.style.display},this.enableListOption=function(e){this._isListButton(e)&&(this._listOptions[e].tr.en=!0,this._listOptions[e].tr.className="tr_btn"+(this._listOptions[e].tr._selected&&t.renderSelect?" tr_btn_selected":""))},this.disableListOption=function(t){this._isListButton(t)&&(this._listOptions[t].tr.en=!1,this._listOptions[t].tr.className="tr_btn tr_btn_disabled")},this.isListOptionEnabled=function(t){if(this._isListButton(t))return this._listOptions[t].tr.en},this.setListOptionPosition=function(t,e){if(this._listOptions[t]&&this.getListOptionPosition(t)!=e&&!isNaN(e)){e<1&&(e=1);var n=this._listOptions[t].tr;this.p_tbody.removeChild(n),e>this.p_tbody.childNodes.length?this.p_tbody.appendChild(n):this.p_tbody.insertBefore(n,this.p_tbody.childNodes[e-1]),n=null}},this.getListOptionPosition=function(t){var e=-1;if(!this._listOptions[t])return e;for(var n=0;n<this.p_tbody.childNodes.length;n++)this.p_tbody.childNodes[n]==this._listOptions[t].tr&&(e=n+1);return e},this.setListOptionImage=function(e,n){if(this._isListButton(e)){var i=this._listOptions[e].tr.childNodes[t.rtl?1:0];if(i.childNodes.length>0)i.childNodes[0].src=t.conf.icons_path+n;else{var o=document.createElement("IMG");o.className="btn_sel_img",o.src=t.conf.icons_path+n,i.appendChild(o)}i=null}},this.getListOptionImage=function(e){if(this._isListButton(e)){var n=this._listOptions[e].tr.childNodes[t.rtl?1:0],i=null;return n.childNodes.length>0&&(i=n.childNodes[0].src),n=null,i}},this.clearListOptionImage=function(e){if(this._isListButton(e)){for(var n=this._listOptions[e].tr.childNodes[t.rtl?1:0];n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.innerHTML="&nbsp;",n=null}},this.setListOptionText=function(e,n){this._isListButton(e)&&(this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML=n)},this.getListOptionText=function(e){if(this._isListButton(e))return this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML},this.setListOptionToolTip=function(t,e){this._isListButton(t)&&(this._listOptions[t].tr.title=e)},this.getListOptionToolTip=function(t){if(this._isListButton(t))return this._listOptions[t].tr.title},this.forEachListOption=function(t){for(var e in this._listOptions)t(e)},this.getAllListOptions=function(){var t=new Array;for(var e in this._listOptions)t[t.length]=e;return t},this.setListOptionSelected=function(t){for(var e in this._listOptions){var n=this._listOptions[e];null!=n.td_a&&null!=n.td_b&&n.tr.en&&(e==t?(n.tr._selected=!0,n.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":""),"select"==this.mode&&(n.tr._img?this.setItemImage(n.tr._img):this.clearItemImage(),this.setItemText(this.getListOptionText(t)))):(n.tr._selected=!1,n.tr.className="tr_btn")),n=null}},this.getListOptionSelected=function(){var t=null;for(var e in this._listOptions)1==this._listOptions[e].tr._selected&&(t=e);return t},this._isListButton=function(t,e){return null!=this._listOptions[t]&&!(!e&&"tr_sep"==this._listOptions[t].tr.className)},this.setMaxOpen=function(t){if(this._ph=null,"number"==typeof t)return this.maxOpen=t,void this._maxOpenTest();this.maxOpen=null},n.width&&this.setWidth(n.width),"select"==this.mode&&void 0!==n.selected&&this.setListOptionSelected(n.selected),this},dhtmlXToolbarObject.prototype._buttonInputObject=function(t,e,n){this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.w=null!=n.width?n.width:100,this.obj.title=null!=n.title?n.title:"",this.obj.innerHTML="<input class='dhxtoolbar_input' type='text' style='width:"+this.obj.w+"px;'"+(null!=n.value?" value='"+n.value+"'":"")+">";var i=t,o=this;return this.obj.childNodes[0].onkeydown=function(t){13==(t=t||event).keyCode&&i.callEvent("onEnter",[o.obj.idd,this.value])},t.base.appendChild(this.obj),this.enableItem=function(){this.obj.childNodes[0].disabled=!1},this.disableItem=function(){this.obj.childNodes[0].disabled=!0},this.isEnabled=function(){return!this.obj.childNodes[0].disabled},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return"none"!=this.obj.style.display},this.setValue=function(t){this.obj.childNodes[0].value=t},this.getValue=function(){return this.obj.childNodes[0].value},this.setWidth=function(t){this.obj.w=t,this.obj.childNodes[0].style.width=this.obj.w+"px"},this.getWidth=function(){return this.obj.w},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this.getInput=function(){return this.obj.firstChild},void 0!==n.enabled&&0==window.dhx4.s2b(n.enabled)&&this.disableItem(),this},dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null==n.enabled,this.imgEn=null!=n.img?n.img:"",this.imgDis=null!=n.imgdis?n.imgdis:"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.pressed=null!=n.selected,this.obj.extAction=n.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.obj.pressed?"pres"+(this.state?"":"_dis"):this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed&&(this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"),this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=n.text?"<div class='dhxtoolbar_text'>"+n.text+"</div>":""),t.base.appendChild(this.obj);var i=this;return this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){0!=i.state&&"none"==t.anyUsed&&(this.pressed?this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over":(this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className))},this.obj._doOnMouseOut=function(){0!=i.state&&"none"==t.anyUsed&&(this.pressed?this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def":(this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.className))},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){if((!t.checkEvent("onBeforeStateChange")||t.callEvent("onBeforeStateChange",[this.idd.replace(t.idPrefix,""),this.pressed]))&&0!=i.state&&"none"==t.anyUsed){this.pressed=!this.pressed,this.className=this.pressed?"dhx_toolbar_btn dhxtoolbar_btn_pres":this.renderAs;var n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n,this.pressed)}catch(e){}return t.callEvent("onStateChange",[n,this.pressed]),!1}},this.setItemState=function(e,n){if(this.obj.pressed!=e&&(1==e?(this.obj.pressed=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres"+(this.state?"":"_dis"),this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(this.obj.pressed=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.renderAs=this.obj.className),1==n)){var i=this.obj.idd.replace(t.idPrefix,"");if(this.obj.extAction)try{window[this.obj.extAction](i,this.obj.pressed)}catch(t){}t.callEvent("onStateChange",[i,this.obj.pressed])}},this.getItemState=function(){return this.obj.pressed},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._sliderObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null==n.enabled||"true"==n.enabled,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.len=null!=n.length?Number(n.length):50,this.obj.innerHTML="<div class='dhxtoolbar_text'>"+(n.textMin||"")+"</div><div class='dhxtoolbar_sl_bg_l'></div><div class='dhxtoolbar_sl_bg_m' style='width:"+this.obj.len+"px;'></div><div class='dhxtoolbar_sl_bg_r'></div><div class='dhxtoolbar_text'>"+(n.textMax||"")+"</div>",t.base.appendChild(this.obj);var i=this;this.pen=document.createElement("DIV"),this.pen.className="dhxtoolbar_sl_pen",this.obj.appendChild(this.pen);var o=this.pen;this.label=document.createElement("DIV"),this.label.dir="ltr",this.label.className="dhx_toolbar_slider_label_"+t.conf.skin+(t.rtl?"_rtl":""),this.label.style.display="none",this.label.tip=n.toolTip||"%v",this.label._zi=window.dhx4.newId(),document.body.appendChild(this.label);var l=this.label;return this.pen.valueMin=null!=n.valueMin?Number(n.valueMin):0,this.pen.valueMax=null!=n.valueMax?Number(n.valueMax):100,this.pen.valueMin>this.pen.valueMax&&(this.pen.valueMin=this.pen.valueMax),this.pen.valueNow=null!=n.valueNow?Number(n.valueNow):this.pen.valueMax,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits=function(){this.minX=i.obj.childNodes[1].offsetLeft+2,this.maxX=i.obj.childNodes[3].offsetLeft-this.offsetWidth+1},this.pen._detectLimits(),this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX),this.style.left=this.nowX+"px",this.newNowX=this.nowX},this.pen._definePos(),this.pen.initXY=0,this.pen.allowMove=!1,this.pen[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(t){0!=i.state&&(t=t||event,this.initXY=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,this.newValueNow=this.valueNow,this.allowMove=!0,this.className="dhxtoolbar_sl_pen dhxtoolbar_over",""!=l.tip&&(l.style.visibility="hidden",l.style.display="",l.innerHTML=l.tip.replace("%v",this.valueNow),l.style.left=Math.round(window.dhx4.absLeft(this)+this.offsetWidth/2-l.offsetWidth/2)+"px",l.style.top=window.dhx4.absTop(this)-l.offsetHeight-3+"px",l.style.visibility="",l.style.zIndex=window.dhx4.zim.reserve(l._zi)))},this.pen._doOnMouseMoveStart=function(t){if(t=t||event,o.allowMove){var e=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,n=e-o.initXY;if(!(e<window.dhx4.absLeft(o)+Math.round(o.offsetWidth/2)&&o.nowX==o.minX||e>window.dhx4.absLeft(o)+Math.round(o.offsetWidth/2)&&o.nowX==o.maxX))return o.newNowX=o.nowX+n,o.newNowX<o.minX&&(o.newNowX=o.minX),o.newNowX>o.maxX&&(o.newNowX=o.maxX),o.nowX=o.newNowX,o.style.left=o.nowX+"px",o.initXY=e,o.newValueNow=Math.round((o.valueMax-o.valueMin)*(o.newNowX-o.minX)/(o.maxX-o.minX)+o.valueMin),""!=l.tip&&(l.innerHTML=l.tip.replace(/%v/gi,o.newValueNow),l.style.left=Math.round(window.dhx4.absLeft(o)+o.offsetWidth/2-l.offsetWidth/2)+"px",l.style.top=window.dhx4.absTop(o)-l.offsetHeight-3+"px"),t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,!1}},this.pen._doOnMouseMoveEnd=function(){o.allowMove&&(o.className="dhxtoolbar_sl_pen",o.allowMove=!1,o.nowX=o.newNowX,o.valueNow=o.newValueNow,""!=l.tip&&(l.style.display="none",window.dhx4.zim.clear(l._zi)),t.callEvent("onValueChange",[i.obj.idd.replace(t.idPrefix,""),o.valueNow]))},window.dhx4.isIPad?(document.addEventListener("touchmove",o._doOnMouseMoveStart,!1),document.addEventListener("touchend",o._doOnMouseMoveEnd,!1)):void 0!==window.addEventListener?(window.addEventListener("mousemove",o._doOnMouseMoveStart,!1),window.addEventListener("mouseup",o._doOnMouseMoveEnd,!1)):(document.body.attachEvent("onmousemove",o._doOnMouseMoveStart),document.body.attachEvent("onmouseup",o._doOnMouseMoveEnd)),this.enableItem=function(){this.state||(this.state=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def")},this.disableItem=function(){this.state&&(this.state=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_dis")},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setValue=function(e,n){(e=Number(e))<this.pen.valueMin&&(e=this.pen.valueMin),e>this.pen.valueMax&&(e=this.pen.valueMax),this.pen.valueNow=e,this.pen._definePos(),1==n&&t.callEvent("onValueChange",[this.obj.idd.replace(t.idPrefix,""),this.pen.valueNow])},this.getValue=function(){return this.pen.valueNow},this.setMinValue=function(t,e){(t=Number(t))>this.pen.valueMax||(this.obj.childNodes[0].innerHTML=e,this.obj.childNodes[0].style.display=e.length>0?"":"none",this.pen.valueMin=t,this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits(),this.pen._definePos())},this.setMaxValue=function(t,e){(t=Number(t))<this.pen.valueMin||(this.obj.childNodes[4].innerHTML=e,this.obj.childNodes[4].style.display=e.length>0?"":"none",this.pen.valueMax=t,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen._detectLimits(),this.pen._definePos())},this.getMinValue=function(){var t=this.obj.childNodes[0].innerHTML,e=this.pen.valueMin;return new Array(e,t)},this.getMaxValue=function(){var t=this.obj.childNodes[4].innerHTML,e=this.pen.valueMax;return new Array(e,t)},this.setItemToolTipTemplate=function(t){this.label.tip=t},this.getItemToolTipTemplate=function(){return this.label.tip},this},dhtmlXToolbarObject.prototype.unload=function(){for(this.conf.isIPad?document.removeEventListener("touchstart",this._doOnClick,!1):"function"==typeof window.addEventListener?window.removeEventListener("mousedown",this._doOnClick,!1):document.body.detachEvent("onmousedown",this._doOnClick),this._doOnClick=null,this.clearAll(),this.objPull=null,this._xmlLoader&&(this._xmlLoader.destructor(),this._xmlLoader=null);this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);for(this.cont.removeChild(this.base),this.base=null;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="",this.cont=null,window.dhx4._enableDataLoading(this,null,null,null,"clear"),window.dhx4._eventable(this,"clear"),this.tX1=null,this.tX2=null,this.tY1=null,this.tY2=null,this.anyUsed=null,this.idPrefix=null,this.rootTypes=null,this._rtl=null,this._rtlParseBtn=null,this.setRTL=null,this._sbw=null,this._getObj=null,this._addImgObj=null,this._setItemImage=null,this._clearItemImage=null,this._setItemText=null,this._getItemText=null,this._enableItem=null,this._disableItem=null,this._xmlParser=null,this._addItemToStorage=null,this._genStr=null,this._addItem=null,this._getPosition=null,this._setPosition=null,this._getIdByPosition=null,this._separatorObject=null,this._textObject=null,this._buttonObject=null,this._buttonSelectObject=null,this._buttonInputObject=null,this._buttonTwoStateObject=null,this._sliderObject=null,this._autoDetectVisibleArea=null,this._removeItem=null,this.setAlign=null,this.setSkin=null,this.setIconsPath=null,this.setIconPath=null,this.loadXML=null,this.loadXMLString=null,this.clearAll=null,this.addSpacer=null,this.removeSpacer=null,this.getType=null,this.getTypeExt=null,this.inArray=null,this.getParentId=null,this.addButton=null,this.addText=null,this.addButtonSelect=null,this.addButtonTwoState=null,this.addSeparator=null,this.addSlider=null,this.addInput=null,this.forEachItem=null,this.showItem=null,this.hideItem=null,this.isVisible=null,this.enableItem=null,this.disableItem=null,this.isEnabled=null,this.setItemText=null,this.getItemText=null,this.setItemToolTip=null,this.getItemToolTip=null,this.setItemImage=null,this.setItemImageDis=null,this.clearItemImage=null,this.clearItemImageDis=null,this.setItemState=null,this.getItemState=null,this.setItemToolTipTemplate=null,this.getItemToolTipTemplate=null,this.setValue=null,this.getValue=null,this.setMinValue=null,this.getMinValue=null,this.setMaxValue=null,this.getMaxValue=null,this.setWidth=null,this.getWidth=null,this.getPosition=null,this.setPosition=null,this.removeItem=null,this.addListOption=null,this.removeListOption=null,this.showListOption=null,this.hideListOption=null,this.isListOptionVisible=null,this.enableListOption=null,this.disableListOption=null,this.isListOptionEnabled=null,this.setListOptionPosition=null,this.getListOptionPosition=null,this.setListOptionText=null,this.getListOptionText=null,this.setListOptionToolTip=null,this.getListOptionToolTip=null,this.setListOptionImage=null,this.getListOptionImage=null,this.clearListOptionImage=null,this.forEachListOption=null,this.getAllListOptions=null,this.setListOptionSelected=null,this.getListOptionSelected=null,this.unload=null,this.setUserData=null,this.getUserData=null,this.setMaxOpen=null,this.items=null,this.conf=null},dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){var t=window.dhx4.screenDim();this.tX1=t.left,this.tX2=t.right,this.tY1=t.top,this.tY2=t.bottom},dhtmlXToolbarObject.prototype._initObj=function(t){for(var e=0;e<t.length;e++)this._addItemToStorage(t[e]);"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._xmlToJson=function(t){var e=[],n=t.getElementsByTagName("toolbar");if(null!=n&&null!=n[0]){n=n[0];for(var i=["id","type","hidden","title","text","enabled","img","imgdis","action","openAll","renderSelect","mode","maxOpen","width","value","selected","length","textMin","textMax","toolTip","valueMin","valueMax","valueNow"],o=["id","type","enabled","disabled","action","selected","img","text"],l=0;l<n.childNodes.length;l++)if("item"==n.childNodes[l].tagName){for(var s={},a=0;a<i.length;a++){null!=(h=n.childNodes[l].getAttribute(i[a]))&&(s[i[a]]=h)}for(var r=0;r<n.childNodes[l].childNodes.length;r++){if("item"==n.childNodes[l].childNodes[r].tagName&&"buttonSelect"==s.type){var d={};for(a=0;a<o.length;a++){var h;null!=(h=n.childNodes[l].childNodes[r].getAttribute(o[a]))&&(d[o[a]]=h)}var u=n.childNodes[l].childNodes[r].getElementsByTagName("itemText");null!=u&&null!=u[0]&&(d.itemText=u[0].firstChild.nodeValue);var c=n.childNodes[l].childNodes[r].getElementsByTagName("userdata");for(a=0;a<c.length;a++){d.userdata||(d.userdata={});var p={};try{p.name=c[a].getAttribute("name")}catch(t){p.name=null}try{p.value=c[a].firstChild.nodeValue}catch(t){p.value=""}null!=p.name&&(d.userdata[p.name]=p.value)}null==s.options&&(s.options=[]),s.options.push(d)}if("userdata"==n.childNodes[l].childNodes[r].tagName){null==s.userdata&&(s.userdata={});d={};try{d.name=n.childNodes[l].childNodes[r].getAttribute("name")}catch(t){d.name=null}try{d.value=n.childNodes[l].childNodes[r].firstChild.nodeValue}catch(t){d.value=""}null!=d.name&&(s.userdata[d.name]=d.value)}}e.push(s)}}return e},dhtmlXToolbarObject.prototype._addItemToStorage=function(t,e){var n=t.id||this._genStr(24),i=t.type||"";if("spacer"==i?this.addSpacer(this._lastId):this._lastId=n,""!=i&&null!=this["_"+i+"Object"]){if("buttonSelect"==i&&null!=t.options)for(var o=0;o<t.options.length;o++)"obj"==t.options[o].type&&(t.options[o].type="button"),"sep"==t.options[o].type&&(t.options[o].type="separator");if("slider"==i){var l={tip_template:"toolTip",value_min:"valueMin",value_max:"valueMax",value_now:"valueNow",text_min:"textMin",text_max:"textMax"};for(var s in l)null==t[l[s]]&&null!=t[s]&&(t[l[s]]=t[s])}"buttonInput"==i&&null==t.value&&null!=t.text&&(t.value=t.text),"buttonTwoState"==i&&void 0===t.selected&&void 0!==t.pressed&&window.dhx4.s2b(t.pressed)&&(t.selected=!0),void 0===t.enabled&&void 0!==t.disabled&&window.dhx4.s2b(t.disabled)&&(t.enabled=!1),null==t.imgDis&&null!=t.img_disabled&&(t.imgdis=t.img_disabled),void 0!==t.openAll&&null!=t.openAll||"dhx_terrace"!=this.conf.skin||(t.openAll=!0),this.objPull[this.idPrefix+n]=new this["_"+i+"Object"](this,n,t),this.objPull[this.idPrefix+n].type=i,this.setPosition(n,e)}if(null!=t.userdata)for(var s in t.userdata)this.setUserData(n,s,t.userdata[s]);if(null!=t.options)for(o=0;o<t.options.length;o++)if(null!=t.options[o].userdata)for(var s in t.options[o].userdata)this.setListOptionUserData(t.id,t.options[o].id,s,t.options[o].userdata[s])},dhtmlXToolbarObject.prototype.setSkin=function(t,e){!0===e?this.cont.className=this.cont.className.replace(/dhxtoolbar_icons_\d{1,}/,"dhxtoolbar_icons_"+this.conf.iconSize):(this.conf.skin=t,"dhx_skyblue"==this.conf.skin&&(this.conf.sel_ofs_y=1),"dhx_web"==this.conf.skin&&(this.conf.sel_ofs_y=1,this.conf.sel_ofs_x=1),"dhx_terrace"==this.conf.skin&&(this.conf.sel_ofs_y=-1,this.conf.sel_ofs_x=0),this.cont.className="dhx_toolbar_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize);for(var n in this.objPull){var i=this.objPull[n];"slider"==i.type&&(i.pen._detectLimits(),i.pen._definePos(),i.label.className="dhx_toolbar_slider_label_"+this.conf.skin),"buttonSelect"==i.type&&(i.polygon.className="dhx_toolbar_poly_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize)}"dhx_terrace"==t&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.setAlign=function(t){this.conf.align="right"==t?"right":"left",this.base.className="right"==t?"dhxtoolbar_float_right":"dhxtoolbar_float_left",this._spacer&&(this._spacer.className="right"==t?" dhxtoolbar_float_left":" dhxtoolbar_float_right")},dhtmlXToolbarObject.prototype.setIconSize=function(t){this.conf.iconSize={18:!0,24:!0,32:!0,48:!0}[t]?t:18,this.setSkin(this.conf.skin,!0),this.callEvent("_onIconSizeChange",[this.conf.iconSize])},dhtmlXToolbarObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXToolbarObject.prototype.setUserData=function(t,e,n){t=this.idPrefix+t,null!=this.objPull[t]&&(null==this.objPull[t].userData&&(this.objPull[t].userData={}),this.objPull[t].userData[e]=n)},dhtmlXToolbarObject.prototype.getUserData=function(t,e){return t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].userData?this.objPull[t].userData[e]||null:null},dhtmlXToolbarObject.prototype._isListOptionExists=function(t,e){if(null==this.objPull[this.idPrefix+t])return!1;var n=this.objPull[this.idPrefix+t];return"buttonSelect"==n.type&&null!=n._listOptions[e]},dhtmlXToolbarObject.prototype.setListOptionUserData=function(t,e,n,i){if(this._isListOptionExists(t,e)){var o=this.objPull[this.idPrefix+t]._listOptions[e];null==o.userData&&(o.userData={}),o.userData[n]=i}},dhtmlXToolbarObject.prototype.getListOptionUserData=function(t,e,n){if(!this._isListOptionExists(t,e))return null;var i=this.objPull[this.idPrefix+t]._listOptions[e];return i.userData&&i.userData[n]?i.userData[n]:null},dhtmlXToolbarObject.prototype._improveTerraceSkin=function(){null==this.conf.terrace_radius&&(this.conf.terrace_radius="3px");var t=[],e={separator:!0,text:!0},n=[this.base];null!=this._spacer&&n.push(this._spacer);for(var i=0;i<n.length;i++){t[i]=[];for(var o=0;o<n[i].childNodes.length;o++)if(null!=n[i].childNodes[o].idd&&"none"!=n[i].childNodes[o].style.display){var l=this.idPrefix+n[i].childNodes[o].idd;null!=this.objPull[l]&&this.objPull[l].obj==n[i].childNodes[o]&&t[i].push({a:l,type:this.objPull[l].type,node:this.objPull[l]["buttonSelect"==this.objPull[l].type?"arw":"obj"]})}n[i]=null}for(i=0;i<t.length;i++)for(o=0;o<t[i].length;o++){var s=t[i][o],a=!1,r=!1;e[s.type]||((o==t[i].length-1||null!=t[i][o+1]&&e[t[i][o+1].type])&&(a=!0),(0==o||o-1>=0&&null!=t[i][o-1]&&e[t[i][o-1].type])&&(r=!0)),s.node.style.borderRightWidth=a?"1px":"0px",s.node.style.borderTopRightRadius=s.node.style.borderBottomRightRadius=a?this.conf.terrace_radius:"0px","buttonSelect"==s.type?(s.node.previousSibling.style.borderTopLeftRadius=s.node.previousSibling.style.borderBottomLeftRadius=r?this.conf.terrace_radius:"0px",s.node.previousSibling._br=a,s.node.previousSibling._bl=r):s.node.style.borderTopLeftRadius=s.node.style.borderBottomLeftRadius=r?this.conf.terrace_radius:"0px",s.node._br=a,s.node._bl=r}for(i=0;i<t.length;i++){for(o=0;o<t[i].length;o++){for(var l in t[i][o])t[i][o][l]=null;t[i][o]=null}t[i]=null}t=n=null},dhtmlXToolbarObject.prototype._improveTerraceButtonSelect=function(t,e){var n=this.objPull[t];1==e?(n.obj.style.borderBottomLeftRadius=n.obj._bl?this.conf.terrace_radius:"0px",n.arw.style.borderBottomRightRadius=n.obj._br?this.conf.terrace_radius:"0px"):(n.obj.style.borderBottomLeftRadius="0px",n.arw.style.borderBottomRightRadius="0px"),n=null},void 0!==window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_toolbar=function(t,e,n,i,o){return void 0!==o?t=o:((t=document.createElement("DIV")).className="dhx_cell_toolbar_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV")),t.firstChild.className="dhx_toolbar_base_18_dhx_skyblue"),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.cont]),this.conf.ofs_nodes.t.toolbar=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachToolbar=function(t){if(null==this.dataNodes.ribbon&&null==this.dataNodes.toolbar)return this.callEvent("_onBeforeContentAttach",["toolbar"]),void 0===t?t={}:"string"==typeof t&&(t={skin:t}),void 0===t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("toolbar").firstChild,this.dataNodes.toolbar=new dhtmlXToolbarObject(t),this._adjustCont(this._idd),this.dataNodes.toolbar._masterCell=this,this.dataNodes.toolbar.attachEvent("_onIconSizeChange",function(){this._masterCell._adjustCont()}),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.toolbar},dhtmlXCellObject.prototype.detachToolbar=function(){this.dataNodes.toolbar&&(this.dataNodes.toolbar._masterCell=null,this.dataNodes.toolbar.unload(),this.dataNodes.toolbar=null,delete this.dataNodes.toolbar,this._detachObject("toolbar"))},dhtmlXCellObject.prototype.showToolbar=function(){this._mtbShowHide("toolbar","")},dhtmlXCellObject.prototype.hideToolbar=function(){this._mtbShowHide("toolbar","none")},dhtmlXCellObject.prototype.getAttachedToolbar=function(){return this.dataNodes.toolbar}),module.exports=dhtmlXToolbarObject;

},{}],5:[function(require,module,exports){
function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function dhtmlXMenuObject(t,e){var i=this;if(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxmenu")||"dhx_skyblue",mode:"web",align:"left",is_touched:!1,selected:-1,last_click:-1,fixed_pos:!1,rtl:!1,icons_path:"",arrow_ff_fix:navigator.userAgent.indexOf("MSIE")>=0&&"BackCompat"==document.compatMode,live_id:window.dhx4.newId(),tags:{root:"menu",item:"item",text_ext:"itemtext",userdata:"userdata",tooltip:"tooltip",hotkey:"hotkey",href:"href"},autoload:{},hide_tm:{},top_mode:!0,top_tmtime:200,v_enabled:!1,v:{x1:null,x2:null,y1:null,y2:null},dir_toplv:"bottom",dir_sublv:"right",auto_overflow:!1,overflow_limit:0,of_utm:null,of_utime:20,of_ustep:3,of_dtm:null,of_dtime:20,of_dstep:3,of_ah:{dhx_skyblue:24,dhx_web:25,dhx_terrace:27},of_ih:{dhx_skyblue:24,dhx_web:24,dhx_terrace:24},tm_sec:400,tm_handler:null,dload:!1,dload_url:"",dload_icon:!1,dload_params:{action:"loadMenu"},dload_pid:"parentId",tl_botmarg:1,tl_rmarg:0,tl_ofsleft:1,context:!1,ctx_zoneid:!1,ctx_autoshow:!0,ctx_autohide:!0,ctx_hideall:!0,ctx_zones:{},ctx_baseid:null,selected_sub:[],opened_poly:[]},"object"==typeof t&&null!=t&&void 0===t.tagName){null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.skin&&(this.conf.skin=t.skin),t.visible_area&&(this.conf.v_enabled=!0,this.conf.v={x1:t.visible_area.x1,x2:t.visible_area.x2,y1:t.visible_area.y1,y2:t.visible_area.y2});for(var l in{json:1,xml:1,items:1,top_text:1,align:1,open_mode:1,overflow:1,dynamic:1,dynamic_icon:1,context:1,onload:1,onclick:1,oncheckboxclick:1,onradioclick:1})null!=t[l]&&(this.conf.autoload[l]=t[l]);t=t.parent}if(null==t)this.base=document.body;else{var n="string"==typeof t?document.getElementById(t):t;null!=n?(this.base=n,this.base.id||(this.base.id=(new Date).valueOf()),this.base.className+=" dhtmlxMenu_"+this.conf.skin+"_Middle dir_left",this.base._autoSkinUpdate=!0,this.base.oncontextmenu&&(this.base._oldContextMenuHandler=this.base.oncontextmenu),this.conf.ctx_baseid=this.base.id,this.base.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.base.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1}):this.base=document.body}this.idPrefix="",this.topId="dhxWebMenuTopId",this.idPull={},this.itemPull={},this.userData={},this.radio={},this.setSkin=function(t){var e=this.conf.skin;switch(this.conf.skin=t,this.conf.skin){case"dhx_skyblue":case"dhx_web":this.conf.tl_botmarg=2,this.conf.tl_rmarg=1,this.conf.tl_ofsleft=1;break;case"dhx_terrace":this.conf.tl_botmarg=0,this.conf.tl_rmarg=0,this.conf.tl_ofsleft=0}this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+e+"_Middle","")+" dhtmlxMenu_"+this.conf.skin+"_Middle");for(var i in this.idPull)this.idPull[i].className=String(this.idPull[i].className).replace(e,this.conf.skin)},this.setSkin(this.conf.skin),this._addSubItemToSelected=function(t,e){for(var i=!0,l=0;l<this.conf.selected_sub.length;l++)this.conf.selected_sub[l][0]==t&&this.conf.selected_sub[l][1]==e&&(i=!1);return 1==i&&this.conf.selected_sub.push(new Array(t,e)),i},this._removeSubItemFromSelected=function(t,e){for(var i=new Array,l=!1,n=0;n<this.conf.selected_sub.length;n++)this.conf.selected_sub[n][0]==t&&this.conf.selected_sub[n][1]==e?l=!0:i[i.length]=this.conf.selected_sub[n];return 1==l&&(this.conf.selected_sub=i),l},this._getSubItemToDeselectByPolygon=function(t){for(var e=new Array,i=0;i<this.conf.selected_sub.length;i++)if(this.conf.selected_sub[i][1]==t){e[e.length]=this.conf.selected_sub[i][0],e=e.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[i][0]));for(var l=!0,n=0;n<this.conf.opened_poly.length;n++)this.conf.opened_poly[n]==this.conf.selected_sub[i][0]&&(l=!1);1==l&&(this.conf.opened_poly[this.conf.opened_poly.length]=this.conf.selected_sub[i][0]),this.conf.selected_sub[i][0]=-1,this.conf.selected_sub[i][1]=-1}return e},this._hidePolygon=function(t){if(null!=this.idPull["polygon_"+t]){if(null!=this.idPull["polygon_"+t]._zId&&window.dhx4.zim.clear(this.idPull["polygon_"+t]._zId),void 0!==this._menuEffect&&!1!==this._menuEffect)this._hidePolygonEffect("polygon_"+t);else{if("none"==this.idPull["polygon_"+t].style.display)return;this.idPull["polygon_"+t].style.display="none",null!=this.idPull["arrowup_"+t]&&(this.idPull["arrowup_"+t].style.display="none"),null!=this.idPull["arrowdown_"+t]&&(this.idPull["arrowdown_"+t].style.display="none"),this._updateItemComplexState(t,!0,!1),window.dhx4.isIE6&&null!=this.idPull["polygon_"+t+"_ie6cover"]&&(this.idPull["polygon_"+t+"_ie6cover"].style.display="none")}(t=String(t).replace(this.idPrefix,""))==this.topId&&(t=null),this.callEvent("onHide",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!0)}},this._showPolygon=function(t,e){var i=this._countVisiblePolygonItems(t);if(0!=i){var l="polygon_"+t;if(null!=this.idPull[l]&&null!=this.idPull[t]){if(this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context&&!this.idPull[t]._mouseOver&&e==this.conf.dir_toplv)return;this.conf.fixed_pos||this._autoDetectVisibleArea();var n=0,o=0,s=null,d=null;if(null==this.idPull[l]._zId&&(this.idPull[l]._zId=window.dhx4.newId()),this.idPull[l]._zInd=window.dhx4.zim.reserve(this.idPull[l]._zId),this.idPull[l].style.visibility="hidden",this.idPull[l].style.left="0px",this.idPull[l].style.top="0px",this.idPull[l].style.display="",this.idPull[l].style.zIndex=this.idPull[l]._zInd,this.conf.auto_overflow)if(this.idPull[l].childNodes[1].childNodes[0].offsetHeight>this.conf.v.y1+this.conf.v.y2){var r=Math.floor((this.conf.v.y2-this.conf.v.y1-2*this.conf.of_ah[this.conf.skin])/this.conf.of_ih[this.conf.skin]);this.conf.overflow_limit=r}else this.conf.overflow_limit=0,null!=this.idPull["arrowup_"+t]&&this._removeUpArrow(String(t).replace(this.idPrefix,"")),null!=this.idPull["arrowdown_"+t]&&this._removeDownArrow(String(t).replace(this.idPrefix,""));if(this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(null==this.idPull["arrowup_"+t]&&this._addUpArrow(String(t).replace(this.idPrefix,"")),null==this.idPull["arrowdown_"+t]&&this._addDownArrow(String(t).replace(this.idPrefix,"")),(s=this.idPull["arrowup_"+t]).style.display="none",(d=this.idPull["arrowdown_"+t]).style.display="none"),this.conf.overflow_limit>0&&(this.conf.overflow_limit<i?(this.idPull[l].childNodes[1].style.height=24*this.conf.overflow_limit+"px",s.style.width=d.style.width=this.idPull[l].childNodes[1].style.width=this.idPull[l].childNodes[1].childNodes[0].offsetWidth+"px",this.idPull[l].childNodes[1].scrollTop=0,s.style.display="",n=s.offsetHeight,d.style.display="",o=d.offsetHeight):(this.idPull[l].childNodes[1].style.height="",this.idPull[l].childNodes[1].style.width="")),null!=this.itemPull[t])this.itemPull[t].parent;else if(this.conf.context)this.idPull[this.idPrefix+this.topId];var a=null!=this.idPull[t].tagName?window.dhx4.absLeft(this.idPull[t]):this.idPull[t][0],h=null!=this.idPull[t].tagName?window.dhx4.absTop(this.idPull[t]):this.idPull[t][1],u=null!=this.idPull[t].tagName?this.idPull[t].offsetWidth:0,c=null!=this.idPull[t].tagName?this.idPull[t].offsetHeight:0,m=0,f=0,p=this.idPull[l].offsetWidth,_=this.idPull[l].childNodes[1].offsetHeight+n+o;if("bottom"==e&&(m=this.conf.rtl?a+(null!=u?u:0)-p:"right"==this.conf.align?a+u-p:a-1+(e==this.conf.dir_toplv?this.conf.tl_rmarg:0),f=h-1+c+this.conf.tl_botmarg),"right"==e&&(m=a+u-1,f=h+2),"left"==e&&(m=a-this.idPull[l].offsetWidth+2,f=h+2),"top"==e&&(m=a-1,f=h-_+2),this.conf.fixed_pos)var g=65536,x=65536;else{g=null!=this.conf.v.x2?this.conf.v.x2:0,x=null!=this.conf.v.y2?this.conf.v.y2:0;0==g&&(window.innerWidth?(g=window.innerWidth,x=window.innerHeight):(g=document.body.offsetWidth,x=document.body.scrollHeight))}if(m+p>g&&!this.conf.rtl&&(m=a-p+2),m<this.conf.v.x1&&this.conf.rtl&&(m=a+u-2),m<0&&(m=0),f+_>x&&null!=this.conf.v.y2&&(f=Math.max(h+c-_+2,this.conf.v_enabled?this.conf.v.y1+2:2),this.conf.context&&this.idPrefix+this.topId==t&&null!=d&&(f-=2),null==this.itemPull[t]||this.conf.context||this.itemPull[t].parent==this.idPrefix+this.topId&&(f-=this.base.offsetHeight)),this.idPull[l].style.left=m+"px",this.idPull[l].style.top=f+"px",void 0!==this._menuEffect&&!1!==this._menuEffect)this._showPolygonEffect(l);else if(this.idPull[l].style.visibility="",this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(this.idPull[l].childNodes[1].scrollTop=0,this._checkArrowsState(t)),window.dhx4.isIE6){var v=l+"_ie6cover";if(null==this.idPull[v]){var P=document.createElement("IFRAME");P.className="dhtmlxMenu_IE6CoverFix_"+this.conf.skin,P.frameBorder=0,P.setAttribute("src","javascript:false;"),document.body.insertBefore(P,document.body.firstChild),this.idPull[v]=P}this.idPull[v].style.left=m+"px",this.idPull[v].style.top=f+"px",this.idPull[v].style.width=this.idPull[l].offsetWidth+"px",this.idPull[v].style.height=this.idPull[l].offsetHeight+"px",this.idPull[v].style.zIndex=this.idPull[l].style.zIndex-1,this.idPull[v].style.display=""}(t=String(t).replace(this.idPrefix,""))==this.topId&&(t=null),this.callEvent("onShow",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!1)}}},this._redistribSubLevelSelection=function(t,e){for(;this.conf.opened_poly.length>0;)this.conf.opened_poly.pop();var i=this._getSubItemToDeselectByPolygon(e);this._removeSubItemFromSelected(-1,-1);for(var l=0;l<i.length;l++)null!=this.idPull[i[l]]&&i[l]!=t&&"enabled"==this.itemPull[i[l]].state&&(this.idPull[i[l]].className="sub_item");for(l=0;l<this.conf.opened_poly.length;l++)this.conf.opened_poly[l]!=e&&this._hidePolygon(this.conf.opened_poly[l]);if("enabled"==this.itemPull[t].state){if(this.idPull[t].className="sub_item_selected",this.itemPull[t].complex&&this.conf.dload&&"no"==this.itemPull[t].loaded){1==this.conf.dload_icon&&this._updateLoaderIcon(t,!0),this.itemPull[t].loaded="get";var n=t.replace(this.idPrefix,"");this._dhxdataload.onBeforeXLS=function(){var t={params:{}};t.params[this.conf.dload_pid]=n;for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)}(this.itemPull[t].complex||this.conf.dload&&"yes"==this.itemPull[t].loaded)&&this.itemPull[t].complex&&null!=this.idPull["polygon_"+t]&&(this._updateItemComplexState(t,!0,!0),this._showPolygon(t,this.conf.dir_sublv)),this._addSubItemToSelected(t,e),this.conf.selected=t}},this._doOnClick=function(t,e,i){if(this.conf.last_click=t,null!=this.itemPull[this.idPrefix+t].href_link&&"enabled"==this.itemPull[this.idPrefix+t].state){var l=document.createElement("FORM"),n=String(this.itemPull[this.idPrefix+t].href_link).split("?");if(l.action=n[0],null!=n[1])for(var o=String(n[1]).split("&"),s=0;s<o.length;s++){var d=String(o[s]).split("="),r=document.createElement("INPUT");r.type="hidden",r.name=d[0]||"",r.value=d[1]||"",l.appendChild(r)}return null!=this.itemPull[this.idPrefix+t].href_target&&(l.target=this.itemPull[this.idPrefix+t].href_target),l.style.display="none",document.body.appendChild(l),l.submit(),void(null!=l&&(document.body.removeChild(l),l=null))}if("c"!=e.charAt(0)&&"d"!=e.charAt(1)&&"s"!=e.charAt(2)){if(this.checkEvent("onClick"))this.callEvent("onClick",[t,this.conf.ctx_zoneid,i]);else if("d"==e.charAt(1)||"win"==this.conf.mode&&"t"==e.charAt(2))return;this.conf.context&&this._isContextMenuVisible()&&this.conf.ctx_autohide?this._hideContextMenu():this._clearAndHide&&this._clearAndHide()}},this._doOnTouchMenu=function(t){0==this.conf.is_touched&&(this.conf.is_touched=!0,this.checkEvent("onTouch")&&this.callEvent("onTouch",[t]))},this._searchMenuNode=function(t,e){for(var i=new Array,l=0;l<e.length;l++)if("object"==typeof e[l]){5==e[l].length&&"object"!=typeof e[l][0]&&e[l][0].replace(this.idPrefix,"")==t&&0==l&&(i=e);var n=this._searchMenuNode(t,e[l]);n.length>0&&(i=n)}return i},this._getMenuNodes=function(t){var e=new Array;for(var i in this.itemPull)this.itemPull[i].parent==t&&(e[e.length]=i);return e},this._genStr=function(t){for(var e="",i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",l=0;l<t;l++)e+=i.charAt(Math.round(Math.random()*(i.length-1)));return e},this.getItemType=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:this.itemPull[t].type},this.forEachItem=function(t){for(var e in this.itemPull)t(String(e).replace(this.idPrefix,""))},this._clearAndHide=function(){for(i.conf.selected=-1,i.conf.last_click=-1;i.conf.opened_poly.length>0;)i.conf.opened_poly.pop();for(var t=0;t<i.conf.selected_sub.length;t++){var e=i.conf.selected_sub[t][0];null!=i.idPull[e]&&"enabled"==i.itemPull[e].state&&("sub_item_selected"==i.idPull[e].className&&(i.idPull[e].className="sub_item"),i.idPull[e].className=="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected"&&(null!=i.itemPull[e].cssNormal?i.idPull[e].className=i.itemPull[e].cssNormal:i.idPull[e].className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal")),i._hidePolygon(e)}i.conf.is_touched=!1,i.conf.context&&i.conf.ctx_hideall&&i._hidePolygon(i.idPrefix+i.topId)},this._showSubLevelItem=function(t,e){null!=document.getElementById("arrow_"+this.idPrefix+t)&&(document.getElementById("arrow_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById("image_"+this.idPrefix+t)&&(document.getElementById("image_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById(this.idPrefix+t)&&(document.getElementById(this.idPrefix+t).style.display=e?"":"none")},this._hideSubLevelItem=function(t){this._showSubLevelItem(t,!0)},this.idPrefix=this._genStr(12)+"_",this._bodyClick=function(t){2==(t=t||event).button||window.dhx4.isOpera&&1==t.ctrlKey||(i.conf.context?i.conf.ctx_autohide&&(!window.dhx4.isOpera||i._isContextMenuVisible()&&window.dhx4.isOpera)&&i._hideContextMenu():i._clearAndHide&&i._clearAndHide())},this._bodyContext=function(t){t=t||event;var e=String((t.srcElement||t.target).className);if(-1==e.search("dhtmlxMenu")||-1==e.search("SubLevelArea")){for(var l=!0,n=t.target||t.srcElement;null!=n;)null!=n.id&&i.isContextZone(n.id)&&(l=!1),n==document.body&&(l=!1),n=n.parentNode;l&&i.hideContextMenu()}},void 0!==window.addEventListener?(window.addEventListener("click",this._bodyClick,!1),window.addEventListener("contextmenu",this._bodyContext,!1)):(document.body.attachEvent("onclick",this._bodyClick),document.body.attachEvent("oncontextmenu",this._bodyContext)),this.unload=function(){window.dhx4._eventable(this,"clear"),dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=null;try{delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]}catch(t){}if(this.conf.live_id=null,"function"==typeof window.addEventListener?(window.removeEventListener("click",this._bodyClick,!1),window.removeEventListener("contextmenu",this._bodyContext,!1)):(document.body.detachEvent("onclick",this._bodyClick),document.body.detachEvent("oncontextmenu",this._bodyContext)),this._bodyClick=null,this._bodyContext=null,this.removeItem(this.idPrefix+this.topId,!0),this.itemPull=null,this.idPull=null,this.conf.context)for(var t in this.conf.ctx_zones)this.removeContextZone(t);null!=this.cont&&(this.cont.className="",this.cont.parentNode.removeChild(this.cont),this.cont=null),null!=this.base&&(this.conf.context||(this.base.className=""),this.conf.context||(this.base.oncontextmenu=this.base._oldContextMenuHandler||null),this.base.onselectstart=null,this.base=null);for(var t in this)this[t]=null;i=null},dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=this,window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson",this.conf.tags.root,{struct:!0}),window.dhx4._eventable(this),1==window.dhx4.s2b(this.conf.autoload.context)&&this.renderAsContextMenu(),null!=this.conf.autoload.dynamic?this.enableDynamicLoading(this.conf.autoload.dynamic,window.dhx4.s2b(this.conf.autoload.dynamic_icon)):null!=this.conf.autoload.items?this.loadStruct(this.conf.autoload.items,this.conf.autoload.onload):null!=this.conf.autoload.json?this.loadStruct(this.conf.autoload.json,this.conf.autoload.onload):null!=this.conf.autoload.xml&&this.loadStruct(this.conf.autoload.xml,this.conf.autoload.onload);for(var l in{onclick:1,oncheckboxclick:1,onradioclick:1})null!=this.conf.autoload[l]&&("function"==typeof this.conf.autoload[l]?this.attachEvent(l,this.conf.autoload[l]):"function"==typeof window[this.conf.autoload[l]]&&this.attachEvent(l,window[this.conf.autoload[l]]));null!=this.conf.autoload.top_text&&this.setTopText(this.conf.autoload.top_text),null!=this.conf.autoload.align&&this.setAlign(this.conf.autoload.align),null!=this.conf.autoload.open_mode&&this.setOpenMode(this.conf.autoload.open_mode),null!=this.conf.autoload.overflow&&this.setOverflowHeight(this.conf.autoload.overflow);for(var l in this.conf.autoload)this.conf.autoload[l]=null,delete this.conf.autoload[l];return this.conf.autoload=null,this}if(void 0===window.dhx4&&(window.dhx4={version:"4.2.1",skin:null,skinDetect:function(t){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(t+"_skin_detect")]||null},readFromCss:function(t,e){var i=document.createElement("DIV");i.className=t,null!=document.body.firstChild?document.body.insertBefore(i,document.body.firstChild):document.body.appendChild(i);var l=i[e||"offsetWidth"];return i.parentNode.removeChild(i),i=null,l},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var t=this.first();for(var e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(t){return this.data[t]=this.last()+this.step,this.data[t]},clear:function(t){null!=this.data[t]&&(this.data[t]=null,delete this.data[t])}},s2b:function(t){return"string"==typeof t&&(t=t.toLowerCase()),1==t||1==t||"true"==t||"1"==t||"yes"==t||"y"==t},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(t){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).left},absTop:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).top},_aOfs:function(t){for(var e=0,i=0;t;)e+=parseInt(t.offsetTop),i+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:i}},_aOfsRect:function(t){var e=t.getBoundingClientRect(),i=document.body,l=document.documentElement,n=window.pageYOffset||l.scrollTop||i.scrollTop,o=window.pageXOffset||l.scrollLeft||i.scrollLeft,s=l.clientTop||i.clientTop||0,d=l.clientLeft||i.clientLeft||0,r=e.top+n-s,a=e.left+o-d;return{top:Math.round(r),left:Math.round(a)}},getOffset:function(t){return t.getBoundingClientRect?this._aOfsRect(t):this._aOfs(t)},_isObj:function(t){return null!=t&&"object"==typeof t&&void 0===t.length},_copyObj:function(t){if(this._isObj(t)){var e={};for(var i in t)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i]}else for(e=[],i=0;i<t.length;i++)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i];return e},screenDim:function(){var t=navigator.userAgent.indexOf("MSIE")>=0,e={};return e.left=document.body.scrollLeft,e.right=e.left+(window.innerWidth||document.body.clientWidth),e.top=Math.max((t?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),e.bottom=e.top+(t?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),e},selectTextRange:function(t,e,i){var l=(t="string"==typeof t?document.getElementById(t):t).value.length;if(e=Math.max(Math.min(e,l),0),i=Math.min(i,l),t.setSelectionRange)try{t.setSelectionRange(e,i)}catch(t){}else if(t.createTextRange){var n=t.createTextRange();n.moveStart("character",e),n.moveEnd("character",i-l);try{n.select()}catch(t){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData},_xmlNodeValue:function(t){for(var e="",i=0;i<t.childNodes.length;i++)e+=null!=t.childNodes[i].nodeValue?t.childNodes[i].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return e}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0,window.dhx4.isKHTML=navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0),void 0===window.dhx4.template&&(window.dhx4.trim=function(t){return String(t).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(t,e,i){return t.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var t=arguments[1],l=window.dhx4.trim(arguments[3]),n=null,o=[e[t]];if(l.length>0){l=l.split(":");for(var s=[],d=0;d<l.length;d++)d>0&&null!=s[s.length-1].match(/\\$/)?s[s.length-1]=s[s.length-1].replace(/\\$/,"")+":"+l[d]:s.push(l[d]);n=s[0];for(d=1;d<s.length;d++)o.push(s[d])}return"string"==typeof n&&"function"==typeof window.dhx4.template[n]?window.dhx4.template[n].apply(window.dhx4.template,o):t.length>0&&void 0!==e[t]?1==i?window.dhx4.trim(e[t]):String(e[t]):""})},window.dhx4.template.date=function(t,e){return null!=t?t instanceof Date?window.dhx4.date2str(t,e):null!=(t=t.toString()).match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(t)),e):t:""},window.dhx4.template.maxlength=function(t,e){return String(t).substr(0,e)},window.dhx4.template.number_format=function(t,e,i,l){var n=window.dhx4.template._parseFmt(e,i,l);return 0==n?t:window.dhx4.template._getFmtValue(t,n)},window.dhx4.template.lowercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toLowerCase()},window.dhx4.template.uppercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toUpperCase()},window.dhx4.template._parseFmt=function(t,e,i){var l=t.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(null==l||4!=l.length)return!1;var n={i_len:!1,i_sep:"string"==typeof e?e:",",d_len:!1,d_sep:"string"==typeof i?i:".",s_bef:"string"==typeof l[1]?l[1]:"",s_aft:"string"==typeof l[3]?l[3]:""},o=l[2].split(".");null!=o[1]&&(n.d_len=o[1].length);var s=o[0].split(",");return s.length>1&&(n.i_len=s[s.length-1].length),n},window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){var v0="";if(null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,!1!==fmt.i_len){for(var i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(!1!==fmt.d_len){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=r[4].match(dhx4.temp);null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft}return value}),void 0===window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(t,e,i){if(null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]),t instanceof Date)var l=function(t){return 1==String(t).length?"0"+String(t):t},n=function(e){switch(e){case"%d":return l(t.getDate());case"%j":return t.getDate();case"%D":return i.dayShortName[t.getDay()];case"%l":return i.dayFullName[t.getDay()];case"%m":return l(t.getMonth()+1);case"%n":return t.getMonth()+1;case"%M":return i.monthShortName[t.getMonth()];case"%F":return i.monthFullName[t.getMonth()];case"%y":return l(t.getYear()%100);case"%Y":return t.getFullYear();case"%g":return(t.getHours()+11)%12+1;case"%h":return l((t.getHours()+11)%12+1);case"%G":return t.getHours();case"%H":return l(t.getHours());case"%i":return l(t.getMinutes());case"%s":return l(t.getSeconds());case"%a":return t.getHours()>11?"pm":"am";case"%A":return t.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return t.getMilliseconds();case"%P":if(null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz)return window.dhx4.temp_calendar.tz;var n=t.getTimezoneOffset(),o=Math.abs(Math.floor(n/60)),s=Math.abs(n)-60*o;return(n>0?"-":"+")+l(o)+":"+l(s);default:return e}},o=String(e||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,n);return o||String(t)},window.dhx4.str2date=function(t,e,i){null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]);var l=[],n=[];e=(e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&")).replace(/%[a-z]/gi,function(t){switch(t){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return n.push(t),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return n.push(t),"([a-zéûäа-яё]{1,})";case"%j":case"%n":case"%g":case"%G":return n.push(t),"(\\d{1,2})";case"%Y":return n.push(t),"(\\d{4})";case"%a":return n.push(t),"([am|pm])";case"%A":return n.push(t),"([AM|PM])";case"%u":return n.push(t),"(\\d{1,6})";case"%P":return n.push(t),"([+-]\\d{1,2}:\\d{1,2})"}return t});var o=new RegExp(e,"i"),s=t.match(o);if(null==s||s.length-1!=n.length)return"Invalid Date";for(var d=1;d<s.length;d++)l.push(s[d]);var r={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},a={},h={};for(d=0;d<n.length;d++)if(void 0!==r[n[d]]){var u=r[n[d]];a[u]||(a[u]=[],h[u]=[]),a[u].push(l[d]),h[u].push(n[d])}l=[],n=[];for(d=1;d<=7;d++)if(null!=a[d])for(var c=0;c<a[d].length;c++)l.push(a[d][c]),n.push(h[d][c]);var m=new Date;m.setDate(1),m.setHours(0),m.setMinutes(0),m.setSeconds(0),m.setMilliseconds(0);var f=function(t,e){for(var i=0;i<e.length;i++)if(e[i].toLowerCase()==t)return i;return-1};for(d=0;d<l.length;d++)switch(n[d]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(l[d])||m[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[n[d]]](Number(l[d])+("%m"==n[d]||"%n"==n[d]?-1:0));break;case"%M":case"%F":var p=f(l[d].toLowerCase(),i[{"%M":"monthShortName","%F":"monthFullName"}[n[d]]]);p>=0&&m.setMonth(p);break;case"%y":if(!isNaN(l[d])){var _=Number(l[d]);m.setFullYear(_+(_>50?1900:2e3))}break;case"%g":case"%h":if(!isNaN(l[d])){(_=Number(l[d]))<=12&&_>=0&&m.setHours(_+(f("pm",l)>=0?12==_?0:12:12==_?-12:0))}break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=l[d])}return m}),void 0===window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(t){if("string"!=typeof t)return t;if(t=t.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE)var e=(new window.DOMParser).parseFromString(t,"text/xml");else if(window.ActiveXObject!==window.undefined){(e=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)}return e},xmltop:function(t,e,i){if((void 0===e.status||e.status<400)&&(xml=e.responseXML?e.responseXML||e:dhx4.ajax.parse(e.responseText||e),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(t)[0]}catch(t){}return-1!==i&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],i]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),!dhx4.isIE){for(var i,l=[],n=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);i=n.iterateNext();)l.push(i);return l}try{return e.selectNodes(t)||[]}catch(t){return[]}},query:function(t){dhx4.ajax._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,null,t.headers)},get:function(t,e){return this._call("GET",t,null,!0,e)},getSync:function(t){return this._call("GET",t,null,!1)},put:function(t,e,i){return this._call("PUT",t,e,!0,i)},del:function(t,e,i){return this._call("DELETE",t,e,!0,i)},post:function(t,e,i){return 1==arguments.length?e="":2!=arguments.length||"function"!=typeof e&&"function"!=typeof window[e]?e=String(e):(i=e,e=""),this._call("POST",t,e,!0,i)},postSync:function(t,e){return e=null==e?"":String(e),this._call("POST",t,e,!1)},getLong:function(t,e){this._call("GET",t,null,!0,e,{url:t})},postLong:function(t,e,i){2!=arguments.length||"function"!=typeof e&&(window[e],0)||(i=e,e=""),this._call("POST",t,e,!0,i,{url:t,postData:e})},_call:function(t,e,i,l,n,o,s){var d=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==l&&(d.onreadystatechange=function(){if(4==d.readyState||1==r&&3==d.readyState){if((200!=d.status||""==d.responseText)&&!dhx4.callEvent("onAjaxError",[d]))return;window.setTimeout(function(){"function"==typeof n&&n.apply(window,[{xmlDoc:d,filePath:e,async:l}]),null!=o&&(void 0!==o.postData?dhx4.ajax.postLong(o.url,o.postData,n):dhx4.ajax.getLong(o.url,n)),n=null,d=null},1)}}),"GET"==t&&1!=this.cache&&(e+=(e.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),d.open(t,e,l),null!=s)for(var a in s)d.setRequestHeader(a,s[a]);else"POST"==t||"PUT"==t||"DELETE"==t?d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==t&&(i=null);return d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.send(i),{xmlDoc:d,filePath:e,async:l}}}),void 0===window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(t,e,i,l,n){if("clear"==n){for(var o in t._dhxdataload)t._dhxdataload[o]=null,delete t._dhxdataload[o];return t._loadData=null,t._dhxdataload=null,t.load=null,t.loadStruct=null,void(t=null)}if(t._dhxdataload={initObj:e,xmlToJson:i,xmlRootTag:l,onBeforeXLS:null},t._loadData=function(t,e,i){2==arguments.length&&(i=e,e=null);var l=null;if(3==arguments.length&&(i=arguments[2]),"string"==typeof t){var n=t.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");if(new RegExp("^<"+this._dhxdataload.xmlRootTag).test(n.replace(/^<\?xml[^\?]*\?>\s*/,""))&&null!=(l=dhx4.ajax.parse(t))&&(l=this[this._dhxdataload.xmlToJson].apply(this,[l])),null!=l||null==n.match(/^\{.*\}$/)&&null==n.match(/^\[.*\]$/)||(l=dhx4.s2j(n)),null==l){this.callEvent("onXLS",[]);var o=[];if("function"==typeof this._dhxdataload.onBeforeXLS){if(null!=(n=this._dhxdataload.onBeforeXLS.apply(this,[t]))&&"object"==typeof n&&(null!=n.url&&(t=n.url),null!=n.params))for(var s in n.params)o.push(s+"="+encodeURIComponent(n.params[s]))}var d=this,r=function(e){var l=null;null!=(l=(e.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=e.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?d[d._dhxdataload.xmlToJson].apply(d,[e.xmlDoc.responseXML]):dhx4.s2j(e.xmlDoc.responseText))&&d[d._dhxdataload.initObj].apply(d,[l,t]),d.callEvent("onXLE",[]),null!=i&&("function"==typeof i?i.apply(d,[]):"function"==typeof window[i]&&window[i].apply(d,[])),r=i=null,l=e=d=null};return o=o.join("&")+("string"==typeof e?"&"+e:""),void("post"==dhx4.ajax.method?dhx4.ajax.post(t,o,r):"get"==dhx4.ajax.method&&dhx4.ajax.get(t+(o.length>0?(t.indexOf("?")>0?"&":"?")+o:""),r))}}else l="object"==typeof t.documentElement||void 0!==t.tagName&&void 0!==t.getElementsByTagName&&t.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[t]):window.dhx4._copyObj(t);null!=l&&this[this._dhxdataload.initObj].apply(this,[l]),null!=i&&("function"==typeof i?i.apply(this,[]):"function"==typeof window[i]&&window[i].apply(this,[]),i=null)},null!=n){var s={struct:"loadStruct",data:"load"};for(var o in n)1==n[o]&&(t[s[o]]=function(){return this._loadData.apply(this,arguments)})}t=null}),void 0===window.dhx4._eventable&&(window.dhx4._eventable=function(t,e){if("clear"==e)return t.detachAllEvents(),t.dhxevs=null,t.attachEvent=null,t.detachEvent=null,t.checkEvent=null,t.callEvent=null,t.detachAllEvents=null,void(t=null);t.dhxevs={data:{}},t.attachEvent=function(t,e){t=String(t).toLowerCase(),this.dhxevs.data[t]||(this.dhxevs.data[t]={});var i=window.dhx4.newId();return this.dhxevs.data[t][i]=e,i},t.detachEvent=function(t){for(var e in this.dhxevs.data){var i=0;for(var l in this.dhxevs.data[e])l==t?(this.dhxevs.data[e][l]=null,delete this.dhxevs.data[e][l]):i++;0==i&&(this.dhxevs.data[e]=null,delete this.dhxevs.data[e])}},t.checkEvent=function(t){return t=String(t).toLowerCase(),null!=this.dhxevs.data[t]},t.callEvent=function(t,e){if(t=String(t).toLowerCase(),null==this.dhxevs.data[t])return!0;var i=!0;for(var l in this.dhxevs.data[t])i=this.dhxevs.data[t][l].apply(this,e)&&i;return i},t.detachAllEvents=function(){for(var t in this.dhxevs.data){for(var e in this.dhxevs.data[t])this.dhxevs.data[t][e]=null,delete this.dhxevs.data[t][e];this.dhxevs.data[t]=null,delete this.dhxevs.data[t]}},t=null},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(t){return""==t},isNotEmpty:function(t){return t instanceof Array?t.length>0:""==!t},isValidBoolean:function(t){return!!t.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(t){return!!t.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(t){return!!t.toString().match(/(^-?\d+$)/)},isValidNumeric:function(t){return!!t.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(t){return!!t.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31&&e[4]<=59&&e[5]<=59&&e[6]<=59)||!1},isValidDate:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31)||!1},isValidTime:function(t){var e=t.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return e&&!!(e[1]<=24&&e[2]<=59&&e[3]<=59)||!1},isValidIPv4:function(t){var e=t.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return e&&!!(e[1]<=255&&e[2]<=255&&e[3]<=255&&e[4]<=255)||!1},isValidCurrency:function(t){return!!t.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)},isValidSSN:function(t){return!!t.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)},isValidSIN:function(t){return!!t.toString().match(/^\d{9}$/)}},dhtmlxValidation=new dhtmlxValidation),void 0===window.dhtmlx&&(window.dhtmlx={extend:function(t,e){for(var i in e)t[i]||(t[i]=e[i]);return t},extend_api:function(t,e,i){var l=window[t];l&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var i=l.apply(this,e._init?e._init(t):arguments);for(var n in dhtmlx)e[n]&&this[e[n]](dhtmlx[n]);for(var n in t)e[n]?this[e[n]](t[n]):0===n.indexOf("on")&&this.attachEvent(n,t[n])}else i=l.apply(this,arguments);return e._patch&&e._patch(this),i||this},window[t].prototype=l.prototype,i&&dhtmlx.extend(window[t].prototype,i))},url:function(t){return-1!=t.indexOf("?")?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){if(!t&&!window.event||2!=(t||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),!(!t||!t.preventDefault)&&(t.preventDefault(),!1))},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var i=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var l=document.createElement("Div");l.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=l.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),i.dhtmlDragAndDrop.dragNode=dragger.dragNode}if(dragger.dragNode.style.left=t.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",t.srcElement)n=t.srcElement;else var n=t.target;dragger.checkLanding(n,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,i=0,l=0;e;)i+=e.offsetLeft,l+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var n=parent.dhtmlDragAndDrop.calculateFramePosition(1);i+=1*n.split("_")[0],l+=1*n.split("_")[1]}if(t)return i+"_"+l;this.fx=i,this.fy=l}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var i=dragger.lastLanding;dragger.lastLanding=null,i&&i.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,i,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(t){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=t&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(t){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),void 0===window.dhtmlxEvent)function dhtmlxEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)}null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),void 0===dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){function t(){if(i){var t=document.createEvent("HTMLEvents");t.initEvent("dblclick",!0,!0),i.dispatchEvent(t),e=i=null}}var e,i,l,n;dhtmlxEvent(document.body,"touchstart",function(o){i=o.touches[0].target,l=o.touches[0].clientX,n=o.touches[0].clientY,e=window.setTimeout(t,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(t){e&&(Math.abs(t.touches[0].clientX-l)>50||Math.abs(t.touches[0].clientY-n)>50)&&(window.clearTimeout(e),e=i=!1)}),dhtmlxEvent(document.body,"touchend",function(t){e&&(window.clearTimeout(e),e=i=!1)}),dhtmlxEvent.initTouch=function(){}}),dhtmlXMenuObject.prototype._init=function(){1!=this._isInited&&(this.conf.dload?(this._dhxdataload.onBeforeXLS=function(){var t={params:{}};for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)):(this._initTopLevelMenu(),this._isInited=!0))},dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(t){var e=0;for(var i in this.itemPull){var l=this.itemPull[i].parent,n=this.itemPull[i].type;null!=this.idPull[i]&&(l!=t||"item"!=n&&"radio"!=n&&"checkbox"!=n||"none"==this.idPull[i].style.display||e++)}return e},dhtmlXMenuObject.prototype._redefineComplexState=function(t){if(this.idPrefix+this.topId!=t&&null!=this.idPull["polygon_"+t]&&null!=this.idPull[t]){var e=this._countVisiblePolygonItems(t);e>0&&!this.itemPull[t].complex&&this._updateItemComplexState(t,!0,!1),0==e&&this.itemPull[t].complex&&this._updateItemComplexState(t,!1,!1)}},dhtmlXMenuObject.prototype._updateItemComplexState=function(t,e,i){if(this.conf.context||"TopLevel"!=this._getItemLevelType(t.replace(this.idPrefix,""))){if(null!=this.idPull[t]&&null!=this.itemPull[t]&&(this.itemPull[t].complex=e,t!=this.idPrefix+this.topId)){var l=null,n=this.idPull[t].childNodes[this.conf.rtl?0:2];if(n.childNodes[0]&&0===String(n.childNodes[0].className).search("complex_arrow")&&(l=n.childNodes[0]),this.itemPull[t].complex){if(null==l){for((l=document.createElement("DIV")).className="complex_arrow",l.id="arrow_"+t;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.appendChild(l)}this.conf.dload&&"get"==this.itemPull[t].loaded&&this.conf.dload_icon?"complex_arrow_loading"!=l.className&&(l.className="complex_arrow_loading"):l.className="complex_arrow"}else this.itemPull[t].complex||null==l||(n.removeChild(l),null!=this.itemPull[t].hotkey_backup&&this.setHotKey&&this.setHotKey(t.replace(this.idPrefix,""),this.itemPull[t].hotkey_backup))}}else this.itemPull[t].complex=e},dhtmlXMenuObject.prototype._getItemLevelType=function(t){return this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"},dhtmlXMenuObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXMenuObject.prototype._updateItemImage=function(t,e){t=this.idPrefix+t;var i=this.itemPull[t].type;if("checkbox"!=i&&"radio"!=i){var l=this.itemPull[t].parent==this.idPrefix+this.topId&&!this.conf.context,n=null;if(l)for(var o=0;o<this.idPull[t].childNodes.length;o++)try{"dhtmlxMenu_TopLevel_Item_Icon"==this.idPull[t].childNodes[o].className&&(n=this.idPull[t].childNodes[o])}catch(t){}else{try{n=this.idPull[t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(t){}null!=n&&void 0!==n.className&&"sub_icon"==n.className||(n=null)}var s=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(s.length>0)if(null!=n)n.src=this.conf.icons_path+s;else if(l){(n=document.createElement("IMG")).className="dhtmlxMenu_TopLevel_Item_Icon",n.src=this.conf.icons_path+s,n.border="0",n.id="image_"+t,!this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(n,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(n)}else{(n=document.createElement("IMG")).className="sub_icon",n.src=this.conf.icons_path+s,n.border="0",n.id="image_"+t;for(var d=this.idPull[t].childNodes[this.conf.rtl?2:0];d.childNodes.length>0;)d.removeChild(d.childNodes[0]);d.appendChild(n)}else if(null!=n){var r=n.parentNode;r.removeChild(n),r.innerHTML="&nbsp;",r=n=null}}},dhtmlXMenuObject.prototype._getAllParents=function(t){var e=new Array;for(var i in this.itemPull)if(this.itemPull[i].parent==t&&(e[e.length]=this.itemPull[i].id,this.itemPull[i].complex))for(var l=this._getAllParents(this.itemPull[i].id),n=0;n<l.length;n++)e[e.length]=l[n];return e},dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){if(!this.conf.v_enabled){var t=window.dhx4.screenDim();this.conf.v.x1=t.left,this.conf.v.x2=t.right,this.conf.v.y1=t.top,this.conf.v.y2=t.bottom}},dhtmlXMenuObject.prototype.getItemPosition=function(t){t=this.idPrefix+t;var e=-1;if(null==this.itemPull[t])return e;for(var i=this.itemPull[t].parent,l=null!=this.idPull["polygon_"+i]?this.idPull["polygon_"+i].tbd:this.cont,n=0;n<l.childNodes.length;n++)l.childNodes[n]!=this.idPull["separator_"+t]&&l.childNodes[n]!=this.idPull[t]||(e=n);return e},dhtmlXMenuObject.prototype.setItemPosition=function(t,e){if(t=this.idPrefix+t,null!=this.idPull[t]){var i=this.itemPull[t].parent==this.idPrefix+this.topId,l=this.idPull[t],n=this.getItemPosition(t.replace(this.idPrefix,"")),o=this.itemPull[t].parent,s=null!=this.idPull["polygon_"+o]?this.idPull["polygon_"+o].tbd:this.cont;s.removeChild(s.childNodes[n]),e<0&&(e=0),i&&e<1&&(e=1),e<s.childNodes.length?s.insertBefore(l,s.childNodes[e]):s.appendChild(l)}},dhtmlXMenuObject.prototype.getParentId=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:(null!=this.itemPull[t].parent?this.itemPull[t].parent:this.topId).replace(this.idPrefix,"")},dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()},dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,!0),this._isInited=!1,this.idPrefix=this._genStr(12)+"_",this.itemPull={}},void 0===dhtmlXMenuObject.prototype.liveInst&&(dhtmlXMenuObject.prototype.liveInst={}),dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(t,e){var i=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var l=0;l<i.length;l++)i[l]!=t&&this._hidePolygon(i[l]),null!=this.idPull[i[l]]&&i[l]!=t&&(this.idPull[i[l]].className=this.idPull[i[l]].className.replace(/Selected/g,"Normal"));"enabled"==this.itemPull[this.idPrefix+t].state&&(this.idPull[this.idPrefix+t].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_Selected",this._addSubItemToSelected(this.idPrefix+t,"parent"),this.conf.selected="win"==this.conf.mode?-1!=this.conf.selected?t:this.conf.selected:t,this.itemPull[this.idPrefix+t].complex&&-1!=this.conf.selected&&this._showPolygon(this.idPrefix+t,this.conf.dir_toplv))},dhtmlXMenuObject.prototype._initTopLevelMenu=function(){if(this.conf.dir_toplv="bottom",this.conf.dir_sublv=this.conf.rtl?"left":"right",this.conf.context)this.idPull[this.idPrefix+this.topId]=new Array(0,0),this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId);else for(var t=this._getMenuNodes(this.idPrefix+this.topId),e=0;e<t.length;e++)"item"==this.itemPull[t[e]].type&&this._renderToplevelItem(t[e],null),"separator"==this.itemPull[t[e]].type&&this._renderSeparator(t[e],null)},dhtmlXMenuObject.prototype._renderToplevelItem=function(t,e){var i=this,l=document.createElement("DIV");if(l.id=t,"enabled"==this.itemPull[t].state&&null!=this.itemPull[t].cssNormal?l.className=this.itemPull[t].cssNormal:l.className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[t].state?"Normal":"Disabled"),""!=this.itemPull[t].title){var n=document.createElement("DIV");n.className="top_level_text",n.innerHTML=this.itemPull[t].title,l.appendChild(n)}if(this.itemPull[t].tip.length>0&&(l.title=this.itemPull[t].tip),""!=this.itemPull[t].imgen||""!=this.itemPull[t].imgdis){var o=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(o){var s=document.createElement("IMG");s.border="0",s.id="image_"+t,s.src=this.conf.icons_path+o,s.className="dhtmlxMenu_TopLevel_Item_Icon",l.childNodes.length>0&&!this.conf.rtl?l.insertBefore(s,l.childNodes[0]):l.appendChild(s)}}l.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},l.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.cont||(this.cont=document.createElement("DIV"),this.cont.dir="ltr",this.cont.className="right"==this.conf.align?"align_right":"align_left",this.base.appendChild(this.cont)),null!=e&&(++e<0&&(e=0),e>this.cont.childNodes.length-1&&(e=null)),null!=e?this.cont.insertBefore(l,this.cont.childNodes[e]):this.cont.appendChild(l),this.idPull[l.id]=l,this.itemPull[t].complex&&!this.conf.dload&&this._addSubMenuPolygon(this.itemPull[t].id,this.itemPull[t].id),l.onmouseover=function(){"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler);var t=i._getSubItemToDeselectByPolygon("parent");i._removeSubItemFromSelected(-1,-1);for(var e=0;e<t.length;e++)t[e]!=this.id&&i._hidePolygon(t[e]),null!=i.idPull[t[e]]&&t[e]!=this.id&&(null!=i.itemPull[t[e]].cssNormal?i.idPull[t[e]].className=i.itemPull[t[e]].cssNormal:("sub_item_selected"==i.idPull[t[e]].className&&(i.idPull[t[e]].className="sub_item"),i.idPull[t[e]].className=i.idPull[t[e]].className.replace(/Selected/g,"Normal")));if("enabled"==i.itemPull[this.id].state){if(this.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected",i._addSubItemToSelected(this.id,"parent"),i.conf.selected="win"==i.conf.mode?-1!=i.conf.selected?this.id:i.conf.selected:this.id,i.conf.dload){if("no"==i.itemPull[this.id].loaded){this._dynLoadTM=(new Date).getTime(),i.itemPull[this.id].loaded="get";var l=this.id.replace(i.idPrefix,"");i._dhxdataload.onBeforeXLS=function(){var t={params:{}};t.params[this.conf.dload_pid]=l;for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},i.loadStruct(i.conf.dload_url)}i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!0)}if((!i.conf.dload||i.conf.dload&&(!i.itemPull[this.id].loaded||"yes"==i.itemPull[this.id].loaded))&&i.itemPull[this.id].complex&&-1!=i.conf.selected)if(i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context){this._mouseOver=!0;var n=this.id;this._menuOpenTM=window.setTimeout(function(){i._showPolygon(n,i.conf.dir_toplv)},i.conf.top_tmtime)}else i._showPolygon(this.id,i.conf.dir_toplv)}i._doOnTouchMenu(this.id.replace(i.idPrefix,""))},l.onmouseout=function(){i.itemPull[this.id].complex&&-1!=i.conf.selected||"enabled"!=i.itemPull[this.id].state||(null!=i.itemPull[this.id].cssNormal?l.className=i.itemPull[this.id].cssNormal:l.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal"),"web"==i.conf.mode&&(window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i._clearAndHide()},i.conf.tm_sec,"JavaScript")),i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!1,window.clearTimeout(this._menuOpenTM))},l.onclick=function(t){if("web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),"web"==i.conf.mode||"disabled"!=i.itemPull[this.id].state){if(t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,"win"==i.conf.mode&&i.itemPull[this.id].complex){if(i.conf.selected==this.id){i.conf.selected=-1;var e=!1}else{i.conf.selected=this.id;e=!0}e?i._showPolygon(this.id,i.conf.dir_toplv):i._hidePolygon(this.id)}var l=i.itemPull[this.id].complex?"c":"-",n="enabled"!=i.itemPull[this.id].state?"d":"-",o={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};return i._doOnClick(this.id.replace(i.idPrefix,""),l+n+"t",o),!1}},"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addSubMenuPolygon=function(t,e){this._renderSublevelPolygon(t,e);var i=this._getMenuNodes(e);for(l=0;l<i.length;l++)"separator"==this.itemPull[i[l]].type?this._renderSeparator(i[l],null):this._renderSublevelItem(i[l],null);if(t==e);else;for(var l=0;l<i.length;l++)this.itemPull[i[l]].complex&&this._addSubMenuPolygon(t,this.itemPull[i[l]].id)},dhtmlXMenuObject.prototype._renderSublevelPolygon=function(t,e){var i=document.createElement("DIV");i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Polygon "+(this.conf.rtl?"dir_right":""),i.dir="ltr",i.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1},i.id="polygon_"+e,i.onclick=function(t){(t=t||event).cancelBubble=!0},i.style.display="none",document.body.insertBefore(i,document.body.firstChild),i.innerHTML='<div style="position:relative;"></div><div style="position: relative; overflow:hidden;"></div><div style="position:relative;"></div>';var l=document.createElement("TABLE");l.className="dhtmlxMebu_SubLevelArea_Tbl",l.cellSpacing=0,l.cellPadding=0,l.border=0;var n=document.createElement("TBODY");return l.appendChild(n),i.childNodes[1].appendChild(l),i.tbl=l,i.tbd=n,this.idPull[i.id]=i,null!=this.sxDacProc&&(this.idPull["sxDac_"+e]=new this.sxDacProc(i,i.className),window.dhx4.isIE?(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeedIE),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCyclesIE)):(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeed),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCycles))),i},dhtmlXMenuObject.prototype._renderSublevelItem=function(t,e){var i=this,l=document.createElement("TR");l.className="enabled"==this.itemPull[t].state?"sub_item":"sub_item_dis";var n=document.createElement("TD");n.className="sub_item_icon";var o=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(""!=o){var s=this.itemPull[t].type;if("checkbox"==s||"radio"==s){(d=document.createElement("DIV")).id="image_"+this.itemPull[t].id,d.className="sub_icon "+o,n.appendChild(d)}if("checkbox"!=s&&"radio"!=s){var d;(d=document.createElement("IMG")).id="image_"+this.itemPull[t].id,d.className="sub_icon",d.src=this.conf.icons_path+o,n.appendChild(d)}}else n.innerHTML="&nbsp;";var r=document.createElement("TD");if(r.className="sub_item_text",""!=this.itemPull[t].title){var a=document.createElement("DIV");a.className="sub_item_text",a.innerHTML=this.itemPull[t].title,r.appendChild(a)}else r.innerHTML="&nbsp;";var h=document.createElement("TD");if(h.className="sub_item_hk",this.itemPull[t].complex){var u=document.createElement("DIV");u.className="complex_arrow",u.id="arrow_"+this.itemPull[t].id,h.appendChild(u)}else if(this.itemPull[t].hotkey.length>0&&!this.itemPull[t].complex){var c=document.createElement("DIV");c.className="sub_item_hk",c.innerHTML=this.itemPull[t].hotkey,h.appendChild(c)}else h.innerHTML="&nbsp;";l.appendChild(this.conf.rtl?h:n),l.appendChild(r),l.appendChild(this.conf.rtl?n:h),l.id=this.itemPull[t].id,l.parent=this.itemPull[t].parent,this.itemPull[t].tip.length>0&&(l.title=this.itemPull[t].tip),l.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},l.onmouseover=function(t){i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),this._visible||i._redistribSubLevelSelection(this.id,this.parent),this._visible=!0},l.onmouseout=function(){"web"==i.conf.mode&&(i.conf.tm_handler&&window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i&&i._clearAndHide&&i._clearAndHide()},i.conf.tm_sec,"JavaScript"));var t=this;i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),i.conf.hide_tm[this.id]=window.setTimeout(function(){t._visible=!1},50)},l.onclick=function(t){if(i.checkEvent("onClick")||!i.itemPull[this.id].complex){(t=t||event).cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,tc=i.itemPull[this.id].complex?"c":"-",td="enabled"==i.itemPull[this.id].state?"-":"d";var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};switch(i.itemPull[this.id].type){case"checkbox":i._checkboxOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"radio":i._radioOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"item":i._doOnClick(this.id.replace(i.idPrefix,""),tc+td+"n",e)}return!1}};var m=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(++e<0&&(e=0),e>m.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=m.tbd.childNodes[e]?m.tbd.insertBefore(l,m.tbd.childNodes[e]):m.tbd.appendChild(l),this.idPull[l.id]=l},dhtmlXMenuObject.prototype._renderSeparator=function(t,e){var i=this.conf.context?"SubLevelArea":this.itemPull[t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea";if("TopLevel"!=i||!this.conf.context){var l=this;if("TopLevel"!=i){var n=document.createElement("TR");n.className="sub_sep";var o=document.createElement("TD");o.colSpan="3",n.appendChild(o)}var s=document.createElement("DIV");if(s.id="separator_"+t,s.className="TopLevel"==i?"top_sep":"sub_sep",s.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},s.onclick=function(t){(t=t||event).cancelBubble=!0;var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};l._doOnClick(this.id.replace("separator_"+l.idPrefix,""),"--s",e)},"TopLevel"==i){if(null!=e)++e<0&&(e=0),null!=this.cont.childNodes[e]?this.cont.insertBefore(s,this.cont.childNodes[e]):this.cont.appendChild(s);else{var d=this.cont.childNodes[this.cont.childNodes.length-1];-1==String(d).search("TopLevel_Text")?this.cont.appendChild(s):this.cont.insertBefore(s,d)}this.idPull[s.id]=s}else{var r=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(++e<0&&(e=0),e>r.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=r.tbd.childNodes[e]?r.tbd.insertBefore(n,r.tbd.childNodes[e]):r.tbd.appendChild(n),o.appendChild(s),this.idPull[s.id]=n}}},dhtmlXMenuObject.prototype.addNewSeparator=function(t,e){e=this.idPrefix+(null!=e?e:this._genStr(24));var i=this.idPrefix+this.getParentId(t);this._addItemIntoGlobalStrorage(e,i,"","separator",!1,"",""),this._renderSeparator(e,this.getItemPosition(t))},dhtmlXMenuObject.prototype._initObj=function(t,e,i){t instanceof Array||(null!=(i=t.parentId)&&0!==String(i).indexOf(this.idPrefix)&&(i=this.idPrefix+String(i)),t=t.items);for(var l=0;l<t.length;l++){void 0!==t[l].id&&null!=t[l].id||(t[l].id=this._genStr(24)),null==t[l].text&&(t[l].text=""),0!==String(t[l].id).indexOf(this.idPrefix)&&(t[l].id=this.idPrefix+String(t[l].id));var n={type:"item",tip:"",hotkey:"",state:"enabled",imgen:"",imgdis:""};for(var o in n)void 0===t[l][o]&&(t[l][o]=n[o]);if(""==t[l].imgen&&null!=t[l].img&&(t[l].imgen=t[l].img),""==t[l].imgdis&&null!=t[l].img_disabled&&(t[l].imgdis=t[l].img_disabled),null==t[l].title&&null!=t[l].text&&(t[l].title=t[l].text),null!=t[l].href&&(null!=t[l].href.link&&(t[l].href_link=t[l].href.link),null!=t[l].href.target&&(t[l].href_target=t[l].href.target)),null!=t[l].userdata)for(var o in t[l].userdata)this.userData[t[l].id+"_"+o]=t[l].userdata[o];void 0!==t[l].enabled&&0==window.dhx4.s2b(t[l].enabled)?t[l].state="disabled":void 0!==t[l].disabled&&1==window.dhx4.s2b(t[l].disabled)&&(t[l].state="disabled"),void 0===t[l].parent&&(t[l].parent=null!=i?i:this.idPrefix+this.topId),"checkbox"==t[l].type&&(t[l].checked=window.dhx4.s2b(t[l].checked),t[l].imgen=t[l].imgdis="chbx_"+(t[l].checked?"1":"0")),"radio"==t[l].type&&(t[l].checked=window.dhx4.s2b(t[l].checked),t[l].imgen=t[l].imgdis="rdbt_"+(t[l].checked?"1":"0"),void 0!==t[l].group&&null!=t[l].group||(t[l].group=this._genStr(24)),null==this.radio[t[l].group]&&(this.radio[t[l].group]=[]),this.radio[t[l].group].push(t[l].id)),this.itemPull[t[l].id]=t[l],null!=t[l].items&&t[l].items.length>0?(this.itemPull[t[l].id].complex=!0,this._initObj(t[l].items,!0,t[l].id)):this.conf.dload&&1==t[l].complex&&(this.itemPull[t[l].id].loaded="no"),this.itemPull[t[l].id].items=null}if(!0!==e)if(1==this.conf.dload)if(null==i)this._initTopLevelMenu();else{if(this._addSubMenuPolygon(i,i),this.conf.selected==i){var s=this.itemPull[i].parent==this.idPrefix+this.topId,d=s&&!this.conf.context?this.conf.dir_toplv:this.conf.dir_sublv,r=!1;if(s&&this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context){var a=this.idPull[i];if(1==a._mouseOver){var h=this.conf.top_tmtime-((new Date).getTime()-a._dynLoadTM);if(h>1){var u=i,c=this;a._menuOpenTM=window.setTimeout(function(){c._showPolygon(u,d),c=u=null},h),r=!0}}}r||this._showPolygon(i,d)}this.itemPull[i].loaded="yes",1==this.conf.dload_icon&&this._updateLoaderIcon(i,!1)}else this._init()},dhtmlXMenuObject.prototype._xmlToJson=function(t,e){var i=[];if(null==e){var l=t.getElementsByTagName(this.conf.tags.root);if(null==l||null!=l&&0==l.length)return{items:[]};l=l[0]}else l=t;null!=l.getAttribute("parentId")&&(e=this.idPrefix+l.getAttribute("parentId"));for(var n=0;n<l.childNodes.length;n++)if(void 0!==l.childNodes[n].tagName&&String(l.childNodes[n].tagName).toLowerCase()==this.conf.tags.item){var o=l.childNodes[n],s={id:this.idPrefix+(o.getAttribute("id")||this._genStr(24)),title:o.getAttribute("text")||"",imgen:o.getAttribute("img")||"",imgdis:o.getAttribute("imgdis")||"",tip:"",hotkey:"",type:o.getAttribute("type")||"item"};if(null!=o.getAttribute("cssNormal")&&(s.cssNormal=o.getAttribute("cssNormal")),"checkbox"==s.type&&(s.checked=o.getAttribute("checked")),"radio"==s.type&&(s.checked=o.getAttribute("checked"),s.group=o.getAttribute("group")),s.state="enabled",null!=o.getAttribute("enabled")&&0==window.dhx4.s2b(o.getAttribute("enabled"))?s.state="disabled":null!=o.getAttribute("disabled")&&1==window.dhx4.s2b(o.getAttribute("disabled"))&&(s.state="disabled"),s.parent=null!=e?e:this.idPrefix+this.topId,this.conf.dload)s.complex=null!=o.getAttribute("complex"),s.complex&&(s.loaded="no");else{var d=this._xmlToJson(o,s.id);s.items=d.items,s.complex=s.items.length>0}for(var r=0;r<o.childNodes.length;r++)if(void 0!==o.childNodes[r].tagName){var a=String(o.childNodes[r].tagName||"").toLowerCase();if(a==this.conf.tags.userdata){var h=o.childNodes[r];null!=h.getAttribute("name")&&(this.userData[s.id+"_"+h.getAttribute("name")]=null!=h.firstChild&&null!=h.firstChild.nodeValue?h.firstChild.nodeValue:"")}a==this.conf.tags.text_ext&&(s.title=o.childNodes[r].firstChild.nodeValue),a==this.conf.tags.tooltip&&(s.tip=o.childNodes[r].firstChild.nodeValue),a==this.conf.tags.hotkey&&(s.hotkey=o.childNodes[r].firstChild.nodeValue),a==this.conf.tags.href&&"item"==s.type&&(s.href_link=o.childNodes[r].firstChild.nodeValue,null!=o.childNodes[r].getAttribute("target")&&(s.href_target=o.childNodes[r].getAttribute("target")))}i.push(s)}return o={parentId:e,items:i}},dhtmlXMenuObject.prototype.enableDynamicLoading=function(t,e){this.conf.dload=!0,this.conf.dload_url=t,this.conf.dload_sign=-1==String(this.conf.dload_url).search(/\?/)?"?":"&",this.conf.dload_icon=e,this._init()},dhtmlXMenuObject.prototype._updateLoaderIcon=function(t,e){if(null!=this.idPull[t]&&!(String(this.idPull[t].className).search("TopLevel_Item")>=0)){var i=this.conf.rtl?0:2;if(this.idPull[t].childNodes[i]&&this.idPull[t].childNodes[i].childNodes[0]){var l=this.idPull[t].childNodes[i].childNodes[0];0===String(l.className).search("complex_arrow")&&(l.className="complex_arrow"+(e?"_loading":""))}}},dhtmlXMenuObject.prototype.addNewSibling=function(t,e,i,l,n,o){var s=this.idPrefix+(null!=e?e:this._genStr(24)),d=this.idPrefix+(null!=t?this.getParentId(t):this.topId);this._addItemIntoGlobalStrorage(s,d,i,"item",l,n,o),d!=this.idPrefix+this.topId||this.conf.context?this._renderSublevelItem(s,this.getItemPosition(t)):this._renderToplevelItem(s,this.getItemPosition(t))},dhtmlXMenuObject.prototype.addNewChild=function(t,e,i,l,n,o,s){if(null==t){if(!this.conf.context)return this.addNewSibling(t,i,l,n,o,s),void(null!=e&&this.setItemPosition(i,e));t=this.topId}i=this.idPrefix+(null!=i?i:this._genStr(24)),this.setHotKey&&this.setHotKey(t,""),t=this.idPrefix+t,this._addItemIntoGlobalStrorage(i,t,l,"item",n,o,s),null==this.idPull["polygon_"+t]&&this._renderSublevelPolygon(t,t),this._renderSublevelItem(i,e-1),this._redefineComplexState(t)},dhtmlXMenuObject.prototype.removeItem=function(t,e,i){e||(t=this.idPrefix+t);var l=null;if(t!=this.idPrefix+this.topId){if(null==this.itemPull[t])return;this.idPull["polygon_"+t]&&this.idPull["polygon_"+t]._tmShow&&window.clearTimeout(this.idPull["polygon_"+t]._tmShow);var n=this.itemPull[t].type;if("separator"==n){var o=this.idPull["separator_"+t];this.itemPull[t].parent==this.idPrefix+this.topId?(o.onclick=null,o.onselectstart=null,o.id=null,o.parentNode.removeChild(o)):(o.childNodes[0].childNodes[0].onclick=null,o.childNodes[0].childNodes[0].onselectstart=null,o.childNodes[0].childNodes[0].id=null,o.childNodes[0].removeChild(o.childNodes[0].childNodes[0]),o.removeChild(o.childNodes[0]),o.parentNode.removeChild(o)),this.idPull["separator_"+t]=null,this.itemPull[t]=null,delete this.idPull["separator_"+t],delete this.itemPull[t],o=null}else{l=this.itemPull[t].parent;for((o=this.idPull[t]).onclick=null,o.oncontextmenu=null,o.onmouseover=null,o.onmouseout=null,o.onselectstart=null,o.id=null;o.childNodes.length>0;)o.removeChild(o.childNodes[0]);o.parentNode.removeChild(o),this.idPull[t]=null,this.itemPull[t]=null,delete this.idPull[t],delete this.itemPull[t],o=null}n=null}for(var s in this.itemPull)this.itemPull[s].parent==t&&this.removeItem(s,!0,!0);var d=new Array(t);null==l||i||null!=this.idPull["polygon_"+l]&&0==this.idPull["polygon_"+l].tbd.childNodes.length&&(d.push(l),this._updateItemComplexState(l,!1,!1));for(var r=0;r<d.length;r++)if(this.idPull["polygon_"+d[r]]){var a=this.idPull["polygon_"+d[r]];if(a.onclick=null,a.oncontextmenu=null,a.tbl.removeChild(a.tbd),a.tbd=null,a.childNodes[1].removeChild(a.tbl),a.tbl=null,a.id=null,a.parentNode.removeChild(a),a=null,window.dhx4.isIE6){var h="polygon_"+d[r]+"_ie6cover";null!=this.idPull[h]&&(document.body.removeChild(this.idPull[h]),delete this.idPull[h])}null!=this.idPull["arrowup_"+t]&&this._removeArrow&&this._removeArrow("arrowup_"+t),null!=this.idPull["arrowdown_"+t]&&this._removeArrow&&this._removeArrow("arrowdown_"+t),this.idPull["polygon_"+d[r]]=null,delete this.idPull["polygon_"+d[r]]}d=null,"dhx_terrace"==this.conf.skin&&1==arguments.length&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(t,e,i,l,n,o,s){var d={id:t,title:i,imgen:null!=o?o:"",imgdis:null!=s?s:"",type:l,state:1==n?"disabled":"enabled",parent:e,complex:!1,hotkey:"",tip:""};this.itemPull[d.id]=d},dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.conf.context=!0,1==this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+this.conf.skin+"_Middle",""),this.base._autoSkinUpdate=!1),null!=this.conf.ctx_baseid&&this.addContextZone(this.conf.ctx_baseid)},dhtmlXMenuObject.prototype.addContextZone=function(t){if(t==document.body){t="document.body."+this.idPrefix;var e=document.body}else if("string"==typeof t)e=document.getElementById(t);else e=t;var i=!1;for(var l in this.conf.ctx_zones)i=i||l==t||this.conf.ctx_zones[l]==e;if(1==i)return!1;this.conf.ctx_zones[t]=e;var n=this;window.dhx4.isOpera?(this.operaContext=function(t){n._doOnContextMenuOpera(t,n)},e.addEventListener("mouseup",this.operaContext,!1)):(null==e.oncontextmenu||e._oldContextMenuHandler||(e._oldContextMenuHandler=e.oncontextmenu),e.oncontextmenu=function(t){for(var e in dhtmlXMenuObject.prototype.liveInst)e!=n.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[e].context&&dhtmlXMenuObject.prototype.liveInst[e]._hideContextMenu();return t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,n._doOnContextBeforeCall(t,this),!1})},dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(t,e){for(var i in dhtmlXMenuObject.prototype.liveInst)i!=e.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[i].context&&dhtmlXMenuObject.prototype.liveInst[i]._hideContextMenu();return t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,0==t.button&&1==t.ctrlKey&&e._doOnContextBeforeCall(t,this),!1},dhtmlXMenuObject.prototype.removeContextZone=function(t){if(!this.isContextZone(t))return!1;t==document.body&&(t="document.body."+this.idPrefix);var e=this.conf.ctx_zones[t];window.dhx4.isOpera?e.removeEventListener("mouseup",this.operaContext,!1):(e.oncontextmenu=null!=e._oldContextMenuHandler?e._oldContextMenuHandler:null,e._oldContextMenuHandler=null);try{this.conf.ctx_zones[t]=null,delete this.conf.ctx_zones[t]}catch(t){}return!0},dhtmlXMenuObject.prototype.isContextZone=function(t){if(t==document.body&&null!=this.conf.ctx_zones["document.body."+this.idPrefix])return!0;var e=!1;return null!=this.conf.ctx_zones[t]&&this.conf.ctx_zones[t]==document.getElementById(t)&&(e=!0),e},dhtmlXMenuObject.prototype._isContextMenuVisible=function(){return null!=this.idPull["polygon_"+this.idPrefix+this.topId]&&""==this.idPull["polygon_"+this.idPrefix+this.topId].style.display},dhtmlXMenuObject.prototype._showContextMenu=function(t,e,i){if(this._clearAndHide(),null==this.idPull["polygon_"+this.idPrefix+this.topId])return!1;window.clearTimeout(this.conf.tm_handler),this.idPull[this.idPrefix+this.topId]=new Array(t,e),this._showPolygon(this.idPrefix+this.topId,"bottom"),this.callEvent("onContextMenu",[i])},dhtmlXMenuObject.prototype._hideContextMenu=function(){if(null==this.idPull["polygon_"+this.idPrefix+this.topId])return!1;this._clearAndHide(),this._hidePolygon(this.idPrefix+this.topId)},dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(t,e){this.conf.ctx_zoneid=e.id,this._clearAndHide(),this._hideContextMenu();var i=t.srcElement||t.target,l=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?t.offsetX:t.layerX,n=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?t.offsetY:t.layerY,o=window.dhx4.absLeft(i)+l,s=window.dhx4.absTop(i)+n;this.checkEvent("onBeforeContextMenu")?this.callEvent("onBeforeContextMenu",[e.id,t])&&this.conf.ctx_autoshow&&(this._showContextMenu(o,s,e.id),this.callEvent("onAfterContextMenu",[e.id,t])):this.conf.ctx_autoshow&&(this._showContextMenu(o,s,e.id),this.callEvent("onAfterContextMenu",[e.id]))},dhtmlXMenuObject.prototype.showContextMenu=function(t,e){this._showContextMenu(t,e,!1)},dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()},dhtmlXMenuObject.prototype.setAutoShowMode=function(t){this.conf.ctx_autoshow=1==t},dhtmlXMenuObject.prototype.setAutoHideMode=function(t){this.conf.ctx_autohide=1==t},dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(t){this.conf.ctx_hideall=1==t},dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.conf.ctx_hideall},dhtmlXMenuObject.prototype._improveTerraceSkin=function(){for(var t in this.itemPull)if(this.itemPull[t].parent==this.idPrefix+this.topId&&null!=this.idPull[t]){var e=!1,i=!1;this.idPull[t].parentNode.firstChild==this.idPull[t]&&(e=!0),this.idPull[t].parentNode.lastChild==this.idPull[t]&&(i=!0);for(var l in this.itemPull)"separator"==this.itemPull[l].type&&this.itemPull[l].parent==this.idPrefix+this.topId&&(this.idPull[t].nextSibling==this.idPull["separator_"+l]&&(i=!0),this.idPull[t].previousSibling==this.idPull["separator_"+l]&&(e=!0));this.idPull[t].style.borderLeftWidth=e?"1px":"0px",this.idPull[t].style.borderTopLeftRadius=this.idPull[t].style.borderBottomLeftRadius=e?"3px":"0px",this.idPull[t].style.borderTopRightRadius=this.idPull[t].style.borderBottomRightRadius=i?"3px":"0px",this.idPull[t]._bl=e,this.idPull[t]._br=i}},dhtmlXMenuObject.prototype._improveTerraceButton=function(t,e){e?(this.idPull[t].style.borderBottomLeftRadius=this.idPull[t]._bl?"3px":"0px",this.idPull[t].style.borderBottomRightRadius=this.idPull[t]._br?"3px":"0px"):(this.idPull[t].style.borderBottomLeftRadius="0px",this.idPull[t].style.borderBottomRightRadius="0px")},void 0!==window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_menu=function(t,e,i,l,n){return void 0!==n?t=n:((t=document.createElement("DIV")).className="dhx_cell_menu_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV"))),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.toolbar||this.conf.idx.cont]),this.conf.ofs_nodes.t.menu=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachMenu=function(t){if(!this.dataNodes.menu)return this.callEvent("_onBeforeContentAttach",["menu"]),void 0===t&&(t={}),void 0===t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("menu").firstChild,this.dataNodes.menu=new dhtmlXMenuObject(t),this._adjustCont(this._idd),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.menu},dhtmlXCellObject.prototype.detachMenu=function(){this.dataNodes.menu&&(this.dataNodes.menu.unload(),this.dataNodes.menu=null,delete this.dataNodes.menu,this._detachObject("menu"))},dhtmlXCellObject.prototype.showMenu=function(){this._mtbShowHide("menu","")},dhtmlXCellObject.prototype.hideMenu=function(){this._mtbShowHide("menu","none")},dhtmlXCellObject.prototype.getAttachedMenu=function(){return this.dataNodes.menu}),dhtmlXMenuObject.prototype.setItemEnabled=function(t){this._changeItemState(t,"enabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.setItemDisabled=function(t){this._changeItemState(t,"disabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.isItemEnabled=function(t){return null!=this.itemPull[this.idPrefix+t]&&"enabled"==this.itemPull[this.idPrefix+t].state},dhtmlXMenuObject.prototype._changeItemState=function(t,e,i){var l=this.idPrefix+t;return null!=this.itemPull[l]&&null!=this.idPull[l]&&this.itemPull[l].state!=e&&(this.itemPull[l].state=e,this.itemPull[l].parent!=this.idPrefix+this.topId||this.conf.context?this.idPull[l].className="sub_item"+("enabled"==this.itemPull[l].state?"":"_dis"):this.idPull[l].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[l].state?"Normal":"Disabled"),this._updateItemComplexState(this.idPrefix+t,this.itemPull[this.idPrefix+t].complex,!1),this._updateItemImage(t,i),this.idPrefix+this.conf.last_click==l&&"TopLevel"!=i&&this._redistribSubLevelSelection(l,this.itemPull[l].parent),"TopLevel"==i&&this.conf.context),!1},dhtmlXMenuObject.prototype.getItemText=function(t){return null!=this.itemPull[this.idPrefix+t]?this.itemPull[this.idPrefix+t].title:""},dhtmlXMenuObject.prototype.setItemText=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t])if(this._clearAndHide(),this.itemPull[t].title=e,this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context){for(i=null,l=0;l<this.idPull[t].childNodes[1].childNodes.length;l++)"sub_item_text"==String(this.idPull[t].childNodes[1].childNodes[l].className||"")&&(i=this.idPull[t].childNodes[1].childNodes[l]);""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?i&&(i.parentNode.removeChild(i),i=null,this.idPull[t].childNodes[1].innerHTML="&nbsp;"):(i||((i=document.createElement("DIV")).className="sub_item_text",this.idPull[t].childNodes[1].innerHTML="",this.idPull[t].childNodes[1].appendChild(i)),i.innerHTML=this.itemPull[t].title)}else{for(var i=null,l=0;l<this.idPull[t].childNodes.length;l++)try{"top_level_text"==this.idPull[t].childNodes[l].className&&(i=this.idPull[t].childNodes[l])}catch(t){}""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?null!=i&&i.parentNode.removeChild(i):(i||((i=document.createElement("DIV")).className="top_level_text",this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(i,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(i)),i.innerHTML=this.itemPull[t].title)}},dhtmlXMenuObject.prototype.loadFromHTML=function(t,e,i){var l=this.conf.tags.item;this.conf.tags.item="div";var n="string"==typeof t?document.getElementById(t):t,o=this._xmlToJson(n,this.idPrefix+this.topId);this._initObj(o),this.conf.tags.item=l,e&&n.parentNode.removeChild(n),n=objOd=null,null!=onload&&("function"==typeof i?i():"function"==typeof window[i]&&window[i]())},dhtmlXMenuObject.prototype.hideItem=function(t){this._changeItemVisible(t,!1)},dhtmlXMenuObject.prototype.showItem=function(t){this._changeItemVisible(t,!0)},dhtmlXMenuObject.prototype.isItemHidden=function(t){var e=null;return null!=this.idPull[this.idPrefix+t]&&(e="none"==this.idPull[this.idPrefix+t].style.display),e},dhtmlXMenuObject.prototype._changeItemVisible=function(t,e){var i=this.idPrefix+t;null!=this.itemPull[i]&&("separator"==this.itemPull[i].type&&(i="separator_"+i),null!=this.idPull[i]&&(this.idPull[i].style.display=e?"":"none",this._redefineComplexState(this.itemPull[this.idPrefix+t].parent)))},dhtmlXMenuObject.prototype.setUserData=function(t,e,i){this.userData[this.idPrefix+t+"_"+e]=i},dhtmlXMenuObject.prototype.getUserData=function(t,e){return null!=this.userData[this.idPrefix+t+"_"+e]?this.userData[this.idPrefix+t+"_"+e]:null},dhtmlXMenuObject.prototype.setOpenMode=function(t){this.conf.mode="win"==t?"win":"web"},dhtmlXMenuObject.prototype.setWebModeTimeout=function(t){this.conf.tm_sec=isNaN(t)?400:t},dhtmlXMenuObject.prototype.getItemImage=function(t){var e=new Array(null,null);return t=this.idPrefix+t,"item"==this.itemPull[t].type&&(e[0]=this.itemPull[t].imgen,e[1]=this.itemPull[t].imgdis),e},dhtmlXMenuObject.prototype.setItemImage=function(t,e,i){"item"==this.itemPull[this.idPrefix+t].type&&(this.itemPull[this.idPrefix+t].imgen=e,this.itemPull[this.idPrefix+t].imgdis=i,this._updateItemImage(t,this._getItemLevelType(t)))},dhtmlXMenuObject.prototype.clearItemImage=function(t){this.setItemImage(t,"","")},dhtmlXMenuObject.prototype.setVisibleArea=function(t,e,i,l){this.conf.v_enabled=!0,this.conf.v.x1=t,this.conf.v.x2=e,this.conf.v.y1=i,this.conf.v.y2=l},dhtmlXMenuObject.prototype.setTooltip=function(t,e){t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.idPull[t].title=e.length>0?e:null,this.itemPull[t].tip=e)},dhtmlXMenuObject.prototype.getTooltip=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].tip},dhtmlXMenuObject.prototype.setTopText=function(t){this.conf.context||(null==this._topText&&(this._topText=document.createElement("DIV"),this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this.conf.rtl?"left":"left"==this.conf.align?"right":"left"),this.base.appendChild(this._topText)),this._topText.innerHTML=t)},dhtmlXMenuObject.prototype.setAlign=function(t){this.conf.align!=t&&("left"!=t&&"right"!=t||(this.conf.align=t,this.cont&&(this.cont.className="right"==this.conf.align?"align_right":"align_left"),null!=this._topText&&(this._topText.className="dhtmlxMenu_TopLevel_Text_"+("left"==this.conf.align?"right":"left"))))},dhtmlXMenuObject.prototype.setHref=function(t,e,i){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].href_link=e,null!=i&&(this.itemPull[this.idPrefix+t].href_target=i))},dhtmlXMenuObject.prototype.clearHref=function(t){null!=this.itemPull[this.idPrefix+t]&&(delete this.itemPull[this.idPrefix+t].href_link,delete this.itemPull[this.idPrefix+t].href_target)},dhtmlXMenuObject.prototype.getCircuit=function(t){for(var e=new Array(t);this.getParentId(t)!=this.topId;)t=this.getParentId(t),e[e.length]=t;return e.reverse()},dhtmlXMenuObject.prototype._getCheckboxState=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].checked},dhtmlXMenuObject.prototype._setCheckboxState=function(t,e){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].checked=e)},dhtmlXMenuObject.prototype._updateCheckboxImage=function(t){if(null!=this.idPull[this.idPrefix+t]){this.itemPull[this.idPrefix+t].imgen="chbx_"+(this._getCheckboxState(t)?"1":"0"),this.itemPull[this.idPrefix+t].imgdis=this.itemPull[this.idPrefix+t].imgen;try{this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+t].imgen}catch(t){}}},dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t]){var l=this._getCheckboxState(t);this.checkEvent("onCheckboxClick")?this.callEvent("onCheckboxClick",[t,l,this.conf.ctx_zoneid,i])&&this.setCheckboxState(t,!l):this.setCheckboxState(t,!l),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.setCheckboxState=function(t,e){this._setCheckboxState(t,e),this._updateCheckboxImage(t)},dhtmlXMenuObject.prototype.getCheckboxState=function(t){return this._getCheckboxState(t)},dhtmlXMenuObject.prototype.addCheckbox=function(t,e,i,l,n,o,s){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var d="chbx_"+(o?"1":"0"),r=d;if("sibling"==t){var a=this.idPrefix+(null!=l?l:this._genStr(24)),h=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(a,h,n,"checkbox",s,d,r),this.itemPull[a].checked=o,this._renderSublevelItem(a,this.getItemPosition(e))}else{a=this.idPrefix+(null!=l?l:this._genStr(24)),h=this.idPrefix+e;this._addItemIntoGlobalStrorage(a,h,n,"checkbox",s,d,r),this.itemPull[a].checked=o,null==this.idPull["polygon_"+h]&&this._renderSublevelPolygon(h,h),this._renderSublevelItem(a,i-1),this._redefineComplexState(h)}},dhtmlXMenuObject.prototype.setHotKey=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context)&&!this.itemPull[t].complex){var i=this.itemPull[t].type;if("item"==i||"checkbox"==i||"radio"==i){var l=null;try{"sub_item_hk"==this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0].className&&(l=this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0])}catch(t){}if(0==e.length)this.itemPull[t].hotkey_backup=this.itemPull[t].hotkey,this.itemPull[t].hotkey="",null!=l&&l.parentNode.removeChild(l);else{if(this.itemPull[t].hotkey=e,this.itemPull[t].hotkey_backup=null,null==l){(l=document.createElement("DIV")).className="sub_item_hk";for(var n=this.idPull[t].childNodes[this.conf.rtl?0:2];n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.appendChild(l)}l.innerHTML=e}}}},dhtmlXMenuObject.prototype.getHotKey=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].hotkey},dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(t){for(var e=this._getSubItemToDeselectByPolygon(t),i=0;i<this.conf.opened_poly.length;i++)this.conf.opened_poly[i]!=t&&this._hidePolygon(this.conf.opened_poly[i]);for(i=0;i<e.length;i++)null!=this.idPull[e[i]]&&"enabled"==this.itemPull[e[i]].state&&(this.idPull[e[i]].className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Item_Normal")},dhtmlXMenuObject.prototype._checkArrowsState=function(t){var e=this.idPull["polygon_"+t].childNodes[1],i=this.idPull["arrowup_"+t],l=this.idPull["arrowdown_"+t];0==e.scrollTop?i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp_Disabled":i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp"+(i.over?"_Over":""),e.scrollTop+e.offsetHeight<e.scrollHeight?l.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown"+(l.over?"_Over":""):l.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown_Disabled",e=i=l=null},dhtmlXMenuObject.prototype._addUpArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowup_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp",i.over=!1,i.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Over",this.over=!0,e._canScrollUp=!0,e._doScrollUp(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollUp=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp",window.clearTimeout(e.conf.of_utm))},i.onclick=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var l=this.idPull["polygon_"+this.idPrefix+t];l.childNodes[0].appendChild(i),this.idPull[i.id]=i,l=i=null},dhtmlXMenuObject.prototype._addDownArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowdown_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown",i.over=!1,i.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Over",this.over=!0,e._canScrollDown=!0,e._doScrollDown(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollDown=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown",window.clearTimeout(e.conf.of_dtm))},i.onclick=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var l=this.idPull["polygon_"+this.idPrefix+t];l.childNodes[2].appendChild(i),this.idPull[i.id]=i,l=i=null},dhtmlXMenuObject.prototype._removeUpArrow=function(t){var e="arrowup_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeDownArrow=function(t){var e="arrowdown_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeArrow=function(t){var e=this.idPull[t];e.onselectstart=null,e.oncontextmenu=null,e.onmouseover=null,e.onmouseout=null,e.onclick=null,e.parentNode&&e.parentNode.removeChild(e),e=null,this.idPull[t]=null;try{delete this.idPull[t]}catch(t){}},dhtmlXMenuObject.prototype._isArrowExists=function(t){return null!=this.idPull["arrowup_"+t]&&null!=this.idPull["arrowdown_"+t]},dhtmlXMenuObject.prototype._doScrollUp=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollUp&&i.scrollTop>0){var l=!1,n=i.scrollTop-this.conf.of_ustep;if(n<0&&(l=!0,n=0),i.scrollTop=n,l)e=!0;else{var o=this;this.conf.of_utm=window.setTimeout(function(){o._doScrollUp(t,!1),o=null},this.conf.of_utime)}}else this._canScrollUp=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._doScrollDown=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollDown&&i.scrollTop+i.offsetHeight<=i.scrollHeight){var l=!1,n=i.scrollTop+this.conf.of_dstep;if(n+i.offsetHeight>=i.scrollHeight&&(l=!0,n=i.scrollHeight-i.offsetHeight),i.scrollTop=n,l)e=!0;else{var o=this;this.conf.of_dtm=window.setTimeout(function(){o._doScrollDown(t,!1),o=null},this.conf.of_dtime)}}else this._canScrollDown=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._countPolygonItems=function(t){var e=0;for(var i in this.itemPull){var l=this.itemPull[i].parent,n=this.itemPull[i].type;l!=this.idPrefix+t||"item"!=n&&"radio"!=n&&"checkbox"!=n||e++}return e},dhtmlXMenuObject.prototype.setOverflowHeight=function(t){if("auto"===t)return this.conf.overflow_limit=0,void(this.conf.auto_overflow=!0);if(!(0==this.conf.overflow_limit&&t<=0))if(this._clearAndHide(),this.conf.overflow_limit>=0&&t>0)this.conf.overflow_limit=t;else if(this.conf.overflow_limit>0&&t<=0){for(var e in this.itemPull)if(this._isArrowExists(e)){var i=String(e).replace(this.idPrefix,"");this._removeUpArrow(i),this._removeDownArrow(i),this.idPull["polygon_"+e].childNodes[1].style.height=""}this.conf.overflow_limit=0}else;},dhtmlXMenuObject.prototype._getRadioImgObj=function(t){try{var e=this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(t){e=null}return e},dhtmlXMenuObject.prototype._setRadioState=function(t,e){var i=this._getRadioImgObj(t);if(null!=i){var l=this.itemPull[this.idPrefix+t];l.checked=e,l.imgen="rdbt_"+(l.checked?"1":"0"),l.imgdis=l.imgen,i.className="sub_icon "+l.imgen}},dhtmlXMenuObject.prototype._radioOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t].group){var l=this.itemPull[this.idPrefix+t].group;this.checkEvent("onRadioClick")?this.callEvent("onRadioClick",[l,this.getRadioChecked(l),t,this.conf.ctx_zoneid,i])&&this.setRadioChecked(l,t):this.setRadioChecked(l,t),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.getRadioChecked=function(t){for(var e=null,i=0;i<this.radio[t].length;i++){var l=this.radio[t][i].replace(this.idPrefix,""),n=this._getRadioImgObj(l);if(null!=n){null!=n.className.match(/rdbt_1$/gi)&&(e=l)}}return e},dhtmlXMenuObject.prototype.setRadioChecked=function(t,e){if(null!=this.radio[t])for(var i=0;i<this.radio[t].length;i++){var l=this.radio[t][i].replace(this.idPrefix,"");this._setRadioState(l,l==e)}},dhtmlXMenuObject.prototype.addRadioButton=function(t,e,i,l,n,o,s,d){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var r=this.idPrefix+(null!=l?l:this._genStr(24)),a="rdbt_"+(s?"1":"0"),h=a;if("sibling"==t){var u=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(r,u,n,"radio",d,a,h),this._renderSublevelItem(r,this.getItemPosition(e))}else{u=this.idPrefix+e;this._addItemIntoGlobalStrorage(r,u,n,"radio",d,a,h),null==this.idPull["polygon_"+u]&&this._renderSublevelPolygon(u,u),this._renderSublevelItem(r,i-1),this._redefineComplexState(u)}var c=null!=o?o:this._genStr(24);this.itemPull[r].group=c,null==this.radio[c]&&(this.radio[c]=new Array),this.radio[c][this.radio[c].length]=r,1==s&&this.setRadioChecked(c,String(r).replace(this.idPrefix,""))},dhtmlXMenuObject.prototype.serialize=function(){return"<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>"},dhtmlXMenuObject.prototype._readLevel=function(t){var e="";for(var i in this.itemPull)if(this.itemPull[i].parent==t){var l="",n="",o="",s=String(this.itemPull[i].id).replace(this.idPrefix,""),d="",r=""!=this.itemPull[i].title?' text="'+this.itemPull[i].title+'"':"",a="";"item"==this.itemPull[i].type&&(""!=this.itemPull[i].imgen&&(l=' img="'+this.itemPull[i].imgen+'"'),""!=this.itemPull[i].imgdis&&(n=' imgdis="'+this.itemPull[i].imgdis+'"'),""!=this.itemPull[i].hotkey&&(o="<hotkey>"+this.itemPull[i].hotkey+"</hotkey>")),"separator"==this.itemPull[i].type?d=' type="separator"':"disabled"==this.itemPull[i].state&&(a=' enabled="false"'),"checkbox"==this.itemPull[i].type&&(d=' type="checkbox"'+(this.itemPull[i].checked?' checked="true"':"")),"radio"==this.itemPull[i].type&&(d=' type="radio" group="'+this.itemPull[i].group+'" '+(this.itemPull[i].checked?' checked="true"':"")),e+="<item id='"+s+"'"+r+d+l+n+a+">",e+=o,this.itemPull[i].complex&&(e+=this._readLevel(i)),e+="</item>"}return e},dhtmlXMenuObject.prototype.enableEffect=function(t,e,i){this._menuEffect=("opacity"==t||"slide"==t||"slide+"==t)&&t,this._pOpStyleIE=navigator.userAgent.search(/MSIE\s[678]\.0/gi)>=0;for(var l in this.idPull)0===l.search(/polygon/)&&(this._pOpacityApply(l,this._pOpStyleIE?100:1),this.idPull[l].style.height="");this._pOpMax=(void 0===e?100:e)/(this._pOpStyleIE?1:100),this._pOpStyleName=this._pOpStyleIE?"filter":"opacity",this._pOpStyleValue=this._pOpStyleIE?"progid:DXImageTransform.Microsoft.Alpha(Opacity=#)":"#",this._pSlSteps=this._pOpStyleIE?10:20,this._pSlTMTimeMax=i||50},dhtmlXMenuObject.prototype._showPolygonEffect=function(t){this._pShowHide(t,!0)},dhtmlXMenuObject.prototype._hidePolygonEffect=function(t){this._pShowHide(t,!1)},dhtmlXMenuObject.prototype._pOpacityApply=function(t,e){this.idPull[t].style[this._pOpStyleName]=String(this._pOpStyleValue).replace("#",e||this.idPull[t]._op)},dhtmlXMenuObject.prototype._pShowHide=function(t,e){if(this.idPull){if(null!=this.idPull[t]._tmShow){if(this.idPull[t]._step_h>0&&1==e||this.idPull[t]._step_h<0&&0==e)return;window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._tmShow=null,this.idPull[t]._max_h=null}if(0!=e||"hidden"!=this.idPull[t].style.visibility&&"none"!=this.idPull[t].style.display){if(1==e&&"none"==this.idPull[t].style.display&&(this.idPull[t].style.visibility="hidden",this.idPull[t].style.display=""),null==this.idPull[t]._max_h){if(this.idPull[t]._max_h=parseInt(this.idPull[t].offsetHeight),this.idPull[t]._h=1==e?0:this.idPull[t]._max_h,this.idPull[t]._step_h=Math.round(this.idPull[t]._max_h/this._pSlSteps)*(1==e?1:-1),0==this.idPull[t]._step_h)return;this.idPull[t]._step_tm=Math.round(this._pSlTMTimeMax/this._pSlSteps),"slide+"==this._menuEffect||"opacity"==this._menuEffect?(this.idPull[t].op_tm=this.idPull[t]._step_tm,this.idPull[t].op_step=this._pOpMax/this._pSlSteps*(1==e?1:-1),this._pOpStyleIE&&(this.idPull[t].op_step=Math.round(this.idPull[t].op_step)),this.idPull[t]._op=1==e?0:this._pOpMax,this._pOpacityApply(t)):(this.idPull[t]._op=this._pOpStyleIE?100:1,this._pOpacityApply(t)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height="0px"),this.idPull[t].style.visibility="visible"}this._pEffectSet(t,this.idPull[t]._h+this.idPull[t]._step_h)}}},dhtmlXMenuObject.prototype._pEffectSet=function(t,e){if(this.idPull)if(this.idPull[t]._tmShow&&window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._h=Math.max(0,Math.min(e,this.idPull[t]._max_h)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=this.idPull[t]._h+"px"),e+=this.idPull[t]._step_h,"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=Math.max(0,Math.min(this._pOpMax,this.idPull[t]._op+this.idPull[t].op_step)),this._pOpacityApply(t)),this.idPull[t]._step_h>0&&e<=this.idPull[t]._max_h||this.idPull[t]._step_h<0&&e>=0){var i=this;this.idPull[t]._tmShow=window.setTimeout(function(){i._pEffectSet(t,e)},this.idPull[t]._step_tm)}else 0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=""),this.idPull[t]._step_h<0&&(this.idPull[t].style.visibility="hidden"),"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=this.idPull[t]._step_h<0?this._pOpStyleIE?100:1:this._pOpMax,this._pOpacityApply(t)),this.idPull[t]._tmShow=null,this.idPull[t]._h=null,this.idPull[t]._max_h=null,this.idPull[t]._step_tm=null},module.exports=dhtmlXMenuObject;

},{}],6:[function(require,module,exports){
function dhtmlXSlider(e){var t=this;if(this.conf={size:null,skin:null,vertical:!1,min:0,max:99,value:0,step:1,decimals:0,margin:2,border:1,inverse:!1,disabled:!1,tooltip:!1,visible:!0,linkTo:void 0},this._attachedNode={},this._movingInitialValues=null,this.base=null,arguments.length>1)return new dhtmlXSlider(this._renderArgumets(arguments));if("string"==typeof e||"object"==typeof e&&e.tagName)return new dhtmlXSlider({parent:e});"string"==typeof e.parent?this.base=document.getElementById(e.parent):this.base=e.parent,this._mergeConfig(this._readAttFormNode(this.base)),this._mergeConfig(e),this._detectDecimals(),null!=this.conf.size&&void 0!=this.conf.size||(this.conf.vertical?this.conf.size=this.base.offsetHeight:this.conf.size=this.base.offsetWidth);var n=this.conf.skin||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxslider")||"dhx_skyblue";return this.setSkin(n),this.base.innerHTML="<div class='dhxsl_container'><div class='dhxsl_track'></div><div class='dhxsl_runner'></div></div>",this._nodes={cont:this.base.firstChild,track:this.base.firstChild.firstChild,runner:this.base.firstChild.childNodes[1]},this._nodes.cont.onmousedown=this._nodes.track.onmousedown=this._nodes.cont.onselectstart=this._nodes.track.onselectstart=function(e){return"function"==typeof(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},this.conf.value=this._normalize(this.conf.value),this._setOrient(this.conf.vertical),this.setSize(this.conf.size),this._initMover=function(e){"function"==typeof(e=e||event).preventDefault&&e.preventDefault(),t._nodes.runner.className="dhxsl_runner dhxsl_runner_actv";var n=("mousedown"==e.type?"client":"page")+(t.conf.vertical?"Y":"X");return t._movingInitialValues={},t._movingInitialValues.value=t.conf.value,t._movingInitialValues.coord=void 0!==e[n]?e[n]:e.touches[0][n],0==t.conf.disabled&&("function"==typeof window.addEventListener?(window.addEventListener("mousemove",t._move,!1),window.addEventListener("mouseup",t._cleanMove,!1),window.addEventListener("touchmove",t._move,!1),window.addEventListener("touchend",t._cleanMove,!1)):(document.body.attachEvent("onmousemove",t._move),document.body.attachEvent("onmouseup",t._cleanMove))),t.callEvent("_onRunnerMouseDown",[]),!1},this._move=function(e){"function"==typeof(e=e||event).preventDefault&&e.preventDefault();var n=("mousemove"==e.type?"client":"page")+(t.conf.vertical?"Y":"X"),s=t.conf.vertical?t._nodes.runner.offsetHeight:t._nodes.runner.offsetWidth,i=t.conf.max-t.conf.min,o=void 0!==e[n]?e[n]:e.touches[0][n],a=t._movingInitialValues.value+(o-t._movingInitialValues.coord)*i/(t.conf.size-s)*(t.conf.inverse?-1:1);t.setValue(a,!0)},this._cleanMove=function(e){"function"==typeof window.addEventListener?(window.removeEventListener("mousemove",t._move,!1),window.removeEventListener("mouseup",t._cleanMove,!1),window.removeEventListener("touchmove",t._move,!1),window.removeEventListener("touchend",t._cleanMove,!1)):(document.body.detachEvent("onmousemove",t._move),document.body.detachEvent("onmouseup",t._cleanMove)),t._movingInitialValues=null,t._nodes.runner.className=t._nodes.runner.className.replace(/\s{0,}dhxsl_runner_actv/gi,""),t.callEvent("onSlideEnd",[t.conf.value]),t.callEvent("_onRunnerMouseUp",[])},this._doOnSetValue=function(e){if(null!=t._movingInitialValues)return!1;"function"==typeof(e=e||event).preventDefault&&e.preventDefault();var n=t.conf.vertical?e.offsetY||e.layerY:e.offsetX||e.layerX,s=(t.conf.vertical?t._nodes.runner.offoffsetHeightsetHe:t._nodes.runner.offsetWidth,n*(t.conf.max-t.conf.min)/t.conf.size+t.conf.min);return t.setValue(s,!0),null==t._movingInitialValues&&t._initMover(e),!1},this._doOnChangeInput=function(e){var n=(e=e||event).target||e.srcElement;t.setValue(n.value)},this._doOnKeyDown=function(e){var n=(e=e||event).target||e.srcElement;13==e.keyCode&&t.setValue(n.value)},this._attachEvents(this._nodes),this.unload=function(){dhx4._eventable(this,"clear"),this._detachNode(),this._detachEvents(this._nodes),this.base.removeChild(this._nodes.cont),this._nodes.cont.onmousedown=this._nodes.track.onmousedown=this._nodes.cont.onselectstart=this._nodes.track.onselectstart=null,delete this._nodes.cont,delete this._nodes.track,delete this._nodes.max,delete this._nodes.min,delete this._nodes.runner,/\s?dhtmlxslider_\S*/.test(this.base.className)&&(this.base.className=this.base.className.replace(/\s?dhtmlxslider_\S*/,""));for(var e in this)this[e]=null;t=null},dhx4._eventable(this),this.conf.disabled&&this.disable(),this.conf.tooltip&&this.enableTooltip(),this.conf.visible||this.hide(),this.conf.linkTo&&this.linkTo(this.conf.linkTo),this}dhtmlXSlider.prototype._setOrient=function(e){e=e||!1,/\s?dhxsl_cont_hr/i.test(this._nodes.cont.className)&&(this._nodes.cont.className=this._nodes.cont.className.replace(/\s?dhxsl_cont_hr/i,"")),/\s?dhxsl_cont_vr/i.test(this._nodes.cont.className)&&(this._nodes.cont.className=this._nodes.cont.className.replace(/\s?dhxsl_cont_vr/i,"")),this._nodes.cont.className+=e?" dhxsl_cont_vr":" dhxsl_cont_hr"},dhtmlXSlider.prototype._attachEvents=function(e){"function"==typeof window.addEventListener?(e.runner.addEventListener("mousedown",this._initMover,!1),e.runner.addEventListener("touchstart",this._initMover,!1),e.cont.addEventListener("mousedown",this._doOnSetValue,!1),e.cont.addEventListener("touchstart",this._doOnSetValue,!1)):(e.runner.attachEvent("onmousedown",this._initMover),e.cont.attachEvent("onmousedown",this._doOnSetValue))},dhtmlXSlider.prototype._detachEvents=function(e){"function"==typeof window.addEventListener?(e.runner.removeEventListener("mousedown",this._initMover,!1),e.runner.removeEventListener("touchstart",this._initMover,!1),e.cont.removeEventListener("mousedown",this._doOnSetValue,!1),e.cont.removeEventListener("touchstart",this._doOnSetValue,!1)):(e.runner.detachEvent("onmousedown",this._initMover),e.cont.detachEvent("onmousedown",this._doOnSetValue))},dhtmlXSlider.prototype._mergeConfig=function(e){for(var t in e)switch(t.toLowerCase()){case"min":case"max":case"size":case"step":case"value":case"inverse":this.conf[t]=e[t];break;case"tooltip":case"visible":case"vertical":case"disabled":this.conf[t]=dhx4.s2b(e[t]);break;case"parent":continue;default:this.conf[t]=e[t]}},dhtmlXSlider.prototype._readAttFormNode=function(e){var t,n,s=e.attributes,i=s.length,o={};for(t=0;t<i;t++)switch((n=s[t]).name.toLowerCase()){case"size":case"min":case"max":case"value":case"step":o[n.name]=n.value;break;case"skin":o.skin=n.value;break;case"vertical":case"disabled":case"visible":o[n.name]=dhx4.s2b(n.value);break;case"linkto":o.linkTo=n.value;break;case"tooltip":o.tooltip=dhx4.s2b(n.value)}return o},dhtmlXSlider.prototype._renderArgumets=function(e){var t,n,s={};for(n=e.length,t=0;t<n;t++)switch(t){case 0:s.parent=e[t];break;case 1:s.size=e[t];break;case 2:s.skin=e[t];break;case 3:s.vertical=e[t];break;case 4:s.min=e[t];break;case 5:s.max=e[t];break;case 6:s.value=e[t];break;case 7:s.step=e[t]}return s},dhtmlXSlider.prototype._skinCollection={dhx_skyblue:!0,dhx_web:!0,dhx_terrace:!0},dhtmlXSlider.prototype._indexOf=function(e,t){var n,s=-1;for(n=e.length;n>=0;n--)if(e[n]==t){s=n;break}return s},dhtmlXSlider.prototype._refreshRunner=function(){var e,t;this.conf.vertical?(e=this._nodes.cont.offsetHeight-this._nodes.runner.offsetHeight,t=this._getCoord(e),this._nodes.runner.style.top=t+this.conf.border+"px",this._nodes.runner.style.left=Math.round((this._nodes.cont.offsetWidth-this._nodes.runner.offsetWidth)/2)+"px"):(e=this._nodes.cont.offsetWidth-this._nodes.runner.offsetWidth,t=this._getCoord(e),this._nodes.runner.style.left=t+this.conf.border+"px",this._nodes.runner.style.top=Math.round((this._nodes.cont.offsetHeight-this._nodes.runner.offsetHeight)/2)+"px")},dhtmlXSlider.prototype._setValueByCoord=function(e){var t,n,s=dhx4.absLeft(this._nodes.cont),i=dhx4.absTop(this._nodes.cont);n=this.conf.vertical?(e.y-i-this._nodes.runner.offsetHeight/2)/(this._nodes.cont.offsetHeight-this._nodes.runner.offsetHeight):(e.x-s-this._nodes.runner.offsetWidth/2)/(this._nodes.cont.offsetWidth-this._nodes.runner.offsetWidth),t=(this.conf.max-this.conf.min)*n+this.conf.min,this.setValue(t,!0)},dhtmlXSlider.prototype._getCoord=function(e){var t=((this.conf.inverse?this._inverseValue(this.conf.value):this.conf.value)-this.conf.min)/(this.conf.max-this.conf.min);return Math.round(e*t)},dhtmlXSlider.prototype._normalize=function(e){e=Number(e),e=Math.round(e/this.conf.step)*this.conf.step;var t=Math.pow(10,this.conf.decimals);return e=Math.round(e*t)/t,e=Math.max(this.conf.min,Math.min(this.conf.max,e))},dhtmlXSlider.prototype._attachNode=function(e){var t=e.tagName.toLowerCase();if(t){switch(this._attachedNode.node=e,t){case"input":case"select":"function"==typeof window.addEventListener?(e.addEventListener("change",this._doOnChangeInput,!1),e.addEventListener("keydown",this._doOnKeyDown,!1)):(e.attachEvent("onchange",this._doOnChangeInput),e.attachEvent("onkeydown",this._doOnKeyDown)),this._attachedNode.setValue=function(e,t){if(e=String(e),t>0){var n=e.match(/\.\d{1,}$/);null!=n&&(t=Math.max(t-n[0].length+1)),e+=e.indexOf(".")<0?".":"";for(var s=0;s<t;s++)e+="0"}this.node.value=e};break;default:this._attachedNode.setValue=function(e){this.node.innerHTML=e}}this._attachedNode.setValue(this.conf.value,this.conf.decimals)}},dhtmlXSlider.prototype._detachNode=function(){var e=this._attachedNode.node;if(e){switch(e.tagName){case"input":case"select":"function"==typeof window.addEventListener?(e.removeEventListener("change",this._doOnChangeInput,!1),e.removeEventListener("keydown",this._doOnChangeInput,!1)):(e.detachEvent("change",this._doOnChangeInput),e.detachEvent("keydown",this._doOnChangeInput))}delete this._attachedNode.node,delete this._attachedNode.setValue}},dhtmlXSlider.prototype._detectDecimals=function(){var e=this.conf.step.toString().match(/\.(\d*)$/);this.conf.decimals=null!=e?e[1].length:0},dhtmlXSlider.prototype.setSize=function(e){isNaN(e)||(this.conf.vertical?(this._nodes.cont.style.width&&delete this._nodes.cont.style.width,this._nodes.cont.style.height=e-this.conf.margin+"px"):(this._nodes.cont.style.height&&delete this._nodes.cont.style.height,this._nodes.cont.style.width=e-this.conf.margin+"px"),this._refreshRunner())},dhtmlXSlider.prototype.setSkin=function(e){e=e.toLowerCase();var t,n,s=-1;if((t=this.base.className.match(/\S\w+/gi))instanceof Array){for(n in this._skinCollection){if(-1!=s)break;s=this._indexOf(t,"dhtmlxslider_"+n)}s=-1==s?t.length:s}else t=[],s=0;t[s]="dhtmlxslider_"+e,this.base.className=t.join(" "),this.conf.skin=e,this._nodes&&this._refreshRunner()},dhtmlXSlider.prototype.setValue=function(e,t){t=t||!1,isNaN(e)||(e=this._normalize(e),this.conf.value!=e&&(this.conf.value=e,this._refreshRunner(),this.conf.tooltip&&(this._nodes.cont.title=e),t&&this.callEvent("onChange",[e,this]))),"function"==typeof this._attachedNode.setValue&&this._attachedNode.setValue(this.conf.value,this.conf.decimals)},dhtmlXSlider.prototype.getValue=function(){return this.conf.value},dhtmlXSlider.prototype._inverseValue=function(){return this.conf.max+this.conf.min-this.conf.value},dhtmlXSlider.prototype.disable=function(e){if(e=0!=e){for(var t in this._nodes)"cont"!=t&&(new RegExp("\\s?dhxsl_"+t+"_dis","i").test(this._nodes[t].className)||(this._nodes[t].className+=" dhxsl_"+t+"_dis"));this.conf.disabled=!0}else this.enable()},dhtmlXSlider.prototype.enable=function(){var e;for(var t in this._nodes)"cont"!=t&&(e=new RegExp("\\s?dhxsl_"+t+"_dis","i")).test(this._nodes[t].className)&&(this._nodes[t].className=this._nodes[t].className.replace(e,""));this.conf.disabled=!1},dhtmlXSlider.prototype.isEnabled=function(){return!this.conf.disabled},dhtmlXSlider.prototype.disableTooltip=function(){this._nodes.cont.removeAttribute("title"),this.conf.tooltip=!1},dhtmlXSlider.prototype.enableTooltip=function(e){(e=void 0===e||dhx4.s2b(e))?(this._nodes.cont.title=this.conf.value,this.conf.tooltip=!0):this.disableTooltip()},dhtmlXSlider.prototype.setMax=function(e){!isNaN(e)&&this.conf.min<e&&(this.conf.max=e,this.setValue(this.conf.value))},dhtmlXSlider.prototype.getMax=function(){return this.conf.max},dhtmlXSlider.prototype.setMin=function(e){!isNaN(e)&&this.conf.max>e&&(this.conf.min=e,this.setValue(this.conf.value))},dhtmlXSlider.prototype.getMin=function(){return this.conf.min},dhtmlXSlider.prototype.setStep=function(e){var t=this.conf.max-this.conf.min;!isNaN(e)&&e<t&&(this.conf.step=e,this._detectDecimals(),this.setValue(this.conf.value))},dhtmlXSlider.prototype.getStep=function(){return this.conf.step},dhtmlXSlider.prototype.show=function(){/\s?dhxsl_hidden/i.test(this._nodes.cont.className)&&(this._nodes.cont.className=this._nodes.cont.className.replace(/\s?dhxsl_hidden/i,"")),this.conf.visible=!0},dhtmlXSlider.prototype.hide=function(){/\s?dhxsl_hidden/i.test(this._nodes.cont.className)||(this._nodes.cont.className+=" dhxsl_hidden"),this.conf.visible=!1},dhtmlXSlider.prototype.isVisible=function(){return this.conf.visible},dhtmlXSlider.prototype.linkTo=function(e){"string"==typeof e&&(e=document.getElementById(e)),this._attachedNode.node&&this._detachNode(),this._attachNode(e)},module.exports=dhtmlXSlider;

},{}],7:[function(require,module,exports){
var Hilitor2=function(e,t){function r(e){var t=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");return t[e>>12&15]+t[e>>8&15]+t[e>>4&15]+t[15&e]}var a=document.getElementById(e)||document.body,i=t||"EM",l=new RegExp("^(?:"+i+"|SCRIPT|FORM)$"),o=["#ff6","#a0ffff","#9f9","#f99","#f6f"],s=[],n=0,c="";this.setMatchType=function(e){switch(e){case"left":this.openLeft=!1,this.openRight=!0;break;case"right":this.openLeft=!0,this.openRight=!1;break;case"open":this.openLeft=this.openRight=!0;break;default:this.openLeft=this.openRight=!1}},this.setRegex=function(e){var t="("+(e=function(e){return retval=e,retval=retval.replace(/([ao])e/gi,"$1"),retval=retval.replace(/\\u00E[024]/gi,"a"),retval=retval.replace(/\\u00E[89AB]/gi,"e"),retval=retval.replace(/\\u00E[EF]/gi,"i"),retval=retval.replace(/\\u00F[46]/gi,"o"),retval=retval.replace(/\\u00F[9BC]/gi,"u"),retval=retval.replace(/\\u00FF/gi,"y"),retval=retval.replace(/\\u00DF/gi,"s"),retval=retval.replace(/a/gi,"([aàâä]|ae)"),retval=retval.replace(/e/gi,"[eèéêë]"),retval=retval.replace(/i/gi,"[iîï]"),retval=retval.replace(/o/gi,"([oôö]|oe)"),retval=retval.replace(/u/gi,"[uùûü]"),retval=retval.replace(/y/gi,"[yÿ]"),retval=retval.replace(/s/gi,"(ss|[sß])"),retval}(e=e.replace(/\\([^u]|$)/g,"$1")))+")";this.openLeft||(t="(?:^|[\\b\\s])"+t),this.openRight||(t+="(?:[\\b\\s]|$)"),c=new RegExp(t,"i")},this.getRegex=function(){var e=c.toString();return e=e.replace(/(^\/|\(\?:[^\)]+\)|\/i$)/g,"")},this.hiliteWords=function(e){if(void 0!==e&&e&&c&&!l.test(e.nodeName)){if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)this.hiliteWords(e.childNodes[t]);if(3==e.nodeType&&(nv=e.nodeValue)&&(regs=c.exec(nv))){s[regs[1].toLowerCase()]||(s[regs[1].toLowerCase()]=o[n++%o.length]);var r=document.createElement(i);r.appendChild(document.createTextNode(regs[1])),r.style.backgroundColor=s[regs[1].toLowerCase()],r.style.fontStyle="inherit",r.style.color="#000";var a;(a=regs[0].match(/^\s/)?e.splitText(regs.index+1):e.splitText(regs.index)).nodeValue=a.nodeValue.substring(regs[1].length),e.parentNode.insertBefore(r,a)}}},this.remove=function(){for(var e=document.getElementsByTagName(i);e.length&&(el=e[0]);){var t=el.parentNode;t.replaceChild(el.firstChild,el),t.normalize()}},this.apply=function(e){this.remove(),void 0!==e&&(e=e.replace(/(^\s+|\s+$)/g,""))&&(e=function(e,t){for(var a,i,l=0,o="",s=0;s<e.length;s++){var n=e.charCodeAt(s);if((n<0||n>65535)&&(o+="!Error in convertCharStr2UTF16: unexpected charCodeAt result, cc="+n+"!"),0!=l){if(56320<=n&&n<=57343){if(a=65536+(l-55296<<10)+(n-56320),t){for(i=a.toString(16);i.length<8;)i="0"+i;o+="\\U"+i}else o+="\\u"+r(55296|(a-=65536)>>10)+"\\u"+r(56320|1023&a);l=0;continue}o+="Error in convertCharStr2UTF16: low surrogate expected, cc="+n+"!",l=0}if(55296<=n&&n<=56319)l=n;else switch(n){case 0:o+="\\0";break;case 8:o+="\\b";break;case 9:o+="\\t";break;case 10:o+="\\n";break;case 13:o+="\\r";break;case 11:o+="\\v";break;case 12:o+="\\f";break;case 34:o+='\\"';break;case 39:o+="\\'";break;case 92:o+="\\\\";break;default:if(n>31&&n<127)o+=String.fromCharCode(n);else{for(i=n.toString(16).toUpperCase();i.length<4;)i="0"+i;o+="\\u"+i}}}return o}(e),this.setRegex(e),this.hiliteWords(a))}};module.exports=Hilitor2;

},{}],8:[function(require,module,exports){
!function(t,e){function i(t,e,i){return[parseFloat(t[0])*(d.test(t[0])?e/100:1),parseFloat(t[1])*(d.test(t[1])?i/100:1)]}function o(e,i){return parseInt(t.css(e,i),10)||0}t.ui=t.ui||{};var l,n=Math.max,s=Math.abs,f=Math.round,r=/left|center|right/,h=/top|center|bottom/,p=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,d=/%$/,a=t.fn.pos;t.pos={scrollbarWidth:function(){if(void 0!==l)return l;var e,i,o=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=o.children()[0];return t("body").append(o),e=n.offsetWidth,o.css("overflow","scroll"),i=n.offsetWidth,e===i&&(i=o[0].clientWidth),o.remove(),l=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),o=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),l="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth;return{width:"scroll"===o||"auto"===o&&e.height<e.element[0].scrollHeight?t.pos.scrollbarWidth():0,height:l?t.pos.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),o=t.isWindow(i[0]);return{element:i,isWindow:o,isDocument:!!i[0]&&9===i[0].nodeType,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:o?i.width():i.outerWidth(),height:o?i.height():i.outerHeight()}}},t.fn.pos=function(e){if(!e||!e.of)return a.apply(this,arguments);e=t.extend({},e);var l,d,g,u,m,w,W=t(e.of),v=t.pos.getWithinInfo(e.within),y=t.pos.getScrollInfo(v),b=(e.collision||"flip").split(" "),T={};return w=function(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}(W),W[0].preventDefault&&(e.at="left top"),d=w.width,g=w.height,u=w.offset,m=t.extend({},u),t.each(["my","at"],function(){var t,i,o=(e[this]||"").split(" ");1===o.length&&(o=r.test(o[0])?o.concat(["center"]):h.test(o[0])?["center"].concat(o):["center","center"]),o[0]=r.test(o[0])?o[0]:"center",o[1]=h.test(o[1])?o[1]:"center",t=p.exec(o[0]),i=p.exec(o[1]),T[this]=[t?t[0]:0,i?i[0]:0],e[this]=[c.exec(o[0])[0],c.exec(o[1])[0]]}),1===b.length&&(b[1]=b[0]),"right"===e.at[0]?m.left+=d:"center"===e.at[0]&&(m.left+=d/2),"bottom"===e.at[1]?m.top+=g:"center"===e.at[1]&&(m.top+=g/2),l=i(T.at,d,g),m.left+=l[0],m.top+=l[1],this.each(function(){var r,h,p=t(this),c=p.outerWidth(),a=p.outerHeight(),w=o(this,"marginLeft"),H=o(this,"marginTop"),x=c+w+o(this,"marginRight")+y.width,L=a+H+o(this,"marginBottom")+y.height,C=t.extend({},m),_=i(T.my,p.outerWidth(),p.outerHeight());"right"===e.my[0]?C.left-=c:"center"===e.my[0]&&(C.left-=c/2),"bottom"===e.my[1]?C.top-=a:"center"===e.my[1]&&(C.top-=a/2),C.left+=_[0],C.top+=_[1],t.support.offsetFractions||(C.left=f(C.left),C.top=f(C.top)),r={marginLeft:w,marginTop:H},t.each(["left","top"],function(i,o){t.ui.pos[b[i]]&&t.ui.pos[b[i]][o](C,{targetWidth:d,targetHeight:g,elemWidth:c,elemHeight:a,collisionPosition:r,collisionWidth:x,collisionHeight:L,offset:[l[0]+_[0],l[1]+_[1]],my:e.my,at:e.at,within:v,elem:p})}),e.using&&(h=function(t){var i=u.left-C.left,o=i+d-c,l=u.top-C.top,f=l+g-a,r={target:{element:W,left:u.left,top:u.top,width:d,height:g},element:{element:p,left:C.left,top:C.top,width:c,height:a},horizontal:o<0?"left":i>0?"right":"center",vertical:f<0?"top":l>0?"bottom":"middle"};d<c&&s(i+o)<d&&(r.horizontal="center"),g<a&&s(l+f)<g&&(r.vertical="middle"),n(s(i),s(o))>n(s(l),s(f))?r.important="horizontal":r.important="vertical",e.using.call(this,t,r)}),p.offset(t.extend(C,{using:h}))})},t.ui.pos={_trigger:function(t,e,i,o){e.elem&&e.elem.trigger({type:i,position:t,positionData:e,triggered:o})},fit:{left:function(e,i){t.ui.pos._trigger(e,i,"posCollide","fitLeft");var o,l=i.within,s=l.isWindow?l.scrollLeft:l.offset.left,f=l.width,r=e.left-i.collisionPosition.marginLeft,h=s-r,p=r+i.collisionWidth-f-s;i.collisionWidth>f?h>0&&p<=0?(o=e.left+h+i.collisionWidth-f-s,e.left+=h-o):e.left=p>0&&h<=0?s:h>p?s+f-i.collisionWidth:s:h>0?e.left+=h:p>0?e.left-=p:e.left=n(e.left-r,e.left),t.ui.pos._trigger(e,i,"posCollided","fitLeft")},top:function(e,i){t.ui.pos._trigger(e,i,"posCollide","fitTop");var o,l=i.within,s=l.isWindow?l.scrollTop:l.offset.top,f=i.within.height,r=e.top-i.collisionPosition.marginTop,h=s-r,p=r+i.collisionHeight-f-s;i.collisionHeight>f?h>0&&p<=0?(o=e.top+h+i.collisionHeight-f-s,e.top+=h-o):e.top=p>0&&h<=0?s:h>p?s+f-i.collisionHeight:s:h>0?e.top+=h:p>0?e.top-=p:e.top=n(e.top-r,e.top),t.ui.pos._trigger(e,i,"posCollided","fitTop")}},flip:{left:function(e,i){t.ui.pos._trigger(e,i,"posCollide","flipLeft");var o,l,n=i.within,f=n.offset.left+n.scrollLeft,r=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,p=e.left-i.collisionPosition.marginLeft,c=p-h,d=p+i.collisionWidth-r-h,a="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,g="left"===i.at[0]?i.targetWidth:"right"===i.at[0]?-i.targetWidth:0,u=-2*i.offset[0];c<0?((o=e.left+a+g+u+i.collisionWidth-r-f)<0||o<s(c))&&(e.left+=a+g+u):d>0&&((l=e.left-i.collisionPosition.marginLeft+a+g+u-h)>0||s(l)<d)&&(e.left+=a+g+u),t.ui.pos._trigger(e,i,"posCollided","flipLeft")},top:function(e,i){t.ui.pos._trigger(e,i,"posCollide","flipTop");var o,l,n=i.within,f=n.offset.top+n.scrollTop,r=n.height,h=n.isWindow?n.scrollTop:n.offset.top,p=e.top-i.collisionPosition.marginTop,c=p-h,d=p+i.collisionHeight-r-h,a="top"===i.my[1]?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,g="top"===i.at[1]?i.targetHeight:"bottom"===i.at[1]?-i.targetHeight:0,u=-2*i.offset[1];c<0?(l=e.top+a+g+u+i.collisionHeight-r-f,e.top+a+g+u>c&&(l<0||l<s(c))&&(e.top+=a+g+u)):d>0&&(o=e.top-i.collisionPosition.marginTop+a+g+u-h,e.top+a+g+u>d&&(o>0||s(o)<d)&&(e.top+=a+g+u)),t.ui.pos._trigger(e,i,"posCollided","flipTop")}},flipfit:{left:function(){t.ui.pos.flip.left.apply(this,arguments),t.ui.pos.fit.left.apply(this,arguments)},top:function(){t.ui.pos.flip.top.apply(this,arguments),t.ui.pos.fit.top.apply(this,arguments)}}},function(){var e,i,o,l,n,s=document.getElementsByTagName("body")[0],f=document.createElement("div");e=document.createElement(s?"div":"body"),o={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&t.extend(o,{position:"absolute",left:"-1000px",top:"-1000px"});for(n in o)e.style[n]=o[n];e.appendChild(f),(i=s||document.documentElement).insertBefore(e,i.firstChild),f.style.cssText="position: absolute; left: 10.7432222px;",l=t(f).offset().left,t.support.offsetFractions=l>10&&l<11,e.innerHTML="",i.removeChild(e)}()}(jQuery);

},{}],9:[function(require,module,exports){
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):e.mobiscroll=t(e.jQuery)}(this,function(e){"use strict";function t(e,t,s){var n=e;return"object"===(void 0===t?"undefined":P(t))?e.each(function(){new V.classes[t.component||"Scroller"](this,t)}):("string"==typeof t&&e.each(function(){var e,a=V.instances[this.id];if(a&&a[t]&&void 0!==(e=a[t].apply(this,Array.prototype.slice.call(s,1))))return n=e,!1}),n)}function s(){}function n(e){return e-parseFloat(e)>=0}function a(e){return"string"==typeof e}function o(e,t,s){return Math.max(t,Math.min(e,s))}function i(){B++,setTimeout(function(){B--},500)}function c(e,t,s){var n=e.originalEvent||e,a=(s?"page":"client")+t;return n.targetTouches&&n.targetTouches[0]?n.targetTouches[0][a]:n.changedTouches&&n.changedTouches[0]?n.changedTouches[0][a]:e[a]}function r(e,t,s,n,a,o){var r,l,m,d,u,p=(0,V.$)(t);a=a||9,e.settings.tap&&p.on("touchstart.mbsc",function(e){m||(n&&e.preventDefault(),m=this,r=c(e,"X"),l=c(e,"Y"),d=!1,u=new Date)}).on("touchcancel.mbsc",function(){m=!1}).on("touchmove.mbsc",function(e){m&&!d&&(Math.abs(c(e,"X")-r)>a||Math.abs(c(e,"Y")-l)>a)&&(d=!0)}).on("touchend.mbsc",function(t){m&&((o&&new Date-u<100||!d)&&(t.preventDefault(),s.call(m,t,e)),m=!1,i())}),p.on("click.mbsc",function(t){t.preventDefault(),s.call(this,t,e)})}function l(e){if(B&&!e.tap&&("TEXTAREA"!=e.target.nodeName||"mousedown"!=e.type))return e.stopPropagation(),e.preventDefault(),!1}function m(e){var t;for(t in e)if(void 0!==Q[e[t]])return!0;return!1}function d(e,t){if("touchstart"==e.type)U(t).attr("data-touch","1");else if(U(t).attr("data-touch"))return U(t).removeAttr("data-touch"),!1;return!0}function u(e,t){var s,n=getComputedStyle(e[0]);return U.each(["t","webkitT","MozT","OT","msT"],function(e,t){if(void 0!==n[t+"ransform"])return s=n[t+"ransform"],!1}),s=s.split(")")[0].split(", "),t?s[13]||s[5]:s[12]||s[4]}function p(e){ke.length||e.show(),ke.push(e)}function h(e,t,s,n){return K({display:t.display||"center",cssClass:"mbsc-alert",okText:t.okText,cancelText:t.cancelText,context:t.context,theme:t.theme,closeOnOverlayTap:!1,onBeforeClose:function(){e.shift()},onBeforeShow:function(){V.activeInstance=null},onHide:function(e,n){s&&s(n._resolve),t.callback&&t.callback(n._resolve),n&&n.destroy(),ke.length?ke[0].show():Te.length&&Te[0].show(!1,!0)}},n)}function f(e){return(e.title?"<h2>"+e.title+"</h2>":"")+"<p>"+(e.message||"")+"</p>"}function b(e,t,s){p(new xe(e,h(ke,t,s)))}function v(e,t,s){var n=new xe(e,h(ke,t,s,{buttons:["ok","cancel"],onSet:function(){n._resolve=!0}}));n._resolve=!1,p(n)}function _(e,t,s){var n=void 0,a=new xe(e,h(ke,t,s,{buttons:["ok","cancel"],onShow:function(){n=a._markup.find("input")[0],setTimeout(function(){n.focus()},300)},onSet:function(){a._resolve=n.value}}));a._resolve=null,p(a)}function g(e,t,s,n,a){var o=void 0;!function(e){var t=Te.length;Te.push(e),ke.length||(t?Te[0].hide():e.show(!1,!0))}(new xe(e,h(Te,t,s,{display:"bottom",animate:a,cssClass:n||"mbsc-snackbar",scrollLock:!1,focusTrap:!1,buttons:[],onShow:function(e,s){!1!==t.duration&&(o=setTimeout(function(){s&&s.hide()},t.duration||3e3)),t.button&&s.tap(U(".mbsc-snackbar-btn",e.target),function(){s.hide(),t.button.action&&t.button.action.call(this)})},onClose:function(){clearTimeout(o)}})))}function y(e,t,s){g(e,t,s,"mbsc-toast","fade")}function w(e,t,s){var n=void 0;return Ce?n=new Promise(function(n){e(t,s,n)}):e(t,s),n}function x(e,t){var s={},n=e.parent(),a=n.find(".mbsc-err-msg"),o=e.attr("data-icon-align")||"left",i=e.attr("data-icon");n.hasClass(Me)?n=n.parent():U('<span class="'+Me+'"></span>').insertAfter(e).append(e),a&&n.find("."+Me).append(a),i&&(-1!==i.indexOf("{")?s=JSON.parse(i):s[o]=i),(i||t)&&(K(s,t),n.addClass((s.right?"mbsc-ic-right ":"")+(s.left?" mbsc-ic-left":"")).find("."+Me).append(s.left?'<span class="mbsc-input-ic mbsc-left-ic mbsc-ic mbsc-ic-'+s.left+'"></span>':"").append(s.right?'<span class="mbsc-input-ic mbsc-right-ic mbsc-ic mbsc-ic-'+s.right+'"></span>':""))}function C(e,t){"button"!=t&&"submit"!=t&&"segmented"!=t&&(e.addClass("mbsc-control-w").find("label").addClass("mbsc-label"),e.contents().filter(function(){return 3==this.nodeType&&this.nodeValue&&/\S/.test(this.nodeValue)}).each(function(){U('<span class="mbsc-label"></span>').insertAfter(this).append(this)}))}function k(e){var t=e[0],s=e.attr("data-role"),n=e.attr("type")||t.nodeName.toLowerCase();return/(switch|range|segmented|stepper)/.test(s)&&(n=s),n}function T(e){var t=V.themes.form[e];return t&&t.addRipple?t:null}function M(){clearTimeout(We),We=setTimeout(function(){U("textarea.mbsc-control").each(function(){S(this)})},100)}function S(e){var t=void 0,s=void 0,n=void 0,a=U(e).attr("rows")||6;e.offsetHeight&&(e.style.height="",n=e.scrollHeight-e.offsetHeight,t=e.offsetHeight+(n>0?n:0),(s=Math.round(t/24))>a?(e.scrollTop=t,t=24*a+(t-24*s),U(e).addClass("mbsc-textarea-scroll")):U(e).removeClass("mbsc-textarea-scroll"),t&&(e.style.height=t+"px"))}e=e&&e.hasOwnProperty("default")?e.default:e;var V=V||{},P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},$=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),O=function e(t,s,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,s);if(void 0===a){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,s,n)}if("value"in a)return a.value;var i=a.get;return void 0!==i?i.call(n):void 0},L=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},A=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},D=e.extend;V.presetShort=function(e,s,n){V.components[e]=function(a){return t(this,D(a,{component:s,preset:!1===n?void 0:e}),arguments)}},V.$=e,e.mobiscroll=V,e.fn.mobiscroll=function(e){return D(this,V.components),t(this,e,arguments)};var I,W,Y,X,j=[],H="undefined"!=typeof window,R=H?navigator.userAgent:"",F=R.match(/Android|iPhone|iPad|iPod|Windows Phone|Windows|MSIE/i),q=H&&window.requestAnimationFrame||function(e){e()},z=H&&window.cancelAnimationFrame||function(){};/Android/i.test(F)?(I="android",(W=R.match(/Android\s+([\d\.]+)/i))&&(j=W[0].replace("Android ","").split("."))):/iPhone|iPad|iPod/i.test(F)?(I="ios",(W=R.match(/OS\s+([\d\_]+)/i))&&(j=W[0].replace(/_/g,".").replace("OS ","").split("."))):/Windows Phone/i.test(F)?I="wp":/Windows|MSIE/i.test(F)&&(I="windows"),Y=j[0],X=j[1];var B=0;H&&(["mouseover","mousedown","mouseup","click"].forEach(function(e){document.addEventListener(e,l,!0)}),"android"==I&&Y<5&&document.addEventListener("change",function(e){B&&"checkbox"==e.target.type&&!e.target.mbscChange&&(e.stopPropagation(),e.preventDefault()),delete e.target.mbscChange},!0));var N,U=V.$,G=+new Date,J={},K=U.extend;(N=K(V,{$:U,version:"3.2.6",util:{getCoord:c,preventClick:i,vibrate:function(e){"vibrate"in navigator&&navigator.vibrate(e||50)}},autoTheme:"mobiscroll",presets:{scroller:{},numpad:{},listview:{},menustrip:{}},themes:{form:{},page:{},frame:{},scroller:{},listview:{},menustrip:{},progress:{}},platform:{name:I,majorVersion:Y,minorVersion:X},i18n:{},instances:J,classes:{},components:{},settings:{},setDefaults:function(e){K(this.settings,e)},customTheme:function(e,t){var s,n=V.themes,a=["frame","scroller","listview","menustrip","form","progress"];for(s=0;s<a.length;s++)n[a[s]][e]=K({},n[a[s]][t],{baseTheme:t})}})).presetShort=N.presetShort||function(){};var Z,Q,ee,te,se=function(e,t){var n,a,o,i,c,l,m,d=this;d.settings={},d._init=s,d._destroy=s,d._processSettings=s,d.init=function(s){var r;for(r in d.settings)delete d.settings[r];o=d.settings,K(t,s),d._hasDef&&(m=N.settings),K(o,d._defaults,m,t),d._hasTheme&&("auto"!=(c=o.theme)&&c||(c=N.autoTheme),"default"==c&&(c="mobiscroll"),t.theme=c,i=N.themes[d._class]?N.themes[d._class][c]:{}),d._hasLang&&(n=N.i18n[o.lang]),d._hasTheme&&l("onThemeLoad",{lang:n,settings:t}),K(o,i,n,m,t),d._processSettings(),d._hasPreset&&(a=N.presets[d._class][o.preset])&&(a=a.call(e,d),K(o,a,t)),d._init(s),l("onInit")},d.destroy=function(){d&&(d._destroy(),l("onDestroy"),delete J[e.id],d=null)},d.tap=function(e,t,s,n,a){r(d,e,t,s,n,a)},d.trigger=function(s,n){var o,c,r,l=[m,i,a,t];for(c=0;c<4;c++)(r=l[c])&&r[s]&&(o=r[s].call(e,n||{},d));return o},d.option=function(e,t){var s={};"object"===(void 0===e?"undefined":P(e))?s=e:s[e]=t,d.init(s)},d.getInst=function(){return d},t=t||{},l=d.trigger,d.__ready||(U(e).addClass("mbsc-comp"),e.id?J[e.id]&&J[e.id].destroy():e.id="mobiscroll"+ ++G,J[e.id]=d,d.__ready=!0)};H&&(Q=document.createElement("modernizr").style,ee=function(){var e,t=["Webkit","Moz","O","ms"];for(e in t)if(m([t[e]+"Transform"]))return"-"+t[e].toLowerCase()+"-";return""}(),te=ee.replace(/^\-/,"").replace(/\-$/,"").replace("moz","Moz"),Z=void 0!==Q.animation?"animationend":"webkitAnimationEnd");var ne,ae,oe=V.classes,ie=V.themes,ce=/(iphone|ipod)/i.test(R)&&Y>=7,re="android"==I,le="ios"==I,me=le&&8==Y,de=le&&Y>7,ue=function(e){e.preventDefault()},pe=function(e,t,n){function r(e){$&&$.removeClass("mbsc-fr-btn-a"),($=U(this)).hasClass("mbsc-fr-btn-d")||$.hasClass("mbsc-fr-btn-nhl")||$.addClass("mbsc-fr-btn-a"),"mousedown"===e.type?U(document).on("mouseup",l):"pointerdown"===e.type&&U(document).on("pointerup",l)}function l(e){$&&($.removeClass("mbsc-fr-btn-a"),$=null),"mouseup"===e.type?U(document).off("mouseup",l):"pointerup"===e.type&&U(document).off("pointerup",l)}function m(e){13==e.keyCode?oe.select():27==e.keyCode&&oe.cancel()}function d(e){e||re||R.focus(),oe.ariaMessage(B.ariaMessage)}function u(e){var t=ne,s=B.focusOnClose;oe._markupRemove(),C.remove(),D&&(O.mbscModals--,B.scrollLock&&O.mbscLock--,O.mbscLock||x.removeClass("mbsc-fr-lock"),O.mbscModals||(x.removeClass("mbsc-fr-lock-ios mbsc-fr-lock-ctx"),H&&(y.css({top:"",left:""}),S.scrollLeft(N),S.scrollTop(J)),e||(t||(t=ie),setTimeout(function(){void 0===s||!0===s?(ae=!0,t[0].focus()):s&&U(s)[0].focus()},200)))),oe._isVisible=!1,I=!1,Q("onHide")}function p(e){clearTimeout(me[e.type]),me[e.type]=setTimeout(function(){var t="scroll"==e.type;t&&!G||(oe.position(!t),"orientationchange"==e.type&&(F.style.display="none",F.offsetHeight,F.style.display=""))},200)}function h(e){e.target.nodeType&&!R.contains(e.target)&&R.focus()}function f(e,t){e&&e(),!1!==oe.show()&&(ne=t)}function b(){oe._fillValue(),Q("onSet",{valueText:oe._value})}function v(){Q("onCancel",{valueText:oe._value})}function _(){oe.setVal(null,!0)}var g,y,w,x,C,k,T,M,S,P,E,$,O,L,A,D,I,W,Y,X,j,H,R,F,q,z,B,N,G,J,K,Q,ee,te,oe=this,ie=U(e),le=[],me={};se.call(this,e,t,!0),oe.position=function(e){var t,s,n,a,i,c,r,l,m,d,u,p,h,f,b,v,_={},g=0,w=0,x=0,k=0;!z&&I&&(oe._position(C),p=W.offsetHeight,h=W.offsetWidth,ee===h&&te===p&&e||(oe._isFullScreen||/top|bottom/.test(B.display)?M.width(h):P.width(""),!1!==Q("onPosition",{target:W,windowWidth:h,windowHeight:p})&&D&&(U(".mbsc-comp",C).each(function(){var e=V.instances[this.id];e&&e!==oe&&e.position&&e.position()}),!oe._isFullScreen&&/center|bubble/.test(B.display)&&(U(".mbsc-w-p",C).each(function(){f=this.getBoundingClientRect().width,k+=f,x=f>x?f:x}),P.css({width:oe._isLiquid?Math.min(B.maxPopupWidth,h-16):Math.ceil(k>h?x:k),"white-space":k>h?"":"nowrap"})),Y=F.offsetWidth,X=F.offsetHeight,G=X<=p&&Y<=h,j&&(g=S.scrollLeft(),w=S.scrollTop()),"center"==B.display?(v=Math.max(0,g+(h-Y)/2),b=Math.max(0,w+(p-X)/2)):"bubble"==B.display?(t=void 0===B.anchor?ie:U(B.anchor),r=U(".mbsc-fr-arr-i",C)[0],a=t.offset(),i=a.top+(A?w-y.offset().top:0),c=a.left+(A?g-y.offset().left:0),s=t[0].offsetWidth,n=t[0].offsetHeight,l=r.offsetWidth,m=r.offsetHeight,v=o(c-(Y-s)/2,g+8,g+h-Y-8),(b=i-X-m/2)<w||i>w+p?(M.removeClass("mbsc-fr-bubble-top").addClass("mbsc-fr-bubble-bottom"),b=i+n+m/2):M.removeClass("mbsc-fr-bubble-bottom").addClass("mbsc-fr-bubble-top"),U(".mbsc-fr-arr",C).css({left:o(c+s/2-(v+(Y-l)/2),0,l)}),G=b>w&&v>g&&b+X<=w+p&&v+Y<=g+h):(v=g,b="top"==B.display?w:Math.max(0,w+p-X)),j&&(d=Math.max(b+X,A?O.scrollHeight:U(document).height()),u=Math.max(v+Y,A?O.scrollWidth:U(document).width()),T.css({width:u,height:d}),B.scroll&&"bubble"==B.display&&(b+X+8>w+p||i>w+p||i+n<w)&&(z=!0,setTimeout(function(){z=!1},300),S.scrollTop(Math.min(i,b+X-p+8,d-p)))),_.top=Math.floor(b),_.left=Math.floor(v),M.css(_),ee=h,te=p)))},oe.attachShow=function(e,t){var s,n=U(e),a=n.prop("readonly");if("inline"!==B.display){if((B.showOnFocus||B.showOnTap)&&n.is("input,select")&&(n.prop("readonly",!0).on("mousedown.mbsc",function(e){e.preventDefault()}).on("focus.mbsc",function(){oe._isVisible&&this.blur()}),(s=U('label[for="'+n.attr("id")+'"]')).length||(s=n.closest("label"))),n.is("select"))return;B.showOnFocus&&n.on("focus.mbsc",function(){ae?ae=!1:f(t,n)}),B.showOnTap&&(n.on("keydown.mbsc",function(e){32!=e.keyCode&&13!=e.keyCode||(e.preventDefault(),e.stopPropagation(),f(t,n))}),oe.tap(n,function(){f(t,n)}),s&&s.length&&oe.tap(s,function(){f(t,n)})),le.push({readOnly:a,el:n,lbl:s})}},oe.select=function(){D?oe.hide(!1,"set",!1,b):b()},oe.cancel=function(){D?oe.hide(!1,"cancel",!1,v):v()},oe.clear=function(){oe._clearValue(),Q("onClear"),D&&oe._isVisible&&!oe.live?oe.hide(!1,"clear",!1,_):_()},oe.enable=function(){B.disabled=!1,oe._isInput&&ie.prop("disabled",!1)},oe.disable=function(){B.disabled=!0,oe._isInput&&ie.prop("disabled",!0)},oe.show=function(e,t){function s(){C.off(Z,s).removeClass("mbsc-anim-in mbsc-anim-trans mbsc-anim-trans-"+L).find(".mbsc-fr-popup").removeClass("mbsc-anim-"+L),d(t)}var n,o;if(!B.disabled&&!oe._isVisible){if(oe._readValue(),!1===Q("onBeforeShow"))return!1;if(ne=null,L=B.animate,E=B.buttons||[],j=A||"bubble"==B.display,H=ce&&!j&&B.scrollLock,n=E.length>0,K=!1,!1!==L&&("top"==B.display?L=L||"slidedown":"bottom"==B.display?L=L||"slideup":"center"!=B.display&&"bubble"!=B.display||(L=L||"pop")),D&&(J=Math.max(0,S.scrollTop()),N=Math.max(0,S.scrollLeft()),ee=0,te=0,H&&!x.hasClass("mbsc-fr-lock-ios")&&y.css({top:-J+"px",left:-N+"px"}),x.addClass((B.scrollLock?"mbsc-fr-lock":"")+(H?" mbsc-fr-lock-ios":"")+(A?" mbsc-fr-lock-ctx":"")),U(document.activeElement).is("input,textarea")&&document.activeElement.blur(),V.activeInstance&&V.activeInstance.hide(),V.activeInstance=oe,O.mbscModals=O.mbscModals||0,O.mbscLock=O.mbscLock||0,O.mbscModals++,B.scrollLock&&O.mbscLock++),o='<div lang="'+B.lang+'" class="mbsc-fr mbsc-no-touch mbsc-'+B.theme+(B.baseTheme?" mbsc-"+B.baseTheme:"")+" mbsc-fr-"+B.display+" "+(B.cssClass||"")+" "+(B.compClass||"")+(oe._isLiquid?" mbsc-fr-liq":"")+(de?" mbsc-fr-hb":"")+(H?" mbsc-platform-ios":"")+(n?E.length>=3?" mbsc-fr-btn-block ":"":" mbsc-fr-nobtn")+'">'+(D?'<div class="mbsc-fr-persp"><div class="mbsc-fr-overlay"></div><div role="dialog" tabindex="-1" class="mbsc-fr-scroll">':"")+'<div class="mbsc-fr-popup'+(B.rtl?" mbsc-rtl":" mbsc-ltr")+(B.headerText?" mbsc-fr-has-hdr":"")+'">'+("bubble"===B.display?'<div class="mbsc-fr-arr-w"><div class="mbsc-fr-arr-i"><div class="mbsc-fr-arr"></div></div></div>':"")+'<div class="mbsc-fr-w"><div aria-live="assertive" class="mbsc-fr-aria mbsc-fr-hdn"></div>'+(B.headerText?'<div class="mbsc-fr-hdr">'+(a(B.headerText)?B.headerText:"")+"</div>":"")+'<div class="mbsc-fr-c">',o+=oe._generateContent(),o+="</div>",n&&(o+='<div class="mbsc-fr-btn-cont">',U.each(E,function(e,t){"set"===(t=a(t)?oe.buttons[t]:t).handler&&(t.parentClass="mbsc-fr-btn-s"),"cancel"===t.handler&&(t.parentClass="mbsc-fr-btn-c"),o+="<div"+(B.btnWidth?' style="width:'+100/E.length+'%"':"")+' class="mbsc-fr-btn-w '+(t.parentClass||"")+'"><div tabindex="0" role="button" class="mbsc-fr-btn'+e+" mbsc-fr-btn-e "+(void 0===t.cssClass?B.btnClass:t.cssClass)+(t.icon?" mbsc-ic mbsc-ic-"+t.icon:"")+'">'+(t.text||"")+"</div></div>"}),o+="</div>"),o+="</div></div></div></div>"+(D?"</div></div>":""),C=U(o),T=U(".mbsc-fr-persp",C),k=U(".mbsc-fr-scroll",C),P=U(".mbsc-fr-w",C),w=U(".mbsc-fr-hdr",C),M=U(".mbsc-fr-popup",C),g=U(".mbsc-fr-aria",C),W=C[0],R=k[0],F=M[0],oe._markup=C,oe._header=w,oe._isVisible=!0,q="orientationchange resize",oe._markupReady(C),Q("onMarkupReady",{target:W}),D){if(U(window).on("keydown",m),B.scrollLock&&C.on("touchmove mousewheel wheel",function(e){G&&e.preventDefault()}),B.focusTrap&&S.on("focusin",h),B.closeOnOverlayTap){var u,f,b,v;k.on("touchstart mousedown",function(e){f||e.target!=k[0]||(f=!0,u=!1,b=c(e,"X"),v=c(e,"Y"))}).on("touchmove mousemove",function(e){f&&!u&&(Math.abs(c(e,"X")-b)>9||Math.abs(c(e,"Y")-v)>9)&&(u=!0)}).on("touchcancel",function(){f=!1}).on("touchend touchcancel mouseup",function(e){f&&!u&&(oe.cancel(),"mouseup"!=e.type&&i()),f=!1})}j&&(q+=" scroll")}setTimeout(function(){if(D)C.appendTo(y);else if(ie.is("div")&&!oe._hasContent)ie.empty().append(C);else if(ie.hasClass("mbsc-control")){var n=ie.closest(".mbsc-control-w");C.insertAfter(n),n.hasClass("mbsc-select")&&n.addClass("mbsc-select-inline")}else C.insertAfter(ie);I=!0,oe._markupInserted(C),Q("onMarkupInserted",{target:W}),C.on("selectstart mousedown",ue).on("click",".mbsc-fr-btn-e",ue).on("keydown",".mbsc-fr-btn-e",function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.click())}).on("keydown",function(e){if(32==e.keyCode)e.preventDefault();else if(9==e.keyCode&&D&&B.focusTrap){var t=C.find('[tabindex="0"]').filter(function(){return this.offsetWidth>0||this.offsetHeight>0}),s=t.index(U(":focus",C)),n=t.length-1,a=0;e.shiftKey&&(n=0,a=-1),s===n&&(t.eq(a)[0].focus(),e.preventDefault())}}).on("touchstart mousedown pointerdown",".mbsc-fr-btn-e",r).on("touchend",".mbsc-fr-btn-e",l),U("input,select,textarea",C).on("selectstart mousedown",function(e){e.stopPropagation()}).on("keydown",function(e){32==e.keyCode&&e.stopPropagation()}),W.addEventListener("touchstart",function(){K||(K=!0,y.find(".mbsc-no-touch").removeClass("mbsc-no-touch"))},!0),U.each(E,function(e,t){oe.tap(U(".mbsc-fr-btn"+e,C),function(e){(a((t=a(t)?oe.buttons[t]:t).handler)?oe.handlers[t.handler]:t.handler).call(this,e,oe)},!0)}),oe._attachEvents(C),oe.position(),S.on(q,p),D&&(L&&!e?C.addClass("mbsc-anim-in mbsc-anim-trans mbsc-anim-trans-"+L).on(Z,s).find(".mbsc-fr-popup").addClass("mbsc-anim-"+L):d(t)),Q("onShow",{target:W,valueText:oe._tempValue})},H?100:0)}},oe.hide=function(e,t,s,n){function a(){C.off(Z,a),u(e)}return!(!oe._isVisible||!s&&!oe._isValid&&"set"==t||!s&&!1===Q("onBeforeClose",{valueText:oe._tempValue,button:t}))&&(D&&(U(document.activeElement).is("input,textarea")&&F.contains(document.activeElement)&&document.activeElement.blur(),U(window).off("keydown",m),delete V.activeInstance),C&&(D&&L&&!e?C.addClass("mbsc-anim-out mbsc-anim-trans mbsc-anim-trans-"+L).on(Z,a).find(".mbsc-fr-popup").addClass("mbsc-anim-"+L):u(e),oe._detachEvents(C),S.off(q,p).off("focusin",h)),n&&n(),ie.trigger("blur"),void Q("onClose",{valueText:oe._value}))},oe.ariaMessage=function(e){g.html(""),setTimeout(function(){g.html(e)},100)},oe.isVisible=function(){return oe._isVisible},oe.setVal=s,oe.getVal=s,oe._generateContent=s,oe._attachEvents=s,oe._detachEvents=s,oe._readValue=s,oe._clearValue=s,oe._fillValue=s,oe._markupReady=s,oe._markupInserted=s,oe._markupRemove=s,oe._position=s,oe.__processSettings=s,oe.__init=s,oe.__destroy=s,oe._destroy=function(){oe.hide(!0,!1,!0),ie.off(".mbsc"),U.each(le,function(e,t){t.el.off(".mbsc").prop("readonly",t.readOnly),t.lbl&&t.lbl.off(".mbsc")}),oe.__destroy()},oe._processSettings=function(){var e,t;for(oe.__processSettings(),B.buttons=B.buttons||("inline"!==B.display?["set","cancel"]:[]),B.headerText=void 0===B.headerText?"inline"!==B.display&&"{value}":B.headerText,E=B.buttons||[],D="inline"!==B.display,A="body"!=B.context,y=U(B.context),x=A?y:U("body,html"),O=y[0],oe._window=S=U(A?B.context:window),oe.live=!0,t=0;t<E.length;t++)"ok"!=(e=E[t])&&"set"!=e&&"set"!=e.handler||(oe.live=!1);oe.buttons.set={text:B.setText,icon:B.setIcon,handler:"set"},oe.buttons.cancel={text:B.cancelText,icon:B.cancelIcon,handler:"cancel"},oe.buttons.close={text:B.closeText,icon:B.closeIcon,handler:"cancel"},oe.buttons.clear={text:B.clearText,icon:B.clearIcon,handler:"clear"},oe._isInput=ie.is("input")},oe._init=function(){oe._isVisible&&oe.hide(!0,!1,!0),ie.off(".mbsc"),oe.__init(),oe._isLiquid="liquid"==B.layout,D?(oe._readValue(),oe._hasContent||oe.attachShow(ie)):oe.show(),ie.on("change.mbsc",function(){oe._preventChange||oe.setVal(ie.val(),!0,!1),oe._preventChange=!1})},oe.buttons={},oe.handlers={set:oe.select,cancel:oe.cancel,clear:oe.clear},oe._value=null,oe._isValid=!0,oe._isVisible=!1,B=oe.settings,Q=oe.trigger,n||oe.init(t)};pe.prototype._defaults={lang:"en",setText:"Set",selectedText:"{count} selected",closeText:"Close",cancelText:"Cancel",clearText:"Clear",context:"body",maxPopupWidth:600,disabled:!1,closeOnOverlayTap:!0,showOnFocus:re||le,showOnTap:!0,display:"center",scroll:!0,scrollLock:!0,tap:!0,btnClass:"mbsc-fr-btn",btnWidth:!0,focusTrap:!0,focusOnClose:!me},oe.Frame=pe,ie.frame.mobiscroll={headerText:!1,btnWidth:!1},ie.scroller.mobiscroll=K({},ie.frame.mobiscroll,{rows:5,showLabel:!1,selectedLineBorder:1,weekDays:"min",checkIcon:"ion-ios7-checkmark-empty",btnPlusClass:"mbsc-ic mbsc-ic-arrow-down5",btnMinusClass:"mbsc-ic mbsc-ic-arrow-up5",btnCalPrevClass:"mbsc-ic mbsc-ic-arrow-left5",btnCalNextClass:"mbsc-ic mbsc-ic-arrow-right5"}),H&&U(window).on("focus",function(){ne&&(ae=!0)});var he=V.classes,fe="ios"==I,be=function(e,t,s){function i(e){Q("onStart",{domEvent:e}),re.stopProp&&e.stopPropagation(),(re.prevDef||"mousedown"==e.type)&&e.preventDefault(),re.readonly||re.lock&&L||d(e,this)&&!O&&(b&&b.removeClass("mbsc-btn-a"),V=!1,L||(b=U(e.target).closest(".mbsc-btn-e",this)).length&&!b.hasClass("mbsc-btn-d")&&(V=!0,v=setTimeout(function(){b.addClass("mbsc-btn-a")},100)),O=!0,W=!1,A=!1,oe.scrolled=L,B=c(e,"X"),N=c(e,"Y"),T=B,g=0,y=0,w=0,F=new Date,R=+u(J,ne)||0,L&&f(R,fe?0:1),"mousedown"===e.type&&U(document).on("mousemove",r).on("mouseup",m))}function r(e){O&&(re.stopProp&&e.stopPropagation(),T=c(e,"X"),M=c(e,"Y"),g=T-B,y=M-N,w=ne?y:g,V&&(Math.abs(y)>re.thresholdY||Math.abs(g)>re.thresholdX)&&(clearTimeout(v),b.removeClass("mbsc-btn-a"),V=!1),(oe.scrolled||!A&&Math.abs(w)>Z)&&(W||Q("onGestureStart",S),oe.scrolled=W=!0,I||(I=!0,D=q(l))),ne||re.scrollLock?e.preventDefault():oe.scrolled?e.preventDefault():Math.abs(y)>7&&(A=!0,oe.scrolled=!0,le.trigger("touchend")))}function l(){E&&(w=o(w,-j*E,j*E)),f(o(R+w,$-k,P+k)),I=!1}function m(e){if(O){var t,s=new Date-F;re.stopProp&&e.stopPropagation(),z(D),I=!1,!A&&oe.scrolled&&(re.momentum&&s<300&&(t=w/s,w=Math.max(Math.abs(w),t*t/re.speedUnit)*(w<0?-1:1)),h(w)),V&&(clearTimeout(v),b.addClass("mbsc-btn-a"),setTimeout(function(){b.removeClass("mbsc-btn-a")},100),A||oe.scrolled||Q("onBtnTap",{target:b[0]})),"mouseup"==e.type&&U(document).off("mousemove",r).off("mouseup",m),O=!1}}function p(e){if(e=e.originalEvent||e,w=ne?e.deltaY||e.wheelDelta||e.detail:e.deltaX,Q("onStart",{domEvent:e}),re.stopProp&&e.stopPropagation(),w){if(e.preventDefault(),e.deltaMode&&1==e.deltaMode&&(w*=5),w=o(-w,-20,20),R=ae,re.readonly||R+w<$||R+w>P)return;W||(S={posX:ne?0:ae,posY:ne?ae:0,originX:ne?0:R,originY:ne?R:0,direction:w>0?ne?270:360:ne?90:180},Q("onGestureStart",S)),I||(I=!0,D=q(l)),W=!0,clearTimeout(Y),Y=setTimeout(function(){z(D),I=!1,W=!1,h(w)},200)}}function h(e){var t,s,n;if(E&&(e=o(e,-j*E,j*E)),n=o(Math.round((R+e)/j)*j,$,P),ie=Math.round(n/j),H){if(e<0){for(t=H.length-1;t>=0;t--)if(Math.abs(n)+_>=H[t].breakpoint){ie=t,ce=2,n=H[t].snap2;break}}else if(e>=0)for(t=0;t<H.length;t++)if(Math.abs(n)<=H[t].breakpoint){ie=t,ce=1,n=H[t].snap1;break}n=o(n,$,P)}s=re.time||(ae<$||ae>P?1e3:Math.max(1e3,Math.abs(n-ae)*re.timeUnit)),S.destinationX=ne?0:n,S.destinationY=ne?n:0,S.duration=s,S.transitionTiming=C,Q("onGestureEnd",S),f(n,s)}function f(e,t,s,n){var a=e!=ae,o=t>1,i=function(){clearInterval(X),clearTimeout(K),L=!1,ae=e,S.posX=ne?0:e,S.posY=ne?e:0,a&&Q("onMove",S),o&&Q("onAnimationEnd",S),n&&n()};S={posX:ne?0:ae,posY:ne?ae:0,originX:ne?0:R,originY:ne?R:0,direction:e-ae>0?ne?270:360:ne?90:180},ae=e,o&&(S.destinationX=ne?0:e,S.destinationY=ne?e:0,S.duration=t,S.transitionTiming=C,Q("onAnimationStart",S)),G[te+"Transition"]=t?ee+"transform "+Math.round(t)+"ms "+C:"",G[te+"Transform"]="translate3d("+(ne?"0,"+e+"px,":e+"px,0,")+"0)",!a&&!L||!t||t<=1?i():t&&(L=!s,clearInterval(X),X=setInterval(function(){var t=+u(J,ne)||0;S.posX=ne?0:t,S.posY=ne?t:0,Q("onMove",S),Math.abs(t-e)<2&&i()},100),clearTimeout(K),K=setTimeout(function(){i()},t)),re.sync&&re.sync(e,t,C)}var b,v,_,g,y,w,x,C,k,T,M,S,V,P,E,$,O,L,A,D,I,W,Y,X,j,H,R,F,B,N,G,J,K,Z,Q,ne,ae,oe=this,ie=0,ce=1,re=t,le=U(e);se.call(this,e,t,!0),oe.scrolled=!1,oe.scroll=function(t,s,a,i){t=o(t=n(t)?Math.round(t/j)*j:Math.ceil((U(t,e).length?Math.round(J.offset()[x]-U(t,e).offset()[x]):ae)/j)*j,$,P),ie=Math.round(t/j),R=ae,f(t,s,a,i)},oe.refresh=function(e){var t;_=void 0===re.contSize?ne?le.height():le.width():re.contSize,$=void 0===re.minScroll?Math.min(0,ne?_-J.height():_-J.width()):re.minScroll,P=void 0===re.maxScroll?0:re.maxScroll,H=null,!ne&&re.rtl&&(t=P,P=-$,$=-t),a(re.snap)&&(H=[],J.find(re.snap).each(function(){var e=ne?this.offsetTop:this.offsetLeft,t=ne?this.offsetHeight:this.offsetWidth;H.push({breakpoint:e+t/2,snap1:-e,snap2:_-e-t})})),j=n(re.snap)?re.snap:1,E=re.snap?re.maxSnapScroll:0,C=re.easing,k=re.elastic?n(re.snap)?j:n(re.elastic)?re.elastic:0:0,void 0===ae&&(ae=re.initialPos,ie=Math.round(ae/j)),e||oe.scroll(re.snap?H?H[ie]["snap"+ce]:ie*j:ae)},oe._processSettings=function(){ne="Y"==re.axis,x=ne?"top":"left",J=re.moveElement||le.children().eq(0),G=J[0].style,Z=ne?re.thresholdY:re.thresholdX},oe._init=function(){oe.refresh(),le.on("touchstart mousedown",i).on("touchmove",r).on("touchend touchcancel",m),re.mousewheel&&le.on("wheel mousewheel",p),e.addEventListener&&e.addEventListener("click",function(e){oe.scrolled&&(oe.scrolled=!1,e.stopPropagation(),e.preventDefault())},!0)},oe._destroy=function(){clearInterval(X),le.off("touchstart mousedown",i).off("touchmove",r).off("touchend touchcancel",m).off("wheel mousewheel",p)},re=oe.settings,Q=oe.trigger,s||oe.init(t)};be.prototype={_class:"scrollview",_defaults:{speedUnit:.0022,timeUnit:3,initialPos:0,axis:"Y",thresholdX:10,thresholdY:5,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",stopProp:!0,momentum:!0,mousewheel:!0,elastic:!0}},he.ScrollView=be,V.presetShort("scrollview","ScrollView",!1);var ve=H?window.CSS:null,_e=!(ve&&ve.supports&&ve.supports("(transform-style: preserve-3d)"))||"wp"==I||"android"==I;V.presetShort("scroller","Scroller",!1);var ge=function(e,t,s){function a(e){var t=+U(this).attr("data-index");e.stopPropagation(),"mousedown"===e.type&&e.preventDefault(),d(e,this)&&!y(t)&&(V=U(this).addClass("mbsc-sc-btn-a"),W=c(e,"X"),Y=c(e,"Y"),D=!0,I=!1,setTimeout(function(){v(t,"inc"==V.attr("data-dir")?1:-1)},100),"mousedown"===e.type&&U(document).on("mousemove",o).on("mouseup",i))}function o(e){(Math.abs(W-c(e,"X"))>7||Math.abs(Y-c(e,"Y"))>7)&&_(!0)}function i(e){_(),e.preventDefault(),"mouseup"===e.type&&U(document).off("mousemove",o).off("mouseup",i)}function r(e){var t,s,n=U(this).attr("data-index");38==e.keyCode?(t=!0,s=-1):40==e.keyCode?(t=!0,s=1):32==e.keyCode&&(t=!0,m(n,B[n]._$markup.find('.mbsc-sc-itm[data-val="'+X[n]+'"]'))),t&&(e.stopPropagation(),e.preventDefault(),s&&!D&&(D=!0,I=!1,v(n,s)))}function l(){_()}function m(e,t){var s=B[e],a=t.attr("data-index"),o=b(s,a),i=Z._tempSelected[e],c=n(s.multiple)?s.multiple:1/0;!1!==q("onItemTap",{target:t[0],index:e,value:o,selected:t.hasClass("mbsc-sc-itm-sel")})&&(s.multiple&&!s._disabled[o]&&(void 0!==i[o]?(t.removeClass(O).removeAttr("aria-selected"),delete i[o]):(1==c&&(Z._tempSelected[e]=i={},s._$markup.find(".mbsc-sc-itm-sel").removeClass(O).removeAttr("aria-selected")),function(e){var t,s=[];for(t in e)s.push(e[t]);return s}(i).length<c&&(t.addClass(O).attr("aria-selected","true"),i[o]=o))),T(s,e,a,J,!0,!0,s.multiple),!Z.live||s.multiple||!0!==F.setOnTap&&!F.setOnTap[e]||setTimeout(function(){Z.select()},200))}function u(e,t){return(e._array?e._map[t]:e.getIndex(t,Z))||0}function p(e,t){var s=e.data;if(t>=e.min&&t<=e.max)return e._array?e.circular?U(s).get(t%e._length):s[t]:U.isFunction(s)?s(t,Z):""}function h(e){return U.isPlainObject(e)?void 0!==e.value?e.value:e.display:e}function f(e){var t=U.isPlainObject(e)?e.display:e;return void 0===t?"":t}function b(e,t){return h(p(e,t))}function v(e,t){I||g(e,t),D&&(clearInterval(A),A=setInterval(function(){g(e,t)},F.delay))}function _(e){clearInterval(A),I=e,D=!1,V&&V.removeClass("mbsc-sc-btn-a")}function g(e,t){var s=B[e];T(s,e,s._current+t,J,1==t?1:2)}function y(e){return U.isArray(F.readonly)?F.readonly[e]:F.readonly}function w(e,t,s){var n=e._index-e._batch;return e.data=e.data||[],e.key=void 0!==e.key?e.key:t,e.label=void 0!==e.label?e.label:t,e._map={},e._array=U.isArray(e.data),e._array&&(e._length=e.data.length,U.each(e.data,function(t,s){e._map[h(s)]=t})),e.circular=void 0===F.circular?void 0===e.circular?e._array&&e._length>F.rows:e.circular:U.isArray(F.circular)?F.circular[t]:F.circular,e.min=e._array?e.circular?-1/0:0:void 0===e.min?-1/0:e.min,e.max=e._array?e.circular?1/0:e._length-1:void 0===e.max?1/0:e.max,e._nr=t,e._index=u(e,X[t]),e._disabled={},e._batch=0,e._current=e._index,e._first=e._index-G,e._last=e._index+G,e._offset=e._first,s?(e._offset-=e._margin/j+(e._index-n),e._margin+=(e._index-n)*j):e._margin=0,e._refresh=function(t){var s=-(e.min-e._offset+(e.multiple&&!$?Math.floor(F.rows/2):0))*j,n=Math.min(s,-(e.max-e._offset-(e.multiple&&!$?Math.floor(F.rows/2):0))*j);K(e._scroller.settings,{minScroll:n,maxScroll:s}),e._scroller.refresh(t)},N[e.key]=e,e}function x(e,t,s,n,a){var o,i,c,r,l,m,d,u,b="",v=Z._tempSelected[t],_=e._disabled||{};for(o=s;o<=n;o++)c=p(e,o),l=f(c),r=h(c),i=c&&void 0!==c.cssClass?c.cssClass:"",m=c&&void 0!==c.label?c.label:"",d=c&&c.invalid,u=void 0!==r&&r==X[t]&&!e.multiple,b+='<div role="option" aria-selected="'+!!v[r]+'" class="mbsc-sc-itm '+(a?"mbsc-sc-itm-3d ":"")+i+" "+(u?"mbsc-sc-itm-sel ":"")+(v[r]?O:"")+(void 0===r?" mbsc-sc-itm-ph":" mbsc-btn-e")+(d?" mbsc-sc-itm-inv-h mbsc-btn-d":"")+(_[r]?" mbsc-sc-itm-inv mbsc-btn-d":"")+'" data-index="'+o+'" data-val="'+r+'"'+(m?' aria-label="'+m+'"':"")+(u?' aria-selected="true"':"")+' style="height:'+j+"px;line-height:"+j+"px;"+(a?ee+"transform:rotateX("+(e._offset-o)*E%360+"deg) translateZ("+j*F.rows/2+"px);":"")+'">'+(z>1?'<div class="mbsc-sc-itm-ml" style="line-height:'+Math.round(j/z)+"px;font-size:"+Math.round(j/z*.8)+'px;">':"")+l+(z>1?"</div>":"")+"</div>";return b}function C(e,t,s,n){var a,o=B[e],i=n||o._disabled,c=u(o,t),r=t,l=t,m=0,d=0;if(void 0===t&&(t=b(o,c)),!0===i[t]){for(a=0;c-m>=o.min&&i[r]&&a<100;)a++,m++,r=b(o,c-m);for(a=0;c+d<o.max&&i[l]&&a<100;)a++,d++,l=b(o,c+d);t=(d<m&&d&&2!==s||!m||c-m<0||1==s)&&!i[l]?l:r}return t}function k(t,s,n,a,o,i){var c,r,l,m,d=Z._isVisible;R=!0,m=F.validate.call(e,{values:X.slice(0),index:s,direction:n},Z)||{},R=!1,m.valid&&(Z._tempWheelArray=X=m.valid.slice(0)),i||U.each(B,function(e,a){if(d&&a._$markup.find(".mbsc-sc-itm-inv").removeClass("mbsc-sc-itm-inv mbsc-btn-d"),a._disabled={},m.disabled&&m.disabled[e]&&U.each(m.disabled[e],function(e,t){a._disabled[t]=!0,d&&a._$markup.find('.mbsc-sc-itm[data-val="'+t+'"]').addClass("mbsc-sc-itm-inv mbsc-btn-d")}),X[e]=a.multiple?X[e]:C(e,X[e],n),d){if(a.multiple&&void 0!==s||a._$markup.find(".mbsc-sc-itm-sel").removeClass(O).removeAttr("aria-selected"),a.multiple){if(void 0===s)for(var i in Z._tempSelected[e])a._$markup.find('.mbsc-sc-itm[data-val="'+i+'"]').addClass(O).attr("aria-selected","true")}else a._$markup.find('.mbsc-sc-itm[data-val="'+X[e]+'"]').addClass("mbsc-sc-itm-sel").attr("aria-selected","true");r=u(a,X[e]),c=r-a._index+a._batch,Math.abs(c)>2*G+1&&(l=c+(2*G+1)*(c>0?-1:1),a._offset+=l,a._margin-=l*j,a._refresh()),a._index=r+a._batch,a._scroller.scroll(-(r-a._offset+a._batch)*j,s===e||void 0===s?t:J,o)}}),q("onValidated"),Z._tempValue=F.formatValue(X,Z),d&&Z._header.html(function(t){var s=F.headerText;return s?"function"==typeof s?s.call(e,t):s.replace(/\{value\}/i,t):""}(Z._tempValue)),Z.live&&(Z._hasValue=a||Z._hasValue,M(a,a,0,!0),a&&q("onSet",{valueText:Z._value})),a&&q("onChange",{valueText:Z._tempValue})}function T(e,t,s,n,a,o,i){var c=b(e,s);void 0!==c&&(X[t]=c,e._batch=e._array?Math.floor(s/e._length)*e._length:0,setTimeout(function(){k(n,t,a,!0,o,i)},10))}function M(e,t,s,n,a){if(n?Z._tempValue=F.formatValue(Z._tempWheelArray,Z):k(s),!a){Z._wheelArray=[];for(var o=0;o<X.length;o++)Z._wheelArray[o]=B[o]&&B[o].multiple?Object.keys(Z._tempSelected[o])[0]:X[o];Z._value=Z._hasValue?Z._tempValue:null,Z._selected=K(!0,{},Z._tempSelected)}e&&(Z._isInput&&Q.val(Z._hasValue?Z._tempValue:""),q("onFill",{valueText:Z._hasValue?Z._tempValue:"",change:t}),t&&(Z._preventChange=!0,Q.trigger("change")))}var S,V,P,E,$,O,L,A,D,I,W,Y,X,j,H,R,F,q,z,B,N,G=40,J=1e3,Z=this,Q=U(e);pe.call(this,e,t,!0),Z.setVal=Z._setVal=function(t,s,n,a,o){Z._hasValue=null!==t&&void 0!==t,Z._tempWheelArray=X=U.isArray(t)?t.slice(0):F.parseValue.call(e,t,Z)||[],M(s,void 0===n?s:n,o,!1,a)},Z.getVal=Z._getVal=function(e){var t=Z._hasValue||e?Z[e?"_tempValue":"_value"]:null;return n(t)?+t:t},Z.setArrayVal=Z.setVal,Z.getArrayVal=function(e){return e?Z._tempWheelArray:Z._wheelArray},Z.changeWheel=function(e,t,s){var n,a;U.each(e,function(e,t){(a=N[e])&&(n=a._nr,K(a,t),w(a,n,!0),Z._isVisible&&($&&a._$3d.html(x(a,n,a._first+G-P+1,a._last-G+P,!0)),a._$scroller.html(x(a,n,a._first,a._last)).css("margin-top",a._margin+"px"),a._refresh(R)))}),!Z._isVisible||Z._isLiquid||R||Z.position(),R||k(t,void 0,void 0,s)},Z.getValidValue=C,Z._generateContent=function(){var e,t=0,s="",n=$?ee+"transform: translateZ("+(j*F.rows/2+3)+"px);":"",a='<div class="mbsc-sc-whl-l" style="'+n+"height:"+j+"px;margin-top:-"+(j/2+(F.selectedLineBorder||0))+'px;"></div>',o=0;return U.each(F.wheels,function(i,c){s+='<div class="mbsc-w-p mbsc-sc-whl-gr-c'+($?" mbsc-sc-whl-gr-3d-c":"")+(F.showLabel?" mbsc-sc-lbl-v":"")+'">'+a+'<div class="mbsc-sc-whl-gr'+($?" mbsc-sc-whl-gr-3d":"")+(L?" mbsc-sc-cp":"")+(F.width||F.maxWidth?'"':'" style="max-width:'+F.maxPopupWidth+'px;"')+">",U.each(c,function(i,c){Z._tempSelected[o]=K({},Z._selected[o]),B[o]=w(c,o),t+=F.maxWidth?F.maxWidth[o]||F.maxWidth:F.width?F.width[o]||F.width:0,e=void 0!==c.label?c.label:i,s+='<div class="mbsc-sc-whl-w '+(c.cssClass||"")+(c.multiple?" mbsc-sc-whl-multi":"")+'" style="'+(F.width?"width:"+(F.width[o]||F.width)+"px;":(F.minWidth?"min-width:"+(F.minWidth[o]||F.minWidth)+"px;":"")+(F.maxWidth?"max-width:"+(F.maxWidth[o]||F.maxWidth)+"px;":""))+'"><div class="mbsc-sc-whl-o" style="'+n+'"></div>'+a+'<div tabindex="0" aria-live="off" aria-label="'+e+'"'+(c.multiple?' aria-multiselectable="true"':"")+' role="listbox" data-index="'+o+'" class="mbsc-sc-whl" style="height:'+F.rows*j*($?1.1:1)+'px;">'+(L?'<div data-index="'+o+'" data-dir="inc" class="mbsc-sc-btn mbsc-sc-btn-plus '+(F.btnPlusClass||"")+'" style="height:'+j+"px;line-height:"+j+'px;"></div><div data-index="'+o+'" data-dir="dec" class="mbsc-sc-btn mbsc-sc-btn-minus '+(F.btnMinusClass||"")+'" style="height:'+j+"px;line-height:"+j+'px;"></div>':"")+'<div class="mbsc-sc-lbl">'+e+'</div><div class="mbsc-sc-whl-c" style="height:'+H+"px;margin-top:-"+(H/2+1)+"px;"+n+'"><div class="mbsc-sc-whl-sc" style="top:'+(H-j)/2+'px;">',s+=x(c,o,c._first,c._last)+"</div></div>",$&&(s+='<div class="mbsc-sc-whl-3d" style="height:'+j+"px;margin-top:-"+j/2+'px;">',s+=x(c,o,c._first+G-P+1,c._last-G+P,!0),s+="</div>"),s+="</div></div>",o++}),s+="</div></div>"}),t&&(F.maxPopupWidth=t),s},Z._attachEvents=function(e){U(".mbsc-sc-btn",e).on("touchstart mousedown",a).on("touchmove",o).on("touchend touchcancel",i),U(".mbsc-sc-whl",e).on("keydown",r).on("keyup",l)},Z._detachEvents=function(){for(var e=0;e<B.length;e++)B[e]._scroller.destroy()},Z._markupReady=function(e){U(".mbsc-sc-whl-w",S=e).each(function(e){var t,s=U(this),n=B[e],a=-(n.min-n._offset+(n.multiple&&!$?Math.floor(F.rows/2):0))*j,o=Math.min(a,-(n.max-n._offset-(n.multiple&&!$?Math.floor(F.rows/2):0))*j);n._$markup=s,n._$scroller=U(".mbsc-sc-whl-sc",this),n._$3d=U(".mbsc-sc-whl-3d",this),n._scroller=new be(this,{mousewheel:F.mousewheel,moveElement:n._$scroller,initialPos:(n._first-n._index)*j,contSize:0,snap:j,minScroll:o,maxScroll:a,maxSnapScroll:G,prevDef:!0,stopProp:!0,timeUnit:3,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",sync:function(e,t,s){$&&(n._$3d[0].style[te+"Transition"]=t?ee+"transform "+Math.round(t)+"ms "+s:"",n._$3d[0].style[te+"Transform"]="rotateX("+-e/j*E+"deg)")},onStart:function(t,s){s.settings.readonly=y(e)},onGestureStart:function(){s.addClass("mbsc-sc-whl-a mbsc-sc-whl-anim"),q("onWheelGestureStart",{index:e})},onGestureEnd:function(s){var a=90==s.direction?1:2,o=s.duration,i=s.destinationY;t=Math.round(-i/j)+n._offset,T(n,e,t,o,a)},onAnimationStart:function(){s.addClass("mbsc-sc-whl-anim")},onAnimationEnd:function(){s.removeClass("mbsc-sc-whl-a mbsc-sc-whl-anim"),q("onWheelAnimationEnd",{index:e}),n._$3d.find(".mbsc-sc-itm-del").remove()},onMove:function(t){!function(e,t,s){var n=Math.round(-s/j)+e._offset,a=n-e._current,o=e._first,i=e._last,c=o+G-P+1,r=i-G+P;a&&(e._first+=a,e._last+=a,e._current=n,a>0?(e._$scroller.append(x(e,t,Math.max(i+1,o+a),i+a)),U(".mbsc-sc-itm",e._$scroller).slice(0,Math.min(a,i-o+1)).remove(),$&&(e._$3d.append(x(e,t,Math.max(r+1,c+a),r+a,!0)),U(".mbsc-sc-itm",e._$3d).slice(0,Math.min(a,r-c+1)).attr("class","mbsc-sc-itm-del"))):a<0&&(e._$scroller.prepend(x(e,t,o+a,Math.min(o-1,i+a))),U(".mbsc-sc-itm",e._$scroller).slice(Math.max(a,o-i-1)).remove(),$&&(e._$3d.prepend(x(e,t,c+a,Math.min(c-1,r+a),!0)),U(".mbsc-sc-itm",e._$3d).slice(Math.max(a,c-r-1)).attr("class","mbsc-sc-itm-del"))),e._margin+=a*j,e._$scroller.css("margin-top",e._margin+"px"))}(n,e,t.posY)},onBtnTap:function(t){m(e,U(t.target))}})}),k()},Z._fillValue=function(){Z._hasValue=!0,M(!0,!0,0,!0)},Z._clearValue=function(){U(".mbsc-sc-whl-multi .mbsc-sc-itm-sel",S).removeClass(O).removeAttr("aria-selected")},Z._readValue=function(){var t=Q.val()||"",s=0;""!==t&&(Z._hasValue=!0),Z._tempWheelArray=X=Z._hasValue&&Z._wheelArray?Z._wheelArray.slice(0):F.parseValue.call(e,t,Z)||[],Z._tempSelected=K(!0,{},Z._selected),U.each(F.wheels,function(e,t){U.each(t,function(e,t){B[s]=w(t,s),s++})}),M(!1,!1,0,!0),q("onRead")},Z.__processSettings=function(){F=Z.settings,q=Z.trigger,z=F.multiline,O="mbsc-sc-itm-sel mbsc-ic mbsc-ic-"+F.checkIcon,B=[],N={}},Z.__init=function(){L=F.showScrollArrows,$=F.scroll3d&&!_e&&!L,j=F.height,H=$?2*Math.round((j-.03*(j*F.rows/2+3))/2):j,P=Math.round(1.8*F.rows),E=360/(2*P),L&&(F.rows=Math.max(3,F.rows)),F.cssClass=(F.cssClass||"")+" mbsc-sc"},Z._getItemValue=h,Z._tempSelected={},Z._selected={},s||Z.init(t)};ge.prototype={_hasDef:!0,_hasTheme:!0,_hasLang:!0,_hasPreset:!0,_class:"scroller",_defaults:K({},pe.prototype._defaults,{minWidth:80,height:40,rows:3,multiline:1,delay:300,readonly:!1,showLabel:!0,setOnTap:!1,wheels:[],preset:"",speedUnit:.0012,timeUnit:.08,checkIcon:"checkmark",validate:function(){},formatValue:function(e){return e.join(" ")},parseValue:function(e,t){var s,n,a=[],o=[],i=0;return null!==e&&void 0!==e&&(a=(e+"").split(" ")),U.each(t.settings.wheels,function(e,c){U.each(c,function(e,c){n=c.data,s=t._getItemValue(n[0]),U.each(n,function(e,n){if(a[i]==t._getItemValue(n))return s=t._getItemValue(n),!1}),o.push(s),i++})}),o}})},V.classes.Scroller=ge;var ye=V.classes,we=function(e,t){var s="",n=U(e),a=this.settings;se.call(this,e,t,!0),this._init=function(){var e=a.context,t=U(e),o=t.find(".mbsc-ms-top .mbsc-ms"),i=t.find(".mbsc-ms-bottom .mbsc-ms"),c={};"body"==e?U("body,html").addClass("mbsc-page-ctx"):t.addClass("mbsc-page-ctx"),s&&n.removeClass(s),o.length&&(c.paddingTop=o[0].offsetHeight),i.length&&(c.paddingBottom=i[0].offsetHeight),s="mbsc-page mbsc-"+a.theme+(a.baseTheme?" mbsc-"+a.baseTheme:"")+(a.rtl?" mbsc-rtl":" mbsc-ltr"),n.addClass(s).css(c)},this._destroy=function(){n.removeClass(s)},a=this.settings,this.init(t)};we.prototype={_hasDef:!0,_hasTheme:!0,_hasLang:!0,_class:"page",_defaults:{context:"body"}},ye.Page=we,V.themes.page.mobiscroll={},V.presetShort("page","Page"),H&&U(function(){U("[mbsc-page]").each(function(){new ye.Page(this)}),U(document).on("mbsc-enhance",function(e,t){U(e.target).is("[mbsc-page]")?new ye.Page(e.target,t):U("[mbsc-page]",e.target).each(function(){new ye.Page(this,t)})})});var xe=function(e,t,s){function n(e){U(".mbsc-fr-c",e).hasClass("mbsc-wdg-c")||(U(".mbsc-fr-c",e).addClass("mbsc-wdg-c").append(c.show()),U(".mbsc-w-p",e).length||U(".mbsc-fr-c",e).addClass("mbsc-w-p"))}var a,o,i,c=U(e),r=this;pe.call(this,e,t,!0),r._generateContent=function(){return""},r._markupReady=function(e){"inline"!=a.display&&n(e)},r._markupInserted=function(e){"inline"==a.display&&n(e),e.trigger("mbsc-enhance",[{theme:a.theme,lang:a.lang}])},r._markupRemove=function(){c.hide(),o?o.prepend(c):i.after(c)},r.__processSettings=function(){a=r.settings,r.buttons.ok={text:a.okText,icon:a.okIcon,handler:"set"},a.buttons=a.buttons||("inline"==a.display?[]:["ok"]),o||i||(i=c.prev()).length||(o=c.parent()),c.hide()},r.__init=function(){a.cssClass=(a.cssClass||"")+" mbsc-wdg"},s||r.init(t)};xe.prototype={_hasDef:!0,_hasTheme:!0,_hasContent:!0,_hasLang:!0,_class:"widget",_defaults:K({},pe.prototype._defaults,{okText:"OK",headerText:!1})},V.classes.Widget=xe,V.themes.widget=V.themes.frame,V.presetShort("widget","Widget",!1);var Ce=H&&!!window.Promise,ke=[],Te=[];V.alert=function(e){var t=document.createElement("div");return t.innerHTML=f(e),w(b,t,e)},V.confirm=function(e){var t=document.createElement("div");return t.innerHTML=f(e),w(v,t,e)},V.prompt=function(e){var t=document.createElement("div");return t.innerHTML=f(e)+'<label class="mbsc-input">'+(e.label?'<span class="mbsc-label">'+e.label+"</span>":"")+'<input tabindex="0" type="'+(e.inputType||"text")+'" placeholder="'+(e.placeholder||"")+'" value="'+(e.value||"")+'"></label>',w(_,t,e)},V.snackbar=function(e){var t=document.createElement("div");return t.innerHTML='<div class="mbsc-snackbar-cont"><div class="mbsc-snackbar-msg">'+(e.message||"")+"</div>"+(e.button?'<button class="mbsc-snackbar-btn mbsc-btn mbsc-btn-flat">'+(e.button.text||"")+"</button>":"")+"</div>",w(g,t,e)},V.toast=function(e){var t=document.createElement("div");return t.innerHTML='<div class="mbsc-toast-msg">'+(e.message||"")+"</div>",w(y,t,e)};var Me="mbsc-input-wrap",Se=["touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup","mouseleave"],Ve={tap:!0},Pe=void 0,Ee=function(){function e(t,s){var n=this;E(this,e);var a=K({},Ve,V.settings,s),o=U(t),i=o.parent(),c=i.hasClass("mbsc-input-wrap")?i.parent():i,r=o.next().hasClass("mbsc-fr")?o.next():null,l=k(o);r&&r.insertAfter(c),C(c,l),o.addClass("mbsc-control"),Se.forEach(function(e){t.addEventListener(e,n)}),this.settings=a,this._type=l,this._elm=t,this._$elm=o,this._$parent=c,this._$frame=r,this._ripple=T(a.theme)}return $(e,[{key:"destroy",value:function(){var e=this;this._$elm.removeClass("mbsc-control"),Se.forEach(function(t){e._elm.removeEventListener(t,e)})}},{key:"option",value:function(e){K(this.settings,e),this._ripple=T(this.settings.theme)}},{key:"handleEvent",value:function(e){switch(e.type){case"touchstart":case"mousedown":this._onStart(e);break;case"touchmove":case"mousemove":this._onMove(e);break;case"touchend":case"touchcancel":case"mouseup":case"mouseleave":this._onEnd(e)}}},{key:"_addRipple",value:function(e){this._ripple&&this._$rippleElm&&this._ripple.addRipple(this._$rippleElm,e)}},{key:"_removeRipple",value:function(){this._ripple&&this._$rippleElm&&this._ripple.removeRipple()}},{key:"_onStart",value:function(e){var t=this._elm;d(e,t)&&(this._startX=c(e,"X"),this._startY=c(e,"Y"),Pe&&Pe.removeClass("mbsc-active"),t.disabled||(this._isActive=!0,(Pe=this._$elm).addClass("mbsc-active"),this._addRipple(e)))}},{key:"_onMove",value:function(e){(this._isActive&&Math.abs(c(e,"X")-this._startX)>9||Math.abs(c(e,"Y")-this._startY)>9)&&(this._$elm.removeClass("mbsc-active"),this._removeRipple(),this._isActive=!1)}},{key:"_onEnd",value:function(e){var t=this,s=this._elm,n=this._type;if(this._isActive&&this.settings.tap&&"touchend"==e.type&&!s.readOnly&&(s.focus(),/(button|submit|checkbox|switch|radio)/.test(n)&&e.preventDefault(),!/select/.test(n))){var a=(e.originalEvent||e).changedTouches[0],o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),o.tap=!0,s.mbscChange=!0,s.dispatchEvent(o),i()}this._isActive&&setTimeout(function(){t._$elm.removeClass("mbsc-active"),t._removeRipple()},100),this._isActive=!1,Pe=null}}]),e}(),$e=function(e){function t(e,s){E(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s));return function(e,t,s){var n={},a=s[0],o=s.attr("data-password-toggle"),i=s.attr("data-icon-show")||"eye",c=s.attr("data-icon-hide")||"eye-blocked";o&&(n.right="password"==a.type?i:c),x(s,n),o&&r(e,t.find(".mbsc-right-ic").addClass("mbsc-input-toggle"),function(){"text"==a.type?(a.type="password",U(this).addClass("mbsc-ic-"+i).removeClass("mbsc-ic-"+c)):(a.type="text",U(this).removeClass("mbsc-ic-"+i).addClass("mbsc-ic-"+c))})}(n,n._$parent,n._$elm),n._$parent.addClass("mbsc-input"),n}return L(t,Ee),$(t,[{key:"destroy",value:function(){O(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this._$parent.removeClass("mbsc-ic-left mbsc-ic-right").find(".mbsc-input-ic").remove()}}]),t}(),Oe=function(e){function t(e,s){E(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s)),a=n._$elm,o=a.attr("data-icon");return a.addClass("mbsc-btn").find(".mbsc-btn-ic").remove(),o&&(a.prepend('<span class="mbsc-btn-ic mbsc-ic mbsc-ic-'+o+'"></span>'),""===a.text()&&a.addClass("mbsc-btn-icon-only")),n._$rippleElm=a,n}return L(t,Ee),t}(),Le=function(e){function t(e,s){E(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s));return n._$parent.prepend(n._$elm).addClass("mbsc-checkbox mbsc-control-w").find(".mbsc-checkbox-box").remove(),n._$elm.after('<span class="mbsc-checkbox-box"></span>'),n}return L(t,Ee),t}(),Ae=function(e){function t(e,s){E(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s));return n._$parent.addClass("mbsc-radio mbsc-control-w").find(".mbsc-radio-box").remove(),n._$elm.after('<span class="mbsc-radio-box"><span></span></span>'),n}return L(t,Ee),t}(),De=function(e){function t(e,s){E(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s)),a=n._$elm,o=n._$parent,i=o.find("input.mbsc-control"),c=i.length?i:U('<input tabindex="-1" class="mbsc-control" readonly>');return n._$input=c,o.addClass("mbsc-select"+(n._$frame?" mbsc-select-inline":"")),a.after(c),c.after('<span class="mbsc-select-ic mbsc-ic mbsc-ic-arrow-down5"></span>'),a.hasClass("mbsc-comp")||(e.addEventListener("change",n),n._setText()),n}return L(t,$e),$(t,[{key:"destroy",value:function(){O(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this._$elm.after(this._$input),this._elm.removeEventListener("change",this)}},{key:"handleEvent",value:function(e){O(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"handleEvent",this).call(this,e),"change"==e.type&&this._setText()}},{key:"_setText",value:function(){var e=this._elm;this._$elm.hasClass("mbsc-comp")||this._$input.val(-1!=e.selectedIndex?e.options[e.selectedIndex].text:"")}}]),t}(),Ie=["keydown","input","scroll"],We=void 0;H&&U(window).on("resize orientationchange",M);var Ye=function(e){function t(e,s){E(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s));return n._$parent.addClass("mbsc-textarea"),Ie.forEach(function(e){n._elm.addEventListener(e,n)}),S(e),n}return L(t,$e),$(t,[{key:"destroy",value:function(){var e=this;O(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),Ie.forEach(function(t){e._elm.removeEventListener(t,e)})}},{key:"handleEvent",value:function(e){switch(O(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"handleEvent",this).call(this,e),e.type){case"keydown":case"input":this._onInput(e);break;case"scroll":!function(e){if(!U(e).hasClass("mbsc-textarea-scroll")){var t=e.scrollHeight-e.offsetHeight,s=e.offsetHeight+t;e.scrollTop=0,e.style.height=s+"px"}}(this._elm)}}},{key:"_onInput",value:function(){var e=this;clearTimeout(this._debounce),this._debounce=setTimeout(function(){S(e._elm)},100)}}]),t}(),Xe=function(e){function t(e,s){E(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s)),a=void 0,o=void 0,i=n._$elm,c=n._$parent;return c.hasClass("mbsc-segmented-item-ready")||(a=U('<div class="mbsc-segmented"></div>'),c.after(a),c.parent().find('input[name="'+i.attr("name")+'"]').each(function(){var e=U(this);o=e.parent().addClass("mbsc-segmented-item mbsc-segmented-item-ready"),U('<span class="mbsc-segmented-content">'+(e.attr("data-icon")?'<span class="mbsc-ic mbsc-ic-'+e.attr("data-icon")+'"></span>':"")+"</span>").append(o.contents()).appendTo(o),o.prepend(e),a.append(o)})),n._$rippleElm=i.next(),n}return L(t,Ee),t}(),je=function(e,t){function s(t){32==t.keyCode&&(t.preventDefault(),_||e.disabled||(h=U(this).addClass("mbsc-active"),m(t)))}function n(e){_&&(e.preventDefault(),u(!0))}function a(t){d(t,this)&&!e.disabled&&(h=U(this).addClass("mbsc-active").trigger("focus"),P&&!h.hasClass("mbsc-step-disabled")&&P.addRipple(h.find(".mbsc-segmented-content"),t),m(t),"mousedown"===t.type&&U(document).on("mousemove",i).on("mouseup",o))}function o(e){_&&(e.preventDefault(),u(!0),"mouseup"===e.type&&U(document).off("mousemove",i).off("mouseup",o))}function i(e){_&&(C=c(e,"X"),k=c(e,"Y"),y=C-O,w=k-L,(Math.abs(y)>7||Math.abs(w)>7)&&u())}function r(){var t;e.disabled||(t=parseFloat(U(this).val()),l(isNaN(t)?D:t))}function l(e,t,s){j=D,void 0===t&&(t=!0),void 0===s&&(s=t),D=void 0!==e?Math.min(M,Math.max(Math.round(e/E)*E,S)):Math.min(M,Math.max(D+(h.hasClass("mbsc-stepper-minus")?-E:E),S)),g=!0,v.removeClass("mbsc-step-disabled"),t&&X.val(D),D==S?b.addClass("mbsc-step-disabled"):D==M&&f.addClass("mbsc-step-disabled"),D!==j&&s&&X.trigger("change")}function m(e){_||(_=!0,g=!1,O=c(e,"X"),L=c(e,"Y"),clearInterval(T),clearTimeout(T),T=setTimeout(function(){l(),T=setInterval(function(){l()},150)},300))}function u(e){clearInterval(T),clearTimeout(T),!g&&e&&l(),_=!1,g=!1,h.removeClass("mbsc-active"),P&&setTimeout(function(){P.removeRipple()},100)}function p(e,t){var s=X.attr(e);return void 0===s||""===s?t:+s}var h,f,b,v,_,g,y,w,x,C,k,T,M,S,P,E,$,O,L,A,D,I,W,Y=this,X=U(e),j=D;se.call(this,e,t,!0),Y.getVal=function(){var e=parseFloat(X.val());return e=isNaN(e)?D:e,Math.min(M,Math.max(Math.round(e/E)*E,S))},Y.setVal=function(e,t,s){e=parseFloat(e),l(isNaN(e)?D:e,t,s)},Y._init=function(t){I=X.parent().hasClass("mbsc-stepper"),W=I?X.closest(".mbsc-stepper-cont"):X.parent(),$=Y.settings,S=void 0===t.min?p("min",$.min):t.min,M=void 0===t.max?p("max",$.max):t.max,E=void 0===t.step?p("step",$.step):t.step,x=X.attr("data-val")||$.val,D=Math.min(M,Math.max(Math.round(+e.value/E)*E||0,S)),A=V.themes.form[$.theme],P=A&&A.addRipple?A:null,I||W.addClass("mbsc-stepper-cont mbsc-control-w").append('<span class="mbsc-segmented mbsc-stepper"></span>').find(".mbsc-stepper").append('<span class="mbsc-segmented-item mbsc-stepper-control mbsc-stepper-minus '+(D==S?"mbsc-step-disabled":"")+'"  tabindex="0"><span class="mbsc-segmented-content"><span class="mbsc-ic mbsc-ic-minus"></span></span></span>').append('<span class="mbsc-segmented-item mbsc-stepper-control mbsc-stepper-plus '+(D==M?"mbsc-step-disabled":"")+'"  tabindex="0"><span class="mbsc-segmented-content"> <span class="mbsc-ic mbsc-ic-plus"></span> </span></span>').prepend(X),b=U(".mbsc-stepper-minus",W),f=U(".mbsc-stepper-plus",W),I||("left"==x?(W.addClass("mbsc-stepper-val-left"),X.after('<span class="mbsc-segmented-item"><span class="mbsc-segmented-content"></span></span>')):"right"==x?(W.addClass("mbsc-stepper-val-right"),f.after('<span class="mbsc-segmented-item"><span class="mbsc-segmented-content"></span></span>')):b.after('<span class="mbsc-segmented-item"><span class="mbsc-segmented-content mbsc-stepper-val"></span></span>')),X.val(D).attr("data-role","stepper").attr("min",S).attr("max",M).attr("step",E).on("change",r),v=U(".mbsc-stepper-control",W).on("keydown",s).on("keyup",n).on("mousedown touchstart",a).on("touchmove",i).on("touchend touchcancel",o),X.addClass("mbsc-stepper-ready mbsc-control")},Y._destroy=function(){X.removeClass("mbsc-control").off("change",r),v.off("keydown",s).off("keyup",n).off("mousedown touchstart",a).off("touchmove",i).off("touchend touchcancel",o)},Y.init(t)};je.prototype={_class:"stepper",_hasDef:!0,_defaults:{min:0,max:100,step:1}},V.classes.Stepper=je,V.presetShort("stepper","Stepper");var He=function(e,t,n){var a,o,i,c,r=this;se.call(this,e,t,!0),r.__init=s,r.__destroy=s,r._init=function(t){var s;c=r.settings,a=U(e),s=!!o,o=(o=a.parent()).hasClass("mbsc-input-wrap")?o.parent():o,r._$parent=o,i&&o.removeClass(i),i=r._css+" mbsc-progress-w mbsc-control-w mbsc-"+c.theme+(c.baseTheme?" mbsc-"+c.baseTheme:"")+(c.rtl?" mbsc-rtl":" mbsc-ltr"),o.addClass(i),a.addClass("mbsc-control"),r.__init(t),s||r._attachChange(),r.refresh()},r._destroy=function(){r.__destroy(),o.removeClass(i),a.removeClass("mbsc-control")},n||r.init(t)};He.prototype={_class:"progressbase"};var Re=function(e,t,n){function a(t){!d(t,this)||S||e.disabled||(F.stopProp&&t.stopPropagation(),S=!0,X=!1,V=!1,z=c(t,"X"),B=c(t,"Y"),O=z,M.removeClass("mbsc-progress-anim"),w=j?U(".mbsc-slider-handle",this):C,x&&x.removeClass("mbsc-handle-curr"),x=w.parent().addClass("mbsc-active mbsc-handle-curr"),A=+w.attr("data-index"),J=M[0].offsetWidth,$=M[0].getBoundingClientRect().left,"mousedown"===t.type&&(t.preventDefault(),U(document).on("mousemove",o).on("mouseup",r)))}function o(e){S&&(O=c(e,"X"),L=c(e,"Y"),P=O-z,E=L-B,(Math.abs(P)>5||X)&&(X=!0,Math.abs(Q-new Date)>50&&(Q=new Date,v(O,F.round,I))),X?e.preventDefault():Math.abs(E)>7&&b())}function r(e){S&&(e.preventDefault(),j||M.addClass("mbsc-progress-anim"),v(O,!0,!0),X||V||("touchend"==e.type&&i(),Z._onTap(K[A])),b())}function l(){S&&b()}function m(){var e=Z._readValue(U(this)),t=+U(this).attr("data-index");e!==K[t]&&(K[t]=e,H[t]=e,g(e,t))}function u(e){e.stopPropagation()}function p(e){e.preventDefault()}function h(t){var s;if(!e.disabled){switch(t.keyCode){case 38:case 39:s=1;break;case 40:case 37:s=-1}s&&(t.preventDefault(),G||(A=+U(this).attr("data-index"),g(K[A]+R*s,A,!0),G=setInterval(function(){g(K[A]+R*s,A,!0)},200)))}}function f(e){e.preventDefault(),clearInterval(G),G=null}function b(){S=!1,x.removeClass("mbsc-active"),U(document).off("mousemove",o).off("mouseup",r)}function v(e,t,s){var n=t?Math.min(Math.round(Math.max(100*(e-$)/J,0)/q/R)*R*100/(W-Y),100):Math.max(0,Math.min(100*(e-$)/J,100));D&&(n=100-n),g(Math.round((Y+n/q)*N)/N,A,s,n)}function _(e){return 100*(e-Y)/(W-Y)}function g(e,t,s,n,a,o){var i=C.eq(t),c=i.parent();e=Math.min(W,Math.max(e,Y)),void 0===o&&(o=s),Z._update?e=Z._update(e,K,t,n,j,a,c):c.css({left:D?"auto":(n||_(e))+"%",right:D?(n||_(e))+"%":"auto"}),e>Y?c.removeClass("mbsc-slider-start"):(K[t]>Y||a)&&c.addClass("mbsc-slider-start"),s&&H[t]!=e&&(V=!0,H[t]=e,K[t]=e,Z._fillValue(e,t,o)),i.attr("aria-valuenow",e)}var y,w,x,C,k,T,M,S,V,P,E,$,O,L,A,D,I,W,Y,X,j,H,R,F,q,z,B,N,G,J,K,Z=this,Q=new Date;He.call(this,e,t,!0),Z._onTap=s,Z.___init=s,Z.___destroy=s,Z._attachChange=function(){y.on(F.changeEvent,m)},Z.__init=function(e){var t;C&&(t=!0,C.parent().remove()),Z.___init(e),T=Z._$parent,M=Z._$track,y=T.find("input"),F=Z.settings,Y=Z._min,W=Z._max,R=Z._step,I=Z._live,N=R%1!=0?100/(100*+(R%1).toFixed(2)):1,q=100/(W-Y)||100,j=y.length>1,D=F.rtl,K=[],H=[],y.each(function(e){K[e]=Z._readValue(U(this)),U(this).attr("data-index",e)}),C=T.find(".mbsc-slider-handle"),k=T.find(j?".mbsc-slider-handle-cont":".mbsc-progress-cont"),C.on("keydown",h).on("keyup",f).on("blur",f),k.on("touchstart mousedown",a).on("touchmove",o).on("touchend touchcancel",r).on("pointercancel",l),t||(y.on("click",u),T.on("click",p))},Z.__destroy=function(){T.off("click",p),y.off(F.changeEvent,m).off("click",u),C.off("keydown",h).off("keyup",f).off("blur",f),k.off("touchstart mousedown",a).off("touchmove",o).off("touchend touchcancel",r).off("pointercancel",l),Z.___destroy()},Z.refresh=function(){y.each(function(e){g(Z._readValue(U(this)),e,!0,!1,!0,!1)})},Z.getVal=function(){return j?K.slice(0):K[0]},Z.setVal=Z._setVal=function(e,t,s){U.isArray(e)||(e=[e]),U.each(e,function(e,t){K[e]=t}),U.each(e,function(e,t){g(t,e,!0,!1,!0,s)})},n||Z.init(t)};Re.prototype={_class:"sliderbase"};var Fe=function(e,t){var s,n,a,o,i=this;K(t=t||{},{changeEvent:"click",round:!1}),Re.call(this,e,t,!0),i._readValue=function(){return e.checked?1:0},i._fillValue=function(e,t,n){s.prop("checked",!!e),n&&s.trigger("change")},i._onTap=function(e){i._setVal(e?0:1)},i.___init=function(){a=i.settings,s=U(e),(n=s.parent()).find(".mbsc-switch-track").remove(),n.prepend(s),s.attr("data-role","switch").after('<span class="mbsc-progress-cont mbsc-switch-track"><span class="mbsc-progress-track mbsc-progress-anim"><span class="mbsc-slider-handle-cont"><span class="mbsc-slider-handle mbsc-switch-handle" data-index="0"><span class="mbsc-switch-txt-off">'+a.offText+'</span><span class="mbsc-switch-txt-on">'+a.onText+"</span></span></span></span></span>"),o&&o.destroy(),o=new Ee(e,a),i._$track=n.find(".mbsc-progress-track"),i._min=0,i._max=1,i._step=1},i.___destroy=function(){o.destroy()},i.getVal=function(){return e.checked},i.setVal=function(e,t,s){i._setVal(e?1:0,t,s)},i.init(t)};Fe.prototype={_class:"switch",_css:"mbsc-switch",_hasTheme:!0,_hasLang:!0,_hasDef:!0,_defaults:{stopProp:!0,offText:"Off",onText:"On"}},V.classes.Switch=Fe,V.presetShort("switch","Switch");var qe=function(e,t,s){function n(){var e=a("value",u);e!==b&&o(e)}function a(e,t){var s=c.attr(e);return void 0===s||""===s?t:+s}function o(e,t,s,n){e=Math.min(p,Math.max(e,u)),l.css("width",100*(e-u)/(p-u)+"%"),void 0===s&&(s=!0),void 0===n&&(n=s),(e!==b||t)&&_._display(e),e!==b&&(b=e,s&&c.attr("value",b),n&&c.trigger("change"))}var i,c,r,l,m,d,u,p,h,f,b,v,_=this;He.call(this,e,t,!0),_._display=function(e){v=f&&h.returnAffix?f.replace(/\{value\}/,e).replace(/\{max\}/,p):e,m&&m.html(v),i&&i.html(v)},_._attachChange=function(){c.on("change",n)},_.__init=function(t){var s,n,o,v;if(h=_.settings,c=U(e),v=!!r,r=_._$parent,u=_._min=void 0===t.min?a("min",h.min):t.min,p=_._max=void 0===t.max?a("max",h.max):t.max,b=a("value",u),s=c.attr("data-val")||h.val,o=c.attr("data-step-labels"),o=o?JSON.parse(o):h.stepLabels,f=c.attr("data-template")||(100!=p||h.template?h.template:"{value}%"),v?(s&&(i.remove(),r.removeClass("mbsc-progress-value-"+("right"==s?"right":"left"))),o&&U(".mbsc-progress-step-label",d).remove()):(C(r),x(c),r.find(".mbsc-input-wrap").append('<span class="mbsc-progress-cont"><span class="mbsc-progress-track mbsc-progress-anim"><span class="mbsc-progress-bar"></span></span></span>'),l=_._$progress=r.find(".mbsc-progress-bar"),d=_._$track=r.find(".mbsc-progress-track")),c.attr("min",u).attr("max",p),s&&(i=U('<span class="mbsc-progress-value"></span>'),r.addClass("mbsc-progress-value-"+("right"==s?"right":"left")).find(".mbsc-input-wrap").append(i)),o)for(n=0;n<o.length;++n)d.append('<span class="mbsc-progress-step-label" style="'+(h.rtl?"right":"left")+": "+100*(o[n]-u)/(p-u)+'%" >'+o[n]+"</span>");m=U(c.attr("data-target")||h.target)},_.__destroy=function(){r.removeClass("mbsc-ic-left mbsc-ic-right").find(".mbsc-progress-cont").remove(),r.find(".mbsc-input-ic").remove(),c.off("change",n)},_.refresh=function(){o(a("value",u),!0,!1)},_.getVal=function(){return b},_.setVal=function(e,t,s){o(e,!0,t,s)},s||_.init(t)};qe.prototype={_class:"progress",_css:"mbsc-progress",_hasTheme:!0,_hasLang:!0,_hasDef:!0,_defaults:{min:0,max:100,returnAffix:!0}},V.classes.Progress=qe,V.presetShort("progress","Progress");var ze=function(e,t,s){function n(e){return 100*(e-f)/(h-f)}function a(e,t){var s=o.attr(e);return void 0===s||""===s?t:"true"===s}var o,i,c,r,l,m,d,u,p,h,f,b,v,_=this;qe.call(this,e,t,!0);var g=_.__init,y=_.__destroy;Re.call(this,e,t,!0);var w=_.__init,x=_.__destroy;_.__init=function(e){g(e),w(e)},_.__destroy=function(){y(),x()},_._update=function(e,t,s,a,o,i,l){return u?0===s?(e=Math.min(e,t[1]),c.css({width:n(t[1])-n(e)+"%",left:p?"auto":n(e)+"%",right:p?n(e)+"%":"auto"})):(e=Math.max(e,t[0]),c.css({width:n(e)-n(t[0])+"%"})):o||!m?l.css({left:p?"auto":(a||n(e))+"%",right:p?(a||n(e))+"%":"auto"}):c.css("width",(a||n(e))+"%"),d&&r.eq(s).html(e),o||t[s]==e&&!i||_._display(e),e},_._readValue=function(e){return+e.val()},_._fillValue=function(e,t,s){o.eq(t).val(e),s&&o.eq(t).trigger("change")},_.___init=function(e){var t,s;if(i&&(i.removeClass("mbsc-slider-has-tooltip"),1!=b&&U(".mbsc-slider-step",l).remove()),i=_._$parent,l=_._$track,c=_._$progress,o=i.find("input"),v=_.settings,f=_._min,h=_._max,_._step=b=void 0===e.step?+o.attr("step")||v.step:e.step,_._live=a("data-live",v.live),d=a("data-tooltip",v.tooltip),m=a("data-highlight",v.highlight)&&o.length<3,u=m&&2==o.length,p=v.rtl,d&&i.addClass("mbsc-slider-has-tooltip"),1!=b)for(s=(h-f)/b,t=0;t<=s;++t)l.append('<span class="mbsc-slider-step" style="'+(p?"right":"left")+":"+100/s*t+'%"></span>');o.each(function(e){"range"==this.type&&U(this).attr("min",f).attr("max",h).attr("step",b),(m?c:l).append('<span class="mbsc-slider-handle-cont'+(u&&!e?" mbsc-slider-handle-left":"")+'"><span tabindex="0" class="mbsc-slider-handle" aria-valuemin="'+f+'" aria-valuemax="'+h+'" data-index="'+e+'"></span>'+(d?'<span class="mbsc-slider-tooltip"></span>':"")+"</span>")}),r=i.find(".mbsc-slider-tooltip")},s||_.init(t)};ze.prototype={_class:"progress",_css:"mbsc-progress mbsc-slider",_hasTheme:!0,_hasLang:!0,_hasDef:!0,_defaults:{changeEvent:"change",stopProp:!0,min:0,max:100,step:1,live:!0,highlight:!0,round:!0,returnAffix:!0}},V.classes.Slider=ze,V.presetShort("slider","Slider");var Be=0,Ne="ios"==I&&Y>7,Ue=V.instances,Ge=function(e,t){function s(){o.removeClass("mbsc-no-touch")}var n,a="",o=U(e),i={},c=this;se.call(this,e,t,!0),c.refresh=function(e){U("input,select,textarea,progress,button",o).each(function(){var e,t=U(this),s=k(t);if("false"!=t.attr("data-enhance"))if(t.hasClass("mbsc-control"))(e=Ue[this.id]||i[this.id])&&e.option&&e.option({theme:n.theme,lang:n.lang,rtl:n.rtl,onText:n.onText,offText:n.offText,stopProp:n.stopProp});else switch(this.id||(this.id="mbsc-form-control-"+ ++Be),s){case"button":case"submit":i[this.id]=new Oe(this,{theme:n.theme,tap:n.tap});break;case"switch":i[this.id]=new Fe(this,{theme:n.theme,lang:n.lang,rtl:n.rtl,tap:n.tap,onText:n.onText,offText:n.offText,stopProp:n.stopProp});break;case"checkbox":i[this.id]=new Le(this,{tap:n.tap});break;case"range":U(this).parent().hasClass("mbsc-slider")||(i[this.id]=new ze(this,{theme:n.theme,lang:n.lang,rtl:n.rtl,stopProp:n.stopProp}));break;case"progress":i[this.id]=new qe(this,{theme:n.theme,lang:n.lang,rtl:n.rtl});break;case"radio":i[this.id]=new Ae(this,{tap:n.tap});break;case"select":case"select-one":case"select-multiple":i[this.id]=new De(this,{tap:n.tap});break;case"textarea":i[this.id]=new Ye(this,{tap:n.tap});break;case"segmented":i[this.id]=new Xe(this,{theme:n.theme,tap:n.tap});break;case"stepper":i[this.id]=new je(this,{theme:n.theme});break;case"hidden":return;default:i[this.id]=new $e(this,{tap:n.tap})}}),e||M()},c._init=function(){V.themes.form[n.theme]||(n.theme="mobiscroll"),o.hasClass("mbsc-form")||o.on("touchstart",s).show(),a&&o.removeClass(a),a="mbsc-form mbsc-no-touch mbsc-"+n.theme+(Ne?" mbsc-form-hb":"")+(n.baseTheme?" mbsc-"+n.baseTheme:"")+(n.rtl?" mbsc-rtl":" mbsc-ltr"),o.addClass(a),c.refresh()},c._destroy=function(){o.removeClass(a).off("touchstart",s);for(var e in i)i[e].destroy()},n=c.settings,c.init(t)};Ge.prototype={_hasDef:!0,_hasTheme:!0,_hasLang:!0,_class:"form",_defaults:{tap:!0,stopProp:!0,lang:"en"}},V.themes.form.mobiscroll={},V.classes.Form=Ge,V.presetShort("form","Form"),H&&U(function(){var e="[mbsc-enhance],[mbsc-form]";U(e).each(function(){new Ge(this)}),U(document).on("mbsc-enhance",function(t,s){U(t.target).is(e)?new Ge(t.target,s):U(e,t.target).each(function(){new Ge(this,s)})}),U(document).on("mbsc-refresh",function(t){var s;U(t.target).is(e)?(s=Ue[t.target.id])&&s.refresh():U(e,t.target).each(function(){(s=Ue[this.id])&&s.refresh()})})});var Je=V.themes;Je.frame.ios={display:"bottom",headerText:!1,btnWidth:!1,deleteIcon:"ios-backspace",scroll3d:!0},Je.scroller.ios=K({},Je.frame.ios,{rows:5,height:34,minWidth:55,selectedLineHeight:!0,selectedLineBorder:1,showLabel:!1,useShortLabels:!0,btnPlusClass:"mbsc-ic mbsc-ic-arrow-down5",btnMinusClass:"mbsc-ic mbsc-ic-arrow-up5",checkIcon:"ion-ios7-checkmark-empty",filterClearIcon:"ion-close-circled",dateDisplay:"MMdyy",btnCalPrevClass:"mbsc-ic mbsc-ic-arrow-left5",btnCalNextClass:"mbsc-ic mbsc-ic-arrow-right5"}),Je.listview.ios={leftArrowClass:"mbsc-ic-ion-ios7-arrow-back",rightArrowClass:"mbsc-ic-ion-ios7-arrow-forward"},Je.form.ios={},V.customTheme("mobiscroll-dark","mobiscroll");var Ke=V.themes,Ze=void 0;return"android"==I?Ze=Y>=5?"material":"android-holo":"ios"==I?Ze="ios":"wp"==I&&(Ze="wp"),V.setAutoTheme=function(){U.each(Ke.frame,function(e,t){return Ze&&t.baseTheme==Ze&&"android-holo-light"!=e&&"material-dark"!=e&&"wp-light"!=e&&"ios-dark"!=e?(V.autoTheme=e,!1):void(e==Ze&&(V.autoTheme=e))})},V.setAutoTheme(),V.customTheme("aeon-ios-blue","ios"),V.customTheme("aeon-ios-dark","ios"),V.customTheme("aeon-ios-light","ios"),V.customTheme("aeon-ios-green","ios"),V.customTheme("aeon-ios-red","ios"),V.customTheme("aeon-ios-modal-blue","ios"),V.customTheme("aeon-ios-modal-red","ios"),V.customTheme("aeon-ios-modal-light","ios"),V.uid="f7e01cab",V});

},{"jquery":331}],10:[function(require,module,exports){
!function(t){var o={},n=t.prototype.stopCallback;t.prototype.stopCallback=function(t,i,a,e){return!!this.paused||!o[a]&&!o[e]&&n.call(this,t,i,a)},t.prototype.bindGlobal=function(t,n,i){if(this.bind(t,n,i),t instanceof Array)for(n=0;n<t.length;n++)o[t[n]]=!0;else o[t]=!0},t.init()}(Mousetrap);

},{}],11:[function(require,module,exports){
var Opentip,firstAdapter,i,mouseMoved,mousePosition,mousePositionObservers,position,vendors,_i,_len,_ref,__slice=[].slice,__indexOf=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},__hasProp={}.hasOwnProperty;for(Opentip=function(){function t(e,i,o,s){var n,r,a,h,p,d,l,u,c,g,f,m,v,b,w=this;if(this.id=++t.lastId,this.debug("Creating Opentip."),t.tips.push(this),this.adapter=t.adapter,(n=this.adapter.data(e,"opentips")||[]).push(this),this.adapter.data(e,"opentips",n),this.triggerElement=this.adapter.wrap(e),this.triggerElement.length>1)throw Error("You can't call Opentip on multiple elements.");if(1>this.triggerElement.length)throw Error("Invalid element.");for(this.loaded=!1,this.loading=!1,this.visible=!1,this.waitingToShow=!1,this.waitingToHide=!1,this.currentPosition={left:0,top:0},this.dimensions={width:100,height:50},this.content="",this.redraw=!0,this.currentObservers={showing:!1,visible:!1,hiding:!1,hidden:!1},s=this.adapter.clone(s),"object"==typeof i?(s=i,i=o=void 0):"object"==typeof o&&(s=o,o=void 0),null!=o&&(s.title=o),null!=i&&this.setContent(i),null==s.extends&&(s.extends=null!=s.style?s.style:t.defaultStyle),h=[s],b=s;b.extends;){if(d=b.extends,null==(b=t.styles[d]))throw Error("Invalid style: "+d);h.unshift(b),null==b.extends&&"standard"!==d&&(b.extends="standard")}for((s=(f=this.adapter).extend.apply(f,[{}].concat(__slice.call(h)))).hideTriggers=function(){var t,e,i,o;for(o=[],t=0,e=(i=s.hideTriggers).length;e>t;t++)r=i[t],o.push(r);return o}(),s.hideTrigger&&0===s.hideTriggers.length&&s.hideTriggers.push(s.hideTrigger),l=0,c=(m=["tipJoint","targetJoint","stem"]).length;c>l;l++)p=m[l],s[p]&&"string"==typeof s[p]&&(s[p]=new t.Joint(s[p]));for(!s.ajax||!0!==s.ajax&&s.ajax||(s.ajax="A"===this.adapter.tagName(this.triggerElement)&&this.adapter.attr(this.triggerElement,"href")),"click"===s.showOn&&"A"===this.adapter.tagName(this.triggerElement)&&this.adapter.observe(this.triggerElement,"click",function(t){return t.preventDefault(),t.stopPropagation(),t.stopped=!0}),s.target&&(s.fixed=!0),!0===s.stem&&(s.stem=new t.Joint(s.tipJoint)),!0===s.target?s.target=this.triggerElement:s.target&&(s.target=this.adapter.wrap(s.target)),this.currentStem=s.stem,null==s.delay&&(s.delay="mouseover"===s.showOn?.2:0),null==s.targetJoint&&(s.targetJoint=new t.Joint(s.tipJoint).flip()),this.showTriggers=[],this.showTriggersWhenVisible=[],this.hideTriggers=[],s.showOn&&"creation"!==s.showOn&&this.showTriggers.push({element:this.triggerElement,event:s.showOn}),null!=s.ajaxCache&&(s.cache=s.ajaxCache,delete s.ajaxCache),this.options=s,this.bound={},u=0,g=(v=["prepareToShow","prepareToHide","show","hide","reposition"]).length;g>u;u++)a=v[u],this.bound[a]=function(t){return function(){return w[t].apply(w,arguments)}}(a);this.adapter.domReady(function(){return w.activate(),"creation"===w.options.showOn?w.prepareToShow():void 0})}return t.prototype.STICKS_OUT_TOP=1,t.prototype.STICKS_OUT_BOTTOM=2,t.prototype.STICKS_OUT_LEFT=1,t.prototype.STICKS_OUT_RIGHT=2,t.prototype.class={container:"opentip-container",opentip:"opentip",header:"ot-header",content:"ot-content",loadingIndicator:"ot-loading-indicator",close:"ot-close",goingToHide:"ot-going-to-hide",hidden:"ot-hidden",hiding:"ot-hiding",goingToShow:"ot-going-to-show",showing:"ot-showing",visible:"ot-visible",loading:"ot-loading",ajaxError:"ot-ajax-error",fixed:"ot-fixed",showEffectPrefix:"ot-show-effect-",hideEffectPrefix:"ot-hide-effect-",stylePrefix:"style-"},t.prototype._setup=function(){var t,e,i,o,s,n,r,a,h,p,d;for(this.debug("Setting up the tooltip."),this._buildContainer(),this.hideTriggers=[],o=s=0,r=(h=this.options.hideTriggers).length;r>s;o=++s){if(e=h[o],i=null,t=this.options.hideOn instanceof Array?this.options.hideOn[o]:this.options.hideOn,"string"==typeof e)switch(e){case"trigger":t=t||"mouseout",i=this.triggerElement;break;case"tip":t=t||"mouseover",i=this.container;break;case"target":t=t||"mouseover",i=this.options.target;break;case"closeButton":break;default:throw Error("Unknown hide trigger: "+e+".")}else t=t||"mouseover",i=this.adapter.wrap(e);i&&this.hideTriggers.push({element:i,event:t,original:e})}for(d=[],n=0,a=(p=this.hideTriggers).length;a>n;n++)e=p[n],d.push(this.showTriggersWhenVisible.push({element:e.element,event:"mouseover"}));return d},t.prototype._buildContainer=function(){return this.container=this.adapter.create('<div id="opentip-'+this.id+'" class="'+this.class.container+" "+this.class.hidden+" "+this.class.stylePrefix+this.options.className+'"></div>'),this.adapter.css(this.container,{position:"absolute"}),this.options.ajax&&this.adapter.addClass(this.container,this.class.loading),this.options.fixed&&this.adapter.addClass(this.container,this.class.fixed),this.options.showEffect&&this.adapter.addClass(this.container,""+this.class.showEffectPrefix+this.options.showEffect),this.options.hideEffect?this.adapter.addClass(this.container,""+this.class.hideEffectPrefix+this.options.hideEffect):void 0},t.prototype._buildElements=function(){var t,e;return this.tooltipElement=this.adapter.create('<div class="'+this.class.opentip+'"><div class="'+this.class.header+'"></div><div class="'+this.class.content+'"></div></div>'),this.backgroundCanvas=this.adapter.wrap(document.createElement("canvas")),this.adapter.css(this.backgroundCanvas,{position:"absolute"}),"undefined"!=typeof G_vmlCanvasManager&&null!==G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.adapter.unwrap(this.backgroundCanvas)),t=this.adapter.find(this.tooltipElement,"."+this.class.header),this.options.title&&(e=this.adapter.create("<h1></h1>"),this.adapter.update(e,this.options.title,this.options.escapeTitle),this.adapter.append(t,e)),this.options.ajax&&!this.loaded&&this.adapter.append(this.tooltipElement,this.adapter.create('<div class="'+this.class.loadingIndicator+'"><span>↻</span></div>')),__indexOf.call(this.options.hideTriggers,"closeButton")>=0&&(this.closeButtonElement=this.adapter.create('<a href="javascript:undefined;" class="'+this.class.close+'"><span>Close</span></a>'),this.adapter.append(t,this.closeButtonElement)),this.adapter.append(this.container,this.backgroundCanvas),this.adapter.append(this.container,this.tooltipElement),this.adapter.append(document.body,this.container),this._newContent=!0,this.redraw=!0},t.prototype.setContent=function(t){return this.content=t,this._newContent=!0,"function"==typeof this.content?(this._contentFunction=this.content,this.content=""):this._contentFunction=null,this.visible?this._updateElementContent():void 0},t.prototype._updateElementContent=function(){var t;return(this._newContent||!this.options.cache&&this._contentFunction)&&(null!=(t=this.adapter.find(this.container,"."+this.class.content))&&(this._contentFunction&&(this.debug("Executing content function."),this.content=this._contentFunction(this)),this.adapter.update(t,this.content,this.options.escapeContent)),this._newContent=!1),this._storeAndLockDimensions(),this.reposition()},t.prototype._storeAndLockDimensions=function(){var t;if(this.container)return t=this.dimensions,this.adapter.css(this.container,{width:"auto",left:"0px",top:"0px"}),this.dimensions=this.adapter.dimensions(this.container),this.dimensions.width+=1,this.adapter.css(this.container,{width:this.dimensions.width+"px",top:this.currentPosition.top+"px",left:this.currentPosition.left+"px"}),this._dimensionsEqual(this.dimensions,t)?void 0:(this.redraw=!0,this._draw())},t.prototype.activate=function(){return this._setupObservers("hidden","hiding")},t.prototype.deactivate=function(){return this.debug("Deactivating tooltip."),this.hide(),this._setupObservers("-showing","-visible","-hidden","-hiding")},t.prototype._setupObservers=function(){var t,e,i,o,s,n,r,a,h,p,d,l,u,c,g,f,m=this;for(n=0,p=(o=arguments.length>=1?__slice.call(arguments,0):[]).length;p>n;n++)if(i=o[n],e=!1,"-"===i.charAt(0)&&(e=!0,i=i.substr(1)),this.currentObservers[i]!==!e)switch(this.currentObservers[i]=!e,t=function(){var t,i,o;return t=arguments.length>=1?__slice.call(arguments,0):[],e?(i=m.adapter).stopObserving.apply(i,t):(o=m.adapter).observe.apply(o,t)},i){case"showing":for(r=0,d=(c=this.hideTriggers).length;d>r;r++)s=c[r],t(s.element,s.event,this.bound.prepareToHide);t(null!=document.onresize?document:window,"resize",this.bound.reposition),t(window,"scroll",this.bound.reposition);break;case"visible":for(a=0,l=(g=this.showTriggersWhenVisible).length;l>a;a++)s=g[a],t(s.element,s.event,this.bound.prepareToShow);break;case"hiding":for(h=0,u=(f=this.showTriggers).length;u>h;h++)s=f[h],t(s.element,s.event,this.bound.prepareToShow);break;case"hidden":break;default:throw Error("Unknown state: "+i)}return null},t.prototype.prepareToShow=function(){return this._abortHiding(),this._abortShowing(),this.visible?void 0:(this.debug("Showing in "+this.options.delay+"s."),null==this.container&&this._setup(),this.options.group&&t._abortShowingGroup(this.options.group,this),this.preparingToShow=!0,this._setupObservers("-hidden","-hiding","showing"),this._followMousePosition(),this.options.fixed&&!this.options.target&&(this.initialMousePosition=mousePosition),this.reposition(),this._showTimeoutId=this.setTimeout(this.bound.show,this.options.delay||0))},t.prototype.show=function(){var e=this;return this._abortHiding(),this.visible?void 0:(this._clearTimeouts(),this._triggerElementExists()?(this.debug("Showing now."),null==this.container&&this._setup(),this.options.group&&t._hideGroup(this.options.group,this),this.visible=!0,this.preparingToShow=!1,null==this.tooltipElement&&this._buildElements(),this._updateElementContent(),!this.options.ajax||this.loaded&&this.options.cache||this._loadAjax(),this._searchAndActivateCloseButtons(),this._startEnsureTriggerElement(),this.adapter.css(this.container,{zIndex:t.lastZIndex++}),this._setupObservers("-hidden","-hiding","-showing","-visible","showing","visible"),this.options.fixed&&!this.options.target&&(this.initialMousePosition=mousePosition),this.reposition(),this.adapter.removeClass(this.container,this.class.hiding),this.adapter.removeClass(this.container,this.class.hidden),this.adapter.addClass(this.container,this.class.goingToShow),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var t;if(e.visible&&!e.preparingToHide)return e.adapter.removeClass(e.container,e.class.goingToShow),e.adapter.addClass(e.container,e.class.showing),t=0,e.options.showEffect&&e.options.showEffectDuration&&(t=e.options.showEffectDuration),e.setCss3Style(e.container,{transitionDuration:t+"s"}),e._visibilityStateTimeoutId=e.setTimeout(function(){return e.adapter.removeClass(e.container,e.class.showing),e.adapter.addClass(e.container,e.class.visible)},t),e._activateFirstInput()}),this._draw()):this.deactivate())},t.prototype._abortShowing=function(){return this.preparingToShow?(this.debug("Aborting showing."),this._clearTimeouts(),this._stopFollowingMousePosition(),this.preparingToShow=!1,this._setupObservers("-showing","-visible","hiding","hidden")):void 0},t.prototype.prepareToHide=function(){return this._abortShowing(),this._abortHiding(),this.visible?(this.debug("Hiding in "+this.options.hideDelay+"s"),this.preparingToHide=!0,this._setupObservers("-showing","visible","-hidden","hiding"),this._hideTimeoutId=this.setTimeout(this.bound.hide,this.options.hideDelay)):void 0},t.prototype.hide=function(){var t=this;return this._abortShowing(),this.visible&&(this._clearTimeouts(),this.debug("Hiding!"),this.visible=!1,this.preparingToHide=!1,this._stopEnsureTriggerElement(),this._setupObservers("-showing","-visible","-hiding","-hidden","hiding","hidden"),this.options.fixed||this._stopFollowingMousePosition(),this.container)?(this.adapter.removeClass(this.container,this.class.visible),this.adapter.removeClass(this.container,this.class.showing),this.adapter.addClass(this.container,this.class.goingToHide),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var e;return t.adapter.removeClass(t.container,t.class.goingToHide),t.adapter.addClass(t.container,t.class.hiding),e=0,t.options.hideEffect&&t.options.hideEffectDuration&&(e=t.options.hideEffectDuration),t.setCss3Style(t.container,{transitionDuration:e+"s"}),t._visibilityStateTimeoutId=t.setTimeout(function(){return t.adapter.removeClass(t.container,t.class.hiding),t.adapter.addClass(t.container,t.class.hidden),t.setCss3Style(t.container,{transitionDuration:"0s"}),t.options.removeElementsOnHide?(t.debug("Removing HTML elements."),t.adapter.remove(t.container),delete t.container,delete t.tooltipElement):void 0},e)})):void 0},t.prototype._abortHiding=function(){return this.preparingToHide?(this.debug("Aborting hiding."),this._clearTimeouts(),this.preparingToHide=!1,this._setupObservers("-hiding","showing","visible")):void 0},t.prototype.reposition=function(){var t,e,i,o=this;return null==(t=this.getPosition())||(e=this.options.stem,this.options.containInViewport&&(i=this._ensureViewportContainment(t),t=i.position,e=i.stem),this._positionsEqual(t,this.currentPosition))?void 0:(this.options.stem&&!e.eql(this.currentStem)&&(this.redraw=!0),this.currentPosition=t,this.currentStem=e,this._draw(),this.adapter.css(this.container,{left:t.left+"px",top:t.top+"px"}),this.defer(function(){var t;return t=o.adapter.unwrap(o.container),t.style.visibility="hidden",t.offsetHeight,t.style.visibility="visible"}))},t.prototype.getPosition=function(t,e,i){var o,s,n,r,a,h,p,d,l;if(this.container)return null==t&&(t=this.options.tipJoint),null==e&&(e=this.options.targetJoint),r={},this.options.target?(p=this.adapter.offset(this.options.target),h=this.adapter.dimensions(this.options.target),r=p,e.right?null!=(d=this.adapter.unwrap(this.options.target)).getBoundingClientRect?r.left=d.getBoundingClientRect().right+(null!=(l=window.pageXOffset)?l:document.body.scrollLeft):r.left+=h.width:e.center&&(r.left+=Math.round(h.width/2)),e.bottom?r.top+=h.height:e.middle&&(r.top+=Math.round(h.height/2)),this.options.borderWidth&&(this.options.tipJoint.left&&(r.left+=this.options.borderWidth),this.options.tipJoint.right&&(r.left-=this.options.borderWidth),this.options.tipJoint.top?r.top+=this.options.borderWidth:this.options.tipJoint.bottom&&(r.top-=this.options.borderWidth))):r=this.initialMousePosition?{top:this.initialMousePosition.y,left:this.initialMousePosition.x}:{top:mousePosition.y,left:mousePosition.x},this.options.autoOffset&&(a=this.options.stem?this.options.stemLength:0,n=a&&this.options.fixed?2:10,o=t.middle&&!this.options.fixed?15:0,s=t.center&&!this.options.fixed?15:0,t.right?r.left-=n+o:t.left&&(r.left+=n+o),t.bottom?r.top-=n+s:t.top&&(r.top+=n+s),a&&(null==i&&(i=this.options.stem),i.right?r.left-=a:i.left&&(r.left+=a),i.bottom?r.top-=a:i.top&&(r.top+=a))),r.left+=this.options.offset[0],r.top+=this.options.offset[1],t.right?r.left-=this.dimensions.width:t.center&&(r.left-=Math.round(this.dimensions.width/2)),t.bottom?r.top-=this.dimensions.height:t.middle&&(r.top-=Math.round(this.dimensions.height/2)),r},t.prototype._ensureViewportContainment=function(e){var i,o,s,n,r,a,h,p,d,l,u;if(h=this.options.stem,s={position:e,stem:h},!this.visible||!e)return s;if(!(p=this._sticksOut(e))[0]&&!p[1])return s;if(l=new t.Joint(this.options.tipJoint),this.options.targetJoint&&(d=new t.Joint(this.options.targetJoint)),a=this.adapter.scrollOffset(),u=this.adapter.viewportDimensions(),[e.left-a[0],e.top-a[1]],i=!1,u.width>=this.dimensions.width&&p[0])switch(i=!0,p[0]){case this.STICKS_OUT_LEFT:l.setHorizontal("left"),this.options.targetJoint&&d.setHorizontal("right");break;case this.STICKS_OUT_RIGHT:l.setHorizontal("right"),this.options.targetJoint&&d.setHorizontal("left")}if(u.height>=this.dimensions.height&&p[1])switch(i=!0,p[1]){case this.STICKS_OUT_TOP:l.setVertical("top"),this.options.targetJoint&&d.setVertical("bottom");break;case this.STICKS_OUT_BOTTOM:l.setVertical("bottom"),this.options.targetJoint&&d.setVertical("top")}return i?(this.options.stem&&(h=l),e=this.getPosition(l,d,h),o=this._sticksOut(e),n=!1,r=!1,o[0]&&o[0]!==p[0]&&(n=!0,l.setHorizontal(this.options.tipJoint.horizontal),this.options.targetJoint&&d.setHorizontal(this.options.targetJoint.horizontal)),o[1]&&o[1]!==p[1]&&(r=!0,l.setVertical(this.options.tipJoint.vertical),this.options.targetJoint&&d.setVertical(this.options.targetJoint.vertical)),n&&r?s:((n||r)&&(this.options.stem&&(h=l),e=this.getPosition(l,d,h)),{position:e,stem:h})):s},t.prototype._sticksOut=function(t){var e,i,o,s;return i=this.adapter.scrollOffset(),s=this.adapter.viewportDimensions(),e=[t.left-i[0],t.top-i[1]],o=[!1,!1],0>e[0]?o[0]=this.STICKS_OUT_LEFT:e[0]+this.dimensions.width>s.width&&(o[0]=this.STICKS_OUT_RIGHT),0>e[1]?o[1]=this.STICKS_OUT_TOP:e[1]+this.dimensions.height>s.height&&(o[1]=this.STICKS_OUT_BOTTOM),o},t.prototype._draw=function(){var e,i,o,s,n,r,a,h,p,d,l,u,c,g,f,m,v,b,w,_=this;if(this.backgroundCanvas&&this.redraw){if(this.debug("Drawing background."),this.redraw=!1,this.currentStem){for(f=0,m=(v=["top","right","bottom","left"]).length;m>f;f++)u=v[f],this.adapter.removeClass(this.container,"stem-"+u);this.adapter.addClass(this.container,"stem-"+this.currentStem.horizontal),this.adapter.addClass(this.container,"stem-"+this.currentStem.vertical)}return r=[0,0],a=[0,0],__indexOf.call(this.options.hideTriggers,"closeButton")>=0&&(n=new t.Joint("top right"===(null!=(b=this.currentStem)?b+"":void 0)?"top left":"top right"),r=[this.options.closeButtonRadius+this.options.closeButtonOffset[0],this.options.closeButtonRadius+this.options.closeButtonOffset[1]],a=[this.options.closeButtonRadius-this.options.closeButtonOffset[0],this.options.closeButtonRadius-this.options.closeButtonOffset[1]]),o=this.adapter.clone(this.dimensions),s=[0,0],this.options.borderWidth&&(o.width+=2*this.options.borderWidth,o.height+=2*this.options.borderWidth,s[0]-=this.options.borderWidth,s[1]-=this.options.borderWidth),this.options.shadow&&(o.width+=2*this.options.shadowBlur,o.width+=Math.max(0,this.options.shadowOffset[0]-2*this.options.shadowBlur),o.height+=2*this.options.shadowBlur,o.height+=Math.max(0,this.options.shadowOffset[1]-2*this.options.shadowBlur),s[0]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[0]),s[1]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[1])),i={left:0,right:0,top:0,bottom:0},this.currentStem&&(this.currentStem.left?i.left=this.options.stemLength:this.currentStem.right&&(i.right=this.options.stemLength),this.currentStem.top?i.top=this.options.stemLength:this.currentStem.bottom&&(i.bottom=this.options.stemLength)),n&&(n.left?i.left=Math.max(i.left,a[0]):n.right&&(i.right=Math.max(i.right,a[0])),n.top?i.top=Math.max(i.top,a[1]):n.bottom&&(i.bottom=Math.max(i.bottom,a[1]))),o.width+=i.left+i.right,o.height+=i.top+i.bottom,s[0]-=i.left,s[1]-=i.top,this.currentStem&&this.options.borderWidth&&(w=this._getPathStemMeasures(this.options.stemBase,this.options.stemLength,this.options.borderWidth),g=w.stemLength,c=w.stemBase),e=this.adapter.unwrap(this.backgroundCanvas),e.width=o.width,e.height=o.height,this.adapter.css(this.backgroundCanvas,{width:e.width+"px",height:e.height+"px",left:s[0]+"px",top:s[1]+"px"}),(h=e.getContext("2d")).setTransform(1,0,0,1,0,0),h.clearRect(0,0,e.width,e.height),h.beginPath(),h.fillStyle=this._getColor(h,this.dimensions,this.options.background,this.options.backgroundGradientHorizontal),h.lineJoin="miter",h.miterLimit=500,l=this.options.borderWidth/2,this.options.borderWidth?(h.strokeStyle=this.options.borderColor,h.lineWidth=this.options.borderWidth):(g=this.options.stemLength,c=this.options.stemBase),null==c&&(c=0),d=function(t,e,i){return i&&h.moveTo(Math.max(c,_.options.borderRadius,r[0])+1-l,-l),e?(h.lineTo(t/2-c/2,-l),h.lineTo(t/2,-g-l),h.lineTo(t/2+c/2,-l)):void 0},p=function(t,e,i){var o,s,n,a;return t?(h.lineTo(-c+l,0-l),h.lineTo(g+l,-g-l),h.lineTo(l,c-l)):e?(a=_.options.closeButtonOffset,n=r[0],i%2!=0&&(a=[a[1],a[0]],n=r[1]),o=Math.acos(a[1]/_.options.closeButtonRadius),s=Math.acos(a[0]/_.options.closeButtonRadius),h.lineTo(-n+l,-l),h.arc(l-a[0],-l+a[1],_.options.closeButtonRadius,-(Math.PI/2+o),s,!1)):(h.lineTo(-_.options.borderRadius+l,-l),h.quadraticCurveTo(l,-l,l,_.options.borderRadius-l))},h.translate(-s[0],-s[1]),h.save(),function(){var e,i,o,s,r,a,l,u,c,g,f;for(f=[],i=c=0,g=t.positions.length/2;g>=0?g>c:c>g;i=g>=0?++c:--c)r=2*i,a=0===i||3===i?0:_.dimensions.width,l=2>i?0:_.dimensions.height,u=Math.PI/2*i,o=i%2==0?_.dimensions.width:_.dimensions.height,s=new t.Joint(t.positions[r]),e=new t.Joint(t.positions[r+1]),h.save(),h.translate(a,l),h.rotate(u),d(o,s.eql(_.currentStem),0===i),h.translate(o,0),p(e.eql(_.currentStem),e.eql(n),i),f.push(h.restore())}(),h.closePath(),h.save(),this.options.shadow&&(h.shadowColor=this.options.shadowColor,h.shadowBlur=this.options.shadowBlur,h.shadowOffsetX=this.options.shadowOffset[0],h.shadowOffsetY=this.options.shadowOffset[1]),h.fill(),h.restore(),this.options.borderWidth&&h.stroke(),h.restore(),n?function(){var t,e,i;return 2*_.options.closeButtonRadius,n+""=="top right"?(i=[_.dimensions.width-_.options.closeButtonOffset[0],_.options.closeButtonOffset[1]],t=[i[0]+l,i[1]-l]):(i=[_.options.closeButtonOffset[0],_.options.closeButtonOffset[1]],t=[i[0]-l,i[1]-l]),h.translate(t[0],t[1]),e=_.options.closeButtonCrossSize/2,h.save(),h.beginPath(),h.strokeStyle=_.options.closeButtonCrossColor,h.lineWidth=_.options.closeButtonCrossLineWidth,h.lineCap="round",h.moveTo(-e,-e),h.lineTo(e,e),h.stroke(),h.beginPath(),h.moveTo(e,-e),h.lineTo(-e,e),h.stroke(),h.restore(),_.adapter.css(_.closeButtonElement,{left:i[0]-e-_.options.closeButtonLinkOverscan+"px",top:i[1]-e-_.options.closeButtonLinkOverscan+"px",width:_.options.closeButtonCrossSize+2*_.options.closeButtonLinkOverscan+"px",height:_.options.closeButtonCrossSize+2*_.options.closeButtonLinkOverscan+"px"})}():void 0}},t.prototype._getPathStemMeasures=function(t,e,i){var o,s,n,r,a,h,p;if(r=i/2,n=Math.atan(t/2/e),o=2*n,a=r/Math.sin(o),s=2*a*Math.cos(n),0>(p=r+e-s))throw Error("Sorry but your stemLength / stemBase ratio is strange.");return h=Math.tan(n)*p*2,{stemLength:p,stemBase:h}},t.prototype._getColor=function(t,e,i,o){var s,n,r,a,h;if(null==o&&(o=!1),"string"==typeof i)return i;for(n=o?t.createLinearGradient(0,0,e.width,0):t.createLinearGradient(0,0,0,e.height),r=a=0,h=i.length;h>a;r=++a)s=i[r],n.addColorStop(s[0],s[1]);return n},t.prototype._searchAndActivateCloseButtons=function(){var t,e,i,o;for(e=0,i=(o=this.adapter.findAll(this.container,"."+this.class.close)).length;i>e;e++)t=o[e],this.hideTriggers.push({element:this.adapter.wrap(t),event:"click"});return this.currentObservers.showing&&this._setupObservers("-showing","showing"),this.currentObservers.visible?this._setupObservers("-visible","visible"):void 0},t.prototype._activateFirstInput=function(){var t;return null!=(t=this.adapter.unwrap(this.adapter.find(this.container,"input, textarea")))&&"function"==typeof t.focus?t.focus():void 0},t.prototype._followMousePosition=function(){return this.options.fixed?void 0:t._observeMousePosition(this.bound.reposition)},t.prototype._stopFollowingMousePosition=function(){return this.options.fixed?void 0:t._stopObservingMousePosition(this.bound.reposition)},t.prototype._clearShowTimeout=function(){return clearTimeout(this._showTimeoutId)},t.prototype._clearHideTimeout=function(){return clearTimeout(this._hideTimeoutId)},t.prototype._clearTimeouts=function(){return clearTimeout(this._visibilityStateTimeoutId),this._clearShowTimeout(),this._clearHideTimeout()},t.prototype._triggerElementExists=function(){var t;for(t=this.adapter.unwrap(this.triggerElement);t.parentNode;){if("BODY"===t.parentNode.tagName)return!0;t=t.parentNode}return!1},t.prototype._loadAjax=function(){var t=this;if(!this.loading)return this.loaded=!1,this.loading=!0,this.adapter.addClass(this.container,this.class.loading),this.setContent(""),this.debug("Loading content from "+this.options.ajax),this.adapter.ajax({url:this.options.ajax,method:this.options.ajaxMethod,onSuccess:function(e){return t.debug("Loading successful."),t.adapter.removeClass(t.container,t.class.loading),t.setContent(e)},onError:function(e){var i;return i=t.options.ajaxErrorMessage,t.debug(i,e),t.setContent(i),t.adapter.addClass(t.container,t.class.ajaxError)},onComplete:function(){return t.adapter.removeClass(t.container,t.class.loading),t.loading=!1,t.loaded=!0,t._searchAndActivateCloseButtons(),t._activateFirstInput(),t.reposition()}})},t.prototype._ensureTriggerElement=function(){return this._triggerElementExists()?void 0:(this.deactivate(),this._stopEnsureTriggerElement())},t.prototype._ensureTriggerElementInterval=1e3,t.prototype._startEnsureTriggerElement=function(){var t=this;return this._ensureTriggerElementTimeoutId=setInterval(function(){return t._ensureTriggerElement()},this._ensureTriggerElementInterval)},t.prototype._stopEnsureTriggerElement=function(){return clearInterval(this._ensureTriggerElementTimeoutId)},t}(),vendors=["khtml","ms","o","moz","webkit"],Opentip.prototype.setCss3Style=function(t,e){var i,o,s,n,r;t=this.adapter.unwrap(t),r=[];for(i in e)__hasProp.call(e,i)&&(o=e[i],null!=t.style[i]?r.push(t.style[i]=o):r.push(function(){var e,r,a;for(a=[],e=0,r=vendors.length;r>e;e++)s=vendors[e],n=""+this.ucfirst(s)+this.ucfirst(i),null!=t.style[n]?a.push(t.style[n]=o):a.push(void 0);return a}.call(this)));return r},Opentip.prototype.defer=function(t){return setTimeout(t,0)},Opentip.prototype.setTimeout=function(t,e){return setTimeout(t,e?1e3*e:0)},Opentip.prototype.ucfirst=function(t){return null==t?"":t.charAt(0).toUpperCase()+t.slice(1)},Opentip.prototype.dasherize=function(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})},mousePositionObservers=[],mousePosition={x:0,y:0},mouseMoved=function(t){var e,i,o,s;for(mousePosition=Opentip.adapter.mousePosition(t),s=[],i=0,o=mousePositionObservers.length;o>i;i++)e=mousePositionObservers[i],s.push(e());return s},Opentip.followMousePosition=function(){return Opentip.adapter.observe(document.body,"mousemove",mouseMoved)},Opentip._observeMousePosition=function(t){return mousePositionObservers.push(t)},Opentip._stopObservingMousePosition=function(t){var e;return mousePositionObservers=function(){var i,o,s;for(s=[],i=0,o=mousePositionObservers.length;o>i;i++)(e=mousePositionObservers[i])!==t&&s.push(e);return s}()},Opentip.Joint=function(){function t(t){null!=t&&(t instanceof Opentip.Joint&&(t+=""),this.set(t))}return t.prototype.set=function(t){return t=t.toLowerCase(),this.setHorizontal(t),this.setVertical(t),this},t.prototype.setHorizontal=function(t){var e,i,o,s,n,r,a;for(o=0,n=(i=["left","center","right"]).length;n>o;o++)e=i[o],~t.indexOf(e)&&(this.horizontal=e.toLowerCase());for(null==this.horizontal&&(this.horizontal="center"),a=[],s=0,r=i.length;r>s;s++)e=i[s],a.push(this[e]=this.horizontal===e?e:void 0);return a},t.prototype.setVertical=function(t){var e,i,o,s,n,r,a;for(o=0,n=(i=["top","middle","bottom"]).length;n>o;o++)e=i[o],~t.indexOf(e)&&(this.vertical=e.toLowerCase());for(null==this.vertical&&(this.vertical="middle"),a=[],s=0,r=i.length;r>s;s++)e=i[s],a.push(this[e]=this.vertical===e?e:void 0);return a},t.prototype.eql=function(t){return null!=t&&this.horizontal===t.horizontal&&this.vertical===t.vertical},t.prototype.flip=function(){var t,e;return e=Opentip.position[this.toString(!0)],t=(e+4)%8,this.set(Opentip.positions[t]),this},t.prototype.toString=function(t){var e,i;return null==t&&(t=!1),i="middle"===this.vertical?"":this.vertical,e="center"===this.horizontal?"":this.horizontal,i&&e&&(e=t?Opentip.prototype.ucfirst(e):" "+e),""+i+e},t}(),Opentip.prototype._positionsEqual=function(t,e){return null!=t&&null!=e&&t.left===e.left&&t.top===e.top},Opentip.prototype._dimensionsEqual=function(t,e){return null!=t&&null!=e&&t.width===e.width&&t.height===e.height},Opentip.prototype.debug=function(){var t;return t=arguments.length>=1?__slice.call(arguments,0):[],Opentip.debug&&null!=("undefined"!=typeof console&&null!==console?console.debug:void 0)?(t.unshift("#"+this.id+" |"),console.debug.apply(console,t)):void 0},Opentip.findElements=function(){var t,e,i,o,s,n,r,a,h,p;for(p=[],r=0,a=(h=(t=Opentip.adapter).findAll(document.body,"[data-ot]")).length;a>r;r++){i=h[r],n={},(""===(e=t.data(i,"ot"))||"true"===e||"yes"===e)&&(e=t.attr(i,"title"),t.attr(i,"title","")),e=e||"";for(o in Opentip.styles.standard)null!=(s=t.data(i,"ot"+Opentip.prototype.ucfirst(o)))&&("yes"===s||"true"===s||"on"===s?s=!0:("no"===s||"false"===s||"off"===s)&&(s=!1),n[o]=s);p.push(new Opentip(i,e,n))}return p},Opentip.version="2.4.6",Opentip.debug=!1,Opentip.lastId=0,Opentip.lastZIndex=100,Opentip.tips=[],Opentip._abortShowingGroup=function(t,e){var i,o,s,n,r;for(r=[],o=0,s=(n=Opentip.tips).length;s>o;o++)(i=n[o])!==e&&i.options.group===t?r.push(i._abortShowing()):r.push(void 0);return r},Opentip._hideGroup=function(t,e){var i,o,s,n,r;for(r=[],o=0,s=(n=Opentip.tips).length;s>o;o++)(i=n[o])!==e&&i.options.group===t?r.push(i.hide()):r.push(void 0);return r},Opentip.adapters={},Opentip.adapter=null,firstAdapter=!0,Opentip.addAdapter=function(t){return Opentip.adapters[t.name]=t,firstAdapter?(Opentip.adapter=t,t.domReady(Opentip.findElements),t.domReady(Opentip.followMousePosition),firstAdapter=!1):void 0},Opentip.positions=["top","topRight","right","bottomRight","bottom","bottomLeft","left","topLeft"],Opentip.position={},i=_i=0,_len=(_ref=Opentip.positions).length;_len>_i;i=++_i)position=_ref[i],Opentip.position[position]=i;Opentip.styles={standard:{extends:null,title:void 0,escapeTitle:!0,escapeContent:!1,className:"standard",stem:!0,delay:null,hideDelay:.1,fixed:!1,showOn:"mouseover",hideTrigger:"trigger",hideTriggers:[],hideOn:null,removeElementsOnHide:!1,offset:[0,0],containInViewport:!0,autoOffset:!0,showEffect:"appear",hideEffect:"fade",showEffectDuration:.3,hideEffectDuration:.2,stemLength:5,stemBase:8,tipJoint:"top left",target:null,targetJoint:null,cache:!0,ajax:!1,ajaxMethod:"GET",ajaxErrorMessage:"There was a problem downloading the content.",group:null,style:null,background:"#fff18f",backgroundGradientHorizontal:!1,closeButtonOffset:[5,5],closeButtonRadius:7,closeButtonCrossSize:4,closeButtonCrossColor:"#d2c35b",closeButtonCrossLineWidth:1.5,closeButtonLinkOverscan:6,borderRadius:5,borderWidth:1,borderColor:"#f2e37b",shadow:!0,shadowBlur:10,shadowOffset:[3,3],shadowColor:"rgba(0, 0, 0, 0.1)"},glass:{extends:"standard",className:"glass",background:[[0,"rgba(252, 252, 252, 0.8)"],[.5,"rgba(255, 255, 255, 0.8)"],[.5,"rgba(250, 250, 250, 0.9)"],[1,"rgba(245, 245, 245, 0.9)"]],borderColor:"#eee",closeButtonCrossColor:"rgba(0, 0, 0, 0.2)",borderRadius:15,closeButtonRadius:10,closeButtonOffset:[8,8]},dark:{extends:"standard",className:"dark",borderRadius:13,borderColor:"#444",closeButtonCrossColor:"rgba(240, 240, 240, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(30, 30, 30, 0.7)"],[.5,"rgba(30, 30, 30, 0.8)"],[.5,"rgba(10, 10, 10, 0.8)"],[1,"rgba(10, 10, 10, 0.9)"]]},alert:{extends:"standard",className:"alert",borderRadius:1,borderColor:"#AE0D11",closeButtonCrossColor:"rgba(255, 255, 255, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(203, 15, 19, 0.7)"],[.5,"rgba(203, 15, 19, 0.8)"],[.5,"rgba(189, 14, 18, 0.8)"],[1,"rgba(179, 14, 17, 0.9)"]]}},Opentip.defaultStyle="standard","undefined"!=typeof module&&null!==module?module.exports=Opentip:window.Opentip=Opentip;__slice=[].slice;!function(t){var e;t.fn.opentip=function(t,e,i){return new Opentip(this,t,e,i)},e=function(){function e(){}return e.prototype.name="jquery",e.prototype.domReady=function(e){return t(e)},e.prototype.create=function(e){return t(e)},e.prototype.wrap=function(e){if((e=t(e)).length>1)throw Error("Multiple elements provided.");return e},e.prototype.unwrap=function(e){return t(e)[0]},e.prototype.tagName=function(t){return this.unwrap(t).tagName},e.prototype.attr=function(){var e,i,o;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],(o=t(i)).attr.apply(o,e)},e.prototype.data=function(){var e,i,o;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],(o=t(i)).data.apply(o,e)},e.prototype.find=function(e,i){return t(e).find(i).get(0)},e.prototype.findAll=function(e,i){return t(e).find(i)},e.prototype.update=function(e,i,o){return e=t(e),o?e.text(i):e.html(i)},e.prototype.append=function(e,i){return t(e).append(i)},e.prototype.remove=function(e){return t(e).remove()},e.prototype.addClass=function(e,i){return t(e).addClass(i)},e.prototype.removeClass=function(e,i){return t(e).removeClass(i)},e.prototype.css=function(e,i){return t(e).css(i)},e.prototype.dimensions=function(e){return{width:t(e).outerWidth(),height:t(e).outerHeight()}},e.prototype.scrollOffset=function(){return[window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop]},e.prototype.viewportDimensions=function(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}},e.prototype.mousePosition=function(t){return null==t?null:{x:t.pageX,y:t.pageY}},e.prototype.offset=function(e){var i;return i=t(e).offset(),{left:i.left,top:i.top}},e.prototype.observe=function(e,i,o){return t(e).bind(i,o)},e.prototype.stopObserving=function(e,i,o){return t(e).unbind(i,o)},e.prototype.ajax=function(e){var i,o;if(null==e.url)throw Error("No url provided");return t.ajax({url:e.url,type:null!=(i=null!=(o=e.method)?o.toUpperCase():void 0)?i:"GET"}).done(function(t){return"function"==typeof e.onSuccess?e.onSuccess(t):void 0}).fail(function(t){return"function"==typeof e.onError?e.onError("Server responded with status "+t.status):void 0}).always(function(){return"function"==typeof e.onComplete?e.onComplete():void 0})},e.prototype.clone=function(e){return t.extend({},e)},e.prototype.extend=function(){var e,i;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],t.extend.apply(t,[i].concat(__slice.call(e)))},e}(),Opentip.addAdapter(new e)}(jQuery);

},{}],12:[function(require,module,exports){
!function(t){"use strict";var e=t.fn.popover,o=function(t,o){e.Constructor.apply(this,arguments)};o.prototype=t.extend({},e.Constructor.prototype,{constructor:o,_super:function(){var o=t.makeArray(arguments);e.Constructor.prototype[o.shift()].apply(this,o)},show:function(){var t,e,o,i,s,h,n;this.hasContent&&this.enabled&&(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),h="function"==typeof this.options.placement?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,e=/in/.test(h),t.remove().css({top:0,left:0,display:"block"}).appendTo(e?this.$element:document.body),o=this.getPosition(e?this.$element:null),i=t[0].offsetWidth,s=t[0].offsetHeight,n=this.calcPosition(e?h.split(" ")[1]:h,o,i,s),t.css(n).addClass("in"),this.setPlacementClass(t,h))},setPlacementClass:function(t,e){t.removeClass("left right bottom top topLeft topRight bottomLeft bottomRight rightTop rightBottom leftTop leftBottom"),t.addClass(e)},reposition:function(){var t,e,o,i,s,h,n;t=this.tip(),h="function"==typeof this.options.placement?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,e=/in/.test(h),o=this.getPosition(e),i=t[0].offsetWidth,s=t[0].offsetHeight,n=this.calcPosition(e?h.split(" ")[1]:h,o,i,s),t.css(n),this.setPlacementClass(t,h)},calcPosition:function(t,e,o,i){var s,h=document.documentElement.clientWidth-10,n=document.documentElement.clientHeight-10;switch(t){case"bottom":s={top:e.top+e.height,left:e.left+e.width/2-o/2};break;case"top":s={top:e.top-i,left:e.left+e.width/2-o/2};break;case"left":s={top:e.top+e.height/2-i/2,left:e.left-o};break;case"right":s={top:e.top+e.height/2-i/2,left:e.left+e.width};break;case"topLeft":s={top:e.top-i,left:e.left+e.width/2-Math.min(20,.25*o)};break;case"topRight":s={top:e.top-i,left:e.left+e.width/2-Math.max(o-20,.75*o)};break;case"rightTop":s={top:e.top+e.height/2-Math.min(20,.25*i),left:e.left+e.width};break;case"rightBottom":s={top:e.top+e.height/2-Math.max(i-20,.75*i),left:e.left+e.width};break;case"bottomLeft":s={top:e.top+e.height,left:e.left+e.width/2-Math.min(20,.25*o)};break;case"bottomRight":s={top:e.top+e.height,left:e.left+e.width/2-Math.max(o-20,.75*o)};break;case"leftTop":s={top:e.top+e.height/2-Math.min(20,.25*i),left:e.left-o};break;case"leftBottom":s={top:e.top+e.height/2-Math.max(i-20,.75*i),left:e.left-o}}return s.left<0?s.left=0:s.left+o>h&&(s.left=h-o),s.top<0?s.top=0:s.top+i>n&&(s.top=n-i),s}}),t.fn.popover=t.extend(function(e){return this.each(function(){var i=t(this),s=i.data("popover"),h="object"==typeof e&&e;s||i.data("popover",s=new o(this,h)),"string"==typeof e&&s[e]()})},e)}(jQuery);

},{}],13:[function(require,module,exports){
window.Slip=function(){"use strict";function t(e,i){if("string"==typeof e&&(e=document.querySelector(e)),!e||!e.addEventListener)throw new Error("Please specify DOM node to attach to");if(!this||this===window)return new t(e,i);this.options=i=i||{},this.options.keepSwipingPercent=i.keepSwipingPercent||0,this.options.minimumSwipeVelocity=i.minimumSwipeVelocity||1,this.options.minimumSwipeTime=i.minimumSwipeTime||110,this.options.moveableClass=i.moveableClass||null,this.cancel=this.setState.bind(this,this.states.idle),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onSelection=this.onSelection.bind(this),this.onContainerFocus=this.onContainerFocus.bind(this),this.setState(this.states.idle),this.attach(e)}function e(t){var e=t.style[c];if(e)return{value:e,original:e};if(window.getComputedStyle){var i=window.getComputedStyle(t).getPropertyValue(u);if(i&&"none"!==i)return{value:i,original:""}}return{value:"",original:""}}function i(t,e){for(var i=0,n=0,s=0;s<e.length;s++)1===e[s].nodeType&&(n++,e[s]===t.node&&(i=n-1));return i}var n={ariaRole:"listbox",tabIndex:0,focus:!1},s={ariaRole:"option",tabIndex:-1,focus:!1},o=/Chrome\/[3-5]/.test(navigator.userAgent),a=o,r=o,h=document.createElement("div").style,l="transition"in h?"transition":"webkitTransition",c="transform"in h?"transform":"webkitTransform",u="webkitTransform"===c?"-webkit-transform":"transform",d="userSelect"in h?"userSelect":"webkitUserSelect";h[c]="translateZ(0)";var m=h[c]?"translateZ(0) ":"",g=h[c]?"translateZ(1px) ":"";h=null;var v=0,f=!1,p=function(){};return t.prototype={container:null,options:{},state:null,target:null,usingTouch:!1,mouseHandlersAttached:!1,startPosition:null,latestPosition:null,previousPosition:null,canPreventScrolling:!1,states:{idle:function(){return this.removeMouseHandlers(),this.target&&(this.target.node.style.willChange="",this.target=null),this.usingTouch=!1,{allowTextSelection:!0}},undecided:function(){if(this.target.height=this.target.node.offsetHeight,this.target.node.style.willChange=u,this.target.node.style[l]="",this.dispatch(this.target.originalTarget,"beforewait"))var t=setTimeout(function(){var t=this.getAbsoluteMovement();this.canPreventScrolling&&t.x<15&&t.y<25&&this.dispatch(this.target.originalTarget,"beforereorder")&&this.setState(this.states.reorder)}.bind(this),300);else this.dispatch(this.target.originalTarget,"beforereorder")&&this.setState(this.states.reorder);return{leaveState:function(){clearTimeout(t)},onMove:function(){var t=this.getAbsoluteMovement();if(t.x>20&&t.y<Math.max(100,this.target.height)){if(this.dispatch(this.target.originalTarget,"beforeswipe",{directionX:t.directionX,directionY:t.directionY}))return this.setState(this.states.swipe),!1;this.setState(this.states.idle)}if(t.y>20&&this.setState(this.states.idle),t.x>1.2*t.y)return!1},onLeave:function(){this.setState(this.states.idle)},onEnd:function(){var t=this.dispatch(this.target.originalTarget,"tap");return this.setState(this.states.idle),t}}},swipe:function(){function t(){n.classList.remove("slip-swiping-container")}var e=!1,n=this.container,s=i(this.target,this.container.childNodes);return n.classList.add("slip-swiping-container"),this.target.height=this.target.node.offsetHeight,{leaveState:function(){e?this.animateSwipe(function(e){if(e.node.style[c]=e.baseTransform.original,e.node.style[l]="",this.dispatch(e.node,"afterswipe"))return t(),!0;this.animateToZero(void 0,e)}.bind(this)):this.animateToZero(t)},onMove:function(){var t=this.getTotalMovement();if(Math.abs(t.y)<this.target.height+20)return this.dispatch(this.target.node,"animateswipe",{x:t.x,originalIndex:s})&&(this.target.node.style[c]="translate("+t.x+"px,0) "+m+this.target.baseTransform.value),!1;this.dispatch(this.target.node,"cancelswipe"),this.setState(this.states.idle)},onLeave:function(){this.state.onEnd.call(this)},onEnd:function(){var t=this.getAbsoluteMovement(),i=t.x/t.time,n=100*Math.abs((this.startPosition.x-this.previousPosition.x)/this.container.clientWidth),o=i>this.options.minimumSwipeVelocity&&t.time>this.options.minimumSwipeTime||this.options.keepSwipingPercent&&n>this.options.keepSwipingPercent;return o?this.dispatch(this.target.node,"swipe",{direction:t.directionX,originalIndex:s})&&(e=!0):this.dispatch(this.target.node,"cancelswipe"),this.setState(this.states.idle),!o}}},reorder:function(){function t(){this.updateScrolling(),o&&(clearTimeout(o),o=null);var t=this.getTotalMovement();this.target.node.style[c]="translate(0,"+t.y+"px) "+g+this.target.baseTransform.value;var e=this.target.height;return f.forEach(function(i){var n=0;i.moveable&&(i.pos<0&&t.y<0&&i.pos>t.y?n=e:i.pos>0&&t.y>0&&i.pos<t.y&&(n=-e),i.node.style[c]=n?"translate(0,"+n+"px) "+m+i.baseTransform.value:i.baseTransform.original)}),!1}this.target.node.focus&&s.focus&&this.target.node.focus(),this.target.height=this.target.node.offsetHeight;for(var o,a=this.container.childNodes,h=i(this.target,a),v=this.target.node.offsetTop+this.target.height/2,f=[],p=0;p<a.length;p++)if(1==a[p].nodeType&&a[p]!==this.target.node){var b=a[p].offsetTop;a[p].style[l]=u+" 0.2s ease-in-out",f.push({node:a[p],baseTransform:e(a[p]),pos:b+(b<v?a[p].offsetHeight:0)-v,moveable:!this.options.moveableClass||a[p].classList.contains(this.options.moveableClass)})}return this.target.node.classList.add("slip-reordering"),this.target.node.style.zIndex="99999",this.target.node.style[d]="none",r&&(this.container.style.webkitTransformStyle="preserve-3d"),t.call(this),{leaveState:function(){o&&clearTimeout(o),r&&(this.container.style.webkitTransformStyle=""),this.container.focus&&n.focus&&this.container.focus(),this.target.node.classList.remove("slip-reordering"),this.target.node.style[d]="",this.animateToZero(function(t){t.node.style.zIndex=""}),f.forEach(function(t){t.moveable&&(t.node.style[c]=t.baseTransform.original,t.node.style[l]="")})},onMove:t,onLeave:function(){o&&clearTimeout(o),o=setTimeout(function(){o=null,this.cancel()}.bind(this),700)},onEnd:function(){var t,e,i=this.getTotalMovement();if(i.y<0){for(t=0;t<f.length&&!(f[t].moveable&&f[t].pos>i.y);t++);e=t}else{for(t=f.length-1;t>=0&&!(f[t].moveable&&f[t].pos<i.y);t--);e=t+1}return this.dispatch(this.target.node,"reorder",{spliceIndex:e,originalIndex:h,insertBefore:f[e]?f[e].node:null}),this.setState(this.states.idle),!1}}}},attach:function(t){v++,this.container&&this.detach(),!f&&a&&(f=!0,document.body.addEventListener("touchstart",p,!1)),this.container=t,!1!==n.tabIndex&&(this.container.tabIndex=n.tabIndex),n.ariaRole&&this.container.setAttribute("aria-role",n.ariaRole),this.setChildNodesAriaRoles(),this.container.addEventListener("focus",this.onContainerFocus,!1),this.otherNodes=[],document.addEventListener("selectionchange",this.onSelection,!1),this.container.addEventListener("touchcancel",this.cancel,!1),this.container.addEventListener("touchstart",this.onTouchStart,!1),this.container.addEventListener("touchmove",this.onTouchMove,!1),this.container.addEventListener("touchend",this.onTouchEnd,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1)},detach:function(){this.cancel(),this.container.removeEventListener("mousedown",this.onMouseDown,!1),this.container.removeEventListener("touchend",this.onTouchEnd,!1),this.container.removeEventListener("touchmove",this.onTouchMove,!1),this.container.removeEventListener("touchstart",this.onTouchStart,!1),this.container.removeEventListener("touchcancel",this.cancel,!1),document.removeEventListener("selectionchange",this.onSelection,!1),!1!==n.tabIndex&&this.container.removeAttribute("tabIndex"),n.ariaRole&&this.container.removeAttribute("aria-role"),this.unSetChildNodesAriaRoles(),!--v&&f&&(f=!1,document.body.removeEventListener("touchstart",p,!1))},setState:function(t){if(this.state){if(this.state.ctor===t)return;this.state.leaveState&&this.state.leaveState.call(this)}var e=this.state,i=t.call(this);this.state===e&&(i.ctor=t,this.state=i)},findTargetNode:function(t){for(;t&&t.parentNode!==this.container;)t=t.parentNode;return t},onContainerFocus:function(t){this.setChildNodesAriaRoles()},setChildNodesAriaRoles:function(){for(var t=this.container.childNodes,e=0;e<t.length;e++)1==t[e].nodeType&&(s.ariaRole&&t[e].setAttribute("aria-role",s.ariaRole),!1!==s.tabIndex&&(t[e].tabIndex=s.tabIndex))},unSetChildNodesAriaRoles:function(){for(var t=this.container.childNodes,e=0;e<t.length;e++)1==t[e].nodeType&&(s.ariaRole&&t[e].removeAttribute("aria-role"),!1!==s.tabIndex&&t[e].removeAttribute("tabIndex"))},onSelection:function(t){var e=t.target===document||this.findTargetNode(t),i=/(iPhone|iPad|iPod)/i.test(navigator.userAgent)&&!/(Android|Windows)/i.test(navigator.userAgent);e&&(i?this.setState(this.states.idle):this.state.allowTextSelection||t.preventDefault())},addMouseHandlers:function(){this.mouseHandlersAttached||(this.mouseHandlersAttached=!0,document.documentElement.addEventListener("mouseleave",this.onMouseLeave,!1),window.addEventListener("mousemove",this.onMouseMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),window.addEventListener("blur",this.cancel,!1))},removeMouseHandlers:function(){this.mouseHandlersAttached&&(this.mouseHandlersAttached=!1,document.documentElement.removeEventListener("mouseleave",this.onMouseLeave,!1),window.removeEventListener("mousemove",this.onMouseMove,!0),window.removeEventListener("mouseup",this.onMouseUp,!0),window.removeEventListener("blur",this.cancel,!1))},onMouseLeave:function(t){this.usingTouch||t.target!==document.documentElement&&t.relatedTarget!==document.documentElement||this.state.onLeave&&this.state.onLeave.call(this)},onMouseDown:function(t){!this.usingTouch&&0==t.button&&this.setTarget(t)&&(this.addMouseHandlers(),this.canPreventScrolling=!0,this.startAtPosition({x:t.clientX,y:t.clientY,time:t.timeStamp}))},onTouchStart:function(t){this.usingTouch=!0,this.canPreventScrolling=!0,t.touches.length>1?this.setState(this.states.idle):this.setTarget(t)&&this.startAtPosition({x:t.touches[0].clientX,y:t.touches[0].clientY,time:t.timeStamp})},setTarget:function(t){var i=this.findTargetNode(t.target);if(!i)return this.setState(this.states.idle),!1;for(var n=i.parentNode;n&&n!=document.body&&!(n.scrollHeight>n.clientHeight&&"visible"!=window.getComputedStyle(n)["overflow-y"]);)n=n.parentNode;return n=n||document.body,this.target={originalTarget:t.target,node:i,scrollContainer:n,origScrollTop:n.scrollTop,origScrollHeight:n.scrollHeight,baseTransform:e(i)},!0},startAtPosition:function(t){this.startPosition=this.previousPosition=this.latestPosition=t,this.setState(this.states.undecided)},updatePosition:function(t,e){null!=this.target&&(this.latestPosition=e,this.state.onMove&&!1===this.state.onMove.call(this)&&t.preventDefault(),this.latestPosition.time-this.previousPosition.time>100&&(this.previousPosition=this.latestPosition))},onMouseMove:function(t){this.updatePosition(t,{x:t.clientX,y:t.clientY,time:t.timeStamp})},onTouchMove:function(t){this.updatePosition(t,{x:t.touches[0].clientX,y:t.touches[0].clientY,time:t.timeStamp}),this.canPreventScrolling=!1},onMouseUp:function(t){this.usingTouch||0!==t.button||this.state.onEnd&&!1===this.state.onEnd.call(this)&&t.preventDefault()},onTouchEnd:function(t){t.touches.length>1?this.cancel():this.state.onEnd&&!1===this.state.onEnd.call(this)&&t.preventDefault()},getTotalMovement:function(){var t=this.target.scrollContainer.scrollTop-this.target.origScrollTop;return{x:this.latestPosition.x-this.startPosition.x,y:this.latestPosition.y-this.startPosition.y+t,time:this.latestPosition.time-this.startPosition.time}},getAbsoluteMovement:function(){var t=this.getTotalMovement();return{x:Math.abs(t.x),y:Math.abs(t.y),time:t.time,directionX:t.x<0?"left":"right",directionY:t.y<0?"up":"down"}},updateScrolling:function(){var t=0,e=this.target.scrollContainer,i=e.getBoundingClientRect(),n=this.target.node.getBoundingClientRect(),s=Math.min(i.bottom,window.innerHeight)-n.bottom,o=n.top-Math.max(i.top,0),a=this.target.origScrollHeight-Math.min(e.clientHeight,window.innerHeight);s<40?t=Math.min(40,40-s):o<40&&(t=Math.max(-40,o-40)),e.scrollTop=Math.max(0,Math.min(a,e.scrollTop+t))},dispatch:function(t,e,i){var n=document.createEvent("CustomEvent");return n&&n.initCustomEvent?n.initCustomEvent("slip:"+e,!0,!0,i):((n=document.createEvent("Event")).initEvent("slip:"+e,!0,!0),n.detail=i),t.dispatchEvent(n)},getSiblings:function(t){for(var i=[],n=t.node.nextSibling;n;)1==n.nodeType&&i.push({node:n,baseTransform:e(n)}),n=n.nextSibling;return i},animateToZero:function(t,e){(e=e||this.target).node.style[l]=u+" 0.1s ease-out",e.node.style[c]="translate(0,0) "+m+e.baseTransform.value,setTimeout(function(){e.node.style[l]="",e.node.style[c]=e.baseTransform.original,t&&t.call(this,e)}.bind(this),101)},animateSwipe:function(t){var e=this.target,i=this.getSiblings(e),n="translate(0,"+this.target.height+"px) "+m+" ";e.node.style[l]="all 0.1s linear",e.node.style[c]=" translate("+(this.getTotalMovement().x>0?"":"-")+"100%,0) "+m+e.baseTransform.value,setTimeout(function(){t.call(this,e)&&(i.forEach(function(t){t.node.style[l]="",t.node.style[c]=n+t.baseTransform.value}),setTimeout(function(){i.forEach(function(t){t.node.style[l]=u+" 0.1s ease-in-out",t.node.style[c]="translate(0,0) "+m+t.baseTransform.value}),setTimeout(function(){i.forEach(function(t){t.node.style[l]="",t.node.style[c]=t.baseTransform.original})},101)},1))}.bind(this),101)}},"function"==typeof define&&define.amd&&define(function(){return t}),t}();

},{}],14:[function(require,module,exports){
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t,e){"use strict";function r(e,r,n,a){for(var i=[],s=0;s<e.length;s++){var o=e[s];if(o){var l=tinycolor(o),c=l.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(r,o)?" sp-thumb-active":"";var f=l.toString(a.preferredFormat||"rgb"),h=u?"background-color:"+l.toRgbString():"filter:"+l.toFilter();i.push('<span title="'+f+'" data-color="'+l.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+h+';" /></span>')}else{i.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",a.noColorSelectedText)).html())}}return"<div class='sp-cf "+n+"'>"+i.join("")+"</div>"}function n(n,a){function g(){if(D.showPaletteOnly&&(D.showPalette=!0),At.text(D.showPaletteOnly?D.togglePaletteMoreText:D.togglePaletteLessText),D.palette){rt=D.palette.slice(0),nt=t.isArray(rt[0])?rt:[rt],at={};for(var e=0;e<nt.length;e++)for(var r=0;r<nt[e].length;r++){var n=tinycolor(nt[e][r]).toRgbString();at[n]=!0}}ht.toggleClass("sp-flat",E),ht.toggleClass("sp-input-disabled",!D.showInput),ht.toggleClass("sp-alpha-enabled",D.showAlpha),ht.toggleClass("sp-clear-enabled",zt),ht.toggleClass("sp-buttons-disabled",!D.showButtons),ht.toggleClass("sp-palette-buttons-disabled",!D.togglePaletteOnly),ht.toggleClass("sp-palette-disabled",!D.showPalette),ht.toggleClass("sp-palette-only",D.showPaletteOnly),ht.toggleClass("sp-initial-disabled",!D.showInitial),ht.addClass(D.className).addClass(D.containerClassName),q()}function b(){if(j&&window.localStorage){try{var e=window.localStorage[j].split(",#");e.length>1&&(delete window.localStorage[j],t.each(e,function(t,e){v(e)}))}catch(t){}try{it=window.localStorage[j].split(";")}catch(t){}}}function v(e){if(I){var r=tinycolor(e).toRgbString();if(!at[r]&&-1===t.inArray(r,it))for(it.push(r);it.length>st;)it.shift();if(j&&window.localStorage)try{window.localStorage[j]=it.join(";")}catch(t){}}}function m(){var e=H(),n=t.map(nt,function(t,n){return r(t,e,"sp-palette-row sp-palette-row-"+n,D)});b(),it&&n.push(r(function(){var t=[];if(D.showPalette)for(var e=0;e<it.length;e++){var r=tinycolor(it[e]).toRgbString();at[r]||t.push(it[e])}return t.reverse().slice(0,D.maxSelectionSize)}(),e,"sp-palette-row sp-palette-row-selection",D)),xt.html(n.join(""))}function y(){if(D.showInitial){var t=Nt,e=H();kt.html(r([t,e],e,"sp-palette-row-initial",D))}}function w(){($<=0||V<=0||X<=0)&&q(),ht.addClass(ot),lt=null,ft.trigger("dragstart.spectrum",[H()])}function _(){ht.removeClass(ot),ft.trigger("dragstop.spectrum",[H()])}function x(){var t=_t.val();if(null!==t&&""!==t||!zt){var e=tinycolor(t);e.isValid()?(M(e),O(!0)):_t.addClass("sp-validation-error")}else M(null),O(!0)}function k(){K?P():S()}function S(){var e=t.Event("beforeShow.spectrum");K?q():(ft.trigger(e,[H()]),!1===B.beforeShow(H())||e.isDefaultPrevented()||(!function(){for(var t=0;t<c.length;t++)c[t]&&c[t].hide()}(),K=!0,t(ct).bind("click.spectrum",C),t(window).bind("resize.spectrum",L),Ft.addClass("sp-active"),ht.removeClass("sp-hidden"),q(),F(),Nt=H(),y(),B.show(Nt),ft.trigger("show.spectrum",[Nt])))}function C(t){2!=t.button&&(It?O(!0):A(),P())}function P(){K&&!E&&(K=!1,t(ct).unbind("click.spectrum",C),t(window).unbind("resize.spectrum",L),Ft.removeClass("sp-active"),ht.addClass("sp-hidden"),B.hide(H()),ft.trigger("hide.spectrum",[H()]))}function A(){M(Nt,!0)}function M(t,e){if(tinycolor.equals(t,H()))F();else{var r,n;!t&&zt?jt=!0:(jt=!1,n=(r=tinycolor(t)).toHsv(),U=n.h%360/360,Z=n.s,tt=n.v,et=n.a),F(),r&&r.isValid()&&!e&&(Et=Dt||r.getFormat())}}function H(t){return t=t||{},zt&&jt?null:tinycolor.fromRatio({h:U,s:Z,v:tt,a:Math.round(100*et)/100},{format:t.format||Et})}function R(){F(),B.move(H()),ft.trigger("move.spectrum",[H()])}function F(){_t.removeClass("sp-validation-error"),T();var t=tinycolor.fromRatio({h:U,s:1,v:1});pt.css("background-color",t.toHexString());var e=Et;et<1&&(0!==et||"name"!==e)&&("hex"!==e&&"hex3"!==e&&"hex6"!==e&&"name"!==e||(e="rgb"));var r=H({format:e}),n="";if(Ot.removeClass("sp-clear-display"),Ot.css("background-color","transparent"),!r&&zt)Ot.addClass("sp-clear-display");else{var a=r.toHexString(),i=r.toRgbString();if(u||1===r.alpha?Ot.css("background-color",i):(Ot.css("background-color","transparent"),Ot.css("filter",r.toFilter())),D.showAlpha){var s=r.toRgb();s.a=0;var o=tinycolor(s).toRgbString(),l="linear-gradient(left, "+o+", "+a+")";f?mt.css("filter",tinycolor(o).toFilter({gradientType:1},a)):(mt.css("background","-webkit-"+l),mt.css("background","-moz-"+l),mt.css("background","-ms-"+l),mt.css("background","linear-gradient(to right, "+o+", "+a+")"))}n=r.toString(e)}D.showInput&&_t.val(n),D.showPalette&&m(),y()}function T(){var t=Z,e=tt;if(zt&&jt)wt.hide(),vt.hide(),gt.hide();else{wt.show(),vt.show(),gt.show();var r=t*V,n=$-e*$;r=Math.max(-W,Math.min(V-W,r-W)),n=Math.max(-W,Math.min($-W,n-W)),gt.css({top:n+"px",left:r+"px"});var a=et*G;wt.css({left:a-Q/2+"px"});var i=U*X;vt.css({top:i-J+"px"})}}function O(t){var e=H(),r="",n=!tinycolor.equals(e,Nt);e&&(r=e.toString(Et),v(e)),Mt&&ft.val(r),t&&n&&(B.change(e),ft.trigger("change",[e]))}function q(){V=pt.width(),$=pt.height(),W=gt.height(),Y=bt.width(),X=bt.height(),J=vt.height(),G=yt.width(),Q=wt.width(),E||(ht.css("position","absolute"),D.offset?ht.offset(D.offset):ht.offset(function(e,r){var n=e.outerWidth(),a=e.outerHeight(),i=r.outerHeight(),s=e[0].ownerDocument,o=s.documentElement,l=o.clientWidth+t(s).scrollLeft(),c=o.clientHeight+t(s).scrollTop(),f=r.offset();return f.top+=i,f.left-=Math.min(f.left,f.left+n>l&&l>n?Math.abs(f.left+n-l):0),f.top-=Math.min(f.top,f.top+a>c&&c>a?Math.abs(a+i-0):0),f}(ht,Tt))),T(),D.showPalette&&m(),ft.trigger("reflow.spectrum")}function N(){P(),ut=!0,ft.attr("disabled",!0),Tt.addClass("sp-disabled")}var D=function(e,r){var n=t.extend({},l,e);return n.callbacks={move:s(n.move,r),change:s(n.change,r),show:s(n.show,r),hide:s(n.hide,r),beforeShow:s(n.beforeShow,r)},n}(a,n),E=D.flat,I=D.showSelectionPalette,j=D.localStorageKey,z=D.theme,B=D.callbacks,L=function(t,e,r){var n;return function(){var a=this,i=arguments;r&&clearTimeout(n),!r&&n||(n=setTimeout(function(){n=null,t.apply(a,i)},e))}}(q,10),K=!1,V=0,$=0,W=0,X=0,Y=0,G=0,Q=0,J=0,U=0,Z=0,tt=0,et=1,rt=[],nt=[],at={},it=D.selectionPalette.slice(0),st=D.maxSelectionSize,ot="sp-dragging",lt=null,ct=n.ownerDocument,ft=(ct.body,t(n)),ut=!1,ht=t(p,ct).addClass(z),dt=ht.find(".sp-picker-container"),pt=ht.find(".sp-color"),gt=ht.find(".sp-dragger"),bt=ht.find(".sp-hue"),vt=ht.find(".sp-slider"),mt=ht.find(".sp-alpha-inner"),yt=ht.find(".sp-alpha"),wt=ht.find(".sp-alpha-handle"),_t=ht.find(".sp-input"),xt=ht.find(".sp-palette"),kt=ht.find(".sp-initial"),St=ht.find(".sp-cancel"),Ct=ht.find(".sp-clear"),Pt=ht.find(".sp-choose"),At=ht.find(".sp-palette-toggle"),Mt=ft.is("input"),Ht=Mt&&h&&"color"===ft.attr("type"),Rt=Mt&&!E,Ft=Rt?t(d).addClass(z).addClass(D.className).addClass(D.replacerClassName):t([]),Tt=Rt?Ft:ft,Ot=Ft.find(".sp-preview-inner"),qt=D.color||Mt&&ft.val(),Nt=!1,Dt=D.preferredFormat,Et=Dt,It=!D.showButtons||D.clickoutFiresChange,jt=!qt,zt=D.allowEmpty&&!Ht;!function(){function e(e){return e.data&&e.data.ignore?(M(t(e.target).closest(".sp-thumb-el").data("color")),R()):(M(t(e.target).closest(".sp-thumb-el").data("color")),R(),O(!0),D.hideAfterPaletteSelect&&P()),!1}if(f&&ht.find("*:not(input)").attr("unselectable","on"),g(),Rt&&ft.after(Ft).hide(),zt||Ct.hide(),E)ft.after(ht).hide();else{var r="parent"===D.appendTo?ft.parent():t(D.appendTo);1!==r.length&&(r=t("body")),r.append(ht)}b(),Tt.bind("click.spectrum touchstart.spectrum",function(e){ut||k(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(ft.is(":disabled")||!0===D.disabled)&&N(),ht.click(i),_t.change(x),_t.bind("paste",function(){setTimeout(x,1)}),_t.keydown(function(t){13==t.keyCode&&x()}),St.text(D.cancelText),St.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),A(),P()}),Ct.attr("title",D.clearText),Ct.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),jt=!0,R(),E&&O(!0)}),Pt.text(D.chooseText),Pt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),_t.hasClass("sp-validation-error")||(O(!0),P())}),At.text(D.showPaletteOnly?D.togglePaletteMoreText:D.togglePaletteLessText),At.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),D.showPaletteOnly=!D.showPaletteOnly,D.showPaletteOnly||E||ht.css("left","-="+(dt.outerWidth(!0)+5)),g()}),o(yt,function(t,e,r){et=t/G,jt=!1,r.shiftKey&&(et=Math.round(10*et)/10),R()},w,_),o(bt,function(t,e){U=parseFloat(e/X),jt=!1,D.showAlpha||(et=1),R()},w,_),o(pt,function(t,e,r){if(r.shiftKey){if(!lt){var n=Z*V,a=$-tt*$,i=Math.abs(t-n)>Math.abs(e-a);lt=i?"x":"y"}}else lt=null;var s=!lt||"y"===lt;(!lt||"x"===lt)&&(Z=parseFloat(t/V)),s&&(tt=parseFloat(($-e)/$)),jt=!1,D.showAlpha||(et=1),R()},w,_),qt?(M(qt),F(),Et=Dt||tinycolor(qt).format,v(qt)):F(),E&&S();var n=f?"mousedown.spectrum":"click.spectrum touchstart.spectrum";xt.delegate(".sp-thumb-el",n,e),kt.delegate(".sp-thumb-el:nth-child(1)",n,{ignore:!0},e)}();var Bt={show:S,hide:P,toggle:k,reflow:q,option:function(r,n){return r===e?t.extend({},D):n===e?D[r]:(D[r]=n,void g())},enable:function(){ut=!1,ft.attr("disabled",!1),Tt.removeClass("sp-disabled")},disable:N,offset:function(t){D.offset=t,q()},set:function(t){M(t),O()},get:H,destroy:function(){ft.show(),Tt.unbind("click.spectrum touchstart.spectrum"),ht.remove(),Ft.remove(),c[Bt.id]=null},container:ht};return Bt.id=c.push(Bt)-1,Bt}function a(){}function i(t){t.stopPropagation()}function s(t,e){var r=Array.prototype.slice,n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}function o(e,r,n,a){function i(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function s(t){if(c){if(f&&l.documentMode<9&&!t.button)return o();var n=t.originalEvent&&t.originalEvent.touches,a=n?n[0].pageX:t.pageX,s=n?n[0].pageY:t.pageY,g=Math.max(0,Math.min(a-u.left,d)),b=Math.max(0,Math.min(s-u.top,h));p&&i(t),r.apply(e,[g,b,t])}}function o(){c&&(t(l).unbind(g),t(l.body).removeClass("sp-dragging"),a.apply(e,arguments)),c=!1}r=r||function(){},n=n||function(){},a=a||function(){};var l=document,c=!1,u={},h=0,d=0,p="ontouchstart"in window,g={};g.selectstart=i,g.dragstart=i,g["touchmove mousemove"]=s,g["touchend mouseup"]=o,t(e).bind("touchstart mousedown",function(r){(r.which?3==r.which:2==r.button)||c||!1!==n.apply(e,arguments)&&(c=!0,h=t(e).height(),d=t(e).width(),u=t(e).offset(),t(l).bind(g),t(l.body).addClass("sp-dragging"),p||s(r),i(r))})}var l={beforeShow:a,move:a,change:a,show:a,hide:a,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},c=[],f=!!/msie/i.exec(window.navigator.userAgent),u=function(){function t(t,e){return!!~(""+t).indexOf(e)}var e=document.createElement("div").style;return e.cssText="background-color:rgba(0,0,0,.5)",t(e.backgroundColor,"rgba")||t(e.backgroundColor,"hsla")}(),h=function(){var e=t("<input type='color' value='!' />")[0];return"color"===e.type&&"!"!==e.value}(),d=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),p=function(){var t="";if(f)for(var e=1;e<=6;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();t.fn.spectrum=function(e,r){if("string"==typeof e){var a=this,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=c[t(this).data("spectrum.id")];if(r){var n=r[e];if(!n)throw new Error("Spectrum: no such method: '"+e+"'");"get"==e?a=r.get():"container"==e?a=r.container:"option"==e?a=r.option.apply(r,i):"destroy"==e?(r.destroy(),t(this).removeData("spectrum.id")):n.apply(r,i)}}),a}return this.spectrum("destroy").each(function(){var r=n(this,t.extend({},e,t(this).data()));t(this).data("spectrum.id",r.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=o,t.fn.spectrum.defaults=l,t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){h||t("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function t(t){var e={r:0,g:0,b:0},r=1,n=!1,a=!1;return"string"==typeof t&&(t=function(t){t=t.replace(S,"").replace(C,"").toLowerCase();var e=!1;if(O[t])t=O[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var r;if(r=N.rgb.exec(t))return{r:r[1],g:r[2],b:r[3]};if(r=N.rgba.exec(t))return{r:r[1],g:r[2],b:r[3],a:r[4]};if(r=N.hsl.exec(t))return{h:r[1],s:r[2],l:r[3]};if(r=N.hsla.exec(t))return{h:r[1],s:r[2],l:r[3],a:r[4]};if(r=N.hsv.exec(t))return{h:r[1],s:r[2],v:r[3]};if(r=N.hsva.exec(t))return{h:r[1],s:r[2],v:r[3],a:r[4]};if(r=N.hex8.exec(t))return{a:function(t){return _(t)/255}(r[1]),r:_(r[2]),g:_(r[3]),b:_(r[4]),format:e?"name":"hex8"};if(r=N.hex6.exec(t))return{r:_(r[1]),g:_(r[2]),b:_(r[3]),format:e?"name":"hex"};if(r=N.hex3.exec(t))return{r:_(r[1]+""+r[1]),g:_(r[2]+""+r[2]),b:_(r[3]+""+r[3]),format:e?"name":"hex"};return!1}(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=function(t,e,r){return{r:255*y(t,255),g:255*y(e,255),b:255*y(r,255)}}(t.r,t.g,t.b),n=!0,a="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=k(t.s),t.v=k(t.v),e=function(t,e,r){t=6*y(t,360),e=y(e,100),r=y(r,100);var n=A.floor(t),a=t-n,i=r*(1-e),s=r*(1-a*e),o=r*(1-(1-a)*e),l=n%6;return{r:255*[r,s,i,i,o,r][l],g:255*[o,r,r,s,i,i][l],b:255*[i,i,o,r,r,s][l]}}(t.h,t.s,t.v),n=!0,a="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=k(t.s),t.l=k(t.l),e=function(t,e,r){function n(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}var a,i,s;t=y(t,360),e=y(e,100),r=y(r,100);if(0===e)a=i=s=r;else{var o=r<.5?r*(1+e):r+e-r*e,l=2*r-o;a=n(l,o,t+1/3),i=n(l,o,t),s=n(l,o,t-1/3)}return{r:255*a,g:255*i,b:255*s}}(t.h,t.s,t.l),n=!0,a="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=m(r),{ok:n,format:t.format||a,r:H(255,R(e.r,0)),g:H(255,R(e.g,0)),b:H(255,R(e.b,0)),a:r}}function e(t,e,r){t=y(t,255),e=y(e,255),r=y(r,255);var n,a,i=R(t,e,r),s=H(t,e,r),o=(i+s)/2;if(i==s)n=a=0;else{var l=i-s;switch(a=o>.5?l/(2-i-s):l/(i+s),i){case t:n=(e-r)/l+(e<r?6:0);break;case e:n=(r-t)/l+2;break;case r:n=(t-e)/l+4}n/=6}return{h:n,s:a,l:o}}function r(t,e,r){t=y(t,255),e=y(e,255),r=y(r,255);var n,a,i=R(t,e,r),s=H(t,e,r),o=i-s;if(a=0===i?0:o/i,i==s)n=0;else{switch(i){case t:n=(e-r)/o+(e<r?6:0);break;case e:n=(r-t)/o+2;break;case r:n=(t-e)/o+4}n/=6}return{h:n,s:a,v:i}}function n(t,e,r,n){var a=[x(M(t).toString(16)),x(M(e).toString(16)),x(M(r).toString(16))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function a(t,e,r,n){return[x(function(t){return Math.round(255*parseFloat(t)).toString(16)}(n)),x(M(t).toString(16)),x(M(e).toString(16)),x(M(r).toString(16))].join("")}function i(t,e){e=0===e?0:e||10;var r=T(t).toHsl();return r.s-=e/100,r.s=w(r.s),T(r)}function s(t,e){e=0===e?0:e||10;var r=T(t).toHsl();return r.s+=e/100,r.s=w(r.s),T(r)}function o(t){return T(t).desaturate(100)}function l(t,e){e=0===e?0:e||10;var r=T(t).toHsl();return r.l+=e/100,r.l=w(r.l),T(r)}function c(t,e){e=0===e?0:e||10;var r=T(t).toRgb();return r.r=R(0,H(255,r.r-M(-e/100*255))),r.g=R(0,H(255,r.g-M(-e/100*255))),r.b=R(0,H(255,r.b-M(-e/100*255))),T(r)}function f(t,e){e=0===e?0:e||10;var r=T(t).toHsl();return r.l-=e/100,r.l=w(r.l),T(r)}function u(t,e){var r=T(t).toHsl(),n=(M(r.h)+e)%360;return r.h=n<0?360+n:n,T(r)}function h(t){var e=T(t).toHsl();return e.h=(e.h+180)%360,T(e)}function d(t){var e=T(t).toHsl(),r=e.h;return[T(t),T({h:(r+120)%360,s:e.s,l:e.l}),T({h:(r+240)%360,s:e.s,l:e.l})]}function p(t){var e=T(t).toHsl(),r=e.h;return[T(t),T({h:(r+90)%360,s:e.s,l:e.l}),T({h:(r+180)%360,s:e.s,l:e.l}),T({h:(r+270)%360,s:e.s,l:e.l})]}function g(t){var e=T(t).toHsl(),r=e.h;return[T(t),T({h:(r+72)%360,s:e.s,l:e.l}),T({h:(r+216)%360,s:e.s,l:e.l})]}function b(t,e,r){e=e||6,r=r||30;var n=T(t).toHsl(),a=360/r,i=[T(t)];for(n.h=(n.h-(a*e>>1)+720)%360;--e;)n.h=(n.h+a)%360,i.push(T(n));return i}function v(t,e){e=e||6;for(var r=T(t).toHsv(),n=r.h,a=r.s,i=r.v,s=[],o=1/e;e--;)s.push(T({h:n,s:a,v:i})),i=(i+o)%1;return s}function m(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function y(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var r=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=H(e,R(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),A.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function w(t){return H(1,R(0,t))}function _(t){return parseInt(t,16)}function x(t){return 1==t.length?"0"+t:""+t}function k(t){return t<=1&&(t=100*t+"%"),t}var S=/^[\s,#]+/,C=/\s+$/,P=0,A=Math,M=A.round,H=A.min,R=A.max,F=A.random,T=function e(r,n){if(r=r||"",n=n||{},r instanceof e)return r;if(!(this instanceof e))return new e(r,n);var a=t(r);this._originalInput=r,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=M(100*this._a)/100,this._format=n.format||a.format,this._gradientType=n.gradientType,this._r<1&&(this._r=M(this._r)),this._g<1&&(this._g=M(this._g)),this._b<1&&(this._b=M(this._b)),this._ok=a.ok,this._tc_id=P++};T.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=m(t),this._roundA=M(100*this._a)/100,this},toHsv:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=r(this._r,this._g,this._b),e=M(360*t.h),n=M(100*t.s),a=M(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+a+"%)":"hsva("+e+", "+n+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var t=e(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=e(this._r,this._g,this._b),r=M(360*t.h),n=M(100*t.s),a=M(100*t.l);return 1==this._a?"hsl("+r+", "+n+"%, "+a+"%)":"hsla("+r+", "+n+"%, "+a+"%, "+this._roundA+")"},toHex:function(t){return n(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return a(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:M(this._r),g:M(this._g),b:M(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+M(this._r)+", "+M(this._g)+", "+M(this._b)+")":"rgba("+M(this._r)+", "+M(this._g)+", "+M(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:M(100*y(this._r,255))+"%",g:M(100*y(this._g,255))+"%",b:M(100*y(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+M(100*y(this._r,255))+"%, "+M(100*y(this._g,255))+"%, "+M(100*y(this._b,255))+"%)":"rgba("+M(100*y(this._r,255))+"%, "+M(100*y(this._g,255))+"%, "+M(100*y(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(q[n(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+a(this._r,this._g,this._b,this._a),r=e,n=this._gradientType?"GradientType = 1, ":"";if(t){r=T(t).toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+r+")"},toString:function(t){var e=!!t;t=t||this._format;var r=!1,n=this._a<1&&this._a>=0;return e||!n||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"name"!==t?("rgb"===t&&(r=this.toRgbString()),"prgb"===t&&(r=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(r=this.toHexString()),"hex3"===t&&(r=this.toHexString(!0)),"hex8"===t&&(r=this.toHex8String()),"name"===t&&(r=this.toName()),"hsl"===t&&(r=this.toHslString()),"hsv"===t&&(r=this.toHsvString()),r||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(l,arguments)},brighten:function(){return this._applyModification(c,arguments)},darken:function(){return this._applyModification(f,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(s,arguments)},greyscale:function(){return this._applyModification(o,arguments)},spin:function(){return this._applyModification(u,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(b,arguments)},complement:function(){return this._applyCombination(h,arguments)},monochromatic:function(){return this._applyCombination(v,arguments)},splitcomplement:function(){return this._applyCombination(g,arguments)},triad:function(){return this._applyCombination(d,arguments)},tetrad:function(){return this._applyCombination(p,arguments)}},T.fromRatio=function(t,e){if("object"==typeof t){var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]="a"===n?t[n]:k(t[n]));t=r}return T(t,e)},T.equals=function(t,e){return!(!t||!e)&&T(t).toRgbString()==T(e).toRgbString()},T.random=function(){return T.fromRatio({r:F(),g:F(),b:F()})},T.mix=function(t,e,r){r=0===r?0:r||50;var n,a=T(t).toRgb(),i=T(e).toRgb(),s=r/100,o=2*s-1,l=i.a-a.a,c=1-(n=((n=o*l==-1?o:(o+l)/(1+o*l))+1)/2),f={r:i.r*n+a.r*c,g:i.g*n+a.g*c,b:i.b*n+a.b*c,a:i.a*s+a.a*(1-s)};return T(f)},T.readability=function(t,e){var r=T(t),n=T(e),a=r.toRgb(),i=n.toRgb(),s=r.getBrightness(),o=n.getBrightness(),l=Math.max(a.r,i.r)-Math.min(a.r,i.r)+Math.max(a.g,i.g)-Math.min(a.g,i.g)+Math.max(a.b,i.b)-Math.min(a.b,i.b);return{brightness:Math.abs(s-o),color:l}},T.isReadable=function(t,e){var r=T.readability(t,e);return r.brightness>125&&r.color>500},T.mostReadable=function(t,e){for(var r=null,n=0,a=!1,i=0;i<e.length;i++){var s=T.readability(t,e[i]),o=s.brightness>125&&s.color>500,l=s.brightness/125*3+s.color/500;(o&&!a||o&&a&&l>n||!o&&!a&&l>n)&&(a=o,n=l,r=T(e[i]))}return r};var O=T.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},q=T.hexNames=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}(O),N=function(){var t="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",e="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{rgb:new RegExp("rgb"+e),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+e),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+e),hsva:new RegExp("hsva"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=T}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})});

},{"jquery":331}],15:[function(require,module,exports){
var ATRange=require("../utils/ATRange"),ATDateStringMatchResult=function(e){this.validDate=!1,this.matchFound=!1,this.text="",this.cleanText="",this.errorRanges=[],this.date=e,this.selection=new ATRange(-1,0),this.updatedCursorPosition=0,this.eraRange=new ATRange(-1,0),this.hourRange=new ATRange(-1,0),this.minuteRange=new ATRange(-1,0),this.secondRange=new ATRange(-1,0),this.amPmRange=new ATRange(-1,0),this.midnightRange=new ATRange(-1,0),this.monthRange=new ATRange(-1,0),this.dayRange=new ATRange(-1,0),this.yearRange=new ATRange(-1,0),this.weekdayRange=new ATRange(-1,0),this.negationRange=new ATRange(-1,0),this.weekRange=new ATRange(-1,0),this.floatingDayRange=new ATRange(-1,0)};module.exports=ATDateStringMatchResult;

},{"../utils/ATRange":47}],16:[function(require,module,exports){
var MakeTimelineDisplayConstants=function(){this.pixelsToRemScale=.1,this.toolbarHeight=62,this.laneMarginWidth=20,this.normalLifetimeHeight=24,this.lifetimeHeight=24,this.collapsedLaneHeight=this.lifetimeHeight,this.minimumExpandedLaneHeight=3*this.collapsedLaneHeight,this.timeHeaderHeight=53,this.normalTimeHeaderHeight=53,this.iPhoneTimeHeaderHeight=30,this.contextHeight=33,this.bookmarksHeight=22,this.navFooterHeight=this.contextHeight+this.bookmarksHeight,this.filterBarHeight=46,this.eventDateTextHeight=19,this.minEventWidthToDropText=100,this.animatedExpansionParentWidth=250,this.maxParentWidthBeforeAutoCollapse=50,this.longEventMinWidth=750,this.eventBoxBorder=0,this.eventBoxPaddingLeft=7,this.eventBoxPaddingRight=0,this.eventBoxPaddingTop=4,this.eventBoxPaddingBottom=4,this.eventIosSelectionCheckboxWidth=35,this.eventMarkerCornerRadiusIos=7,this.eventMarkerCornerRadius=5,this.eventMarkerSvgNormalExtraWidth=3,this.eventMarkerSvgNormalExtraHeight=3,this.eventMarkerSvgParentExtraWidth=13,this.eventMarkerSvgParentExtraHeight=13,this.eventMarkerMarginRight=4,this.eventMarkerMarginTop=3,this.eventMarkerMarginBottom=2,this.eventMarkerShowMoreMarginLeft=10,this.eventMarkerShowMoreWidth=15,this.eventMarkerShowMoreHeight=18,this.eventParentExpandWidth=9,this.eventParentExpandHeight=10,this.eventParentExpandSpanOffsetFromRight=15,this.eventParentExpandSpanOffsetFromRightIos=5,this.eventParentArrowWidthIos=24,this.eventParentArrowOffsetForExpandedParentIos=36,this.eventTextWrapSafetyBuffer=8,this.eventMarkerOffsetFromBoundsTop=this.eventBoxBorder+this.eventBoxPaddingTop+this.eventMarkerMarginTop,this.eventMarkerOffsetFromBoundsLeft=this.eventBoxBorder+this.eventBoxPaddingLeft,this.eventBoxUnderneathWidthAdjust=this.eventBoxBorder+0+this.eventBoxPaddingRight+this.eventBoxBorder,this.eventBoxUnderneathHeightAdjust=this.eventBoxBorder+this.eventMarkerMarginTop+0+this.eventMarkerMarginBottom+0+this.eventBoxBorder,this.eventBoxSideBySideWidthAdjust=this.eventBoxBorder+0+this.eventMarkerMarginRight+0+this.eventMarkerShowMoreMarginLeft+this.eventMarkerShowMoreWidth+this.eventBoxPaddingRight+this.eventBoxBorder,this.eventBoxSideBySideHeightAdjust=this.eventBoxBorder+0+this.eventBoxBorder,this.eventOffsetFromTopOfLane=this.lifetimeHeight+4,this.eventOffsetFromTopOfCollapsedLane=this.collapsedLaneHeight/2-this.eventMarkerCornerRadius-this.eventMarkerOffsetFromBoundsTop,this.eventXOffsetFromPreviousEvent=2*this.eventBoxPaddingLeft+this.eventIosSelectionCheckboxWidth,this.eventYOffsetFromPreviousEvent=12,this.eventYOffsetFromPreviousParentEvent=12,this.eventYOffsetFromOwnParentEvent=12,this.eventChildRectPaddingLeft=10,this.eventChildRectPaddingRight=5,this.eventChildRectPaddingBottom=10,this.eventOptimiseFurthestOffscreen=-1e3,this.eventOptimiseMaxPolygonWidth=1e4,this.dependencyHookRadius=10,this.mainTickLineHeight=25,this.mainTickTextOffsetY=20,this.subTickCircleOffsetY=this.timeHeaderHeight-7,this.subTickCircleRadius=1.5,this.subTickTextOffsetY=this.timeHeaderHeight-14,this.laneLabelOffsetX=25,this.lifetimeLabelOffsetX=5,this.lifetimeLeftMargin=120,this.lifetimeLeftMarginToText=10,this.lifetimeLabelMinGap=42,this.contextBarEventRectHeight=18,this.contextBarLabelRectHeight=this.contextHeight-this.contextBarEventRectHeight,this.contextLensImageHeight=this.contextHeight,this.contextLensImageArrowWidth=Math.round(30*this.contextHeight/79),this.contextLensImageMiddleWidth=Math.round(234*this.contextHeight/79),this.contextLensRootFolder="skins/",this.contextLensImageLeftArrowHref="lens-left-arrow.png",this.contextLensImageRightArrowHref="lens-right-arrow.png",this.contextLensImageMiddleHref="lens-middle.png",this.contextDotRadius=5,this.contextDotOffsetY=5,this.contextBarLabelOffsetX=4,this.contextBarLabelOffsetY=28,this.contextLensResizeGrabWidth=10,this.contextLensDragMinGap=2*this.contextLensImageArrowWidth,this.laneNavNodeWidth=10,this.scrollTrackThickness=16,this.scrollTrackTopMargin=1,this.scrollTrackNoLaneNavThickness=16,this.scrollTrackDefaultThickness=28,this.scrollKnobThickness=10,this.scrollKnobXPosition=0,this.scrollKnobDefaultXPosition=3,this.scrollKnobNoLaneNavXPosition=14,this.scrollKnobOpacity=.6,this.scrollKnobFadeOpacity=.6,this.scrollTrackOpacity=1,this.bookmarksBarHeight=22,this.bookmarksRectHeight=18,this.bookmarksRectOffsetY=2,this.relationshipViewEventVerticalPadding=10,this.relationshipViewParentIndent=15,this.relationshipViewEventAreaWidth=520+3*this.relationshipViewParentIndent,this.relationshipViewGroupHeaderHeight=23,this.relationshipViewEntityHeaderHeight=120,this.relationshipViewEntityColumnSpacing=40,this.relationshipViewEntityGroupSpacing=160,this.relationshipViewDateOffsetLeft=5,this.relationshipViewDateOffsetDefaultWidth=80,this.relationshipViewDateOffsetHideWidth=10,this.relationshipViewDateOffsetWidth=this.relationshipViewDateOffsetDefaultWidth,this.relationshipViewEventDotWidth=16,this.relationshipViewEventTextXOffset=this.relationshipViewEventDotWidth+10,this.relationshipViewVerticalSpacing=10,this.relationshipViewDateOffsetLineX=this.relationshipViewDateOffsetWidth-5,this.relationshipViewDateEventLeftLineXOffset=8,this.relationshipViewDateEventLeftLineWidth=this.eventBoxPaddingLeft+5,this.relationshipViewDateEventLeftLineWidthFlattenedTree=12,this.relationshipViewDateEventLeftLineWidthNoChildren=30,this.relationshipViewDateEventLeftLineWidthParent=16,this.relationshipViewDateEventLeftLineWidthLastChildAddition=15,this.relationshipViewDateOffsetLineOffsetFromNodeTop=this.relationshipViewEventVerticalPadding+this.relationshipViewEventDotWidth/2+1,this.relationshipViewEntityOffsetFromLeft=this.relationshipViewEventAreaWidth+this.relationshipViewDateOffsetWidth,this.relationshipNavFooterHeight=this.contextHeight+this.scrollTrackNoLaneNavThickness,this.relationshipViewIosNarrowEventWidth=308,this.relationshipViewIosNarrowEditModeEventWidth=356,this.relationshipViewIosExpandedEventWidth=462,this.relationshipViewIosExpandedEditModeEventWidth=510,this.relationshipViewIosEntityColGroupRightPadding=100,this.relationshipViewIosEmptyColumnStateWidth=200,this.relationshipViewIosOverscrollHeight=0,this.snapDragMinDist=5,this.snapDragLineLength=100,this.contextLensWidth=120,this.contextLensMinMargin=20,this.minimumParentWidthToShow=400,this.alwaysExpandDurationTS=10,this.touchEventMinimumHoldTimeBeforeMove=300},TimelineDisplayConstants=new MakeTimelineDisplayConstants;module.exports=TimelineDisplayConstants;

},{}],17:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),d3=require("d3"),utf8=require("utf8"),TimelineDisplayConstants=require("./ATDisplayConstants"),ATViewMode=require("../view/ATViewMode"),ATTimeUnit=require("../model/ATTimeUnit"),ATEmptyGuidString=require("../model/ATEmptyGuidString"),ATAddEntityView=require("../view/desktop/ATAddEntityView"),ATAddEventView=require("../view/desktop/ATAddEventView"),ATEmbedInNewParentView=require("../view/desktop/ATEmbedInNewParentView"),ATManageEntitiesView=require("../view/desktop/ATManageEntitiesView"),ATEditTemplateView=require("../view/desktop/ATEditTemplateView"),ATEditCalendarView=require("../view/desktop/ATEditCalendarView"),ATDisplaySettingsView=require("../view/desktop/ATDisplaySettingsView"),ATTagManagerView=require("../view/desktop/ATTagManagerView"),ATNewParentView=require("../view/desktop/ATNewParentView"),ATEnterNameView=require("../view/desktop/ATEnterNameView"),ATEnterDateView=require("../view/desktop/ATEnterDateView"),ATEnterDurationView=require("../view/desktop/ATEnterDurationView"),ATSyncSettingsView=require("../view/desktop/ATSyncSettingsView"),ATSyncManagerView=require("../view/desktop/ATSyncManagerView"),ATExportCSVView=require("../view/desktop/ATExportCSVView"),ATImportCsvView=require("../view/desktop/ATImportCsvView"),ATExportImageView=require("../view/desktop/ATExportImageView"),ATPrintView=require("../view/desktop/ATPrintView"),ATFindReplaceView=require("../view/desktop/ATFindReplaceView"),ATOnboardingView=require("../view/desktop/ATOnboardingView"),ATNotificationManager=require("../view/ios/ATNotificationManager"),ATExpressSettingsView=require("../view/desktop/ATExpressSettingsView"),ATExpressManageRowsView=require("../view/desktop/ATExpressManageRowsView"),ATScreenMode=require("../view/ios/ATScreenMode"),ATToolbar=require("../view/desktop/ATToolbar"),ATPoint=require("../utils/ATPoint"),ATSize=require("../utils/ATSize"),ATBounds=require("../utils/ATBounds"),ATUtilities=require("../utils/ATUtilities"),ATMainTimelineApp=function(e,i,t,n){"windows"===e?this.setForWindows():"mac"===e?this.setForMac():"iPad"===e?this.setForIpad():"iPhone"===e?this.setForIphone():this.setForMac(),this.isExpressMode=n,this.timeline=i.timeline,this.inspectorModel=i.inspectorModel,this.timelineViewModel=i.timelineViewModel,this.canvasManager=t,this.relationshipView=t.relationshipView,this.timelineView=t.timelineView,this.inspectorView=t.inspectorView,this.filterBarView=t.filterBarView,this.syncBinderView=t.syncBinderView,this.firstDataLoad=!0,this.titleEditDiv=null,this.draggingEvent=!1,this.eventDragStartPos=null,this.eventDragEndPos=null,this.displaySettings=null,this.modalStack=[],this.iosModalCount=0,d3.select("body").classed("welcomeScreen",!1).classed("loaded",!1).classed("mainApp",!0),this.switchToTimelineView(),this.inspectorD3=d3.select("#inspector"),this.mainCanvasD3=d3.select("#mainTimelineCanvas"),this.syncBinderD3=d3.select("#syncBinder"),this.$bounds=$("#bounds"),this.bindKeyEvents()};ATMainTimelineApp.prototype.bindKeyEvents=function(){Mousetrap.bind("home",this.homeKeyPressed.bind(this)),Mousetrap.bind("end",this.endKeyPressed.bind(this)),Mousetrap.bind("pageup",this.pageUpKeyPressed.bind(this)),Mousetrap.bind("pagedown",this.pageDownKeyPressed.bind(this))},ATMainTimelineApp.prototype.scrollToTopOnNextUpdate=function(){this._scrollToTopOnNextUpdate=!0},ATMainTimelineApp.prototype.setUndoRedoState=function(e,i){this.canvasManager.setUndoRedoState(e,i)},ATMainTimelineApp.prototype.loadNewData=function(e){var i,t=this,n=utf8.decode(atob(e)),o=JSON.parse(n),a=0;this.timelineView.holdRendering(),o.displayTemplate&&(this.displaySettings=o.displayTemplate,this.isIos&&this.displaySettings.skin.indexOf("ios")<0&&(this.displaySettings.skin="ios_blue"),this.timelineView.setDisplayTemplateSettings(o.displayTemplate),this.inspectorView.resize()),this.timeline.update(o),this.firstDataLoad&&(a=this.timelineViewModel.contentXAverage,i=0,o.unitScale&&this.timelineViewModel.set("unitScale",o.unitScale),isNaN(o.startPixel)||(a=o.startPixel),o.positiveOnly&&(this.timelineView.rangeX=new ATBounds(-TimelineDisplayConstants.laneMarginWidth,Number.MAX_VALUE))),(o.calendar||o.timelineType)&&this.inspectorView.setRangeConversion(this.timeline.rangeConversion),(o.expandedParents.length||o.showMoreNodes.length)&&(this.timelineView.calculateIfRequired(),o.expandedParents&&_.each(o.expandedParents,function(e){t.timelineView.setShowChildNodes(e.nodeId,e.laneId)}),o.showMoreNodes&&_.each(o.showMoreNodes,function(e){t.timelineView.setShowMoreEventInfo(e.nodeId,e.laneId)})),this.timelineView.renderFlags.data=!0,this.timelineView.renderFlags.calculate=!0,this.timelineView.renderIfRequired(),this.firstDataLoad&&(this.timelineView.scrollTopLeftToPoint(a,i),this.timelineView.animateContextBarReturn(0,0)),(o.minUnitScale||o.maxUnitScale)&&(this.timelineView.timelinePainter.defaultTransitionDuration>0?(this.timelineViewModel.get("unitScale")<o.minUnitScale?this.timelineView.animatedZoomToUnitScale(o.minUnitScale,1e3):this.timelineViewModel.get("unitScale")>o.maxUnitScale&&this.timelineView.animatedZoomToUnitScale(o.maxUnitScale,1e3),o.minUnitScale&&window.setTimeout(function(){t.timelineView.minimumUnitScale=o.minUnitScale},1100),o.maxUnitScale&&window.setTimeout(function(){t.timelineView.maximumUnitScale=o.maxUnitScale},1100)):(this.timelineViewModel.get("unitScale")<o.minUnitScale?this.timelineView.zoomToScale(o.minUnitScale):this.timelineViewModel.get("unitScale")>o.maxUnitScale&&this.timelineView.zoomToScale(o.maxUnitScale),o.minUnitScale&&(t.timelineView.minimumUnitScale=o.minUnitScale),o.maxUnitScale&&(t.timelineView.maximumUnitScale=o.maxUnitScale)),window.appToolbar&&(window.appToolbar.setSliderPositionRange(o.minUnitScale,o.maxUnitScale),this.unitScaleChanged())),this.firstDataLoad&&(this.timelineView.releaseRendering(),this.firstDataLoad=!1,window.setTimeout(function(){d3.select("body").classed("loaded",!0)},0)),this.timelineView.releaseRendering(),o.selectedEvents&&(this.timeline.selectEventsWithIDs(o.selectedEvents),this.timelineView.calculateIfRequired(),o.selectedEvents.length>0&&this.timelineView.scrollToEventsIfOffScreen(o.selectedEvents)),this._scrollToTopOnNextUpdate&&(this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?this.timelineView.scrollTopToPoint(0):this.relationshipView.scrollTopToPoint(0),this.sendAllDimensionsToAppInterface()),this._scrollToTopOnNextUpdate=!1},ATMainTimelineApp.prototype.setInspectorTemplate=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i),n=[],o=[],a=[],s=1;this.inspectorModel.set({template:t}),window.appToolbar&&(o.push({identifier:"laneNone",text:"None",shortcut:"Ctrl+0"}),o.push({identifier:"-"}),_.each(t.types,function(e){var i=e.name,t=e.typeId;o.push({identifier:"lane"+i,text:"Group by "+i,shortcut:"Ctrl+"+s}),n.push({identifier:"addEntity"+t,text:"Add "+i}),a.push({identifier:"addEntity"+t,text:"Add "+i}),s++}),window.appToolbar.updateOptionsForIdentifier("addEntity",n),window.appToolbar.updateOptionsForIdentifier("lane",o),window.appToolbar.updateOptionsForIdentifier("addEntityMenu",a))},ATMainTimelineApp.prototype.setRecentFiles=function(e){if(window.appToolbar){var i=utf8.decode(atob(e)),t=JSON.parse(i),n=[],o=0;_.each(t,function(e){n.push({identifier:"openRecent_"+o,text:e.name}),o++}),window.appToolbar.updateOptionsForIdentifier("openRecent",n)}},ATMainTimelineApp.prototype.switchToTimelineView=function(){this.timelineView.holdRendering(),this.timelineView.setViewMode(ATViewMode.TIMELINE_VIEW),this.relationshipView.toggleView(!1),this.firstDataLoad||(this.timelineView.resizeWindow(),this.timelineView.calculateIfRequired(),this.timelineView.scrollToEventsIfOffScreen(this.timeline.selectedEvents)),this.timelineView.releaseRendering(),this.canvasManager.setIsRelationshipView(!1),window.appToolbar&&(this.setToolbarItemState("timelineView",!0),this.setToolbarItemState("relationshipView",!1),this.enableToolbarItem("zoom"),this.enableToolbarItem("zoomIn"),this.enableToolbarItem("zoomOut")),this.firstDataLoad||this.sendAllDimensionsToAppInterface()},ATMainTimelineApp.prototype.switchToRelationshipView=function(){this.timelineView.holdRendering(),this.timelineView.setViewMode(ATViewMode.RELATIONSHIP_VIEW),this.relationshipView.toggleView(!0),this.firstDataLoad||(this.timelineView.calculateIfRequired(),this.relationshipView.scrollToEventsIfOffScreen(this.timeline.selectedEvents)),this.timelineView.releaseRendering(),this.canvasManager.setIsRelationshipView(!0),window.appToolbar&&(this.setToolbarItemState("timelineView",!1),this.setToolbarItemState("relationshipView",!0),this.disableToolbarItem("zoom"),this.disableToolbarItem("zoomIn"),this.disableToolbarItem("zoomOut")),this.firstDataLoad||this.sendAllDimensionsToAppInterface()},ATMainTimelineApp.prototype.expandSideBar=function(){this.canvasManager.expandSideBar()},ATMainTimelineApp.prototype.collapseSideBar=function(){this.canvasManager.collapseSideBar()},ATMainTimelineApp.prototype.expandRelationshipEventColumn=function(){this.relationshipView.toggleExpandedColumnsClick(!0)},ATMainTimelineApp.prototype.collapseRelationshipEventColumn=function(){this.relationshipView.toggleExpandedColumnsClick(!1)},ATMainTimelineApp.prototype.setRelationshipViewTreeFlattened=function(e){this.relationshipView.setTreeFlattened(e)},ATMainTimelineApp.prototype.setRelationshipViewShowOffsets=function(e){this.relationshipView.setShowOffsets(e)},ATMainTimelineApp.prototype.mouseWheelWorkaround=function(e,i,t,n,o){this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.mouseWheelWorkaround(e,i,t,n,o):this.relationshipView.mouseWheelWorkaround(e,i,t,n,o)},ATMainTimelineApp.prototype.setInspectorData=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.inspectorModel.set({eventData:t})},ATMainTimelineApp.prototype.setInspectorEntities=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.inspectorModel.set({entitiesByType:t})},ATMainTimelineApp.prototype.setInspectorTags=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.inspectorModel.set({tags:t})},ATMainTimelineApp.prototype.removeExistingModal=function(){this.modalStack.length>0&&this.modalStack[this.modalStack.length-1].modal("hide")},ATMainTimelineApp.prototype.modalClosed=function(e){this.modalStack=_.without(this.modalStack,e),0==this.modalStack.length&&window.ApplicationInterface&&window.ApplicationInterface.lastModalClosed(window.timelineDocumentId)},ATMainTimelineApp.prototype.showModal=function(e,i){var t=this;window.isAeonWebExport||(i||this.removeExistingModal(),this.modalStack.push(e),e.on("hidden.bs.modal",function(){t.modalClosed(e)}),e.modal("show"),window.ApplicationInterface&&window.ApplicationInterface.modalOpened(window.timelineDocumentId))},ATMainTimelineApp.prototype.signalPopoverOpened=function(){window.ApplicationInterface&&window.ApplicationInterface.modalOpened(window.timelineDocumentId)},ATMainTimelineApp.prototype.signalPopoverClosed=function(){window.ApplicationInterface&&window.ApplicationInterface.lastModalClosed(window.timelineDocumentId)},ATMainTimelineApp.prototype.showNewParentPromptIfNeeded=function(e,i){var t=this.timeline.get("events").findChild(e);!t||t.children.length>0?i(!1):(this.newParentModal||(this.newParentModal=$("#newParentModal"),$("#newParentModal").modal({show:!1,backdrop:"static"}),this.newParentView=new ATNewParentView({el:"#newParentModal"})),this.newParentView.setCallback(i),this.newParentView.setParentEventTitle(t.get("title")),this.showModal(this.newParentModal,!0))},ATMainTimelineApp.prototype.showAddEventModal=function(e,i,t){var n=e,o=t,a=i;this.addEventModal||(this.addEventModal=$("#addEventModal"),$("#addEventModal").modal({show:!1,backdrop:"static"}),this.addEventView=new ATAddEventView({el:"#addEventModal",model:this.inspectorModel})),this.addEventView.setRangeConversion(this.timeline.rangeConversion),this.showModal(this.addEventModal),n||(n=this.timeline.rangeConversion.calendar?this.timeline.rangeConversion.calendar.dateWithTimestamp(this.defaultTimestamp(),ATTimeUnit.SECOND):this.defaultTimestamp()),o||(o=ATEmptyGuidString),a||(a=ATEmptyGuidString),this.addEventView.resetForm(n,o,a)},ATMainTimelineApp.prototype.defaultTimestamp=function(){return this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?this.timelineView.centerTimestamp():this.relationshipView.topTimestamp()},ATMainTimelineApp.prototype.defaultRangeString=function(){var e=this.defaultTimestamp();return this.timeline.rangeConversion.naturalStringFromValue(e,!1)},ATMainTimelineApp.prototype.showFindReplaceModal=function(){this.findReplaceModal||(this.findReplaceModal=$("#findReplaceModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.findReplaceView=new ATFindReplaceView({el:"#findReplaceModal"})),this.showModal(this.findReplaceModal),this.findReplaceView.resetForm()},ATMainTimelineApp.prototype.showEmbedInNewParentModal=function(e){this.embedInNewParentModal||(this.embedInNewParentModal=$("#embedInNewParentModal"),$("#embedInNewParentModal").modal({show:!1,backdrop:"static"}),this.embedInNewParentView=new ATEmbedInNewParentView({el:"#embedInNewParentModal",model:this.inspectorModel})),this.showModal(this.embedInNewParentModal),e||(e=ATEmptyGuidString),this.embedInNewParentView.resetForm(e)},ATMainTimelineApp.prototype.showOnboardingModal=function(e){this.onboardingModal||(this.onboardingModal=$("#onboardingModal"),$("#onboardingModal").modal({show:!1,backdrop:"static"}),this.onboardingView=new ATOnboardingView({el:"#onboardingModal"})),this.onboardingView.configureForCategory(e),this.showModal(this.onboardingModal)},ATMainTimelineApp.prototype.showAddEntityModal=function(e){var i=this;this.addEntityModal||(this.addEntityModal=$("#addEntityModal"),$("#addEntityModal").modal({show:!1,backdrop:"static"}),this.addEntityView=new ATAddEntityView({el:"#addEntityModal",model:this.inspectorModel})),this.addEntityView.setTypeId(e),this.addEntityView.setRangeConversion(this.timeline.rangeConversion),this.addEntityView.setValidatorFunction(function(e){var t=!1;return!!e.length&&(i.timeline.get("entities").each(function(i){i.get("name")==e&&(t=!0)}),_.each(["Event","Entity","Tag","Color","Parent","Link","Any","All","Timeline"],function(i){i==e&&(t=!0)}),!t)}),this.addEntityView.setWindowTitle("Add Entity"),this.addEntityView.setWindowBelowMessage("NOTE: Entity names must be unique (e.g. Arcs and Characters cannot share a name)."),this.showModal(this.addEntityModal),this.addEntityView.resetForm()},ATMainTimelineApp.prototype.showExpressManageRowsModal=function(){this.manageRowsModal||(this.manageRowsModal=$("#manageEntitiesModal"),$("#manageEntitiesModal").modal({show:!1,backdrop:"static"}),this.manageRowsView=new ATExpressManageRowsView({el:"#manageEntitiesModal",model:this.inspectorModel})),this.manageRowsView.updateRows(),this.showModal(this.manageRowsModal)},ATMainTimelineApp.prototype.showManageEntitiesModal=function(){var e=this;this.manageEntitiesModal||(this.manageEntitiesModal=$("#manageEntitiesModal"),$("#manageEntitiesModal").modal({show:!1,backdrop:"static"}),this.manageEntitiesView=new ATManageEntitiesView({el:"#manageEntitiesModal",model:this.inspectorModel})),this.manageEntitiesView.setRangeConversion(this.timeline.rangeConversion),this.manageEntitiesView.updateDetailFields(),this.showModal(this.manageEntitiesModal),window.setTimeout(function(){e.manageEntitiesView.immediateUpdateExpandedGroupHeight()},250)},ATMainTimelineApp.prototype.showEditTemplateModal=function(){this.editTemplateModal||(this.editTemplateModal=$("#editTemplateModal"),$("#editTemplateModal").modal({show:!1,backdrop:"static"}),this.editTemplateView=new ATEditTemplateView({el:"#editTemplateModal",model:this.inspectorModel})),this.editTemplateView.grabInitialTemplate(),this.editTemplateView.setAllowEditCalendar(0==this.timeline.get("events").length&&0==this.timeline.get("entities").length),this.showModal(this.editTemplateModal)},ATMainTimelineApp.prototype.showEditCalendarModal=function(e,i){this.editCalendarModal||(this.editCalendarModal=$("#editCalendarModal"),$("#editCalendarModal").modal({show:!1,backdrop:"static"}),this.editCalendarView=new ATEditCalendarView({el:"#editCalendarModal",model:e})),this.editCalendarView.model=e,this.editCalendarView.grabInitialCalendar(),this.editCalendarView.setCompletionCallback(i),this.showModal(this.editCalendarModal,!0)},ATMainTimelineApp.prototype.showDisplaySettingsModal=function(){this.displaySettingsModal||(this.displaySettingsModal=$("#displaySettingsModal"),$("#displaySettingsModal").modal({show:!1,backdrop:"static"}),this.displaySettingsView=new ATDisplaySettingsView({el:"#displaySettingsModal",model:this.inspectorModel})),this.displaySettingsView.setDisplayTemplateSettings(this.displaySettings),this.showModal(this.displaySettingsModal)},ATMainTimelineApp.prototype.showExpressSettingsModal=function(){this.displaySettingsModal||(this.displaySettingsModal=$("#displaySettingsModal"),$("#displaySettingsModal").modal({show:!1,backdrop:"static"}),this.expressSettingsView=new ATExpressSettingsView({el:"#displaySettingsModal",model:this.inspectorModel})),this.expressSettingsView.setDisplaySettings(this.displaySettings),this.showModal(this.displaySettingsModal)},ATMainTimelineApp.prototype.showTagManagerModal=function(e){var i=utf8.decode(atob(e));this.tagManagerModal||(this.tagManagerModal=$("#tagManagerModal"),$("#tagManagerModal").modal({show:!1,backdrop:"static"}),this.tagManagerView=new ATTagManagerView({el:"#tagManagerModal",model:this.inspectorModel})),this.tagManagerView.setTags(JSON.parse(i)),this.showModal(this.tagManagerModal)},ATMainTimelineApp.prototype.showSyncSettingsModal=function(e){var i=utf8.decode(atob(e));this.syncSettingsModal||(this.syncSettingsModal=$("#syncSettingsModal"),$("#syncSettingsModal").modal({show:!1,backdrop:"static"}),this.syncSettingsView=new ATSyncSettingsView({el:"#syncSettingsModal",model:this.inspectorModel})),this.syncSettingsView.setScrivenerFields(JSON.parse(i)),this.showModal(this.syncSettingsModal)},ATMainTimelineApp.prototype.showSyncItemStatusModal=function(e){var i=utf8.decode(atob(e));this.syncBinderView&&this.syncBinderView.showItemStatusPopover(JSON.parse(i))},ATMainTimelineApp.prototype.setSyncBinderIsLoading=function(){this.syncBinderView&&this.syncBinderView.setSyncBinderIsLoading(!0)},ATMainTimelineApp.prototype.showSyncManagerModal=function(e){var i=utf8.decode(atob(e));this.syncManagerModal||(this.syncManagerModal=$("#syncManagerModal"),$("#syncManagerModal").modal({show:!1,backdrop:"static"}),this.syncManagerView=new ATSyncManagerView({el:"#syncManagerModal"})),this.syncManagerView.setProjects(JSON.parse(i)),this.showModal(this.syncManagerModal)},ATMainTimelineApp.prototype.updateSyncManagerModal=function(e){var i=utf8.decode(atob(e));this.syncManagerModal&&this.syncManagerView.setProjects(JSON.parse(i))},ATMainTimelineApp.prototype.showAddBookmarkModal=function(){var e=this;this.enterNameModal||(this.enterNameModal=$("#enterNameModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.enterNameView=new ATEnterNameView({el:"#enterNameModal"})),this.enterNameView.setCallback(function(i){if(window.ApplicationInterface){var t=e.timelineView.model.get("unitScale");if(window.ApplicationInterface)if(e.timelineView.viewMode==ATViewMode.TIMELINE_VIEW)window.ApplicationInterface.addBookmark(window.timelineDocumentId,i,e.timelineView.viewport.centerX()*t,t);else{var n=e.relationshipView.fakeCenterTsForBookmark();isNaN(n)||window.ApplicationInterface.addBookmark(window.timelineDocumentId,i,n,t)}}}),this.enterNameView.setWindowTitle("Add Bookmark"),this.enterNameView.setWindowAboveMessage(""),this.enterNameView.setWindowBelowMessage(""),this.showModal(this.enterNameModal),this.enterNameView.resetForm()},ATMainTimelineApp.prototype.showSaveFilterModal=function(){this.enterNameModal||(this.enterNameModal=$("#enterNameModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.enterNameView=new ATEnterNameView({el:"#enterNameModal"})),this.enterNameView.setCallback(function(e){window.ApplicationInterface&&window.ApplicationInterface.saveFilterWithName(window.timelineDocumentId,e)}),this.enterNameView.setWindowTitle("Save Filter As..."),this.enterNameView.setWindowAboveMessage(""),this.enterNameView.setWindowBelowMessage(""),this.showModal(this.enterNameModal),this.enterNameView.resetForm()},ATMainTimelineApp.prototype.showSaveCustomTemplateModal=function(e){this.enterNameModal||(this.enterNameModal=$("#enterNameModal"),$("#enterNameModal").modal({show:!1,backdrop:"static"}),this.enterNameView=new ATEnterNameView({el:"#enterNameModal"})),this.enterNameView.setCallback(e),this.enterNameView.setWindowTitle("Save As Custom Template"),this.enterNameView.setWindowAboveMessage(""),this.enterNameView.setWindowBelowMessage("Note: Your current event display layout will be saved with the template."),this.showModal(this.enterNameModal,!0),this.enterNameView.resetForm()},ATMainTimelineApp.prototype.showZeroDateModal=function(e,i,t,n,o,a,s){this.enterDateModal||(this.enterDateModal=$("#enterDateModal"),$("#enterDateModal").modal({show:!1,backdrop:"static"}),this.enterDateView=new ATEnterDateView({el:"#enterDateModal"})),this.enterDateView.setRangeConversion(t),this.enterDateView.setCallback(e),this.enterDateView.setValidatorFunction(i),this.enterDateView.setWindowTitle("Change Calendar Type"),this.enterDateView.setWindowAboveMessage(a),this.enterDateView.setWindowBelowMessage(s),this.showModal(this.enterDateModal,!0),this.enterDateView.setTimestamp(n,o),this.enterDateView.resetForm()},ATMainTimelineApp.prototype.showShiftEventsModal=function(){this.enterDurationModal||(this.enterDurationModal=$("#enterDurationModal"),$("#enterDurationModal").modal({show:!1,backdrop:"static"}),this.enterDurationView=new ATEnterDurationView({el:"#enterDurationModal"})),this.enterDurationView.setCallback(function(e){window.ApplicationInterface&&window.ApplicationInterface.moveSelectedEventsByDuration(window.timelineDocumentId,e)}),this.enterDurationView.setRangeConversion(this.timeline.rangeConversion),this.enterDurationView.setWindowTitle("Shift Events By..."),this.showModal(this.enterDurationModal,!0),this.enterDurationView.resetForm()},ATMainTimelineApp.prototype.adjustFilterBar=function(e){this.canvasManager.adjustFilterBar(e)},ATMainTimelineApp.prototype.resizeInspector=function(e){this.canvasManager.resizeInspector(e)},ATMainTimelineApp.prototype.disableNonWebElements=function(){this.hideInspector(!1),this.hideFilterBar(!1),this.hideSyncBinder(!1)},ATMainTimelineApp.prototype.showFilterBar=function(e){this.canvasManager.showFilterBar(e),window.appToolbar&&this.setToolbarItemState("filter",!0)},ATMainTimelineApp.prototype.hideFilterBar=function(e){this.canvasManager.hideFilterBar(e),window.appToolbar&&this.setToolbarItemState("filter",!1)},ATMainTimelineApp.prototype.showInspector=function(e){this.canvasManager.showInspector(e),window.appToolbar&&this.setToolbarItemState("inspector",!0)},ATMainTimelineApp.prototype.hideInspector=function(e,i,t){this.canvasManager.hideInspector(e,i,t),window.appToolbar&&this.setToolbarItemState("inspector",!1)},ATMainTimelineApp.prototype.setInspectorWidthWhenOpen=function(e){this.inspectorView.currentWidthWhenOpen=e},ATMainTimelineApp.prototype.zoomIn=function(){window.appToolbar&&window.appToolbar.adjustItemSliderValue("zoom",10)},ATMainTimelineApp.prototype.zoomOut=function(){window.appToolbar&&window.appToolbar.adjustItemSliderValue("zoom",-10)},ATMainTimelineApp.prototype.zoomToFit=function(){this.timelineView.animatedZoomToFit()},ATMainTimelineApp.prototype.resizeSyncBinder=function(e){this.canvasManager.resizeSyncBinder(e)},ATMainTimelineApp.prototype.showSyncBinder=function(e,i,t,n,o){var a=utf8.decode(atob(t));this.syncBinderView.setSyncData(a),n&&this.syncBinderView.setErrorMessage(n,o),this.canvasManager.showSyncBinder(e,i)},ATMainTimelineApp.prototype.hideSyncBinder=function(e){this.canvasManager.hideSyncBinder(e)},ATMainTimelineApp.prototype.updateSyncErrorMessage=function(e,i){this.syncBinderView&&this.syncBinderView.setErrorMessage(e,i)},ATMainTimelineApp.prototype.updateSyncData=function(e){var i=utf8.decode(atob(e));this.syncBinderView&&(this.syncBinderView.setErrorMessage(null,!1),this.syncBinderView.setSyncData(i))},ATMainTimelineApp.prototype.updateSyncRemoteProgress=function(e){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.syncBinderView&&this.syncBinderView.setRemoteProgress(t)},ATMainTimelineApp.prototype.expandSyncItemInBinder=function(e){this.syncBinderView&&this.syncBinderView.expandItemInBinder(e)},ATMainTimelineApp.prototype.collapseSyncItemInBinder=function(e){this.syncBinderView&&this.syncBinderView.collapseItemInBinder(e)},ATMainTimelineApp.prototype.editSyncItemInBinder=function(e){this.syncBinderView&&this.syncBinderView.editItemInBinder(e)},ATMainTimelineApp.prototype.showSyncLinkPopover=function(e){this.syncBinderView&&this.syncBinderView.showLinkEventPopoverForItem(e)},ATMainTimelineApp.prototype.collapseAllLanes=function(){this.timelineView.collapseAllLanes()},ATMainTimelineApp.prototype.expandAllLanes=function(){this.timelineView.expandAllLanes()},ATMainTimelineApp.prototype.setForWindows=function(){d3.select("body").classed("windows",!0).classed("mac",!1).classed("ios",!1),this.isWindows=!0,this.isMac=!1,this.isIos=!1,this.isIpad=!1,this.isIphone=!1},ATMainTimelineApp.prototype.setForMac=function(){d3.select("body").classed("windows",!1).classed("mac",!0).classed("ios",!1),this.isMac=!0,this.isWindows=!1,this.isIos=!1,this.isIpad=!1,this.isIphone=!1},ATMainTimelineApp.prototype.setForIpad=function(){this.setForIos(),this.isIpad=!0,this.isIphone=!1},ATMainTimelineApp.prototype.setForIphone=function(){this.setForIos(),this.isIphone=!0,this.isIpad=!1},ATMainTimelineApp.prototype.setForIos=function(){d3.select("body").classed("windows",!1).classed("mac",!1).classed("ios",!0).classed("ios_blue",!0),this.isIos=!0,this.isWindows=!1,this.isMac=!1},ATMainTimelineApp.prototype.setForExport=function(){this.setForImmediateRender(),d3.select("body").classed("export",!0),this.hideFilterBar(!1),this.hideInspector(!1),this.hideSyncBinder(!1)},ATMainTimelineApp.prototype.setForImmediateRender=function(){this.timelineView.timelinePainter.defaultTransitionDuration=0,this.timelineView.timelinePainter.transitionDuration=0,this.timelineView.isExport=!0,this.timelineView.timelinePainter.isExport=!0},ATMainTimelineApp.prototype.getUnitScale=function(){return this.timelineView.model.get("unitScale")},ATMainTimelineApp.prototype.setUnitScale=function(e){var i=this,t=this.getUnitScale();this.timelineView.holdRendering(),0==this.timelineView.timelinePainter.defaultTransitionDuration?this.timelineView.zoomToScale(e):d3.transition().duration(500).tween("animatedZoom",function(e,t){return function(){var n=d3.interpolateNumber(e,t);return function(e){var t=n(e);i.timelineView.zoomToScale(t)}}}(t,e)),this.timelineView.releaseRendering()},ATMainTimelineApp.prototype.unitScaleChanged=function(){var e=this.timelineView.model.get("unitScale"),i=this;window.appToolbar&&window.appToolbar.setItemSliderValue("zoom",e),window.scaleAppNotifyTimeout&&clearTimeout(window.scaleAppNotifyTimeout),window.scaleAppNotifyTimeout=setTimeout(function(){i.sendUnitScaleToAppInterface(e)},100)},ATMainTimelineApp.prototype.sendUnitScaleToAppInterface=function(e){window.ApplicationInterface&&window.ApplicationInterface.setUnitScale(window.timelineDocumentId,String(e)),this.sendAllDimensionsToAppInterface()},ATMainTimelineApp.prototype.scrollPositionChanged=function(){var e=this.timelineView.viewport.origin.x,i=this.timelineView.viewport.origin.y,t=this;window.scrollAppNotifyTimeout&&clearTimeout(window.scrollAppNotifyTimeout),window.scrollAppNotifyTimeout=setTimeout(function(){t.sendScrollPositionToAppInterface(e,i)},100)},ATMainTimelineApp.prototype.sendScrollPositionToAppInterface=function(e,i){window.ApplicationInterface&&window.ApplicationInterface.setScrollPosition(window.timelineDocumentId,String(e),String(i)),this.sendAllDimensionsToAppInterface()},ATMainTimelineApp.prototype.sendAllDimensionsToAppInterface=function(){var e,i,t,n,o,a=40,s=this.getViewportSizeAsSize();this.isIos&&window.ApplicationInterface&&(this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?(e=this.getScrollPositionAsPoint(),a=40,t=this.getEarliestEventPixel()-a,n=this.getLatestEventPixel()+a,o=this.getTimelineHeight()):this.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE?(t=0,n=(i=this.relationshipView.getScrollableDimensions()).viewWidth,o=i.viewHeight,e={x:i.scrollLeft,y:i.scrollTop}):(e=this.getScrollPositionAsPoint(),t=this.getEarliestEventPixel(),n=this.getLatestEventPixel(),o=this.getTimelineHeight()),window.ApplicationInterface.setScrollDimensions(window.timelineDocumentId,String(t),String(n),String(o),String(s.width),String(s.height),String(e.x),String(e.y)))},ATMainTimelineApp.prototype.getScrollPositionAsPoint=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?new ATPoint(this.timelineView.viewport.origin.x,this.timelineView.viewport.origin.y):new ATPoint(this.relationshipView.viewport.origin.x,this.relationshipView.viewport.origin.y)},ATMainTimelineApp.prototype.getScrollPosition=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.viewport.origin.x+","+this.timelineView.viewport.origin.y:this.relationshipView.viewport.origin.x+","+this.relationshipView.viewport.origin.y},ATMainTimelineApp.prototype.getEarliestEventPixel=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.model.findEarliestEventPixel()-20:this.relationshipView.rangeX.min},ATMainTimelineApp.prototype.getLatestEventPixel=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.model.findLatestEventPixel()+20:this.relationshipView.rangeX.max},ATMainTimelineApp.prototype.getTimelineHeight=function(){var e=this.timelineView.model.lastLane();return e?e.get("top")+e.get("height")+(this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?TimelineDisplayConstants.timeHeaderHeight:TimelineDisplayConstants.relationshipViewEntityHeaderHeight):this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?TimelineDisplayConstants.timeHeaderHeight:TimelineDisplayConstants.relationshipViewEntityHeaderHeight},ATMainTimelineApp.prototype.getTimelineHeightForExport=function(){return this.getTimelineHeight()+TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.contextHeight+TimelineDisplayConstants.bookmarksBarHeight},ATMainTimelineApp.prototype.reportExportSetupCompletion=function(){var e=this.getTimelineHeight()*this.timelineView.physicalScaleFactor;window.ApplicationInterface&&window.ApplicationInterface.exportSetupComplete(this.timelineDocumentId,e)},ATMainTimelineApp.prototype.getPhysicalScaleFactor=function(){return this.timelineView.physicalScaleFactor},ATMainTimelineApp.prototype.pixelForTimestamp=function(e){return e/this.timelineView.model.get("unitScale")},ATMainTimelineApp.prototype.setScrollPosition=function(e,i){var t=window.mainApp.isIos;this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?this.timelineView.scrollTopLeftToPoint(e,i,t):this.relationshipView.scrollTopLeftToPoint(e,i)},ATMainTimelineApp.prototype.assumeAllEventsAreOpen=function(){return this.timelineView.viewMode===ATViewMode.RELATIONSHIP_VIEW&&this.timelineViewModel.relationshipViewFlattenTree},ATMainTimelineApp.prototype.sortFunctionForEventNodes=function(){return this.timelineView.viewMode===ATViewMode.RELATIONSHIP_VIEW&&this.timelineViewModel.relationshipViewFlattenTree?function(e,i){return e.get("relationshipTotalRect").origin.y-i.get("relationshipTotalRect").origin.y}:function(e,i){var t=e.get("event").get("displayId"),n=i.get("event").get("displayId");return ATUtilities.versionNumberCompare(t,n)}},ATMainTimelineApp.prototype.sortFunctionForEvents=function(){return this.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW&&this.timelineViewModel.relationshipViewFlattenTree?null:function(e,i){var t=e.get("displayId"),n=i.get("displayId");return ATUtilities.versionNumberCompare(t,n)}},ATMainTimelineApp.prototype.selectAll=function(){this.timelineView.model.selectAll(this.assumeAllEventsAreOpen())},ATMainTimelineApp.prototype.selectNone=function(){this.timeline.clearSelection()},ATMainTimelineApp.prototype.selectAllBefore=function(){this.timelineView.model.selectAllBefore(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes())},ATMainTimelineApp.prototype.selectAllAfter=function(){this.timelineView.model.selectAllAfter(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes())},ATMainTimelineApp.prototype.findFirst=function(e){this.timelineView.findFirst(e,this.sortFunctionForEvents())},ATMainTimelineApp.prototype.scrollToTimestamp=function(e){this.timelineView.scrollToTimestamp(e)},ATMainTimelineApp.prototype.selectNextEvent=function(){var e=this.timelineView.model.selectNextEvent(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes());e&&this.timelineView.scrollToNodeIfOffScreen(e)},ATMainTimelineApp.prototype.selectPreviousEvent=function(){var e=this.timelineView.model.selectPreviousEvent(this.assumeAllEventsAreOpen(),this.sortFunctionForEventNodes());e&&this.timelineView.scrollToNodeIfOffScreen(e)},ATMainTimelineApp.prototype.applySearchResult=function(e,i,t){var n,o,a=i?e:utf8.decode(atob(e)),s=a?JSON.parse(a):{};this.relationshipView.relationshipPainter.setHighlightString(s.highlightString),this.timelineView.timelinePainter.setHighlightString(s.highlightString),window.appToolbar&&window.appToolbar.markErrorTextItem("search",t),s.selectEventId!=ATEmptyGuidString?(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(s.selectEventId),(n=this.timelineView.model.findNodeForEventId(s.selectEventId))&&((o=n.get("lane")).get("collapsed")&&this.timelineView.toggleLane(o.id),this.timelineView.revealChildNode(s.selectEventId))):s.scrollPosition&&this.timelineView.scrollToTimestamp(s.scrollPosition)},ATMainTimelineApp.prototype.getViewportSizeAsSize=function(){return this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?new ATSize(this.timelineView.viewport.size.width,this.timelineView.viewport.size.height):new ATSize(this.relationshipView.viewport.size.width,this.relationshipView.viewport.size.height)},ATMainTimelineApp.prototype.getViewportSizeAsSizeForExport=function(){return this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?new ATSize(this.timelineView.viewport.size.width,this.timelineView.viewport.size.height+TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.contextHeight+TimelineDisplayConstants.bookmarksBarHeight):new ATSize(this.relationshipView.viewport.size.width,this.relationshipView.viewport.size.height)},ATMainTimelineApp.prototype.getViewportSizeForExport=function(){var e;return this.timelineView.viewMode===ATViewMode.TIMELINE_VIEW?(e=this.timelineView.viewport.size.copy()).height+=TimelineDisplayConstants.timeHeaderHeight+TimelineDisplayConstants.contextHeight+TimelineDisplayConstants.bookmarksBarHeight:e=this.relationshipView.viewport.size.copy(),e.width+","+e.height},ATMainTimelineApp.prototype.getBoundsForManageFilterButton=function(){return this.filterBarView.boundsForManageIcon()},ATMainTimelineApp.prototype.setDocumentSize=function(e,i){d3.select("body").style("width",e+"px").style("height",i+"px"),d3.select("#bounds").style("width",e+"px").style("height",i+"px"),this.timelineView.resizeWindow(null)},ATMainTimelineApp.prototype.hideSelectedEventDetails=function(){this.timelineView.hideSelectedEventDetails()},ATMainTimelineApp.prototype.hideAllEventDetails=function(){this.timelineView.hideAllEventDetails(this.assumeAllEventsAreOpen())},ATMainTimelineApp.prototype.showSelectedEventDetails=function(){this.timelineView.showSelectedEventDetails()},ATMainTimelineApp.prototype.expandSelectedParentEvents=function(){this.timelineView.expandSelectedParentEvents()},ATMainTimelineApp.prototype.collapseSelectedParentEvents=function(){this.timelineView.collapseSelectedParentEvents()},ATMainTimelineApp.prototype.setMoreTemplate=function(e){this.timelineView.setMoreTemplate(e)},ATMainTimelineApp.prototype.createToolbar=function(){window.appToolbar||(window.appToolbar=new ATToolbar({el:"#toolbarDiv"}),window.appToolbar.setToolbarCommands(window.toolbarCommands),window.appToolbar.setMenuCommands(window.menuCommands)),d3.select("#bounds").classed("underToolbar",!0),window.appToolbar.setDisabled(_.map(window.toolbarCommands,"identifier"),!1),window.appToolbar.setDisabled(_.map(window.toolbarCommands[0].options,"identifier"),!1),window.appToolbar.setDisabled(_.map(window.menuCommands[0].options,"identifier"),!1),window.appToolbar.setDisabled(_.map(window.menuCommands[1].options,"identifier"),!1),window.appToolbar.setDisabled(_.map(window.menuCommands[2].options,"identifier"),!1),window.appToolbar.setDisabled(_.map(window.menuCommands[3].options,"identifier"),!1),window.appToolbar.setDisabled(_.map(window.menuCommands[4].options,"identifier"),!1),window.appToolbar.setDisabled(_.map(window.menuCommands[5].options,"identifier"),!1),window.appToolbar.setDisabled(["findPrevious","findNext","syncClose","deactivate"],!0),this.enableToolbarItemsForSelection()},ATMainTimelineApp.prototype.createWebToolbar=function(){window.appToolbar||(window.appToolbar=new ATToolbar({el:"#toolbarDiv"}),window.appToolbar.setToolbarCommands(window.webToolbarCommands)),d3.select("#bounds").classed("webUnderToolbar",!0),this.enableToolbarItemsForSelection(),window.isAeonWebExport&&"MacOS"===this.osCheck()&&d3.select("body").classed("windows",!1).classed("mac",!0)},ATMainTimelineApp.prototype.renderSyncContextMenu=function(e){this.syncBinderView&&this.syncBinderView.renderJsContextMenuWithItems(e)},ATMainTimelineApp.prototype.renderDefaultContextMenu=function(e){this.timelineView.renderJsContextMenuWithItems(e)},ATMainTimelineApp.prototype.configureManageFilterMenu=function(e){var i=utf8.decode(atob(e));this.filterBarView.configureManageFilterMenu(i)},ATMainTimelineApp.prototype.focusToolbarSearch=function(){window.appToolbar&&window.appToolbar.focusTextItem("search")},ATMainTimelineApp.prototype.enableToolbarItemsForSelection=function(){window.appToolbar&&window.appToolbar.setSelectionCount(this.timeline.selectedEvents.length)},ATMainTimelineApp.prototype.enableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!1):ATConsoleLog("enableToolbarItem FAILED because toolbar does not exist yet")},ATMainTimelineApp.prototype.disableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!0):ATConsoleLog("disableToolbarItem FAILED because toolbar does not exist yet")},ATMainTimelineApp.prototype.setToolbarItemState=function(e,i){window.appToolbar?window.appToolbar.setState(e,i):ATConsoleLog("setToolbarItemState FAILED because toolbar does not exist yet")},ATMainTimelineApp.prototype.bulkSetToolbarItemsEnabledState=function(e){var i=JSON.parse(e);window.appToolbar?_.each(i,function(e,i){window.appToolbar.setDisabled([i],!e)}):ATConsoleLog("setToolbarItemState FAILED because toolbar does not exist yet")},ATMainTimelineApp.prototype.showExportCSV=function(){this.$exportCsvModal||(this.$exportCsvModal=$("#exportCsvModal"),$("#exportCsvModal").modal({show:!1,backdrop:"static"}),this.exportCSVView=new ATExportCSVView({el:"#exportCsvModal"})),this.showModal(this.$exportCsvModal)},ATMainTimelineApp.prototype.showExportImage=function(){this.$exportImageModal||(this.$exportImageModal=$("#exportImageModal"),$("#exportImageModal").modal({show:!1,backdrop:"static"}),this.exportImageView=new ATExportImageView({el:"#exportImageModal"}),this.exportImageView.setRangeConversion(this.timeline.rangeConversion)),this.exportImageView.calculateRangeOnShow(),this.showModal(this.$exportImageModal)},ATMainTimelineApp.prototype.showPrint=function(){this.$printModal||(this.$printModal=$("#printModal"),$("#printModal").modal({show:!1,backdrop:"static"}),this.printView=new ATPrintView({el:"#printModal"}),this.printView.setRangeConversion(this.timeline.rangeConversion)),this.printView.calculateRangeOnShow(),this.showModal(this.$printModal)},ATMainTimelineApp.prototype.showNotifications=function(){this.notificationManager||(this.notificationManager=new ATNotificationManager({model:this.timeline})),this.notificationManager.show()},ATMainTimelineApp.prototype.showImportCsvFirstModal=function(){this.$importCsvModal||(this.$importCsvModal=$("#importCsvModal"),$("#importCsvModal").modal({show:!1,backdrop:"static"}),this.importCsvView=new ATImportCsvView({el:"#importCsvModal"})),this.importCsvView.configureAsPage1(),this.showModal(this.$importCsvModal)},ATMainTimelineApp.prototype.showImportCsvSecondModal=function(e){if(0!=e.length){var i=utf8.decode(atob(e)),t=JSON.parse(i);this.$importCsvModal?this.importCsvView.configureAsPage2(t[0],t[1]):ATConsoleLog("attempting to show Csv Second page when first page was never shown")}},ATMainTimelineApp.prototype.formInputHasFocus=function(){var e=$(document.activeElement);return e[0]!=$(document)[0]&&e[0]!=$("html")[0]&&e[0]!=$("body")[0]},ATMainTimelineApp.prototype.homeKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollToPixelXY(null,this.timelineView.rangeY.min):this.relationshipView.scrollToPixelXY(null,this.relationshipView.rangeY.min),!1},ATMainTimelineApp.prototype.endKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollToPixelXY(null,this.timelineView.rangeY.max):this.relationshipView.scrollToPixelXY(null,this.relationshipView.rangeY.max),!1},ATMainTimelineApp.prototype.pageDownKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollPageDown():this.relationshipView.gotoNextEvent(),!1},ATMainTimelineApp.prototype.pageUpKeyPressed=function(){return this.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.timelineView.scrollPageUp():this.relationshipView.gotoPreviousEvent(),!1},ATMainTimelineApp.prototype.osCheck=function(){var e=null;return-1!=navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e},ATMainTimelineApp.prototype.revealInTimeline=function(){this.timeline.selectedEvents.length>=1&&this.timelineView.scrollToEventsIfOffScreen(this.timeline.selectedEvents)},ATMainTimelineApp.prototype.selectAndScrollToEvents=function(e){var i=this,t=e.split(",");this.timeline.clearSelection(!0),this.timeline.selectEventsWithIDs(t),this.timelineView.holdRendering(),_.each(t,function(e){var t,n=i.timelineView.model.findNodeForEventId(e);n&&((t=n.get("lane")).get("collapsed")&&i.timelineView.toggleLane(t.id),i.timelineView.revealChildNode(e))}),this.timelineView.releaseRendering(),t.length>1&&this.timelineView.scrollToEventsIfOffScreen(t)},ATMainTimelineApp.prototype.keyboardOpenedWithHeightAndDuration=function(e,i){this.canvasManager&&this.canvasManager.keyboardOpenedWithHeightAndDuration(e,i)},ATMainTimelineApp.prototype.keyboardClosedWithDuration=function(e){this.canvasManager&&this.canvasManager.keyboardClosedWithDuration(e)},module.exports=ATMainTimelineApp;

},{"../model/ATEmptyGuidString":26,"../model/ATTimeUnit":40,"../utils/ATBounds":44,"../utils/ATPoint":46,"../utils/ATSize":49,"../utils/ATUtilities":51,"../view/ATViewMode":53,"../view/desktop/ATAddEntityView":54,"../view/desktop/ATAddEventView":55,"../view/desktop/ATDisplaySettingsView":61,"../view/desktop/ATEditCalendarView":65,"../view/desktop/ATEditTemplateView":68,"../view/desktop/ATEmbedInNewParentView":69,"../view/desktop/ATEnterDateView":70,"../view/desktop/ATEnterDurationView":71,"../view/desktop/ATEnterNameView":72,"../view/desktop/ATExportCSVView":73,"../view/desktop/ATExportImageView":74,"../view/desktop/ATExpressManageRowsView":77,"../view/desktop/ATExpressSettingsView":78,"../view/desktop/ATFindReplaceView":80,"../view/desktop/ATImportCsvView":82,"../view/desktop/ATManageEntitiesView":89,"../view/desktop/ATNewParentView":90,"../view/desktop/ATOnboardingView":91,"../view/desktop/ATPrintView":92,"../view/desktop/ATSyncManagerView":98,"../view/desktop/ATSyncSettingsView":99,"../view/desktop/ATTagManagerView":100,"../view/desktop/ATToolbar":101,"../view/ios/ATNotificationManager":187,"../view/ios/ATScreenMode":191,"./ATDisplayConstants":16,"d3":320,"jquery":331,"lodash":333,"utf8":362}],18:[function(require,module,exports){
var ATOnboardSuggestions={drag_event:{title:"Drag events to different dates on your timeline",description:"As you are unlikely to know exact dates for all of your events from the outset, here are a few ways to move events around the timeline.",iosSteps:["Edit an event date or duration manually by tapping on the event, and then tapping on the start date in the Inspector.","Press and hold on the timeline view to enter Edit Mode, which will enable you to select and drag events physically around the timeline. Tap 'Done' in the toolbar to exit Edit Mode.","While in Edit Mode, you can also select multiple events, tap on the 'More' (three dots) icon in the toolbar, and choose Make Consecutive. This works best if the selected events have a duration."],desktopSteps:["Edit an event date or duration manually by clicking on the event.","Under the 'Range' tab in the Inspector, type a new date next to the 'Start' heading to change the start date. You can do the same for the end date or duration.","You can also click on the calendar symbol to the right of the text to use the date picker to select the date.","Click and drag an event on the timeline to move it to a new location. Text will appear to show you the new date that will be assigned as you move the event.","To move events by a certain duration, select the event choose 'Shift Events By...' from the Timeline menu. Enter a duration to move the event by","You can select multiple events to move at once by dragging a box around the events, or by holding down Ctrl (on Windows) or Cmd (on Mac) while selecting the events","Choose 'Make Consecutive' from the Timeline menu when multiple events are selected to make them consecutive. This works best if the selected events have a duration."]},fiction_create_timeline:{title:"Create a timeline with the Fiction template",description:"Congratulations, you have completed the first step by creating this timeline. Our Fiction template is pre-configured to track typical types of information you may want for a writing project.",iosSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Settings - just click on the cog icon in the left hand side bar."],desktopSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Timeline Settings - just click on the cog icon in the toolbar."]},fiction_add_character:{title:"Create your characters",description:"If you already know who your main characters are, you can add them at the start of the project. This will allow you to associate events with characters from the outset.",iosSteps:["Tap on the Character icon in the left hand side bar","Tap on 'Add' at the top of the Character list","In the modal, type the name of the character and optionally choose a color","You can leave the Birth/Creation and Death/Destruction fields alone for now, we will revisit them later","Tap 'Add' at the top of the modal","Repeat for each character you wish to create. You can always add more later"],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Character'.","In the modal, type the name of the character.","You can leave the Birth/Creation and Death/Destruction fields alone for now, we will revisit them later","Click on 'OK' to add the character.","Repeat for each character you wish to create. You can always add more later"]},fiction_add_event:{title:"Add your first events to your timeline",description:"Begin by adding the major events that represent the key turning points of your story. Don't worry about the structure too much at this point, that can come later. At this point we just want a place to get started.",iosSteps:["Don't stress about dates much yet, but if you already know the approximate month or year or decade your story is set, scroll to that position in the Timeline View.","Tap + in the left hand side bar to add an event.","Type the title of the event in the inspector","If you have a specific date in mind for this event, you can modify the date and duration of the event."],desktopSteps:["Don't stress about dates much yet, but if you already know the approximate month or year or decade your story is set, scroll to that position in the Timeline View.","Click the + icon on the toolbar, or alternatively double click on the timeline to add an event.","Type the title of the event in the text box.","If you have a specific date in mind for this event, you can modify the date and duration of the event"]},fiction_assign_character:{title:"Associate characters with events",description:"Once your events have been created, you can associate them with specific characters through the Inspector.",iosSteps:["Tap on an event in the timeline view to select the event and show the Inspector","Tap on the 'Participant' row (located under 'Roles') in the Inspector.","Tap on the names of characters who participated in this event. If your list is very long, you can type the first few letters into the Filter search box to reduce the number shown.","If there are characters who witnessed or were affected by an event but were not a direct participant, you can add them under the 'Observer' role instead.","If you want to assign multiple events to a character at once, press and hold on the Timeline View to enter edit mode. You can then select multiple events, and tap the edit icon in the toolbar to open the inspector and edit all selected events at once."],desktopSteps:["Click on an event in the timeline view.","Click on the 'Roles' tab in the Inspector.","Click on the green plus sign next to the 'Participant' heading.","Click on a name of a character who participated in this event. If your list is very long, you can type the first few letters into the search box to reduce the number shown.","If there are characters who witnessed or were affected by an event but were not a direct participant, you can add them under the 'Observer' role instead.","If you want to assign multiple events to a character at once, select multiple events by holding down Ctrl (on Windows) or Cmd (on Mac). You can assign characters in the inspector to all the selected events."]},fiction_character_age:{title:"Give your characters a date of birth and start tracking their age",description:"If you give characters a date of birth, Aeon Timeline will calculate their age at every event in the timeline. This allows you to build up a character's backstory.",iosSteps:["Tap on the Character icon in the left hand side bar","Tap on 'Edit' at the top of the Character list","Tap on the name of the character you wish to edit","In the modal, tap on Birth/Creation","If you want to specify a specific date, tap on 'Date' and then select that date from the calendar","Alternatively, you can calculate their date of birth as an offset from a specific event by tapping on 'Event'. Select the event and then select the relevant offset details.","Tap 'Done' at the top of the modal"],desktopSteps:["Open the 'Manage Entities' window via the Timeline menu or via the icon on the toolbar.","Click on the 'Character' heading to open the list of characters, and click on the name of the character you wish to edit.","To add a date of birth for a character type in a specific date next to the 'Date' heading under 'Birth/Creation' or use the date picker to select the date.","ALternatively, you can calculate their date of birth as an offset from a speciic event by choosing the event from the dropdown list and typing the offset duration. Choose whether this offset is from the start or end of the event.","Close the modal window by clicking the cross in the top right corner."]},fiction_group_by_character:{title:"View group of events assigned to a character",description:"So far, we have been looking at all events in the timeline at once, but there may be times you want to focus on events for a specific character instead.",iosSteps:["Tap on the Character icon in the left hand side bar.","Tap on the character you wish to view.","If you want to view unassigned tasks with no associated character, tap the 'Unallocated (No Character)' instead","To return to viewing all events, tap on the character icon again and choose 'All Events'"],desktopSteps:["Click on the 'Group By' icon on the toolbar and choose 'Group By Character'. This will divide your events by character in the vertical space.","If you want to jump to a certain character use the navigational bubbles on the right.","You can collapse and expand character groups to reduce the amount of clutter and vertical space on the timeline by clicking on the arrow next to the character name."]},fiction_divide_arcs:{title:"Add structure by dividing events into arcs",description:"As your timeline grows in complexity with a mix of major, minor and background events for your story and characters, it will reach a point where you need to give it more structure. At this point, you can use arcs to separate your events into logical groups based on the story arcs of your project.",iosSteps:["Tap on the Arc icon in the left hand side bar","Tap on 'Add' at the top of the Arc list","In the modal, type the name of the arc you wish to create","Tap 'Add' at the top of the modal","Switch to Relationship View by clicking on the grid icon in the center of the toolbar.","Tap on the dropdown menu and choose to show 'Arc' as your column type","For each event you wish to assign to that Arc, tap on the table cell intersecting the event and arc name, and pick 'Arc' from the dropdown.","Repeat to add additional arcs","You can now view event groups by Arc in the same way you can view them by Character."],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Arc'.","In the modal, type the name of the arc you wish to create and click 'OK'.","Switch to Relationship View by clicking on the grid icon on the right of the toolbar.","For each event you wish to assign to that Arc, click on the table cell intersecting the event and arc name and pick 'Arc' from the dropdown.","Repeat to add additional arcs.","You can now view event groups by Arc in the same way you can view them by Character."]},screenplay_create_timeline:{title:"Create a timeline with the Screenplay template",description:"Congratulations, you have completed the first step by creating this timeline. Our Screenplay template is pre-configured to track typical types of information you may want for a writing project.",iosSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Settings - just click on the cog icon in the left hand side bar."],desktopSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Timeline Settings - just click on the cog icon in the toolbar."]},screenplay_add_character:{title:"Create your characters",description:"If you already know who your main characters are, you can add them at the start of the project. This will allow you to associate events with characters from the outset.",iosSteps:["Tap on the Character icon in the left hand side bar","Tap on 'Add' at the top of the Character list","In the modal, type the name of the character and optionally choose a color","Tap 'Add' at the top of the modal","Repeat for each character you wish to create. You can always add more later"],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Character'.","In the modal, type the name of the character.","You can leave the Birth/Creation and Death/Destruction fields alone for now, we will revisit them later.","Click on 'OK' to add the character.","Repeat for each character you wish to create. You can always add more later"]},screenplay_add_event:{title:"Add your first events to your timeline",description:"Begin by adding the major events that represent the key turning points of your story. Don't worry about the structure too much at this point, that can come later. At this point we just want a place to get started.",iosSteps:["Tap + in the left hand side bar to add an event.","Type the title of the event in the inspector","If you know approximately when this event will occur in your screenplay, adjust the time accordingly. You will always be able to move them later."],desktopSteps:["Click on the + icon in the toolbar or alternatively double click on the timeline to add an event.","Type the title of the event in the textbox.","If you know approximately when this event will occur in your screenplay, adjust the start and end time accordingly. You will always be able to move them later."]},screenplay_assign_character:{title:"Associate characters with events",description:"Once your events have been created, you can associate them with specific characters through the Inspector.",iosSteps:["Tap on an event in the timeline view to select the event and show the Inspector","Tap on the 'Participant' row (located under 'Roles') in the Inspector.","Tap on the names of characters who participated in this event. If your list is very long, you can type the first few letters into the Filter search box to reduce the number shown.","If there are characters who witnessed or were affected by an event but were not a direct participant, you can add them under the 'Observer' role instead.","If you want to assign multiple tasks to a character at once, press and hold on the Timeline View to enter edit mode. You can then select multiple events, and tap the edit icon in the toolbar to open the inspector and edit all selected events at once."],desktopSteps:["Click on an event in the timeline view.","Click on the 'Roles' tab in the Inspector.","Click on the green plus sign next to the 'Participant' heading.","Click on the name of a character who participated in this event. If your list is very long, you can type the first few letters into the search box to reduce the number shown.","If there are characters who witnessed or were affected by an event but were not a direct participant, you can add them under the 'Observer' role instead.","If you want to assign multiple events to a character at once, select multiple events by holding down Ctrl (on Windows) or Cmd (on Mac). You can assign characters in the inspector to all the selected events."]},screenplay_group_by_character:{title:"View group of events assigned to a character",description:"So far, we have been looking at all events in the timeline at once, but there may be times you want to focus on events for a specific character instead.",iosSteps:["Tap on the Character icon in the left hand side bar.","Tap on the character you wish to view.","If you want to view unassigned tasks with no associated character, tap the 'Unallocated (No Character)' instead","To return to viewing all events, tap on the character icon again and choose 'All Events'"],desktopSteps:["Click on the 'Group By' icon on the toolbar and choose 'Group By Character'. This will divide your events by character in the vertical space.","If you want to jump to a certain character use the navigational bubbles on the right.","You can collapse and expand character groups to reduce the amount of clutter and vertical space on the timeline by clicking on the arrow next to the character name."]},screenplay_divide_arcs:{title:"Add structure by dividing events into arcs",description:"As your timeline grows in complexity with a mix of major, minor and background events for your story and characters, it will reach a point where you need to give it more structure. At this point, you can use arcs to separate your events into logical groups based on the story arcs of your project.",iosSteps:["Tap on the Arc icon in the left hand side bar","Tap on 'Add' at the top of the Arc list","In the modal, type the name of the arc you wish to create","Tap 'Add' at the top of the modal","Switch to Relationship View by clicking on the grid icon in the center of the toolbar.","Tap on the dropdown menu and choose to show 'Arc' as your column type","For each event you wish to assign to that Arc, tap on the table cell intersecting the event and arc name, and pick 'Arc' from the dropdown.","Repeat to add additional arcs","You can now view event groups by Arc in the same way you can view them by Character."],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Arc'.","In the modal, type the name of the arc you wish to create and click 'OK'.","Switch to Relationship View by clicking on the grid icon on the right of the toolbar.","For each event you wish to assign to that Arc, click on the table cell intersecting the event and arc name and pick 'Arc' from the dropdown.","Repeat to add additional arcs.","You can now view event groups by Arc in the same way you can view them by Character."]},pm_create_timeline:{title:"Create a timeline with the Project Management template",description:"Congratulations, you have completed the first step by creating this timeline. Our Project Management template is pre-configured to track typical types of data you may want for a project.",iosSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Settings - just click on the cog icon in the left hand side bar."],desktopSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Timeline Settings - just click on the cog icon in the toolbar."]},pm_create_project:{title:"Create one or more projects",description:"Aeon Timeline allows you to track events across all of your projects in a single timeline. As a first step, we recommend adding your projects from the outset so that you can assign events to the correct project as they are created.",iosSteps:["Tap on the Project icon in the left hand side bar","Tap on 'Add' at the top of the Projects list","In the modal, type the name of the project and optionally choose a color","Tap 'Add' at the top of the modal","Repeat for each project you wish to create... you can always add more later"],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Project'.","In the modal, type the name of the project.","Repeat for each project you wish to create... you can always add more later"]},pm_add_employee:{title:"Add your employees",description:"By adding your employees into the timeline, you will be able to assign each task to the employees that should complete the work. You will then be able to view each employee's individual schedule to ensure they are not over- or under-worked.",iosSteps:["Tap on the Employee icon in the left hand side bar","Tap on 'Add' at the top of the Employee list","In the modal, type the name of the employee and optionally choose a color","Tap 'Add' at the top of the modal","Repeat for each employee you wish to create. You can always add more later"],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Employee'.","In the modal, type the name of the employee.","Repeat for each employee you wish to create... you can always add more later"]},pm_add_event:{title:"Add your tasks into the timeline",description:"The next step is to create events to represent the tasks that make up your project. It is easiest to do this one project at a time. We usually recommend a top-down approach where you create high level events first, and flesh them out with more detail when required.",iosSteps:["Tap on the Project icon in the left hand side bar.","Tap on the project you wish to update. This will change the Timeline View to show that project group (only events from that group will be displayed).","Tap + in the left hand side bar to add an event.","Type the title of the event in the inspector.","Set the date and duration by tapping on the relevant fields in the Inspector.","Repeat for each event you wish to add to the project, and then repeat for each project you are creating."],desktopSteps:["Click on the 'Group By' icon on the right side of the toolbar and choose 'Group by Project'. This will change the Timeline View to group events by project group.","Double click inside the project you wish to add an event to.","Type the title of the event in the text box in the pop up window.","Set the date and duration of the task in the relevant fields and click 'OK'.","Repeat for each event you wish to add to the project, and then repeat for each project you are creating."]},pm_assign_task:{title:"Assign tasks to employees",description:"Once your tasks have been created, you can assign tasks to specific employees through the Inspector.",iosSteps:["Tap on an event in the timeline view to select the event and show the Inspector","Tap on the 'Resource' row (located under 'Roles') in the Inspector.","Tap on the name of the employee to assign them to the event. If your list is very long, you can type the first few letters into the Filter search box to reduce the number shown.","To add more than one employee, tap on another employee name","Tapping on an already selected employee will remove them from the event.","If you want to assign multiple tasks to an employee at once, press and hold on the Timeline View to enter edit mode. You can then select multiple events, and tap the edit icon in the toolbar to open the inspector and edit all selected events at once."],desktopSteps:["Click on an event in the timeline view.","Click on the 'Roles' tab in the Inspector.","Click on the green plus sign next to the 'Resource' heading.","Click on the name of the employee to assign them to the event. If your list is very long, you can type the first few letters into the search box to reduce the number shown.","Repeat to add more employees to events.","If you want to assign multiple tasks to an employee at once, select multiple events by holding down Ctrl (on Windows) or Cmd (on Mac). You can assign employees in the inspector to all the selected events."]},pm_view_employee_tasks:{title:"View task list for employee",description:"So far, we have viewed events grouped by project, but there may be times you want to view events assigned to an individual employee instead to evaluate their comparative workload.",iosSteps:["Tap on the Employee icon in the left hand side bar.","Tap on the employee you wish to view.","If you want to view unassigned tasks with no associated employee, tap the 'Unallocated (No Employee)' instead"],desktopSteps:["Click on the 'Group By' icon on the toolbar and choose 'Group By Employee'. This will divide your events by employee in the vertical space.","If you want to jump to a certain employee use the navigational bubbles on the right.","You can collapse and expand employee groups to reduce the amount of clutter and vertical space on the timeline by clicking on the arrow next to the employee name."]},pm_consecutive_tasks:{title:"Make tasks consecutive to avoid down time or overlaps",description:"You can make tasks consecutive so that one task will start after the other has finished.",iosSteps:["Press and hold to enter 'Edit Mode'.","Select the events you want to make consecutive.","Tap the 'More' icon (three dots) and choose 'Make Consecutive'. This will move the start date of the later event to be the end date of the earlier. This works best for events with a duration"],desktopSteps:["Select the events you want to make consecutive by holding down Ctrl (on Windows) or Cmd (on Mac).","Choose 'Make Events Consecutive' from the Timeline Menu. This will move the start date of the later event to be the end date of the earlier. This works best for events with a duration"]},generic_create_timeline:{title:"Create a new timeline",description:"Congratulations, you have completed the first step by creating this timeline. Our templates are pre-configured to track typical types of information you may want in your project.",iosSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Settings - just click on the cog icon in the left hand side bar."],desktopSteps:["We would recommend becoming familiar with Aeon Timeline first by completing the remainder of the suggestions, but you can always modify the template to better suit your needs via Timeline Settings - just click on the cog icon in the toolbar."]},generic_add_person:{title:"Add people to your timeline",description:"If there are people you want to track in your timeline, you can add them at the start of the project. This will allow you to associate events with those people from the outset.",iosSteps:["Tap on the Person icon in the left hand side bar","Tap on 'Add' at the top of the Person list","In the modal, type the name of the person and optionally choose a color","You can leave the Birth/Creation and Death/Destruction fields alone for now, we will revisit them later","Tap 'Add' at the top of the modal","Repeat for each person you wish to add. You can always add more later."],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Person'.","In the modal, type the name of the person.","You can leave the Birth/Creation and Death/Destruction fields alone for now, we will revisit them later","Click on 'OK' to add the person.","Repeat for each person you wish to create. You can always add more later"]},generic_add_event:{title:"Add your first events to your timeline",description:"Begin by adding the major events into your timeline. Don't worry about the structure too much at this point, that can come later. At this point we just want a place to get started.",iosSteps:["If you already know the approximate month or year or decade your event took place, scroll to that position in the Timeline View.","Tap + in the left hand side bar to add an event.","Type the title of the event in the inspector","Enter the date the event took place. If you are not sure, you can use an approprimate date for now and update it later."],desktopSteps:["Don't stress about dates much yet, but if you already know the approximate month or year or decade where your events are set, scroll to that position in the Timeline View.","Click the + icon on the toolbar, or alternatively double click on the timeline to add an event.","Type the title of the event in the text box.","If you have a specific date in mind for this event, you can modify the date and duration of the event"]},generic_assign_person:{title:"Associate people with events",description:"Once your events have been created, you can associate them with specific people through the Inspector.",iosSteps:["Tap on an event in the timeline view to select the event and show the Inspector","Tap on the 'Person' row (located under 'Roles') in the Inspector.","Tap on the names of people who participated in this event. If your list is very long, you can type the first few letters into the Filter search box to reduce the number shown.","If you want to assign multiple events to a person at once, press and hold on the Timeline View to enter edit mode. You can then select multiple events, and tap the edit icon in the toolbar to open the inspector and edit all selected events at once."],desktopSteps:["Click on an event in the timeline view.","Click on the 'Roles' tab in the Inspector.","Click on the green plus sign next to the 'Person' heading.","Click on the name of a person who participated in this event. If you list is very long, you can type the first few letters into the search box to reduce the number shown.","If you want to assign multiple events to a person at once, select multiple events by holding down Ctrl (on Windows) or Cmd (on Mac). You can assign people in the inspector to all the selected events."]},generic_person_age:{title:"Give your people a date of birth",description:"If you give people a date of birth, Aeon Timeline will calculate their age at every event in the timeline.",iosSteps:["Tap on the Person icon in the left hand side bar","Tap on 'Edit' at the top of the Person list","Tap on the name of the person you wish to edit","In the modal, tap on Birth/Creation","If you want to specify a specific date, tap on 'Date' and then select that date from the calendar","Alternatively, you can calculate their date of birth as an offset from a specific event by tapping on 'Event'. Select the event and then select the relevant offset details.","Tap 'Done' at the top of the modal"],desktopSteps:["Open the 'Manage Entities' window via the Timeline menu or via the icon on the toolbar.","Click on the 'Person' heading to open the list of people, and click on the name of the person you wish to edit.","To add a date of birth for a person type in a specific date next to the 'Date' heading under 'Birth/Creation' or use the date picker to select the date.","ALternatively, you can calculate their date of birth as an offset from a speciic event by choosing the event from the dropdown list and typing the offset duration. Choose whether this offset is from the start or end of the event.","Close the modal window by clicking the cross in the top right corner."]},generic_group_by_person:{title:"View group of events assigned to a person",description:"So far, we have been looking at all events in the timeline at once, but there may be times you want to focus on a single person instead.",iosSteps:["Tap on the Person icon in the left hand side bar.","Tap on the person you wish to view.","If you want to view unassigned tasks with no associated person, tap the 'Unallocated (No Person)' instead","To return to viewing all events, tap on the person icon again and choose 'All Events'"],desktopSteps:["Click on the 'Group By' icon on the toolbar and choose 'Group By Person'. This will divide your events by people in the vertical space.","If you want to jump to a certain person use the navigational bubbles on the right.","You can collapse and expand person groups to reduce the amount of clutter and vertical space on the timeline by clicking on the arrow next to the person name."]},generic_divide_category:{title:"Add structure by dividing events into categories",description:"As your timeline grows in complexity with a mix of major, minor and background events, it will reach a point where you need to give it more structure. At this point, you can use categories to separate your events into logical groups.",iosSteps:["Tap on the Category icon in the left hand side bar","Tap on 'Add' at the top of the Category list","In the modal, type the name of the category you wish to create","Tap 'Add' at the top of the modal","Switch to Relationship View by clicking on the grid icon in the center of the toolbar.","Tap on the dropdown menu and choose to show 'Category' as your column type","For each event you wish to assign to that Category, tap on the table cell intersecting the event and category name, and pick 'Category' from the dropdown.","Repeat to add additional categories","You can now view event groups by Category in the same way you can view them by Person."],desktopSteps:["Click on the 'Add Entity' icon in the toolbar and choose 'Add Categories'.","In the modal, type the name of the category you wish to create and click 'OK'.","Switch to Relationship View by clicking on the grid icon on the right of the toolbar.","For each event you wish to assign to that Category, click on the table cell intersecting the event and category name and pick 'Category' from the dropdown.","Repeat to add additional categories.","You can now view event groups by Category in the same way you can view them by Person."]},ios_group_person:{title:"View events assigned to a specific entity (e.g. person)",description:"Due to screen size constraints, Aeon Timeline on iOS shows only a single group of events at a time, but provides a quick way to switch between different groups.",iosSteps:["Tap on the relevant entity type icon (e.g. Person, Arc) in the left hand side bar.","Tap on the entity name you wish to view.","Repeat the process to switch between different groups","To return to viewing all events, tap on any type icon and choose 'All Events'","To view events that have not been assigned to anyone of a given type, tap the 'Unallocated' label instead"],desktopSteps:["..."]},ios_edit_entity:{title:"Edit information about an entity (e.g. person)",description:"",iosSteps:["Tap on the relevant type icon in the left hand side bar","Tap on 'Edit' at the top of the displayed entity list","Tap on the name of the entity you wish to edit","In the modal, edit any information you want to change.","Tap 'Done' at the top of the modal"],desktopSteps:["..."]},ios_drag_event:{title:"Drag events around your timeline",description:"",iosSteps:["Press and hold on the Timeline or Relationship View to enter Edit Mode.","Once in Edit Mode, you can tap and drag to move events around the timeline.","To drag multiple events at once, first select multiple events by tapping in the checkbox next to them. Start a tap-and-drag from one of the selected events to move all selected events.","Tap 'Done' in the toolbar to exit Edit Mode."],desktopSteps:["..."]},ios_bulk_edit:{title:"Edit multiple events at once",description:"",iosSteps:["Press and hold on the Timeline or Relationship View to enter Edit Mode.","Select events you wish to edit by tapping in the checkbox next to them.","Tap on the edit (pencil) icon in the toolbar to open the inspector.","Update any values you wish to apply to all events.","Tap away from the inspector to close it.","Tap 'Done' in the toolbar to exit Edit Mode."],desktopSteps:["..."]},ios_relationship_columns:{title:"Change visible columns in Relationship View",description:"",iosSteps:["Switch to Relationship View by clicking on the grid icon in the center of the toolbar.","Tap on the dropdown menu above the event list.","Tap the name of the entity type you wish to view"],desktopSteps:["..."]}};module.exports=ATOnboardSuggestions;

},{}],19:[function(require,module,exports){
var _=require("lodash"),ATUtilities=require("../utils/ATUtilities"),ATTimeUnit=require("../model/ATTimeUnit"),ATTimeSpan=require("../model/ATTimeSpan"),ATRange=require("../utils/ATRange"),ATRangePositionSuggestion=require("./ATRangePositionSuggestion"),TimelineDisplayConstants=require("../controller/ATDisplayConstants"),ATCalendarType=require("../model/ATCalendarType"),ATRangeConversion=function(e,n){this.type=e,this.calendar=n};ATRangeConversion.prototype.stringFromValue=function(e,n){return"date"===this.type?_.isNil(e.timestamp)?this.calendar.stringFromDate(this.calendar.dateWithTimestamp(e),n):this.calendar.stringFromDate(e,n):this.stringFromNumber(e)},ATRangeConversion.prototype.naturalStringFromValue=function(e,n){return"date"===this.type?_.isNil(e.timestamp)?this.calendar.naturalStringFromDate(this.calendar.dateWithTimestamp(e),!1,!1,!1,n?"%G":"%Y"):this.calendar.naturalStringFromDate(e,!1,!1,!1,n?"%G":"%Y"):this.stringFromNumber(e)},ATRangeConversion.prototype.naturalStringFromEndValue=function(e,n,a){return"date"===this.type?_.isNil(e.timestamp)?this.calendar.naturalStringFromDate(this.calendar.dateWithTimestamp(e),!1,!0,this.calendar.dateWithTimestamp(n),a?"%G":"%Y"):this.calendar.naturalStringFromDate(e,!1,!0,n,a?"%G":"%Y"):this.stringFromNumber(e)},ATRangeConversion.prototype.naturalStringFromValueRange=function(e,n){return"date"===this.type?_.isNil(e.timestamp)?this.calendar.naturalStringFromDate(this.calendar.dateWithTimestamp(e),this.calendar.dateWithTimestamp(n)):this.calendar.naturalStringFromDateRange(e,n):this.stringFromNumber(e)+" - "+this.stringFromNumber(n)},ATRangeConversion.prototype.stringFromNumber=function(e){return Math.abs(e)>=1e9?parseFloat((e/1e9).toFixed(2))+" billion":Math.abs(e)>=1e6?parseFloat((e/1e6).toFixed(2))+" million":String(e)},ATRangeConversion.prototype.shortStringFromNumber=function(e){return Math.abs(e)>=1e9?parseFloat((e/1e9).toFixed(2))+"b":Math.abs(e)>=1e6?parseFloat((e/1e6).toFixed(2))+"m":String(e)},ATRangeConversion.prototype.stringFromRoundedNumber=function(e,n){return Math.abs(e)>=1e9?parseFloat((e/1e9).toFixed(2))+" billion":Math.abs(e)>=1e6?parseFloat((e/1e6).toFixed(2))+" million":n?e.toFixed(n):String(e)},ATRangeConversion.prototype.stringFromSpanValue=function(e){return"date"===this.type?e.toString():this.stringFromNumber(e)},ATRangeConversion.prototype.shortStringFromSpanValue=function(e){return"date"===this.type?e.toShortString():this.shortStringFromNumber(e)},ATRangeConversion.prototype.decimalPlaces=function(e){for(var n=0,a=e;a<1;)a*=10,n++;return n},ATRangeConversion.prototype.valueFromTimestamp=function(e,n){return"date"===this.type?this.calendar.dateWithTimestamp(e,n):parseInt(e)},ATRangeConversion.prototype.nowTimestamp=function(){return"date"===this.type?this.calendar.timestampForNow():null},ATRangeConversion.prototype.todayTimestamp=function(){return"date"===this.type?this.calendar.timestampForToday():null},ATRangeConversion.prototype.valueByAddingSpanToValue=function(e,n){return"date"===this.type?_.isNil(e)||_.isNil(n)?null:_.isNumber(e.timestamp)?this.calendar.dateByAddingTimespanToDate(e,n):this.calendar.dateByAddingTimespanToDate(this.calendar.dateWithTimestamp(e),n):isNaN(e)||isNaN(n)?e:e+n},ATRangeConversion.prototype.valueAtEvenSpanBeforeTimestamp=function(e,n){return"date"===this.type?this.calendar.dateAtEvenTimespanBeforeDate(this.calendar.dateWithTimestamp(e),n):e%n},ATRangeConversion.prototype.spanBetweenValues=function(e,n){return"date"===this.type?this.calendar.timespanBetweenDates(e,n):n-e},ATRangeConversion.prototype.spanForPrecision=function(e,n){var a=n?-1:1;return"date"===this.type?e===ATTimeUnit.YEAR?new ATTimeSpan(a,0,0,0,0,0,0):e===ATTimeUnit.MONTH?new ATTimeSpan(0,a,0,0,0,0,0):e===ATTimeUnit.WEEK?new ATTimeSpan(0,0,a,0,0,0,0):e===ATTimeUnit.DAY?new ATTimeSpan(0,0,0,a,0,0,0):e===ATTimeUnit.HOUR?new ATTimeSpan(0,0,0,0,a,0,0):e===ATTimeUnit.MINUTE?new ATTimeSpan(0,0,0,0,0,a,0):new ATTimeSpan(0,0,0,0,0,0,a):a},ATRangeConversion.prototype.roundedSpanForScale=function(e){return"date"===this.type?this.calendar.roundedTimespanForScale(e):this.roundedNumberForScale(e)},ATRangeConversion.prototype.roundedSpanForUnitsAtScale=function(e,n){return"date"===this.type?this.calendar.roundedTimespanForSecondsAtScale(e,n):this.roundedNumberForValue(e,n)},ATRangeConversion.prototype.roundedValueForValue=function(e,n){return"date"===this.type?this.roundedDateForValue(e,n):this.roundedNumberForValue(e,n)},ATRangeConversion.prototype.valueForPartialString=function(e,n,a){return"date"===this.type?this.dateValueForPartialString(e,n,a):this.numberValueForPartialString(e,n,a)},ATRangeConversion.prototype.spanValueForPartialString=function(e,n,a){return"date"===this.type?this.timespanValueForPartialString(e,n,a):this.numberValueForPartialString(e,n,a)},ATRangeConversion.prototype.incrementString=function(e,n,a){return"date"===this.type?this.incrementDateString(e,n,a):this.incrementNumberString(e,n,a)},ATRangeConversion.prototype.nextComponentInString=function(e,n){return"date"===this.type?this.nextComponentInDateString(e,n):this.nextComponentInNumberString(e,n)},ATRangeConversion.prototype.previousComponentInString=function(e,n){return"date"===this.type?this.previousComponentInDateString(e,n):this.previousComponentInNumberString(e,n)},ATRangeConversion.prototype.updateStringWithComponents=function(e,n,a){return"date"===this.type?this.updateDateStringWithComponents(e,n,a):this.updateNumberStringWithComponents(e,n,a)},ATRangeConversion.prototype.labelsBetweenBounds=function(e,n,a,r,t,i){return"date"===this.type?this.dateLabelsBetweenBounds(e,n,a,r,t,i):this.numberLabelsBetweenBounds(e,n,a,r,t,i)},ATRangeConversion.prototype.calculateMarkerSpacing=function(e,n){return"date"===this.type?this.calendar.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME?this.calculateDateMarkerSpacing(e,n):this.calendar.calendarType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME?this.calculateFloatingWeekMarkerSpacing(e,n):this.calendar.calendarType===ATCalendarType.CALENDAR_TYPE_DAY_TIME?this.calculateFloatingDayMarkerSpacing(e,n):this.calendar.calendarType===ATCalendarType.CALENDAR_TYPE_HOUR_TIME?this.calculateZeroHourMarkerSpacing(e,n):this.calculateDateMarkerSpacing(e,n):this.calculateNumberMarkerSpacing(e,n)},ATRangeConversion.prototype.lifetimeMarks=function(e,n,a,r,t,i,o,s){return"date"===this.type?this.dateLifetimeMarks(e,n,a,r,t,i,o,s):this.numberLifetimeMarks(e,n,a,r,t,i,o,s)},ATRangeConversion.prototype.roundedNumberForScale=function(e){for(var n=1;e>n&&!((n*=2)>=e)&&!((n=5*n/2)>=e);)n*=2;return n},ATRangeConversion.prototype.roundedDateForValue=function(e,n){var a=this.calendar,r=a.roundedTimespanForScale(n);return a.dateAtEvenTimespanBeforeDate(a.dateWithTimestamp(e),r)},ATRangeConversion.prototype.roundedNumberForValue=function(e,n){var a=this.roundedNumberForScale(n);return ATUtilities.floatToInt(e/a)*a},ATRangeConversion.prototype.dateValueForPartialString=function(e,n,a){var r=this.calendar.dateWithPartialString(e,n,a);return new ATRangePositionSuggestion(r.matchFound,r.date,r.text,r.selectionRange,r.cleanText)},ATRangeConversion.prototype.numberValueForPartialString=function(e,n,a){var r=e.length?parseInt(e):0;return isNaN(r)?new ATRangePositionSuggestion(!1,r,e,new ATRange(n,0),e):new ATRangePositionSuggestion(!0,r,String(r),new ATRange(n,0),String(r))},ATRangeConversion.prototype.timespanValueForPartialString=function(e,n,a){var r,t,i,o,s,p,m,T,u,S,g,c,A,M,l,d,k,w,h,b,y=e,F=n,f=new RegExp("\\b(y(e(a(r(s)?)?)?)?)","i"),R=this.calendar.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME?new RegExp("\\b(m(o(n(t(h(s)?)?)?)?)?)","i"):new RegExp("\\b(mo(n(t(h(s)?)?)?)?)","i"),v=new RegExp("\\b(w(e(e(k(s)?)?)?)?)","i"),I=new RegExp("\\b(d(a(y(s)?)?)?)","i"),D=new RegExp("\\b(h(o(u(r(s)?)?)?)?)","i"),C=this.calendar.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME?new RegExp("\\b(mi(n(u(t(e(s)?)?)?)?)?)","i"):new RegExp("\\b(m(i(n(u(t(e(s)?)?)?)?)?)?)","i"),x=new RegExp("\\b(s(e(c(o(n(d(s)?)?)?)?)?)?)","i"),E=" ",N=0;return a&&(i=y.substring(0,F),o=!1,s="",F!==y.length&&(s=y.substring(F,y.length-1),o=/^[^A-Za-z]/.test(s)),(o||F===y.length)&&(p=!1,F===y.length&&(m=i.match(/(\d+)(\s?)$/))&&(""===m[2]?(y=i+" seconds",N=8,p=!0):(y=i+"seconds",N=7,p=!0)),p||(T=new RegExp("([A-Za-z]+)$"),(u=i.match(T))&&(S=u[1].toString(),g=i.substring(0,u.index),(c=S.match(f))&&(r=g.match(/(\d+)(\s*)$/))&&(t=parseInt(r[1]),E="",""===r[2]&&(E=" ",F++),1===t?(y=g+E+"year"+s,p=!0,N=4-c[1].length):(y=g+E+"years"+s,p=!0,N=5-c[1].length)),p||(A=S.match(C))&&(r=g.match(/(\d+)(\s*)$/))&&(t=parseInt(r[1]),E="",""===r[2]&&(E=" ",F++),1===t?(y=g+E+"minute"+s,p=!0,N=6-A[1].length):(y=g+E+"minutes"+s,N=7-A[1].length,p=!0)),p||(M=S.match(R))&&(r=g.match(/(\d+)(\s*)$/))&&(t=parseInt(r[1]),E="",""===r[2]&&(E=" ",F++),1===t?(y=g+E+"month"+s,p=!0,N=5-M[1].length):(y=g+E+"months"+s,N=6-M[1].length,p=!0)),p||null!==(l=S.match(I))&&null!==(r=g.match(/(\d+)(\s*)$/))&&(t=parseInt(r[1]),E="",""===r[2]&&(E=" ",F++),1===t?(y=g+E+"day"+s,p=!0,N=3-l[1].length):(y=g+E+"days"+s,N=4-l[1].length,p=!0)),p||(d=S.match(v))&&(r=g.match(/(\d+)(\s*)$/))&&(t=parseInt(r[1]),E="",""===r[2]&&(E=" ",F++),1===t?(y=g+E+"week"+s,p=!0,N=4-d[1].length):(y=g+E+"weeks"+s,N=5-d[1].length,p=!0)),p||(k=S.match(D))&&(r=g.match(/(\d+)(\s*)$/))&&(t=parseInt(r[1]),E="",""===r[2]&&(E=" ",F++),1===t?(y=g+E+"hour"+s,p=!0,N=4-k[1].length):(y=g+E+"hours"+s,N=5-k[1].length,p=!0)),p||(w=S.match(x))&&(r=g.match(/(\d+)(\s*)$/))&&(t=parseInt(r[1]),E="",""===r[2]&&(E=" ",F++),1===t?(y=g+E+"second"+s,p=!0,N=6-w[1].length):(y=g+E+"seconds"+s,N=7-w[1].length,p=!0)))))),y.length>0?(h=ATTimeSpan.fromString(y),b=!0,0===h.years&&0===h.months&&0===h.days&&0===h.weeks&&0===h.hours&&0===h.minutes&&0===h.seconds&&(b=!1),new ATRangePositionSuggestion(b,h,y,new ATRange(F,N),h.toString())):new ATRangePositionSuggestion(!1,new ATTimeSpan(0,0,0,0,0,0,0),"0",new ATRange(F,0),"0")},ATRangeConversion.prototype.updateDateStringWithComponents=function(e,n,a){var r=a[0],t=a[1],i=a[2],o=a[3],s=this.calendar.updateStringWithComponents(e,n,r,t,i,o),p=this.valueForPartialString(s.text,!1);return new ATRangePositionSuggestion(p.matchFound,p.value,p.string,s.selectionRange,p.cleanText)},ATRangeConversion.prototype.updateNumberStringWithComponents=function(e,n,a){var r=a[0];return r?new ATRangePositionSuggestion(!0,r,String(r),new ATRange(n,0),String(r)):new ATRangePositionSuggestion(!1,r,e,new ATRange(n,0),e)},ATRangeConversion.prototype.incrementDateString=function(e,n,a){var r=this.calendar.incrementDateString(e,n,a),t=this.valueForPartialString(r.text,!1);return new ATRangePositionSuggestion(t.matchFound,t.value,r.text,r.selectionRange,t.cleanString)},ATRangeConversion.prototype.incrementNumberString=function(e,n,a){var r=parseInt(e)+a;return r?new ATRangePositionSuggestion(!0,r,String(r),new ATRange(n,0),String(r)):new ATRangePositionSuggestion(!1,r,e,new ATRange(n,0),e)},ATRangeConversion.prototype.nextComponentInDateString=function(e,n){var a=this.calendar.nextComponentInString(e,n);return new ATRangePositionSuggestion(!0,0,a.text,a.selectionRange,a.text)},ATRangeConversion.prototype.previousComponentInDateString=function(e,n){var a=this.calendar.previousComponentInString(e,n);return new ATRangePositionSuggestion(!0,0,a.text,a.selectionRange,a.text)},ATRangeConversion.prototype.nextComponentInNumberString=function(e,n){var a=parseInt(e);return a?new ATRangePositionSuggestion(!0,a,String(a),new ATRange(n,0),String(a)):new ATRangePositionSuggestion(!1,a,e,new ATRange(n,0),e)},ATRangeConversion.prototype.previousComponentInNumberString=function(e,n){var a=parseInt(e);return a?new ATRangePositionSuggestion(!0,a,String(a),new ATRange(n,0),String(a)):new ATRangePositionSuggestion(!1,a,e,new ATRange(n,0),e)},ATRangeConversion.prototype.calculateDateMarkerSpacing=function(e,n){var a,r,t,i,o,s,p={},m=n*e,T=this.calendar,u=-1!==T.timeFormat.indexOf("%I"),S=T.months.length,g=T.hoursInDay;if(m<30)return m<5?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):m<10?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):m<15?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):m<20?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),p.mainMarkerFormat=u?"%a %d %b %G %I:%M:%S%p":"%a %d %b %G %H:%M:%S",p.subMarkerFormat=u?"%I:%M:%S%p":"%H:%M:%S",p;if(m<1800)return m<60?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerFormat=u?"%I:%M:%S%p":"%H:%M:%S"):m<120?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerFormat=u?"%I:%M:%S%p":"%H:%M:%S"):m<300?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):m<600?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):m<900?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):m<1200?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"),p.mainMarkerFormat=u?"%a %d %b %G %I:%M%p":"%a %d %b %G %H:%M",p;if(m<T.secondsInDay/2){for(a=!1,s=1;s<g/2;s++)if(g%s==0&&m<3600*s){p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,s,0,0),p.subMarkerSpacing=1===s?new ATTimeSpan(0,0,0,0,0,15,0):s%2==0?new ATTimeSpan(0,0,0,0,s/2,0,0):s%3==0?new ATTimeSpan(0,0,0,0,s/3,0,0):new ATTimeSpan(0,0,0,0,s,0,0),a=!0;break}if(p.mainMarkerFormat=u?"%a %d %b %G %I:%M%p":"%a %d %b %G %H:00",p.subMarkerFormat=u?"%I:%M%p":"%H:%M",a)return p}if(m<=T.secondsInDay)return t=1,p.mainMarkerSpacing=new ATTimeSpan(0,0,0,t,0,0,0),p.mainMarkerFormat="%a %d %b %G %E",r=g,g%5==0?r=g/5:g%4==0?r=g/4:g%3==0?r=g/3:g%2==0&&(r=g/2),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,r,0,0),p.subMarkerFormat=u?"%I:00%p":"%H:00",p;if(m<T.secondsInWeek)return p.mainMarkerSpacing=new ATTimeSpan(0,0,1,0,0,0,0),p.mainMarkerFormat="%a %d %b %G %E",p.subMarkerFormat="%a",p.subMarkerSpacing=new ATTimeSpan(0,0,0,1,0,0,0),p;if(m<T.avgSecondsInYear/2){for(o=Math.ceil(m/T.avgSecondsInMonth),t=1;t<o;)do{t++}while(S%t!=0);return p.mainMarkerFormat="%b %G %E",p.subMarkerFormat="%b",p.mainMarkerSpacing=new ATTimeSpan(0,t,0,0,0,0,0),p.subMarkerSpacing=new ATTimeSpan(0,1,0,0,0,0,0),p}for(o=Math.ceil(m/T.avgSecondsInYear),t=1,i=1;t<o;){if((t*=2)>=o){i=4;break}if(t=5*t/2,i=5,t>=o)break;t*=2}return p.mainMarkerFormat="%G %E",p.mainMarkerSpacing=new ATTimeSpan(t,0,0,0,0,0,0),1===t?(p.subMarkerSpacing=S%4==0?new ATTimeSpan(0,S/4,0,0,0,0,0):S%3==0?new ATTimeSpan(0,S/3,0,0,0,0,0):S%2==0?new ATTimeSpan(0,S/2,0,0,0,0,0):new ATTimeSpan(0,S,0,0,0,0,0),p.subMarkerFormat="%b"):2===t?(p.subMarkerSpacing=new ATTimeSpan(1,0,0,0,0,0,0),p.subMarkerFormat="%g"):(p.subMarkerSpacing=new ATTimeSpan(t/i,0,0,0,0,0,0),p.subMarkerFormat="%g"),p},ATRangeConversion.prototype.calculateFloatingWeekMarkerSpacing=function(e,n){var a,r,t,i,o,s,p={},m=n*e,T=this.calendar,u=-1!==T.timeFormat.indexOf("%I"),S=T.hoursInDay;if(m<30)return m<5?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):m<10?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):m<15?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):m<20?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),p.mainMarkerFormat=u?"%a Week %Z %I:%M:%S%p":"%a Week %Z %H:%M:%S",p.subMarkerFormat=u?"%I:%M:%S%p":"%H:%M:%S",p;if(m<1800)return m<60?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),p.subMarkerFormat=u?"%I:%M:%S%p":"%H:%M:%S"):m<120?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),p.subMarkerFormat=u?"%I:%M:%S%p":"%H:%M:%S"):m<300?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):m<600?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):m<900?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):m<1200?(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"):(p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),p.subMarkerFormat=u?"%I:%M%p":"%H:%M"),p.mainMarkerFormat=u?"%a Week %Z %I:%M%p":"%a Week %Z %H:%M",p;if(m<T.secondsInDay/2){for(a=!1,s=1;s<S/2;s++)if(S%s==0&&m<3600*s){p.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,s,0,0),p.subMarkerSpacing=1===s?new ATTimeSpan(0,0,0,0,0,15,0):s%2==0?new ATTimeSpan(0,0,0,0,s/2,0,0):s%3==0?new ATTimeSpan(0,0,0,0,s/3,0,0):new ATTimeSpan(0,0,0,0,s,0,0),a=!0;break}if(p.mainMarkerFormat=u?"%a Week %Z %I:00%p":"%a Week %Z %H:00",p.subMarkerFormat=u?"%I:%M%p":"%H:%M",a)return p}if(m<=T.secondsInDay)return t=1,p.mainMarkerSpacing=new ATTimeSpan(0,0,0,t,0,0,0),p.mainMarkerFormat="%a Week %Z",r=S,S%5==0?r=S/5:S%4==0?r=S/4:S%3==0?r=S/3:S%2==0&&(r=S/2),p.subMarkerSpacing=new ATTimeSpan(0,0,0,0,r,0,0),p.subMarkerFormat=u?"%I:00%p":"%H:00",p;for(o=Math.ceil(m/T.secondsInWeek),t=1,i=1;t<o;){if((t*=2)>=o){i=4;break}if(t=5*t/2,i=5,t>=o)break;t*=2}return p.mainMarkerFormat="Week %Z",p.mainMarkerSpacing=new ATTimeSpan(0,0,t,0,0,0,0),1===t?(p.subMarkerSpacing=new ATTimeSpan(0,0,0,1,0,0,0),p.subMarkerFormat="%a"):(p.subMarkerSpacing=new ATTimeSpan(0,0,t/i,0,0,0,0),p.subMarkerFormat="Week %Z"),p},ATRangeConversion.prototype.calculateFloatingDayMarkerSpacing=function(e,n){var a,r,t,i,o,s={},p=n*e,m=this.calendar,T=-1!==m.timeFormat.indexOf("%I"),u=m.hoursInDay;if(p<30)return p<5?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):p<10?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):p<15?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):p<20?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),s.mainMarkerFormat=T?"Day %z %I:%M:%S%p":"Day %z %H:%M:%S",s.subMarkerFormat=T?"%I:%M:%S%p":"%H:%M:%S",s;if(p<1800)return p<60?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),s.subMarkerFormat=T?"%I:%M:%S%p":"%H:%M:%S"):p<120?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),s.subMarkerFormat=T?"%I:%M:%S%p":"%H:%M:%S"):p<300?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),s.subMarkerFormat=T?"%I:%M%p":"%H:%M"):p<600?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),s.subMarkerFormat=T?"%I:%M%p":"%H:%M"):p<900?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),s.subMarkerFormat=T?"%I:%M%p":"%H:%M"):p<1200?(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),s.subMarkerFormat=T?"%I:%M%p":"%H:%M"):(s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),s.subMarkerFormat=T?"%I:%M%p":"%H:%M"),s.mainMarkerFormat=T?"Day %z %I:%M%p":"Day %z %H:%M",s;if(p<m.secondsInDay/2){for(a=!1,o=1;o<u/2;o++)if(u%o==0&&p<3600*o){s.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,o,0,0),s.subMarkerSpacing=1===o?new ATTimeSpan(0,0,0,0,0,15,0):o%2==0?new ATTimeSpan(0,0,0,0,o/2,0,0):o%3==0?new ATTimeSpan(0,0,0,0,o/3,0,0):new ATTimeSpan(0,0,0,0,o,0,0),a=!0;break}if(s.mainMarkerFormat=T?"Day %z %I:00%p":"Day %z %H:00",s.endMarkerFormat=T?"%I:00%p":"%H:00",s.subMarkerFormat=T?"%I:%M%p":"%H:%M",a)return s}for(i=Math.ceil(p/m.secondsInDay),r=1,t=1;r<i;){if((r*=2)>=i){t=2===r?2:4;break}if(r=5*r/2,t=5,r>=i)break;r*=2}return s.mainMarkerFormat="Day %z",s.mainMarkerSpacing=new ATTimeSpan(0,0,0,r,0,0,0),1===r?(s.subMarkerSpacing=new ATTimeSpan(0,0,0,0,4,0,0),s.subMarkerFormat=T?"%I:00%p":"%H:00"):(s.subMarkerSpacing=new ATTimeSpan(0,0,0,r/t,0,0,0),s.subMarkerFormat="Day %z"),s},ATRangeConversion.prototype.calculateZeroHourMarkerSpacing=function(e,n){var a,r,t,i={},o=n*e;if(o<30)return o<5?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,1)):o<10?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,2)):o<15?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):o<20?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,20),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,5)):(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,10)),i.mainMarkerFormat="%x:%v:%u",i.subMarkerFormat="%x:%v:%u",i;if(o<1800)return o<60?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,15),i.subMarkerFormat="%x:%v:%u"):o<120?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,0,30),i.subMarkerFormat="%x:%v:%u"):o<300?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,1,0),i.subMarkerFormat="%x:%v"):o<600?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,2,0),i.subMarkerFormat="%x:%v"):o<900?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,15,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),i.subMarkerFormat="%x:%v"):o<1200?(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,20,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,5,0),i.subMarkerFormat="%x:%v"):(i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,0,30,0),i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),i.subMarkerFormat="%x:%v"),i.mainMarkerFormat="%x:%v",i;for(t=Math.ceil(o/3600),a=1,r=1;a<t;){if((a*=2)>=t){r=4;break}if(a=5*a/2,r=5,a>=t)break;a*=2}return i.mainMarkerFormat="%x:00",i.mainMarkerSpacing=new ATTimeSpan(0,0,0,0,a,0,0),1===a?(i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,0,10,0),i.subMarkerFormat="%x:%v"):(i.subMarkerSpacing=new ATTimeSpan(0,0,0,0,a/r,0,0),i.subMarkerFormat="%x:%v"),i},ATRangeConversion.prototype.calculateNumberMarkerSpacing=function(e,n){var a,r,t={},i=n*e;for(a=1,r=1;a<i;){if((a*=2)>=i){r=4;break}if(a=5*a/2,r=5,a>=i)break;a*=2}return t.mainMarkerFormat="",t.subMarkerFormat="",t.mainMarkerSpacing=a,t.subMarkerSpacing=1===a?.2:a/r,t},ATRangeConversion.prototype.dateLifetimeMarks=function(e,n,a,r,t,i,o,s){var p,m,T,u,S,g,c,A,M,l,d,k=n,w=s,h=this.calendar,b=r?ATUtilities.floatToInt(t/a):null,y=h.dateWithTimestamp(t),F=Math.max(t,e),f=ATUtilities.floatToInt(F/a),R=h.dateWithTimestamp(F),v=[],I=new ATTimeSpan(0,0,0,0,0,0,0),D=1;if(!r)return[];if(i&&(p=ATUtilities.floatToInt(o/a),o<k&&(k=o),F>o))return[];for(w.years*=2,w.months*=2,w.weeks*=2,w.days*=2,w.hours*=2,w.minutes*=2,w.seconds*=2,0!==w.years||h.yearsBetweenDates(y,R)>=2?(0===w.years&&(w=new ATTimeSpan(1,0,0,0,0,0,0)),D=w.years):0!==w.months||h.monthsBetweenDates(y,R)>=2?(0===w.months&&(w=new ATTimeSpan(0,1,0,0,0,0,0)),D=w.months):0!==w.weeks||h.weeksBetweenDates(y,R)>=2?(0===w.weeks&&(w=new ATTimeSpan(0,0,1,0,0,0,0)),D=w.weeks):0!==w.days||h.daysBetweenDates(y,R)>=2?(0===w.days&&(w=new ATTimeSpan(0,0,0,1,0,0,0)),D=w.days):0!==w.hours||h.hoursBetweenDates(y,R)>=2?(0===w.hours&&(w=new ATTimeSpan(0,0,0,0,1,0,0)),D=w.hours):0!==w.minutes||h.minutesBetweenDates(y,R)>=2?(0===w.minutes&&(w=new ATTimeSpan(0,0,0,0,0,1,0)),D=w.minutes):(0===w.seconds&&(w=new ATTimeSpan(0,0,0,0,0,0,1)),D=w.seconds),A=h.dateBeforeDateAtTimespanFromStart(R,w,y),M=ATUtilities.floatToInt(A.timestamp/a),0!==w.years?(m=h.yearsBetweenDates(y,A),I.years=m,T="year"):0!==w.months?(m=h.monthsBetweenDates(y,A),I.months=m,T="month"):0!==w.weeks?(m=h.weeksBetweenDates(y,A),I.weeks=m,T="week"):0!==w.days?(m=h.daysBetweenDates(y,A),I.days=m,T="day"):0!==w.hours?(m=h.hoursBetweenDates(y,A),I.hours=m,T="hour"):0!==w.minutes?(m=h.minutesBetweenDates(y,A),I.minutes=m,T="minute"):(m=h.secondsBetweenDates(y,A),I.seconds=m,T="second"),l=h.dateByAddingTimespanToDate(A,w),c=(d=ATUtilities.floatToInt(l.timestamp/a))-M,v=[],f>b&&c>4*TimelineDisplayConstants.lifetimeLabelMinGap&&d-f>2*TimelineDisplayConstants.lifetimeLabelMinGap&&(S=ATUtilities.floatToInt(f*a),g=h.dateWithTimestamp(S),u="("+(0!==w.years?h.yearsBetweenDates(y,g):0!==w.months?h.monthsBetweenDates(y,g):0!==w.weeks?h.weeksBetweenDates(y,g):0!==w.days?h.daysBetweenDates(y,g):0!==w.hours?h.hoursBetweenDates(y,g):0!==w.minutes?h.minutesBetweenDates(y,g):h.secondsBetweenDates(y,g))+" "+T+(1===m?"":"s")+")",v.push({xPosition:f,text:u,showDot:!1}));A.timestamp<k;)u=0===m?"Born":this.stringFromNumber(m)+" "+T+(1===m?"":"s"),l=h.dateByAddingTimespanToDate(A,w),(d=ATUtilities.floatToInt(l.timestamp/a))>p&&(d=p),M>=f&&d-M>TimelineDisplayConstants.lifetimeLabelMinGap&&v.push({xPosition:M,text:u,showDot:!0}),A=l,M=ATUtilities.floatToInt(A.timestamp/a),m+=D;return o<=k&&v.push({xPosition:p,text:"Died",showDot:!0}),v},ATRangeConversion.prototype.numberLifetimeMarks=function(e,n,a,r,t,i,o,s){var p,m,T,u,S,g,c,A=n,M=s,l=o/a,d=Math.max(t,e),k=ATUtilities.floatToInt(d/a),w=[];if(!r)return[];if(i&&(o<A&&(A=o),d>o))return[];for(M*=2,c=this.decimalPlaces(M),T=t+(p=ATUtilities.floatToInt((d-t)/M)*M),u=ATUtilities.floatToInt(T/a),S=T+M,g=ATUtilities.floatToInt(S/a),w=[];T<A;)m=0===p?"0":this.stringFromRoundedNumber(p,c),S=T+M,(g=ATUtilities.floatToInt(S/a))>l&&(g=l),u>=k&&g-u>TimelineDisplayConstants.lifetimeLabelMinGap&&w.push({xPosition:u,text:m,showDot:!0}),T=S,u=ATUtilities.floatToInt(T/a),p+=M;return o<=A&&w.push({xPosition:l,text:"Died",showDot:!0}),w},ATRangeConversion.prototype.dateLabelsBetweenBounds=function(e,n,a,r,t,i){var o,s,p=this.calendar,m=p.dateWithTimestamp(e),T=p.dateAtEvenTimespanBeforeDate(m,r),u=p.dateByAddingTimespanToDate(T,r),S=null,g=[];for(p.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME&&u.eraIndex!==T.eraIndex&&(u=p.dateAtEvenTimespanBeforeDate(u,r));T.timestamp<=n;)o=ATUtilities.floatToInt(T.timestamp/a),s=p.stringFromDate(T,t),g.push({xPosition:o,text:s}),T=u,u=p.dateByAddingTimespanToDate(u,r),p.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME&&u.eraIndex!==T.eraIndex&&(S=p.dateAtEvenTimespanBeforeDate(u,r)).timestamp!==T.timestamp&&(u=S);return g},ATRangeConversion.prototype.numberLabelsBetweenBounds=function(e,n,a,r,t,i){var o,s,p,m=ATUtilities.floatToInt(e/r)*r,T=m+r,u=[];for(p=this.decimalPlaces(r);m<=n;)o=ATUtilities.floatToInt(m/a),s=this.stringFromRoundedNumber(m,p),u.push({xPosition:o,text:s}),m=T,T+=r;return u},module.exports=ATRangeConversion;

},{"../controller/ATDisplayConstants":16,"../model/ATCalendarType":22,"../model/ATTimeSpan":39,"../model/ATTimeUnit":40,"../utils/ATRange":47,"../utils/ATUtilities":51,"./ATRangePositionSuggestion":20,"lodash":333}],20:[function(require,module,exports){
var ATRangePositionSuggestion=function(i,t,n,s,o){this.matchFound=i,this.value=t,this.string=n,this.selection=s,this.cleanString=o};module.exports=ATRangePositionSuggestion;

},{}],21:[function(require,module,exports){
var _=require("lodash"),ATTimeUnit=require("./ATTimeUnit"),ATTimeSpan=require("./ATTimeSpan"),ATUtilities=require("../utils/ATUtilities"),ATEra=require("./ATEra"),ATMonth=require("./ATMonth"),ATWeekday=require("./ATWeekday"),ATDate=require("./ATDate"),ATRange=require("../utils/ATRange"),ATDateStringMatchResult=require("../controller/ATDateStringMatchResult"),ATCalendarType=require("./ATCalendarType"),ATDateOrder=require("./ATDateOrder"),ATStringSelection=require("../utils/ATStringSelection"),matchWithPseudoBoundary=function(e,t){var n=t.match(e);return n?{index:n.index+n[1]?n[1].length:0,length:n[2]?n[2].length:0,0:n[2],1:n[3]}:null},ATCalendar=function(e,t,n,a,i,o){var s,r=0,h=0,g=[],l=[],m=[],d=[];for(this.eras=e,this.months=t,this.weekdays=n,this.weekdayIndexAtZero=i,this.hoursInDay=a,this.maximumDaysInAnyMonth=0,s=0;s<this.months.length;s++)this.months[s].normalDuration>this.maximumDaysInAnyMonth&&(this.maximumDaysInAnyMonth=this.months[s].normalDuration),this.months[s].leapDuration>this.maximumDaysInAnyMonth&&(this.maximumDaysInAnyMonth=this.months[s].leapDuration);_.each(this.months,function(e){g.push(r),l.push(h),r+=e.normalDuration,h+=e.leapDuration}),this.daysInNormalYear=r,this.daysInLeapYear=h,this.monthStartsInNormalYear=g,this.monthStartsInLeapYear=l,this.isStandardMonths=this._isStandardMonths(),this.daysIn400Years=303*r+97*h,this.daysIn100Years=76*r+24*h,this.daysIn4Years=3*r+h,this.secondsInDay=3600*a,this.secondsInWeek=this.secondsInDay*this.weekdays.length,this.avgDaysInYear=ATUtilities.floatToInt(this.daysIn400Years/400),this.avgDaysInMonth=ATUtilities.floatToInt(this.avgDaysInYear/this.months.length),this.avgSecondsInYear=this.avgDaysInYear*this.secondsInDay,this.avgSecondsInMonth=this.avgDaysInMonth*this.secondsInDay,_.each(this.eras,function(e){var t=e.duration*r;e.hasLeap&&(t+=(ATUtilities.floatToInt(e.duration/4)-ATUtilities.floatToInt(e.duration/100)+ATUtilities.floatToInt(e.duration/400))*(h-r)),m.push(t),d.push(t*a*3600)}),this.daysInEra=m,this.secondsInEra=d,o?this.setZeroDate(this.dateWithTimestamp(o)):this.setZeroDate(this.dateWithTimestamp(0)),this.calendarType=ATCalendarType.CALENDAR_TYPE_DATE_TIME,this.dayNameFormat="%A",this.dateOrder="%d/%m/%Y",this.dateFormat="%d %B %Y",this.timeFormat="%H:%M:%S",this.monthFormat="%B %Y",this.buildRegularExpressions()};ATCalendar.prototype.DefaultCalendar=function(){var e,t,n=[],a=[],i=[],o=Math.pow(2,53)-1;return n.push(new ATEra(0,"BC","BC",o,!0,!1)),n.push(new ATEra(1,"AD","AD",o,!1,!0)),a.push(new ATMonth(0,"January","Jan",31,31)),a.push(new ATMonth(1,"February","Feb",28,29)),a.push(new ATMonth(2,"March","Mar",31,31)),a.push(new ATMonth(3,"April","Apr",30,30)),a.push(new ATMonth(4,"May","May",31,31)),a.push(new ATMonth(5,"June","Jun",30,30)),a.push(new ATMonth(6,"July","Jul",31,31)),a.push(new ATMonth(7,"August","Aug",31,31)),a.push(new ATMonth(8,"September","Sep",30,30)),a.push(new ATMonth(9,"October","Oct",31,31)),a.push(new ATMonth(10,"November","Nov",30,30)),a.push(new ATMonth(11,"December","Dec",31,31)),i.push(new ATWeekday(0,"Sunday","Sun")),i.push(new ATWeekday(1,"Monday","Mon")),i.push(new ATWeekday(2,"Tuesday","Tue")),i.push(new ATWeekday(3,"Wednesday","Wed")),i.push(new ATWeekday(4,"Thursday","Thu")),i.push(new ATWeekday(5,"Friday","Fri")),i.push(new ATWeekday(6,"Saturday","Sat")),e=new ATCalendar(n,a,i,24,1),63460972800,t=e.dateWithTimestamp(63460972800),e.setZeroDate(t),e},ATCalendar.prototype.isStandardCalendar=function(){return this._isStandardMonths()&&7===this.weekdays.length&&24===this.hoursInDay&&2===this.eras.length},ATCalendar.prototype.setZeroDate=function(e){this.zeroDate=e.copy(),this.zeroDateTS=this.zeroDate.timestamp},ATCalendar.prototype.setCalendarType=function(e){this.calendarType=e},ATCalendar.prototype.dateWithComponents=function(e,t,n,a,i,o,s,r){var h=new ATDate(0,e,t,n,a,i,o,s,0,r);return r&&r<ATTimeUnit.MONTH&&(h.month=this.firstMonthOfYear(e,t)),r&&r<ATTimeUnit.WEEK&&(h.day=1),r&&r<ATTimeUnit.HOUR&&(h.hour=0),r&&r<ATTimeUnit.MINUTE&&(h.minute=0),r&&r<ATTimeUnit.SECOND&&(h.second=0),this.calculateTimestampForDate(h),this.calculateWeekdayForDate(h),r&&r===ATTimeUnit.WEEK?this.dateAtEvenTimespanBeforeDate(h,new ATTimeSpan(0,0,1,0,0,0,0)):(r||(0!==h.second?h.precision=ATTimeUnit.SECOND:0!==h.minute?h.precision=ATTimeUnit.MINUTE:0!==h.hour?h.precision=ATTimeUnit.HOUR:1!==h.day?h.precision=ATTimeUnit.DAY:h.month!==this.firstMonthOfYear(e,t)?h.precision=ATTimeUnit.MONTH:h.precision=ATTimeUnit.YEAR),h)},ATCalendar.prototype.timestampForNow=function(){var e;return this.calendarType!==ATCalendarType.CALENDAR_TYPE_DATE_TIME?this.zeroDateTS:this.isStandardCalendar()?(e=new Date,this.dateWithComponents(this.eras.length-1,e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),ATTimeUnit.SECOND).timestamp+e.getMilliseconds()/1e3):null},ATCalendar.prototype.timestampForToday=function(){var e;return this.calendarType!==ATCalendarType.CALENDAR_TYPE_DATE_TIME?this.zeroDateTS:this.isStandardCalendar()?(e=new Date,this.dateWithComponents(this.eras.length-1,e.getFullYear(),e.getMonth()+1,e.getDate(),0,0,0,ATTimeUnit.DAY).timestamp):null},ATCalendar.prototype.dateForNow=function(){var e;return this.isStandardCalendar()?(e=new Date,this.dateWithComponents(this.eras.length-1,e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),ATTimeUnit.SECOND)):null},ATCalendar.prototype.dateWithTimestamp=function(e,t){var n=new ATDate(Math.round(e),0,0,0,0,0,0,0,0,t),a=!1;return isNaN(e)?n:(this.calculateComponentsForDate(n),t&&t<ATTimeUnit.MONTH&&(a=!0,n.month=1),t&&t<ATTimeUnit.WEEK&&(a=!0,n.day=1),t&&t<ATTimeUnit.HOUR&&(a=!0,n.hour=0),t&&t<ATTimeUnit.MINUTE&&(a=!0,n.minute=0),t&&t<ATTimeUnit.SECOND&&(a=!0,n.second=0),a&&this.calculateTimestampForDate(n),this.calculateWeekdayForDate(n),t&&t===ATTimeUnit.WEEK&&0!==n.weekdayIndex?this.dateAtEvenTimespanBeforeDate(n,new ATTimeSpan(0,0,1,0,0,0,0)):(t||(0!==n.second?n.precision=ATTimeUnit.SECOND:0!==n.minute?n.precision=ATTimeUnit.MINUTE:0!==n.hour?n.precision=ATTimeUnit.HOUR:1!==n.day?n.precision=ATTimeUnit.DAY:1!==n.month?n.precision=ATTimeUnit.MONTH:n.precision=ATTimeUnit.YEAR),n))},ATCalendar.prototype.dateByAddingTimespanToDate=function(e,t){var n=e.copy(),a=this.months.length,i=t.years+ATUtilities.floatToInt(t.months/a),o=t.months%a,s=60*(60*((t.weeks*this.weekdays.length+t.days)*this.hoursInDay+t.hours)+t.minutes)+t.seconds,r=t.toPrecision();if(0!==i||0!==o){if(n.month=n.month+o,n.month<=0?(--i,n.month+=a):n.month>a&&(++i,n.month=(n.month-1)%a+1),0!==i&&this._addYearsToDate(n,i),!0===this.isLeapYearInEra(n.year,n.eraIndex)){if(n.day>this.months[n.month-1].leapDuration&&(n.day=1,n.month++,n.month<=this.months.length))for(;this.months[n.month-1].leapDuration<=0&&(n.month++,!(n.month>this.months.length)););}else if(n.day>this.months[n.month-1].normalDuration&&(n.day=1,n.month++,n.month<=this.months.length))for(;this.months[n.month-1].normalDuration<=0&&(n.month++,!(n.month>this.months.length)););n.month>this.months.length&&(this.eras[n.eraIndex].isBackwards?n.year--:n.year++,(n.year>this.eras[n.eraIndex].duration||n.year<=0)&&(n.eraIndex++,this.eras[n.eraIndex].isBackwards?n.year=this.eras[n.eraIndex].duration:n.year=1),n.month=this.firstMonthOfYear(n.eraIndex,n.year)),this.calculateTimestampForDate(n)}return n.timestamp+=s,this.calculateComponentsForDate(n),this.calculateWeekdayForDate(n),n.precision=Math.max(e.precision,r),n},ATCalendar.prototype.dateByAddingTimespanToDateWithPrecision=function(e,t,n){var a=e.copy(),i=this.months.length,o=t.years+ATUtilities.floatToInt(t.months/i),s=t.months%i,r=60*(60*((t.weeks*this.weekdays.length+t.days)*this.hoursInDay+t.hours)+t.minutes)+t.seconds;if(0!==o||0!==s){if(a.month=a.month+s,a.month<=0?(--o,a.month+=i):a.month>i&&(++o,a.month=(a.month-1)%i+1),0!==o&&this._addYearsToDate(a,o),this.isLeapYearInEra(a.year,a.eraIndex)){if(a.day>this.months[a.month-1].leapDuration&&(a.day=1,a.month++,a.month<=this.months.length))for(;this.months[a.month-1].normalDuration<=0&&(a.month++,!(a.month>this.months.length)););}else if(a.day>this.months[a.month-1].normalDuration&&(a.day=1,a.month++,a.month<=this.months.length))for(;this.months[a.month-1].leapDuration<=0&&(a.month++,!(a.month>this.months.length)););a.month>this.months.length&&(this.eras[a.eraIndex].isBackwards?a.year--:a.year++,(a.year>this.eras[a.eraIndex].duration||a.year<=0)&&(a.eraIndex++,this.eras[a.eraIndex].isBackwards?a.year=this.eras[a.eraIndex].duration:a.year=1),a.month=this.firstMonthOfYear(a.eraIndex,a.year)),this.calculateTimestampForDate(a)}return a.timestamp+=r,this.calculateComponentsForDate(a),this.calculateWeekdayForDate(a),a.precision=n,a},ATCalendar.prototype.dateAtEvenTimespanBeforeDate=function(e,t){var n,a,i,o,s;if(this.calendarType!==ATCalendarType.CALENDAR_TYPE_DATE_TIME){if(t.weeks>0)return n=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-e.weekdayIndex,-e.hour,-e.minute,-e.second)),this.zeroDate&&(this.zeroDate.timestamp<=n.timestamp?(i=this.weeksBetweenDates(this.zeroDate,n),i=ATUtilities.floatToInt(i/t.weeks)*t.weeks):(i=this.weeksBetweenDates(this.zeroDate,n)-1,i=ATUtilities.floatToInt(i/t.weeks)*t.weeks-t.weeks),n=this.dateByAddingTimespanToDate(this.zeroDate,new ATTimeSpan(0,0,i,0,0,0,0))),n.precision=ATTimeUnit.WEEK,n;if(t.days>0)return n=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,0,-e.hour,-e.minute,-e.second)),this.zeroDate&&(this.zeroDate.timestamp<=n.timestamp?(o=this.daysBetweenDates(this.zeroDate,n),o=ATUtilities.floatToInt(o/t.days)*t.days):(o=this.daysBetweenDates(this.zeroDate,n)-1,o=ATUtilities.floatToInt(o/t.days)*t.days-t.days),n=this.dateByAddingTimespanToDate(this.zeroDate,new ATTimeSpan(0,0,0,o,0,0,0))),n.precision=ATTimeUnit.DAY,n;if(t.hours>0){if(n=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,0,0,-e.minute,-e.second)),this.calendarType!==ATCalendarType.CALENDAR_TYPE_HOUR_TIME)return n.hour=ATUtilities.floatToInt(n.hour/t.hours)*t.hours,n.minute=0,n.second=0,n.precision=ATTimeUnit.HOUR,this.calculateTimestampForDate(n),this.calculateWeekdayForDate(n),n;if(this.zeroDate)return this.zeroDate.timestamp<=n.timestamp?(s=this.hoursBetweenDates(this.zeroDate,n),s=ATUtilities.floatToInt(s/t.hours)*t.hours):(s=this.hoursBetweenDates(this.zeroDate,n)-1,s=ATUtilities.floatToInt(s/t.hours)*t.hours-t.hours),n=this.dateByAddingTimespanToDate(this.zeroDate,new ATTimeSpan(0,0,0,0,s,0,0)),n.precision=ATTimeUnit.HOUR,n}}return t.weeks>0?(n=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-e.weekdayIndex,-e.hour,-e.minute,-e.second)),n.precision=ATTimeUnit.WEEK,n):(n=e.copy(),t.seconds>0?(n.second=ATUtilities.floatToInt(n.second/t.seconds)*t.seconds,a=ATTimeUnit.SECOND):t.minutes>0?(n.minute=ATUtilities.floatToInt(n.minute/t.minutes)*t.minutes,n.second=0,a=ATTimeUnit.MINUTE):t.hours>0?(n.hour=ATUtilities.floatToInt(n.hour/t.hours)*t.hours,n.minute=0,n.second=0,a=ATTimeUnit.HOUR):t.days>0?(n.day=ATUtilities.floatToInt((n.day-1)/t.days)*t.days+1,n.hour=0,n.minute=0,n.second=0,a=ATTimeUnit.DAY):t.months>0?(n.month=ATUtilities.floatToInt((n.month-1)/t.months)*t.months+1,n.day=1,n.hour=0,n.minute=0,n.second=0,a=ATTimeUnit.MONTH):t.years>0&&(this.eras[n.eraIndex].isBackwards?n.year=Math.ceil(n.year/t.years)*t.years:n.year=ATUtilities.floatToInt((n.year-1)/t.years)*t.years+1,n.month=this.firstMonthOfYear(n.eraIndex,n.year),n.day=1,n.hour=0,n.minute=0,n.second=0,a=ATTimeUnit.YEAR),this.calculateTimestampForDate(n),this.calculateWeekdayForDate(n),n.precision=a,n)},ATCalendar.prototype.dateBeforeDateAtTimespanFromStart=function(e,t,n){var a,i=t.copy();return 0!==i.years?(a=this.yearsBetweenDates(n,e),i.years=ATUtilities.floatToInt(a/i.years)*i.years):0!==i.months?(a=this.monthsBetweenDates(n,e),i.months=ATUtilities.floatToInt(a/i.months)*i.months):0!==i.weeks?(a=this.weeksBetweenDates(n,e),i.weeks=ATUtilities.floatToInt(a/i.weeks)*i.weeks):0!==i.days?(a=this.daysBetweenDates(n,e),i.days=ATUtilities.floatToInt(a/i.days)*i.days):0!==i.hours?(a=this.hoursBetweenDates(n,e),i.hours=ATUtilities.floatToInt(a/i.hours)*i.hours):0!==i.minutes?(a=this.minutesBetweenDates(n,e),i.minutes=ATUtilities.floatToInt(a/i.minutes)*i.minutes):0!==i.seconds&&(a=this.secondsBetweenDates(n,e),i.seconds=ATUtilities.floatToInt(a/i.seconds)*i.seconds),this.dateByAddingTimespanToDate(n,i)},ATCalendar.prototype.isValidDate=function(e){var t,n,a,i;return!(e.eraIndex<0||e.eraIndex>=this.eras.length)&&(t=this.eras[e.eraIndex],!(e.year<=0||e.year>t.duration)&&(!(e.month<=0||e.month>this.months.length)&&(n=this.months[e.month-1],a=this.isLeapYearInEra(e.year,e.eraIndex),i=a?n.leapDuration:n.normalDuration,!(e.day<=0||e.day>i)&&(!(e.hour<0||e.hour>=this.hoursInDay)&&(!(e.minute<0||e.minute>=60)&&!(e.second<0||e.second>=60))))))},ATCalendar.prototype.isValidDateComponents=function(e,t,n,a,i,o,s){var r,h,g,l;return!(e<0||e>this.eras.length)&&(r=this.eras[e],!(t<=0||t>r.duration)&&(!(n<=0||n>this.months.length)&&(h=this.months[n-1],g=this.isLeapYearInEra(t,e),l=g?h.leapDuration:h.normalDuration,!(a<=0||a>l)&&(!(i<0||i>this.hoursInDay)&&((i!==this.hoursInDay||0===o&&0===s)&&(!(o<0||o>=60)&&!(s<0||s>=60)))))))},ATCalendar.prototype.timespanForPrecision=function(e){var t=e===ATTimeUnit.YEAR?1:0,n=e===ATTimeUnit.MONTH?1:0,a=e===ATTimeUnit.WEEK?1:0,i=e===ATTimeUnit.DAY?1:0,o=e===ATTimeUnit.HOUR?1:0,s=e===ATTimeUnit.MINUTE?1:0,r=e===ATTimeUnit.SECOND?1:0;return new ATTimeSpan(t,n,a,i,o,s,r)},ATCalendar.prototype.roundedTimespanForSecondsAtScale=function(e,t){var n=this.roundedTimespanForScale(t);return 0!==n.years?n.years=Math.round(e/this.avgSecondsInYear/n.years)*n.years:0!==n.months?n.months=Math.round(e/this.avgSecondsInMonth/n.months)*n.months:0!==n.weeks?n.weeks=Math.round(e/this.secondsInWeek/n.weeks)*n.weeks:0!==n.days?n.days=Math.round(e/this.secondsInDay/n.days)*n.days:0!==n.hours?n.hours=Math.round(e/3600/n.hours)*n.hours:0!==n.minutes?n.minutes=Math.round(e/60/n.minutes)*n.minutes:0!==n.seconds&&(n.seconds=Math.round(e/n.seconds)*n.seconds),n},ATCalendar.prototype.roundedTimespanForScale=function(e){var t,n,a=10*e,i=this.hoursInDay/2,o=this.weekdays.length,s=o/2,r=ATUtilities.floatToInt(this.avgDaysInMonth/o)/2,h=this.months.length,g=h/2;if(a<=30)return t=e,n=t<=1?1:t<=2?2:t<=5?5:t<=10?10:t<=15?15:30,new ATTimeSpan(0,0,0,0,0,0,n);if(a<=1800)return t=e/60,n=t<=1?1:t<=2?2:t<=5?5:t<=10?10:t<=15?15:30,new ATTimeSpan(0,0,0,0,0,n,0);if(a<=3600*i){for(t=e/3600,n=1;n<i&&!(this.hoursInDay%n==0&&t<n);n++);if(this.hoursInDay%n==0)return new ATTimeSpan(0,0,0,0,n,0,0)}if(a<=s*this.secondsInDay){for(t=e/this.secondsInDay,n=1;n<i&&!(t<n);n++);return new ATTimeSpan(0,0,0,n,0,0,0)}if(a<=r*this.secondsInWeek){for(t=e/this.secondsInWeek,n=1;n<r&&!(t<n);n++);return new ATTimeSpan(0,0,n,0,0,0,0)}if(a<=g*this.avgSecondsInMonth){for(t=e/this.avgSecondsInMonth,n=1;n<g&&!(h%n==0&&t<n);n++);return new ATTimeSpan(0,n,0,0,0,0,0)}for(t=e/this.avgSecondsInYear,n=1;t>n&&!((n*=2)>=t)&&!((n=5*n/2)>=t);)n*=2;return new ATTimeSpan(n,0,0,0,0,0,0)},ATCalendar.prototype.timespanBetweenDates=function(e,t){var n,a=0,i=0,o=0,s=0,r=0,h=0,g=0,l=e.copy();if(this.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME){if(a=this.yearsBetweenDates(e,t),n=new ATTimeSpan(a,0,0,0,0,0,0),(l=this.dateByAddingTimespanToDate(e,n)).timestamp===t.timestamp)return n;if(i=this.monthsBetweenDates(l,t),n=new ATTimeSpan(a,i,0,0,0,0,0),(l=this.dateByAddingTimespanToDate(e,n)).timestamp===t.timestamp)return n}return this.calendarType<=ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME&&(o=this.weeksBetweenDates(l,t),n=new ATTimeSpan(a,i,o,0,0,0,0),(l=this.dateByAddingTimespanToDate(e,n)).timestamp===t.timestamp)?n:this.calendarType<=ATCalendarType.CALENDAR_TYPE_DAY_TIME&&(s=this.daysBetweenDates(l,t),n=new ATTimeSpan(a,i,o,s,0,0,0),(l=this.dateByAddingTimespanToDate(e,n)).timestamp===t.timestamp)?n:(r=this.hoursBetweenDates(l,t),n=new ATTimeSpan(a,i,o,s,r,0,0),(l=this.dateByAddingTimespanToDate(e,n)).timestamp===t.timestamp?n:(h=this.minutesBetweenDates(l,t),n=new ATTimeSpan(a,i,o,s,r,h,0),(l=this.dateByAddingTimespanToDate(e,n)).timestamp===t.timestamp?n:(g=this.secondsBetweenDates(l,t),new ATTimeSpan(a,i,o,s,r,h,g))))},ATCalendar.prototype.yearsBetweenDates=function(e,t){return ATUtilities.floatToInt(this.monthsBetweenDates(e,t)/this.months.length)},ATCalendar.prototype.monthsBetweenDates=function(e,t){var n,a,i,o,s,r=this.months.length;if(t.timestamp<e.timestamp)return-this.monthsBetweenDates(t,e);if(e.eraIndex===t.eraIndex)return n=this.calculateMonthsSinceEraStart(e),a=this.calculateMonthsSinceEraStart(t),0!==(i=a-n)&&(this.eras[e.eraIndex].isBackwards&&(i=-i),t.day<e.day?--i:t.day===e.day&&(t.hour<e.hour?--i:t.hour===e.hour&&(t.minute<e.minute?--i:t.minute===e.minute&&t.second<e.second&&--i))),i;for(i=-(e.month-1),this.eras[e.eraIndex].isBackwards?i+=e.year*r:i+=(this.eras[e.eraIndex].duration-e.year+1)*r,1===e.day&&0===e.hour&&0===e.minute&&0===e.second||--i,o=e.eraIndex+1;o<t.eraIndex;o++)i+=this.eras[o].duration*r;for(this.eras[t.eraIndex].isBackwards?i+=(this.eras[t.eraIndex].duration-t.year)*r:i+=(t.year-1)*r,i+=t.month-1,o=0;o<2&&(s=new ATTimeSpan(0,i+1,0,0,0,0,0),!(this.dateByAddingTimespanToDate(e,s).timestamp>t.timestamp));o++)i++;return i},ATCalendar.prototype.weeksBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/(this.weekdays.length*this.hoursInDay*3600))},ATCalendar.prototype.daysBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/(3600*this.hoursInDay))},ATCalendar.prototype.hoursBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/3600)},ATCalendar.prototype.minutesBetweenDates=function(e,t){return ATUtilities.floatToInt(this.secondsBetweenDates(e,t)/60)},ATCalendar.prototype.secondsBetweenDates=function(e,t){return t.timestamp-e.timestamp},ATCalendar.prototype.calculateTimestampForDate=function(e){var t,n,a,i,o=this.eras.length,s=0;if(e.eraIndex===this.eras.length-1)s=this.calculateDaysSinceEraStartForDateComponents(e);else{for(t=o-2;t>e.eraIndex;t--)s-=this.daysInEra[t];!1===this.eras[e.eraIndex].isBackwards?(s-=this.daysInEra[e.eraIndex],s+=this.calculateDaysSinceEraStartForDateComponents(e)):s-=this.calculateDaysSinceEraStartForDateComponents(e)}e.timestamp=s*this.hoursInDay*3600,e.eraIndex===o-1?e.timestamp+=3600*e.hour+60*e.minute+e.second:this.eras[e.eraIndex].isBackwards?(n=this.hoursInDay-e.hour,0===e.minute&&0===e.second||(n-=1),a=60-e.minute,0!==e.second&&(a-=1),i=60-e.second,n===this.hoursInDay&&(n=0),60===a&&(a=0),60===i&&(i=0),e.timestamp-=3600*n+60*a+i):0===e.hour&&0===e.minute&&0===e.second||(e.timestamp+=3600*e.hour+60*e.minute+e.second)},ATCalendar.prototype.calculateComponentsForDate=function(e){var t,n,a,i,o,s,r,h,g,l,m,d,c,u,T,y=3600*this.hoursInDay;if(0===e.timestamp)e.eraIndex=this.eras.length-1,e.year=1,e.month=1,e.day=1,e.hour=0,e.minute=0,e.second=0;else if(e.timestamp>0)e.eraIndex=this.eras.length-1,e.year=1,e.month=1,e.day=1,t=e.timestamp%y,e.hour=ATUtilities.floatToInt(t/3600),t%=3600,e.minute=ATUtilities.floatToInt(t/60),e.second=t%60,n=ATUtilities.floatToInt(e.timestamp/y),this.eras[e.eraIndex].hasLeap&&this.daysInNormalYear!==this.daysInLeapYear?this.isStandardMonths?(i=this._toDaysSinceCalcZero(!0,e.year,e.month,e.day)+n,this._fromDaysSinceCalcZero(i,!0,e)):(e.year+=400*ATUtilities.floatToInt(n/this.daysIn400Years),a=n%this.daysIn400Years,(T=ATUtilities.floatToInt(a/this.daysIn100Years))<4?(e.year+=100*T,a%=this.daysIn100Years):(e.year+=100*(T-1),a-=(T-1)*this.daysIn100Years),e.year+=4*ATUtilities.floatToInt(a/this.daysIn4Years),(a%=this.daysIn4Years)<3*this.daysInNormalYear?(e.year+=ATUtilities.floatToInt(a/this.daysInNormalYear),a%=this.daysInNormalYear):(e.year+=3,a-=3*this.daysInNormalYear),(u=this.isLeapYearInEra(e.year,e.eraIndex))?this._calcMonthAndDayForDaysIntoLeapYear(e,a):this._calcMonthAndDayForDaysIntoNormalYear(e,a)):(e.year+=ATUtilities.floatToInt(n/this.daysInNormalYear),(a=n%this.daysInNormalYear)>0&&(!0===(u=this.isLeapYearInEra(e.year,e.eraIndex))?this._calcMonthAndDayForDaysIntoLeapYear(e,a):this._calcMonthAndDayForDaysIntoNormalYear(e,a)));else{for(o=-e.timestamp,s=this.eras.length-2,r=this.secondsInEra[s];s>0&&o>r;)o-=r,s--,r=this.secondsInEra[s];h=r/y,e.eraIndex=s,(l=this.eras[e.eraIndex]).isBackwards?(l.hasLeap?(g=0,m=0,(n=ATUtilities.floatToInt(o/y))>=this.daysIn400Years&&(g+=d=400*ATUtilities.floatToInt(n/this.daysIn400Years),n-=(c=ATUtilities.floatToInt(d/400))*this.daysIn400Years,m+=c*this.daysIn400Years*y),n>=this.daysIn100Years&&(g+=d=100*ATUtilities.floatToInt(n/this.daysIn100Years),n-=(c=ATUtilities.floatToInt(d/100))*this.daysIn100Years,m+=c*this.daysIn100Years*y),n>=this.daysIn4Years&&(g+=d=4*ATUtilities.floatToInt(n/this.daysIn4Years),n-=(c=ATUtilities.floatToInt(d/4))*this.daysIn4Years,m+=c*this.daysIn4Years*y),n<=3*this.daysInNormalYear?(g+=d=ATUtilities.floatToInt(n/this.daysInNormalYear),m+=d*this.daysInNormalYear*y):(g+=3,m+=3*this.daysInNormalYear*y),e.year=g,0===(o-=m)?(e.month=1,e.day=1):(e.year+=1,a=ATUtilities.floatToInt(o/y),(u=this.isLeapYearInEra(e.year,e.eraIndex))?this._calcMonthAndDayForDaysIntoLeapYearNegative(e,a):this._calcMonthAndDayForDaysIntoNormalYearNegative(e,a),o-=m=a*y)):(n=ATUtilities.floatToInt(o/y),g=ATUtilities.floatToInt(n/this.daysInNormalYear),e.year=g,0===(o-=g*this.daysInNormalYear*y)?(e.month=1,e.day=1):(e.year+=1,o-=(a=ATUtilities.floatToInt(o/y))*y,this._calcMonthAndDayForDaysIntoNormalYearNegative(e,a))),0===o?(e.hour=0,e.minute=0,e.second=0):(e.day-=1,0===e.day&&(e.month-=1,0===e.month&&(e.year-=1,0===e.year&&(e.eraIndex--,this.eras[e.eraIndex].isBackwards()?e.year=1:e.year=this.eras[e.eraIndex].duration()),e.month=this.months.length),u=this.isLeapYearInEra(e.year,e.eraIndex),e.day=u?this.months[e.month-1].leapDuration:this.months[e.month-1].normalDuration),e.hour=this.hoursInDay-ATUtilities.floatToInt(o/3600)-1,0===(o%=3600)?(e.minute=0,e.second=0,e.hour++):(e.minute=60-ATUtilities.floatToInt(o/60)-1,0===(o%=60)?(e.second=0,e.minute++):e.second=60-o))):(n=h-ATUtilities.floatToInt(o/y),o%y!=0&&n--,l.hasLeap?(g=0,m=0,n>=this.daysIn400Years&&(g+=d=400*ATUtilities.floatToInt(n/this.daysIn400Years),n-=(c=ATUtilities.floatToInt(d/400))*this.daysIn400Years,m+=c*this.daysIn400Years*y),n>=this.daysIn100Years&&(g+=d=100*ATUtilities.floatToInt(n/this.daysIn100Years),n-=(c=ATUtilities.floatToInt(d/100))*this.daysIn100Years,m+=c*this.daysIn100Years*y),n>=this.daysIn4Years&&(g+=d=4*ATUtilities.floatToInt(n/this.daysIn4Years),n-=(c=ATUtilities.floatToInt(d/4))*this.daysIn4Years,m+=c*this.daysIn4Years*y),n<=3*this.daysInNormalYear?(g+=d=ATUtilities.floatToInt(n/this.daysInNormalYear),m+=d*this.daysInNormalYear*y):(g+=3,m+=3*this.daysInNormalYear*y),e.year=g+1,0===(o=(m=r-m)-o)?(e.month=1,e.day=1):(a=ATUtilities.floatToInt(o/y),!0===(u=this.isLeapYearInEra(e.year,e.eraIndex))?this._calcMonthAndDayForDaysIntoLeapYear(e,a):this._calcMonthAndDayForDaysIntoNormalYear(e,a),o-=m=a*y)):(g=ATUtilities.floatToInt(n/this.daysInNormalYear),e.year=g+1,0===(o=(m=r-(m=g*this.daysInNormalYear*y))-o)?(e.month=1,e.day=1):(o-=(a=ATUtilities.floatToInt(o/y))*y,this._calcMonthAndDayForDaysIntoNormalYear(e,a))),0===o?(e.hour=0,e.minute=0,e.second=0):(e.hour=ATUtilities.floatToInt(o/3600),o-=3600*e.hour,e.minute=ATUtilities.floatToInt(o/60),o-=60*e.minute,e.second=o))}},ATCalendar.prototype.calculateWeekdayForDate=function(e){var t,n=60*this.hoursInDay*60,a=ATUtilities.floatToInt(e.timestamp/n),i=this.weekdays.length;e.timestamp>=0?e.weekdayIndex=(this.weekdayIndexAtZero+a)%i:(t=Math.abs(a%i),e.weekdayIndex=this.weekdayIndexAtZero-t,e.timestamp%n!=0&&(e.weekdayIndex-=1),e.weekdayIndex<0&&(e.weekdayIndex+=i))},ATCalendar.prototype.calculateMonthsSinceEraStart=function(e){var t,n,a=this.months.length;return this.eras[e.eraIndex].isBackwards?(t=e.year-1,1===e.month&&1===e.day&&0===e.hour&&0===e.minute&&0===e.second?++t*a:(n=a-e.month,1===e.day&&0===e.hour&&0===e.minute&&0===e.second&&n++,t*a+n)):(e.year-1)*a+(e.month-1)},ATCalendar.prototype.calculateDaysSinceEraStartForDateComponents=function(e){var t,n=this.eras[e.eraIndex],a=this.months.length,i=e.year-1,o=this.daysInNormalYear*i;if(n.hasLeap&&(o+=(ATUtilities.floatToInt(i/4)-ATUtilities.floatToInt(i/100)+ATUtilities.floatToInt(i/400))*(this.daysInLeapYear-this.daysInNormalYear)),n.isBackwards)if(this.isLeapYearInEra(e.year,e.eraIndex)){for(t=a;t>e.month;t--)o+=this.months[t-1].leapDuration;o+=this.months[e.month-1].leapDuration-e.day,0===e.hour&&0===e.minute&&0===e.second&&o++}else{for(t=a;t>e.month;t--)o+=this.months[t-1].normalDuration;o+=this.months[e.month-1].normalDuration-e.day,0===e.hour&&0===e.minute&&0===e.second&&o++}else{if(this.isLeapYearInEra(e.year,e.eraIndex))for(t=1;t<=a&&t!==e.month;t++)o+=this.months[t-1].leapDuration;else for(t=1;t<=a&&t!==e.month;t++)o+=this.months[t-1].normalDuration;o+=e.day-1}return o},ATCalendar.prototype._calcMonthAndDayForDaysIntoNormalYear=function(e,t){var n;for(n=this.months.length-1;n>=0;n--)if(t>=this.monthStartsInNormalYear[n]){e.month=n+1,e.day=1+t-this.monthStartsInNormalYear[n];break}},ATCalendar.prototype._calcMonthAndDayForDaysIntoNormalYearNegative=function(e,t){var n,a;for(n=this.months.length-1;n>=0;n--)if(t<=this.daysInNormalYear-this.monthStartsInNormalYear[n]){e.month=n+1,a=this.daysInNormalYear-this.monthStartsInNormalYear[n]-t,e.day=a+1;break}},ATCalendar.prototype._calcMonthAndDayForDaysIntoLeapYear=function(e,t){var n,a=this.months.length;for(e.month=0,n=a-1;n>=0;n--)if(t>=this.monthStartsInLeapYear[n]){e.month=n+1,e.day=1+t-this.monthStartsInLeapYear[n];break}},ATCalendar.prototype._calcMonthAndDayForDaysIntoLeapYearNegative=function(e,t){var n,a;for(n=this.months.length-1;n>=0;n--)if(t<=this.daysInLeapYear-this.monthStartsInLeapYear[n]){e.month=n+1,a=this.daysInLeapYear-this.monthStartsInLeapYear[n]-t,e.day=a+1;break}},ATCalendar.prototype.isLeapYearInEra=function(e,t){return!!this.eras[t].hasLeap&&(e%400==0||e%4==0&&e%100!=0)},ATCalendar.prototype.daysInMonthOfYear=function(e,t,n){return this.isLeapYearInEra(t,n)?this.months[e-1].leapDuration:this.months[e-1].normalDuration},ATCalendar.prototype._addYearsToDate=function(e,t){for(var n,a,i=e.year,o=e.eraIndex,s=t;0!==s;)if((n=this.eras[o]).isBackwards)if((i-=s)<=0)o++,(n=this.eras[o]).isBackwards?(s=-i,i=n.duration):(s=-i,i=1);else{if(!(i>n.duration))return e.year=i,void(e.eraIndex=o);o--,a=n,(n=this.eras[o]).isBackwards?(s=a.duration-i,i=1):(s=a.duration-i,i=n.duration)}else if((i+=s)>n.duration)o++,a=n,(n=this.eras[o]).isBackwards?(s=i-a.duration-1,i=n.duration):(s=i-a.duration,i=0);else{if(!(i<=0))return e.year=i,void(e.eraIndex=o);o--,(n=this.eras[o]).isBackwards?(s=i,i=1):(s=i,i=n.duration)}e.year=i,e.eraIndex=o},ATCalendar.prototype.getWeeksSinceZeroDate=function(e){return _.isNil(this.zeroDate)?0:Math.floor(this.getSecondsSinceZeroDate(e)/(this.weekdays.length*this.hoursInDay*3600))},ATCalendar.prototype.getDaysSinceZeroDate=function(e){return _.isNil(this.zeroDate)?0:Math.floor(this.getSecondsSinceZeroDate(e)/(3600*this.hoursInDay))},ATCalendar.prototype.getSecondsSinceZeroDate=function(e){return _.isNil(this.zeroDate)?0:this.secondsBetweenDates(this.zeroDate,e)},ATCalendar.prototype.getHoursSinceZeroDate=function(e){return _.isNil(this.zeroDate)?0:this.hoursBetweenDates(this.zeroDate,e)},ATCalendar.prototype.getMinutesSinceZeroDate=function(e){return _.isNil(this.zeroDate)?0:this.minutesBetweenDates(this.zeroDate,e)},ATCalendar.prototype.stringFromDate=function(e,t,n,a){var i,o,s,r,h,g,l,m,d,c,u,T,y,p,R,D,A,I,S,w,x,f,U,k,E;if(n&&e.timestamp!==a.timestamp&&0===e.hour&&0===e.minute&&0===e.second&&-1===t.indexOf("%I"))return r=t.replace("%H",String(this.hoursInDay)),this.stringFromDate(this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-1,0,0,0)),r);for(e.year>=1e9?(i=(e.year/1e9).toFixed(2),o=" billion",s="b"):e.year>=1e6?(i=(e.year/1e6).toFixed(2),o=" million",s="m"):(i=e.year,o="",s=""),h=!0,-1===t.indexOf("%d %B %Y")&&-1===t.indexOf("%d %b %Y")||(h=!1),g=e.day,e.day<10&&h&&(g="0"+e.day),l=e.month,e.month<10&&h&&(l="0"+e.month),d=m=e.year%100,m<10&&h&&(d="0"+m),c=e.year,e.year<10&&h?c="000"+e.year:e.year<100&&h?c="00"+e.year:e.year<1e3&&h&&(c="0"+e.year),u=ATUtilities.floatToInt(e.day/this.weekdays.length+1),T=e.weekdayIndex,e.weekdayIndex<10&&(T="0"+e.weekdayIndex),y=0,p=0;p<e.month-1;p++)this.isLeapYearInEra(e.year,e.eraIndex)?y+=this.months[p].leapDuration:y+=this.months[p].normalDuration;return y+=e.day,R=this.getWeeksSinceZeroDate(e),D=this.getDaysSinceZeroDate(e),A=1,(I=this.getSecondsSinceZeroDate(e))<0&&(A=-1,I=-I),S=ATUtilities.floatToInt(I/3600),w=ATUtilities.floatToInt(I%3600),x=ATUtilities.floatToInt(w/60),f=ATUtilities.floatToInt(w%60),0===(U=S*A)&&A<0&&(U="-0"),k=this.hoursInDay%2==0?e.hour>this.hoursInDay/2-1?"pm":"am":"",E=this.hoursInDay%2==0?0===e.hour?(this.hoursInDay/2).toString():e.hour===this.hoursInDay/2?(this.hoursInDay/2).toString():(e.hour%(this.hoursInDay/2)).toString():e.hour.toString(),t.replace("%G",i+o).replace("%g",i+s).replace("%y",d).replace("%Y",c).replace("%i",this.weekdays[e.weekdayIndex].name.charAt(0)).replace("%a",this.weekdays[e.weekdayIndex].shortName).replace("%A",this.weekdays[e.weekdayIndex].name).replace("%b",this.months[e.month-1].shortName).replace("%B",this.months[e.month-1].name).replace("%T",this.eras[e.eraIndex].name).replace("%t",this.eras[e.eraIndex].shortName).replace("%E",e.eraIndex<this.eras.length-1?this.eras[e.eraIndex].shortName:"").replace("%d",g).replace("%e",e.day).replace("%m",l).replace("%n",e.month).replace("%H",e.hour).replace("%I",E).replace("%p",k).replace("%M",ATUtilities.numberToTwoDigitString(e.minute)).replace("%S",ATUtilities.numberToTwoDigitString(e.second)).replace("%W",u).replace("%w",T).replace("%j",y).replace("%Z",R).replace("%z",D).replace("%x",U).replace("%v",ATUtilities.numberToTwoDigitString(x)).replace("%u",ATUtilities.numberToTwoDigitString(f))},ATCalendar.prototype.dateWithPartialString=function(e,t,n,a,i){var o,s,r,h,g,l,m,d,c,u,T,y,p,R,D,A,I=new ATRange(t,0),S=this.dateWithTimestamp(0),w=new ATDateStringMatchResult(S),x=!1;if(w.validDate=!1,w.text=e,w.selection=I,w.date.eraIndex=this.eras.length-1,w.date.year=1,w.date.month=1,w.date.day=1,w.date.minute=0,w.date.second=0,w.updatedCursorPosition=t,this.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME){if(o={remainingString:null,foundResult:null},this.extractEraFromPartialString(o,w,e),this.extractTimeFromPartialString(o,w,o.remainingString),m=w.date.precision,h=this.extractLongDateFromPartialString(o.remainingString,w),w.matchFound||(h=this.extractShortDateFromPartialString(h,w)),!w.matchFound&&n&&(h=this.extractPartialLongDateFromPartialString(e,t,h,w)),w.matchFound||(h=this.extractYearOnlyDateFromPartialString(h,w)),s={remainingString:null,foundWeekday:null,weekdayIndex:null,useShortName:null},h=this.extractWeekdayFromPartialString(s,w,h),w.validDate){if((x=w.date.hour===this.hoursInDay&&0===w.date.minute&&0===w.date.second)&&(w.date.hour=0),o.foundResult?w.date=this.dateWithComponents(w.date.eraIndex,w.date.year,w.date.month,w.date.day,w.date.hour,w.date.minute,w.date.second,m):w.date=this.dateWithComponents(w.date.eraIndex,w.date.year,w.date.month,w.date.day,w.date.hour,w.date.minute,w.date.second,w.date.precision),w.cleanText=this.naturalStringFromDate(w.date,!0,!1,null,"%Y"),s.foundWeekday&&(R=w.weekdayRange,this.modifyWeekdayInMatchResult(w,s.useShortName,t),h=ATUtilities.replaceLocationWithWhitespace(R.location,R.length,h)),r=h.match(this.remainingErrorContent))if(1===r.length)w.errorRanges.push(new ATRange(r.index,r[0].length));else for(g=r.index,l=0;l<r.length;l++)w.errorRanges.push(new ATRange(g,r[l].length)),g+=r[l].length}else w.date=this.dateWithComponents(w.date.eraIndex,w.date.year,w.date.month,w.date.day,w.date.hour,w.date.minute,w.date.second,w.date.precision),w.errorRanges.push(new ATRange(0,e.length));return w.validDate&&a&&(x||w.date.timestamp!==i.timestamp)&&(y=x?ATTimeUnit.DAY:w.date.precision,(p=this.timespanForPrecision(y)).hours=0,p.minutes=0,p.seconds=0,w.date=this.dateByAddingTimespanToDate(w.date,p)),w}if(this.calendarType===ATCalendarType.CALENDAR_TYPE_HOUR_TIME){if(o={remainingString:null,foundResult:null,hour:null,minute:null,second:null,timePrecision:null,negative:null},this.extractSignedTimeFromPartialString(o,w,e),o.negative&&(o.hour=-o.hour,o.minute=-o.minute,o.second=-o.second),o.remainingString&&(r=o.remainingString.match(this.remainingErrorContent)))if(1===r.length)w.errorRanges.push(new ATRange(r.index,r[0].length));else for(g=r.index,l=0;l<r.length;l++)w.errorRanges.push(new ATRange(g,r[l].length)),g+=r[l].length;return o.foundResult&&(d=new ATTimeSpan(0,0,0,0,o.hour,o.minute,o.second),w.validDate=!0,w.matchFound=!0,w.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,d,o.timePrecision),w.cleanText=this.naturalStringFromDate(w.date,!0)),w.yearRange.location=-1,w.yearRange.length=0,w.monthRange.location=-1,w.monthRange.length=0,w.dayRange.location=-1,w.dayRange.length=0,w.weekdayRange.location=-1,w.weekdayRange.length=0,w.eraRange.location=-1,w.eraRange.length=0,w.weekRange.location=-1,w.weekRange.length=0,w.dayRange.location=-1,w.dayRange.length=0,w}if(this.calendarType===ATCalendarType.CALENDAR_TYPE_DAY_TIME){if(o={remainingString:null,foundResult:null},this.extractTimeFromPartialString(o,w,e),(x=w.date.hour===this.hoursInDay&&0===w.date.minute&&0===w.date.second)&&(w.date.hour=0),c=w.date.hour,u=w.date.minute,T=w.date.second,m=w.date.precision,D={remainingString:null,day:null},this.extractDayFromPartialString(D,w,o.remainingString),D.remainingString&&(r=D.remainingString.match(this.remainingErrorContent)))if(1===r.length)w.errorRanges.push(new ATRange(r.index,r[0].length));else for(g=r.index,l=0;l<r.length;l++)w.errorRanges.push(new ATRange(g,r[l].length)),g+=r[l].length;return w.matchFound&&(d=new ATTimeSpan(0,0,0,D.day,c,u,T),o.foundResult?w.date.precision=m:w.date.precision=ATTimeUnit.DAY,w.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,d,w.date.precision),w.validDate=!0,w.cleanText=this.naturalStringFromDate(w.date,!0)),w.yearRange.location=-1,w.yearRange.length=0,w.dayRange.location=-1,w.dayRange.length=0,w.monthRange.location=-1,w.monthRange.length=0,w.validDate&&a&&(x||w.date.timestamp!==i.timestamp)&&(y=x?ATTimeUnit.DAY:w.date.precision,(p=this.timespanForPrecision(y)).hours=0,p.minutes=0,p.seconds=0,w.date=this.dateByAddingTimespanToDate(w.date,p)),w}if(o={remainingString:null,foundResult:null},this.extractTimeFromPartialString(o,w,e),(x=w.date.hour===this.hoursInDay&&0===w.date.minute&&0===w.date.second)&&(w.date.hour=0),c=w.date.hour,u=w.date.minute,T=w.date.second,m=w.date.precision,A={remainingString:null,week:null},this.extractWeekFromPartialString(A,w,o.remainingString),s={remainingString:null,foundWeekday:null,weekdayIndex:null,useShortName:null},(h=this.extractWeekdayFromPartialString(s,w,A.remainingString))&&(r=h.match(this.remainingErrorContent)))if(1===r.length)w.errorRanges.push(new ATRange(r.index,r[0].length));else for(g=r.index,l=0;l<r.length;l++)w.errorRanges.push(new ATRange(g,r[l].length)),g+=r[l].length;return w.matchFound&&!s.foundWeekday?(d=new ATTimeSpan(0,0,A.week,0,0,0,0),w.date.precision=ATTimeUnit.WEEK,w.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,d,w.date.precision),w.cleanText=this.naturalStringFromDate(w.date,!0)):w.matchFound&&s.foundWeekday&&(d=new ATTimeSpan(0,0,A.week,s.weekdayIndex,c,u,T),o.foundResult?w.date.precision=m:w.date.precision=ATTimeUnit.DAY,w.date=this.dateByAddingTimespanToDateWithPrecision(this.zeroDate,d,w.date.precision),w.cleanText=this.naturalStringFromDate(w.date,!0)),w.yearRange.location=-1,w.yearRange.length=0,w.monthRange.location=-1,w.monthRange.length=0,w.dayRange.location=-1,w.dayRange.length=0,w.eraRange.location=-1,w.eraRange.length=0,w.validDate&&a&&(x||w.date.timestamp!==i.timestamp)&&(y=x?ATTimeUnit.DAY:w.date.precision,(p=this.timespanForPrecision(y)).hours=0,p.minutes=0,p.seconds=0,w.date=this.dateByAddingTimespanToDate(w.date,p)),w},ATCalendar.prototype.dateWithString=function(e,t){var n=this.dateWithPartialString(e,e.length,!0);n.validDate?(t.foundResult=!0,t.date=n.date):t.foundResult=!1},ATCalendar.prototype.extractEraFromPartialString=function(e,t,n){var a,i,o,s=matchWithPseudoBoundary(this.eraNameWithDigitRegExp,n);if(s){for(a=s[0],o=0;o<this.eras.length;o++)if(ATUtilities.caseInsensitiveCompare(a,this.eras[o].name)||ATUtilities.caseInsensitiveCompare(a,this.eras[o].shortName)){t.date.eraIndex=o;break}i=s[0].indexOf(a),t.eraRange.location=s.index+i,t.eraRange.length=s[0].length,e.foundResult=!0,e.remainingString=ATUtilities.replaceLocationWithWhitespace(t.eraRange.location,t.eraRange.length,n)}else e.foundResult=!1,e.remainingString=n,t.eraRange.location=-1,t.eraRange.length=0},ATCalendar.prototype.extractTimeFromPartialString=function(e,t,n){var a,i,o,s,r;return t.midnightRange.location=-1,t.midnightRange.length=0,this.hoursInDay%2==0&&(i=n.match(this.timeRegExp))?(e.foundResult=!0,t.date.hour=parseInt(i[1]),t.date.precision=ATTimeUnit.HOUR,t.hourRange.location=i.index,t.hourRange.length=i[1].length,a=t.hourRange.location+t.hourRange.length+1,_.isNil(i[3])?(t.date.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0):(t.date.minute=parseInt(i[3]),t.date.precision=ATTimeUnit.MINUTE,t.minuteRange.location=a,t.minuteRange.length=i[3].length,a=t.minuteRange.location+t.minuteRange.length+1),_.isNil(i[5])?(t.date.second=0,t.secondRange.location=-1,t.secondRange.length=0):(t.date.second=parseInt(i[5]),t.date.precision=ATTimeUnit.SECOND,t.secondRange.location=a,t.secondRange.length=i[5].length),_.isNil(i[6])?(t.amPmRange.location=-1,t.amPmRange.length=0):(ATUtilities.caseInsensitiveCompare(i[6],"AM")?t.date.hour===this.hoursInDay/2&&(t.date.hour=0):ATUtilities.caseInsensitiveCompare(i[6],"PM")&&t.date.hour<this.hoursInDay/2&&(t.date.hour+=this.hoursInDay/2),t.amPmRange.location=n.search(i[6]),t.amPmRange.length=i[6].length),t.date.hour<0||t.date.hour>this.hoursInDay||t.date.minute<0||t.date.minute>60||t.date.second<0||t.date.second>60?(t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,void(e.remainingString=n)):void(e.remainingString=ATUtilities.replaceCharactersWithWhitespace(this.timeRegExp,i[0].length,n))):(o=n.match(this.timeRegExp2))&&(e.foundResult=!0,!_.isNil(o[1]))?(t.date.hour=parseInt(o[1]),t.hourRange.location=o.index,t.hourRange.length=o[1].length,a=t.hourRange.location+t.hourRange.length+1,t.date.precision=ATTimeUnit.HOUR,_.isNil(o[2])?(t.date.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0):(t.date.minute=parseInt(o[2]),t.minuteRange.location=a,t.minuteRange.length=o[2].length,a=t.minuteRange.location+t.minuteRange.length+1,t.date.precision=ATTimeUnit.MINUTE),_.isNil(o[4])?(t.date.second=0,t.secondRange.location=-1,t.secondRange.length=0):(t.date.second=parseInt(o[4]),t.secondRange.location=a,t.secondRange.length=o[4].length,a=t.secondRange.location+t.secondRange.length+1,t.date.precision=ATTimeUnit.SECOND),t.amPmRange.location=-1,t.amPmRange.length=0,t.date.hour<0||t.date.hour>this.hoursInDay||t.date.minute<0||t.date.minute>60||t.date.second<0||t.date.second>60?(t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,void(e.remainingString=n)):void(e.remainingString=ATUtilities.replaceLocationWithWhitespace(o.index,o[0].length,n))):(s=n.match(this.timeRegExp3))&&!_.isNil(s[1])?(t.date.hour=parseInt(s[1]),t.hourRange.location=s.index,t.hourRange.length=s[1].length,t.date.precision=ATTimeUnit.HOUR,a=t.hourRange.location+t.hourRange.length,_.isNil(s[2])?(t.date.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0):(t.date.minute=parseInt(s[2]),t.minuteRange.location=a,t.minuteRange.length=s[2].length,t.date.precision=ATTimeUnit.MINUTE),t.date.second=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,t.date.hour<0||t.date.hour>this.hoursInDay||t.date.minute<0||t.date.minute>60||t.date.second<0||t.date.second>60?(t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,void(e.remainingString=n)):(e.remainingString=ATUtilities.replaceLocationWithWhitespace(s.index,s[0].length,n),void(e.foundResult=!0))):-1!==(r=n.indexOf("midnight"))?(t.date.hour=this.hoursInDay,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.HOUR,t.midnightRange.location=r,t.midnightRange.length=8,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,e.foundResult=!0,void(e.remainingString=ATUtilities.replaceLocationWithWhitespace(r,8,n))):(t.date.hour=0,t.date.minute=0,t.date.second=0,t.date.precision=ATTimeUnit.YEAR,e.foundResult=!1,t.hourRange.location=-1,t.hourRange.length=0,t.minuteRange.location=-1,t.minuteRange.length=0,t.secondRange.location=-1,t.secondRange.length=0,t.amPmRange.location=-1,t.amPmRange.length=0,void(e.remainingString=n))},ATCalendar.prototype.extractLongDateFromPartialString=function(e,t){var n,a,i,o,s,r=matchWithPseudoBoundary(this.monthNameRegExp,e);if(r){for(n=String(r[0]),a=0;a<this.months.length;a++)if(ATUtilities.caseInsensitiveCompare(n,this.months[a].name)||ATUtilities.caseInsensitiveCompare(n,this.months[a].shortName)){t.date.month=a+1;break}return t.monthRange.location=r.index,t.monthRange.length=r[0].length,i=ATUtilities.replaceCharactersWithWhitespace(r[0],t.monthRange.length,e),(o=i.match(this.monthNameRemainderRegExp))?(_.isNil(o[3])||_.isNil(o[1])?(t.date.day=1,t.date.year=parseInt(o[1]),t.dayRange.location=-1,t.dayRange.length=0,t.yearRange.location=o.index,t.yearRange.length=o[1].length,s=!1):(t.date.day=parseInt(o[1]),t.date.year=parseInt(o[3]),t.dayRange.location=o.index,t.dayRange.length=o[1].length,t.yearRange.length=o[3].length,t.yearRange.location=o.index+o[0].length-t.yearRange.length,s=!0),t.date.precision=s?ATTimeUnit.DAY:ATTimeUnit.MONTH,t.matchFound=!0,t.validDate=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),ATUtilities.replaceCharactersWithWhitespace(this.monthNameRemainderRegExp,o[0].length,i)):(t.dayRange.location=-1,t.dayRange.length=0,t.yearRange.location=-1,t.yearRange.length=0,t.matchFound=!1,t.validDate=!1,e)}return t.dayRange.location=-1,t.dayRange.length=0,t.yearRange.location=-1,t.yearRange.length=0,t.monthRange.location=-1,t.monthRange.length=0,t.matchFound=!1,t.validDate=!1,e},ATCalendar.prototype.extractShortDateFromPartialString=function(e,t){var n,a,i,o,s,r,h,g,l,m,d=e.match(this.formalDateRegExp);return d&&d.length>3?(n=parseInt(d[1]),a=parseInt(d[2]),i=parseInt(d[3]),o=d[1].length,s=d[2].length,r=d[3].length,h=d.index,g=h+o+1,l=g+s+1,t.date.precision=ATTimeUnit.DAY,this.dateOrder===ATDateOrder.DATE_ORDER_YEAR_MONTH_DAY?(t.date.year=n,t.date.month=a,t.date.day=i,t.yearRange.location=h,t.yearRange.length=o,t.monthRange.location=g,t.monthRange.length=s,t.dayRange.location=l,t.dayRange.length=r):this.dateOrder===ATDateOrder.DATE_ORDER_DAY_MONTH_YEAR?(t.date.day=n,t.date.month=a,t.date.year=i,t.dayRange.location=h,t.dayRange.length=o,t.monthRange.location=g,t.monthRange.length=s,t.yearRange.location=l,t.yearRange.length=r):(t.date.month=n,t.date.day=a,t.date.year=i,t.monthRange.location=h,t.monthRange.length=o,t.dayRange.location=g,t.dayRange.length=s,t.yearRange.location=l,t.yearRange.length=r),(m=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0))||this.dateOrder===ATDateOrder.DATE_ORDER_YEAR_MONTH_DAY||(t.date.year=n,t.date.month=a,t.date.day=i,(m=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0))&&(t.yearRange.location=h,t.yearRange.length=o,t.monthRange.location=g,t.monthRange.length=s,t.dayRange.location=l,t.dayRange.length=r)),m||this.dateOrder===ATDateOrder.DATE_ORDER_DAY_MONTH_YEAR||(t.date.day=n,t.date.month=a,t.date.year=i,(m=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0))&&(t.dayRange.location=h,t.dayRange.length=o,t.monthRange.location=g,t.monthRange.length=g,t.yearRange.location=l,t.yearRange.length=r)),m||this.dateOrder===ATDateOrder.DATE_ORDER_MONTH_DAY_YEAR||(t.date.month=n,t.date.day=a,t.date.year=i,(m=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0))&&(t.monthRange.location=h,t.monthRange.length=o,t.dayRange.location=g,t.dayRange.length=s,t.yearRange.location=l,t.yearRange.length=r)),t.matchFound=!0,t.validDate=m,m&&(t.date.precision=t.date.precision>ATTimeUnit.DAY?t.date.precision:ATTimeUnit.DAY),ATUtilities.replaceCharactersWithWhitespace(this.formalDateRegExp,d[0].length,e)):(t.date.year=1,t.date.month=1,t.date.day=1,t.yearRange.location=-1,t.yearRange.length=0,t.monthRange.location=-1,t.monthRange.length=0,t.dayRange.location=-1,t.dayRange.length=0,e)},ATCalendar.prototype.extractYearOnlyDateFromPartialString=function(e,t){var n,a=e.match(this.largeYearRegExp);return t.date.month=1,t.date.day=1,a?(ATUtilities.caseInsensitiveCompare(a[4],"billion")?t.date.year=ATUtilities.floatToInt(1e9*parseFloat(a[1])):ATUtilities.caseInsensitiveCompare(a[4],"million")&&(t.date.year=ATUtilities.floatToInt(1e6*parseFloat(a[1]))),t.yearRange.location=a.index,t.yearRange.length=a[0].length,t.monthRange.location=-1,t.monthRange.length=0,t.dayRange.location=-1,t.dayRange.length=0,t.date.precision=ATTimeUnit.YEAR,t.validDate=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),t.matchFound=!0,ATUtilities.replaceLocationWithWhitespace(a.index,a[0].length,e)):(n=e.match(this.yearRegExp))?(t.date.year=parseInt(n[1]),t.yearRange.location=n.index,t.yearRange.length=n[0].length,t.monthRange.location=-1,t.monthRange.length=0,t.dayRange.location=-1,t.dayRange.length=0,t.date.precision=ATTimeUnit.YEAR,t.date.month=this.firstMonthOfYear(t.date.eraIndex,t.date.year),t.validDate=this.isValidDateComponents(t.date.eraIndex,t.date.year,t.date.month,t.date.day,0,0,0),t.matchFound=!0,ATUtilities.replaceLocationWithWhitespace(n.index,n[0].length,e)):(t.matchFound=!1,e)},ATCalendar.prototype.extractPartialLongDateFromPartialString=function(e,t,n,a){var i,o,s,r,h,g,l,m,d,c,u,T=!1,y=e.substring(0,t),p=y.match(this.matchLastWordRegExp);if(!p)return n;if(i=p.index,y=e.substring(i),o=y.match(this.matchFirstWordRegExp))for(s=o[0].length,r=o[0],l=0;l<this.months.length;l++)if(h=this.months[l].name.search(new RegExp(r,"i")),g=this.months[l].shortName.search(new RegExp(r,"i")),(0===h||0===g)&&(c=!1,e.length>i+r.length&&" "!==e.charAt(i+r.length)&&(c=!0),c?(m=e.substring(0,i)+this.months[l].name+" "+e.substring(i+s),d=n.substring(0,i)+this.months[l].name+" "+n.substring(i+s)):(m=e.substring(0,i)+this.months[l].name+e.substring(i+s),d=n.substring(0,i)+this.months[l].name+n.substring(i+s)),T&&(a.text=m,a.selection.location=t,a.selection.length=this.months[l].name.length+1+i-t,T=!1),u=this.extractLongDateFromPartialString(d,a),a.matchFound))return a.text=m,a.selection.location=t,a.selection.length=this.months[l].name.length+1+i-t,u;return n},ATCalendar.prototype.extractWeekdayFromPartialString=function(e,t,n){var a,i,o=matchWithPseudoBoundary(this.weekdayNameRegExp,n);if(e.foundWeekday=!1,e.weekdayIndex=0,t.weekdayRange.location=-1,t.weekdayRange.length=0,e.useShortName=!1,o){for(a=o[0],i=0;i<this.weekdays.length;i++){if(ATUtilities.caseInsensitiveCompare(a,this.weekdays[i].name)){e.weekdayIndex=i,e.foundWeekday=!0,e.useShortName=!1;break}if(ATUtilities.caseInsensitiveCompare(a,this.weekdays[i].shortName)){e.weekdayIndex=i,e.foundWeekday=!0,e.useShortName=!0;break}}return e.foundWeekday&&(t.weekdayRange.location=o.index,t.weekdayRange.length=o[0].length),ATUtilities.replaceCharactersWithWhitespace(o[0],o[0].length,n)}return n},ATCalendar.prototype.extractSignedTimeFromPartialString=function(e,t,n){var a,i,o,s=n.match(this.timeRegExp4);return s&&!_.isNil(s[2])?(e.hour=parseInt(s[2]),a=s[1],i=0,_.isNil(a)?(e.negative=!1,t.negationRange.location=-1,t.negationRange.length=0):ATUtilities.caseInsensitiveCompare(a,"-")?(e.negative=!0,t.negationRange.location=s.index,t.negationRange.length=s[1].length,i=t.negationRange.location+t.negationRange.length):ATUtilities.caseInsensitiveCompare(a,"+")?(e.negative=!1,t.negationRange.location=s.index,t.negationRange.length=s[1].length,i=t.negationRange.location+t.negationRange.length):(e.negative=!1,t.negationRange.location=-1,t.negationRange.length=0),t.hourRange.location=i,t.hourRange.length=s[2].length,i=t.hourRange.location+t.hourRange.length+1,e.timePrecision=ATTimeUnit.HOUR,_.isNil(s[5])?(e.minute=0,t.minuteRange.location=-1,t.minuteRange.length=0):(e.minute=parseInt(s[5]),t.minuteRange.location=i,t.minuteRange.length=s[5].length,i=t.minuteRange.location+t.minuteRange.length+1,e.timePrecision=ATTimeUnit.MINUTE),_.isNil(s[7])?(e.second=0,t.secondRange.location=-1,t.secondRange.length=0):(e.second=parseInt(s[7]),t.secondRange.location=i,t.secondRange.length=s[7].length,i=t.secondRange.location+t.secondRange.length+1,e.timePrecision=ATTimeUnit.SECOND),t.amPmRange.location=-1,t.amPmRange.length=0,o=ATUtilities.replaceLocationWithWhitespace(s.index,s[0].length,n),e.foundResult=!0,o):(e.foundResult=!1,e.hour=0,e.minute=0,e.second=0,n)},ATCalendar.prototype.extractWeekFromPartialString=function(e,t,n){var a=n.match(this.weekRegExp);a&&a.length>4?(t.matchFound=!0,t.validDate=!0,e.week=parseInt(a[4]),t.weekRange.location=a.index+a[1].length,t.weekRange.length=a[4].length,e.remainingString=ATUtilities.replaceLocationWithWhitespace(a.index,a[0].length,n)):(t.matchFound=!1,t.validDate=!1,t.weekRange.location=-1,t.weekRange.length=0,e.remainingString=n)},ATCalendar.prototype.extractDayFromPartialString=function(e,t,n){var a=n.match(this.dayRegExp);a?_.isNil(a[4])||_.isNil(a[1])||(t.validDate=!0,t.matchFound=!0,e.day=parseInt(a[4]),t.floatingDayRange.location=a.index+a[1].length,t.floatingDayRange.length=a[4].length,e.remainingString=ATUtilities.replaceLocationWithWhitespace(a.index,a[0].length,n)):(t.floatingDayRange.location=-1,t.floatingDayRange.length=0,e.remainingString=n,t.validDate=!1,t.matchFound=!1)},ATCalendar.prototype.buildRegularExpressions=function(){var e,t,n,a,i,o,s,r,h,g,l,m,d,c,u="^(.*[\\s\\,\\-\\/]+)?",T="([\\s\\,\\-\\/]+.*)?$",y=u+"(";for(e=0;e<this.months.length;e++)y+=t="("+this.months[e].name+")|("+this.months[e].shortName+")",e!==this.months.length-1&&(y+="|");for(y+=")"+T,this.monthNameRegExp=new RegExp(y,"i"),n=u+"(",e=0;e<this.months.length;e++)n+=t="("+this.months[e].name+")",e!==this.months.length-1&&(n+="|");for(n+=")"+T,this.longMonthNameRegExp=new RegExp(n,"i"),a=u+"(",e=0;e<this.months.length;e++)a+=t="("+this.months[e].shortName+")",e!==this.months.length-1&&(a+="|");for(a+=")"+T,this.shortMonthNameRegExp=new RegExp(a,"i"),this.monthNameRemainderRegExp=new RegExp("\\b(\\d+)([\\s,/-]+(\\d+))?\\b"),i=u+"\\d*(",o=u+"(",e=0;e<this.eras.length;e++)o+=t="("+this.eras[e].name+")|("+this.eras[e].shortName+")",i+=t,e!==this.eras.length-1&&(o+="|",i+="|");for(o+=")\\s*$",i+=")\\s*$",this.eraNameWithDigitRegExp=new RegExp(i,"i"),this.eraNameRegExp=new RegExp(o,"i"),s=u+"(",e=0;e<this.eras.length;e++)s+=t="("+this.eras[e].name+")",e!==this.eras.length-1&&(s+="|");for(s+=")\\s*$",this.longEraNameRegExp=new RegExp(s,"i"),r=u+"(",e=0;e<this.eras.length;e++)r+=t="("+this.eras[e].shortName+")",e!==this.eras.length-1&&(r+="|");for(r+=")\\s*$",this.shortEraNameRegExp=new RegExp(r,"i"),h="\\b(\\d{1,2})(:([0-5][0-9])(:([0-5][0-9]))?)?\\s?([ap][m])\\b",this.timeRegExp=new RegExp(h,"i"),h="\\b(\\d{1,2}):([0-5][0-9])(:([0-5][0-9]))?",this.timeRegExp2=new RegExp(h),h="\\b(\\d{1,2})([0-5][0-9])\\s?hr?s?\\b",this.timeRegExp3=new RegExp(h,"i"),h="^\\s*([-+])?\\s*(\\d{1,2})((:([0-5][0-9]))(:([0-5][0-9]))?)?\\s*$",this.timeRegExp4=new RegExp(h),this.formalDateRegExp=new RegExp("\\b(\\d+)[/.-](\\d+)[/.-](\\d+)\\b"),this.matchLastWordRegExp=new RegExp("\\b([a-zA-z]+)$"),this.matchFirstWordRegExp=new RegExp("^([a-zA-z]+)"),g=u+"(",e=0;e<this.weekdays.length;e++)g+=t="("+this.weekdays[e].name+")|("+this.weekdays[e].shortName+")",e!==this.weekdays.length-1&&(g+="|");for(g+=")"+T,this.weekdayNameRegExp=new RegExp(g,"i"),l=u+"(",e=0;e<this.weekdays.length;e++)l+=t="("+this.weekdays[e].name+")",e!==this.weekdays.length-1&&(l+="|");for(l+=")"+T,this.longWeekdayNameRegExp=new RegExp(l,"i"),m=u+"(",e=0;e<this.weekdays.length;e++)m+=t="("+this.weekdays[e].shortName+")",e!==this.weekdays.length-1&&(m+="|");m+=")"+T,this.shortWeekdayNameRegExp=new RegExp(m,"i"),this.remainingErrorContent=new RegExp("(\\S)+"),d="(\\b(w(eek|k)?)\\s*)(-?\\d+)",this.weekRegExp=new RegExp(d,"i"),this.yearRegExp=new RegExp("\\b(\\d+)\\b","i"),this.largeYearRegExp=new RegExp("\\b((\\d+)(.\\d+)?)\\s?(billion|million)\\b","i"),c="(\\b(d(ay)?)\\s*)(-?\\d+)\\b",this.dayRegExp=new RegExp(c,"i")},ATCalendar.prototype.naturalStringFromDate=function(e,t,n,a,i){var o,s,r,h,g,l,m,d,c,u=e.precision,T=this.dateFormat,y=this.monthFormat,p=this.dayNameFormat,R="";return this.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME?(c=e.copy(),n&&e.timestamp!==a.timestamp&&0===e.hour&&0===e.minute&&0===e.second&&((c=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-1,0,0,0))).hour=24),u===ATTimeUnit.YEAR?R=i||"%G":u===ATTimeUnit.MONTH?R=y:(R=(t?p+" ":"")+T,u>ATTimeUnit.DAY&&(R+=" "+this.timeStringFromDate(c))),e.eraIndex!==this.eras.length-1&&(R+=" %t"),this.stringFromDate(e,R,n,a)):this.calendarType===ATCalendarType.CALENDAR_TYPE_HOUR_TIME?u===ATTimeUnit.HOUR?(o=this.getHoursSinceZeroDate(e),ATUtilities.numberToTwoDigitString(o)+":00:00"):u===ATTimeUnit.MINUTE?(o=this.getHoursSinceZeroDate(e),s=this.getMinutesSinceZeroDate(e),(r=s-60*o)<0&&(r*=-1),0===o&&s<0?"-"+ATUtilities.numberToTwoDigitString(o)+":"+ATUtilities.numberToTwoDigitString(r)+":00":ATUtilities.numberToTwoDigitString(o)+":"+ATUtilities.numberToTwoDigitString(r)+":00"):(o=this.getHoursSinceZeroDate(e),s=this.getMinutesSinceZeroDate(e),r=s-60*o,h=this.getSecondsSinceZeroDate(e),g=h-60*s,r<0&&(r*=-1),g<0&&(g*=-1),0===o&&h<0?"-"+ATUtilities.numberToTwoDigitString(o)+":"+ATUtilities.numberToTwoDigitString(r)+":"+ATUtilities.numberToTwoDigitString(g):ATUtilities.numberToTwoDigitString(o)+":"+ATUtilities.numberToTwoDigitString(r)+":"+ATUtilities.numberToTwoDigitString(g)):this.calendarType===ATCalendarType.CALENDAR_TYPE_DAY_TIME?(c=e.copy(),n&&e.timestamp!==a.timestamp&&0===e.hour&&0===e.minute&&0===e.second&&((c=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-1,0,0,0))).hour=24),l=this.getDaysSinceZeroDate(c),h=this.getSecondsSinceZeroDate(c),(g=h-l*this.hoursInDay*3600)<0&&l--,u===ATTimeUnit.DAY?"Day "+l.toString():this.timeStringFromDate(c)+" Day "+l.toString()):(c=e.copy(),n&&e.timestamp!==a.timestamp&&0===e.hour&&0===e.minute&&0===e.second&&((c=this.dateByAddingTimespanToDate(e,new ATTimeSpan(0,0,0,-1,0,0,0))).hour=24),m=this.getWeeksSinceZeroDate(c),d=this.weekdays[c.weekdayIndex].name,h=this.getSecondsSinceZeroDate(c),(g=h-m*this.weekdays.length*this.hoursInDay*3600)<0&&m--,u===ATTimeUnit.WEEK?"Week "+m.toString():u===ATTimeUnit.DAY?d+" Week "+m.toString():this.timeStringFromDate(c)+" "+d+" Week "+m.toString())},ATCalendar.prototype.naturalStringFromDateRange=function(e,t){var n,a,i,o,s,r,h,g,l,m,d,c,u,T,y,p,R,D,A,I,S,w,x,f,U,k,E,M,Y,C,N,F,P,W,_,v,b,B=this.dateFormat,Z=this.monthFormat;return e.timestamp===t.timestamp?this.naturalStringFromDate(e,!0):this.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME?Math.max(e.precision,t.precision)===ATTimeUnit.YEAR?(n=new ATTimeSpan(-1,0,0,0,0,0,0),s=this.dateByAddingTimespanToDate(t,n),e.timestamp===s.timestamp?this.naturalStringFromDate(e,!0):(r=this.eraStringFromDate(e),h=this.eraStringFromDate(s),g=this.yearStringFromDate(e),l=this.yearStringFromDate(s),e.eraIndex!==s.eraIndex?g+" "+r+" - "+l+" "+h:e.eraIndex!==this.eras.length-1?g+" - "+l+" "+r:g+" - "+l)):Math.max(e.precision,t.precision)===ATTimeUnit.MONTH?(a=new ATTimeSpan(0,-1,0,0,0,0,0),s=this.dateByAddingTimespanToDate(t,a),e.timestamp===s.timestamp?this.naturalStringFromDate(e,!0):(r=this.eraStringFromDate(e),h=this.eraStringFromDate(s),g=this.yearStringFromDate(e),l=this.yearStringFromDate(s),"%b %Y"===Z?(m=this.shortMonthStringFromDate(e),d=this.shortMonthStringFromDate(s)):(m=this.monthStringFromDate(e),d=this.monthStringFromDate(s)),e.year===s.year&&e.eraIndex===s.eraIndex?e.eraIndex!==this.eras.length-1?m+" - "+d+" "+g+" "+r:m+" - "+d+" "+g:e.eraIndex===s.eraIndex?e.eraIndex!==this.eras.length-1?m+" "+g+" - "+d+" "+l+" "+r:m+" "+g+" - "+d+" "+l:m+" "+g+" "+r+" - "+d+" "+l+" "+h)):"%d %b %Y"===B||"%d %B %Y"===B?Math.max(e.precision,t.precision)===ATTimeUnit.DAY?(i=new ATTimeSpan(0,0,0,-1,0,0,0),s=this.dateByAddingTimespanToDate(t,i),e.timestamp===s.timestamp?this.naturalStringFromDate(e,!0):(r=this.eraStringFromDate(e),h=this.eraStringFromDate(s),g=this.yearStringFromDate(e),l=this.yearStringFromDate(s),"%d %b %Y"===B?(m=this.shortMonthStringFromDate(e),d=this.shortMonthStringFromDate(s)):(m=this.monthStringFromDate(e),d=this.monthStringFromDate(s)),c=this.dayStringFromDate(e),u=this.dayStringFromDate(s),T=this.weekdays[e.weekdayIndex].name,y=this.weekdays[s.weekdayIndex].name,e.month===s.month&&e.year===s.year&&e.eraIndex===s.eraIndex?e.eraIndex!==this.eras.length-1?T+" "+c+" - "+y+" "+u+" "+m+" "+g+" "+r:T+" "+c+" - "+y+" "+u+" "+m+" "+g:e.year===s.year&&e.eraIndex===s.eraIndex?e.eraIndex!==this.eras.length-1?T+" "+c+" "+m+" - "+y+" "+u+" "+d+" "+g+" "+r:T+" "+c+" "+m+" - "+y+" "+u+" "+d+" "+g:e.eraIndex===s.eraIndex?e.eraIndex!==this.eras.length-1?T+" "+c+" "+m+" "+g+" - "+y+" "+u+" "+d+" "+l+" "+r:T+" "+c+" "+m+" "+g+" - "+y+" "+u+" "+d+" "+l:T+" "+c+" "+m+" "+g+" "+r+" - "+y+" "+u+" "+d+" "+l+" "+h)):(s=t,(Math.max(e.precision,t.precision)===ATTimeUnit.HOUR&&0===t.hour||Math.max(e.precision,t.precision)===ATTimeUnit.MINUTE&&0===t.hour&&0===t.hour||0===t.hour&&0===t.minute&&0===t.second)&&(i=new ATTimeSpan(0,0,0,-1,0,0,0),(s=this.dateByAddingTimespanToDate(t,i)).hour=this.hoursInDay),e.timestamp===s.timestamp?this.naturalStringFromDate(e,!0):(r=this.eraStringFromDate(e),h=this.eraStringFromDate(s),g=this.yearStringFromDate(e),l=this.yearStringFromDate(s),"%d %b %Y"===B?(m=this.shortMonthStringFromDate(e),d=this.shortMonthStringFromDate(s)):(m=this.monthStringFromDate(e),d=this.monthStringFromDate(s)),c=this.dayStringFromDate(e),u=this.dayStringFromDate(s),T=this.weekdays[e.weekdayIndex].name,y=this.weekdays[s.weekdayIndex].name,p=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),R=this.timeStringFromDate(s,Math.max(e.precision,t.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===p.charAt(p.length-2)&&"p"===R.charAt(R.length-2))&&(D=!0),e.eraIndex===s.eraIndex&&e.year===s.year&&e.month===s.month&&e.day===s.day?(D&&(p=p.substr(0,p.length-2)),e.eraIndex!==this.eras.length-1?T+" "+c+" "+m+" "+g+" "+p+" - "+R+" "+r:T+" "+c+" "+m+" "+g+" "+p+" - "+R):e.eraIndex===s.eraIndex&&e.year===s.year&&e.month===s.month?e.eraIndex!==this.eras.length-1?p+" "+T+" "+c+" "+m+" - "+R+" "+y+" "+u+" "+d+" "+g+" "+r:p+" "+T+" "+c+" "+m+" - "+R+" "+y+" "+u+" "+d+" "+g:e.eraIndex!==this.eras.length-1||e.eraIndex!==s.eraIndex?p+" "+T+" "+c+" "+m+" "+g+" "+r+" - "+R+" "+y+" "+u+" "+d+" "+l+" "+h:p+" "+T+" "+c+" "+m+" "+g+" - "+R+" "+y+" "+u+" "+d+" "+l)):Math.max(e.precision,t.precision)===ATTimeUnit.DAY?(i=new ATTimeSpan(0,0,0,-1,0,0,0),s=this.dateByAddingTimespanToDate(t,i),T=this.weekdays[e.weekdayIndex].name,y=this.weekdays[s.weekdayIndex].name,b=!0,"%Y-%m-%d"===B&&(b=!1),e.timestamp===s.timestamp?this.naturalStringFromDate(e,b):(r=this.eraStringFromDate(e),h=this.eraStringFromDate(s),A=B,I=B,A=A.replace("%d",ATUtilities.numberToTwoDigitString(e.day)),A=A.replace("%m",ATUtilities.numberToTwoDigitString(e.month)),A=A.replace("%Y",ATUtilities.numberToTwoDigitString(e.year)),I=I.replace("%d",ATUtilities.numberToTwoDigitString(s.day)),I=I.replace("%m",ATUtilities.numberToTwoDigitString(s.month)),I=I.replace("%Y",ATUtilities.numberToTwoDigitString(s.year)),b?e.eraIndex===s.eraIndex?e.eraIndex!==this.eras.length-1?T+" "+A+" - "+y+" "+I+" "+r:T+" "+A+" - "+y+" "+I:T+" "+A+" "+r+" - "+y+" "+I+" "+h:e.eraIndex===s.eraIndex?e.eraIndex!==this.eras.length-1?A+" - "+I+" "+r:A+" - "+I:A+" "+r+" - "+I+" "+h)):(s=t,(Math.max(e.precision,t.precision)===ATTimeUnit.HOUR&&0===t.hour||Math.max(e.precision,t.precision)===ATTimeUnit.MINUTE&&0===t.hour&&0===t.hour||0===t.hour&&0===t.minute&&0===t.second)&&(i=new ATTimeSpan(0,0,0,-1,0,0,0),(s=this.dateByAddingTimespanToDate(t,i)).hour=this.hoursInDay),T=this.weekdays[e.weekdayIndex].name,y=this.weekdays[s.weekdayIndex].name,b=!0,"%Y-%m-%d"===B&&(b=!1),e.timestamp===s.timestamp?this.naturalStringFromDate(e,b):(r=this.eraStringFromDate(e),h=this.eraStringFromDate(s),A=B,I=B,A=A.replace("%d",ATUtilities.numberToTwoDigitString(e.day)),A=A.replace("%m",ATUtilities.numberToTwoDigitString(e.month)),A=A.replace("%Y",ATUtilities.numberToTwoDigitString(e.year)),I=I.replace("%d",ATUtilities.numberToTwoDigitString(s.day)),I=I.replace("%m",ATUtilities.numberToTwoDigitString(s.month)),I=I.replace("%Y",ATUtilities.numberToTwoDigitString(s.year)),p=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),R=this.timeStringFromDate(s,Math.max(e.precision,t.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===p.charAt(p.length-2)&&"p"===R.charAt(R.length-2))&&(D=!0),e.eraIndex===s.eraIndex&&e.year===s.year&&e.month===s.month&&e.day===s.day?(D&&(p=p.substr(0,p.length-2)),b?e.eraIndex!==this.eras.length-1?T+" "+A+" "+p+" - "+R+" "+r:T+" "+A+" "+p+" - "+R:e.eraIndex!==this.eras.length-1?A+" "+p+" - "+R+" "+r:A+" "+p+" - "+R):b?e.eraIndex!==s.eraIndex||e.eraIndex!==this.eras.length-1?T+" "+A+" "+p+" "+r+" - "+y+" "+I+" "+R+" "+h:T+" "+A+" "+p+" - "+y+" "+I+" "+R:e.eraIndex!==s.eraIndex||e.eraIndex!==this.eras.length-1?A+" "+p+" "+r+" - "+I+" "+R+" "+h:A+" "+p+" - "+I+" "+R)):this.calendarType===ATCalendarType.CALENDAR_TYPE_DAY_TIME?Math.max(e.precision,t.precision)===ATTimeUnit.DAY?(x=this.getDaysSinceZeroDate(e),f=this.getDaysSinceZeroDate(t),x===f-1?this.naturalStringFromDate(e,!0):"Day "+x.toString()+" - "+(f-1).toString()):Math.max(e.precision,t.precision)===ATTimeUnit.HOUR?(x=this.getDaysSinceZeroDate(e),f=this.getDaysSinceZeroDate(t),U=this.getHoursSinceZeroDate(e),k=this.getHoursSinceZeroDate(t),P=U-x*this.hoursInDay,W=k-f*this.hoursInDay,p=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),R=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===R.charAt(R.length-2)&&"p"===R.charAt(R.length-2))&&(D=!0),P<0&&x--,W<0&&f--,x===f?(D&&(p=p.substr(0,p.length-2)),p+" - "+R+" Day "+x.toString()):p+" Day "+x.toString()+" - "+R+" Day "+f.toString()):Math.max(e.precision,t.precision)===ATTimeUnit.MINUTE?(x=this.getDaysSinceZeroDate(e),f=this.getDaysSinceZeroDate(t),U=this.getHoursSinceZeroDate(e),k=this.getHoursSinceZeroDate(t),P=U-x*this.hoursInDay,W=k-f*this.hoursInDay,p=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),R=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===p.charAt(p.length-2)&&"p"===R.charAt(R.length-2))&&(D=!0),P<0?x--:0===P&&(_=(E=this.getMinutesSinceZeroDate(e))-60*U)<0&&x--,W<0?f--:0===W&&(v=(M=this.getMinutesSinceZeroDate(t))-60*k)<0&&f--,x===f?(D&&(p=p.substr(0,p.length-2)),p+" - "+R+" Day "+x.toString()):p+" Day "+x.toString()+" - "+R+" Day "+f.toString()):(x=this.getDaysSinceZeroDate(e),f=this.getDaysSinceZeroDate(t),U=this.getHoursSinceZeroDate(e),k=this.getHoursSinceZeroDate(t),P=U-x*this.hoursInDay,W=k-f*this.hoursInDay,p=this.timeStringFromDate(e,Math.max(e.precision,t.precision)),R=this.timeStringFromDate(t,Math.max(e.precision,t.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===p.charAt(p.length-2)||"p"===R.charAt(R.length-2))&&(D=!0),P<0?x--:0===P&&((_=E-60*(U=this.getMinutesSinceZeroDate(e)))<0?x--:0===_&&this.getSecondsSinceZeroDate(e)-60*E<0&&x--),W<0?f--:0===W&&((v=(M=this.getMinutesSinceZeroDate(e))-60*k)<0?f--:0===v&&this.getSecondsSinceZeroDate(t)-60*M<0&&f--),x===f?(D&&(p=p.substr(0,p.length-2)),p+" - "+R+" Day "+x.toString()):p+" Day "+x.toString()+" - "+R+" Day "+f.toString()):this.calendarType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME?Math.max(e.precision,t.precision)===ATTimeUnit.WEEK?(S=this.getWeeksSinceZeroDate(e),w=this.getWeeksSinceZeroDate(t),S===w-1?this.naturalStringFromDate(e):"Week "+S.toString()+" - "+(w-1).toString()):Math.max(e.precision,t.precision)===ATTimeUnit.DAY?(o=new ATTimeSpan(0,0,0,-1,0,0,0),s=this.dateByAddingTimespanToDate(t,o),Y=this.weekdays[e.weekdayIndex].name,S=this.getWeeksSinceZeroDate(e),x=this.getDaysSinceZeroDate(e),N=x-S*this.weekdays.length,C=this.weekdays[s.weekdayIndex].name,w=this.getWeeksSinceZeroDate(s),f=this.getDaysSinceZeroDate(s),F=f-w*this.weekdays.length,N<0&&S--,F<0&&w--,S===w?Y!==C?Y+" - "+C+" Week "+S.toString():Y+" Week "+S.toString():Y+" Week "+S.toString()+" - "+C+" Week "+w.toString()):(s=t,(Math.max(e.precision,t.precision)===ATTimeUnit.HOUR&&0===t.hour||Math.max(e.precision,t.precision)===ATTimeUnit.MINUTE&&0===t.hour&&0===t.minute||0===t.hour&&0===t.minute&&0===t.second)&&"%I:%M:%S"!==this.timeFormat&&(o=new ATTimeSpan(0,0,0,-1,0,0,0),(s=this.dateByAddingTimespanToDate(t,o)).hour=this.hoursInDay),Math.max(e.precision,t.precision)===ATTimeUnit.HOUR?(Y=this.weekdays[e.weekdayIndex].name,S=this.getWeeksSinceZeroDate(e),x=this.getDaysSinceZeroDate(e),N=x-S*this.weekdays.length,C=this.weekdays[s.weekdayIndex].name,w=this.getWeeksSinceZeroDate(s),f=this.getDaysSinceZeroDate(s),F=f-w*this.weekdays.length,N<0?S--:0===N&&(P=(U=this.getHoursSinceZeroDate(e))-x*this.hoursInDay)<0&&S--,F<0?w--:0===F&&(W=(k=this.getHoursSinceZeroDate(s))-f*this.hoursInDay)<0&&w--,p=this.timeStringFromDate(e,Math.max(e.precision,s.precision)),R=this.timeStringFromDate(s,Math.max(e.precision,s.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===p.charAt(p.length-2)&&"p"===R.charAt(R.length-2))&&(D=!0),e.weekdayIndex===s.weekdayIndex&&S===w?(D&&(p=p.substr(0,p.length-2)),p+" - "+R+" "+Y+" Week "+S.toString()):S===w?p+" "+Y+" - "+R+" "+C+" Week "+S.toString():p+" "+Y+" Week "+S.toString()+" - "+R+" "+C+" Week "+w.toString()):Math.max(e.precision,t.precision)===ATTimeUnit.MINUTE?(Y=this.weekdays[e.weekdayIndex].name,S=this.getWeeksSinceZeroDate(e),x=this.getDaysSinceZeroDate(e),N=x-S*this.weekdays.length,C=this.weekdays[s.weekdayIndex].name,w=this.getWeeksSinceZeroDate(s),f=this.getDaysSinceZeroDate(s),F=f-w*this.weekdays.length,N<0?S--:0===N&&((P=(U=this.getHoursSinceZeroDate(e))-x*this.hoursInDay)<0?S--:0===P&&(_=(E=this.getMinutesSinceZeroDate(e))-60*U)<0&&S--),F<0?w--:0===F&&((W=(k=this.getHoursSinceZeroDate(s))-f*this.hoursInDay)<0?w--:0===W&&(v=(M=this.getMinutesSinceZeroDate(s))-60*k)<0&&w--),p=this.timeStringFromDate(e,Math.max(e.precision,s.precision)),R=this.timeStringFromDate(s,Math.max(e.precision,s.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===p.charAt(p.length-2)&&"p"===R.charAt(R.length-2))&&(D=!0),e.weekdayIndex===s.weekdayIndex&&S===w?(D&&(p=p.substr(0,p.length-2)),p+" - "+R+" "+Y+" Week "+S.toString()):S===w?p+" "+Y+" - "+R+" "+C+" Week "+S.toString():p+" "+Y+" Week "+S.toString()+" - "+R+" "+C+" Week "+w.toString()):(Y=this.weekdays[e.weekdayIndex].name,S=this.getWeeksSinceZeroDate(e),x=this.getDaysSinceZeroDate(e),N=x-S*this.weekdays.length,C=this.weekdays[s.weekdayIndex].name,w=this.getWeeksSinceZeroDate(s),f=this.getDaysSinceZeroDate(s),F=f-w*this.weekdays.length,N<0&&S--,0===N&&((P=(U=this.getHoursSinceZeroDate(e))-x*this.hoursInDay)<0?S--:0===P&&((_=(E=this.getHoursSinceZeroDate(e))-60*U)<0?S--:0===_&&this.getSecondsSinceZeroDate(e)-60*E<0&&S--)),F<0&&w--,0===F&&((W=(k=this.getHoursSinceZeroDate(s))-f*this.hoursInDay)<0?k--:0===W&&((v=(M=this.getHoursSinceZeroDate(s))-60*k)<0?w--:0===v&&this.getSecondsSinceZeroDate(s)-60*M<0&&w--)),p=this.timeStringFromDate(e,Math.max(e.precision,s.precision)),R=this.timeStringFromDate(s,Math.max(e.precision,s.precision)),D=!1,("a"===p.charAt(p.length-2)&&"a"===R.charAt(R.length-2)||"p"===p.charAt(R.length-2)||"p"===R.charAt(R.length-2))&&(D=!0),e.weekdayIndex===s.weekdayIndex&&S===w?(D&&(p=p.substr(0,p.length-2)),p+" - "+R+" "+Y+" Week "+S.toString()):S===w?p+" "+Y+" - "+R+" "+C+" Week "+S.toString():p+" "+Y+" Week "+S.toString()+" - "+R+" "+C+" Week "+w.toString())):this.naturalStringFromDate(e,!0)+" - "+this.naturalStringFromDate(t,!0)},ATCalendar.prototype.eraStringFromDate=function(e){return this.eras[e.eraIndex].name},ATCalendar.prototype.yearStringFromDate=function(e){return e.year>1e9?e.year%1e9<1e6?ATUtilities.floatToYear(e.year/1e9).toString()+" billion":(e.year/1e9).toString()+" billion":e.year>1e6?e.year%1e6<1e3?ATUtilities.floatToYear(e.year%1e6).toString()+" million":(e.year/1e6).toString()+" million":e.year.toString()},ATCalendar.prototype.monthStringFromDate=function(e){return this.months[e.month-1].name},ATCalendar.prototype.shortMonthStringFromDate=function(e){return this.months[e.month-1].shortName},ATCalendar.prototype.dayStringFromDate=function(e){return e.day.toString()},ATCalendar.prototype.timeStringFromDate=function(e,t){var n,a=this.timeFormat,i="",o=":",s=t;if(void 0===s&&(s=e.precision),-1!==a.indexOf("%I")){if(24===e.hour)return"midnight";switch(i=e.hour>=this.hoursInDay/2?"pm":"am",0===(n=e.hour%(this.hoursInDay/2))&&(n=this.hoursInDay/2),s){case ATTimeUnit.HOUR:return n.toString()+i;case ATTimeUnit.MINUTE:return n.toString()+o+ATUtilities.numberToTwoDigitString(e.minute)+i;case ATTimeUnit.SECOND:return n.toString()+o+ATUtilities.numberToTwoDigitString(e.minute)+o+ATUtilities.numberToTwoDigitString(e.second)+i;default:return""}}if("%H%M"===a)return o="",i="h",ATUtilities.numberToTwoDigitString(e.hour)+ATUtilities.numberToTwoDigitString(e.minute)+i;switch(s){case ATTimeUnit.HOUR:return e.hour.toString()+o+"00"+i;case ATTimeUnit.MINUTE:return e.hour.toString()+o+ATUtilities.numberToTwoDigitString(e.minute)+i;case ATTimeUnit.SECOND:return e.hour.toString()+o+ATUtilities.numberToTwoDigitString(e.minute)+o+ATUtilities.numberToTwoDigitString(e.second)+i;default:return""}},ATCalendar.prototype.modifyWeekdayInMatchResult=function(e,t){var n,a,i,o;e.weekdayRange.length>0&&(n=this.weekdays[e.date.weekdayIndex].name,t&&(n=this.weekdays[e.date.weekdayIndex].shortName),a=e.weekdayRange,(i=new ATRange(a.location,a.length)).length=n.length,o=i.length-a.length,e.text=ATUtilities.replaceStringBetween(e.text,e.weekdayRange.location,e.weekdayRange.location+e.weekdayRange.length,n),e.weekdayRange.length=i.length,e.eraRange.location>a.location&&(e.eraRange.location+=o),e.yearRange.location>a.location&&(e.yearRange.location+=o),e.monthRange.location>a.location&&(e.monthRange.location+=o),e.dayRange.location>a.location&&(e.dayRange.location+=o),e.hourRange.location>a.location&&(e.hourRange.location+=o),e.minuteRange.location>a.location&&(e.minuteRange.location+=o),e.secondRange.location>a.location&&(e.secondRange.location+=o),e.amPmRange.location>a.location&&(e.amPmRange.location+=o),e.midnightRange.location>a.location&&(e.midnightRange.location+=o),e.selection.location>a.location&&(e.selection.location+=o),e.updatedCursorPosition>a.location&&(e.updatedCursorPosition+=o))},ATCalendar.prototype._isStandardMonths=function(){return 12===this.months.length&&(31===this.months[0].normalDuration&&31===this.months[0].leapDuration&&(28===this.months[1].normalDuration&&29===this.months[1].leapDuration&&(31===this.months[2].normalDuration&&31===this.months[2].leapDuration&&(30===this.months[3].normalDuration&&30===this.months[3].leapDuration&&(31===this.months[4].normalDuration&&31===this.months[4].leapDuration&&(30===this.months[5].normalDuration&&30===this.months[5].leapDuration&&(31===this.months[6].normalDuration&&31===this.months[6].leapDuration&&(31===this.months[7].normalDuration&&31===this.months[7].leapDuration&&(30===this.months[8].normalDuration&&30===this.months[8].leapDuration&&(31===this.months[9].normalDuration&&31===this.months[9].leapDuration&&(30===this.months[10].normalDuration&&30===this.months[10].leapDuration&&(31===this.months[11].normalDuration&&31===this.months[11].leapDuration))))))))))))},ATCalendar.prototype._toDaysSinceCalcZero=function(e,t,n,a){var i=n,o=t,s=a;return e?(i=(i+9)%12,365*(o-=ATUtilities.floatToInt(i/10))+ATUtilities.floatToInt(o/4)-ATUtilities.floatToInt(o/100)+ATUtilities.floatToInt(o/400)+ATUtilities.floatToInt((306*i+5)/10)+(s-1)):(i=(i+9)%12,365*(o+=ATUtilities.floatToInt(i/10))-ATUtilities.floatToInt((306*i+5)/10)+(s-1))},ATCalendar.prototype._fromDaysSinceCalcZero=function(e,t,n){var a,i,o,s;t?((i=e-(365*(a=ATUtilities.floatToInt((1e4*e+14780)/3652425))+ATUtilities.floatToInt(a/4)-ATUtilities.floatToInt(a/100)+ATUtilities.floatToInt(a/400)))<0&&(i=e-(365*--a+ATUtilities.floatToInt(a/4)-ATUtilities.floatToInt(a/100)+ATUtilities.floatToInt(a/400))),o=ATUtilities.floatToInt((52+100*i)/3060),n.year=a+ATUtilities.floatToInt((o+2)/12),n.month=ATUtilities.floatToInt((o+2)%12)+1,n.day=i-ATUtilities.floatToInt((306*o+5)/10)+1):((s=365*(a=e/365)-e)<0&&(s=e-365*++a),o=ATUtilities.floatToInt((52+100*s)/3060),n.year=a-ATUtilities.floatToInt((o+2)/12),n.month=ATUtilities.floatToInt((o+2)%12)+1,n.day=s-ATUtilities.floatToInt((306*o+5)/10)+1)},ATCalendar.prototype.incrementDateString=function(e,t,n){var a,i,o,s,r,h,g,l,m,d,c,u,T,y,p,R,D,A,I=t,S=new ATRange(I,0),w=new ATStringSelection(e,S),x=this.dateWithPartialString(e,I,!0),f=!1,U=!1,k=!1,E=!1,M=!1,Y=!1,C=!1,N=!1,F=!1,P=new ATRange(I,0),W="",_=-1!==this.timeFormat.indexOf("%I");if(I=x.updatedCursorPosition,this.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME)x.eraRange.contains(I)?(a=x.date.eraIndex+n)>=0&&a<this.eras.length&&(U=!0,f=!0,P=x.eraRange,i=e.substring(x.eraRange.location,x.eraRange.location+x.eraRange.length),o=matchWithPseudoBoundary(this.longEraNameRegExp,e),W=(s=matchWithPseudoBoundary(this.shortEraNameRegExp,e))?this.eras[a].shortName:this.eras[a].name):x.yearRange.contains(I)?(r=x.validDate?x.date.year:parseInt(e.substring(x.yearRange.location,x.yearRange.location+x.yearRange.length)),(r+=n)>0&&(f=!0,k=!0,P=x.yearRange,W=r.toString())):x.monthRange.contains(I)?(r=x.validDate?x.date.month:parseInt(e.substring(x.monthRange.location,x.monthRange.location+x.monthRange.length)),(r+=n)<=0&&(r=this.months.length),r>this.months.length&&(r=1),f=!0,E=!0,i=e.substring(x.monthRange.location,x.monthRange.location+x.monthRange.length),o=matchWithPseudoBoundary(this.longMonthNameRegExp,i),s=matchWithPseudoBoundary(this.shortMonthNameRegExp,i),o?(P=x.monthRange,W=this.months[r-1].name):s?(P=x.monthRange,W=this.months[r-1].shortName):(P=x.monthRange,W=r.toString())):x.dayRange.contains(I)||x.weekdayRange.contains(I)?(r=x.validDate?x.date.day:parseInt(e.substring(x.dayRange.location,x.dayRange.location+x.dayRange.length)),(r+=n)<=0&&(r=this.maximumDaysInAnyMonth),r>this.maximumDaysInAnyMonth&&(r=1),f=!0,M=!0,P=x.dayRange,W=r.toString()):x.hourRange.contains(I)?(r=x.validDate?x.date.hour:parseInt(e.substring(x.hourRange.location,x.hourRange.location+x.hourRange.length)),(r+=n)<0&&(r=this.hoursInDay-1),r>=this.hoursInDay&&(r=0),-1!==x.amPmRange.location&&((r<this.hoursInDay/2||r===this.hoursInDay)&&(x.date.hour<this.hoursInDay/2||x.date.hour===this.hoursInDay)||r>=this.hoursInDay/2&&r<this.hoursInDay-1&&x.date.hour>=this.hoursInDay/2&&x.date.hour<this.hoursInDay-1||(h=!1,g="","AM"===(l=e.substring(x.amPmRange.location,x.amPmRange.location+x.amPmRange.length))?(g="PM",h=!0):"am"===l?(g="pm",h=!0):"pm"===l?(g="am",h=!0):"PM"===l?(g="AM",h=!0):"aM"===l?(g="pM",h=!0):"Am"===l?(g="Pm",h=!0):"pM"===l?(g="aM",h=!0):"Pm"===l&&(g="Am",h=!0),h&&(w.text=ATUtilities.replaceStringBetween(w.text,x.amPmRange.location,x.amPmRange.location+x.amPmRange.length,g))),r>this.hoursInDay/2&&(r-=this.hoursInDay/2),0===r&&(r=this.hoursInDay/2)),f=!0,Y=!0,P=x.hourRange,W=r.toString()):x.minuteRange.contains(I)?(r=x.validDate?x.date.minute:parseInt(e.substring(x.minuteRange.location,x.minuteRange.location+x.minuteRange.length)),(r+=n)<0&&(r=59),r>59&&(r=0),f=!0,C=!0,P=x.minuteRange,W=ATUtilities.numberToTwoDigitString(r)):x.secondRange.contains(I)?(r=x.validDate?x.date.second:parseInt(e.substring(x.secondRange.location,x.secondRange.location+x.secondRange.length)),(r+=n)<0&&(r=59),r>59&&(r=0),f=!0,N=!0,P=x.secondRange,W=ATUtilities.numberToTwoDigitString(r)):x.amPmRange.contains(I)?(l=e.substring(x.amPmRange.location,x.amPmRange.location+x.amPmRange.length),f=!0,F=!0,P=x.amPmRange,W=ATUtilities.caseInsensitiveCompare(l,"am")?"pm":"am"):x.midnightRange.contains(I)&&(f=!0,Y=!0,P=x.midnightRange,n>0?(W=_?"1:00am":"1:00",x.hourRange.location=x.midnightRange.location,x.hourRange.length=1,x.minuteRange.location=x.hourRange.location+2,x.minuteRange.length=2,x.amPmRange.location=_?x.minuteRange.location+2:-1,x.amPmRange.length=_?2:0):(W=_?"11:00pm":"23:00",x.hourRange.location=x.midnightRange.location,x.hourRange.length=2,x.minuteRange.location=x.hourRange.location+2,x.minuteRange.length=2,x.amPmRange.location=_?x.minuteRange.location+2:-1,x.amPmRange.length=_?2:0));else if(this.calendarType===ATCalendarType.CALENDAR_TYPE_HOUR_TIME)x.negationRange.contains(I)&&!x.hourRange.contains(I)?(m=!0,(c=this.getHoursSinceZeroDate(x.date))<0?m=!1:0===c&&((u=this.getMinutesSinceZeroDate(x.date))<0?m=!1:0===u&&this.getSecondsSinceZeroDate(x.date)<0&&(m=!1)),f=!0,P=x.negationRange,W=m?"-":"+"):x.hourRange.contains(I)?(r=(c=Math.abs(this.getHoursSinceZeroDate(x.date)))+n)<0?f=!1:(f=!0,P=x.hourRange,W=r.toString()):x.minuteRange.contains(I)?(c=this.getHoursSinceZeroDate(x.date),u=this.getMinutesSinceZeroDate(x.date),(r=Math.abs(u-60*c)+n)<0&&(r=59),r>59&&(r=0),f=!0,P=x.minuteRange,W=ATUtilities.numberToTwoDigitString(r)):x.secondRange.contains(I)&&(u=this.getMinutesSinceZeroDate(x.date),T=this.getSecondsSinceZeroDate(x.date),(r=Math.abs(T-60*u)+n)<0&&(r=59),r>59&&(r=0),f=!0,P=x.secondRange,W=ATUtilities.numberToTwoDigitString(r));else if(this.calendarType===ATCalendarType.CALENDAR_TYPE_DAY_TIME)x.floatingDayRange.contains(I)?(f=!0,(d=this.getDaysSinceZeroDate(x.date))<=0&&x.date.timestamp<this.zeroDate.timestamp&&(x.date.hour!==this.zeroDate.hour||x.date.minute!==this.zeroDate.minute||x.date.second!==this.zeroDate.second)&&d--,r=d+n,P=x.floatingDayRange,W=r.toString()):x.hourRange.contains(I)?((r=x.date.hour+n)<0&&(r=this.hoursInDay-1),r>=this.hoursInDay&&(r=0),-1!==x.amPmRange.location&&((r<this.hoursInDay/2||r===this.hoursInDay)&&(x.date.hour<this.hoursInDay/2||x.date.hour===this.hoursInDay)||r>this.hoursInDay/2&&r<this.hoursInDay-1&&x.date.hour>=this.hoursInDay/2&&x.date.hour<this.hoursInDay-1||(h=!1,g="","AM"===(l=e.substring(x.amPmRange.location,x.amPmRange.location+x.amPmRange.length))?(g="PM",h=!0):"am"===l?(g="pm",h=!0):"pm"===l?(g="am",h=!0):"PM"===l?(g="AM",h=!0):"aM"===l?(g="pM",h=!0):"Am"===l?(g="Pm",h=!0):"pM"===l?(g="aM",h=!0):"Pm"===l&&(g="Am",h=!0),h&&ATUtilities.replaceStringBetween(w.text,x.amPmRange.location,x.amPmRange.location+x.amPmRange.length,g)),r>this.hoursInDay/2&&(r-=this.hoursInDay/2)),f=!0,P=x.hourRange,W=r.toString()):x.minuteRange.contains(I)?((r=x.date.minute+n)<0&&(r=59),r>59&&(r=0),f=!0,P=x.minuteRange,W=ATUtilities.numberToTwoDigitString(r)):x.secondRange.contains(I)?((r=x.date.second+n)<0&&(r=59),r>59&&(r=0),f=!0,P=x.secondRange,W=ATUtilities.numberToTwoDigitString(r)):x.amPmRange.contains(I)?(l=e.substring(x.amPmRange.location,x.amPmRange.location+x.amPmRange.length),f=!0,F=!0,P=x.amPmRange,W=ATUtilities.caseInsensitiveCompare(l,"am")?"pm":"am"):x.midnightRange.contains(I)&&(f=!0,Y=!0,P=x.midnightRange,n>0?(W=_?"1:00am":"1:00",x.hourRange.location=x.midnightRange.location,x.hourRange.length=1,x.minuteRange.location=x.hourRange.location+2,x.minuteRange.length=2,x.amPmRange.location=_?x.minuteRange.location+2:-1,x.amPmRange.length=_?2:0):(W=_?"11:00pm":"23:00",x.hourRange.location=x.midnightRange.location,x.hourRange.length=2,x.minuteRange.location=x.hourRange.location+2,x.minuteRange.length=2,x.amPmRange.location=_?x.minuteRange.location+2:-1,x.amPmRange.length=_?2:0));else if(this.calendarType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME)if(x.weekRange.contains(I))f=!0,(y=this.getWeeksSinceZeroDate(x.date))<=0&&x.date.timestamp<this.zeroDate.timestamp&&(x.date.weekdayIndex!==this.zeroDate.weekdayIndex||x.date.hour!==this.zeroDate.hour||x.date.minute!==this.zeroDate.minute||x.date.second!==this.zeroDate.second)&&y--,r=y+n,P=x.weekRange,W=r.toString();else if(x.weekdayRange.contains(I)){for(p=e.substr(x.weekdayRange.location,x.weekdayRange.length),D=0,D=0;D<this.weekdays.length;D++)if(ATUtilities.caseInsensitiveCompare(this.weekdays[D].name,p)||ATUtilities.caseInsensitiveCompare(this.weekdays[D].shortName,p)){R=D+n;break}for(R<0&&(R=this.weekdays.length-1);R>=this.weekdays.length;)R-=this.weekdays.length;P=x.weekdayRange,o=matchWithPseudoBoundary(this.longWeekdayNameRegExp,e),W=(s=matchWithPseudoBoundary(this.shortWeekdayNameRegExp,e))?this.weekdays[R].shortName:this.weekdays[R].name,f=!0}else x.hourRange.contains(I)?((r=x.date.hour+n)<0&&(r=this.hoursInDay-1),r>=this.hoursInDay&&(r=0),-1!==x.amPmRange.location&&((r<this.hoursInDay/2||r===this.hoursInDay)&&(x.date.hour<this.hoursInDay/2||x.date.hour===this.hoursInDay)||r>this.hoursInDay/2&&r<this.hoursInDay-1&&x.date.hour>=this.hoursInDay/2&&x.date.hour<this.hoursInDay-1||(h=!1,g="","AM"===(l=e.substring(x.amPmRange.location,x.amPmRange.location+x.amPmRange.length))?(g="PM",h=!0):"am"===l?(g="pm",h=!0):"pm"===l?(g="am",h=!0):"PM"===l?(g="AM",h=!0):"aM"===l?(g="pM",h=!0):"Am"===l?(g="Pm",h=!0):"pM"===l?(g="aM",h=!0):"Pm"===l&&(g="Am",h=!0),h&&(w.text=ATUtilities.replaceStringBetween(w.text,x.amPmRange.location,x.amPmRange.location+x.amPmRange.length,g))),r>this.hoursInDay/2&&(r-=this.hoursInDay/2)),f=!0,P=x.hourRange,W=r.toString()):x.minuteRange.contains(I)?((r=x.date.minute+n)<0&&(r=59),r>59&&(r=0),f=!0,P=x.minuteRange,W=ATUtilities.numberToTwoDigitString(r)):x.amPmRange.contains(I)?(l=e.substring(x.amPmRange.location,x.amPmRange.location+x.amPmRange.length),f=!0,F=!0,P=x.amPmRange,W=ATUtilities.caseInsensitiveCompare(l,"am")?"pm":"am"):x.secondRange.contains(I)?((r=x.date.second+n)<0&&(r=59),r>59&&(r=0),f=!0,P=x.secondRange,W=ATUtilities.numberToTwoDigitString(r)):x.midnightRange.contains(I)&&(f=!0,Y=!0,P=x.midnightRange,n>0?(W=_?"1:00am":"1:00",x.hourRange.location=x.midnightRange.location,x.hourRange.length=1,x.minuteRange.location=x.hourRange.location+2,x.minuteRange.length=2,x.amPmRange.location=_?x.minuteRange.location+2:-1,x.amPmRange.length=_?2:0):(W=_?"11:00pm":"23:00",x.hourRange.location=x.midnightRange.location,x.hourRange.length=2,x.minuteRange.location=x.hourRange.location+2,x.minuteRange.length=2,x.amPmRange.location=_?x.minuteRange.location+2:-1,x.amPmRange.length=_?2:0));return f&&(w.text=ATUtilities.replaceStringBetween(w.text,P.location,P.location+P.length,W),w.selectionRange.location=P.location,w.selectionRange.length=W.length,(A=this.dateWithPartialString(w.text,I,!0)).matchFound&&(w.text=A.text,U?w.selectionRange=A.eraRange:k?w.selectionRange=A.yearRange:E?w.selectionRange=A.monthRange:M?w.selectionRange=A.dayRange:Y?w.selectionRange=A.hourRange:C?w.selectionRange=A.minuteRange:N?w.selectionRange=A.secondRange:F&&(w.selectionRange=A.amPmRange))),w},ATCalendar.prototype.updateStringWithComponents=function(e,t,n,a,i,o){var s,r,h,g,l,m,d,c,u,T,y,p,R,D,A,I,S=new ATRange(t,0),w=new ATStringSelection(e,S);if(w.text=e,this.calendarType!==ATCalendarType.CALENDAR_TYPE_DATE_TIME)return w;if(s=this.dateWithPartialString(e,t,!0),!e||!s.matchFound)return r=n,h=-1===i?this.dateWithComponents(r,a,1,1,0,0,0,ATTimeUnit.YEAR):-1===o?this.dateWithComponents(r,a,i,1,0,0,0,ATTimeUnit.MONTH):this.dateWithComponents(r,a,i,o,0,0,0,ATTimeUnit.DAY),w.text=this.naturalStringFromDate(h,!0,!1,null,"%Y"),w.selectionRange.location=w.text.length,w;if(s.matchFound){if(-1===i)return w.text=a.toString(),(s.eraRange.length>0||n<this.eras.length-1)&&(w.text+=" ",w.text+=this.eras[n].shortName),w.selectionRange.location=w.text.length,w;if(-1===o)return s.monthRange.length>0?(g=e.substring(s.monthRange.location,s.monthRange.location+s.monthRange.length),l=matchWithPseudoBoundary(this.longMonthNameRegExp,g),m=matchWithPseudoBoundary(this.shortMonthNameRegExp,g),w.text=l?this.months[i-1].name:m?this.months[i-1].shortName:this.months[i-1].name):w.text=this.months[i-1].name,w.text+=" ",w.text+=a.toString(),(s.eraRange.length>0||n<this.eras.length-1)&&(w.text+=" ",w.text+=this.eras[n].shortName),w.selectionRange.location=w.text.length,w;if(w.text=s.text,s.weekdayRange.length>0&&(d=this.weekdays[s.date.weekdayIndex].name,c=!0,-1===s.text.search(d)&&(u=this.weekdays[s.date.weekdayIndex].shortName,-1!==s.text.search(u)&&(c=!0,d=u)),T=this.dateWithComponents(s.date.eraIndex,a,i,o,0,0,0),y=c?this.weekdays[T.weekdayIndex].name:this.weekdays[T.weekdayIndex].shortName,w.text=ATUtilities.replaceStringBetween(w.text,s.weekdayRange.location,s.weekdayRange.location+s.weekdayRange.length,y),p=y.length-d.length,s.dayRange.location>s.weekdayRange.location&&(s.dayRange.location+=p),s.monthRange.location>s.weekdayRange.location&&(s.monthRange.location+=p),s.yearRange.location>s.weekdayRange.location&&(s.yearRange.location+=p),s.eraRange.location>s.weekdayRange.location&&(s.eraRange.location+=p)),s.dayRange.length>0){if(R=o.toString(),D=R.length-s.dayRange.length,w.text=ATUtilities.replaceStringBetween(w.text,s.dayRange.location,s.dayRange.location+s.dayRange.length,R),s.monthRange.location>s.dayRange.location&&(s.monthRange.location+=D),s.yearRange.location>s.dayRange.location&&(s.yearRange.location+=D),s.eraRange.location>s.dayRange.location&&(s.eraRange.location+=D),!(s.monthRange.length>0))return w.selectionRange.location=w.text.length,w;g=w.text.substring(s.monthRange.location,s.monthRange.location+s.monthRange.length),l=matchWithPseudoBoundary(this.longMonthNameRegExp,g),m=matchWithPseudoBoundary(this.shortMonthNameRegExp,g),A=l?this.months[i-1].name:m?this.months[i-1].shortName:i.toString(),w.text=ATUtilities.replaceStringBetween(w.text,s.monthRange.location,s.monthRange.location+s.monthRange.length,A),I=A.length-s.monthRange.length,s.yearRange.location>s.monthRange.location&&(s.yearRange.location+=I),s.eraRange.location>s.monthRange.location&&(s.eraRange.location+=I),w.text=ATUtilities.replaceStringBetween(w.text,s.yearRange.location,s.yearRange.location+s.yearRange.length,a.toString()),s.eraRange.length>0?w.text=ATUtilities.replaceStringBetween(w.text,s.eraRange.location,s.eraRange.location+s.eraRange.length,this.eras[n].shortName):n<this.eras.length-1&&(w.text+=" ",w.text+=this.eras[n].shortName)}else w.text=o.toString()+" "+this.months[i-1].name+" "+a.toString(),(s.eraRange.length>0||n<this.eras.length-1)&&(w.text+=" ",w.text+=this.eras[n].shortName)}return w.selectionRange.location=w.text.length,w},ATCalendar.prototype.nextComponentInString=function(e,t){var n,a,i,o=new ATRange(t,0),s=new ATStringSelection(e,o);return s.text=e,s.selectionRange.location=e.length,s.selectionRange.length=0,(n=this.dateWithPartialString(e,t,!1)).matchFound&&(a=Number.MAX_VALUE,i=s.selectionRange,n.eraRange.location>t&&n.eraRange.location<a&&(a=n.eraRange.location,i=n.eraRange),n.yearRange.location>t&&n.yearRange.location<a&&(a=n.yearRange.location,i=n.yearRange),n.monthRange.location>t&&n.monthRange.location<a&&(a=n.monthRange.location,i=n.monthRange),n.dayRange.location>t&&n.dayRange.location<a&&(a=n.dayRange.location,i=n.dayRange),n.hourRange.location>t&&n.hourRange.location<a&&(a=n.hourRange.location,i=n.hourRange),n.minuteRange.location>t&&n.minuteRange.location<a&&(a=n.minuteRange.location,i=n.minuteRange),n.secondRange.location>t&&n.secondRange.location<a&&(a=n.secondRange.location,i=n.secondRange),n.midnightRange.location>t&&n.midnightRange.location<a&&(a=n.midnightRange.location,i=n.midnightRange),n.floatingDayRange.location>t&&n.floatingDayRange.location<a&&(a=n.floatingDayRange.location,i=n.floatingDayRange),this.calendarType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME&&n.weekdayRange.location>t&&n.weekdayRange.location<a&&(a=n.weekdayRange.location,i=n.weekdayRange),n.weekRange.location>t&&n.weekRange.location<a&&(a=n.weekRange.location,i=n.weekRange),n.amPmRange.location>t&&n.amPmRange.location<a&&(a=n.amPmRange.location,i=n.amPmRange),s.selectionRange=i),s},ATCalendar.prototype.previousComponentInString=function(e,t){var n,a,i,o=new ATRange(t,0),s=new ATStringSelection(e,o);return s.text=e,s.selectionRange.location=0,s.selectionRange.length=0,(n=this.dateWithPartialString(e,t,!1)).matchFound&&(a=-1,i=s.selectionRange,n.eraRange.location>=0&&n.eraRange.location+n.eraRange.length<t&&n.eraRange.location>a&&(a=n.eraRange.location,i=n.eraRange),n.yearRange.location>=0&&n.yearRange.location+n.yearRange.length<t&&n.yearRange.location>a&&(a=n.yearRange.location,i=n.yearRange),n.monthRange.location>=0&&n.monthRange.location+n.monthRange.length<t&&n.monthRange.location>a&&(a=n.monthRange.location,i=n.monthRange),n.dayRange.location>=0&&n.dayRange.location+n.dayRange.length<t&&n.dayRange.location>a&&(a=n.dayRange.location,i=n.dayRange),n.hourRange.location>=0&&n.hourRange.location+n.hourRange.length<=t&&n.hourRange.location>a&&(a=n.hourRange.location,i=n.hourRange),n.minuteRange.location>=0&&n.minuteRange.location+n.minuteRange.length<t&&n.minuteRange.location>a&&(a=n.minuteRange.location,i=n.minuteRange),n.secondRange.location>=0&&n.secondRange.location+n.secondRange.length<t&&n.secondRange.location>a&&(a=n.secondRange.location,i=n.secondRange),n.midnightRange.location>=0&&n.midnightRange.location+n.midnightRange.length<t&&n.midnightRange.location>a&&(a=n.midnightRange.location,i=n.midnightRange),this.calendarType===ATCalendarType.CALENDAR_TYPE_HOUR_TIME&&n.negationRange.location>=0&&n.negationRange.location+n.negationRange.length<=t&&n.negationRange.location>a&&(a=n.negationRange.location,i=n.negationRange),n.amPmRange.location>=0&&n.amPmRange.location+n.amPmRange.length<t&&n.amPmRange.location>a&&(a=n.amPmRange.location,i=n.amPmRange),this.calendarType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME&&n.weekdayRange.location>=0&&n.weekdayRange.location+n.weekdayRange.length<t&&n.weekdayRange.location>a&&(a=n.weekdayRange.location,i=n.weekdayRange),s.selectionRange=i),s},ATCalendar.prototype.firstMonthOfYear=function(e,t){var n,a=1;if(this.isLeapYearInEra(t,e)){for(n=0;n<this.months.length;n++)if(this.months[n].leapDuration>0){a=n+1;break}}else for(n=0;n<this.months.length;n++)if(this.months[n].normalDuration>0){a=n+1;break}return a},module.exports=ATCalendar;

},{"../controller/ATDateStringMatchResult":15,"../utils/ATRange":47,"../utils/ATStringSelection":50,"../utils/ATUtilities":51,"./ATCalendarType":22,"./ATDate":23,"./ATDateOrder":24,"./ATEra":31,"./ATMonth":38,"./ATTimeSpan":39,"./ATTimeUnit":40,"./ATWeekday":43,"lodash":333}],22:[function(require,module,exports){
module.exports={CALENDAR_TYPE_DATE_TIME:0,CALENDAR_TYPE_WEEKDAY_TIME:1,CALENDAR_TYPE_DAY_TIME:2,CALENDAR_TYPE_HOUR_TIME:3};

},{}],23:[function(require,module,exports){
var ATDate=function(t,i,e,s,h,n,a,o,r,d){this.timestamp=t,this.eraIndex=i,this.year=e,this.month=s,this.day=h,this.hour=n,this.minute=a,this.second=o,this.weekdayIndex=r,this.precision=d};ATDate.prototype.copy=function(){return new ATDate(this.timestamp,this.eraIndex,this.year,this.month,this.day,this.hour,this.minute,this.second,this.weekdayIndex,this.precision)},module.exports=ATDate;

},{}],24:[function(require,module,exports){
module.exports={DATE_ORDER_YEAR_MONTH_DAY:1,DATE_ORDER_DAY_MONTH_YEAR:2,DATE_ORDER_MONTH_DAY_YEAR:3};

},{}],25:[function(require,module,exports){
var TimelineDisplayConstants=require("../controller/ATDisplayConstants"),ATDependencyPath=function(t,e,s){var n;this.node1=t,this.node2=e,this.startPt=t.get("totalRect").origin.copy(),this.startPt.x=t.get("startPixel"),this.startPt.y+=t.get("lane").get("top")+TimelineDisplayConstants.eventMarkerOffsetFromBoundsTop+TimelineDisplayConstants.eventMarkerCornerRadius,this.endPt=e.get("totalRect").origin.copy(),this.endPt.x=e.get("startPixel"),s&&(this.startPt.x=t.get("stopPixel")),this.endPt.y+=e.get("lane").get("top")+TimelineDisplayConstants.eventMarkerOffsetFromBoundsTop+TimelineDisplayConstants.eventMarkerCornerRadius,this.startPt.x=Math.round(this.startPt.x)+.5,this.startPt.y=Math.round(this.startPt.y)+.5,this.endPt.x=Math.round(this.endPt.x)+.5,this.endPt.y=Math.round(this.endPt.y)+.5,this.startPt.y==this.endPt.y?this.path=" l"+(this.endPt.x-this.startPt.x)+","+(this.endPt.y-this.startPt.y):Math.abs(this.startPt.x-this.endPt.x)<TimelineDisplayConstants.dependencyHookRadius?this.startPt.y<this.endPt.y?this.startPt.x<this.endPt.x?this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0":this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0":(n=this.startPt,this.startPt=this.endPt,this.endPt=n,this.startPt.x>this.endPt.x?this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0":this.path=" l0,"+(this.endPt.y-3*TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" c0,"+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+"  "+-TimelineDisplayConstants.dependencyHookRadius+","+2*TimelineDisplayConstants.dependencyHookRadius+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x)+",0"):this.startPt.y<this.endPt.y?this.startPt.x<this.endPt.x?this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x-TimelineDisplayConstants.dependencyHookRadius)+",0":this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x+TimelineDisplayConstants.dependencyHookRadius)+",0":(n=this.startPt,this.startPt=this.endPt,this.endPt=n,this.startPt.x>this.endPt.x?this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,1  "+-TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x+TimelineDisplayConstants.dependencyHookRadius)+",0":this.path=" l0,"+(this.endPt.y-TimelineDisplayConstants.dependencyHookRadius-this.startPt.y)+" a"+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" 0 0,0  "+TimelineDisplayConstants.dependencyHookRadius+","+TimelineDisplayConstants.dependencyHookRadius+" l"+(this.endPt.x-this.startPt.x-TimelineDisplayConstants.dependencyHookRadius)+",0"),this.name=t.get("lane").id+" "+t.id+" "+e.get("lane").id+" "+e.id};module.exports=ATDependencyPath;

},{"../controller/ATDisplayConstants":16}],26:[function(require,module,exports){
module.exports="00000000-0000-0000-0000-000000000000";

},{}],27:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATUuidIntMap=require("../utils/ATUuidIntMap"),ATEntity=Backbone.Model.extend({defaults:function(){return{name:null,color:null,type:null,sortOrder:0,startTS:0,stopTS:0,hasStart:!1,hasStop:!1,visibleAsColumn:!0,relationships:{}}},initialize:function(){this.fastId=ATUuidIntMap(this.id)},update:function(e){var t,i;if(e.relUpdates||e.relDeletes){i=_.clone(this.get("relationships")),_.each(e.relDeletes,function(e){delete i[e]});for(t in e.relUpdates)e.relUpdates.hasOwnProperty(t)&&(i[t]=e.relUpdates[t]);this.set({relationships:i}),this.trigger("relationshipsChanged")}}});module.exports=ATEntity;

},{"../utils/ATUuidIntMap":52,"backbone":220,"lodash":333}],28:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEmptyGuidString=require("./ATEmptyGuidString"),ATEventNodeList=require("./ATEventNodeList"),ATEntityLane=Backbone.Model.extend({defaults:function(){return{timeline:null,entity:null,top:0,height:0,nameWidth:null,sortOrder:0,collapsed:!1}},initialize:function(){var e=this,t=this.get("timeline").get("events"),i=this.get("entity");this.nodes=new ATEventNodeList,this.layoutRequired=!0,this.relationshipUpdatePending=!1,this.set({sortOrder:i.get("sortOrder")}),this.updateRelationshipNodes(),this.nameChanged(),this.listenTo(t,"add remove",function(){e.relationshipsChanged()}),this.listenTo(i,"change:relationships",function(){e.relationshipsChanged()}),this.listenTo(i,"change:name",function(){e.nameChanged()}),this.listenTo(i,"change:sortOrder",function(){this.set({sortOrder:i.get("sortOrder")})}),this.listenTo(t,"layoutRequired",function(){this.layoutRequired=!0}),this.listenTo(t,"childNodeAdded",function(){this.trigger("childNodeAdded")})},destroy:function(){},scaleChanged:function(e){this.nodes.each(function(t){t.scaleChanged(e)})},eventsChanged:function(){var e=this.get("timeline").get("events"),t=this.nodes,i=[];t.each(function(t){e.get(t.id)||i.push(t)}),t.remove(i)},nameChanged:function(){this.set("nameWidth",window.mainApp.timelineView.calcEntityTextWidth(this.get("entity").get("name")))},relationshipsChanged:function(){this.relationshipUpdatePending=!0},updateRelationshipNodes:function(){var e=this,t=this.get("timeline").get("events"),i=this.get("entity").get("relationships"),n=_.keys(i),d=this.nodes,s=[],h=[],o={};_.each(n,function(n){var h=t.get(n),a=d.get(n);h&&h.get("parentId")==ATEmptyGuidString&&(a?(a.set("role",i[n]),a.childrenChanged(),o[a.id]=a.id):(s.push({id:h.id,lane:e,event:t.findChild(h.id)}),o[h.id]=h.id))}),_.each(n,function(i){var n,h=t.findChild(i);if(h&&h.get("parentId")!=ATEmptyGuidString){for(;h&&h.get("parentId")!=ATEmptyGuidString;)h=t.findChild(h.get("parentId"));h&&!o[h.id]&&((n=d.get(h.id))?(n.set("role","Inherited"),n.childrenChanged(),o[n.id]=n.id):(s.push({id:h.id,lane:e,event:t.findChild(h.id)}),o[h.id]=h.id))}}),d.each(function(e){_.includes(o,e.id)&&t.get(e.id)||h.push(e)}),d.remove(h),d.set(s,{remove:!1}),this.relationshipUpdatePending=!1}});module.exports=ATEntityLane;

},{"./ATEmptyGuidString":26,"./ATEventNodeList":35,"backbone":220,"lodash":333}],29:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEntityLane=require("./ATEntityLane"),ATEntityLaneList=Backbone.Collection.extend({model:ATEntityLane,comparator:"sortOrder",initialize:function(){this.listenTo(this,"change:collapsed",function(){this.trigger("laneCollapsed")}),this.listenTo(this,"change:sortOrder",function(){this.sort()})}});module.exports=ATEntityLaneList;

},{"./ATEntityLane":28,"backbone":220,"lodash":333}],30:[function(require,module,exports){
var Backbone=require("backbone"),ATEntity=require("./ATEntity"),ATEntityList=Backbone.Collection.extend({model:ATEntity,comparator:"name"});module.exports=ATEntityList;

},{"./ATEntity":27,"backbone":220}],31:[function(require,module,exports){
var ATEra=function(s,a,i,t,h,r){this.index=s,this.name=a,this.shortName=i,this.duration=t,this.isBackwards=h,this.hasLeap=r};module.exports=ATEra;

},{}],32:[function(require,module,exports){
var _=require("lodash"),ATEmptyGuidString=require("./ATEmptyGuidString"),Backbone=require("backbone"),ATFilterResult=require("./ATFilterResult"),ATUuidIntMap=require("../utils/ATUuidIntMap"),ATEvent=Backbone.Model.extend({defaults:function(){return{title:null,displayId:null,startTS:null,endTS:null,precision:null,dateString:null,durationString:null,filterResult:ATFilterResult.MATCH,isFaded:!1,parentId:ATEmptyGuidString,nestingLevel:0,values:{},links:[],attachments:[],tags:[],imagePath:null,fullImagePath:null,relationships:[],color:null,priority:500,dependencies:{},successors:[],selected:!1}},initialize:function(){var t=require("./ATEventList");this.children=new t,this.fastId=ATUuidIntMap(this.id),this.listenTo(this,"change:relationships",this.updateRelationshipFastIds.bind(this)),this.listenTo(this,"change:title change:displayId change:startTS change:endTS change:duration",this.displayTitleChanged.bind(this)),window.mainApp.isIos||this.listenTo(this,"change:values change:relationships change:dateString change:tags change:links change:imagePath change:fullImagePath change:attachments",this.valuesChanged.bind(this)),this.updateRelationshipFastIds(),this.displayTitleChanged(),this.valuesChanged()},updateRelationshipFastIds:function(){_.each(this.get("relationships"),function(t){t.fastEntityId=ATUuidIntMap(t.entityId)})},displayTitleChanged:function(){var t=window.mainApp.displaySettings.showEventId,e=this.get("durationString"),i=e.length>0&&window.mainApp.displaySettings.showDurationInTitle;this.set("displayTitle",(t?this.get("displayId")+". ":"")+this.get("title")+(i?" ["+e+"]":"")),window.mainApp.timelineView.eventTextCalculator.addEvent(this)},valuesChanged:function(){this.displayTemplateChanged(),window.mainApp.isIos||window.mainApp.timelineView.eventTextCalculator.addEvent(this)},displayTemplateChanged:function(){this.set("contentHTML",window.mainApp.timelineView.moreTemplate({event:this})),this.children.each(function(t){t.displayTemplateChanged()})},displayTitleSettingsChanged:function(){this.displayTitleChanged(),this.children.each(function(t){t.displayTitleSettingsChanged()})},update:function(t){var e,i,n=this,a=this.children,s=t.valueUpdates;if(s){e=_.clone(this.get("values"));for(i in s)s.hasOwnProperty(i)&&(e[i]=s[i]);this.set({values:e}),this.set("nestingLevel",(this.get("displayId").match(/\./g)||[]).length)}t.childUpdates&&_.each(t.childUpdates,function(t){var e=_.pick(t,"id","title","displayId","startTS","endTS","precision","dateString","durationString","color","priority","links","attachments","imagePath","fullImagePath","tags","filterResult","isFaded","dependencies","successors","relationships");e.parentId=n.id,a.set([e],{remove:!1}),a.get(t.id).update(t)}),t.childDeletes&&a.remove(t.childDeletes)},appendAllDescendants:function(t){var e=this.children;return t.push.apply(t,e.models),e.each(function(e){e.appendAllDescendants(t)}),t},hasChildInIdMap:function(t){var e,i=this.children.length,n=this.children.models;if(t[this.id])return!0;for(e=0;e<i;e++)if(n[e].hasChildInIdMap(t))return!0;return!1},matchString:function(t){var e=this.get("title"),i=new RegExp(t,"i");return!!e.match(i)},displayColor:function(){return this.get("color")}});module.exports=ATEvent;

},{"../utils/ATUuidIntMap":52,"./ATEmptyGuidString":26,"./ATEventList":33,"./ATFilterResult":36,"backbone":220,"lodash":333}],33:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEvent=require("./ATEvent"),ATEventList=Backbone.Collection.extend({model:ATEvent,findChild:function(e){var n,t,i,r=this.get(e);if(r)return r;for(t=this.length,i=0;i<t;i++)if(n=this.at(i),r=n.children.findChild(e))return r;return null}});module.exports=ATEventList;

},{"./ATEvent":32,"backbone":220,"lodash":333}],34:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),TimelineDisplayConstants=require("../controller/ATDisplayConstants"),ATFilterResult=require("./ATFilterResult"),ATPoint=require("../utils/ATPoint"),ATRect=require("../utils/ATRect"),ATSize=require("../utils/ATSize"),ATEventNode=Backbone.Model.extend({defaults:function(){return{event:null,lane:null,role:null,contentHTML:null,startPixel:null,stopPixel:null,displayTitle:null,showChildNodes:!1,showMore:!1,textSize:new ATSize(0,0),parentTextSize:new ATSize(0,0),smallTextSize:new ATSize(0,0),bigTextSize:new ATSize(0,0),markerRect:new ATRect(TimelineDisplayConstants.eventMarkerOffsetFromBoundsLeft,TimelineDisplayConstants.eventMarkerOffsetFromBoundsTop,0,2*TimelineDisplayConstants.eventMarkerCornerRadius),totalRect:new ATRect(0,0,0,0),relationshipTotalRect:new ATRect(0,0,0,0),smallTotalRect:new ATRect(0,0,0,0),markerPoints:[],bulletPos:null,selected:!1,relationshipRect:new ATRect(0,0,0,0),relationshipLineYPixel:0}},initialize:function(){var e,t=this,i=this.get("lane"),n=this.get("event"),s=n.children,h=i.get("entity").attributes.relationships,a=[];this.fastId=n.fastId;var l=require("./ATEventNodeList");this.childNodes=new l,this.childRect=new ATRect(0,0,0,0),e=this.childNodes,this.calcTextSizeRequired=!0,this.calcRectsRequired=!0,this.calcBigTextRequired=!0,this.calcEventTextRequired=!1,h[this.id]?this.set("role",h[this.id]):this.set("role","Inherited"),this.updateDisplayTitle(),s.each(function(e){e.hasChildInIdMap(h)&&a.push({id:e.id,lane:i,event:e})}),e.set(a,{remove:!1}),this.useScale=window.mainApp.timelineViewModel.get("unitScale"),this.listenTo(n.children,"add remove",function(){t.childrenChanged()}),this.listenTo(n,"change:startTS change:endTS change:maxScale change:filterResult",function(){t.scaleChanged(t.useScale)}),this.listenTo(n,"change:displayTitle",this.updateDisplayTitle.bind(this)),this.listenTo(n,"change:textSize change:narrowRelTextSize change:wideRelTextSize",this.updateEventTextSize.bind(this)),this.listenTo(n,"change:displayTitle change:values change:relationships change:tags change:links change:imagePath change:fullImagePath change:attachments",function(){t.valuesChanged()}),this.listenTo(this,"change:showMore",function(){t.showMoreChanged()}),this.listenTo(this,"change:showChildNodes",function(){t.showChildNodesChanged()}),this.listenTo(n,"change:selected",this.selectionChanged),this.listenTo(e,"add",this.childAdded),this.listenTo(e,"remove",this.childRemoved),this.updateEventTextSize(),this.scaleChanged(this.useScale),this.valuesChanged()},updateDisplayTitle:function(){this.set("displayTitle",this.get("event").get("displayTitle")),this.calcRectsRequired=!0},updateEventTextSize:function(){var e,t;(e=this.get("event").get("textSize"))&&((t=e.copy()).height+=TimelineDisplayConstants.eventDateTextHeight,this.set("smallTextSize",t),this.set("parentTextSize",e.copy()),window.mainApp.isIos&&(t=this.get("event").get("narrowRelTextSize").copy(),window.mainApp.timelineView.showEventDate&&(t.height+=TimelineDisplayConstants.eventDateTextHeight),this.set("narrowRelTextSize",t),t=this.get("event").get("wideRelTextSize").copy(),window.mainApp.timelineView.showEventDate&&(t.height+=TimelineDisplayConstants.eventDateTextHeight),this.set("wideRelTextSize",t)),this.calcRects())},destroy:function(){},isVisible:function(){var e=this.get("event").get("filterResult");return"Inherited"!==this.get("role")&&e===ATFilterResult.MATCH||e!==ATFilterResult.NO_MATCH&&null!==this.childNodes.find(function(e){return e.isVisible()})},showMoreChanged:function(){this.calcBigTextRequired&&this.get("showMore")&&(this.calcEventTextRequired=!0),window.ApplicationInterface&&window.ApplicationInterface.setEventNodeShowMoreState(window.timelineDocumentId,this.id,this.get("lane").id,this.get("showMore")),this.calcRectsRequired=!0},showChildNodesChanged:function(){0===this.get("event").children.length&&this.set("showChildNodes",!1),this.get("showChildNodes")?this.get("showMore")&&this.set("showMore",!1):this.childNodes.each(function(e){e.get("showChildNodes")&&e.set("showChildNodes",!1)}),window.ApplicationInterface&&window.ApplicationInterface.setParentExpandedState(window.timelineDocumentId,this.id,this.get("lane").id,this.get("showChildNodes")),this.calcRectsRequired=!0},displayTemplateChanged:function(){this.valuesChanged(),this.childNodes.each(function(e){e.displayTemplateChanged()}),this.updateDisplayTitle(),this.calcBigTextRequired=!0,this.get("showMore")&&(this.calcEventTextRequired=!0)},valuesChanged:function(){this.calcBigTextRequired=!0,this.get("showMore")&&(this.calcEventTextRequired=!0)},childrenChanged:function(){var e=this.get("lane"),t=this.get("event").children,i=e.get("entity").get("relationships"),n=[];t.each(function(t){t.hasChildInIdMap(i)&&n.push({id:t.id,lane:e,event:t})}),this.childNodes.set(n,{remove:!0}),this.childNodes.each(function(e){e.childrenChanged()}),t.length||this.set("showChildNodes",!1),this.calcRectsRequired=!0},childAdded:function(){this.trigger("childNodeAdded")},childRemoved:function(){},scaleChanged:function(e){this.childNodes.each(function(t){t.scaleChanged(e)}),this.calcPixels(e),this.useScale=e},selectionChanged:function(){this.set("selected",this.get("event").get("selected"))},calcPixels:function(e){var t=this.get("event"),i=this.isVisible()?t.get("maxScale"):0,n=i<0?1:i>e?1:i/e;this.set({startPixel:t.get("startTS")/e,stopPixel:t.get("endTS")/e,scale:n}),this.calcRectsRequired=!0},calcRects:function(){var e,t,i,n,s,h,a=this.get("startPixel"),l=this.get("stopPixel"),o=this.get("markerRect"),d=this.get("smallTextSize"),r=this.get("bigTextSize"),c=this.get("parentTextSize"),g=l-a,u=this.get("showMore"),p=new ATRect(0,0,0,0),T=new ATRect(0,0,0,0),w=window.mainApp.isIos?TimelineDisplayConstants.eventMarkerCornerRadiusIos:TimelineDisplayConstants.eventMarkerCornerRadius,m=[],v=0,x=TimelineDisplayConstants.eventOptimiseMaxPolygonWidth-2*w;if(this.get("showChildNodes")&&u)this.set({showMore:!1});else{if(o.size.width=Math.max(Math.round(l-a),2*w),o.size.height=2*w,n=window.mainApp.timelineView.isExport?o.size.width:Math.min(TimelineDisplayConstants.eventOptimiseMaxPolygonWidth,o.size.width),window.mainApp.timelineView.isExport&&n>TimelineDisplayConstants.eventOptimiseMaxPolygonWidth){for(s=Math.min(n/2,x),h=n,m.push(String(.5)+","+(w+.5)+" "+(w+.5)+",0.5 "+(Math.round(s)+.5)+",0.5 "+(Math.round(s)+.5)+","+(2*w+.5)+" "+(w+.5)+","+(2*w+.5)),h-=s,v+=s;h>x;)s=Math.min(x,h-x),m.push(String(Math.round(v)+.5)+",0.5 "+(Math.round(v+s)+.5)+",0.5 "+(Math.round(v+s)+.5)+","+(2*w+.5)+" "+(Math.round(v)+.5)+","+(2*w+.5)),h-=s,v+=s;m.push(String(Math.round(v)+.5)+",0.5 "+(Math.round(n-w)+.5)+",0.5 "+(Math.round(n)+.5)+","+(w+.5)+" "+(Math.round(n-w)+.5)+","+(2*w+.5)+" "+(Math.round(v)+.5)+","+(2*w+.5))}else m.push(String(.5)+","+(w+.5)+" "+(w+.5)+",0.5 "+(Math.round(n-w)+.5)+",0.5 "+(Math.round(n)+.5)+","+(w+.5)+" "+(Math.round(n-w)+.5)+","+(2*w+.5)+" "+(w+.5)+","+(2*w+.5));this.childNodes.length>0?(i=window.mainApp.isIos?new ATPoint(o.right()+TimelineDisplayConstants.eventParentExpandSpanOffsetFromRightIos,0):new ATPoint(Math.max(o.centerX()-TimelineDisplayConstants.eventParentExpandWidth/2,o.right()-TimelineDisplayConstants.eventParentExpandSpanOffsetFromRight),o.centerY()-TimelineDisplayConstants.eventParentExpandHeight/2),o.size.width+=TimelineDisplayConstants.eventMarkerSvgParentExtraWidth,o.size.height+=TimelineDisplayConstants.eventMarkerSvgParentExtraHeight):(i=new ATPoint(0,0),o.size.width+=TimelineDisplayConstants.eventMarkerSvgNormalExtraWidth,o.size.height+=TimelineDisplayConstants.eventMarkerSvgNormalExtraHeight),p.origin.x=a-TimelineDisplayConstants.eventMarkerOffsetFromBoundsLeft,g<2*w&&(p.origin.x-=w),T.origin.x=p.origin.x,e=this.get("showChildNodes")?c:this.get("showMore")&&!window.mainApp.isIos?r:window.mainApp.displaySettings.showEventDate?d:c,t=this.get("showChildNodes")?c:window.mainApp.displaySettings.showEventDate?d:c,o.size.width>TimelineDisplayConstants.minEventWidthToDropText||this.get("showChildNodes")||window.mainApp.isIos&&this.childNodes.length>0?(p.size.width=Math.max(o.size.width+TimelineDisplayConstants.eventMarkerShowMoreMarginLeft+TimelineDisplayConstants.eventMarkerShowMoreWidth,e.width)+TimelineDisplayConstants.eventBoxUnderneathWidthAdjust,p.size.height=o.size.height+e.height+TimelineDisplayConstants.eventBoxUnderneathHeightAdjust,T.size.width=Math.max(o.size.width+TimelineDisplayConstants.eventMarkerShowMoreMarginLeft+TimelineDisplayConstants.eventMarkerShowMoreWidth,t.width)+TimelineDisplayConstants.eventBoxUnderneathWidthAdjust,T.size.height=o.size.height+t.height+TimelineDisplayConstants.eventBoxUnderneathHeightAdjust):(p.size.width=o.size.width+e.width+TimelineDisplayConstants.eventBoxSideBySideWidthAdjust,p.size.height=e.height+TimelineDisplayConstants.eventBoxSideBySideHeightAdjust,T.size.width=o.size.width+t.width+TimelineDisplayConstants.eventBoxSideBySideWidthAdjust,T.size.height=t.height+TimelineDisplayConstants.eventBoxSideBySideHeightAdjust,this.childNodes.length>0&&window.mainApp.isIos&&(i=new ATPoint(p.size.width-TimelineDisplayConstants.eventParentArrowWidthIos,0))),this.set({markerRect:o,textSize:e,markerPoints:m,bulletPos:i,totalRect:p,smallTotalRect:T}),this.calcRectsRequired=!1}}});module.exports=ATEventNode;

},{"../controller/ATDisplayConstants":16,"../utils/ATPoint":46,"../utils/ATRect":48,"../utils/ATSize":49,"./ATEventNodeList":35,"./ATFilterResult":36,"backbone":220,"lodash":333}],35:[function(require,module,exports){
var Backbone=require("backbone"),ATEventNode=require("./ATEventNode"),ATUtilities=require("../utils/ATUtilities"),ATEventNodeList=Backbone.Collection.extend({model:ATEventNode,initialize:function(){this.sortRequired=!1,this.listenTo(this,"change:totalRect",this.markSortRequired),this.listenTo(this,"change:values",function(){this.trigger("layoutRequired")}),this.listenTo(this,"add",function(){this.sortRequired=!0,this.trigger("childNodeAdded")})},markSortRequired:function(){this.sortRequired=!0,this.trigger("layoutRequired")},findNode:function(t){var e,i,r,n=this.get(t);if(n)return n;for(i=this.length,r=0;r<i;r++)if(e=this.at(r),n=e.childNodes.findNode(t))return n;return null},destroy:function(){this.off(null,null,this)},sortChildren:function(){this.sort(),this.each(function(t){t.childNodes.sortChildren()})},comparator:function(t,e){var i=t.get("event").attributes,r=e.get("event").attributes;return i.startTS==r.startTS?ATUtilities.versionNumberCompare(i.displayId,r.displayId):i.startTS-r.startTS}});module.exports=ATEventNodeList;

},{"../utils/ATUtilities":51,"./ATEventNode":34,"backbone":220}],36:[function(require,module,exports){
module.exports={NO_MATCH:0,MATCH_CHILDREN:1,MATCH:2};

},{}],37:[function(require,module,exports){
var Backbone=require("backbone"),ATEmptyGuidString=require("./ATEmptyGuidString"),ATCalendar=require("./ATCalendar"),ATInspectorModel=Backbone.Model.extend({defaults:function(){return{template:{types:[],rangeProperties:[{id:6,name:"Date",type:"date",calendar:new ATCalendar.prototype.DefaultCalendar}],properties:[],colors:[],validPropertyTypes:[],validRangeTypes:[]},eventData:{enabled:!1,parentId:ATEmptyGuidString,eventIds:[]},entitiesByType:{},tags:[]}}});module.exports=ATInspectorModel;

},{"./ATCalendar":21,"./ATEmptyGuidString":26,"backbone":220}],38:[function(require,module,exports){
var ATMonth=function(t,i,n,o,h){this.index=t,this.normalDuration=o,this.leapDuration=h,this.name=i,this.shortName=n};module.exports=ATMonth;

},{}],39:[function(require,module,exports){
var _=require("lodash"),ATTimeUnit=require("./ATTimeUnit"),ATTimeSpan=function(s,t,e,i,n,h,a){this.years=Math.round(s),this.months=Math.round(t),this.weeks=Math.round(e),this.days=Math.round(i),this.hours=Math.round(n),this.minutes=Math.round(h),this.seconds=Math.round(a)};ATTimeSpan.fromString=function(s){var t=new RegExp("\\b(\\d+)\\s*y","i"),e=new RegExp("\\b(\\d+)\\s*m(?!i)((o)||\\b)","i"),i=new RegExp("\\b(\\d+)\\s*w","i"),n=new RegExp("\\b(\\d+)\\s*d","i"),h=new RegExp("\\b(\\d+)\\s*h","i"),a=new RegExp("\\b(\\d+)\\s*mi","i"),r=new RegExp("\\b(\\d+)\\s*s","i"),o=new RegExp("\\b(\\d+)"),m=new RegExp("^\\s*-"),u=0,T=0,p=0,c=0,d=0,l=0,A=0,y=!1,w=s.match(m),U=!1;return null!=w&&(U=!0),null!=(w=s.match(t))&&(u=parseInt(w[1]),y=!0),null!=(w=s.match(e))&&(T=parseInt(w[1]),y=!0),null!=(w=s.match(i))&&(p=parseInt(w[1]),y=!0),null!=(w=s.match(n))&&(c=parseInt(w[1]),y=!0),null!=(w=s.match(h))&&(d=parseInt(w[1]),y=!0),null!=(w=s.match(a))&&(l=parseInt(w[1]),y=!0),null!=(w=s.match(r))&&(A=parseInt(w[1]),y=!0),0==y&&null!=(w=s.match(o))&&(A=parseInt(w[1])),1==U&&(u=-u,T=-T,p=-p,c=-c,d=-d,l=-l,A=-A),new ATTimeSpan(u,T,p,c,d,l,A)},ATTimeSpan.fromComponents=function(s){var t=0,e=0,i=0,n=0,h=0,a=0,r=0;return _.each(s,function(s){switch(s.precision){case ATTimeUnit.YEAR:t=s.value;break;case ATTimeUnit.MONTH:e=s.value;break;case ATTimeUnit.WEEK:i=s.value;break;case ATTimeUnit.DAY:n=s.value;break;case ATTimeUnit.HOUR:h=s.value;break;case ATTimeUnit.MINUTE:a=s.value;break;default:r=s.value}}),new ATTimeSpan(t,e,i,n,h,a,r)},ATTimeSpan.prototype.toComponents=function(){var s=[{precision:ATTimeUnit.YEAR,value:this.years},{precision:ATTimeUnit.MONTH,value:this.months},{precision:ATTimeUnit.WEEK,value:this.weeks},{precision:ATTimeUnit.DAY,value:this.days},{precision:ATTimeUnit.HOUR,value:this.hours},{precision:ATTimeUnit.MINUTE,value:this.minutes},{precision:ATTimeUnit.SECOND,value:this.seconds}];return _.filter(s,function(s){return 0!=s.value})},ATTimeSpan.prototype.copy=function(){return new ATTimeSpan(this.years,this.months,this.weeks,this.days,this.hours,this.minutes,this.seconds)},ATTimeSpan.prototype.toString=function(){var s="";return this.years&&(s+=(s.length?", ":"")+this.years+" year"+(1!=this.years?"s":"")),this.months&&(s+=(s.length?", ":"")+this.months+" month"+(1!=this.months?"s":"")),this.weeks&&(s+=(s.length?", ":"")+this.weeks+" week"+(1!=this.weeks?"s":"")),this.days&&(s+=(s.length?", ":"")+this.days+" day"+(1!=this.days?"s":"")),this.hours&&(s+=(s.length?", ":"")+this.hours+" hour"+(1!=this.hours?"s":"")),this.minutes&&(s+=(s.length?", ":"")+this.minutes+" minute"+(1!=this.minutes?"s":"")),this.seconds&&(s+=(s.length?", ":"")+this.seconds+" second"+(1!=this.seconds?"s":"")),0==s.length&&(s="0 seconds"),s},ATTimeSpan.prototype.toShortString=function(){var s="";return this.years?(s+=this.years+"y",this.months&&(s+=" "+this.months+"m")):this.months?(s+=this.months+"m",this.weeks&&(s+=" "+this.weeks+"w")):this.weeks?(s+=this.weeks+"w",this.days&&(s+=" "+this.days+"d")):this.days?(s+=this.days+"d",this.hours&&(s+=" "+this.hours+"h")):this.hours?(s+=this.hours+"h",this.minutes&&(s+=" "+this.minutes+"min")):this.minutes?(s+=this.minutes+"min",this.seconds&&(s+=" "+this.seconds+"s")):this.seconds&&(s+=this.seconds+"s"),0==s.length&&(s="0s"),s},ATTimeSpan.prototype.toPrecision=function(){return this.seconds?ATTimeUnit.SECOND:this.minutes?ATTimeUnit.MINUTE:this.hours?ATTimeUnit.HOUR:this.days?ATTimeUnit.DAY:this.weeks?ATTimeUnit.WEEK:this.months?ATTimeUnit.MONTH:ATTimeUnit.YEAR},module.exports=ATTimeSpan;

},{"./ATTimeUnit":40,"lodash":333}],40:[function(require,module,exports){
module.exports={CENTURY:0,DECADE:1,YEAR:2,MONTH:3,WEEK:4,DAY:5,HOUR:6,MINUTE:7,SECOND:8};

},{}],41:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATRangeConversion=require("../controller/ATRangeConversion"),ATCalendar=require("./ATCalendar"),ATEventList=require("./ATEventList"),ATUtilities=require("../utils/ATUtilities"),ATEmptyGuidString=require("./ATEmptyGuidString"),ATEntityList=require("./ATEntityList"),ATTimeline=Backbone.Model.extend({defaults:function(){return{name:"New Timeline",events:new ATEventList,entities:new ATEntityList,laneTypeName:null,columnTypeName:null,laneIds:{},threadIds:{},bookmarks:[],filters:[],omittedLanes:[],todos:[],suggestions:[]}},initialize:function(){this.selectedEvents=[]},update:function(e){var t,n,i,s=this.get("entities"),a=this.get("events"),r={},d=!1;this.rangeConversion?(e.timelineType&&(this.rangeConversion.type=e.timelineType,d=!0),e.calendar&&(this.rangeConversion.calendar=new ATCalendar(e.calendar.eras,e.calendar.months,e.calendar.weekdays,e.calendar.hoursInDay,e.calendar.weekdayIndexAtZero,e.calendar.zeroDateTS),this.rangeConversion.calendar.setCalendarType(e.calendar.calendarType),this.rangeConversion.calendar.dateOrder=e.calendar.dateOrder,this.rangeConversion.calendar.dateFormat=e.calendar.dateFormat,this.rangeConversion.calendar.timeFormat=e.calendar.timeFormat,this.rangeConversion.calendar.monthFormat=e.calendar.monthFormat,this.rangeConversion.calendar.dayNameFormat=e.calendar.dayNameFormat,d=!0)):(e.timelineType||ATConsoleLog("ERROR: First update() in timeline does not have timelineType"),"date"!=e.timelineType||e.calendar||ATConsoleLog("ERROR: First update() in timeline for date type does not have calendar"),e.calendar&&((n=new ATCalendar(e.calendar.eras,e.calendar.months,e.calendar.weekdays,e.calendar.hoursInDay,e.calendar.weekdayIndexAtZero,e.calendar.zeroDateTS)).setCalendarType(e.calendar.calendarType),n.dateOrder=e.calendar.dateOrder,n.dateFormat=e.calendar.dateFormat,n.timeFormat=e.calendar.timeFormat,n.monthFormat=e.calendar.monthFormat,n.dayNameFormat=e.calendar.dayNameFormat),this.rangeConversion=new ATRangeConversion(e.timelineType,n),d=!0),d&&this.trigger("rangeConversionChanged"),e.entityUpdates&&_.each(e.entityUpdates,function(e){var t=_.pick(e,"id","name","sortOrder","color","icon","visibleAsColumn","type","startTS","stopTS","hasStart","hasStop");s.set([t],{remove:!1}),s.get(e.id).update(e)}),e.entityDeletes&&s.remove(e.entityDeletes),e.eventUpdates&&(t=[],_.each(e.eventUpdates,function(e){var n=_.pick(e,"id","title","displayId","startTS","endTS","precision","maxScale","dateString","durationString","color","priority","links","attachments","imagePath","fullImagePath","tags","filterResult","isFaded","dependencies","successors","relationships");n.parentId=ATEmptyGuidString,t.push(n),a.set([n],{remove:!1}),a.get(e.id).update(e)})),e.eventDeletes&&a.remove(e.eventDeletes),e.lanes&&(i={},_.each(e.lanes,function(e,t){i[t]=!window.mainApp.isIos&&e}),r.laneIds=i),e.laneTypeName&&(r.laneTypeName=e.laneTypeName),_.isEmpty(r)||this.set(r),e.columnTypeName&&this.set("columnTypeName",e.columnTypeName),e.omittedLanes&&this.set("omittedLanes",e.omittedLanes),e.name&&this.set("name",e.name),this.set("todos",e.todos),this.set("suggestions",e.suggestions),this.trigger("updateUnallocatedRequired"),this.trigger("nodeLayoutRequired"),e.bookmarks&&this.set("bookmarks",e.bookmarks),e.filters&&this.set("filters",e.filters)},appendAllEvents:function(e){var t=this.get("events");return e.push.apply(e,t.models),t.each(function(t){t.appendAllDescendants(e)}),e},clearSelection:function(e){var t=this;_.each(this.selectedEvents,function(e){var n=t.get("events").findChild(e);n&&n.set("selected",!1)}),this.selectedEvents=[],e||this.selectionChanged()},toggleEventSelectionWithID:function(e,t){this.get("events").findChild(e).get("selected")?this.unselectEventWithID(e,t):this.selectEventWithID(e,t)},selectEventWithID:function(e,t){var n=this.get("events").findChild(e);n&&(n.set("selected",!0),-1===this.selectedEvents.indexOf(e)&&this.selectedEvents.push(e)),t||this.selectionChanged()},selectEventsWithIDs:function(e,t){var n=this,i=_.uniq(e);this.clearSelection(!0),_.each(i,function(e){n.selectEventWithID(e,!0)}),t||this.selectionChanged()},unselectEventWithID:function(e,t){var n=this.get("events").findChild(e);n&&n.set("selected",!1);var i=this.selectedEvents.indexOf(e);i>-1&&this.selectedEvents.splice(i,1),t||this.selectionChanged()},isEventWithIdSelected:function(e){var t=this.get("events").findChild(e);return!!t&&t.get("selected")},selectionChanged:function(){var e,t=this;this.selectedEvents.sort(function(e,n){var i=t.get("events").findChild(e),s=t.get("events").findChild(n),a=i.attributes,r=s.attributes;return a.startTS==r.startTS?a.endTS==r.endTS?a.title<r.title?-1:a.title==r.title?0:1:a.endTS-r.endTS:a.startTS-r.startTS}),this.trigger("selectionChanged"),window.ApplicationInterface&&(e=this.selectedEvents.join(),window.ApplicationInterface.selectionChanged(window.timelineDocumentId,e))},selectedEventsDraggable:function(){var e=this,t=!0;return _.each(this.selectedEvents,function(n){e.isEventDraggable(n)||(t=!1)}),t},isEventDraggable:function(e){var t=this,n=this.get("events").findChild(e),i=!1;if(n){if(_.keys(n.get("dependencies")).length>0)return!1;if(n.children.each(function(e){t.isEventDraggable(e.id)&&(i=!0)}),n.children.length&&!i)return!1}return!0},dateAfterDraggingEvent:function(e,t){var n=this.get("events").findChild(e).get("startTS");return this.rangeConversion.valueByAddingSpanToValue(n,t)},endDateAfterDraggingEvent:function(e,t){var n=this.get("events").findChild(e).get("endTS");return this.rangeConversion.valueByAddingSpanToValue(n,t)},flattenedEventList:function(e){var t=this,n=[],i=this.get("events"),s=e||function(e,t){var n=e.attributes,i=t.attributes;return n.startTS==i.startTS?ATUtilities.versionNumberCompare(n.displayId,i.displayId):n.startTS-i.startTS};return i.each(function(e){n.push(e),t.addChildrenToFlattenedList(e,n)}),n.sort(s),n},addChildrenToFlattenedList:function(e,t){var n=this;e.children.each(function(e){t.push(e),n.addChildrenToFlattenedList(e,t)})},selectedEventsCanHaveParent:function(e){return this.canBeMadeChildren(this.selectedEvents,e)},canBeMadeChildren:function(e,t){var n=this,i=!0;return _.each(e,function(e){n.canBeMadeChild(e,t)||(i=!1)}),i},canBeMadeChild:function(e,t){var n=this.get("events").findChild(e).get("parentId");return!(this.isDependentOnEventChild(e,t)||this.isDependentOnEventChild(t,e)||this.isSuccessorOfEvent(e,t)||this.isSuccessorOfEventChild(t,e)||this.isEventAncestor(t,e)||n==t)},isEventAncestor:function(e,t){for(var n=this.get("events"),i=n.findChild(e).get("parentId");i!=ATEmptyGuidString;){if(i==t)return!0;i=n.findChild(i).get("parentId")}return!1},isDependentOnEvent:function(e,t){var n=this,i=this.get("events").findChild(e),s=_.keys(i.get("dependencies")),a=!1;return _.each(s,function(e){(e==t||n.isDependentOnEvent(e,t))&&(a=!0)}),a},isSuccessorOfEvent:function(e,t){var n=this,i=this.get("events").findChild(e).get("successors"),s=!1;return _.each(i,function(e){(e==t||n.isSuccessorOfEvent(e,t))&&(s=!0)}),s},isDependentOnEventChild:function(e,t){var n=this,i=this.get("events").findChild(e),s=_.keys(i.get("dependencies")),a=!1;return _.each(s,function(e){(n.isEventAncestor(e,t)||e==t||n.isDependentOnEventChild(e,t))&&(a=!0)}),a},isSuccessorOfEventChild:function(e,t){var n=this,i=this.get("events").findChild(e).get("successors"),s=!1;return _.each(i,function(e){(n.isEventAncestor(e,t)||e==t||n.isSuccessorOfEventChild(e,t))&&(s=!0)}),s},ancestorIdsForEvents:function(e){var t=this,n=(this.get("events"),[]);return _.each(e,function(e){t._addAncestorsOfEventToList(e,n)}),n},_addAncestorsOfEventToList:function(e,t){var n=this.get("events").findChild(e).get("parentId");n!==ATEmptyGuidString&&(t.push(n),this._addAncestorsOfEventToList(n,t))},illegalPredecessorsForEvents:function(e){var t=this,n=(this.get("events"),this.ancestorIdsForEvents(e)),i=_.union(e,n),s=_.clone(i);return _.each(i,function(e){s=_.union(s,t._successorsAndAncestorsOfEvent(e))}),_.uniq(s)},_successorsAndAncestorsOfEvent:function(e){var t=this,n=this.get("events").findChild(e).get("successors"),i=this.ancestorIdsForEvents(n),s=_.union(n,i),a=_.clone(s);return _.each(s,function(e){a=_.union(a,t._successorsAndAncestorsOfEvent(e))}),a},firstEventAfterTimestamp:function(e){var t=this.flattenedEventList();return _.find(t,function(t){return t.get("startTS")>e})}});module.exports=ATTimeline;

},{"../controller/ATRangeConversion":19,"../utils/ATUtilities":51,"./ATCalendar":21,"./ATEmptyGuidString":26,"./ATEntityList":30,"./ATEventList":33,"backbone":220,"lodash":333}],42:[function(require,module,exports){
var _=require("lodash"),Backbone=require("backbone"),ATEntityLaneList=require("./ATEntityLaneList"),ATEntity=require("./ATEntity"),ATDependencyPath=require("./ATDependencyPath"),TimelineDisplayConstants=require("../controller/ATDisplayConstants"),ATPoint=require("../utils/ATPoint"),ATRect=require("../utils/ATRect"),ATEmptyGuidString=require("./ATEmptyGuidString"),ATViewMode=require("../view/ATViewMode"),ATScreenMode=require("../view/ios/ATScreenMode"),ATBounds=require("../utils/ATBounds"),ATTimelineViewModel=Backbone.Model.extend({defaults:function(){return{timeline:null,inspectorModel:null,unitScale:1e6,contentXMinimum:0,contentXMaximum:0,contentXAverage:0}},initialize:function(){var e,t="",i=this.get("timeline"),n=i.get("entities"),s=i.get("laneTypeName"),o=[];this.lanes=new ATEntityLaneList,this.threadIds=[],this.dependencyPaths=[],this.changeObservers=[],this.selectionObservers=[],this.displayLanes=[],this.navigationLanes=[],this.displayColumnGroups=[],this.unallocatedEntity=null,this.relationshipViewFlattenTree=!1,this.relationshipViewShowOffsets=!0,e=this.lanes,n.each(function(e){o.push({id:e.id,timeline:i,entity:e})}),e.set(o,{remove:!1}),t=s&&"None"!=s?"No "+i.get("laneTypeName"):"All Events",this.unallocatedEntity=new ATEntity({name:t,color:null,sortOrder:9999999}),this.updateUnallocatedEvents(),this.listenTo(i,"updateUnallocatedRequired",this.updateUnallocatedEvents.bind(this)),this.listenTo(i,"change:laneTypeName",function(){var e="All Events",t=i.get("laneTypeName");t&&"None"!=t&&(e="No "+t),this.unallocatedEntity.set("name",e)}),this.listenTo(i,"change:laneIds",this.laneIdsChanged),this.listenTo(i,"change:threadIds",this.threadIdsChanged),this.listenTo(i,"selectionChanged",function(){this.trigger("selectionChanged")}),this.listenTo(this,"change:unitScale",this.scaleChanged),this.listenTo(e,"childNodeAdded",this.trigger("childNodeAdded")),this.listenTo(e,"laneCollapsed",function(){this.trigger("laneCollapsed")})},destroy:function(){},threadIdsChanged:function(e,t,i){this.threadIds=t},laneIdsChanged:function(e,t,i){var n=this,s=this.lanes,o=_.keys(t),l=this.get("timeline"),a=l.get("entities"),r=[],d=[];s.each(function(e){_.includes(o,""+e.id)||r.push(e)}),s.remove(r),_.each(o,function(e){s.get(e)||d.push({id:e,timeline:l,entity:e==ATEmptyGuidString?n.unallocatedEntity:a.get(e),collapsed:t[e]})}),s.set(d,{remove:!1})},updateUnallocatedEvents:function(){var e=this.get("timeline"),t=e.get("entities"),i=(e.get("omittedLanes"),[]),n=e.get("laneTypeName"),s=(this.lanes,[]),o={};e.appendAllEvents(i),_.each(i,function(e){var i=e.get("relationships"),o=!1;_.each(i,function(e){var i=e.entityId;t.get(i).get("type")===n&&(o=!0)}),o||s.push(e.id)}),_.each(s,function(e){o[e]="Unallocated"}),this.unallocatedEntity.set("relationships",o)},scaleChanged:function(){var e=this.get("unitScale");this.lanes.each(function(t){t.scaleChanged(e)})}});ATTimelineViewModel.prototype.addChangeObserver=function(e){this.changeObservers.push(e)},ATTimelineViewModel.prototype.removeChangeObserver=function(e){var t=this.changeObservers.indexOf(e);t>-1&&this.changeObservers.splice(t,1)},ATTimelineViewModel.prototype.notifyChangeObservers=function(e){var t,i=this.changeObservers.length;for(t=0;t<i;t++)this.changeObservers[t]()},ATTimelineViewModel.prototype.addSelectionObserver=function(e){this.selectionObservers.push(e)},ATTimelineViewModel.prototype.removeSelectionObserver=function(e){var t=this.selectionObservers.indexOf(e);t>-1&&this.selectionObservers.splice(t,1)},ATTimelineViewModel.prototype.notifySelectionObservers=function(e){var t,i=this.selectionObservers.length;for(t=0;t<i;t++)this.selectionObservers[t]()},ATTimelineViewModel.prototype.setEventTitle=function(e,t){var i,n,s;for(s in this.lanes)if(this.lanes.hasOwnProperty(s)){var o=this.lanes[s].events;for(n=o.length,i=0;i<n;i++){var l=o[i];l.id==e&&(l.title=t)}}this.notifyChangeObservers()},ATTimelineViewModel.prototype.selectEventsInRect=function(e){var t=this,i=this.get("timeline");i.clearSelection(!0),this.lanes.each(function(n){var s=n.get("top");t.selectEventsFromGroupInRect(n.nodes,e,s,i)}),i.selectionChanged()},ATTimelineViewModel.prototype.selectEventsFromGroupInRect=function(e,t,i,n){var s=this;e.each(function(e){var o=e.get("totalRect");(o=new ATRect(o.origin.x,o.origin.y,o.size.width,o.size.height)).origin.y+=i,o.overlaps(t)&&n.selectEventWithID(e.id,!0),e.childNodes.length>0&&e.get("showChildNodes")&&s.selectEventsFromGroupInRect(e.childNodes,t,i,n)})},ATTimelineViewModel.prototype.findEarliestEventNode=function(){var e=null,t=0;return this.lanes.each(function(i){i.nodes.each(function(i){var n=i.get("event").get("startTS");(null==e||n<t)&&(e=i,t=n)})}),e},ATTimelineViewModel.prototype.findLatestEventNode=function(e){var t=null,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=e?n.get("event").get("endTS"):n.get("event").get("startTS");(null==t||s>i)&&(t=n,i=s)})}),t},ATTimelineViewModel.prototype.findEarliestEventPixel=function(){var e=!1,t=0;return this.lanes.each(function(i){i.nodes.each(function(i){var n=i.get("totalRect").left();(!e||n<t)&&(t=n,e=!0)})}),t},ATTimelineViewModel.prototype.findLatestEventPixel=function(){var e=this,t=!1,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=n.get("totalRect").right();if((!t||s>i)&&(i=s,t=!0),n.get("showChildNodes")){var o=e.findLatestEventPixelInChildren(n);null!==o&&o>i&&(i=o)}})}),i},ATTimelineViewModel.prototype.findLatestEventPixelInChildren=function(e){var t=this,i=!1,n=0;return e.childNodes.each(function(e){var s=e.get("totalRect").right();if((!i||s>n)&&(n=s,i=!0),e.get("showChildNodes")){var o=t.findLatestEventPixelInChildren(e);null!==o&&o>n&&(n=o)}}),i?n:null},ATTimelineViewModel.prototype.findPreviousEventNodeBeforeTS=function(e){var t=null,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=n.get("event").get("startTS");n.isVisible()&&s<e&&(null==t||s>i)&&(t=n,i=s)})}),t},ATTimelineViewModel.prototype.findNextEventNodeAfterTS=function(e){var t=null,i=0;return this.lanes.each(function(n){n.nodes.each(function(n){var s=n.get("event").get("startTS");n.isVisible()&&s>e&&(null==t||s<i)&&(t=n,i=s)})}),t},ATTimelineViewModel.prototype.allOpenEventNodes=function(e){var t=this,i=[];return this.lanes.each(function(n){n.get("collapsed")||n.nodes.each(function(n){n.isVisible()&&(i.push(n),(e||n.get("showChildNodes"))&&t.appendOpenChildNodes(n,i,e))})}),i},ATTimelineViewModel.prototype.appendOpenChildNodes=function(e,t,i){var n=this;e.childNodes.each(function(e){e.isVisible()&&(t.push(e),(i||e.get("showChildNodes"))&&n.appendOpenChildNodes(e,t))})},ATTimelineViewModel.prototype.selectAll=function(e){var t=this.allOpenEventNodes(e),i=_.uniq(_.map(t,"id"));this.get("timeline").clearSelection(!0),this.get("timeline").selectEventsWithIDs(i)},ATTimelineViewModel.prototype.selectAllAfter=function(e,t){var i,n,s=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),o=!1,l=[];for(s.sort(t),i=s.length,n=0;n<i;n++)s[n].get("event").get("selected")?(l=[],o=!0):o&&s[n].isVisible()&&l.push(s[n].id);this.get("timeline").clearSelection(!0),this.get("timeline").selectEventsWithIDs(_.uniq(l))},ATTimelineViewModel.prototype.selectAllBefore=function(e,t){var i,n=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),s=!1,o=[];for(n.sort(t),i=n.length-1;i>=0;i--)n[i].get("event").get("selected")?(o=[],s=!0):s&&n[i].isVisible()&&o.push(n[i].id);this.get("timeline").clearSelection(!0),this.get("timeline").selectEventsWithIDs(_.uniq(o))},ATTimelineViewModel.prototype.selectNextEvent=function(e,t){var i,n=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),s=null;for(n.sort(t),i=n.length-1;i>=0&&!n[i].get("event").get("selected");i--)n[i].isVisible()&&(s=n[i]);return s&&(this.get("timeline").clearSelection(!0),this.get("timeline").selectEventWithID(s.id)),s},ATTimelineViewModel.prototype.selectPreviousEvent=function(e,t){var i,n,s=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),o=null;for(s.sort(t),i=s.length,n=0;n<i&&!s[n].get("event").get("selected");n++)s[n].isVisible()&&(o=s[n]);return o&&(this.get("timeline").clearSelection(!0),this.get("timeline").selectEventWithID(o.id)),o},ATTimelineViewModel.prototype.hideAllEventDetails=function(e){var t,i=_.uniq(this.allOpenEventNodes(e),!1,function(e){return e.id}),n=i.length;for(t=0;t<n;t++)i[t].get("showMore")&&i[t].set("showMore",!1)},ATTimelineViewModel.prototype.findNodeForEventId=function(e){var t=null;return this.lanes.each(function(i){null==t&&(t=i.nodes.findNode(e))}),t},ATTimelineViewModel.prototype.findAllNodesForEventId=function(e){var t=this,i=[];return this.lanes.each(function(n){n.nodes.each(function(n){n.get("event").id==e&&i.push(n),t.addAllChildNodesWithEventId(n,i,e)})}),i},ATTimelineViewModel.prototype.addAllChildNodesWithEventId=function(e,t,i){var n=this;e.childNodes.each(function(e){e.get("event").id==i&&t.push(e),n.addAllChildNodesWithEventId(e,t,i)})},ATTimelineViewModel.prototype.findAllNodesForEventIds=function(e){var t=this,i=[];return this.lanes.each(function(n){n.nodes.each(function(n){_.includes(e,n.get("event").id)&&i.push(n),t.addAllChildNodesWithEventIds(n,i,e)})}),i},ATTimelineViewModel.prototype.addAllChildNodesWithEventIds=function(e,t,i){var n=this;e.childNodes.each(function(e){_.includes(i,e.get("event").id)&&t.push(e),n.addAllChildNodesWithEventIds(e,t,i)})},ATTimelineViewModel.prototype.eventNodeForAbsolutePosition=function(e,t){var i,n=this.laneForAbsoluteY(e.y);return i=new ATPoint(e.x,e.y-n.get("top")),this.eventNodeForAbsolutePositionInGroup(n.nodes.models,i,t)},ATTimelineViewModel.prototype.eventNodeForAbsolutePositionInGroup=function(e,t,i){var n,s,o,l,a,r=e.length;for(s=0;s<r;s++){if((n=e[s]).get("showChildNodes")&&(a=this.eventNodeForAbsolutePositionInGroup(n.childNodes.models,t,i)))return a;if((o=n.get("totalRect")).contains(t))return n;if(i&&(l=n.childRect,(o=new ATRect(o.origin.x+l.origin.x,o.origin.y+l.origin.y,l.size.width,l.size.height)).contains(t)))return n}return null},ATTimelineViewModel.prototype.eventNodeForSnapDrag=function(e,t,i,n){var s,o,l,a=this.get("timeline").get("events").findChild(e),r=this.lanes.get(t),d=a.get("parentId"),h=d!=ATEmptyGuidString?r.nodes.findNode(d):null,p=null;if(h?s=h.childNodes.models:(s=[],this.lanes.each(function(e){var t=e.get("top"),i=t+e.get("height"),o=n.top(),l=n.bottom(),a=n.deepCopy();a.origin.y=Math.max(t,o),a.size.height=Math.min(i,l)-a.origin.y,a.origin.y=Math.max(0,a.origin.y-t),!e.get("collapsed")&&a.size.height>0&&(s=_.union(s,e.nodes.filter(function(e){return e.get("totalRect").overlaps(a)})))})),s.length>0&&(p=_.minBy(s,function(t){return t.id==e?1e3:Math.min(Math.abs(t.get("startPixel")-i.x),Math.abs(t.get("stopPixel")-i.x))})),p&&p.id!=e)if(o=Math.abs(p.get("startPixel")-i.x),l=Math.abs(p.get("stopPixel")-i.x),o<=l){if(o<TimelineDisplayConstants.snapDragMinDist)return{node:p,location:"start",xValue:p.get("startPixel")}}else if(l<TimelineDisplayConstants.snapDragMinDist)return{node:p,location:"end",xValue:p.get("stopPixel")};return null},ATTimelineViewModel.prototype.laneForAbsoluteY=function(e){return this.lanes.find(function(t){var i=t.get("top"),n=i+t.get("height");return i<=e&&n>e})||this.lanes.last()},ATTimelineViewModel.prototype.relationshipColumnForAbsoluteX=function(e,t){var i,n,s=null,o=null;return _.each(this.displayColumnGroups,function(l){t&&l.name!=t||_.each(l.entityColumns,function(t){i||(i=t,o=t.xPixel),t.xPixel>=e&&t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing<e&&(s=t),n=t})}),s||(s=e<o?i:n),s},ATTimelineViewModel.prototype.laneForEntityId=function(e){return this.lanes.find(function(t){return t.id==e})},ATTimelineViewModel.prototype.columnForEntityId=function(e){var t=null;return _.each(this.displayColumnGroups,function(i){var n=_.find(i.entityColumns,function(t){return t.id==e});n&&(t=n)}),t},ATTimelineViewModel.prototype.lastLane=function(){return this.lanes.last()},ATTimelineViewModel.prototype.closestLaneTopToAbsoluteY=function(e){var t=null,i=1e4;return this.lanes.each(function(n){var s=n.get("top"),o=Math.abs(s-e);(null==t||o<i)&&(t=n,i=o)}),t||this.lanes.last()},ATTimelineViewModel.prototype.calculateNodes=function(){window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?this.calculateNodesTimelineView():this.calculateNodesRelationshipView()},ATTimelineViewModel.prototype.emptyTextForLane=function(e){var t,i=this.get("timeline"),n=i.get("events"),s=window.mainApp.isIos?window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE?"footer":"side bar":"toolbar",o=window.mainApp.canvasManager.isFilterBarVisible&&i.get("filters").length>0?" matching the current filter":"";return 0===n.length?"You have no events in your timeline. Use the button in the "+s+" to add your first event.":e.id===ATEmptyGuidString?"All Events"===e.entityName?"You have no events"+o+".":(t=e.entityName.substr(3),"There are no unallocated events"+o+". All events are allocated to at least one "+t+"."):"You have no events allocated to "+e.entityName+o+".<br />Add an event with the button in the "+s+", or assign existing events to this entity."},ATTimelineViewModel.prototype.calculateNodesTimelineView=function(){var e,t,i,n,s,o,l,a=_.values(this.lanes.models),r="cascade"==window.mainApp.displaySettings.layout?this.layoutNodeGroupCascade.bind(this):this.layoutNodeGroupTwoPass.bind(this),d=a.length;for(this.displayLanes=[],this.navigationLanes=[],s=0,o=0,e=0;e<d;e++)(t=a[e]).layoutRequired=!1,(i=t.nodes).sortRequired&&(i.sort(),i.sortRequired=!1),n=t.get("collapsed"),this.displayLanes.push({original:t,id:t.id,entityName:t.get("entity").get("name"),marginForLane:TimelineDisplayConstants.laneLabelOffsetX+t.get("nameWidth")+TimelineDisplayConstants.lifetimeLeftMarginToText,lifetimeMarks:[],lifetimeBounds:this.lifetimeBoundsForLane(t),nodes:[],collapsed:t.get("collapsed"),odd:e%2==1}),l=this.displayLanes[this.displayLanes.length-1],s=r(t.id,n,i.models,0,0,null,!1,l),(s+=20)<TimelineDisplayConstants.minimumExpandedLaneHeight&&(s=TimelineDisplayConstants.minimumExpandedLaneHeight),n&&(s=TimelineDisplayConstants.collapsedLaneHeight),t.set("top",o),t.set("height",s),o+=s,l.empty=0===l.nodes.length,l.emptyText=this.emptyTextForLane(l),l.top=t.get("top"),l.height=t.get("height"),this.navigationLanes.push(_.pick(l,"id","entityName","top","height"));this.contentXMinimum=0,this.contentXMaximum=0,this.contentXAverage=0,window.mainApp.timelineView.rangeY=new ATBounds(0,o),this.calculateDependencyPaths(),this.notifyChangeObservers(),this.trigger("nodeLayoutChanged")},ATTimelineViewModel.prototype.updateRelationshipViewColumns=function(){var e,t=this,i=this.get("inspectorModel").get("template").types,n=this.get("timeline").get("entities"),s=1;return this.displayColumnGroups=[],_.each(i,function(i){e={name:i.name,sortOrder:s,entityColumns:[]},t.displayColumnGroups.push(e),s++}),n.each(function(e){if(e.get("visibleAsColumn")){var i=e.get("type"),n=_.find(t.displayColumnGroups,function(e){return e.name==i});if(!n)return console.log("updateRelationshipViewColumns ERROR"),console.log("cannot find colGroup for type: "+i),console.log("Printing that.displayColumnGroups, entity"),console.dir(t.displayColumnGroups),void console.dir(e);n.entityColumns.push({id:e.id,fastId:e.fastId,type:i,name:e.get("name"),sortOrder:e.get("sortOrder"),icon:e.get("icon"),color:e.get("color")})}}),this.displayColumnGroups=this.displayColumnGroups.filter(function(e){return e.entityColumns.length>0}),this.calculateRelationshipViewColumns(!0,!0)},ATTimelineViewModel.prototype.calculateRelationshipViewColumns=function(e,t){var i,n=!1;return i=TimelineDisplayConstants.relationshipViewDateOffsetWidth+TimelineDisplayConstants.relationshipViewEventAreaWidth+TimelineDisplayConstants.relationshipViewEntityColumnSpacing,_.each(this.displayColumnGroups,function(s){e?s.xPixel=i:i=s.xPixel,n=!1,s.entityColumns.sort(function(e,t){return e.sortOrder-t.sortOrder}),_.each(s.entityColumns,function(e){e.xPixel=i,e.isOdd=n,e.isLast=!1,i+=TimelineDisplayConstants.relationshipViewEntityColumnSpacing,t&&(n=!n)}),_.last(s.entityColumns).isLast=!0,i+=TimelineDisplayConstants.relationshipViewEntityGroupSpacing}),i},ATTimelineViewModel.prototype.calculateNodesRelationshipView=function(e){var t,i,n,s,o,l,a,r,d,h=_.values(this.lanes.models),p=h.length;for(this.displayLanes=[],this.navigationLanes=[],o=e?(l=this.displayColumnGroups[this.displayColumnGroups.length-1]).entityColumns[l.entityColumns.length-1].xPixel+TimelineDisplayConstants.relationshipViewEntityColumnSpacing+TimelineDisplayConstants.relationshipViewEntityGroupSpacing:this.updateRelationshipViewColumns(),a=0,r=0,t=0;t<p;t++)(i=h[t]).layoutRequired=!1,this.relationshipViewFlattenTree?(n=this.flattenedEventNodeListForLane(i.id)).sort(i.nodes.comparator):(i.nodes.sortChildren(),i.nodes.sortRequired=!1,n=i.nodes.models),s=i.get("collapsed"),this.displayLanes.push({original:i,id:i.id,entityName:i.get("entity").get("name"),marginForLane:TimelineDisplayConstants.laneLabelOffsetX+i.get("nameWidth")+TimelineDisplayConstants.lifetimeLeftMarginToText,lifetimeMarks:[],lifetimeBounds:this.lifetimeBoundsForLane(i),nodes:[],intersections:[],collapsed:i.get("collapsed"),odd:t%2==1}),d=this.displayLanes[this.displayLanes.length-1],(a=this.layoutRelationshipNodeGroup(i.id,s,n,0,0,d,this.displayColumnGroups,TimelineDisplayConstants.lifetimeHeight,!1,!1,null))<TimelineDisplayConstants.minimumExpandedLaneHeight&&(a=TimelineDisplayConstants.minimumExpandedLaneHeight),s&&(a=TimelineDisplayConstants.collapsedLaneHeight),i.set("top",r),i.set("height",a),r+=a,d.empty=0===d.nodes.length,d.emptyText=this.emptyTextForLane(d),d.top=i.get("top"),d.height=i.get("height"),this.navigationLanes.push(_.pick(d,"id","entityName","top","height"));this.contentXMinimum=0,this.contentXMaximum=0,this.contentXAverage=0,window.mainApp.relationshipView.rangeY=new ATBounds(window.mainApp.isIos?0:-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,r+TimelineDisplayConstants.scrollTrackNoLaneNavThickness+TimelineDisplayConstants.bookmarksHeight),window.mainApp.relationshipView.rangeX=new ATBounds(0,o+20),this.notifyChangeObservers(),this.trigger("nodeLayoutChanged")},ATTimelineViewModel.prototype.layoutNodeGroupTwoPass=function(e,t,i,n,s,o,l,a){var r;return("compact"==window.mainApp.displaySettings.layout?this.layoutCompactNodes.bind(this):this.layoutWaterfallNodes.bind(this))(e,t,i,n,s,o,l),(r=_.clone(i)).sort(function(e,t){var i=e.get("smallTotalRect"),n=t.get("smallTotalRect");return i.origin.y==n.origin.y?i.origin.x-n.origin.x:i.origin.y-n.origin.y}),this.expandTwoPassNodes(e,t,r,n,s,o,l,a)},ATTimelineViewModel.prototype.layoutCompactNodes=function(e,t,i,n,s,o,l){var a,r,d,h,p,c,u,g,m,f,y=i.length,T=!0,v=0,C=[],w=t?TimelineDisplayConstants.eventOffsetFromTopOfCollapsedLane:o?s:TimelineDisplayConstants.eventOffsetFromTopOfLane;for(a=0;a<y;a++)if(r=i[a],d=r.get("event"),h=r.get("smallTotalRect"),r.isVisible())if(m=h.right()+TimelineDisplayConstants.eventXOffsetFromPreviousEvent,(T||m>f)&&(f=m),T=!1,r.color=d.displayColor(),r.laneId=e,p=0,g=!1,t||l)h.origin.y=w;else do{if(p>=C.length){for(g=!0,h.origin.y=p?C[p-1].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent:w,u=Math.floor(h.bottom()/10);p<u;p++)C.push({x:m,y:10*(p+1)});C.push({x:m,y:h.bottom()}),g=!0}else if(h.origin.x>=C[p].x){for(h.origin.y=p?C[p-1].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent:w,u=Math.floor(h.bottom()/10),c=p,g=!0;p<=u&&p<C.length;p++)h.origin.x<C[p].x&&(g=!1);if(g){for(p=c;p<u;p++)p<C.length?C[p]={x:m,y:10*(p+1)}:C.push({x:m,y:10*(p+1)});p<C.length?C[p]={x:m,y:h.bottom()}:C.push({x:m,y:h.bottom()})}}else p++}while(!g);return v=C.length?C[C.length-1].y:0,o&&f>o.right()&&(o.size.width=f-o.origin.x),v},ATTimelineViewModel.prototype.layoutWaterfallNodes=function(e,t,i,n,s,o,l){var a,r,d,h,p,c,u,g,m,f,y,T,v,C,w,A,V,N=i.length,E=!0,x=0,M=[],D=0,P=0,L=t?TimelineDisplayConstants.eventOffsetFromTopOfCollapsedLane:o?s:TimelineDisplayConstants.eventOffsetFromTopOfLane,b=0;for(h=0;h<N;h++)if(p=i[h],c=p.get("event"),u=p.get("smallTotalRect"),p.isVisible())if(A=u.right()+TimelineDisplayConstants.eventXOffsetFromPreviousEvent,(E||A>V)&&(V=A),E=!1,p.color=c.displayColor(),p.laneId=e,t||l)u.origin.y=L;else{if(a=h>=D)for(P=L,f=Math.min(N,h+M.length),g=h;g<f&&(m=i[g].get("smallTotalRect"),C=Math.floor(P/10),w=Math.floor((P+m.size.height)/10),!(C>M.length));g++){for(r=!1,v=C;v<=w&&!(v>=M.length);v++)if(m.origin.x<M[v].x){if(!M[v].isLong){for(a=!1,T=0,D=N,y=g+1;y<N;y++)if(i[y].get("smallTotalRect").origin.x>M[v].x){D=y;break}for(;D>0&&T<=10*v;)T+=i[--D].get("smallTotalRect").size.height+TimelineDisplayConstants.eventYOffsetFromPreviousEvent;D++;break}r=!0,P=M[v].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent}if(!a)break;r?g--:P+=m.size.height+TimelineDisplayConstants.eventYOffsetFromPreviousEvent}a?(u.origin.y=L,C=0,b=u.bottom()+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,w=Math.floor(b/10)):(u.origin.y=b,C=Math.floor(u.origin.y/10),b=u.bottom()+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,w=Math.floor(b/10));do{for(r=!1,v=C;v<=w&&!(v>=M.length);v++)u.origin.x<M[v].x&&M[v].isLong&&(r=!0,b=M[v].y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent);r&&(u.origin.y=b,C=Math.floor(u.origin.y/10)+1,b=u.bottom()+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,w=Math.floor(b/10))}while(r);for(d=p.get("markerRect").size.width>TimelineDisplayConstants.longEventMinWidth,v=C;v<w;v++)v<M.length?M[v]={x:A,y:10*(v+1),isLong:d}:M.push({x:A,y:10*(v+1),isLong:d});w<M.length?M[w]={x:A,y:b,isLong:d}:M.push({x:A,y:b,isLong:d})}return x=M.length?M[M.length-1].y:0,o&&V>o.right()&&(o.size.width=V-o.origin.x),x},ATTimelineViewModel.prototype.expandTwoPassNodes=function(e,t,i,n,s,o,l,a){var r,d,h,p,c,u,g,m,f,y,T,v,C,w=[],A=[],V=i.length,N=0,E={nodes:[]};for(r=0;r<V;r++)if((d=i[r]).isVisible()){if(h=d.get("totalRect"),p=d.get("smallTotalRect"),h.origin.y=p.origin.y,c=h.deepCopy(),E.nodes=[],!t){for(d.childNodes.length>0&&(v=d.get("markerRect"),d.isParent=!0,d.childNodes.sortRequired&&(d.childNodes.sort(),d.childNodes.sortRequired=!1),d.get("showChildNodes")?(this.layoutNodeGroupTwoPass(e,t,d.childNodes.models,0,c.bottom()+TimelineDisplayConstants.eventYOffsetFromOwnParentEvent,c,!1,E),c.origin.x-=TimelineDisplayConstants.eventChildRectPaddingLeft,c.size.height+=TimelineDisplayConstants.eventChildRectPaddingBottom,c.size.width+=TimelineDisplayConstants.eventChildRectPaddingLeft+TimelineDisplayConstants.eventChildRectPaddingRight,d.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,v.origin.y+v.size.height/2,c.size.width,c.size.height-v.size.height/2)):(c.origin.x-=TimelineDisplayConstants.eventChildRectPaddingLeft,c.size.height+=TimelineDisplayConstants.eventChildRectPaddingBottom,c.size.width+=TimelineDisplayConstants.eventChildRectPaddingLeft+TimelineDisplayConstants.eventChildRectPaddingRight,d.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,0,c.size.width,0))),c.size.height+=TimelineDisplayConstants.eventYOffsetFromPreviousEvent,c.size.width+=TimelineDisplayConstants.eventXOffsetFromPreviousEvent,g=-1,u=w.length,m=0;m<u;m++)if(c.overlaps(w[m].bounds))for(y=(f=w[m].rects).length,T=0;T<y;T++)c.overlaps(f[T])&&(c.origin.y=f[T].bottom(),g=m);if(-1!=g)w[g].bounds=w[g].bounds.union(c,0),w[g].rects.push(c.deepCopy()),w[g].rects.sort(function(e,t){return e.origin.y==t.origin.y?e.origin.x-t.origin.x:e.origin.y-t.origin.y});else if(d.get("showMore")||d.get("showChildNodes")){for(y=A.length,T=0;T<y;T++)c.overlaps(A[T])&&(c.origin.y=A[T].bottom());w.push({bounds:c.deepCopy(),rects:[c.deepCopy()]})}else A.push(c.deepCopy());c.bottom()>N&&(N=c.bottom()),_.each(E.nodes,function(e){e.totalRect.origin.y+=c.origin.y-h.origin.y}),h.origin.y=c.origin.y}a&&(C=_.extend({original:d,fastId:d.fastId,laneId:e,childRect:d.childRect,color:d.color,isParent:d.isParent,isLaneCollapsed:t,startYPosition:o?o.origin.y:0,visible:!0,widthAdjustToOptimise:0,translateMarkerX:0},_.extend(_.pick(d.attributes,"startPixel","stopPixel","markerRect","markerPoints","bulletPos","textSize","totalRect","scale","displayTitle","showMore","showChildNodes"),_.pick(d.get("event").attributes,"id","contentHTML","dateString","selected","isFaded","imagePath","fullImagePath","links","attachments"))),a.nodes.push(C),_.each(E.nodes,function(e){a.nodes.push(e)}))}return o&&(0==N&&(N=o.bottom()+20),o.size.height=N-o.origin.y),N},ATTimelineViewModel.prototype.layoutNodeGroupCascade=function(e,t,i,n,s,o,l,a){var r,d,h,p,c,u,g,m,f,y,T,v,C,w=t?TimelineDisplayConstants.eventOffsetFromTopOfCollapsedLane:o?s:TimelineDisplayConstants.eventOffsetFromTopOfLane;for(d=i.length,m=!0,v=0,r=0;r<d;r++)p=(h=i[r]).get("event"),c=h.get("totalRect"),h.isVisible()&&(h.color=p.displayColor(),h.laneId=e,m||t||l?(c.origin.y=w,T=c.origin.x):c.origin.x>T+TimelineDisplayConstants.eventXOffsetFromPreviousEvent?c.origin.y=w:c.origin.y=y+TimelineDisplayConstants.eventYOffsetFromPreviousEvent,m=!1,h.childNodes.length>0?(g=h.get("markerRect"),h.isParent=!0,h.childNodes.sortRequired&&(h.childNodes.sort(),h.childNodes.sortRequired=!1),u=new ATRect(c.origin.x,c.origin.y,c.size.width,c.size.height),h.get("showChildNodes")?(this.layoutNodeGroupCascade(e,t,h.childNodes.models,0,u.bottom()+TimelineDisplayConstants.eventYOffsetFromOwnParentEvent,u,!1,a),h.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,g.origin.y+g.size.height/2,u.size.width+TimelineDisplayConstants.eventChildRectPaddingLeft+TimelineDisplayConstants.eventChildRectPaddingRight,u.size.height-g.size.height/2+TimelineDisplayConstants.eventChildRectPaddingBottom),f=u.right(),y=u.top()+h.childRect.size.height+TimelineDisplayConstants.eventYOffsetFromPreviousParentEvent):(l||this.layoutNodeGroupCascade(e,t,h.childNodes.models,0,u.top(),u,!0,null),f=c.right(),y=c.top()+c.size.height,h.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,0,u.size.width,0))):(f=c.right(),y=c.top()+c.size.height,h.childRect=new ATRect(-TimelineDisplayConstants.eventChildRectPaddingLeft,0,0,0),h.isParent=!1),y>v&&(v=y),f>T&&(T=f),a&&(C=_.extend({original:h,fastId:h.fastId,laneId:e,childRect:h.childRect,color:h.color,isParent:h.isParent,isLaneCollapsed:t,startYPosition:o?o.origin.y:0,visible:!0,widthAdjustToOptimise:0,translateMarkerX:0},_.extend(_.pick(h.attributes,"startPixel","stopPixel","markerRect","markerPoints","bulletPos","textSize","totalRect","scale","displayTitle","showMore","showChildNodes"),_.pick(h.get("event").attributes,"id","contentHTML","dateString","selected","isFaded","imagePath","fullImagePath","links","attachments"))),a.nodes.push(C)));return o&&(0==v&&(v=o.bottom()+20),o.size.height=v-o.origin.y,T>o.right()&&(o.size.width=T-o.origin.x)),v},ATTimelineViewModel.prototype.layoutRelationshipNodeGroup=function(e,t,i,n,s,o,l,a,r,d,h){var p,c,u,g,m,f,y,T,v,C,w,A,V,N,E,x,M=this.get("timeline"),D=null,P=null,L=[],b=!!r,R=a||null,O={y:null,lastWasOdd:!1},I=window.mainApp.isIos?window.mainApp.canvasManager.relationshipView.relationshipColumnsExpanded?"wideRelTextSize":"narrowRelTextSize":"textSize";if(!t){for(E=!1,c=i.length,T=Math.max(s,TimelineDisplayConstants.lifetimeHeight),p=0;p<c;p++)g=i[p],u=g.get("event"),g.isVisible()&&(g.isParent=!this.relationshipViewFlattenTree&&g.childNodes.length>0,y=g.get(I),f=g.get("relationshipTotalRect"),m=new ATRect(TimelineDisplayConstants.relationshipViewEventTextXOffset,TimelineDisplayConstants.relationshipViewEventVerticalPadding,y.width,y.height),f.size.width=TimelineDisplayConstants.relationshipViewEventAreaWidth-n,f.size.height=y.height+2*TimelineDisplayConstants.relationshipViewEventVerticalPadding,f.origin.x=TimelineDisplayConstants.relationshipViewDateOffsetWidth+n,f.origin.y=T,T=f.bottom(),w=f.top()+TimelineDisplayConstants.relationshipViewDateOffsetLineOffsetFromNodeTop,g.color=u.displayColor(),g.laneId=e,A=M.rangeConversion.valueFromTimestamp(u.get("startTS")),D&&(N=M.rangeConversion.spanBetweenValues(V,A),P=M.rangeConversion.shortStringFromSpanValue(N)),C=u.get("relationships"),x=[],_.each(l,function(e,t){_.each(e.entityColumns,function(e){var t=_.find(C,function(t){return t.fastEntityId==e.fastId});t&&(x.push({icon:t.icon,color:t.color,age:t.age,shortAge:t.shortAge,role:t.role,xPixel:e.xPixel,yPixel:w,id:g.id+"-"+e.id,nodeId:g.id,entityId:e.id,fastNodeId:u.fastId,fastEntityId:e.fastId}),o.intersections.push(_.last(x)))})}),o&&(v=_.extend({original:g,fastId:g.fastId,laneId:e,color:g.color,isParent:g.isParent,isLaneCollapsed:t,textRect:m,totalRect:f,offsetText:E?P:"",offsetTextX:f.origin.x-TimelineDisplayConstants.relationshipViewDateOffsetWidth,offsetTextY:(w+R)/2,lineY:w,prevLineY:R,lineWidth:this.relationshipViewFlattenTree?TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthFlattenedTree:g.isParent?TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthParent:TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthNoChildren,lineX:f.origin.x+TimelineDisplayConstants.relationshipViewDateEventLeftLineXOffset-TimelineDisplayConstants.relationshipViewDateEventLeftLineWidth,isOdd:b,relationshipValues:L,visible:!0,intersections:x},_.extend(_.pick(g.attributes,"displayTitle","showMore","showChildNodes"),_.pick(g.get("event").attributes,"id","contentHTML","dateString","selected","isFaded","imagePath","fullImagePath","links","attachments","nestingLevel"))),this.relationshipViewFlattenTree&&(v.showChildNodes=!1),v.verticalLineX=v.lineX,d&&p==c-1&&(v.lineWidth+=TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthLastChildAddition,v.lineX-=TimelineDisplayConstants.relationshipViewDateEventLeftLineWidthLastChildAddition),o.nodes.push(v)),!this.relationshipViewFlattenTree&&g.childNodes.length>0&&g.get("showChildNodes")?(T=this.layoutRelationshipNodeGroup(e,t,g.childNodes.models,n+TimelineDisplayConstants.relationshipViewParentIndent,T,o,l,f.origin.y+m.origin.y+m.size.height/2+4,!b,p!=c-1,O),R=O.y,b=O.lastWasOdd):R=w,E=this.relationshipViewShowOffsets,D=g,V=A,b=!b);return h&&(h.y=w,h.lastWasOdd=!b),T}},ATTimelineViewModel.prototype.flattenedEventNodeList=function(){var e=this,t=[];return this.lanes.each(function(i){i.nodes.each(function(i){t.push(i),e.addChildNodesToFlattenedList(i,t)})}),t},ATTimelineViewModel.prototype.addChildNodesToFlattenedList=function(e,t){var i=this;e.childNodes.each(function(e){t.push(e),i.addChildNodesToFlattenedList(e,t)})},ATTimelineViewModel.prototype.flattenedEventNodeListForLane=function(e){var t=this,i=[];return this.lanes.get(e).nodes.each(function(e){i.push(e),t.addChildNodesToFlattenedList(e,i)}),i},ATTimelineViewModel.prototype.lifetimeBoundsForLane=function(e){var t=this.get("unitScale"),i=e.get("entity"),n=i.get("hasStart"),s=i.get("hasStop"),o=0,l=0;return n&&(o=e.get("entity").get("startTS")/t),s&&(l=e.get("entity").get("stopTS")/t),{hasStart:n,start:o,hasStop:s,stop:l}},ATTimelineViewModel.prototype.calculateDependencyPaths=function(){var e,t=this,i=this.flattenedEventNodeList();this.dependencyPaths=[],e=this.dependencyPaths,_.each(i,function(i){var n=i.get("event"),s=i.get("lane"),o=n.get("dependencies"),l=n.get("parentId"),a=l!=ATEmptyGuidString?s.nodes.findNode(l):null;_.isEmpty(o)||!i.isVisible()||s.get("collapsed")||a&&!a.get("showChildNodes")||_.each(o,function(n,o){var l=t.findAllNodesForEventId(o),a=!1,r=_.minBy(l,function(e){var t=e.get("lane"),i=e.get("event").get("parentId"),n=i!=ATEmptyGuidString?t.nodes.findNode(i):null;return e.isVisible()?t.get("collapsed")?1e6:n&&!n.get("showChildNodes")?1e6:(a=!0,Math.abs(s.get("top")-t.get("top"))):1e6});a&&!r.get("lane").get("collapsed")&&e.push(new ATDependencyPath(r,i,n))})})},ATTimelineViewModel.freeze=function(e){return{_class:"ATTimelineViewModel",lanes:e.lanes,threads:e.threads,deleted_lanes:e.deleted_lanes,deleted_threads:e.deleted_threads,deleted_events:e.deleted_events}},ATTimelineViewModel.thaw=function(e){return new ATTimelineViewModel(e.lanes,e.threads,e.deleted_lanes,e.deleted_threads,e.deleted_events)},module.exports=ATTimelineViewModel;

},{"../controller/ATDisplayConstants":16,"../utils/ATBounds":44,"../utils/ATPoint":46,"../utils/ATRect":48,"../view/ATViewMode":53,"../view/ios/ATScreenMode":191,"./ATDependencyPath":25,"./ATEmptyGuidString":26,"./ATEntity":27,"./ATEntityLaneList":29,"backbone":220,"lodash":333}],43:[function(require,module,exports){
var ATWeekday=function(e,t,a){this.index=e,this.name=t,this.shortName=a};module.exports=ATWeekday;

},{}],44:[function(require,module,exports){
var ATBounds=function(n,t){this.min=n,this.max=t};ATBounds.prototype.span=function(){return this.max-this.min},ATBounds.prototype.constrain=function(n){return n>this.min?n<this.max?n:this.max:this.min},ATBounds.prototype.debugAsString=function(){return"[ATBounds min: "+this.min+", max: "+this.max+"]"},module.exports=ATBounds;

},{}],45:[function(require,module,exports){
var ATPoint=require("./ATPoint"),ATLine=function(i,n,t,e){this.origin=new ATPoint(i,n),this.destination=new ATPoint(t,e)};ATLine.prototype.deepCopy=function(){return new ATLine(this.origin.x,this.origin.y,this.destination.x,this.destination.y)},module.exports=ATLine;

},{"./ATPoint":46}],46:[function(require,module,exports){
var ATPoint=function(t,i){this.x=t,this.y=i};ATPoint.prototype.copy=function(){return new ATPoint(this.x,this.y)},ATPoint.prototype.scale=function(t){this.x*=t,this.y*=t},ATPoint.prototype.debugAsString=function(){return"[ATPoint x: "+this.x+", y: "+this.y+"]"},module.exports=ATPoint;

},{}],47:[function(require,module,exports){
var ATRange=function(t,n){this.location=t,this.length=n};ATRange.prototype.contains=function(t){return t>=this.location&&t<=this.location+this.length},ATRange.prototype.debugAsString=function(){return"[ATRange location: "+this.location+", length: "+this.length+"]"},module.exports=ATRange;

},{}],48:[function(require,module,exports){
var ATPoint=require("./ATPoint"),ATSize=require("./ATSize"),ATRect=function(t,i,e,o){this.origin=new ATPoint(t,i),this.size=new ATSize(e,o)};ATRect.prototype.debugAsString=function(){return"[ATRect x: "+this.origin.x+", y: "+this.origin.y+", w: "+this.size.width+", h: "+this.size.height+"]"},ATRect.prototype.deepCopy=function(){return new ATRect(this.origin.x,this.origin.y,this.size.width,this.size.height)},ATRect.prototype.scale=function(t){this.origin.x*=t,this.origin.y*=t,this.size.width*=t,this.size.height*=t},ATRect.prototype.left=function(){return this.origin.x},ATRect.prototype.centerX=function(){return this.origin.x+this.size.width/2},ATRect.prototype.right=function(){return this.origin.x+this.size.width},ATRect.prototype.top=function(){return this.origin.y},ATRect.prototype.centerY=function(){return this.origin.y+this.size.height/2},ATRect.prototype.bottom=function(){return this.origin.y+this.size.height},ATRect.prototype.overlaps=function(t){return this.right()>=t.left()&&this.left()<=t.right()&&this.bottom()>=t.top()&&this.top()<=t.bottom()},ATRect.prototype.contains=function(t){return this.left()<=t.x&&this.right()>=t.x&&this.top()<=t.y&&this.bottom()>=t.y},ATRect.prototype.containsRect=function(t){return this.left()<=t.left()&&this.right()>=t.right()&&this.top()<=t.top()&&this.bottom()>=t.bottom()},ATRect.prototype.union=function(t,i){var e=this.left(),o=this.right(),n=this.bottom(),r=this.top(),h=t.left(),s=t.right(),c=t.bottom(),p=t.top(),u=e<h?e:h,g=r<p?r:p;return new ATRect(u-i,g-i,(o>s?o:s)-u+2*i,(n>c?n:c)-g+2*i)},module.exports=ATRect;

},{"./ATPoint":46,"./ATSize":49}],49:[function(require,module,exports){
var ATSize=function(t,i){this.width=t,this.height=i};ATSize.prototype.copy=function(){return new ATSize(this.width,this.height)},ATSize.prototype.scale=function(t){this.width*=t,this.height*=t},ATSize.prototype.debugAsString=function(){return"[ATSize w: "+this.width+", h: "+this.height+"]"},module.exports=ATSize;

},{}],50:[function(require,module,exports){
var ATStringSelection=function(t,e){this.text=t,this.selectionRange=e};module.exports=ATStringSelection;

},{}],51:[function(require,module,exports){
var _=require("lodash");exports.floatToInt=function(t){return t<0?Math.ceil(t):Math.floor(t)},exports.numberToTwoDigitString=function(t){return t<0&&Math.abs(t)>=0&&Math.abs(t)<=9?"-0"+Math.abs(t).toString():t>=0&&t<=9?"0"+t.toString():t.toString()},exports.numberToFourDigitString=function(t){return t>=0&&t<=9?"000"+t.toString():t<=99?"00"+t.toString():t<=999?"0"+t.toString():t.toString()},exports.replaceStringBetween=function(t,r,e,n){return-1==r||-1==e?t:t.substring(0,r)+n+t.substring(e)},exports.replaceCharactersWithWhitespace=function(t,r,e){var n,o="";for(n=0;n<r;n++)o+=" ";return e.replace(t,o)},exports.replaceLocationWithWhitespace=function(t,r,e){var n,o="";for(n=0;n<r;n++)o+=" ";return e.replace(e.substring(t,t+r),o)},exports.caseInsensitiveCompare=function(t,r){return!_.isNil(t)&&!_.isNil(r)&&t.toLocaleLowerCase()===r.toLocaleLowerCase()},exports.versionNumberCompare=function(t,r){var e,n,o,i=t.split("."),s=r.split("."),a=Math.min(i.length,s.length);for(e=0;e<a;e++)if(n=parseInt(i[e]),o=parseInt(s[e]),n!=o)return n-o;return i.length-s.length},exports.caseInsensitiveStartsWith=function(t,r){return 0===t.toLocaleLowerCase().indexOf(r.toLocaleLowerCase(),0)},exports.regexStrippedString=function(t){return t?t.replace(/[-[\]{}()*+?.,\\^$|#]/g,""):t},exports.regexEscapedString=function(t){return t?t.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"):t},exports.countOccurrencesOfSubstring=function(t,r){if(t=String(t),(r=String(r)).length<=0)return t.length+1;for(var e=0,n=0,o=r.length;(n=t.indexOf(r,n))>=0;)++e,n+=o;return e};

},{"lodash":333}],52:[function(require,module,exports){
var ATUuidIntMap=function(n){return window.atUuidToIntMap||(window.atUuidToIntMap={},window.atNextUniqueIntId=1),window.atUuidToIntMap[n]||(window.atUuidToIntMap[n]=window.atNextUniqueIntId++),window.atUuidToIntMap[n]};module.exports=ATUuidIntMap;

},{}],53:[function(require,module,exports){
module.exports={TIMELINE_VIEW:1,RELATIONSHIP_VIEW:2};

},{}],54:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDatePicker=require("./ATDatePicker"),ATDurationPicker=require("./ATDurationPicker"),ATDropdown=require("./ATDropDown"),ATSearchDropdown=require("./ATSearchDropDown"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/addEntityTemplate.html"),ATAddEntityView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(i({windowTitle:"Enter Name"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.typeId=null,this.isPersistent=!1,this.$windowTitle=$("#addEntityWindowTitle"),this.d3WindowBelowMsg=d3.select("#addEntityWindowBelowMessage"),this.$nameInput=$("#addEntityInput"),this.$nameInput.on("input",this.validateNameInput.bind(this)),this.$submitButton=$("#addEntitySubmit"),this.$earlyInputCatcher=$("#modalInputCatcher"),this.createOffsetFromDropdown=new ATDropdown({el:"#addEntityCreateOffsetFrom"}),this.createEventSearchDropdown=new ATSearchDropdown({el:"#addEntityCreateEvent"}),this.createEventSearchDropdown.setNoOptionPlaceholder("No Event"),this.createEventSearchDropdown.setSearchWordByWord(!0),this.d3CreateDate=this.d3El.select("#manageEntitiesCreateDate"),this.createDatePickerView=new ATDatePicker({el:"#addEntityCreateDate"}),this.createDatePickerView.setResetCallback(function(){window.setTimeout(t.resetCreateDateField.bind(t),0)}),this.createOffsetPickerView=new ATDurationPicker({el:"#addEntityCreateOffset"}),this.listenTo(this.createEventSearchDropdown,"change",this.createEventChangeHandler.bind(this)),this.listenTo(this.createOffsetFromDropdown,"change",this.createEventChangeHandler.bind(this)),this.createOffsetPickerView.setChangeCallback(this.createEventChangeHandler.bind(this)),$("#addEntityForm").on("submit",this.addClickHandler.bind(this))},setTypeId:function(e){this.typeId=e;var t=this.model.get("template").types,i=!1;_.each(t,function(t){t.typeId==e&&(i=t.persistent)}),this.isPersistent=i,d3.select("#addEntityBirthInput").style("display",this.isPersistent?"none":null)},setRangeConversion:function(e){this.rangeConversion=e,this.createDatePickerView.setRangeConversion(e),this.createOffsetPickerView.setRangeConversion(e)},setCallback:function(e){this.callbackFunction=e},setValidatorFunction:function(e){this.validatorFunction=e},setWindowTitle:function(e){this.$windowTitle.text(e)},setWindowBelowMessage:function(e){this.d3WindowBelowMsg.text(e).style("display",e?null:"none")},resetForm:function(){this.$nameInput.val(""),this.$submitButton.prop("disabled",!0),this.$earlyInputCatcher.addClass("active").val("").focus(),this.formSubmitted=!1,this.updateEventDropdowns(),this.createEventSearchDropdown.setValue(ATEmptyGuidString),this.createDatePickerView.setValue(null),this.createDatePickerView.setDisabled(!1),this.createOffsetPickerView.setDurationComponents([]),this.createOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setDisabled(!0),window.setTimeout(this.focusAndSelectNameIfUnfocused.bind(this),500)},resetCreateDateField:function(){this.createDatePickerView.setValue(null)},focusAndSelectNameIfUnfocused:function(){var e=this.$earlyInputCatcher.val(),t=e.length;this.$nameInput.val(e),this.$nameInput.focus(),this.$nameInput[0].setSelectionRange(t,t),this.validateNameInput(),this.$earlyInputCatcher.removeClass("active")},validateNameInput:function(){var e=this.$nameInput.val(),t=this.validatorFunction?this.validatorFunction(e):e.length>0;return this.$submitButton.prop("disabled",!t),this.$nameInput[0].setCustomValidity(t?"":"Error"),d3.select(this.$nameInput[0]).classed("invalid",!t),t},createEventChangeHandler:function(){this.createEventSearchDropdown.getValue()!=ATEmptyGuidString?(0==this.createOffsetPickerView.text().length&&(this.createOffsetPickerView.setText("0 seconds"),this.createOffsetFromDropdown.setValue("start")),this.createDatePickerView.setDisabled(!0),this.createOffsetPickerView.setDisabled(!1),this.createOffsetFromDropdown.setDisabled(!1)):(this.createEventSearchDropdown.setValue(ATEmptyGuidString),this.createDatePickerView.setDisabled(!1),this.createOffsetPickerView.setDurationComponents([]),this.createOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setDisabled(!0))},updateEventDropdowns:function(){var e=this,t=this.model.get("timeline").get("events").models,i=[{value:ATEmptyGuidString,sortValue:"-1",label:"(No Event)"}];_.each(t,function(t){i.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),e.addChildrenOfEventsToOptions(i,t)}),i.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),a=Math.min(i.length,n.length),s=0;for(s=0;s<a;s++)if(i[s]!=n[s])return i[s]-n[s];return i.length-n.length}),this.createEventSearchDropdown.setOptions(i)},addChildrenOfEventsToOptions:function(e,t){var i=this;t.children.each(function(t){e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t)})},addClickHandler:function(e){var t=this.$nameInput.val(),i=this.typeId;return eventId="",offset="",addToStart=!1,date="",!0===this.formSubmitted?(window.mainApp.removeExistingModal(),e.preventDefault(),!1):(this.formSubmitted=!0,!1===this.isPersistent&&(eventId=this.createEventSearchDropdown.getValue(),offset=this.createOffsetPickerView.text(),addToStart="start"===this.createOffsetFromDropdown.getValue(),date=this.createDatePickerView.text()),this.validateNameInput()?(window.ApplicationInterface&&window.ApplicationInterface.addEntity(window.timelineDocumentId,t,i,eventId,offset,addToStart,date),window.mainApp.removeExistingModal(),e.preventDefault(),!1):void e.preventDefault())}});module.exports=ATAddEntityView;

},{"../../model/ATEmptyGuidString":26,"./ATDatePicker":60,"./ATDropDown":62,"./ATDurationPicker":64,"./ATSearchDropDown":94,"./templates/addEntityTemplate.html":103,"backbone":220,"d3":320,"jquery":331,"lodash":333}],55:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATSearchDropdown=require("./ATSearchDropdown"),ATColorDropdown=require("./ATColorDropdown"),ATDatePicker=require("./ATDatePicker"),ATDurationPicker=require("./ATDurationPicker"),ATRangeControlManager=require("./ATRangeControlManager"),ATInspectorListView=require("./ATInspectorListView"),ATSearchableContextMenu=require("./ATSearchableContextMenu"),ATDropdown=require("./ATDropdown"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/addEventTemplate.html"),rolesDivHtml=require("./templates/addEventRolesDivTemplate.html"),ATAddEventView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.rolesDivTemplate=_.template(rolesDivHtml),this.d3RoleElements={},this.roleListViews={},this.relationshipLists={},this.roleDropdowns={},this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.listenTo(this.model,"change:template",this.renderTemplate),this.$titleInput=$("#addEventTitle"),this.$titleInput.on("input",this.titleInput.bind(this)),this.colorDropdown=new ATColorDropdown({el:"#addEventColor"}),this.colorDropdown.setNoOptionPlaceholder("No Color"),this.parentSearchDropdown=new ATSearchDropdown({el:"#addEventParent"}),this.parentSearchDropdown.setNoOptionPlaceholder("No Parent"),this.parentSearchDropdown.setSearchWordByWord(!0),this.d3StartDate=this.d3El.select("#addEventStartDate"),this.startDatePickerView=new ATDatePicker({el:"#addEventStartDate"}),this.startDatePickerView.setValidCallback(this.validateForm.bind(this)),this.d3EndDate=this.d3El.select("#addEventEndDate"),this.endDatePickerView=new ATDatePicker({el:"#addEventEndDate"}),this.endDatePickerView.setupAsEndPickerForStartPicker(this.startDatePickerView),this.endDatePickerView.setValidCallback(this.validateForm.bind(this)),this.startDatePickerView.setAllowEmptyValues(!1),this.endDatePickerView.setAllowEmptyValues(!1),this.durationPickerView=new ATDurationPicker({el:"#addEventDuration"}),this.d3RoleDiv=this.d3El.select("#addEventRoleDiv"),this.entitySearchContextMenu=new ATSearchableContextMenu({el:"#addEventEntitySearch"}),this.entitySearchContextMenu.setAllowNewItems(!1),this.listenTo(this.entitySearchContextMenu,"change",this.contextEntityClick.bind(this)),this.$earlyInputCatcher=$("#modalInputCatcher"),this.rangeControlManager=new ATRangeControlManager(this.startDatePickerView,this.durationPickerView,this.endDatePickerView),this.rangeControlManager.setRangeConversion(this.rangeConversion),$("#addEventForm").on("submit",this.addClickHandler.bind(this)),this.renderTemplate()},renderTemplate:function(){var e=this,t=this.model.get("template"),i=t.colors,n=[];this.d3Elements={},this.listViews={},this.relationshipLists={},this.dropdowns={},_.each(t.types,function(e){_.each(e.roles,function(e){e.roleId||(e.roleId=e.id),n.push(e)})}),this.d3RoleDiv.html(this.rolesDivTemplate({roles:n})),_.each(n,function(t){e.d3RoleElements[t.roleId]=e.d3El.select("#addEvent-"+t.roleId),t.multiplePerEvent?(e.roleListViews[t.roleId]=new ATInspectorListView({el:"#addEvent-"+t.roleId}),e.roleListViews[t.roleId].setListId(t.roleId),e.roleListViews[t.roleId].setAddCallback(e.roleAddClicked.bind(e)),e.roleListViews[t.roleId].setRemoveCallback(e.roleRemoveClicked.bind(e))):e.roleDropdowns[t.roleId]=new ATDropdown({el:"#addEvent-"+t.roleId})}),this.colorDropdown.setOptions(i),this.$titleInput.val(""),this.colorDropdown.setValue(i[0].name)},setRangeConversion:function(e){this.rangeConversion=e,this.rangeControlManager.setRangeConversion(e)},resetForm:function(e,t,i){var n=this,r=this.model.get("template"),o=r.colors;this.$titleInput.val("New Event"),this.colorDropdown.setValue(o[0].name),this.formSubmitted=!1,this.startDatePickerView.setDate(e),this.durationPickerView.setText("0"),this.endDatePickerView.setDate(e),this.updateParentDropdown(t),_.each(r.types,function(e){var t=!0;_.each(e.roles,function(r){r.multiplePerEvent?t?n.updateRoleList(r.roleId,e.name,i):n.updateRoleList(r.roleId,e.name,ATEmptyGuidString):n.updateRoleDropdown(r.roleId,e.name,i),t=!1})}),$("#addEventSubmit").prop("disabled",!0),this.setTitleFieldIsInvalid(!1),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectTitleIfUnfocused.bind(this),500)},focusAndSelectTitleIfUnfocused:function(){var e=this.$earlyInputCatcher.val(),t=e.length;this.$titleInput.val(e),this.$titleInput.focus(),this.$titleInput[0].setSelectionRange(t,t),this.$earlyInputCatcher.removeClass("activeCatcher"),t>0&&this.titleInput()},updateParentDropdown:function(e){var t=this,i=this.model.get("timeline").get("events").models,n=(this.model.get("eventData").eventIds,[{value:ATEmptyGuidString,sortValue:"-1",label:"(No Parent)"}]);_.each(i,function(e){n.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")}),t.addChildrenOfEventsToOptions(n,e)}),n.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),r=Math.min(i.length,n.length),o=0;for(o=0;o<r;o++)if(i[o]!=n[o])return i[o]-n[o];return i.length-n.length}),this.parentSearchDropdown.setOptions(n),this.parentSearchDropdown.setValue(e)},addChildrenOfEventsToOptions:function(e,t){var i=this;t.children.each(function(t){e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t)})},roleAddClicked:function(e,t){var i=this.model.get("template").types,n=_.find(i,function(t){return _.find(t.roles,function(t){return t.roleId==e})});_.find(n.roles,function(t){return t.roleId==e});this.sourceElement=t,this.editingRoleId=e,this.updateEntitySearchDropdown(e),this.entitySearchContextMenu.show(t)},updateEntitySearchDropdown:function(e){var t=this.model.get("template").types,i=_.find(t,function(t){return _.find(t.roles,function(t){return t.roleId==e})}),n=(_.find(i.roles,function(t){return t.roleId==e}),this.model.get("entitiesByType")),r=(this.model.get("eventData"),this.relationshipLists[e]),o=_.reject(n[i.name],function(e){return _.find(r,function(t){return t.id==e.entityId})});options=[],_.each(o,function(e){options.push({value:e.entityId,label:e.name})}),this.entitySearchContextMenu.setOptions(options)},contextEntityClick:function(){var e=this.entitySearchContextMenu.getValue(),t=this.model.get("timeline"),i=(t.get("laneIds"),t.get("entities").get(e));i&&(this.relationshipLists[this.editingRoleId].push({id:i.id,title:i.get("name")}),this.renderRoleList(this.editingRoleId))},roleRemoveClicked:function(e,t,i){this.relationshipLists[e]=_.filter(this.relationshipLists[e],function(e){return e.id!=t}),this.renderRoleList(e)},updateRoleList:function(e,t,i){var n=this,r=this.model.get("timeline"),o=(r.get("laneIds"),r.get("entities"));this.relationshipLists[e]=[],o.each(function(r){r.get("type")==t&&r.id==i&&n.relationshipLists[e].push({id:r.id,title:r.get("name")})}),this.renderRoleList(e)},renderRoleList:function(e){var t=[];_.each(this.relationshipLists[e],function(e){t.push({actionIcon:"",id:e.id,title:e.title,extra:""})}),this.roleListViews[e].render(t)},updateRoleDropdown:function(e,t,i){var n=this.model.get("timeline"),r=(n.get("laneIds"),n.get("entities")),o=window.mainApp.isExpressMode?[]:[{name:"None",value:ATEmptyGuidString}],s=!1;r.each(function(e){e.get("type")==t&&(o.push({value:e.id,name:e.get("name")}),e.id==i&&(s=!0))}),this.roleDropdowns[e].setOptions(o),s?this.roleDropdowns[e].setValue(i):this.roleDropdowns[e].setValue(ATEmptyGuidString)},titleInput:function(){this.validateForm()},setTitleFieldIsInvalid:function(e){this.$titleInput[0].setCustomValidity(e?"Error":"")},validateForm:function(){var e=!0,t=this.$titleInput.val();this.setTitleFieldIsInvalid(!t),t||(e=!1);!1===this.startDatePickerView.getValid()&&(e=!1);return!1===this.endDatePickerView.getValid()&&(e=!1),$("#addEventSubmit").prop("disabled",!e),e},addClickHandler:function(e){var t=this,i=this.model.get("template"),n=this.$titleInput.val(),r=this.colorDropdown.getValue(),o=this.parentSearchDropdown.getValue(),s=this.startDatePickerView.text(),a=this.durationPickerView.text(),l=(this.endDatePickerView.text(),{});return this.validateForm()?!0===this.formSubmitted?(e.preventDefault(),!1):(this.formSubmitted=!0,_.each(i.types,function(e){_.each(e.roles,function(e){var i,n=e.roleId;e.multiplePerEvent?(i=t.relationshipLists[n])&&i.length>0&&(l[n]=[],_.each(i,function(e){l[n].push(e.id)})):(i=t.roleDropdowns[n].getValue())!=ATEmptyGuidString&&(l[n]=[i])})}),window.mainApp.removeExistingModal(),window.mainApp.showNewParentPromptIfNeeded(o,function(e){window.ApplicationInterface.addEvent(window.timelineDocumentId,n,r,o,e,s,a,JSON.stringify(l))}),e.preventDefault(),!1):(e.preventDefault(),!1)}});module.exports=ATAddEventView;

},{"../../model/ATEmptyGuidString":26,"./ATColorDropdown":59,"./ATDatePicker":60,"./ATDropdown":63,"./ATDurationPicker":64,"./ATInspectorListView":84,"./ATRangeControlManager":93,"./ATSearchDropdown":95,"./ATSearchableContextMenu":96,"./templates/addEventRolesDivTemplate.html":104,"./templates/addEventTemplate.html":105,"backbone":220,"d3":320,"jquery":331,"lodash":333}],56:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("../../utils/ATUtilities"),templateHtml=require("./templates/autoSuggestFieldTemplate.html"),ATAutoSuggestField=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),i=t+"-dropdown",s=t+"-list",e=this,n=_.template(templateHtml);this.allOptions=[],this.matchingOptions=[],this.hasFocus=!1,this.d3El=d3.select("#"+t),this.d3El.html(n({placeholder:""})),this.d3El.classed("autosuggestDiv",!0),this.d3Placeholder=this.d3El.select(".autosuggestPlaceholder").attr("id",t+"-autosuggestPlaceholder"),this.d3Front=this.d3El.select(".autosuggestFront").attr("id",t+"-autosuggestFront"),this.d3Behind=this.d3El.select(".autosuggestBehind").attr("id",t+"-autosuggestBehind"),this.$placeholder=$("#"+t+"-autosuggestPlaceholder"),this.$front=$("#"+t+"-autosuggestFront"),this.$behind=$("#"+t+"-autosuggestBehind"),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",i),this.$dropdown=$("#"+i),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",s),this.$list=$("#"+s),this.$overflowHelper=this.buildOverflowHelper(this.$front),this.d3Placeholder.on("click",this.focusClickHandler.bind(this)),this.d3Front.on("click",this.focusClickHandler.bind(this)),this.d3Behind.on("click",this.focusClickHandler.bind(this)),this.d3Front.on("focus",this.focusHandler.bind(this)),this.d3Front.on("blur",this.blurHandler.bind(this)),this.$front.on("keydown",function(t){e.keyDownHandler(t)}),this.d3Front.on("input",this.inputHandler.bind(this))},buildOverflowHelper:function(t){return $('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:t.css("font-family"),fontSize:t.css("font-size"),fontStyle:t.css("font-style"),fontVariant:t.css("font-variant"),fontWeight:t.css("font-weight"),wordSpacing:t.css("word-spacing"),letterSpacing:t.css("letter-spacing"),textIndent:t.css("text-indent"),textRendering:t.css("text-rendering"),textTransform:t.css("text-transform")}).insertAfter(t)},hasOverflow:function(){var t=this.$front.width()-2;return this.$overflowHelper.text(this.$front.val()),this.$overflowHelper.width()>=t},setPlaceholderText:function(t,i){this.d3Front.attr("placeholder",t),this.d3Placeholder.attr("placeholder",i)},setOptions:function(t){this.allOptions=t,this.filterOptions(),this.renderOptions(),this.hasFocus&&this.showListIfAvailable()},setLookupFunction:function(t){this.lookupFunction=t},setOnFocus:function(t){this.onFocus=t},setOnBlur:function(t){this.onBlur=t},setOnGoToNextField:function(t){this.onGoToNextField=t},clear:function(){this.$front.val(""),this.$behind.val(""),this.$placeholder.val(""),this.inputValid=!1,this.filterOptions(),this.d3Behind.classed("overflowed",this.hasOverflow())},selectIndex:function(t){var i=this.matchingOptions[t];this.highlightIndex=t,this.$front.val(i),this.$behind.val(i),this.inputValid=!0,this.renderOptions(),this.d3Behind.classed("overflowed",this.hasOverflow())},focusClickHandler:function(t){this.onFocus(),this.$front.focus(),this.$front.select()},focusHandler:function(t){this.hasFocus=!0,this.renderOptions(),this.showListIfAvailable(),this.onFocus&&this.onFocus()},blurHandler:function(t){this.hasFocus=!1,this.$behind.val().length?this.$front.val(this.$behind.val()):this.highlightIndex>=0&&this.optionClick(this.highlightIndex),this.onBlur&&this.onBlur()},keyDownHandler:function(t){var i=!1,s=0;switch(t.keyCode||t.which){case 27:this.$front.blur(),i=!0,t.preventDefault();break;case 13:this.highlightIndex>=0&&(this.optionClick(this.highlightIndex),i=!0);break;case 38:-1==this.highlightIndex&&this.matchingOptions.length?s=this.matchingOptions.length-1:this.highlightIndex>0&&(s=this.highlightIndex-1),this.selectIndex(s),i=!0;break;case 40:-1==this.highlightIndex&&this.matchingOptions.length?s=0:this.highlightIndex<this.matchingOptions.length-1&&(s=this.highlightIndex+1),this.selectIndex(s),this.renderOptions(),i=!0}return!i},inputHandler:function(t){var i=this.$front.val(),s=(this.lookupFunction?this.lookupFunction(i):{match:null,list:[]}).match,e=s?s.substr(0,i.length):"";i.length?this.lookupFunction?s?(this.$behind.val(s),this.$front.val(e),this.d3Front.classed("error",!1),this.inputValid=!0):(this.$behind.val(""),this.d3Front.classed("error",!0),this.inputValid=!1):(this.$behind.val(""),this.d3Front.classed("error",!1),this.inputValid=!0):(this.$behind.val(""),this.d3Front.classed("error",!1),this.inputValid=!1),this.filterOptions(),this.d3Behind.classed("overflowed",this.hasOverflow())},filterOptions:function(){var t=this.$front.val(),i=this.$front.get(0).selectionStart,s=(this.$front.get(0).selectionEnd,t.substr(0,i));this.matchingOptions=s?_.filter(this.allOptions,function(t){return ATUtilities.caseInsensitiveStartsWith(t,s)}):this.allOptions,this.highlightIndex=_.indexOf(this.matchingOptions,t),-1==this.highlightIndex&&this.matchingOptions.length&&(this.highlightIndex=0),this.renderOptions()},isInputValid:function(){return this.inputValid},values:function(){return{valid:this.inputValid,original:this.$front.val(),suggestion:this.$behind.val()}},showListIfAvailable:function(){var t=this;this.disabled||(this.matchingOptions.length?(this.renderOptions(),this.slideOpenTimeout=window.setTimeout(function(){t.d3El.classed("open",!0),t.$dropdown.slideDown(250),t.highlightIndex>=0&&t.scrollItemIntoView(),this.open=!0},50)):this.hideList())},scrollItemIntoView:function(){var t=this.$el.attr("id"),i=$("#"+(t+"-list")+"-"+this.highlightIndex),s=this.$list.scrollTop(),e=this.$list.height(),n=i.position()?i.position().top:0,h=i.height();(n<0||n+h>e)&&this.$list.scrollTop(s+n-e/2+h/2)},hideList:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.open=!1,window.clearTimeout(this.slideOpenTimeout),this.slideOpenTimeout=null},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.matchingOptions),s=this.$el.attr("id")+"-list";i.attr("id",function(t,i){return s+"-"+i}).classed("active",function(i){return!!t.selectedOption&&i==t.selectedOption}).classed("highlight",function(i,s){return s==t.highlightIndex}).select("span").text(function(t,i){return t});i.enter().append("li").attr("id",function(t,i){return s+"-"+i}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return!!t.selectedOption&&i==t.selectedOption}).classed("highlight",function(i,s){return s==t.highlightIndex}).on("mousedown",function(i,s){return d3.event.stopPropagation(),t.optionClick(s)}).append("span").text(function(t,i){return t});i.exit().remove(),this.scrollItemIntoView()},optionClick:function(t){return this.selectIndex(t),this.hideList(),this.onGoToNextField&&this.onGoToNextField(),!1}});module.exports=ATAutoSuggestField;

},{"../../utils/ATUtilities":51,"./templates/autoSuggestFieldTemplate.html":109,"backbone":220,"d3":320,"jquery":331,"lodash":333}],57:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATTimeUnit=require("../../model/ATTimeUnit"),ATTimeSpan=require("../../model/ATTimeSpan"),templateHtml=require("./templates/calendarPickerTemplate.html"),ATCalendarPicker=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.$el.parent();this.d3El=d3.select("#"+t),this.d3El.classed("calendarPicker"),this.era=1,this.year=1,this.month=1,this.day=1,this.precision=ATTimeUnit.YEAR,this.d3El.html(e({})),this.yearInputD3=this.d3El.select("#calendarYearInput"),this.$yearInput=this.$("#calendarYearInput"),this.yearInputD3.on("change",this.calendarYearInputChange.bind(this)),this.yearDownArrowD3=this.d3El.select("#yearDivLower").on("click",this.decrementCalendarYearClick.bind(this)),this.yearUpArrowD3=this.d3El.select("#yearDivHigher").on("click",this.incrementCalendarYearClick.bind(this)),this.headerRow=this.d3El.select("#headerRow"),this.tableBody=this.d3El.select("#tableBody"),this.monthYearOnlyDiv=this.d3El.select("#monthYearOnly"),this.yearOnlyDiv=this.d3El.select("#yearOnly"),this.monthsDiv=this.d3El.select("#months")},render:function(){var t=this;this.d3El.on("click",function(e){t.doNothingClick()}),this.setupParentClick(),this.monthYearOnlyDiv.on("click",function(e){t.monthYearOnlyClicked()}),this.yearOnlyDiv.on("click",function(e){t.yearOnlyClicked()}),this.updateMonthDisplay()},setCalendar:function(t){this.calendar=t,this.updateDisplayHeader()},setDate:function(t,e,i,a,n){this.era=t,this.year=e,this.month=i,this.day=a,this.precision=n,this.updateMonthDisplay()},setTimestamp:function(t,e){var i=this.calendar.dateWithTimestamp(t,e);this.era=i.eraIndex,this.year=i.year,this.month=i.month,this.day=i.day,this.precision=e,this.updateMonthDisplay()},setupParentClick:function(){var t=this;this.$el.parent().parent().on("click",function(){t.doNothingClick()})},setDatePicker:function(t){this.datePicker=t},calendarYearInputChange:function(){var t=this.$yearInput.val(),e={};if(this.calendar.dateWithString(t,e),e.foundResult)this.year=e.date.year,this.era=e.date.eraIndex;else{var i=parseInt(this.$yearInput.val());i>0&&(this.year=i)}this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,ATTimeUnit.DAY),this.resumeFocus(!1)},decrementCalendarYearClick:function(){var t=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision),e=new ATTimeSpan(-1,0,0,0,0,0,0),i=this.calendar.dateByAddingTimespanToDate(t,e);this.era=i.eraIndex,this.year=i.year,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,this.precision),this.resumeFocus(!0)},incrementCalendarYearClick:function(){var t=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision),e=new ATTimeSpan(1,0,0,0,0,0,0),i=this.calendar.dateByAddingTimespanToDate(t,e);this.era=i.eraIndex,this.year=i.year,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,this.precision),this.resumeFocus(!0)},yearOnlyClicked:function(t){this.precision=ATTimeUnit.YEAR,this.day=1,this.month=1,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,-1,-1,ATTimeUnit.YEAR),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},monthYearOnlyClicked:function(t){this.precision=ATTimeUnit.MONTH,this.day=1,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,-1,ATTimeUnit.MONTH),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},clickOnMonth:function(t){if(0!==this.calendar.daysInMonthOfYear(t.index+1,this.year,this.era)){if(this.month=t.index+1,this.precision<ATTimeUnit.MONTH&&(this.precision=ATTimeUnit.MONTH),this.precision>=ATTimeUnit.DAY)for(var e=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision);!this.calendar.isValidDate(e);)this.day--,e=this.calendar.dateWithComponents(this.era,this.year,this.month,this.day,0,0,0,this.precision);this.updateMonthDisplay(),this.datePicker&&(this.precision==ATTimeUnit.MONTH?this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,-1,ATTimeUnit.MONTH):this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,ATTimeUnit.DAY)),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()}},clickOnDate:function(t){t<=0||(this.day=t,this.precision=ATTimeUnit.DAY,this.updateMonthDisplay(),this.datePicker&&this.datePicker.setEraYearMonthDayPrecision(this.era,this.year,this.month,this.day,ATTimeUnit.DAY),this.resumeFocus(!0),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},doNothingClick:function(t){this.resumeFocus()},resumeFocus:function(t){this.datePicker&&this.datePicker.resumeFocus(t)},updateDisplayHeader:function(){var t=this.calendar.weekdays.length,e=Math.max(3*t,27.5),i=this.headerRow.selectAll("th").data(this.calendar.weekdays);i.text(function(t){return t.shortName.charAt(0)+t.shortName.charAt(1)}),i.enter().append("th").text(function(t){return t.shortName.charAt(0)+t.shortName.charAt(1)}),this.d3El.style("width",e+"rem")},updateMonthDisplay:function(){var t=[],e=this.calendar.months,i=this.precision>ATTimeUnit.YEAR?this.calendar.months[this.month-1]:null,a=this.calendar.isLeapYearInEra(this.year,this.era),n=i?a?i.leapDuration:i.normalDuration:0,s=i?this.calendar.dateWithComponents(this.era,this.year,this.month,1,0,0,0,0).weekdayIndex:0,r=0,h=this.calendar.weekdays.length,o=0,c=[],d=Math.ceil(e.length/6),l=100/Math.ceil(e.length/d);if(i){for(t.push(c),r=0;r<s;r++)c.push(""),o++;for(r=1;r<=n;r++)o==h&&(o=0,c=[],t.push(c)),c.push(String(r)),o++;for(r=o;r<h;r++)c.push("")}var u=this,p=this.monthsDiv.selectAll("div").data(e);p.text(function(t){return t.shortName}).attr("class",function(t,e){return u.precision>ATTimeUnit.YEAR&&e==u.month-1?"selMonth":null}),p.enter().append("div").text(function(t){return t.shortName}).attr("class",function(t,e){return u.precision>ATTimeUnit.YEAR&&e==u.month-1?"selMonth":null}).style("width",l+"%").on("click",function(t){u.clickOnMonth(t)}),p.exit().remove();var m=this.tableBody.selectAll("tr").data(t);m.enter().append("tr");var y=m.selectAll("td").data(function(t){return t});y.select("div").text(function(t){return t}).attr("class",function(t){return u.precision>ATTimeUnit.MONTH&&t==u.day?"selected":null}),y.enter().append("td").append("div").text(function(t){return t}).attr("class",function(t){return u.precision>ATTimeUnit.MONTH&&t==u.day?"selected":""}).on("click",function(t){u.clickOnDate(t)}),y.exit().remove(),m.exit().remove();for(var T=String(this.year);T.length<4;)T="0"+T;T+=" "+this.calendar.eras[this.era].shortName,this.$yearInput.val(T),this.monthYearOnlyDiv.attr("class",this.precision==ATTimeUnit.MONTH?"checked":null),this.yearOnlyDiv.attr("class",this.precision==ATTimeUnit.YEAR?"checked":null)}});module.exports=ATCalendarPicker;

},{"../../model/ATTimeSpan":39,"../../model/ATTimeUnit":40,"./templates/calendarPickerTemplate.html":110,"backbone":220,"d3":320,"jquery":331,"lodash":333}],58:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),d3=require("d3"),ATTimelineView=require("../shared/ATTimelineView"),ATRelationshipView=require("../shared/ATRelationshipView"),ATInspectorView=require("./ATInspectorView"),ATExpressInspectorView=require("./ATExpressInspectorView"),ATFilterBarView=require("./ATFilterBarView"),ATSyncBinderView=require("./ATSyncBinderView"),mainTimelineHtml=require("./templates/mainTimelineWindow.html"),ATCanvasManager=function(e,i){var n=ATInspectorView;i?(this.isExpressMode=!0,n=ATExpressInspectorView):(this.isExpressMode=!1,n=ATInspectorView),this.inspectorVisible=!1,this.filterBarVisible=!1,this.syncBinderVisible=!1,$("#bounds").html(mainTimelineHtml),this.relationshipView=new ATRelationshipView({el:"#relationshipContentDiv",model:e.timelineViewModel}),this.timelineView=new ATTimelineView({el:"#mainTimelineContentDiv",model:e.timelineViewModel}),this.inspectorView=new n({el:"#inspector",model:e.inspectorModel}),this.filterBarView=new ATFilterBarView({el:"#filterBarDiv",model:e.inspectorModel}),this.syncBinderView=new ATSyncBinderView({el:"#syncBinder",model:e.timeline}),this.relationshipView.setInspectorModel(e.inspectorModel),this.timelineView.setRelationshipView(this.relationshipView),this.timelineView.configureInteraction("desktop"),this.relationshipView.configureInteraction("desktop"),this.inspectorD3=d3.select("#inspector"),this.mainCanvasD3=d3.select("#mainTimelineCanvas"),this.syncBinderD3=d3.select("#syncBinder"),this.$bounds=$("#bounds"),this.syncBinderD3.style("display","none")};ATCanvasManager.prototype.setIsRelationshipView=function(e){},ATCanvasManager.prototype.setUndoRedoState=function(e,i){},ATCanvasManager.prototype.isFilterBarVisible=function(){return this.filterBarVisible},ATCanvasManager.prototype.adjustFilterBar=function(e){var i=this;this.filterBarVisible&&this.timelineView.filterBarDiv.style("visibility",null),window.setTimeout(function(){i.resizeFilterBar(e)},100)},ATCanvasManager.prototype.resizeFilterBar=function(e){var i=this,n=$(".filterBar").innerHeight(),t=this.filterBarVisible?$(".filterControl").outerHeight()+9:0;if(e){d3.transition().duration(300).tween("filterTween",function(){var e=d3.interpolateNumber(n,t);return function(n){var s=e(n);i.timelineView.holdRendering(),i.timelineView.filterBarDiv.style("height",s+"px"),i.timelineView.filterBarDiv.style("visibility",s?null:"hidden"),i.timelineView.filterBarDiv.classed("visibleFilter",!(!i.filterBarVisible||s!=t)),i.timelineView.d3El.style("top",s+"px"),i.relationshipView.d3El.style("top",s+"px"),i.timelineView.resizeWindow(null,!0),i.timelineView.releaseRendering()}})}else i.timelineView.holdRendering(),i.timelineView.filterBarDiv.style("height",t+"px"),i.timelineView.d3El.style("top",t+"px"),i.relationshipView.d3El.style("top",t+"px"),i.timelineView.resizeWindow(null,!0),i.timelineView.filterBarDiv.style("visibility",this.filterBarVisible?null:"hidden"),i.timelineView.filterBarDiv.classed("visibleFilter",this.filterBarVisible),i.timelineView.releaseRendering()},ATCanvasManager.prototype.resizeInspector=function(e){var i=$("#syncBinder").width()+e;this.timelineView.holdRendering(),this.inspectorD3.style("width",e+"px"),window.isAeonWebExport?this.mainCanvasD3.style("width","calc(100% - "+i+"px)"):this.mainCanvasD3.style("width","-webkit-calc(100% - "+i+"px)"),this.timelineView.resizeWindow(null),0==e?this.inspectorD3.style("display","none"):this.inspectorD3.style("display",null),this.inspectorView.resize(),this.timelineView.releaseRendering()},ATCanvasManager.prototype.adjustInspector=function(e){0==this.inspectorView.currentWidthWhenOpen&&(this.inspectorView.currentWidthWhenOpen=350);var i=this,n=$("#inspector").innerWidth(),t=this.inspectorVisible?this.inspectorView.currentWidthWhenOpen:0;if(e){d3.transition().duration(300).tween("inspectorTween",function(){var e=d3.interpolateNumber(n,t);return function(n){i.resizeInspector(e(n))}})}else i.resizeInspector(t)},ATCanvasManager.prototype.showFilterBar=function(e){this.filterBarVisible=!0,this.adjustFilterBar(e)},ATCanvasManager.prototype.hideFilterBar=function(e){this.filterBarVisible=!1,this.adjustFilterBar(e)},ATCanvasManager.prototype.showInspector=function(e){this.inspectorVisible=!0,this.adjustInspector(e)},ATCanvasManager.prototype.hideInspector=function(e){this.inspectorVisible=!1,this.adjustInspector(e)},ATCanvasManager.prototype.resizeSyncBinder=function(e){var i=$("#inspector").innerWidth()+e;this.timelineView.holdRendering(),this.syncBinderD3.style("width",e+"px"),window.isAeonWebExport?this.mainCanvasD3.style("width","calc(100% - "+i+"px)"):this.mainCanvasD3.style("width","-webkit-calc(100% - "+i+"px)"),this.mainCanvasD3.style("left",e+"px"),this.timelineView.resizeWindow(null),0==e?this.syncBinderD3.style("display","none"):this.syncBinderD3.style("display",null),this.syncBinderView&&this.syncBinderView.resize(),this.timelineView.releaseRendering()},ATCanvasManager.prototype.adjustSyncBinder=function(e){var i=this,n=$("#syncBinder").innerWidth(),t=this.syncBinderVisible?this.syncBinderView.currentWidthWhenOpen:0;this.$bounds.innerWidth(),$("#inspector").innerWidth();if(e){d3.transition().duration(300).tween("syncBinderTween",function(){var e=d3.interpolateNumber(n,t);return function(n){i.resizeSyncBinder(e(n))}})}else i.resizeSyncBinder(t)},ATCanvasManager.prototype.showSyncBinder=function(e,i){this.syncBinderView.currentWidthWhenOpen=i,this.syncBinderVisible=!0,this.adjustSyncBinder(e)},ATCanvasManager.prototype.hideSyncBinder=function(e){this.syncBinderVisible=!1,this.adjustSyncBinder(e)},module.exports=ATCanvasManager;

},{"../shared/ATRelationshipView":198,"../shared/ATTimelineView":201,"./ATExpressInspectorView":75,"./ATFilterBarView":79,"./ATInspectorView":88,"./ATSyncBinderView":97,"./templates/mainTimelineWindow.html":160,"d3":320,"jquery":331,"lodash":333}],59:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/colorDropdownTemplate.html"),ATColorDropdown=Backbone.View.extend({setOptions:function(t){this.visibleOptions=t,this.selectedOption&&this.setValue(this.selectedOption.name)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.visibleOptions,function(i){return i.name==t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},getValue:function(){return this.selectedOption?this.selectedOption.name:null},initialize:function(){var t=this.$el.attr("id"),i=t+"-label",e=t+"-caret",s=t+"-dropdown",n=t+"-list",l=_.template(templateHtml),o=this;this.visibleOptions=[],this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.d3El=d3.select("#"+t),this.d3El.classed("bselect colorDropdown",!0),this.d3El.attr("tabindex",0),this.d3El.html(l({})),this.$el.keydown(function(t){return o.keyDownHandler(t)}),this.$el.on("blur",function(){return o.blurHandler()}),this.d3El.on("click",function(){o.open||o.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",i).on("click",this.toggle.bind(this)),this.d3LabelName=this.d3Label.select("span"),this.d3LabelColor=this.d3Label.select(".colorSquareLabel"),this.d3El.select(".bselect-caret").attr("id",e).on("click",this.toggle.bind(this)),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",s),this.$dropdown=$("#"+s),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",n),this.$list=$("#"+n),this.updateTitle()},toggle:function(){this.disabled||this.open?this.hide():(this.show(),this.$el.focus()),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.attr("id")+"-list",i=(this.selectedOption&&this.selectedOption.colorId,this.$el.height()+this.$el.offset().top),e=$(window).height()-i<250;this.disabled||(this.d3El.classed("open",!0),this.d3El.classed("flipped",e),this.$dropdown.slideDown(250),this.renderOptions(),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.scrollItemIntoView(),this.open=!0)},hide:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.open=!1},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id")+"-list";i.attr("id",function(t){return e+"-"+t.colorId}).classed("active",function(i){return!!t.selectedOption&&i.name==t.selectedOption.name}).classed("highlight",function(i,e){return e==t.highlightIndex}),i.select(".colorSquare").attr("class",function(t){return"colorSquare "+t.color}),i.select("span").text(function(t){return t.name});var s=i.enter().append("li").attr("id",function(t){return e+"-"+t.colorId}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return!!t.selectedOption&&i.name==t.selectedOption.name}).classed("highlight",function(i,e){return e==t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)});s.append("div").classed("colorSquare",!0).attr("class",function(t){return"colorSquare "+t.color}),s.append("span").text(function(t){return t.name}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id")+"-list",i=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,e=i?t+"-"+i.value:null,s=null;if(e){s=$("#"+e);var n=this.$list.scrollTop(),l=this.$list.height(),o=s.position()?s.position().top:0,h=s.height();(o<0||o+h>l)&&this.$list.scrollTop(n+o-l/2+h/2)}},updateTitle:function(){this.selectedOption?(this.d3LabelName.text(this.selectedOption.name),this.d3LabelColor.attr("class","colorSquare "+this.selectedOption.color).style("border-color",null)):(this.d3LabelName.html(this.noOptionPlaceholder),this.d3LabelColor.attr("class","colorSquare"))},optionClick:function(t){return this.selectedOption=_.find(this.visibleOptions,function(i){return i.name==t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change"),!1},keyDownHandler:function(t){var i=!1;switch(t.keyCode||t.which){case 9:this.open&&(this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide());break;case 13:this.open?this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide():this.$el.closest("form").submit(),i=!0;break;case 27:this.open&&(this.hide(),i=!0);break;case 38:this.open?(-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,i=!0):this.show();break;case 40:this.open?(-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,i=!0):this.show()}return this.renderOptions(),!i},focusHandler:function(){},blurHandler:function(){this.hide()}});module.exports=ATColorDropdown;

},{"./templates/colorDropdownTemplate.html":111,"backbone":220,"d3":320,"jquery":331,"lodash":333}],60:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),d3=require("d3"),Backbone=require("backbone"),ATCalendarPicker=require("./ATCalendarPicker"),ATCalendarType=require("../../model/ATCalendarType"),ATTimeUnit=require("../../model/ATTimeUnit"),ATDatePicker=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=t+"-picker",i=t+"-input",a=t+"-backdrop",s=t+"-calendar",n=this;this.value=null,this.inputValid=!1,this.changeCallback=null,this.continuousChangeCallback=null,this.allowCompletion=!0,this.allowEmptyValues=!0,this.hasChanged=!1,this.isEndPicker=!1,this.pairedStartPicker=null,this.d3El=d3.select("#"+t),this.d3El.classed("datePickerWrap",!0),this.d3pickerDiv=this.d3El.append("div").attr("id",e).attr("class","datePickerDiv"),this.backdrop=this.d3El.append("div").attr("id",a).attr("class","backdrop").style("display","none").on("click",function(){n.focusLost()}),this.backdropOn=!1,this.d3textInput=this.d3pickerDiv.append("input").attr("id",i).attr("class","datePickerInput").attr("type","text").on("focus",function(){n.focusHandler()}).on("blur",function(){n.blurHandler()}).on("input",function(){n.inputHandler()}).on("keydown",function(){n.keyDownHandler()}),this.textInput=$("#"+i),this.d3calendarIcon=this.d3pickerDiv.append("span").attr("id",i).attr("class","fa fa-calendar-o").on("click",function(){n.calendarClickHandler()}),this.d3calendar=this.d3El.append("div").attr("id",s).style("display","none"),this.calendarPickerView=new ATCalendarPicker({el:"#"+s}),this.calendarPickerView.setDatePicker(this),this.$el.popover({content:this.calendarPickerView.el,container:"#"+this.$el.attr("id"),html:!0,placement:function(t,e){var i=$(window),a=$(e),s=i.height(),n=312*window.mainApp.timelineView.physicalScaleFactor,l=a.offset();return l.top+n+50<s?"in bottom":l.top-n-50>0?"in top":l.left-50>0?"in left":"in right"},trigger:"manual",animation:!1,template:'<div class="popover calendar"><div class="arrow"></div><div class="popover-content"></div></div>'})},setupAsEndPickerForStartPicker:function(t){this.isEndPicker=!0,this.pairedStartPicker=t},setAllowEmptyValues:function(t){this.allowEmptyValues=t},setChangeCallback:function(t){this.changeCallback=t,this.recordedManagerCallback=null},setContinuousChangeCallback:function(t){this.continuousChangeCallback=t},setManagerCallback:function(t){this.managerCallback=t},setValidCallback:function(t){this.validCallback=t},setResetCallback:function(t){this.resetCallback=t},setRangeConversion:function(t){this.rangeConversion=t,t&&(this.calendar=t.calendar,this.calendar?(this.calendarPickerView.setCalendar(this.calendar),this.d3textInput.attr("type","text"),this.d3textInput.attr("class","datePickerInput"),this.d3calendarIcon.style("display",this.calendar.calendarType===ATCalendarType.CALENDAR_TYPE_DATE_TIME?null:"none")):(this.d3textInput.attr("type","text"),this.d3textInput.attr("class","datePickerNumberInput"),this.d3calendarIcon.style("display","none")))},text:function(){return this.textInput.val()},setText:function(t){this.textInput.val(t),this.inputHandler()},getValue:function(){return this.value},getValid:function(){return this.inputValid},setValid:function(t){this.inputValid=t,this.textInput[0].setCustomValidity(t?"":"Error"),this.d3El.classed("invalid",!t),this.d3pickerDiv.classed("invalid",!t),this.validCallback&&this.validCallback()},getPrecision:function(){return this.value?this.value.precision:0},getTimestamp:function(){return this.calendar?this.value.timestamp:this.value},setValue:function(t){this.calendar&&t?this.setTimestamp(t.timestamp,t.precision):this.setTimestamp(t),this.setValid(!0)},setTimestamp:function(t,e){var i,a,s;$.isNumeric(t)&&this.calendar?(a=this.isEndPicker,s=this.pairedStartPicker?this.pairedStartPicker.getValue():null,this.value=this.calendar.dateWithTimestamp(t,e),i=this.calendar.naturalStringFromDate(this.value,!0,a,s,"%Y")):(this.value=t,i=t?String(t):""),this.textInput.val(i),this.updateDisplay(),this.initialDate=this.value,this.initialText=i,this.setValid(!0)},setDate:function(t){this.calendar?this.setTimestamp(t.timestamp,t.precision):this.setTimestamp(t,null),this.setValid(!0)},setDisabled:function(t){this.disabled=t,this.focusLost(),this.textInput.prop("disabled",t),this.d3El.classed("disabled",t)},setEraYearMonthDayPrecision:function(t,e,i,a,s){var n,l,r=this.textInput.val(),h=this.textInput.get(0).selectionStart,c=this.isEndPicker,o=this.pairedStartPicker?this.pairedStartPicker.getValue():null;this.calendar&&(n=s===ATTimeUnit.YEAR?this.rangeConversion.updateStringWithComponents(r,h,[t,e,-1,-1]):s===ATTimeUnit.MONTH?this.rangeConversion.updateStringWithComponents(r,h,[t,e,i,-1]):this.rangeConversion.updateStringWithComponents(r,h,[t,e,i,a]),l=(n=this.calendar.dateWithPartialString(n.string,n.string.length,!0,c,o)).selection,this.value=n.date,this.textInput.val(n.text),this.textInput.get(0).setSelectionRange(l.location,l.location+l.length),this.hasChanged=!0,this.recordedInputValue=this.calendar?this.value.timestamp:this.value,this.recordedInputPrecision=this.calendar?this.value.precision:0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,this.setValid(!0),this.continuousChangeCallback&&this.continuousChangeCallback())},updateDisplay:function(){var t,e=this.value,i=this.isEndPicker,a=this.pairedStartPicker?this.pairedStartPicker.getValue():null;this.calendar&&this.value&&(i&&this.value.timestamp!==a.timestamp&&0===this.value.hour&&0===this.value.minute&&0===this.value.second&&((t=this.calendar.timespanForPrecision(Math.min(ATTimeUnit.DAY,this.value.precision))).days=-t.days,t.months=-t.months,t.years=-t.years,e=this.calendar.dateByAddingTimespanToDate(this.value,t)),this.calendarPickerView.setDate(e.eraIndex,e.year,e.month,e.day,this.value.precision))},keyDownHandler:function(){var t,e,i,a=d3.event.keyCode||d3.event.which,s=!1,n=this.textInput.val(),l=this.textInput.get(0).selectionStart,r=this.textInput.get(0).selectionEnd,h=this.isEndPicker,c=this.pairedStartPicker?this.pairedStartPicker.getValue():null;switch(this.allowCompletion=!0,a){case 9:this.calendar&&(r===n.length||d3.event.shiftKey?0!==l&&d3.event.shiftKey?(i=(t=this.rangeConversion.previousComponentInString(n,l)).selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(i.location,i.location+i.length),s=!0):this.focusLost():(i=(t=this.rangeConversion.nextComponentInString(n,l)).selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(i.location,i.location+i.length),s=!0));break;case 8:case 46:this.allowCompletion=!1;break;case 13:this.textInput.blur(),this.textInput.closest("form").submit(),s=!0;break;case 27:break;case 38:i=(t=this.rangeConversion.incrementString(n,l,1)).selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(i.location,i.location+i.length),this.calendar?(e=this.calendar.dateWithPartialString(t.string,i.location,!1,h,c),this.value=e.date,!e.validDate&&(!this.allowEmptyValues||!this.zeroLengthString)||e.errorRanges.length>0?this.setValid(!1):this.setValid(!0)):(this.value=parseInt(t.string),isNaN(this.value)?this.setValid(!1):this.setValid(!0)),this.updateDisplay(),this.recordedInputValue=this.calendar?this.value.timestamp:this.value,this.recordedInputPrecision=this.calendar?this.value.precision:0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,this.hasChanged=!0,s=!0;break;case 40:i=(t=this.rangeConversion.incrementString(n,l,-1)).selection,this.textInput.val(t.string),this.textInput.get(0).setSelectionRange(i.location,i.location+i.length),this.calendar?(e=this.calendar.dateWithPartialString(t.string,i.location,!1,h,c),this.value=e.date,!e.validDate&&(!this.allowEmptyValues||!this.zeroLengthString)||e.errorRanges.length>0?this.setValid(!1):this.setValid(!0)):(this.value=parseInt(t.string),isNaN(this.value)?this.setValid(!1):this.setValid(!0)),this.updateDisplay(),this.hasChanged=!0,this.recordedInputValue=this.calendar?this.value.timestamp:this.value,this.recordedInputPrecision=this.calendar?this.value.precision:0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,s=!0}this.continuousChangeCallback&&this.continuousChangeCallback(),s&&(d3.event.preventDefault(),d3.event.sourceEvent&&d3.event.sourceEvent.preventDefault())},inputHandler:function(){var t,e,i=this.textInput.val(),a=this.textInput.get(0).selectionStart,s=this.isEndPicker,n=this.pairedStartPicker?this.pairedStartPicker.getValue():null;if(!this.calendar)return isNaN(i)||!i.length?void this.setValid(!1):(this.setValid(!0),this.value=parseInt(i),this.recordedInputValue=this.value,this.recordedInputPrecision=0,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,void(this.continuousChangeCallback&&this.continuousChangeCallback()));0===i.length?(this.$el.popover("hide"),this.zeroLengthString=!0):this.zeroLengthString&&(this.$el.popover("show"),this.zeroLengthString=!1),!((t=this.calendar.dateWithPartialString(i,a,this.allowCompletion,s,n)).validDate||this.allowEmptyValues&&this.zeroLengthString)||t.errorRanges.length>0?this.setValid(!1):(this.setValid(!0),e=t.selection,this.value=t.date,this.updateDisplay(),this.allowCompletion&&(this.textInput.val(t.text),this.textInput.get(0).setSelectionRange(e.location,e.location+e.length)),this.allowCompletion=!0,this.hasChanged=!0,this.recordedInputValue=this.value.timestamp,this.recordedInputPrecision=this.value.precision,this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,this.continuousChangeCallback&&this.continuousChangeCallback())},focusHandler:function(){this.d3pickerDiv.classed("focusRing",!0)},showCalendar:function(){this.calendar&&!this.disabled&&(this.focusHasResumed=!0,this.backdropOn=!0,this.backdrop.style("display",null),this.d3calendar.style("display",null),this.$el.popover("show"),this.calendarPickerView.render())},resumeFocus:function(t){t&&this.textInput.focus()},focusLost:function(){this.backdropOn=!1,this.backdrop.style("display","none"),this.$el.popover("hide"),this.d3pickerDiv.classed("focusRing",!1),this.inputValid?(!_.isNil(this.recordedInputValue)&&this.recordedChangeCallback&&this.recordedChangeCallback(this.recordedInputValue,this.recordedInputPrecision),!_.isNil(this.recordedInputValue)&&this.recordedManagerCallback&&this.recordedManagerCallback(this.recordedInputValue,this.recordedInputPrecision),this.setValue(this.value),this.recordedInputValue=null,this.recordedInputPrecision=null,this.recordedChangeCallback=null,this.recordedManagerCallback=null):this.resetCallback&&this.resetCallback()},blurHandler:function(){this.backdropOn||this.focusLost()},focusAndSelectAll:function(){this.textInput.focus(),this.textInput.select()},commit:function(){!_.isNil(this.recordedInputValue)&&this.recordedChangeCallback&&this.focusLost()},calendarClickHandler:function(){this.showCalendar(),this.textInput.focus()}});module.exports=ATDatePicker;

},{"../../model/ATCalendarType":22,"../../model/ATTimeUnit":40,"./ATCalendarPicker":57,"backbone":220,"d3":320,"jquery":331,"lodash":333}],61:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/displaySettingsTemplate.html"),displaySettingsImageHtml=require("./templates/displaySettingsImage.html"),displaySettingsTagListHtml=require("./templates/displaySettingsTagList.html"),displaySettingsLinkListHtml=require("./templates/displaySettingsLinkList.html"),displaySettingsAttachmentListHtml=require("./templates/displaySettingsAttachmentList.html"),displaySettingsPropertyBooleanHtml=require("./templates/displaySettingsPropertyBoolean.html"),displaySettingsPropertyNumberHtml=require("./templates/displaySettingsPropertyNumber.html"),displaySettingsPropertyParagraphHtml=require("./templates/displaySettingsPropertyParagraph.html"),displaySettingsPropertyPercentageHtml=require("./templates/displaySettingsPropertyPercentage.html"),displaySettingsPropertyStringHtml=require("./templates/displaySettingsPropertyString.html"),displaySettingsRoleListHtml=require("./templates/displaySettingsRoleList.html"),ATDisplaySettingsView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=this,i=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+t),this.d3El.html(i()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),$("#displaySettingsShowIds").on("change",this.showIdsChanged.bind(this)),$("#displaySettingsShowDates").on("change",this.showDatesChanged.bind(this)),$("#displaySettingsShowDependencies").on("change",this.showDependenciesChanged.bind(this)),$("#displaySettingsShowToday").on("change",this.showTodayChanged.bind(this)),$("#displaySettingsShowDurationInTitle").on("change",this.showDurationInTitleChanged.bind(this)),$("#displaySettingsExpandAll").on("change",this.expandAllChanged.bind(this)),this.skinDropdown=new ATDropdown({el:"#displaySettingsSkin"}),this.listenTo(this.skinDropdown,"change",this.skinChanged.bind(this)),this.sizeDropdown=new ATDropdown({el:"#displaySettingsSize"}),this.listenTo(this.sizeDropdown,"change",this.sizeChanged.bind(this)),this.scrollDropdown=new ATDropdown({el:"#displaySettingsScrollingBounds"}),this.listenTo(this.scrollDropdown,"change",this.scrollChanged.bind(this)),this.layoutDropdown=new ATDropdown({el:"#displaySettingsLayout"}),this.listenTo(this.layoutDropdown,"change",this.layoutChanged.bind(this)),this.$leftColumn=$("#leftDisplayColumn"),this.$rightColumn=$("#rightDisplayColumn"),this.$leftDropTarget=$("#leftAddDropTarget"),this.$rightDropTarget=$("#rightAddDropTarget"),this.$availableGroup=$("#availableGroup"),this.$leftDropTarget.on("dragover",function(t){return e.dragOver(t.originalEvent,e.$leftDropTarget)}),this.$leftDropTarget.on("dragenter",function(t){return e.dragEnter(t.originalEvent,e.$leftDropTarget)}),this.$leftDropTarget.on("dragleave",function(t){return e.dragLeave(t.originalEvent,e.$leftDropTarget)}),this.$leftDropTarget.on("drop",function(t){return e.drop(t.originalEvent,e.$leftDropTarget)}),this.$rightDropTarget.on("dragover",function(t){return e.dragOver(t.originalEvent,e.$rightDropTarget)}),this.$rightDropTarget.on("dragenter",function(t){return e.dragEnter(t.originalEvent,e.$rightDropTarget)}),this.$rightDropTarget.on("dragleave",function(t){return e.dragLeave(t.originalEvent,e.$rightDropTarget)}),this.$rightDropTarget.on("drop",function(t){return e.drop(t.originalEvent,e.$rightDropTarget)}),this.$availableGroup.on("dragover",function(t){return e.dragOver(t.originalEvent,e.$availableGroup)}),this.$availableGroup.on("dragenter",function(t){return e.dragEnter(t.originalEvent,e.$availableGroup)}),this.$availableGroup.on("dragleave",function(t){return e.dragLeave(t.originalEvent,e.$availableGroup)}),this.$availableGroup.on("drop",function(t){return e.drop(t.originalEvent,e.$availableGroup)}),$("#displaySettingsForm").on("submit",this.okClickHandler.bind(this)),$("#displaySettingsApply").on("click",this.applyClickHandler.bind(this)),$("#displaySettingsCancel").on("click",this.cancelClickHandler.bind(this)),this.draggedItem=null},setDisplayTemplateSettings:function(t){this.displaySettings=t,this.buildDisplayItems(),this.render()},buildDisplayItems:function(){var t=this,e=this.model.get("template"),i=e.properties,n=e.types,s=this.displaySettings.moreInfoLeftColumn,a=this.displaySettings.moreInfoRightColumn,r=/LABEL/g,l=/TYPE/g;this.displayItems=[],this.displayItems.push({name:"Image",type:"image",optionId:"",show:!0,innerHtml:displaySettingsImageHtml}),this.displayItems.push({name:"Tags",type:"tags",optionId:"",show:!0,innerHtml:displaySettingsTagListHtml}),this.displayItems.push({name:"Attachments",type:"attachments",optionId:"",show:!0,innerHtml:displaySettingsAttachmentListHtml}),this.displayItems.push({name:"Links",type:"links",optionId:"",show:!0,innerHtml:displaySettingsLinkListHtml}),_.each(i,function(e){var i;i=(i="percentage"===e.type?displaySettingsPropertyPercentageHtml:"multitext"===e.type||"richtext"===e.type?displaySettingsPropertyParagraphHtml:"number"===e.type||"currency"===e.type||"decimal"===e.type?displaySettingsPropertyNumberHtml:"boolean"===e.type?displaySettingsPropertyBooleanHtml:displaySettingsPropertyStringHtml).replace(r,e.name),t.displayItems.push({name:e.name,type:e.type,optionId:e.id,show:!0,innerHtml:i})}),_.each(n,function(e){_.each(e.roles,function(i){var n=displaySettingsRoleListHtml.replace(r,i.name);n=n.replace(l,e.name),t.displayItems.push({name:i.name,type:"role",optionId:i.id,show:!0,innerHtml:n})})}),this.leftColItems=[],this.rightColItems=[],_.each(s,function(e){var i=_.find(t.displayItems,function(t){return e.name===t.name});i&&t.leftColItems.push(i)}),_.each(a,function(e){var i=_.find(t.displayItems,function(t){return e.name===t.name});i&&t.rightColItems.push(i)}),this.remainderItems=this.displayItems,this.remainderItems=_.difference(this.remainderItems,this.leftColItems),this.remainderItems=_.difference(this.remainderItems,this.rightColItems)},render:function(){var t,e,i=this,n=d3.select("#leftDisplayColumn").selectAll(".displayItem").data(this.leftColItems),s=d3.select("#rightDisplayColumn").selectAll(".displayItem").data(this.rightColItems),a=d3.select("#available").selectAll(".item").data(this.remainderItems),r=this.displaySettings.skin?this.displaySettings.skin:"dark",l=this.displaySettings.size?this.displaySettings.size:"100",o=this.displaySettings.scrollingBehaviour?this.displaySettings.scrollingBehaviour:"bounce",d=this.displaySettings.layout?this.displaySettings.layout:"cascade";this.formSubmitted=!1,this.skinDropdown.setValue(r),this.sizeDropdown.setValue(l),this.scrollDropdown.setValue(o),this.layoutDropdown.setValue(d),d3.select("#displaySettingsShowIds").attr("checked",this.displaySettings.showEventId?"checked":null),d3.select("#displaySettingsShowDates").attr("checked",this.displaySettings.showEventDate?"checked":null),d3.select("#displaySettingsShowToday").attr("checked",this.displaySettings.showTodayLine?"checked":null),d3.select("#displaySettingsShowDurationInTitle").attr("checked",this.displaySettings.showDurationInTitle?"checked":null),n.select(".displayItemContent").html(function(t){return t.innerHtml}),n.select(".removeButton").on("click",function(t){i.removeDisplayItem(t)}),(t=n.enter().append("div").classed("displayItem draggableClass",!0).attr("draggable","true").on("dragstart",function(t){return i.dragStart(t,$(this))}).on("dragend",function(t){return i.dragEnd(t)}).on("dragover",function(t){return i.dragOver(d3.event,$(this))}).on("dragenter",function(t){return i.dragEnter(d3.event,$(this))}).on("dragleave",function(t){return i.dragLeave(d3.event,$(this))}).on("drop",function(t){return i.drop(d3.event,$(this),t)})).append("div").classed("displayItemContent",!0).style("pointer-events","none").html(function(t){return t.innerHtml}),t.append("div").classed("removeButton",!0).on("click",function(t){i.removeDisplayItem(t)}).append("span").classed("fa fa-times-circle",!0),n.exit().remove(),s.select(".displayItemContent").html(function(t){return t.innerHtml}),s.select(".removeButton").on("click",function(t){i.removeDisplayItem(t)}),(e=s.enter().append("div").classed("displayItem draggableClass",!0).attr("draggable","true").on("dragstart",function(t){return i.dragStart(t,$(this))}).on("dragend",function(t){return i.dragEnd(t)}).on("dragover",function(t){return i.dragOver(d3.event,$(this))}).on("dragenter",function(t){return i.dragEnter(d3.event,$(this))}).on("dragleave",function(t){return i.dragLeave(d3.event,$(this))}).on("drop",function(t){return i.drop(d3.event,$(this),t)})).append("div").classed("displayItemContent",!0).style("pointer-events","none").html(function(t){return t.innerHtml}),e.append("div").classed("removeButton",!0).on("click",this.removeDisplayItem.bind(this)).append("span").classed("fa fa-times-circle",!0),s.exit().remove(),a.text(function(t){return t.name}),a.enter().append("div").classed("item draggableClass",!0).attr("draggable","true").text(function(t){return t.name}).on("dragstart",function(t){return i.dragStart(t,$(this))}).on("dragend",function(t){return i.dragEnd(t)}),a.exit().remove()},dragStart:function(t,e){var i=d3.event;i.dataTransfer.effectAllowed="move",i.dataTransfer.setData("text",t.name),i.dataTransfer.setDragImage(e[0],5,5),this.draggedItem=t},dragEnd:function(t){this.draggedItem=null},dragOver:function(t,e){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",e===this.$availableGroup&&e.addClass("over"),!1},dragEnter:function(t,e){e.addClass("over")},dragLeave:function(t,e){e.removeClass("over")},drop:function(t,e,i){var n=this,s=_.indexOf(this.leftColItems,this.draggedItem),a=_.indexOf(this.rightColItems,this.draggedItem),r=_.indexOf(this.leftColItems,i),l=_.indexOf(this.rightColItems,i);return t.stopPropagation&&t.stopPropagation(),e.removeClass&&e.removeClass("over"),-1!==s&&(this.displaySettings.moreInfoLeftColumn=_.reject(this.displaySettings.moreInfoLeftColumn,function(t){return t.name===n.draggedItem.name})),-1!==a&&(this.displaySettings.moreInfoRightColumn=_.reject(this.displaySettings.moreInfoRightColumn,function(t){return t.name===n.draggedItem.name})),i?-1!==r?this.displaySettings.moreInfoLeftColumn.splice(r,0,this.draggedItem):-1!==l&&this.displaySettings.moreInfoRightColumn.splice(l,0,this.draggedItem):e===this.$leftDropTarget?this.displaySettings.moreInfoLeftColumn.push(this.draggedItem):e===this.$rightDropTarget&&this.displaySettings.moreInfoRightColumn.push(this.draggedItem),this.buildDisplayItems(),this.render(),t.preventDefault(),!1},removeDisplayItem:function(t){this.displaySettings.moreInfoLeftColumn=_.reject(this.displaySettings.moreInfoLeftColumn,function(e){return e.name===t.name}),this.displaySettings.moreInfoRightColumn=_.reject(this.displaySettings.moreInfoRightColumn,function(e){return e.name===t.name}),this.buildDisplayItems(),this.render()},showIdsChanged:function(){this.displaySettings.showEventId=$("#displaySettingsShowIds").prop("checked")},showDatesChanged:function(){this.displaySettings.showEventDate=$("#displaySettingsShowDates").prop("checked")},showDependenciesChanged:function(){this.displaySettings.showDependencies=$("#displaySettingsShowDependencies").prop("checked")},showTodayChanged:function(){this.displaySettings.showTodayLine=$("#displaySettingsShowToday").prop("checked")},showDurationInTitleChanged:function(){this.displaySettings.showDurationInTitle=$("#displaySettingsShowDurationInTitle").prop("checked")},expandAllChanged:function(){this.displaySettings.parmenentExpandEvents=$("#displaySettingsExpandAll").prop("checked")},skinChanged:function(){this.displaySettings.skin=this.skinDropdown.getValue()},sizeChanged:function(){this.displaySettings.size=parseInt(this.sizeDropdown.getValue())},scrollChanged:function(){this.displaySettings.scrollingBehaviour=this.scrollDropdown.getValue()},layoutChanged:function(){this.displaySettings.layout=this.layoutDropdown.getValue()},okClickHandler:function(t){return!0===this.formSubmitted?(window.mainApp.removeExistingModal(),t.preventDefault(),!1):(this.formSubmitted=!0,window.ApplicationInterface&&window.ApplicationInterface.updateDisplaySettings(window.timelineDocumentId,JSON.stringify(this.displaySettings)),window.mainApp.removeExistingModal(),t.preventDefault(),!1)},applyClickHandler:function(t){return window.ApplicationInterface&&window.ApplicationInterface.updateDisplaySettings(window.timelineDocumentId,JSON.stringify(this.displaySettings)),t.preventDefault(),!1},cancelClickHandler:function(t){return window.mainApp.removeExistingModal(),t.preventDefault(),!1}});module.exports=ATDisplaySettingsView;

},{"./ATDropdown":63,"./templates/displaySettingsAttachmentList.html":112,"./templates/displaySettingsImage.html":113,"./templates/displaySettingsLinkList.html":114,"./templates/displaySettingsPropertyBoolean.html":115,"./templates/displaySettingsPropertyNumber.html":116,"./templates/displaySettingsPropertyParagraph.html":117,"./templates/displaySettingsPropertyPercentage.html":118,"./templates/displaySettingsPropertyString.html":119,"./templates/displaySettingsRoleList.html":120,"./templates/displaySettingsTagList.html":121,"./templates/displaySettingsTemplate.html":122,"backbone":220,"d3":320,"jquery":331,"lodash":333}],62:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/dropdownTemplate.html"),ATDropdown=Backbone.View.extend({setOptions:function(t){var i=this;this.visibleOptions=_.map(t,function(t){var e=t.value?t.value:t.name,s=e&&e.replace?e.replace(/[\s[\]:]/g,"_-_"):String(e);return i.trueValueForCleanValue[s]=e,{name:t.name,value:s}}),this.selectedOption&&this.setValue(this.selectedOption.value)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},selectFirst:function(){this.selectedOption=this.visibleOptions.length>0?this.visibleOptions[0]:null,this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},setValue:function(t){var i=t&&t.replace?t.replace(/[\s[\]:]/g,"_-_"):String(t);this.selectedOption=_.find(this.visibleOptions,function(t){return String(t.value)===String(i)}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},getValue:function(){var t;return this.selectedOption?((t=this.selectedOption.value)&&this.trueValueForCleanValue[t]&&(t=this.trueValueForCleanValue[t]),t):null},getText:function(){return this.selectedOption?this.selectedOption.name:null},initialize:function(){var t,i=this.$el.attr("id"),e=i+"-label",s=i+"-caret",n=i+"-dropdown",l=i+"-list",h=_.template(templateHtml),o=this;this.trueValueForCleanValue={},this.visibleOptions=[],this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.d3El=d3.select("#"+i),"SELECT"===this.$el.prop("nodeName")&&(this.d3El.selectAll("option").each(function(){var t,i=$(this),e=i.text(),s=i.prop("value"),n=i.is(":selected");s||(s=e),t=s&&s.replace?s.replace(/[\s[\]:]/g,"_-_"):String(s),o.trueValueForCleanValue[t]=s,o.visibleOptions.push({name:e,value:t}),n&&(o.selectedOption=o.visibleOptions[o.visibleOptions.length-1])}),t=this.$el.prop("class"),this.$el.replaceWith('<div id="'+i+'"></div>'),this.$el=$("#"+i),this.d3El=d3.select("#"+i),this.$el.prop("class",t)),this.d3El.classed("bselect",!0),this.d3El.attr("tabindex",0),this.d3El.html(h({})),this.$el.keydown(function(t){return o.keyDownHandler(t)}),this.$el.on("blur",function(){return o.blurHandler()}),this.d3El.on("click",function(){o.open||o.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",e).on("click",this.toggle.bind(this)),this.d3El.select(".bselect-caret").attr("id",s).on("click",this.toggle.bind(this)),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",n),this.$dropdown=$("#"+n),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",l),this.$list=$("#"+l),this.updateTitle(),this.selectedOption&&this.setValue(this.selectedOption.value)},toggle:function(t){this.disabled||this.open?this.hide():(this.show(),this.$el.focus()),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.height()+this.$el.offset().top,i=$(window).height()-t<250;this.disabled||(this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.d3El.classed("open",!0),this.d3El.classed("flipped",i),this.$dropdown.slideDown(250),this.renderOptions(),this.scrollItemIntoView(),this.open=!0)},hide:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.open=!1},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id")+"-list";i.attr("id",function(t){return e+"-"+t.value}).classed("active",function(i){return!!t.selectedOption&&i.name===t.selectedOption.name}).classed("highlight",function(i,e){return e===t.highlightIndex}).select("span").text(function(t){return t.name}),i.enter().append("li").attr("id",function(t){return e+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return!!t.selectedOption&&i.name===t.selectedOption.name}).classed("highlight",function(i,e){return e===t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)}).append("span").text(function(t){return t.name}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t,i,e,s,n=this.$el.attr("id")+"-list",l=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,h=l?n+"-"+l.value:null,o=null;h&&(o=$("#"+h),t=this.$list.scrollTop(),i=this.$list.height(),e=o.position()?o.position().top:0,s=o.height(),(e<0||e+s>i)&&this.$list.scrollTop(t+e-i/2+s/2))},updateTitle:function(){this.selectedOption?this.d3Label.text(this.selectedOption.name):this.d3Label.html(this.noOptionPlaceholder)},optionClick:function(t){return this.selectedOption=_.find(this.visibleOptions,function(i){return i.name===t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change"),!1},keyDownHandler:function(t){var i=!1;switch(t.keyCode||t.which){case 9:this.open&&(this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide());break;case 13:this.open?this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide():this.$el.closest("form").submit(),i=!0;break;case 27:this.open&&(this.hide(),i=!0);break;case 38:this.open?(-1===this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,i=!0):this.show();break;case 40:this.open?(-1===this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,i=!0):this.show()}return this.renderOptions(),!i},blurHandler:function(){this.hide()}});module.exports=ATDropdown;

},{"./templates/dropdownTemplate.html":123,"backbone":220,"d3":320,"jquery":331,"lodash":333}],63:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/dropdownTemplate.html"),ATDropdown=Backbone.View.extend({setOptions:function(t){var i=this;this.visibleOptions=_.map(t,function(t){var e=t.value?t.value:t.name,s=e&&e.replace?e.replace(/[\s[\]:]/g,"_-_"):String(e);return i.trueValueForCleanValue[s]=e,{name:t.name,value:s}}),this.selectedOption&&this.setValue(this.selectedOption.value)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},selectFirst:function(){this.selectedOption=this.visibleOptions.length>0?this.visibleOptions[0]:null,this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},setValue:function(t){var i=t&&t.replace?t.replace(/[\s[\]:]/g,"_-_"):String(t);this.selectedOption=_.find(this.visibleOptions,function(t){return String(t.value)===String(i)}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.renderOptions()},getValue:function(){var t;return this.selectedOption?((t=this.selectedOption.value)&&this.trueValueForCleanValue[t]&&(t=this.trueValueForCleanValue[t]),t):null},getText:function(){return this.selectedOption?this.selectedOption.name:null},initialize:function(){var t,i=this.$el.attr("id"),e=i+"-label",s=i+"-caret",n=i+"-dropdown",l=i+"-list",h=_.template(templateHtml),o=this;this.trueValueForCleanValue={},this.visibleOptions=[],this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.d3El=d3.select("#"+i),"SELECT"===this.$el.prop("nodeName")&&(this.d3El.selectAll("option").each(function(){var t,i=$(this),e=i.text(),s=i.prop("value"),n=i.is(":selected");s||(s=e),t=s&&s.replace?s.replace(/[\s[\]:]/g,"_-_"):String(s),o.trueValueForCleanValue[t]=s,o.visibleOptions.push({name:e,value:t}),n&&(o.selectedOption=o.visibleOptions[o.visibleOptions.length-1])}),t=this.$el.prop("class"),this.$el.replaceWith('<div id="'+i+'"></div>'),this.$el=$("#"+i),this.d3El=d3.select("#"+i),this.$el.prop("class",t)),this.d3El.classed("bselect",!0),this.d3El.attr("tabindex",0),this.d3El.html(h({})),this.$el.keydown(function(t){return o.keyDownHandler(t)}),this.$el.on("blur",function(){return o.blurHandler()}),this.d3El.on("click",function(){o.open||o.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",e).on("click",this.toggle.bind(this)),this.d3El.select(".bselect-caret").attr("id",s).on("click",this.toggle.bind(this)),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",n),this.$dropdown=$("#"+n),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",l),this.$list=$("#"+l),this.updateTitle(),this.selectedOption&&this.setValue(this.selectedOption.value)},toggle:function(t){this.disabled||this.open?this.hide():(this.show(),this.$el.focus()),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.height()+this.$el.offset().top,i=$(window).height()-t<250;this.disabled||(this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.d3El.classed("open",!0),this.d3El.classed("flipped",i),this.$dropdown.slideDown(250),this.renderOptions(),this.scrollItemIntoView(),this.open=!0)},hide:function(){this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.open=!1},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id")+"-list";i.attr("id",function(t){return e+"-"+t.value}).classed("active",function(i){return!!t.selectedOption&&i.name===t.selectedOption.name}).classed("highlight",function(i,e){return e===t.highlightIndex}).select("span").text(function(t){return t.name}),i.enter().append("li").attr("id",function(t){return e+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return!!t.selectedOption&&i.name===t.selectedOption.name}).classed("highlight",function(i,e){return e===t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)}).append("span").text(function(t){return t.name}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.name)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t,i,e,s,n=this.$el.attr("id")+"-list",l=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,h=l?n+"-"+l.value:null,o=null;h&&(o=$("#"+h),t=this.$list.scrollTop(),i=this.$list.height(),e=o.position()?o.position().top:0,s=o.height(),(e<0||e+s>i)&&this.$list.scrollTop(t+e-i/2+s/2))},updateTitle:function(){this.selectedOption?this.d3Label.text(this.selectedOption.name):this.d3Label.html(this.noOptionPlaceholder)},optionClick:function(t){return this.selectedOption=_.find(this.visibleOptions,function(i){return i.name===t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change"),!1},keyDownHandler:function(t){var i=!1;switch(t.keyCode||t.which){case 9:this.open&&(this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide());break;case 13:this.open?this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].name):this.hide():this.$el.closest("form").submit(),i=!0;break;case 27:this.open&&(this.hide(),i=!0);break;case 38:this.open?(-1===this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,i=!0):this.show();break;case 40:this.open?(-1===this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,i=!0):this.show()}return this.renderOptions(),!i},blurHandler:function(){this.hide()}});module.exports=ATDropdown;

},{"./templates/dropdownTemplate.html":123,"backbone":220,"d3":320,"jquery":331,"lodash":333}],64:[function(require,module,exports){
var d3=require("d3"),Backbone=require("backbone"),ATTimeUnit=require("../../model/ATTimeUnit"),ATTimeSpan=require("../../model/ATTimeSpan"),ATDurationPicker=Backbone.View.extend({events:{},initialize:function(){var e=this,t=this.$el.attr("id");this.value=null,this.allowCompletion=!0,this.continuousChangeCallback=null,this.changeCallback=null,this.hasChanged=!1,this.$el.blurOnEnter(),this.d3El=d3.select("#"+t).on("input",function(){e.inputHandler()}).on("blur",function(){e.blurHandler()}).on("keydown",function(){e.keyDownHandler()})},setChangeCallback:function(e){this.changeCallback=e,this.recordedManagerCallback=null},setContinuousChangeCallback:function(e){this.continuousChangeCallback=e},setManagerCallback:function(e){this.managerCallback=e},setRangeConversion:function(e){this.rangeConversion=e},setDurationComponents:function(e){this.rangeConversion&&("date"===this.rangeConversion.type?e.length>0?(this.value=ATTimeSpan.fromComponents(e),this.$el.val(this.rangeConversion.stringFromSpanValue(this.value))):this.disabled||(this.value=null,this.$el.val("")):(this.value=e.length>0?e[0].value:0,e.length>0?this.$el.val(String(this.value)):this.$el.val("0")),this.hasChanged=!1)},setValue:function(e){this.value=e,"date"===this.rangeConversion.type?this.value.years||this.value.months||this.value.weeks||this.value.days||this.value.hours||this.value.minutes||this.value.seconds?this.$el.val(this.rangeConversion.stringFromSpanValue(this.value)):this.$el.val(""):this.$el.val(this.rangeConversion.stringFromSpanValue(this.value)),this.hasChanged=!1},setText:function(e){this.$el.val(e),this.allowCompletion=!1,this.inputHandler()},text:function(){return this.$el.val()},getValue:function(){return this.value},getPrecision:function(){return"date"===this.rangeConversion.type&&this.value?0!==this.value.seconds?ATTimeUnit.SECOND:0!==this.value.minutes?ATTimeUnit.MINUTE:0!==this.value.hours?ATTimeUnit.HOUR:0!==this.value.days?ATTimeUnit.DAY:0!==this.value.weeks?ATTimeUnit.WEEK:0!==this.value.months?ATTimeUnit.MONTH:ATTimeUnit.YEAR:0},focusCursor:function(){var e=this.$el.val().length;this.$el.focus(),this.$el[0].setSelectionRange(e,e)},setDisabled:function(e){this.disabled=e,this.$el.prop("disabled",e),this.$el.blur(),!e||"0"!==this.getValue()&&"0 seconds"!==this.getValue()||this.$el.val("")},keyDownHandler:function(){var e=d3.event.keyCode||d3.event.which,t=!1,n=this.$el.val(),a=this.$el.get(0).selectionStart,i=this.$el.get(0).selectionEnd;switch(this.allowCompletion=!0,e){case 9:0===a&&i===n.length||i-a>0&&(this.$el.get(0).setSelectionRange(i,i),t=!0);break;case 8:case 46:this.allowCompletion=!1}this.continuousChangeCallback&&this.continuousChangeCallback(),t&&(d3.event.preventDefault(),d3.event.sourceEvent&&d3.event.sourceEvent.preventDefault())},inputHandler:function(){var e,t,n=this.$el.val(),a=this.$el.get(0).selectionStart;t=(e=this.rangeConversion.spanValueForPartialString(n,a,this.allowCompletion)).selection,this.value=e.value,this.allowCompletion&&(this.$el.val(e.string),this.$el.get(0).setSelectionRange(t.location,t.location+t.length)),this.recordedInputValue=this.$el.val(),this.recordedChangeCallback=this.changeCallback,this.recordedManagerCallback=this.managerCallback,this.allowCompletion=!0,this.hasChanged=!0,this.continuousChangeCallback&&this.continuousChangeCallback()},blurHandler:function(){"date"===this.rangeConversion.type?(this.recordedChangeCallback&&this.recordedInputValue&&this.recordedChangeCallback(this.recordedInputValue),this.recordedManagerCallback&&this.recordedInputValue&&this.recordedManagerCallback(this.recordedInputValue)):(this.recordedChangeCallback&&!isNaN(this.recordedInputValue)&&this.recordedChangeCallback(this.recordedInputValue),this.recordedManagerCallback&&!isNaN(this.recordedInputValue)&&this.recordedManagerCallback(this.recordedInputValue),this.$el.val().length||this.$el.val("0")),this.recordedInputValue=null,this.recordedChangeCallback=null,this.recordedManagerCallback=null},commit:function(){this.recordedInputValue&&this.recordedChangeCallback&&this.blurHandler()}});module.exports=ATDurationPicker;

},{"../../model/ATTimeSpan":39,"../../model/ATTimeUnit":40,"backbone":220,"d3":320}],65:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("../../utils/ATUtilities"),templateHtml=require("./templates/editCalendarTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),editEraHtml=require("./templates/editEraPageTemplate.html"),editMonthHtml=require("./templates/editMonthPageTemplate.html"),editWeekdayHtml=require("./templates/editWeekdaysPageTemplate.html"),moveWithinArray=function(e,t,i){e.splice(i,0,e.splice(t,1)[0])},ATEditCalendarView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).classed("wide-modal",!0).attr("tabindex",-1).attr("role","dialog"),this.optionsTemplate=_.template(optionsHtml),this.selectedItem=null,this.displayGroups=[],this.displayGroups.push({type:"Eras",icon:"fa-calendar-o",items:[],typeName:"Era"}),this.displayGroups.push({type:"Months",icon:"fa-calendar-o",items:[],typeName:"Month"}),this.displayGroups.push({type:"Weekdays",icon:"fa-calendar-o",items:[],typeName:"Weekday"}),this.d3MasterList=this.d3El.select(".masterViewList"),this.$detailView=$("#editCalendarDetailView"),$("#editCalendarRemoveButton").on("click",this.removeSelectedItem.bind(this)),$("#editCalendarMoveUpButton").on("click",this.moveSelectedItemUp.bind(this)),$("#editCalendarMoveDownButton").on("click",this.moveSelectedItemDown.bind(this)),$("#editCalendarForm").on("submit",this.okClickHandler.bind(this)),$("#editCalendarCancel").on("click",this.cancelClickHandler.bind(this)),this.grabInitialCalendar()},grabInitialCalendar:function(){this.localTimelineCalendar=JSON.parse(JSON.stringify(this.model)),this.renderMasterList()},setCompletionCallback:function(e){this.completionCallback=e},renderMasterList:function(){var e=this,t=this.localTimelineCalendar.eras,i=this.localTimelineCalendar.months,a=this.localTimelineCalendar.weekdays,n=this.selectedItem;n&&(_.each(t,function(e){e.name==n.name&&(n=e)}),_.each(i,function(e){e.name==n.name&&(n=e)}),_.each(a,function(e){e.name==n.name&&(n=e)}));var s,r,l,d,h;this.displayGroups[0].items=t,this.displayGroups[1].items=i,this.displayGroups[2].items=a,(d=(s=this.d3MasterList.selectAll(".group").data(this.displayGroups,function(e){return e.type})).select("ul").selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==n})).select("span").html(function(e){return e.name}),d.select("i").style("color",function(e){return e.color}),(h=d.enter().append("li").classed("selected",function(e){return e==n}).on("click",function(t){return e.clickOnListItem(d3.select(this),t)})).append("i").attr("class",function(t,i,a){return"fa "+e.displayGroups[a].icon}).style("color",function(e){return e.color}),h.append("span").html(function(e){return e.name}),d.exit().remove(),(l=(r=s.enter().append("div").classed("group",!0)).append("div").classed("groupHeading",!0).on("click",function(t){e.clickOnGroupHeading(d3.select(this.parentNode),t)})).append("span").html(function(e){return e.type}),l.append("i").classed("fa fa-plus-circle",!0).on("click",this.addListItem.bind(this)),(h=(d=r.append("ul").style("max-height","0px").selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e==n})).enter().append("li").classed("selected",function(e){return e==n}).on("click",function(t){return e.clickOnListItem(d3.select(this),t)})).append("i").attr("class",function(t,i,a){return"fa "+e.displayGroups[a].icon}).style("color",function(e){return e.color}),h.append("span").html(function(e){return e.name}),s.exit().remove(),this.selectedItem=n,this.updateDetailFields(),this.animateExpansion()},clickOnGroupHeading:function(e,t){this.expandedGroupName==t.type?(this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null):(this.expandedGroup=t,this.expandedGroupName=t.type,this.selectedItem=t.items.length?t.items[0]:null),this.expandedGroupName?this.d3El.select(".masterViewControls").style("display",null):this.d3El.select(".masterViewControls").style("display","none"),this.renderMasterList()},updateDetailFields:function(){"Eras"==this.expandedGroupName?this.updateEraDetailFields():"Months"==this.expandedGroupName?this.updateMonthDetailFields():"Weekdays"==this.expandedGroupName?this.updateWeekdayDetailFields():this.removeDetailFields()},removeDetailFields:function(){this.$detailView.html("")},updateEraDetailFields:function(){this.$detailView.html(editEraHtml),this.$nameInput=$("#editEraName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$shortNameInput=$("#editEraShortName"),this.$shortNameInput.on("change",this.shortNameChanged.bind(this)),this.$editEraDuration=$("#editEraDuration"),this.$editEraDuration.on("change",this.editEraDurationChanged.bind(this)),this.$editEraBackwards=$("#editEraBackwards"),this.$editEraBackwards.on("change",this.editEraBackwardsChanged.bind(this)),this.$editEraLeapYear=$("#editEraLeapYear"),this.$editEraLeapYear.on("change",this.editEraLeapYearChanged.bind(this)),this.selectedItem?(this.selectedItem.name==this.localTimelineCalendar.eras[0].name||this.selectedItem.name==this.localTimelineCalendar.eras[this.localTimelineCalendar.eras.length-1].name?(this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editEraDuration.prop("disabled",!0),this.$editEraBackwards.prop("disabled",!0),this.$editEraLeapYear.prop("disabled",!1)):(this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editEraDuration.prop("disabled",!1),this.$editEraBackwards.prop("disabled",!1),this.$editEraLeapYear.prop("disabled",!1)),this.$nameInput.val(this.selectedItem.name),this.$shortNameInput.val(this.selectedItem.shortName),this.$editEraDuration.val(this.selectedItem.duration),this.$editEraBackwards.prop("checked",this.selectedItem.isBackwards),this.$editEraLeapYear.prop("checked",this.selectedItem.hasLeap)):(this.$nameInput.val(""),this.$shortNameInput.val(""),this.$editEraDuration.val(""),this.$editEraBackwards.prop("checked",!1),this.$editEraLeapYear.prop("checked",!1),this.$nameInput.prop("disabled",!0),this.$shortNameInput.prop("disabled",!0),this.$editEraDuration.prop("disabled",!0),this.$editEraBackwards.prop("disabled",!0),this.$editEraLeapYear.prop("disabled",!0))},updateMonthDetailFields:function(){this.$detailView.html(editMonthHtml),this.$nameInput=$("#editMonthName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$shortNameInput=$("#editMonthShortName"),this.$shortNameInput.on("change",this.shortNameChanged.bind(this)),this.$editMonthRegularYearDuration=$("#editMonthRegularYearDuration"),this.$editMonthRegularYearDuration.on("change",this.editMonthRegularYearDurationChanged.bind(this)),this.$editMonthLeapYearDuration=$("#editMonthLeapYearDuration"),this.$editMonthLeapYearDuration.on("change",this.editMonthLeapYearDurationChanged.bind(this)),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.$shortNameInput.val(this.selectedItem.shortName),this.$editMonthRegularYearDuration.val(this.selectedItem.normalDuration),this.$editMonthLeapYearDuration.val(this.selectedItem.leapDuration),this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editMonthRegularYearDuration.prop("disabled",!1),this.$editMonthLeapYearDuration.prop("disabled",!1)):(this.$nameInput.val(""),this.$shortNameInput.val(""),this.$editMonthRegularYearDuration.val(""),this.$editMonthLeapYearDuration.val(""),this.$nameInput.prop("disabled",!0),this.$shortNameInput.prop("disabled",!0),this.$editMonthRegularYearDuration.prop("disabled",!0),this.$editMonthLeapYearDuration.prop("disabled",!0))},updateWeekdayDetailFields:function(){if(this.$detailView.html(editWeekdayHtml),this.$nameInput=$("#editWeekdayName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$shortNameInput=$("#editWeekdayShortName"),this.$shortNameInput.on("change",this.shortNameChanged.bind(this)),this.$editHoursInDay=$("#editHoursInDay"),this.$editHoursInDay.on("change",this.editHoursInDayChanged.bind(this)),this.$firstDayFinalEra=$("#firstDayFinalEra"),this.$firstDayFinalEra.on("change",this.firstDayFinalEraChanged.bind(this)),this.selectedItem){this.$nameInput.val(this.selectedItem.name),this.$shortNameInput.val(this.selectedItem.shortName),this.$editHoursInDay.val(this.localTimelineCalendar.hoursInDay);var e=this.localTimelineCalendar.weekdayIndexAtZero;e>=0&&(this.localTimelineCalendar.weekdays[e].name==this.selectedItem.name?this.$firstDayFinalEra.prop("checked",!0):this.$firstDayFinalEra.prop("checked",!1)),this.$nameInput.prop("disabled",!1),this.$shortNameInput.prop("disabled",!1),this.$editHoursInDay.prop("disabled",!1),this.$firstDayFinalEra.prop("disabled",!1)}else this.$nameInput.val(""),this.$shortNameInput.val(""),this.$editHoursInDay.val(""),this.$firstDayFinalEra.prop("checked",!1),this.$nameInput.prop("disabled",!0),this.$shortNameInput.prop("disabled",!0),this.$editHoursInDay.prop("disabled",!0),this.$firstDayFinalEra.prop("disabled",!0)},clickOnListItem:function(e,t){this.d3MasterList.selectAll("li").classed("selected",!1),e.classed("selected",!0),this.selectedItem=t,this.updateDetailFields()},addListItem:function(e){for(var t=this.expandedGroup.typeName,i=0;this.findItemWithName(t);)i++,t=String(this.expandedGroup.typeName)+i;if("Eras"==this.expandedGroupName){this.localTimelineCalendar.eras.push({name:t,shortName:t,duration:1,isBackwards:!1,hasLeap:!1});var a=this.localTimelineCalendar.eras;moveWithinArray(a,this.localTimelineCalendar.eras.length-1,this.localTimelineCalendar.eras.length-2),this.selectedItem=this.localTimelineCalendar.eras[this.localTimelineCalendar.eras.length-2]}else"Months"==this.expandedGroupName?(this.localTimelineCalendar.months.push({name:t,shortName:t,normalDuration:31,leapDuration:31}),this.selectedItem=this.localTimelineCalendar.months[this.localTimelineCalendar.months.length-1]):"Weekdays"==this.expandedGroupName&&(this.localTimelineCalendar.weekdays.push({name:t,shortName:t}),this.selectedItem=this.localTimelineCalendar.weekdays[this.localTimelineCalendar.weekdays.length-1]);return this.renderMasterList(),d3.event.stopPropagation(),!1},removeSelectedItem:function(){var e,t=-1;"Eras"==this.expandedGroupName?e=this.localTimelineCalendar.eras:"Months"==this.expandedGroupName?e=this.localTimelineCalendar.months:"Weekdays"==this.expandedGroupName&&(e=this.localTimelineCalendar.weekdays),1!=e.length&&-1!=(t=_.indexOf(e,this.selectedItem))&&("Eras"!=this.expandedGroupName||0!=t&&t!=e.length-1)&&("Weekdays"==this.expandedGroupName&&(t<this.localTimelineCalendar.weekdayIndexAtZero?this.localTimelineCalendar.weekdayIndexAtZero-=1:t==this.localTimelineCalendar.weekdayIndexAtZero&&t==this.localTimelineCalendar.weekdays.length-1&&(this.localTimelineCalendar.weekdayIndexAtZero-=1)),e=_.without(e,this.selectedItem),"Eras"==this.expandedGroupName?this.localTimelineCalendar.eras=e:"Months"==this.expandedGroupName?this.localTimelineCalendar.months=e:"Weekdays"==this.expandedGroupName&&(this.localTimelineCalendar.weekdays=e),0==e.length?this.selectedItem=null:t>e.length?this.selectedItem=e[e.length-1]:this.selectedItem=e[t],this.renderMasterList())},moveSelectedItemUp:function(){var e,t=0;"Eras"==this.expandedGroupName?e=this.localTimelineCalendar.eras:"Months"==this.expandedGroupName?e=this.localTimelineCalendar.months:"Weekdays"==this.expandedGroupName&&(e=this.localTimelineCalendar.weekdays),_.each(e,function(e){e.index=t,t++}),"Eras"==this.expandedGroupName?this.selectedItem.index>1&&this.selectedItem.index<t-1&&moveWithinArray(e,this.selectedItem.index,this.selectedItem.index-1):this.selectedItem.index>0&&("Weekdays"==this.expandedGroupName&&(this.selectedItem.index==this.localTimelineCalendar.weekdayIndexAtZero?this.localTimelineCalendar.weekdayIndexAtZero--:this.selectedItem.index==this.localTimelineCalendar.weekdayIndexAtZero+1&&this.localTimelineCalendar.weekdayIndexAtZero++),moveWithinArray(e,this.selectedItem.index,this.selectedItem.index-1)),this.renderMasterList()},moveSelectedItemDown:function(){var e,t=0;"Eras"==this.expandedGroupName?e=this.localTimelineCalendar.eras:"Months"==this.expandedGroupName?e=this.localTimelineCalendar.months:"Weekdays"==this.expandedGroupName&&(e=this.localTimelineCalendar.weekdays),_.each(e,function(e){e.index=t,t++}),"Eras"==this.expandedGroupName?this.selectedItem.index>0&&this.selectedItem.index<t-2&&moveWithinArray(e,this.selectedItem.index,this.selectedItem.index+1):this.selectedItem.index<t-1&&("Weekdays"==this.expandedGroupName&&(this.selectedItem.index==this.localTimelineCalendar.weekdayIndexAtZero?this.localTimelineCalendar.weekdayIndexAtZero++:this.selectedItem.index==this.localTimelineCalendar.weekdayIndexAtZero-1&&this.localTimelineCalendar.weekdayIndexAtZero--),moveWithinArray(e,this.selectedItem.index,this.selectedItem.index+1)),this.renderMasterList()},animateExpansion:function(){var e=this;this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedGroupName==t.type}).select("ul").transition().duration(250).style("max-height",function(t){var i=0;return e.expandedGroupName!=t.type?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedItem==t})},okClickHandler:function(e){return this.completionCallback&&this.completionCallback(this.localTimelineCalendar),window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},cancelClickHandler:function(e){return window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},nameChanged:function(){var e=ATUtilities.regexStrippedString(this.$nameInput.val());if(e=e.trim(),this.selectedItem.name!=e){null==this.findItemWithName(e)?(this.selectedItem.name=e,this.$nameInput.val(e),this.renderMasterList()):this.$nameInput.val(this.selectedItem.name)}},shortNameChanged:function(){var e=ATUtilities.regexStrippedString(this.$shortNameInput.val());if(e=e.trim(),this.selectedItem.shortName!=e){null==this.findItemWithShortName(e)?(this.selectedItem.shortName=e,this.$shortNameInput.val(e),this.renderMasterList()):this.$shortNameInput.val(this.selectedItem.shortName)}},editEraDurationChanged:function(){this.selectedItem.duration=parseInt(this.$editEraDuration.val()),(this.selectedItem.duration<=0||1==isNaN(this.selectedItem.duration))&&(this.selectedItem.duration=1),this.renderMasterList()},editEraBackwardsChanged:function(){this.selectedItem.isBackwards=this.$editEraBackwards.prop("checked"),this.renderMasterList()},editEraLeapYearChanged:function(){this.selectedItem.hasLeap=this.$editEraLeapYear.prop("checked"),this.renderMasterList()},editMonthRegularYearDurationChanged:function(){this.selectedItem.normalDuration=parseInt(this.$editMonthRegularYearDuration.val()),(this.selectedItem.normalDuration<0||1==isNaN(this.selectedItem.normalDuration))&&(this.selectedItem.normalDuration=1),this.renderMasterList()},editMonthLeapYearDurationChanged:function(){this.selectedItem.leapDuration=parseInt(this.$editMonthLeapYearDuration.val()),(this.selectedItem.leapDuration<0||1==isNaN(this.selectedItem.leapDuration))&&(this.selectedItem.leapDuration=1),this.renderMasterList()},editHoursInDayChanged:function(){this.localTimelineCalendar.hoursInDay=parseInt(this.$editHoursInDay.val()),(this.localTimelineCalendar.hoursInDay<=0||1==isNaN(this.localTimelineCalendar.hoursInDay))&&(this.localTimelineCalendar.hoursInDay=1),this.renderMasterList()},firstDayFinalEraChanged:function(){var e=this.localTimelineCalendar.weekdays;this.selectedItem.name;if(1==this.$firstDayFinalEra.prop("checked")){var t=_.indexOf(e,this.selectedItem);this.localTimelineCalendar.weekdayIndexAtZero=t,this.renderMasterList()}},findItemWithName:function(e){var t=null,i=this.localTimelineCalendar,a=i.eras,n=i.months,s=i.weekdays;if(!e||0===e.length)return"The string entered is empty.";if(t=_.find(a,function(t){return t.name==e}))return t;if(t=_.find(n,function(t){return t.name==e}))return t;if(t=_.find(s,function(t){return t.name==e}))return t;if(new RegExp(/[\<\>\{\}\[\]]/).test(e))return"Invalid character detected";return new RegExp(/\b\d+\b/).test(e)?"Names cannot have isolated numbers":null},findItemWithShortName:function(e){var t=null,i=this.localTimelineCalendar,a=i.eras,n=i.months,s=i.weekdays;if(!e||0===e.length)return"The string entered is empty.";if(t=_.find(a,function(t){return t.shortName==e}))return t;if(t=_.find(n,function(t){return t.shortName==e}))return t;if(t=_.find(s,function(t){return t.shortName==e}))return t;if(new RegExp(/[\<\>\{\}\[\]]/).test(e))return"Invalid character detected";return new RegExp(/\b\d+\b/).test(e)?"Names cannot have isolated numbers":null}});module.exports=ATEditCalendarView;

},{"../../utils/ATUtilities":51,"./templates/editCalendarTemplate.html":124,"./templates/editEraPageTemplate.html":126,"./templates/editMonthPageTemplate.html":127,"./templates/editWeekdaysPageTemplate.html":134,"./templates/optionsTemplate.html":164,"backbone":220,"d3":320,"jquery":331,"lodash":333}],66:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/editPropertyOptionListTemplate.html"),bootstrap=require("bootstrap"),ATEditPropertyOptionListView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.d3El=d3.select("#"+this.elementName),this.useExternalLinkTemplate=!1,this.render([])},render:function(e){var t=this;this.d3El.html(this.elTemplate({items:e})),this.d3El.select(".addButton").attr("id",this.elementName+"-add").on("click",function(){t.addClick()}),_.each(e,function(e){var a=t.elementName+"-item"+e.id;t.d3El.select(".remove-"+e.id).attr("id",a+"-remove").on("click",function(){t.removeClick(e.id)}),t.d3El.select(".edit-name-"+e.id).attr("id",a+"-edit-name").on("change",function(){t.nameChanged(e.id,$("#"+a+"-edit-name").val())}).on("input",function(){t.nameInput(e.id,$("#"+a+"-edit-name").val())})})},setDisabled:function(e){this.disabled=e,this.d3El.classed("disabled",e)},setNameIsInvalid:function(e,t){var a="#"+this.elementName+"-item"+e+"-edit-name";$(a)[0].setCustomValidity(t?"Error":"")},setAddCallback:function(e){this.addCallback=e},setRemoveCallback:function(e){this.removeCallback=e},setNameChangeCallback:function(e){this.nameChangeCallback=e},setNameInputCallback:function(e){this.nameInputCallback=e},addClick:function(){this.addCallback&&this.addCallback()},removeClick:function(e){this.removeCallback&&this.removeCallback(e)},nameInput:function(e,t){this.nameInputCallback&&this.nameInputCallback(e,t)},nameChanged:function(e,t){this.nameChangeCallback&&this.nameChangeCallback(e,t)}});module.exports=ATEditPropertyOptionListView;

},{"./templates/editPropertyOptionListTemplate.html":128,"backbone":220,"bootstrap":222,"d3":320,"jquery":331,"lodash":333}],67:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATIconPickerControl=require("../ios/ATIconPickerControl"),ATPopover=require("../ios/ATPopover"),templateHtml=require("./templates/editRoleListTemplate.html"),ATEditRoleListView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.iconPickerControl=new ATIconPickerControl,this.popover=new ATPopover,this.d3El=d3.select("#"+this.elementName),this.iconOptions=this._roleIconList(),this.useExternalLinkTemplate=!1,this.render([])},render:function(e){var t=this;this.d3El.html(this.elTemplate({items:e})),this.d3El.select(".addButton").attr("id",this.elementName+"-add").on("click",function(){t.addClick()}),_.each(e,function(e){var i,n=t.elementName+"-item"+e.id,l=_.find(t.iconOptions,function(t){return t.id===e.icon});t.d3El.select(".remove-"+e.id).attr("id",n+"-remove").on("click",function(){t.removeClick(e.id)}),t.d3El.select(".edit-name-"+e.id).attr("id",n+"-edit-name").on("change",function(){t.nameChanged(e.id,$("#"+n+"-edit-name").val())}).on("input",function(){t.nameInput(e.id,$("#"+n+"-edit-name").val())}),t.d3El.select(".edit-multiple-"+e.id).attr("id",n+"-edit-multiple").on("change",function(){t.multipleChanged(e.id,$("#"+n+"-edit-multiple").prop("checked"))}),t.d3El.select(".edit-role-icon-"+e.id).attr("id",n+"-edit-role-icon"),i=$("#"+n+"-edit-role-icon"),d3.select("#"+n+"-edit-role-icon svg.selectedIcon").select("use").attr("xlink:href",l?l.src:"#none"),i.on("click",function(i){t._iconButtonClick(e,i)})}),t.d3El.classed("oneRoleOnly",e.length<=1)},_iconNameToPath:function(e){return e?"#"+e:null},_roleIconList:function(){var e=this,t=[];return _.each([{svgName:"circle",cssClass:"circle"},{svgName:"square",cssClass:"square"},{svgName:"circle-f",cssClass:"circle filled"},{svgName:"square-f",cssClass:"square filled"},{svgName:"circle-text",cssClass:"circle text"},{svgName:"square-text",cssClass:"square text"},{svgName:"circle-text-f",cssClass:"circle filled text"},{svgName:"square-text-f",cssClass:"square filled text"}],function(i){t.push({id:i.cssClass,src:e._iconNameToPath(i.svgName),color:"mono",selected:!1})}),t},_iconButtonClick:function(e,t){var i=this,n=e.icon,l=$(t.target);return t.stopPropagation(),t.preventDefault(),_.each(this.iconOptions,function(e){e.selected=e.id===n}),this.iconPickerControl.setIconOptions(this.iconOptions),this.popover.reset(),this.popover.customize({heading:null,placement:"bottom",width:"17.6rem"}),this.popover.setView(this.iconPickerControl),this.listenToOnce(this.iconPickerControl,"icon:select",function(t){i.iconChanged(e.id,t)}),this.listenToOnce(this.popover,"popover:hidden",function(){i.stopListening(i.iconPickerControl)}),this.popover.show(l),!1},setDisabled:function(e){this.disabled=e,this.d3El.classed("disabled",e)},setNameIsInvalid:function(e,t){var i="#"+this.elementName+"-item"+e+"-edit-name";$(i)[0].setCustomValidity(t?"Error":"")},setAddCallback:function(e){this.addCallback=e},setRemoveCallback:function(e){this.removeCallback=e},setNameChangeCallback:function(e){this.nameChangeCallback=e},setIconChangeCallback:function(e){this.iconChangeCallback=e},setNameInputCallback:function(e){this.nameInputCallback=e},setMultipleChangeCallback:function(e){this.multipleChangeCallback=e},addClick:function(){this.addCallback&&this.addCallback()},removeClick:function(e){this.removeCallback&&this.removeCallback(e)},nameInput:function(e,t){this.nameInputCallback&&this.nameInputCallback(e,t)},nameChanged:function(e,t){this.nameChangeCallback&&this.nameChangeCallback(e,t)},multipleChanged:function(e,t){this.multipleChangeCallback&&this.multipleChangeCallback(e,t)},iconChanged:function(e,t){this.popover.hide(),this.iconChangeCallback&&this.iconChangeCallback(e,t)}});module.exports=ATEditRoleListView;

},{"../ios/ATIconPickerControl":184,"../ios/ATPopover":189,"./templates/editRoleListTemplate.html":131,"backbone":220,"d3":320,"jquery":331,"lodash":333}],68:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATCalendar=require("../../model/ATCalendar"),ATCalendarType=require("../../model/ATCalendarType"),ATRangeConversion=require("../../controller/ATRangeConversion"),ATTimeSpan=require("../../model/ATTimeSpan"),ATTimeUnit=require("../../model/ATTimeUnit"),ATDropdown=require("./ATDropdown"),ATEditRoleListView=require("./ATEditRoleListView"),ATEditPropertyOptionListView=require("./ATEditPropertyOptionListView"),ATIconPickerControl=require("../ios/ATIconPickerControl"),ATPopover=require("../ios/ATPopover"),templateHtml=require("./templates/editTemplateTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),editRangePropertyHtml=require("./templates/editRangePropertyPageTemplate.html"),editPropertyHtml=require("./templates/editPropertyPageTemplate.html"),editTypeHtml=require("./templates/editTypePageTemplate.html"),editColorHtml=require("./templates/editColorPageTemplate.html");const uuidV1=require("uuid/v1");var ATEditTemplateView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.allowEditCalendar=!0,this.BadWords=["Event","Entity","Tag","Color","Parent","Link","Any","None","All","Timeline"],this.rangeTypeConversion={date:"Date",numeric:"Numeric",hierarchy:"Hierarchy"},this.swatchList=[{name:"red",color:String("#d0011b").toLowerCase()},{name:"peach",color:String("#ff9b7b").toLowerCase()},{name:"orange",color:String("#e79102").toLowerCase()},{name:"yellow",color:String("#f5e309").toLowerCase()},{name:"mint",color:String("#a1eda3").toLowerCase()},{name:"apple",color:String("#73c619").toLowerCase()},{name:"lightTeal",color:String("#2fc286").toLowerCase()},{name:"darkTeal",color:String("#0a7b75").toLowerCase()},{name:"lightBlue",color:String("#89e4ff").toLowerCase()},{name:"denim",color:String("#6592c7").toLowerCase()},{name:"midBlue",color:String("#00a2ef").toLowerCase()},{name:"darkBlue",color:String("#004fef").toLowerCase()},{name:"darkPurple",color:String("#6434ff").toLowerCase()},{name:"lightPurple",color:String("#b59dff").toLowerCase()},{name:"pastelPink",color:String("#f89dff").toLowerCase()},{name:"fuschia",color:String("#bc28c8").toLowerCase()},{name:"lightPink",color:String("#ff629e").toLowerCase()},{name:"darkPink",color:String("#fe3d5a").toLowerCase()},{name:"deepPurple500",color:String("#673AB7").toLowerCase()},{name:"lightGreen500",color:String("#8BC34A").toLowerCase()},{name:"lime500",color:String("#CDDC39").toLowerCase()},{name:"brown500",color:String("#795548").toLowerCase()},{name:"grey",color:String("#8c8c8c").toLowerCase()},{name:"mono",color:"white"},{name:"red200",color:String("#EF9A9A").toLowerCase()},{name:"red300",color:String("#E57373").toLowerCase()},{name:"red500",color:String("#F44336").toLowerCase()},{name:"red700",color:String("#D32F2F").toLowerCase()},{name:"red900",color:String("#B71C1C").toLowerCase()},{name:"red200A",color:String("#FF5252").toLowerCase()},{name:"red400A",color:String("#FF1744").toLowerCase()},{name:"red700A",color:String("#D50000").toLowerCase()},{name:"pink200",color:String("#F48FB1").toLowerCase()},{name:"pink300",color:String("#F06292").toLowerCase()},{name:"pink500",color:String("#E91E63").toLowerCase()},{name:"pink700",color:String("#C2185B").toLowerCase()},{name:"pink900",color:String("#880E4F").toLowerCase()},{name:"pink200A",color:String("#FF4081").toLowerCase()},{name:"pink400A",color:String("#F50057").toLowerCase()},{name:"pink700A",color:String("#C51162").toLowerCase()},{name:"purple200",color:String("#CE93D8").toLowerCase()},{name:"purple300",color:String("#BA68C8").toLowerCase()},{name:"purple500",color:String("#9C27B0").toLowerCase()},{name:"purple700",color:String("#7B1FA2").toLowerCase()},{name:"purple900",color:String("#4A148C").toLowerCase()},{name:"purple200A",color:String("#E040FB").toLowerCase()},{name:"purple400A",color:String("#D500F9").toLowerCase()},{name:"purple700A",color:String("#AA00FF").toLowerCase()},{name:"indigo200",color:String("#9FA8DA").toLowerCase()},{name:"indigo300",color:String("#7986CB").toLowerCase()},{name:"indigo500",color:String("#3F51B5").toLowerCase()},{name:"indigo700",color:String("#303F9F").toLowerCase()},{name:"indigo900",color:String("#1A237E").toLowerCase()},{name:"indigo200A",color:String("#536DFE").toLowerCase()},{name:"indigo400A",color:String("#3D5AFE").toLowerCase()},{name:"indigo700A",color:String("#304FFE").toLowerCase()},{name:"blue200",color:String("#90CAF9").toLowerCase()},{name:"blue300",color:String("#64B5F6").toLowerCase()},{name:"blue500",color:String("#2196F3").toLowerCase()},{name:"blue700",color:String("#1976D2").toLowerCase()},{name:"blue900",color:String("#0D47A1").toLowerCase()},{name:"blue200A",color:String("#448AFF").toLowerCase()},{name:"blue400A",color:String("#2979FF").toLowerCase()},{name:"blue700A",color:String("#2962FF").toLowerCase()},{name:"teal200",color:String("#80CBC4").toLowerCase()},{name:"teal300",color:String("#4DB6AC").toLowerCase()},{name:"teal500",color:String("#009688").toLowerCase()},{name:"teal700",color:String("#00796B").toLowerCase()},{name:"teal900",color:String("#004D40").toLowerCase()},{name:"teal200A",color:String("#64FFDA").toLowerCase()},{name:"teal400A",color:String("#1DE9B6").toLowerCase()},{name:"teal700A",color:String("#00BFA5").toLowerCase()},{name:"green200",color:String("#A5D6A7").toLowerCase()},{name:"green300",color:String("#81C784").toLowerCase()},{name:"green500",color:String("#4CAF50").toLowerCase()},{name:"green700",color:String("#388E3C").toLowerCase()},{name:"green900",color:String("#1B5E20").toLowerCase()},{name:"green200A",color:String("#69F0AE").toLowerCase()},{name:"green400A",color:String("#00E676").toLowerCase()},{name:"green700A",color:String("#00C853").toLowerCase()},{name:"yellow200",color:String("#FFF59D").toLowerCase()},{name:"yellow300",color:String("#FFF176").toLowerCase()},{name:"yellow500",color:String("#FFEB3B").toLowerCase()},{name:"yellow700",color:String("#FBC02D").toLowerCase()},{name:"yellow900",color:String("#F57F17").toLowerCase()},{name:"yellow200A",color:String("#FFFF01").toLowerCase()},{name:"yellow400A",color:String("#FFEA00").toLowerCase()},{name:"yellow700A",color:String("#FFD601").toLowerCase()},{name:"deepOrange200",color:String("#FFAB91").toLowerCase()},{name:"deepOrange300",color:String("#FF8A65").toLowerCase()},{name:"deepOrange500",color:String("#FF5722").toLowerCase()},{name:"deepOrange700",color:String("#E64A19").toLowerCase()},{name:"deepOrange900",color:String("#BF360C").toLowerCase()},{name:"deepOrange200A",color:String("#FF6E40").toLowerCase()},{name:"deepOrange400A",color:String("#FF3D00").toLowerCase()},{name:"deepOrange700A",color:String("#DD2C00").toLowerCase()},{name:"grey300",color:String("#E0E0E0").toLowerCase()},{name:"grey500",color:String("#9E9E9E").toLowerCase()},{name:"grey700",color:String("#616161").toLowerCase()},{name:"grey900",color:String("#212121").toLowerCase()},{name:"blueGrey300",color:String("#90A4AE").toLowerCase()},{name:"blueGrey500",color:String("#607D8B").toLowerCase()},{name:"blueGrey700",color:String("#455A64").toLowerCase()},{name:"blueGrey900",color:String("#263238").toLowerCase()},{name:"pureMaroon",color:String("#800000").toLowerCase()},{name:"pureCrimson",color:String("#db133b").toLowerCase()},{name:"pureRed",color:String("#ff0000").toLowerCase()},{name:"pureOrange",color:String("#e16e31").toLowerCase()},{name:"pureOlive",color:String("#808000").toLowerCase()},{name:"pureGreen",color:String("#008000").toLowerCase()},{name:"pureTeal",color:String("#008080").toLowerCase()},{name:"pureLightGreen",color:String("#2ec994").toLowerCase()},{name:"pureLime",color:String("#00ff00").toLowerCase()},{name:"pureNavy",color:String("#000080").toLowerCase()},{name:"pureBlue",color:String("#0000ff").toLowerCase()},{name:"pureCyan",color:String("#00ffff").toLowerCase()},{name:"pureGold",color:String("#ffd600").toLowerCase()},{name:"pureYellow",color:String("#ffff00").toLowerCase()},{name:"pureLightYellow",color:String("#fffacd").toLowerCase()},{name:"purePurple",color:String("#800080").toLowerCase()},{name:"pureLilac",color:String("#8373c0").toLowerCase()},{name:"pureMagenta",color:String("#ff00ff").toLowerCase()},{name:"pureLavendar",color:String("#e6e6f9").toLowerCase()},{name:"purePink",color:String("#ffbfca").toLowerCase()},{name:"pureBlack",color:String("#000000").toLowerCase()},{name:"pureGray",color:String("#808080").toLowerCase()},{name:"pureSilver",color:String("#bfbfbf").toLowerCase()},{name:"pureWhite",color:String("#ffffff").toLowerCase()}],this.spectrumPalette=_.chunk(_.map(this.swatchList,"color"),8),this.optionsTemplate=_.template(optionsHtml),this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null,this.requireSelectAndFocus=!1,this.selectAndFocusName=null,this.displayGroups=[],this.displayGroups.push({type:"Range",icon:"flag",items:[],typeName:"Range"}),this.displayGroups.push({type:"Properties",icon:"flag",items:[],typeName:"Property"}),this.displayGroups.push({type:"Entity Types",icon:"user",items:[],typeName:"Entity Type"}),this.displayGroups.push({type:"Colors",icon:"squareSmall",items:[],typeName:"Color"}),this.iconPickerControl=new ATIconPickerControl,this.popover=new ATPopover,this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).classed("wide-modal",!0).attr("tabindex",-1).attr("role","dialog"),this.d3MasterList=this.d3El.select(".masterViewList"),this.$detailView=$("#editTemplateDetailView"),$("#editTemplateRemoveButton").on("click",this.removeSelectedItem.bind(this)),$("#editTemplateMoveUpButton").on("click",this.moveSelectedItemUp.bind(this)),$("#editTemplateMoveDownButton").on("click",this.moveSelectedItemDown.bind(this)),$("#editTemplateForm").on("submit",this.okClickHandler.bind(this)),$("#editTemplateCancel").on("click",this.cancelClickHandler.bind(this)),$("#editTemplateSave").on("click",this.showEnterNameHandler.bind(this)),this.grabInitialTemplate(),this.updateDetailFields()},grabInitialTemplate:function(){this.localTimelineTemplate=JSON.parse(JSON.stringify(this.model.get("template"))),this.renderMasterList(),this.displayGroups.length&&(this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null,this.clickOnGroupHeading(this.displayGroups[0]))},setAllowEditCalendar:function(e){this.allowEditCalendar=e,this.$editCalendar.attr("disabled",!this.allowEditCalendar)},renderMasterList:function(){var e,t,i,n,o,r=this,s=this.localTimelineTemplate,a=s.rangeProperties,l=s.properties,d=s.types,c=s.colors,p=this.selectedItem;p&&(_.each(a,function(e){e.name===p.name?p=e:r.requireSelectAndFocus&&e.name===r.selectAndFocusName&&(p=e)}),_.each(l,function(e){e.name===p.name?p=e:r.requireSelectAndFocus&&e.name===r.selectAndFocusName&&(p=e)}),_.each(d,function(e){e.name===p.name?p=e:r.requireSelectAndFocus&&e.name===r.selectAndFocusName&&(p=e)}),_.each(c,function(e){e.name===p.name?p=e:r.requireSelectAndFocus&&e.name===r.selectAndFocusName&&(p=e)})),_.each(a,function(e){e.icon||(e.icon=r.displayGroups[0].icon)}),_.each(l,function(e){e.icon||(e.icon=r.displayGroups[1].icon)}),_.each(d,function(e){e.icon||(e.icon=r.displayGroups[2].icon)}),_.each(c,function(e){e.icon||(e.icon=r.displayGroups[3].icon)}),this.displayGroups[0].items=a,this.displayGroups[1].items=l,this.displayGroups[2].items=d,this.displayGroups[3].items=c,(n=(e=this.d3MasterList.selectAll(".group").data(this.displayGroups,function(e){return e.type})).select("ul").selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e===p})).select("span").html(function(e){return e.name}),n.select("svg").attr("class",function(e){return"icon "+(e.color?e.color:"")}).select("use").attr("xlink:href",function(e){return"#"+e.icon}),(o=n.enter().append("li").classed("selected",function(e){return e===p}).on("click",function(e){return r.clickOnListItem(e)})).append("svg").attr("class",function(e){return"icon "+(e.color?e.color:"")}).append("use").attr("xlink:href",function(e){return"#"+e.icon}),o.append("span").html(function(e){return e.name}),n.exit().remove(),(i=(t=e.enter().append("div").classed("group",!0)).append("div").classed("groupHeading",!0).on("click",function(e){r.clickOnGroupHeading(e)})).append("span").html(function(e){return e.type}),i.append("i").classed("fa fa-plus-circle",!0).on("click",this.addListItem.bind(this)).style("display",function(e,t){return 0===t?"none":null}),(o=(n=t.append("ul").style("max-height","0px").selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e===p})).enter().append("li").classed("selected",function(e){return e===p}).on("click",function(e){return r.clickOnListItem(e)})).append("svg").attr("class",function(e){return"icon "+(e.color?e.color:"")}).append("use").attr("xlink:href",function(e){return"#"+e.icon}),o.append("span").html(function(e){return e.name}),e.exit().remove(),this.selectedItem=p,this.updateDetailFields(),this.animateExpansion()},updateDetailFields:function(){"Range"===this.expandedGroupName?this.updateRangePropertyDetailFields():"Properties"===this.expandedGroupName?this.updatePropertyDetailFields():"Entity Types"===this.expandedGroupName?this.updateTypeDetailFields():"Colors"===this.expandedGroupName?this.updateColorDetailFields():this.removeDetailFields()},removeDetailFields:function(){this.$detailView.html("")},updateRangePropertyDetailFields:function(){var e=this;this.$detailView.html(editRangePropertyHtml),this.$nameInput=$("#editRangePropertyName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.$typeDisplayDiv=$("#editRangePropertyType"),this.calendarTypeDropdown=new ATDropdown({el:"#editRangePropertyCalendarType"}),this.listenTo(this.calendarTypeDropdown,"change",this.calendarTypeChanged.bind(this)),this.dateMinZoomDropdown=new ATDropdown({el:"#editRangePropertyDateMinZoom"}),this.listenTo(this.dateMinZoomDropdown,"change",this.dateMinZoomChanged.bind(this)),this.dateMaxZoomDropdown=new ATDropdown({el:"#editRangePropertyDateMaxZoom"}),this.listenTo(this.dateMaxZoomDropdown,"change",this.dateMaxZoomChanged.bind(this)),this.$numericMinZoomInput=$("#editRangePropertyNumericMinZoom"),this.$numericMinZoomInput.on("change",this.numericMinZoomChanged.bind(this)),this.$numericMaxZoomInput=$("#editRangePropertyNumericMaxZoom"),this.$numericMaxZoomInput.on("change",this.numericMaxZoomChanged.bind(this)),this.$editCalendar=$("#editCalendarButton"),this.$editCalendar.attr("disabled",!this.allowEditCalendar),this.$editCalendar.on("click",this.showEditCalendarHandler.bind(this)),this.dateFormatDropdown=new ATDropdown({el:"#editRangePropertyDateFormat"}),this.listenTo(this.dateFormatDropdown,"change",this.dateFormatChanged.bind(this)),this.timeFormatDropdown=new ATDropdown({el:"#editRangePropertyTimeFormat"}),this.listenTo(this.timeFormatDropdown,"change",this.timeFormatChanged.bind(this)),this.$includeDayName=$("#editRangePropertyIncludeDayName"),this.$includeDayName.on("change",this.includeDayNameChanged.bind(this)),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.$nameInput.prop("disabled",!1),this.$typeDisplayDiv.text(this.rangeTypeConversion[this.selectedItem.type]),this.updateRangeOptionsDisplay()):(this.$nameInput.val(""),this.$nameInput.prop("disabled",!0),this.$typeDisplayDiv.text(""),d3.select("#editRangePropertyDateOptions").style("display","none"),d3.select("#editRangePropertyNumericOptions").style("display","none")),this.setNameFieldIsInvalid(!1)},updatePropertyDetailFields:function(){var e=this,t=[];this.$detailView.html(editPropertyHtml),this.$nameInput=$("#editPropertyName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.typeDropdown=new ATDropdown({el:"#editPropertyType"}),this.listenTo(this.typeDropdown,"change",this.propertyTypeChanged.bind(this)),this.$calcFromChildren=$("#editPropertyCalculate"),this.$calcFromChildren.on("change",this.calcFromChildrenChanged.bind(this)),this.$fadeUsingProperty=$("#editPropertyFadeCheckbox"),this.$fadeUsingProperty.on("change",this.fadeUsingPropertyChanged.bind(this)),this.calcModeDropdown=new ATDropdown({el:"#editPropertyCalcMode"}),this.listenTo(this.calcModeDropdown,"change",this.calculationModeChanged.bind(this)),this.$fadeUsingPropertyDiv=$("#editPropertyFadeDiv"),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.propertyOptionListView=new ATEditPropertyOptionListView({el:"#editPropertyOptions"}),this.propertyOptionListView.setAddCallback(this.addPropertyOptionClicked.bind(this)),this.propertyOptionListView.setNameInputCallback(this.editPropertyOptionNameInput.bind(this)),this.propertyOptionListView.setNameChangeCallback(this.editPropertyOptionNameChanged.bind(this)),this.propertyOptionListView.setRemoveCallback(this.removePropertyOptionClicked.bind(this)),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.typeDropdown.setValue(this.selectedItem.type),this.$nameInput.prop("disabled",!1),this.typeDropdown.setDisabled(!1),this.$calcFromChildren.prop("checked",this.selectedItem.calcFromChildren),"boolean"===this.selectedItem.type||"percentage"===this.selectedItem.type?(this.$fadeUsingProperty.prop("disabled",!1),this.$fadeUsingProperty.prop("checked",this.selectedItem.useForFadingEvents)):(this.$fadeUsingProperty.prop("checked",!1),this.$fadeUsingProperty.prop("disabled",!0)),"list"===this.selectedItem.type?(_.each(this.selectedItem.options,function(e){t.push({id:e.uuid,title:e.name})}),this.propertyOptionListView.render(t),this.propertyOptionListView.setDisabled(!1)):(this.propertyOptionListView.render([]),this.propertyOptionListView.setDisabled(!0))):(this.$nameInput.val(""),this.typeDropdown.setValue(null),this.$nameInput.prop("disabled",!0),this.typeDropdown.setDisabled(!0),this.$calcFromChildren.prop("checked",!1),this.$calcFromChildren.prop("disabled",!0),this.$fadeUsingProperty.prop("checked",!1),this.$fadeUsingProperty.prop("disabled",!0),this.propertyOptionListView.setDisabled(!0)),this.updatePropertyCalcModeOptions(),this.setNameFieldIsInvalid(!1)},updateTypeDetailFields:function(){var e=this,t=[];this.$detailView.html(editTypeHtml),this.$nameInput=$("#editTypeName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.$persistentInput=$("#editTypePersistent"),this.$persistentInput.on("change",this.typePersistenceChanged.bind(this)),this.$iconButton=$("#editTypeIcon"),this.d3IconButtonSvg=d3.select("#editTypeIcon svg.selectedIcon"),this.roleListView=new ATEditRoleListView({el:"#editRangeRoles"}),this.roleListView.setAddCallback(this.addRoleClicked.bind(this)),this.roleListView.setNameInputCallback(this.editRoleNameInput.bind(this)),this.roleListView.setNameChangeCallback(this.editRoleNameChanged.bind(this)),this.roleListView.setIconChangeCallback(this.editRoleIconChanged.bind(this)),this.roleListView.setMultipleChangeCallback(this.editRoleMultipleChanged.bind(this)),this.roleListView.setRemoveCallback(this.removeRoleClicked.bind(this)),this.requireSelectAndFocus&&(window.setTimeout(function(){e.$nameInput.focus(),e.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.selectedItem?(this.$nameInput.val(this.selectedItem.name),this.$persistentInput.prop("checked",!this.selectedItem.persistent),this.$nameInput.prop("disabled",!1),this.$persistentInput.prop("disabled",!1),this.d3IconButtonSvg.attr("class","selectedIcon icon "+(this.selectedItem.color?this.selectedItem.color:"")).select("use").attr("xlink:href","#"+this.selectedItem.icon),this.$iconButton.prop("disabled",!1),_.each(this.selectedItem.roles,function(e){t.push({id:e.roleId,title:e.name,multiplePerEvent:e.multiplePerEvent,icon:e.icon})}),this.roleListView.render(t),this.roleListView.setDisabled(!1)):(this.$nameInput.val(""),this.$persistentInput.prop("checked",!1),this.$nameInput.prop("disabled",!0),this.$persistentInput.prop("disabled",!0),this.roleListView.setDisabled(!0),this.d3IconButtonSvg.attr("class","selectedIcon icon transparent").select("use").attr("xlink:href","#empty"),this.$iconButton.prop("disabled",!0)),this.$iconButton.on("click",this._typeIconButtonClick.bind(this)),this.setNameFieldIsInvalid(!1)},_typeIconList:function(){var e=this,t=["iconRed","iconOrange","iconPurple","iconYellow","iconGreen"],i=[];return _.each(["star","person","map","house","bulb","book","folder","gavel","scales","case","organisation","mortar","cube","puzzle","flag","mail","pin","cursor"],function(n){_.each(t,function(t){var o=n+"_"+t;i.push({id:o,src:e._iconNameToPath(n),color:t,selected:!1})})}),i},_iconNameToPath:function(e){return e?"#"+e:null},_typeIconButtonClick:function(e){var t=this,i=this.selectedItem?this.selectedItem.icon+"_"+this.selectedItem.color:null,n=$(e.target);return e.stopPropagation(),e.preventDefault(),this.typeIconOptions=this._typeIconList(),_.each(this.typeIconOptions,function(e){e.selected=e.id===i}),this.iconPickerControl.setIconOptions(this.typeIconOptions),this.popover.reset(),this.popover.customize({heading:null,placement:"bottom",width:"21.6rem"}),this.popover.setView(this.iconPickerControl),this.listenToOnce(this.iconPickerControl,"icon:select",this._typeIconSelected.bind(this)),this.listenToOnce(this.popover,"popover:hidden",function(){t.stopListening(t.iconPickerControl)}),this.popover.show(n),!1},_typeIconSelected:function(e){var t=e.split("_");this.popover.hide(),this.selectedItem&&(this.selectedItem.icon=t[0],this.selectedItem.color=t[1]),this.renderMasterList()},updateColorDetailFields:function(){var e,t=this,i=this.$el.attr("id");this.$detailView.html(editColorHtml),this.$nameInput=$("#editColorName"),this.$nameInput.on("change",this.nameChanged.bind(this)),this.$nameInput.on("input",this.nameInput.bind(this)),this.$colorInput=$("#editColorColor"),this.$colorInput.on("change",this.colorColorChanged.bind(this)),this.requireSelectAndFocus&&(window.setTimeout(function(){t.$nameInput.focus(),t.$nameInput.select()},100),this.requireSelectAndFocus=!1),this.selectedItem?(e=_.find(this.swatchList,function(e){return e.name===t.selectedItem.color}),this.$nameInput.val(this.selectedItem.name),this.$colorInput.val(e.color),this.$nameInput.prop("disabled",!1),this.$colorInput.prop("disabled",!1),this.$colorInput.spectrum({color:e.color,showInput:!1,showInitial:!1,allowEmpty:!1,showPalette:!0,showPaletteOnly:!0,showButtons:!1,hideAfterPaletteSelect:!0,disabled:!1,preferredFormat:"hex",palette:this.spectrumPalette,appendTo:"#"+i,change:this.colorColorChanged.bind(this)})):(this.$nameInput.val(""),this.$colorInput.val(""),this.$nameInput.prop("disabled",!0),this.$colorInput.prop("disabled",!0),this.$colorInput.spectrum({color:"#fff"})),this.setNameFieldIsInvalid(!1)},clickOnGroupHeading:function(e){var t=this;this.expandedGroupName===e.type?(this.expandedGroup=null,this.expandedGroupName=null,this.selectedItem=null):(this.expandedGroup=e,this.expandedGroupName=e.type,this.selectedItem=e.items.length?e.items[0]:null),"Range"!==this.expandedGroupName&&this.expandedGroupName?this.d3El.select(".masterViewControls").style("display",null):this.d3El.select(".masterViewControls").style("display","none"),this.animateExpansion(),this.updateDetailFields(),window.setTimeout(function(){t.animateExpansion()},265)},animateExpansion:function(){var e=this;this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedGroupName===t.type}).select("ul").transition().duration(250).style("max-height",function(t){var i=0;return e.expandedGroupName!==t.type?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedItem===t})},clickOnListItem:function(e){var t=this;this.selectedItem=e,this.d3MasterList.selectAll("li").classed("selected",function(e){return t.selectedItem===e}),this.updateDetailFields()},addListItem:function(e){for(var t="New "+this.expandedGroup.typeName,i=0;this.findItemWithName(t);)i++,t="New "+this.expandedGroup.typeName+" "+i;return this.requireSelectAndFocus=!0,this.selectAndFocusName=t,"Range"===this.expandedGroupName||("Properties"===this.expandedGroupName?(this.localTimelineTemplate.properties.push({propertyId:uuidV1(),name:t,type:"text",sortOrder:this.localTimelineTemplate.properties.length-1,calcFromChildren:!1,calculationMode:"all",options:[]}),this.selectedItem=this.localTimelineTemplate.properties[this.localTimelineTemplate.properties.length-1]):"Entity Types"===this.expandedGroupName?(this.localTimelineTemplate.types.push({typeId:uuidV1(),name:t,icon:"star",color:"iconRed",persistent:!1,sortOrder:this.localTimelineTemplate.types.length-1}),this.selectedItem=this.localTimelineTemplate.types[this.localTimelineTemplate.types.length-1],this.selectedItem.roles=[{roleId:uuidV1(),name:t,icon:"circle",multiplePerEvent:!0,allowPercent:!1,sortOrder:0}]):"Colors"===this.expandedGroupName&&(this.localTimelineTemplate.colors.push({colorId:uuidV1(),name:t,color:"mono",sortOrder:this.localTimelineTemplate.colors.length-1,icon:"squareSmall"}),this.selectedItem=this.localTimelineTemplate.colors[this.localTimelineTemplate.colors.length-1])),this.renderMasterList(),d3.event.stopPropagation(),!1},findItemWithName:function(e){var t,i,n,o=null,r=this.localTimelineTemplate,s=r.rangeProperties,a=r.properties,l=r.types,d=r.colors,c=this.BadWords;if(!e||0===e.length)return"The string entered is empty.";if(o=_.find(c,function(t){return t===e}))return o;if(o=_.find(s,function(t){return t.name===e}))return o;if(o=_.find(a,function(t){return t.name===e}))return o;if(o=_.find(d,function(t){return t.name===e}))return o;if(o=_.find(l,function(t){return t.name===e}))return o;for(t=0,i=l.length;t<i;t++)if(n=l[t].roles,o=_.find(n,function(t){return t.name===e}))return o;return new RegExp(/[<>{}[\]]/).test(e)?"Invalid character detected":null},removeSelectedItem:function(){var e,t=-1;"Range"===this.expandedGroupName||("Properties"===this.expandedGroupName?e=this.localTimelineTemplate.properties:"Entity Types"===this.expandedGroupName?e=this.localTimelineTemplate.types:"Colors"===this.expandedGroupName&&(e=this.localTimelineTemplate.colors)),t=_.indexOf(e,this.selectedItem),e=_.without(e,this.selectedItem),"Range"===this.expandedGroupName||("Properties"===this.expandedGroupName?this.localTimelineTemplate.properties=e:"Entity Types"===this.expandedGroupName?this.localTimelineTemplate.types=e:"Colors"===this.expandedGroupName&&(this.localTimelineTemplate.colors=e)),0===e.length?this.selectedItem=null:t>e.length?this.selectedItem=e[e.length-1]:this.selectedItem=e[t],this.renderMasterList()},moveSelectedItemUp:function(){var e,t=0;"Range"===this.expandedGroupName||("Properties"===this.expandedGroupName?e=this.localTimelineTemplate.properties:"Entity Types"===this.expandedGroupName?e=this.localTimelineTemplate.types:"Colors"===this.expandedGroupName&&(e=this.localTimelineTemplate.colors)),this.selectedItem.sortOrder=this.selectedItem.sortOrder-1.5,e.sort(function(e,t){return e.sortOrder-t.sortOrder}),_.each(e,function(e){e.sortOrder=t++}),this.renderMasterList()},moveSelectedItemDown:function(){var e,t=0;"Range"===this.expandedGroupName||("Properties"===this.expandedGroupName?e=this.localTimelineTemplate.properties:"Entity Types"===this.expandedGroupName?e=this.localTimelineTemplate.types:"Colors"===this.expandedGroupName&&(e=this.localTimelineTemplate.colors)),this.selectedItem.sortOrder=this.selectedItem.sortOrder+1.5,e.sort(function(e,t){return e.sortOrder-t.sortOrder}),_.each(e,function(e){e.sortOrder=t++}),this.renderMasterList()},nameInput:function(){var e=this.$nameInput.val(),t=!1;this.selectedItem.name!==e&&(this.findItemWithName(e)?this.selectedItem.roles?_.find(this.selectedItem.roles,function(t){return t.name===e})||(t=!0):t=!0:this.$nameInput[0].setCustomValidity("")),this.setNameFieldIsInvalid(t)},setNameFieldIsInvalid:function(e){this.$nameInput[0].setCustomValidity(e?"Error":"")},nameChanged:function(){var e=this.$nameInput.val();this.selectedItem.name!==e&&(this.findItemWithName(e)?this.selectedItem.roles?(_.find(this.selectedItem.roles,function(t){return t.name===e})&&(this.selectedItem.name=this.$nameInput.val(),this.renderMasterList()),this.$nameInput.val(this.selectedItem.name)):this.$nameInput.val(this.selectedItem.name):(this.selectedItem.name=this.$nameInput.val(),this.renderMasterList())),this.setNameFieldIsInvalid(!1)},iconChanged:function(e){this.selectedItem.icon=e,this.renderMasterList()},updatePropertyCalcModeOptions:function(){var e=[];this.selectedItem?("number"===this.selectedItem.type||"decimal"===this.selectedItem.type||"currency"===this.selectedItem.type?(e.push({name:"Sum",value:"sum"}),e.push({name:"Average",value:"avg"}),e.push({name:"Maximum",value:"max"}),e.push({name:"Minimum",value:"min"})):"boolean"===this.selectedItem.type?(e.push({name:"All",value:"all"}),e.push({name:"Any",value:"any"})):"percentage"===this.selectedItem.type&&e.push({name:"Weighted Percentage",value:"weightedPercentage"}),"text"===this.selectedItem.type||"multitext"===this.selectedItem.type||"list"===this.selectedItem.type?(this.calcModeDropdown.setDisabled(!0),this.$calcFromChildren.prop("disabled",!0)):(this.$calcFromChildren.prop("disabled",!1),this.selectedItem.calcFromChildren?this.calcModeDropdown.setDisabled(!1):this.calcModeDropdown.setDisabled(!0)),this.calcModeDropdown.setOptions(e),this.calcModeDropdown.setValue(this.selectedItem.calculationMode)):(this.calcModeDropdown.setDisabled(!0),this.$calcFromChildren.prop("disabled",!0),this.calcModeDropdown.setOptions(e),this.calcModeDropdown.setValue(null))},updateRangeOptionsDisplay:function(){"date"===this.selectedItem.type?(d3.select("#editRangePropertyDateOptions").style("display",null),d3.select("#editRangePropertyNumericOptions").style("display","none"),this.calendarTypeDropdown.setValue(parseInt(this.selectedItem.calendar.calendarType)),this.dateMinZoomDropdown.setValue(this.selectedItem.minUnitScale),this.dateMaxZoomDropdown.setValue(this.selectedItem.maxUnitScale),this.dateFormatDropdown.setValue(this.selectedItem.calendar.dateFormatEnum),this.timeFormatDropdown.setValue(this.selectedItem.calendar.timeFormatEnum),this.$includeDayName.prop("checked",this.selectedItem.calendar.dateFormatIncludeDayName)):(d3.select("#editRangePropertyDateOptions").style("display","none"),d3.select("#editRangePropertyNumericOptions").style("display",null),this.$numericMinZoomInput.val(this.selectedItem.minUnitScale),this.$numericMaxZoomInput.val(this.selectedItem.maxUnitScale))},propertyTypeChanged:function(){this.selectedItem.type=this.typeDropdown.getValue(),this.updatePropertyCalcModeOptions(),this.calcModeDropdown.selectFirst(),this.selectedItem.calculationMode=this.calcModeDropdown.getValue(),"text"===this.selectedItem.type||"multitext"===this.selectedItem.type||"list"===this.selectedItem.type?(this.calcModeDropdown.setDisabled(!0),this.$calcFromChildren.prop("disabled",!0),this.$calcFromChildren.prop("checked",!1),this.selectedItem.calcFromChildren=!1):(this.$calcFromChildren.prop("disabled",!1),this.selectedItem.calcFromChildren?this.calcModeDropdown.setDisabled(!1):this.calcModeDropdown.setDisabled(!0)),"boolean"===this.selectedItem.type||"percentage"===this.selectedItem.type?(this.$fadeUsingProperty.prop("disabled",!1),this.$fadeUsingProperty.prop("checked",this.selectedItem.useForFadingEvents)):(this.selectedItem.useForFadingEvents=!1,this.$fadeUsingProperty.prop("disabled",!0),this.$fadeUsingProperty.prop("checked",!1)),this.updatePropertyDetailFields()},colorColorChanged:function(){var e=this.$colorInput.val(),t=_.find(this.swatchList,function(t){return t.color===e});this.selectedItem.color=t.name,this.renderMasterList()},typePersistenceChanged:function(){this.selectedItem.persistent=!this.$persistentInput.prop("checked")},calendarTypeChanged:function(){var e,t=this.selectedItem.calendar,i=new ATCalendar(t.eras,t.months,t.weekdays,t.hoursInDay,t.weekdayIndexAtZero,0),n=new ATRangeConversion("date",i);this.zeroDateFromType=t.calendarType,this.zeroDateToType=parseInt(this.calendarTypeDropdown.getValue()),e=this.zeroDateFromType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME||this.zeroDateToType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME?"Date must be at start of week ("+i.weekdays[0].name+")":this.zeroDateFromType===ATCalendarType.CALENDAR_TYPE_DAY_TIME||this.zeroDateToType===ATCalendarType.CALENDAR_TYPE_DAY_TIME?"Date can be any day (no time component)":"Date must be at start of an hour",this.zeroDateFromType!==this.zeroDateToType&&window.mainApp.showZeroDateModal(this.zeroDateChanged.bind(this),this.zeroDateValidate.bind(this),n,this.selectedItem.calendar.zeroDateTS,ATTimeUnit.HOUR,'Position "zero" in the relative timeline at date:',e)},zeroDateValidate:function(e,t){var i;return i=this.zeroDateFromType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME||this.zeroDateToType===ATCalendarType.CALENDAR_TYPE_WEEKDAY_TIME?t.dateAtEvenTimespanBeforeDate(e,new ATTimeSpan(0,0,1,0,0,0,0)):this.zeroDateFromType===ATCalendarType.CALENDAR_TYPE_DAY_TIME||this.zeroDateToType===ATCalendarType.CALENDAR_TYPE_DAY_TIME?t.dateAtEvenTimespanBeforeDate(e,new ATTimeSpan(0,0,0,1,0,0,0)):t.dateAtEvenTimespanBeforeDate(e,new ATTimeSpan(0,0,0,0,1,0,0)),e.timestamp===i.timestamp},zeroDateChanged:function(e){this.selectedItem.calendar.zeroDateTS=e.timestamp,this.selectedItem.calendar.calendarType=this.zeroDateToType},dateMinZoomChanged:function(){this.selectedItem.minUnitScale=this.dateMinZoomDropdown.getValue()},dateMaxZoomChanged:function(){this.selectedItem.maxUnitScale=this.dateMaxZoomDropdown.getValue()},dateFormatChanged:function(){this.selectedItem.calendar.dateFormatEnum=parseInt(this.dateFormatDropdown.getValue())},timeFormatChanged:function(){this.selectedItem.calendar.timeFormatEnum=parseInt(this.timeFormatDropdown.getValue())},includeDayNameChanged:function(){var e=this.$includeDayName.prop("checked");this.selectedItem.calendar.dateFormatIncludeDayName=e},numericMinZoomChanged:function(){var e=this.$numericMinZoomInput.val();isNaN(e)||(this.selectedItem.minUnitScale=parseFloat(e))},numericMaxZoomChanged:function(){var e=this.$numericMaxZoomInput.val();isNaN(e)||(this.selectedItem.maxUnitScale=parseFloat(e))},addRoleClicked:function(){for(var e=uuidV1(),t="New Role",i=1;this.findItemWithName(t);)t="New Role "+ ++i;this.selectedItem.roles.push({roleId:e,name:t,icon:"circle",multiplePerEvent:!0}),this.updateDetailFields(),$("#editRangeRoles-item"+e+"-edit-name").focus(),$("#editRangeRoles-item"+e+"-edit-name").select()},removeRoleClicked:function(e){var t;this.selectedItem.roles.length<=1||(t=_.find(this.selectedItem.roles,function(t){return t.roleId===e}),this.selectedItem.roles=_.without(this.selectedItem.roles,t),this.updateDetailFields())},editRoleNameInput:function(e,t){var i=!1;_.find(this.selectedItem.roles,function(t){return t.roleId===e})&&this.findItemWithName(t)&&this.selectedItem.name!==t&&(i=!0),this.roleListView.setNameIsInvalid(e,i)},editRoleNameChanged:function(e,t){var i=_.find(this.selectedItem.roles,function(t){return t.roleId===e});i&&(this.findItemWithName(t)?this.selectedItem.name===t&&(i.name=t):i.name=t),this.updateDetailFields()},editRoleIconChanged:function(e,t){var i=_.find(this.selectedItem.roles,function(t){return t.roleId===e});i&&(i.icon=t),this.updateDetailFields()},editRoleMultipleChanged:function(e,t){var i=_.find(this.selectedItem.roles,function(t){return t.roleId===e});i&&(i.multiplePerEvent=t),this.updateDetailFields()},calcFromChildrenChanged:function(){this.selectedItem.calcFromChildren=this.$calcFromChildren.prop("checked"),!1===this.selectedItem.calcFromChildren?this.calcModeDropdown.setDisabled(!0):"multitext"!==this.selectedItem.type&&"text"!==this.selectedItem.type&&"list"!==this.selectedItem.type&&this.calcModeDropdown.setDisabled(!1)},calculationModeChanged:function(){this.selectedItem.calculationMode=this.calcModeDropdown.getValue()},fadeUsingPropertyChanged:function(){var e=this.$fadeUsingProperty.prop("checked"),t=this.localTimelineTemplate.properties;e?(_.each(t,function(e){e.useForFadingEvents=!1}),this.selectedItem.useForFadingEvents=!0):this.selectedItem.useForFadingEvents=!1},addPropertyOptionClicked:function(){for(var e=uuidV1(),t="Option",i=1;-1!==_.findIndex(this.selectedItem.options,{name:t});)t="Option "+ ++i;this.selectedItem.options.push({uuid:e,name:t}),this.updateDetailFields(),$("#editPropertyOptions-item"+e+"-edit-name").focus(),$("#editPropertyOptions-item"+e+"-edit-name").select()},removePropertyOptionClicked:function(e){var t=_.find(this.selectedItem.options,function(t){return t.uuid===e});this.selectedItem.options=_.without(this.selectedItem.options,t),this.updateDetailFields()},propertyNameIsValid:function(e,t){var i=_.find(this.selectedItem.options,function(e){return e.name===t}),n=this.BadWords,o=_.find(n,function(e){return e===t});return!(!t||i&&i.uuid!==e||o)},editPropertyOptionNameInput:function(e,t){this.propertyOptionListView.setNameIsInvalid(e,!this.propertyNameIsValid(e,t))},editPropertyOptionNameChanged:function(e,t){var i;this.propertyNameIsValid(e,t)?((i=_.find(this.selectedItem.options,function(t){return t.uuid===e}))&&t&&(i.name=t),this.updateDetailFields()):this.updateDetailFields()},okClickHandler:function(e){return window.ApplicationInterface&&window.ApplicationInterface.updateTemplate(window.timelineDocumentId,JSON.stringify(this.localTimelineTemplate)),window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},cancelClickHandler:function(e){return this.$colorInput&&this.$colorInput.spectrum("hide"),window.mainApp.removeExistingModal(),e.preventDefault(),this.selectedItem=null,this.expandedGroup=null,this.expandedGroupName=null,this.animateExpansion(),!1},showEnterNameHandler:function(e){return window.mainApp.showSaveCustomTemplateModal(this.saveAsCustomSubmitHandler.bind(this)),e.preventDefault(),!1},showEditCalendarHandler:function(e){window.mainApp.showEditCalendarModal(this.selectedItem.calendar,this.replaceCalendar.bind(this))},replaceCalendar:function(e){this.selectedItem.calendar=e},saveAsCustomSubmitHandler:function(e){return e&&window.ApplicationInterface&&window.ApplicationInterface.saveCustomTemplate(window.timelineDocumentId,JSON.stringify(this.localTimelineTemplate),e),event.preventDefault(),!1}});module.exports=ATEditTemplateView;

},{"../../controller/ATRangeConversion":19,"../../model/ATCalendar":21,"../../model/ATCalendarType":22,"../../model/ATTimeSpan":39,"../../model/ATTimeUnit":40,"../ios/ATIconPickerControl":184,"../ios/ATPopover":189,"./ATDropdown":63,"./ATEditPropertyOptionListView":66,"./ATEditRoleListView":67,"./templates/editColorPageTemplate.html":125,"./templates/editPropertyPageTemplate.html":129,"./templates/editRangePropertyPageTemplate.html":130,"./templates/editTemplateTemplate.html":132,"./templates/editTypePageTemplate.html":133,"./templates/optionsTemplate.html":164,"backbone":220,"d3":320,"jquery":331,"lodash":333,"uuid/v1":366}],69:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATSearchDropdown=require("./ATSearchDropdown"),ATColorDropdown=require("./ATColorDropdown"),ATDropdown=require("./ATDropdown"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/embedInParentTemplate.html"),ATEmbedInNewParentView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$titleInput=$("#embedInParentTitle"),this.colorDropdown=new ATColorDropdown({el:"#embedInParentColor"}),this.colorDropdown.setNoOptionPlaceholder("No Color"),this.parentSearchDropdown=new ATSearchDropdown({el:"#embedInParentParent"}),this.parentSearchDropdown.setNoOptionPlaceholder("No Parent"),this.parentSearchDropdown.setSearchWordByWord(!0),$("#embedInParentForm").on("submit",this.addClickHandler.bind(this)),this.renderTemplate()},renderTemplate:function(){var e=this.model.get("template").colors;this.colorDropdown.setOptions(e),this.$titleInput.val(""),this.colorDropdown.setValue(e[0].name)},resetForm:function(e){var t=this.model.get("template").colors;this.$titleInput.val("New Event"),this.colorDropdown.setValue(t[0].name),this.updateParentDropdown(e),this.formSubmitted=!1,window.setTimeout(this.$titleInput.focus.bind(this.$titleInput),500),window.setTimeout(this.$titleInput.select.bind(this.$titleInput),501)},updateParentDropdown:function(e){var t=this,n=this.model.get("timeline"),i=n.get("events").models,o=this.model.get("eventData").eventIds,r=[{value:ATEmptyGuidString,sortValue:"-1",label:"(No Parent)"}],d=n.get("events").findChild(o[0]),a=d?d.get("parentId"):ATEmptyGuidString;_.each(i,function(e){!_.includes(o,e.id)&&t.validateDependencyLoop(o,e.id,!0)&&(r.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")}),t.addChildrenOfEventsToOptions(r,e,o))}),r.sort(function(e,t){var n=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),i=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),o=Math.min(n.length,i.length),r=0;for(r=0;r<o;r++)if(n[r]!=i[r])return n[r]-i[r];return n.length-i.length}),_.each(o,function(e){var t=n.get("events").findChild(e);a!=t.get("parentId")&&(a=ATEmptyGuidString)}),this.parentSearchDropdown.setOptions(r),this.parentSearchDropdown.setValue(a)},addChildrenOfEventsToOptions:function(e,t,n){var i=this;t.children.each(function(t){!_.includes(n,t.id)&&i.validateDependencyLoop(n,t.id,!0)&&e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t,n)})},validateDependencyLoop:function(e,t,n){var i=this,o=this.model.get("timeline").get("events"),r=o.findChild(t),d=_.keys(r.get("dependencies")),a=r.children,l=!1,s=!1;return!_.includes(e,t)&&(_.each(d,function(t){i.validateDependencyLoop(e,t,!1)||(l=!0)}),a.each(function(t){i.validateDependencyLoop(e,t.id,!1)||(l=!0)}),!l&&(!n||(_.each(e,function(e){var n=o.findChild(e),i=_.keys(n.get("dependencies"));_.includes(i,t)&&(s=!0)}),!s)))},addClickHandler:function(e){this.model.get("template");var t=this.$titleInput.val(),n=this.colorDropdown.getValue(),i=this.parentSearchDropdown.getValue();return!0===this.formSubmitted?(e.preventDefault(),!1):(this.formSubmitted=!0,window.mainApp.removeExistingModal(),window.ApplicationInterface&&window.ApplicationInterface.embedSelectedEventsInNewParentEvent(window.timelineDocumentId,t,n,i),e.preventDefault(),!1)}});module.exports=ATEmbedInNewParentView;

},{"../../model/ATEmptyGuidString":26,"./ATColorDropdown":59,"./ATDropdown":63,"./ATSearchDropdown":95,"./templates/embedInParentTemplate.html":135,"backbone":220,"d3":320,"jquery":331,"lodash":333}],70:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDatePicker=require("./ATDatePicker"),templateHtml=require("./templates/enterDateTemplate.html"),ATEnterDateView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+e),this.d3El.html(t({windowTitle:"Enter Date"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#enterDateWindowTitle"),this.d3WindowAboveMsg=d3.select("#enterDateWindowAboveMessage"),this.d3WindowBelowMsg=d3.select("#enterDateWindowBelowMessage"),this.d3DatePicker=this.d3El.select("#enterDatePicker"),this.datePickerView=new ATDatePicker({el:"#enterDatePicker"}),this.datePickerView.setContinuousChangeCallback(this.validateInput.bind(this)),this.$earlyInputCatcher=$("#modalInputCatcher"),this.$submitButton=$("#enterDateSubmit"),$("#enterDateForm").on("submit",this.addClickHandler.bind(this))},resetForm:function(){this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectDateIfUnfocused.bind(this),500),this.formSubmitted=!1},focusAndSelectDateIfUnfocused:function(){var e=this.$earlyInputCatcher.val();e.length>0&&(this.datePickerView.setText(e),this.validateInput()),this.datePickerView.resumeFocus(!0),this.$earlyInputCatcher.removeClass("activeCatcher")},setCallback:function(e){this.callbackFunction=e},setValidatorFunction:function(e){this.validatorFunction=e},setWindowTitle:function(e){this.$windowTitle.text(e)},setWindowAboveMessage:function(e){this.d3WindowAboveMsg.text(e).style("display",e?null:"none")},setWindowBelowMessage:function(e){this.d3WindowBelowMsg.text(e).style("display",e?null:"none")},setRangeConversion:function(e){this.datePickerView.setRangeConversion(e)},setTimestamp:function(e,t){this.datePickerView.setTimestamp(e,t),this.datePickerView.focusAndSelectAll()},validateInput:function(){var e=this.datePickerView.getValue(),t=!this.validatorFunction||this.validatorFunction(e,this.datePickerView.calendar);return this.$submitButton.prop("disabled",!t),t},addClickHandler:function(e){var t=this.datePickerView.getValue();return!0===this.formSubmitted?(e.preventDefault(),window.mainApp.removeExistingModal(),!1):(this.formSubmitted=!0,e.preventDefault(),!!this.validateInput()&&(this.callbackFunction&&this.callbackFunction(t),window.mainApp.removeExistingModal(),!1))}});module.exports=ATEnterDateView;

},{"./ATDatePicker":60,"./templates/enterDateTemplate.html":136,"backbone":220,"d3":320,"jquery":331,"lodash":333}],71:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDurationPicker=require("./ATDurationPicker"),templateHtml=require("./templates/enterDurationTemplate.html"),ATEnterDurationView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),i=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+t),this.d3El.html(i({windowTitle:"Enter Duration"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#enterDurationWindowTitle"),this.d3Duration=this.d3El.select("#enterDurationPicker"),this.durationPickerView=new ATDurationPicker({el:"#enterDurationPicker"}),this.durationPickerView.setContinuousChangeCallback(this.validateInput.bind(this)),this.$earlyInputCatcher=$("#modalInputCatcher"),this.$submitButton=$("#enterDurationSubmit"),$("#enterDurationForm").on("submit",this.addClickHandler.bind(this))},setCallback:function(t){this.callbackFunction=t},setValidatorFunction:function(t){this.validatorFunction=t},setWindowTitle:function(t){this.$windowTitle.text(t)},setRangeConversion:function(t){this.durationPickerView.setRangeConversion(t)},resetForm:function(){this.durationPickerView.setText(""),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectFieldIfUnfocused.bind(this),500),this.formSubmitted=!1},focusAndSelectFieldIfUnfocused:function(){var t=this.$earlyInputCatcher.val(),i=t.length;this.durationPickerView.setText(t),this.durationPickerView.focusCursor(),i>0&&this.validateInput(),this.$earlyInputCatcher.removeClass("activeCatcher")},setValue:function(t){this.durationPickerView.setValue(t)},validateInput:function(){var t=this.durationPickerView.text(),i=!this.validatorFunction||this.validatorFunction(t);return this.$submitButton.prop("disabled",!i),i},addClickHandler:function(t){var i=this.durationPickerView.text();this.durationPickerView.getValue();return!0===this.formSubmitted?(t.preventDefault(),window.mainApp.removeExistingModal(),!1):(this.formSubmitted=!0,t.preventDefault(),!!this.validateInput()&&(this.callbackFunction&&this.callbackFunction(i),window.mainApp.removeExistingModal(),!1))}});module.exports=ATEnterDurationView;

},{"./ATDurationPicker":64,"./templates/enterDurationTemplate.html":137,"backbone":220,"d3":320,"jquery":331,"lodash":333}],72:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/enterNameTemplate.html"),ATEnterNameView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+t),this.d3El.html(e({windowTitle:"Enter Name"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#enterNameWindowTitle"),this.d3WindowAboveMsg=d3.select("#enterNameWindowAboveMessage"),this.d3WindowBelowMsg=d3.select("#enterNameWindowBelowMessage"),this.$nameInput=$("#enterNameInput"),this.$nameInput.on("input",this.validateNameInput.bind(this)),this.$submitButton=$("#enterNameSubmit"),this.$earlyInputCatcher=$("#modalInputCatcher"),$("#enterNameForm").on("submit",this.addClickHandler.bind(this))},setCallback:function(t){this.callbackFunction=t},setValidatorFunction:function(t){this.validatorFunction=t},setWindowTitle:function(t){this.$windowTitle.text(t)},setWindowAboveMessage:function(t){this.d3WindowAboveMsg.text(t).style("display",t?null:"none")},setWindowBelowMessage:function(t){this.d3WindowBelowMsg.text(t).style("display",t?null:"none")},resetForm:function(){this.$nameInput.val(""),this.$submitButton.prop("disabled",!0),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectNameIfUnfocused.bind(this),500),this.formSubmitted=!1},focusAndSelectNameIfUnfocused:function(){var t=this.$earlyInputCatcher.val(),e=t.length;this.$nameInput.val(t),this.$nameInput.focus(),this.$nameInput[0].setSelectionRange(e,e),e>0&&this.validateNameInput(),this.$earlyInputCatcher.removeClass("activeCatcher")},validateNameInput:function(){var t=this.$nameInput.val(),e=this.validatorFunction?this.validatorFunction(t):t.length>0;return this.$submitButton.prop("disabled",!e),e},addClickHandler:function(t){this.$nameInput.val();if(!0===this.formSubmitted)return t.preventDefault(),window.mainApp.removeExistingModal(),!1;this.formSubmitted=!0;if(this.validateNameInput())return this.callbackFunction&&this.callbackFunction(this.$nameInput.val()),window.mainApp.removeExistingModal(),t.preventDefault(),!1;t.preventDefault()}});module.exports=ATEnterNameView;

},{"./templates/enterNameTemplate.html":138,"backbone":220,"d3":320,"jquery":331,"lodash":333}],73:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/exportCSVTemplate.html"),ATExportCSVView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.d3El=d3.select("#"+t),this.d3El.html(e({windowTitle:"Export to CSV"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#exportCSVWindowTitle"),this.$delimiterCommaInput=$("#delimiterInputComma"),this.dateFormatDropdown=new ATDropdown({el:"#dateFormatInput"}),this.timeFormatDropdown=new ATDropdown({el:"#timeFormatInput"}),this.$submitButton=$("#exportCSVSubmit"),$("#exportCSVForm").on("submit",this.addClickHandler.bind(this))},setWindowTitle:function(t){this.$windowTitle.text(t)},addClickHandler:function(t){var e=this.$delimiterCommaInput.is(":checked"),i=parseInt(this.dateFormatDropdown.getValue()),o=this.timeFormatDropdown.getValue();return o=0!=o,window.ApplicationInterface&&window.ApplicationInterface.exportCsv(window.timelineDocumentId,e,i,o),window.mainApp.removeExistingModal(),t.preventDefault(),!1}});module.exports=ATExportCSVView;

},{"./ATDropdown":63,"./templates/exportCSVTemplate.html":139,"backbone":220,"d3":320,"jquery":331,"lodash":333}],74:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATViewMode=require("../ATViewMode"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),templateHtml=require("./templates/exportImageTemplate.html"),ATRect=require("../../utils/ATRect"),ATDatePicker=require("./ATDatePicker"),ATExportImageView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),i=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(i({windowTitle:"Export to Image or PDF"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#exportImageWindowTitle"),this.d3StartDate=this.d3El.select("#startDateInputImage"),this.startDatePickerView=new ATDatePicker({el:"#startDateInputImage"}),this.d3EndDate=this.d3El.select("#endDateInputImage"),this.endDatePickerView=new ATDatePicker({el:"#endDateInputImage"}),this.endDatePickerView.setupAsEndPickerForStartPicker(this.startDatePickerView),this.exportViewport=new ATRect(0,0,0,0),this.validSize=!1,this.currentFormat(),this.$submitButton=$("#exportImageSubmit"),$("#entireTimelineImage").on("click",this.entireTimeline.bind(this)),$("#formatCurrentImage").on("click",this.currentFormat.bind(this)),$("#betweenDatesImage").on("click",this.betweenDates.bind(this)),this.startDatePickerView.setChangeCallback(this.updateDates.bind(this)),this.endDatePickerView.setChangeCallback(this.updateDates.bind(this)),$("#exportImageForm").on("submit",this.exportClickHandler.bind(this))},calculateRangeOnShow:function(){window.mainApp.getUnitScale(),this.printSize;var e=$("input[name=Format]:checked","#exportImageForm").val();window.mainApp.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW?($("#betweenDatesImage").prop("disabled","disabled"),$("#formatCurrentImage").prop("disabled","disabled"),e="All",$("#entireTimelineImage").prop("checked",!0),$("#betweenDatesImage").prop("checked",!1),$("#formatCurrentImage").prop("checked",!1)):($("#betweenDatesImage").prop("disabled",null),$("#formatCurrentImage").prop("disabled",null)),"Current"==e?this.currentFormat():"All"==e?this.entireTimeline():this.betweenDates()},setRangeConversion:function(e){this.startDatePickerView.setRangeConversion(e),this.endDatePickerView.setRangeConversion(e)},currentFormat:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),this.exportViewport=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?window.mainApp.timelineView.viewport.deepCopy():window.mainApp.relationshipView.viewport.deepCopy(),this.exportViewport.size=window.mainApp.getViewportSizeAsSizeForExport(),this.checkFileSizeLimits()},entireTimeline:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),this.exportViewport.origin.x=window.mainApp.getEarliestEventPixel(),this.exportViewport.origin.y=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?0:-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,this.exportViewport.size.width=window.mainApp.getLatestEventPixel()-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeightForExport(),this.checkFileSizeLimits()},betweenDates:function(){this.startDatePickerView.setDisabled(!1),this.endDatePickerView.setDisabled(!1),this.updateDates()},updateDates:function(){var e,i;null!==this.startDatePickerView.getValue()&&(e=this.startDatePickerView.getTimestamp()),null!==this.endDatePickerView.getValue()&&(i=this.endDatePickerView.getTimestamp()),isNaN(e)&&isNaN(i)||i>=e&&(this.exportViewport.origin.x=window.mainApp.pixelForTimestamp(e),this.exportViewport.origin.y=0,this.exportViewport.size.width=window.mainApp.pixelForTimestamp(i)-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeightForExport(),this.checkFileSizeLimits())},checkFileSizeLimits:function(){this.exportViewport.size.width*=window.mainApp.timelineView.physicalScaleFactor,this.exportViewport.size.height*=window.mainApp.timelineView.physicalScaleFactor,this.exportViewport.size.width=4*Math.ceil(this.exportViewport.size.width/4),this.exportViewport.size.height=4*Math.ceil(this.exportViewport.size.height/4),this.exportViewport.size.width>=65536||this.exportViewport.size.height>=65536?(this.validSize=!1,$("#widthLabelImage").text(Math.round(this.exportViewport.size.width)),$("#heightLabelImage").text(Math.round(this.exportViewport.size.height)),$("#exportImageSubmit").prop("disabled","disabled"),$("#exportImageWarningLabel").text("Error: Dimensions too large to export (Max width/height: 65536 pixels)")):(this.validSize=!0,$("#widthLabelImage").text(Math.round(this.exportViewport.size.width)),$("#heightLabelImage").text(Math.round(this.exportViewport.size.height)),$("#exportImageSubmit").prop("disabled",null),$("#exportImageWarningLabel").text(""))},setWindowTitle:function(e){this.$windowTitle.text(e)},exportClickHandler:function(e){var i=window.mainApp.getUnitScale();return this.validSize?(window.ApplicationInterface&&window.ApplicationInterface.exportImage(window.timelineDocumentId,""+this.exportViewport.origin.x,""+this.exportViewport.origin.y,this.exportViewport.size.width,this.exportViewport.size.height,""+i),window.mainApp.removeExistingModal(),e.preventDefault(),!1):(e.preventDefault(),!1)}});module.exports=ATExportImageView;

},{"../../controller/ATDisplayConstants":16,"../../utils/ATRect":48,"../ATViewMode":53,"./ATDatePicker":60,"./templates/exportImageTemplate.html":140,"backbone":220,"d3":320,"jquery":331,"lodash":333}],75:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATInspectorRangePageView=require("./ATInspectorRangePageView"),ATInspectorPropertyPageView=require("./ATInspectorPropertyPageView"),ATInspectorRolePageView=require("./ATInspectorRolePageView"),ATInspectorLinkPageView=require("./ATInspectorLinkPageView"),ATSearchDropdown=require("./ATSearchDropdown"),ATColorDropdown=require("./ATColorDropdown"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/expressInspectorTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),pageGroupHtml=require("./templates/expressInspectorPageGroupTemplate.html"),ATExpressInspectorView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml),n=_.template(pageGroupHtml);console.log("ATExpressInspectorView constructor -- GOOD"),this.minWidth=200,this.maxWidth=400,this.stackedWidth=300,this.currentWidthWhenOpen=350,this.optionsTemplate=_.template(optionsHtml),this.d3El=d3.select("#"+e),this.d3El.html(i({})),this.listenTo(this.model,"change:template",this.renderTemplate),this.listenTo(this.model,"change:eventData",this.render),this.$headerText=$("#inspectorHeaderText"),this.$headerEventId=$("#inspectorHeaderEventID"),this.d3HeaderEventId=d3.select("#inspectorHeaderEventID"),this.$topBox=$("#inspectorTopBox"),this.$titleInput=$("#inspectorTitle"),$("#inspectorCloseArrow").on("click",function(){window.ApplicationInterface&&window.ApplicationInterface.closeInspector(window.timelineDocumentId)}),$("#inspectorForm").on("submit",function(){return!1}),this.colorDropdown=new ATColorDropdown({el:"#inspectorColor"}),this.colorDropdown.setNoOptionPlaceholder("No Color"),this.$titleInput.on("input",function(){t.titleInputHandler()}),this.$titleInput.blurOnEnter().on("blur",function(){t.titleBlurHandler()}),this.listenTo(this.colorDropdown,"change",function(){t.colorChangeHandler()}),this.d3ScrollBox=this.d3El.select("#inspectorScrollBox"),this.d3TabGroup=this.d3El.select("#inspectorPageGroup"),this.tabs=[{index:0,name:"Roles",icon:"users"},{index:1,name:"Range",icon:"flag"},{index:2,name:"Values",icon:"tags"},{index:3,name:"Links",icon:"link"}],this.d3TabGroup.html(n({tabs:this.tabs})),this.d3TabContentGroup=this.d3TabGroup.select(".tabContentGroup"),_.each(this.tabs,function(e){e.page=t.d3El.select("#"+e.name+"-page")}),this.rolePageView=new ATInspectorRolePageView({el:"#"+this.tabs[0].name+"-page",model:this.model,isExpressMode:!0}),this.rangePageView=new ATInspectorRangePageView({el:"#"+this.tabs[1].name+"-page",model:this.model,isExpressMode:!0}),this.propertyPageView=new ATInspectorPropertyPageView({el:"#"+this.tabs[2].name+"-page",model:this.model,isExpressMode:!0}),this.linkPageView=new ATInspectorLinkPageView({el:"#"+this.tabs[3].name+"-page",model:this.model,isExpressMode:!0}),this.resizeDrag=d3.behavior.drag().on("dragstart",this.resizeDragStarted.bind(this)).on("drag",this.resizeDragged.bind(this)).on("dragend",this.resizeDragEnded.bind(this)),d3.select("#inspectorResizeGrabber").call(this.resizeDrag),this.renderTemplate(),this.render(),window.addEventListener("resize",this.resize.bind(this),!1),this.resize()},resize:function(){var e=this.$el.innerWidth(),t=this.$el.innerHeight()-this.$topBox.outerHeight(),i=window.mainApp&&window.mainApp.displaySettings?this.stackedWidth*window.mainApp.displaySettings.size/100:this.stackedWidth;this.d3El.classed("stacked",e<i),this.d3ScrollBox.style("height",t+"px"),this.propertyPageView.resizeMultilineElement()},renderTemplate:function(){var e=this.model.get("template"),t=e.colors;this.colorDropdown.setOptions(t),this.rangePageView.setRangeId(e.rangeProperties[0].rangePropertyId)},resizeDragStarted:function(e){},resizeDragged:function(e){var t,i=d3.event.sourceEvent.clientX;this.resizeDragStartX||(this.resizeDragStartX=i,this.resizeDragOriginalWidth=this.$el.innerWidth()),(t=this.resizeDragOriginalWidth+(this.resizeDragStartX-i))<this.minWidth?t=this.minWidth:t>this.maxWidth&&(t=this.maxWidth),this.currentWidthWhenOpen=t,window.mainApp.resizeInspector(t),window.ApplicationInterface&&window.ApplicationInterface.setInspectorWidth(window.timelineDocumentId,t)},resizeDragEnded:function(e){this.resizeDragStartX=null,this.originalWidth=null},setRangeConversion:function(e){this.rangePageView.setRangeConversion(e)},render:function(){var e,t,i,n=this,s=this.model.get("eventData"),r="Event:",o=[];if(this.currentEventIds=s.eventIds,s.eventIds)for(e=0;e<s.eventIds.length;e++)o.push({id:s.eventIds[e],displayId:s.displayEventIds[e]});o.sort(function(e,t){return e.displayIndex<t.displayIndex?-1:e.displayIndex==t.displayIndex?0:1}),this.commitTitle(),0==o.length?r="Events: None selected":o.length>1&&(r="Events:",o.length>5&&(r+=" (Multiple)",o=[])),(t=this.d3HeaderEventId.selectAll("span").data(o)).select("a").text(function(e){return e.displayId}),t.select("i").text(function(e,t){return t<o.length-1?", ":""}),(i=t.enter().append("span")).append("a").text(function(e){return e.displayId}).on("click",function(e){n.eventIdClicked(e.id)}),i.append("i").text(function(e,t){return t<o.length-1?", ":""}),t.exit().remove(),this.$headerText.text(r),this.$titleInput.val(s.title),this.colorDropdown.setValue(s.color),this.$titleInput.prop("disabled",!s.enabled),this.colorDropdown.setDisabled(!s.enabled),this.setTitleFieldIsInvalid(!1)},titleInputHandler:function(){this.recordedInputTitle=this.$titleInput.val(),this.recordedInputEvents=this.currentEventIds,this.setTitleFieldIsInvalid(!this.$titleInput.val())},setTitleFieldIsInvalid:function(e){this.$titleInput&&this.$titleInput[0].setCustomValidity(e?"Error":"")},titleBlurHandler:function(){var e=this.model.get("eventData");this.recordedInputTitle&&this.recordedInputEvents?window.ApplicationInterface&&window.ApplicationInterface.setSelectedEventsTitle(window.timelineDocumentId,this.recordedInputEvents.join(),this.recordedInputTitle):(this.$titleInput.val(e?e.title:""),this.setTitleFieldIsInvalid(!1)),this.recordedInputTitle=null,this.recordedInputEvents=null},commitTitle:function(){this.recordedInputTitle&&this.titleBlurHandler()},colorChangeHandler:function(){window.ApplicationInterface&&window.ApplicationInterface.setSelectedEventsColor(window.timelineDocumentId,this.currentEventIds.join(),this.colorDropdown.getValue())},eventIdClicked:function(e){return d3.event.preventDefault(),d3.event.stopPropagation(),window.mainApp.timelineView.revealChildNode(parseInt(e)),!1}});module.exports=ATExpressInspectorView;

},{"./ATColorDropdown":59,"./ATDropdown":63,"./ATInspectorLinkPageView":83,"./ATInspectorPropertyPageView":85,"./ATInspectorRangePageView":86,"./ATInspectorRolePageView":87,"./ATSearchDropdown":95,"./templates/expressInspectorPageGroupTemplate.html":141,"./templates/expressInspectorTemplate.html":142,"./templates/optionsTemplate.html":164,"backbone":220,"d3":320,"jquery":331,"lodash":333}],76:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/expressManageRowsListTemplate.html"),bootstrap=require("bootstrap"),ATExpressManageRowsListView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.d3El=d3.select("#"+this.elementName),this.useExternalLinkTemplate=!1,this.render([])},render:function(e){var t=this;this.d3El.html(this.elTemplate({items:e})),this.d3El.select(".addButton").attr("id",this.elementName+"-add").on("click",function(){t.addClick()}),_.each(e,function(e){var a=t.elementName+"-item"+e.id;t.d3El.select(".remove-"+e.id).attr("id",a+"-remove").on("click",function(){t.removeClick(e.id)}),t.d3El.select(".edit-name-"+e.id).attr("id",a+"-edit-name").on("change",function(){t.nameChanged(e.id,$("#"+a+"-edit-name").val())}).on("input",function(){t.nameInput(e.id,$("#"+a+"-edit-name").val())})}),t.d3El.classed("oneRowOnly",e.length<=1)},setDisabled:function(e){this.disabled=e,this.d3El.classed("disabled",e)},setNameIsInvalid:function(e,t){var a="#"+this.elementName+"-item"+e+"-edit-name";$(a)[0].setCustomValidity(t?"Error":"")},setAddCallback:function(e){this.addCallback=e},setRemoveCallback:function(e){this.removeCallback=e},setNameChangeCallback:function(e){this.nameChangeCallback=e},setNameInputCallback:function(e){this.nameInputCallback=e},addClick:function(){this.addCallback&&this.addCallback()},removeClick:function(e){this.removeCallback&&this.removeCallback(e)},nameInput:function(e,t){this.nameInputCallback&&this.nameInputCallback(e,t)},nameChanged:function(e,t){this.nameChangeCallback&&this.nameChangeCallback(e,t)}});module.exports=ATExpressManageRowsListView;

},{"./templates/expressManageRowsListTemplate.html":144,"backbone":220,"bootstrap":222,"d3":320,"jquery":331,"lodash":333}],77:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("../../utils/ATUtilities"),ATExpressManageRowsListView=require("./ATExpressManageRowsListView"),templateHtml=require("./templates/expressManageRowsViewTemplate.html"),ATExpressManageRowsView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml);this.BadWords=["Event","Row","Entity","Tag","Color","Parent","Link","Any","None","All","Timeline"],this.requireSelectAndFocus=!1,this.selectAndFocusName=null,this.d3El=d3.select("#"+e),this.d3El.html(i()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.rowListView=new ATExpressManageRowsListView({el:"#manageRowsList"}),this.rowListView.setAddCallback(this.addRowClicked.bind(this)),this.rowListView.setNameInputCallback(this.editRowNameInput.bind(this)),this.rowListView.setNameChangeCallback(this.editRowNameChanged.bind(this)),this.rowListView.setRemoveCallback(this.removeRowClicked.bind(this)),this.listenTo(this.model,"change:entitiesByType",function(){t.updateRows()}),this.focusLastAfterRender=!1,this.updateRows()},updateRows:function(){var e=this,t=this.model.get("entitiesByType"),i=this.model.get("template"),s=(t=this.model.get("entitiesByType"),i.types);this.rowItems=[],this.rowType=_.first(s),_.each(t,function(t,i){_.each(t,function(t){e.rowItems.push({id:t.entityId,title:t.name})})}),this.rowListView.render(this.rowItems),this.focusLastAfterRender&&window.setTimeout(function(){var t=e.$(".manageRowsInput").last();t.focus(),t.select()},100),this.focusLastAfterRender=!1},validateName:function(e,t){var i=null,s=this.model.get("entitiesByType"),n=this.BadWords;if(!e||0===e.length)return!1;if(i=_.find(n,function(t){return t==e}))return!1;if(_.each(s,function(t,s){_.each(t,function(t){t.name==e&&(i=t)})}),i)return i.entityId==t;return!new RegExp(/[\<\>\{\}\[\]]/).test(e)},addRowClicked:function(){for(var e=1,t="Row "+e;!this.validateName(t);)t="Row "+ ++e;this.focusLastAfterRender=!0,window.ApplicationInterface&&window.ApplicationInterface.addEntity(window.timelineDocumentId,t,this.rowType.typeId,-1,"",!1,"")},removeRowClicked:function(e){this.rowItems.length<=1||window.ApplicationInterface&&window.ApplicationInterface.removeEntity(window.timelineDocumentId,e)},editRowNameInput:function(e,t){var i=this.validateName(t,e);this.rowListView.setNameIsInvalid(e,!i)},editRowNameChanged:function(e,t){this.validateName(t,e)?window.ApplicationInterface.setEntityName(window.timelineDocumentId,t,e):this.updateRows()}});module.exports=ATExpressManageRowsView;

},{"../../utils/ATUtilities":51,"./ATExpressManageRowsListView":76,"./templates/expressManageRowsViewTemplate.html":145,"backbone":220,"d3":320,"jquery":331,"lodash":333}],78:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("../../utils/ATUtilities"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/expressSettingsTemplate.html"),ATExpressSettingsView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),i=_.template(templateHtml);this.formSubmitted=!1,this.d3El=d3.select("#"+t),this.d3El.html(i()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),$("#displaySettingsShowIds").on("change",this.showIdsChanged.bind(this)),$("#displaySettingsShowDates").on("change",this.showDatesChanged.bind(this)),$("#displaySettingsShowToday").on("change",this.showTodayChanged.bind(this)),$("#displaySettingsExpandAll").on("change",this.expandAllChanged.bind(this)),this.skinDropdown=new ATDropdown({el:"#displaySettingsSkin"}),this.listenTo(this.skinDropdown,"change",this.skinChanged.bind(this)),this.sizeDropdown=new ATDropdown({el:"#displaySettingsSize"}),this.listenTo(this.sizeDropdown,"change",this.sizeChanged.bind(this)),this.scrollDropdown=new ATDropdown({el:"#displaySettingsScrollingBounds"}),this.listenTo(this.scrollDropdown,"change",this.scrollChanged.bind(this)),this.layoutDropdown=new ATDropdown({el:"#displaySettingsLayout"}),this.listenTo(this.layoutDropdown,"change",this.layoutChanged.bind(this)),this.dateMinZoomDropdown=new ATDropdown({el:"#displaySettingsMinZoom"}),this.listenTo(this.dateMinZoomDropdown,"change",this.dateMinZoomChanged.bind(this)),this.dateMaxZoomDropdown=new ATDropdown({el:"#displaySettingsMaxZoom"}),this.listenTo(this.dateMaxZoomDropdown,"change",this.dateMaxZoomChanged.bind(this)),this.dateFormatDropdown=new ATDropdown({el:"#displaySettingsDateFormat"}),this.listenTo(this.dateFormatDropdown,"change",this.dateFormatChanged.bind(this)),this.timeFormatDropdown=new ATDropdown({el:"#displaySettingsTimeFormat"}),this.listenTo(this.timeFormatDropdown,"change",this.timeFormatChanged.bind(this)),$("#displaySettingsForm").on("submit",this.okClickHandler.bind(this)),$("#displaySettingsApply").on("click",this.applyClickHandler.bind(this)),$("#displaySettingsCancel").on("click",this.cancelClickHandler.bind(this)),this.draggedItem=null},setDisplaySettings:function(t){this.displaySettings=t,this.render()},render:function(){d3.select("#leftDisplayColumn").selectAll(".displayItem").data(this.leftColItems),d3.select("#rightDisplayColumn").selectAll(".displayItem").data(this.rightColItems),d3.select("#available").selectAll(".item").data(this.remainderItems);var t=this.displaySettings.skin?this.displaySettings.skin:"dark",i=this.displaySettings.size?this.displaySettings.size:"100",e=this.displaySettings.scrollingBehaviour?this.displaySettings.scrollingBehaviour:"bounce",s=this.displaySettings.layout?this.displaySettings.layout:"cascade";this.formSubmitted=!1,this.skinDropdown.setValue(t),this.sizeDropdown.setValue(i),this.scrollDropdown.setValue(e),this.layoutDropdown.setValue(s),this.dateMinZoomDropdown.setValue(this.displaySettings.minUnitScale),this.dateMaxZoomDropdown.setValue(this.displaySettings.maxUnitScale),this.dateFormatDropdown.setValue(this.displaySettings.dateFormat),this.timeFormatDropdown.setValue(this.displaySettings.timeFormat),d3.select("#displaySettingsShowIds").attr("checked",this.displaySettings.showEventId?"checked":null),d3.select("#displaySettingsShowDates").attr("checked",this.displaySettings.showEventDate?"checked":null),d3.select("#displaySettingsShowToday").attr("checked",this.displaySettings.showTodayLine?"checked":null)},showIdsChanged:function(){this.displaySettings.showEventId=$("#displaySettingsShowIds").prop("checked")},showDatesChanged:function(){this.displaySettings.showEventDate=$("#displaySettingsShowDates").prop("checked")},showTodayChanged:function(){this.displaySettings.showTodayLine=$("#displaySettingsShowToday").prop("checked")},expandAllChanged:function(){this.displaySettings.parmenentExpandEvents=$("#displaySettingsExpandAll").prop("checked")},skinChanged:function(){this.displaySettings.skin=this.skinDropdown.getValue()},sizeChanged:function(){this.displaySettings.size=parseInt(this.sizeDropdown.getValue())},scrollChanged:function(){this.displaySettings.scrollingBehaviour=this.scrollDropdown.getValue()},layoutChanged:function(){this.displaySettings.layout=this.layoutDropdown.getValue()},dateMinZoomChanged:function(){this.displaySettings.minUnitScale=this.dateMinZoomDropdown.getValue()},dateMaxZoomChanged:function(){this.displaySettings.maxUnitScale=this.dateMaxZoomDropdown.getValue()},dateFormatChanged:function(){this.displaySettings.dateFormat=parseInt(this.dateFormatDropdown.getValue())},timeFormatChanged:function(){this.displaySettings.timeFormat=parseInt(this.timeFormatDropdown.getValue())},okClickHandler:function(t){return!0===this.formSubmitted?(window.mainApp.removeExistingModal(),t.preventDefault(),!1):(this.formSubmitted=!0,window.ApplicationInterface&&window.ApplicationInterface.updateDisplaySettings(window.timelineDocumentId,JSON.stringify(this.displaySettings)),window.mainApp.removeExistingModal(),t.preventDefault(),!1)},applyClickHandler:function(t){return window.ApplicationInterface&&window.ApplicationInterface.updateDisplaySettings(window.timelineDocumentId,JSON.stringify(this.displaySettings)),t.preventDefault(),!1},cancelClickHandler:function(t){return window.mainApp.removeExistingModal(),t.preventDefault(),!1}});module.exports=ATExpressSettingsView;

},{"../../utils/ATUtilities":51,"./ATDropdown":63,"./templates/expressSettingsTemplate.html":147,"backbone":220,"d3":320,"jquery":331,"lodash":333}],79:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("../../utils/ATUtilities"),ATAutoSuggestField=require("./ATAutoSuggestField"),templateHtml=require("./templates/filterBarTemplate.html"),itemsHtml=require("./templates/filterBarItemsTemplate.html"),dhtmlXMenuObject=require("../../../lib/dhtmlxmenu"),ATFilterBarView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),i=this,t=_.template(templateHtml);this.itemsTemplate=_.template(itemsHtml),this.chosenLogic="AND",this.chosenNegate="HAS",this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3InlineAdd=this.d3El.select("#filterBarInlineAdd"),this.d3Items=this.d3El.select("#filterBarItems"),this.inlineAddScopeField=new ATAutoSuggestField({el:"#filterBarInlineAddScope"}),this.inlineAddValueField=new ATAutoSuggestField({el:"#filterBarInlineAddValue"}),this.inlineAddScopeField.setPlaceholderText("Field","Click to add filter..."),this.inlineAddScopeField.setLookupFunction(this.lookupScope.bind(this)),this.inlineAddValueField.setPlaceholderText("Value",""),this.inlineAddValueField.setLookupFunction(this.lookupValue.bind(this)),this.inlineAddScopeField.setOnFocus(function(){i.scopeFieldFocused(),i.resumeFocus()}),this.inlineAddScopeField.setOnGoToNextField(function(){i.inlineAddValueField.focusClickHandler()}),this.inlineAddValueField.setOnFocus(function(){i.valueFieldFocused(),i.resumeFocus()}),this.inlineAddValueField.setOnGoToNextField(function(){$("#filterBarInlineAddButton").focus()}),this.d3InlineLogicDiv=d3.select("#filterBarInlineAddLogic"),this.$inlineLogicDiv=$("#filterBarInlineAddLogic"),this.d3InlineLogicValue=d3.select("#filterBarInlineAddLogicValue"),this.$inlineLogicValue=$("#filterBarInlineAddLogicValue"),this.d3InlineLogicOptions=this.d3InlineLogicDiv.selectAll("li").data(["AND","OR"]).on("click",this.logicOptionClick.bind(this)),this.$logicDropdown=$("#filterBarInlineAddLogicList"),this.$inlineLogicDiv.on("focus",this.resumeFocus.bind(this)),this.$inlineLogicValue.on("click",this.showLogicDropdown.bind(this)),this.d3InlineNegateDiv=d3.select("#filterBarInlineAddNegate"),this.$inlineNegateDiv=$("#filterBarInlineAddNegate"),this.d3InlineNegateValue=d3.select("#filterBarInlineAddNegateValue"),this.$inlineNegateValue=$("#filterBarInlineAddNegateValue"),this.d3InlineNegateOptions=this.d3InlineNegateDiv.selectAll("li").data(["HAS","NOT"]).on("click",this.negateOptionClick.bind(this)),this.$negateDropdown=$("#filterBarInlineAddNegateList"),this.$inlineNegateDiv.on("focus",this.resumeFocus.bind(this)),this.$inlineNegateValue.on("click",this.showNegateDropdown.bind(this)),$("#filterBarInlineAddButton").on("focus",function(){i.resumeFocus()}),$("#filterBarInlineAddButton .imageButton").on("focus",function(){i.resumeFocus()}),this.listenTo(this.model.get("timeline"),"change:filters",this.renderFilterItems),this.inlineAddScopeField.setOptions(this.scopeList()),this.listenTo(this.model,"change:template",function(){i.scopeOptionsList=null,i.inlineAddScopeField.setOptions(i.scopeList())}),$(".manageFilterIcon").on("click",function(){i.manageFilterClicked()}),$(".clearFilterIcon").on("click",this.clearFilterClicked.bind(this)),$("#filterBarInlineAddButton").on("click",this.addClicked.bind(this))},configureManageFilterMenu:function(e){var i,t=JSON.parse(e),n=[{id:"save",text:"Save..."},{id:"load",text:"Load",items:[]},{id:"delete",text:"Delete",items:[]}];for(i=0;i<t.length;i++)n[1].items.push({id:"load"+i,text:t[i]}),n[2].items.push({id:"delete"+i,text:t[i]});0==t.length&&(n[1].disabled=!0,n[2].disabled=!0),this.manageFilterMenu?(this.manageFilterMenu.clearAll(),this.manageFilterMenu.loadStruct(n)):(this.manageFilterMenu=new dhtmlXMenuObject({context:!0,items:n}),this.manageFilterMenu.setAutoShowMode(!1),this.manageFilterMenu.setAutoHideMode(!0),this.manageFilterMenu.setContextMenuHideAllMode(!1),this.manageFilterMenu.attachEvent("onClick",this.manageFilterMenuItemClick.bind(this)))},valueFieldFocused:function(){this.inlineAddValueField.setOptions(this.createValueList()),this.inlineAddScopeField.hideList(),this.hideLogicDropdown(),this.hideNegateDropdown()},scopeFieldFocused:function(){this.inlineAddValueField.hideList(),this.hideLogicDropdown(),this.hideNegateDropdown()},resumeFocus:function(){var e=this,i=this.model.get("timeline").get("filters");this.d3InlineAdd.classed("focus",!0),this.d3InlineLogicDiv.classed("hide",0==i.length),this.$backdrop||(this.$backdrop=$('<div class="filterBackdrop"/>'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){e.removeFocus()})),this.adjustFilterSize()},removeFocus:function(){this.d3InlineAdd.classed("focus",!1),this.$backdrop&&(this.$backdrop.remove(),this.$backdrop=null),this.adjustFilterSize(),this.inlineAddScopeField.hideList(),this.inlineAddValueField.hideList(),this.hideLogicDropdown(),this.hideNegateDropdown(),this.focusHasResumed=!1},renderFilterItems:function(){var e=this,i=this.model.get("timeline").get("filters");this.d3Items.html(this.itemsTemplate({items:i})),this.d3Items.selectAll(".remove").data(i).on("click",function(i){e.removeItem(i.uniqueId)}),this.adjustFilterSize()},adjustFilterSize:function(){window.mainApp.adjustFilterBar(!1)},showLogicDropdown:function(){var e=this;this.inlineAddScopeField.hideList(),this.inlineAddValueField.hideList(),this.hideNegateDropdown(),this.d3InlineLogicOptions.classed("active",function(i){return i==e.chosenLogic}).classed("highlight",function(i,t){return i==e.chosenLogic}),e.$logicDropdown.slideDown(250)},hideLogicDropdown:function(){this.$logicDropdown.slideUp(250)},logicOptionClick:function(e){this.chosenLogic=e,this.$inlineLogicValue.text(e),this.hideLogicDropdown()},showNegateDropdown:function(){var e=this;this.inlineAddScopeField.hideList(),this.inlineAddValueField.hideList(),this.hideLogicDropdown(),this.d3InlineNegateOptions.classed("active",function(i){return i==e.chosenNegate}).classed("highlight",function(i,t){return i==e.chosenNegate}),e.$negateDropdown.slideDown(250)},hideNegateDropdown:function(){this.$negateDropdown.slideUp(250)},negateOptionClick:function(e){this.chosenNegate=e,this.$inlineNegateValue.text(e),this.hideNegateDropdown()},scopeList:function(){if(!this.scopeOptionsList){var e=this.model.get("template"),i=["Title","Color","Entity","Tag","Duration"];_.each(e.properties,function(e){i.push(e.name)}),_.each(e.types,function(e){i.push(e.name),_.each(e.roles,function(t){t.name!=e.name&&i.push(t.name)})}),_.each(e.rangeProperties,function(e){i.push(e.name)}),i.sort(),this.scopeOptionsList=i}return this.scopeOptionsList},lookupScope:function(e){var i=this.scopeList();return e.length>0&&(match=_.find(i,function(i){return ATUtilities.caseInsensitiveStartsWith(i,e)})),{match:match,list:i}},createValueList:function(){var e,i=this.model.get("template"),t=this.model.get("timeline").get("entities").models,n=this.inlineAddScopeField.values().suggestion,l=!1;return options=[],match=null,type=null,prop=null,"Color"===n&&(_.each(i.colors,function(e){options.push(e.name)}),l=!0),"Entity"===n&&(_.each(t,function(e){options.push(e.get("name"))}),options.push("None"),l=!0),"Tag"===n&&(e=this.model.get("tags"),_.each(e,function(e){options.push(e)}),l=!0),l||(_.each(i.types,function(e){e.name==n?type=e:_.find(e.roles,function(e){return e.name==n})&&(type=e)}),type&&(_.each(t,function(e){e.get("type")==type.name&&options.push(e.get("name"))}),options.push("None"),l=!0)),l||(prop=_.find(i.properties,function(e){return e.name==n}),prop&&("boolean"==prop.type?(options.push("Yes"),options.push("No"),l=!0):"list"==prop.type&&(_.each(prop.options,function(e){options.push(e.name)}),options.push("None"),l=!0))),options},lookupValue:function(e){var i=this.createValueList();return i.length?(e.length>0&&(match=_.find(i,function(i){return ATUtilities.caseInsensitiveStartsWith(i,e)})),{match:match,list:i}):{match:e,list:[e]}},addClicked:function(){var e=this.inlineAddScopeField.values().suggestion,i=this.inlineAddValueField.values().suggestion,t=this.chosenLogic+("NOT"==this.chosenNegate?" NOT":"");return this.inlineAddScopeField.isInputValid()&&this.inlineAddValueField.isInputValid()?(window.ApplicationInterface&&window.ApplicationInterface.addFilterItem(window.timelineDocumentId,e,i,t),this.removeFocus(),this.inlineAddScopeField.clear(),this.inlineAddValueField.clear(),this.logicOptionClick("AND"),this.negateOptionClick("HAS")):0==this.inlineAddScopeField.isInputValid()?this.inlineAddScopeField.focusClickHandler():0==this.inlineAddValueField.isInputValid()&&this.inlineAddValueField.focusClickHandler(),!1},removeItem:function(e){window.ApplicationInterface&&window.ApplicationInterface.removeFilterItemWithId(window.timelineDocumentId,e)},manageFilterClicked:function(){var e=this;if(this.manageFilterMenu){var i=$(".manageFilterIcon"),t=i.offset(),n=this.model.get("timeline").get("filters");t.bottom=t.top+i.innerHeight(),0==n.length?this.manageFilterMenu.setItemDisabled("save"):this.manageFilterMenu.setItemEnabled("save"),setTimeout(function(){e.manageFilterMenu.showContextMenu(t.left,t.bottom)})}else window.ApplicationInterface&&window.ApplicationInterface.manageFilters()},manageFilterMenuItemClick:function(e,i,t){var n=this.manageFilterMenu.getParentId(e),l=this.manageFilterMenu.getItemText(e);return"save"==e?(window.mainApp.showSaveFilterModal(),!1):(window.ApplicationInterface&&("load"==n?window.ApplicationInterface.loadSavedFilter(window.timelineDocumentId,l):"delete"==n&&window.ApplicationInterface.deleteSavedFilter(window.timelineDocumentId,l)),!1)},boundsForManageIcon:function(){var e=$(".manageFilterIcon"),i=null;return e&&(i=e[0].getBoundingClientRect()),i?i.left+" "+i.right+" "+i.bottom+" "+i.top:""},clearFilterClicked:function(){var e=this.model.get("timeline").get("filters");window.ApplicationInterface&&_.each(e,function(e){window.ApplicationInterface.removeFilterItemWithId(window.timelineDocumentId,e.uniqueId)})}});module.exports=ATFilterBarView;

},{"../../../lib/dhtmlxmenu":5,"../../utils/ATUtilities":51,"./ATAutoSuggestField":56,"./templates/filterBarItemsTemplate.html":149,"./templates/filterBarTemplate.html":150,"backbone":220,"d3":320,"jquery":331,"lodash":333}],80:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/findReplaceTemplate.html"),ATFindReplaceView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$earlyInputCatcher=$("#modalInputCatcher"),this.$findInput=$("#findInput"),this.$replaceInput=$("#replaceInput"),this.$eventTitles=$("#eventTitlesCheckbox"),this.$eventProperties=$("#eventPropertiesCheckbox"),this.$tags=$("#tagsCheckbox"),this.$entityNames=$("#entityNamesCheckbox"),this.$bookmarks=$("#bookmarksCheckbox"),this.$submitButton=$("#findReplaceSubmit"),this.$eventTitles.prop("checked",!0),this.$eventProperties.prop("checked",!0),this.$tags.prop("checked",!0),this.$entityNames.prop("checked",!0),this.$bookmarks.prop("checked",!0),$("#findReplaceForm").on("submit",this.okClickHandler.bind(this)),$("#findReplaceCancel").on("click",this.cancelClickHandler.bind(this)),this.$findInput.on("input",this.validate.bind(this)),this.$replaceInput.on("input",this.validate.bind(this)),this.$eventTitles.on("click",this.validate.bind(this)),this.$eventProperties.on("click",this.validate.bind(this)),this.$tags.on("click",this.validate.bind(this)),this.$entityNames.on("click",this.validate.bind(this)),this.$bookmarks.on("click",this.validate.bind(this))},resetForm:function(){this.$findInput.val(""),this.$replaceInput.val(""),this.$submitButton.prop("disabled",!0),this.$earlyInputCatcher.addClass("activeCatcher").val("").focus(),window.setTimeout(this.focusAndSelectFieldIfUnfocused.bind(this),500)},focusAndSelectFieldIfUnfocused:function(){var e=this.$earlyInputCatcher.val(),t=e.length;this.$findInput.val(e),this.$findInput.focus(),this.$findInput[0].setSelectionRange(t,t),this.$earlyInputCatcher.removeClass("activeCatcher")},validate:function(){var e=this.$findInput.val(),t=this.$replaceInput.val(),i=this.$eventTitles.prop("checked"),n=this.$eventProperties.prop("checked"),s=this.$tags.prop("checked"),a=this.$entityNames.prop("checked"),c=this.$bookmarks.prop("checked"),h=!1;e&&t&&(i||n||s||a||c)&&(h=!0),this.$submitButton.prop("disabled",!h)},cancelClickHandler:function(e){return window.mainApp.removeExistingModal(),e.preventDefault(),!1},okClickHandler:function(e){if(window.ApplicationInterface){var t=this.$findInput.val(),i=this.$replaceInput.val(),n=this.$eventTitles.prop("checked"),s=this.$eventProperties.prop("checked"),a=this.$tags.prop("checked"),c=this.$entityNames.prop("checked"),h=this.$bookmarks.prop("checked");t&&i&&(n||s||a||c||h)&&window.ApplicationInterface.findAndReplace(window.timelineDocumentId,t,i,n,s,a,c,h)}return window.mainApp.removeExistingModal(),e.preventDefault(),!1}});module.exports=ATFindReplaceView;

},{"./templates/findReplaceTemplate.html":151,"backbone":220,"d3":320,"jquery":331,"lodash":333}],81:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/iconContextMenuTemplate.html"),ATIconContextMenu=Backbone.View.extend({setOptions:function(t){console.log("ATIconContextMenu.setOptions(): printing opts"),console.dir(t),this.rawOptions=t.slice(),this.visibleOptions=this.rawOptions.slice(),this.selectedOption&&this.setValue(this.selectedOption.value)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.rawOptions,function(i){return i.value===t}),this.renderOptions()},getValue:function(){return this.selectedOption?this.selectedOption.value:null},initialize:function(){var t=this.$el.attr("id"),i=t+"-list",e=_.template(templateHtml),n=this;this.rawOptions=[],this.visibleOptions=this.rawOptions.slice(),this.allowNewItems=!0,this.createNewText="",this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.$el.html(e({elementName:t})),this.d3El=d3.select("#"+t),this.d3El.classed("iconContextMenu bselect-dropdown",!0).style("display","none"),this.$el.keydown(function(t){return n.divKeyDownHandler(t)}).on("focus",function(){n.focusHandler()}).on("blur",function(){n.blurHandler()}),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",i),this.$list=$("#"+i),this.$list.on("scroll",this.listScrollHandler.bind(this))},show:function(t,i,e){var n=t.offset(),s=(t.outerWidth(),t.outerHeight()),o=$(window).width(),l=$(window).height(),h=this.$el.width(),d=this.$el.height(),c=isNaN(i)||isNaN(e)?{left:Math.min(n.left,o-h-5),top:n.top+s}:{left:Math.min(n.left+i,o-h-5),top:n.top+e};this.highlightIndex=-1,this.renderOptions(),c.top+d>l-10?(this.d3El.style("left",c.left+"px"),this.d3El.style("bottom",l-c.top+4+"px"),this.d3El.style("top",null)):(this.d3El.style("left",c.left+"px"),this.d3El.style("top",c.top+"px"),this.d3El.style("bottom",null)),this.d3El.classed("open",!0),this.$el.slideDown(250),this.open=!0},hide:function(){this.$el.slideUp(250),this.d3El.classed("open",!1),this.open=!1},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id")+"-list";i.attr("id",function(t){return e+"-"+t.value}).classed("active",function(i){return!!t.selectedOption&&i.value===t.selectedOption.value}).classed("highlight",function(i,e){return e===t.highlightIndex}).select("span").html(function(t){return'<div class="roleDropdownIcon '+t.icon+'"><span>'+t.initial+"</span></div> "+t.label}),i.enter().append("li").attr("id",function(t){return e+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return!!t.selectedOption&&i.value===t.selectedOption.value}).classed("highlight",function(i,e){return e===t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}).append("span").html(function(t){return'<div class="roleDropdownIcon '+t.icon+'"><span>'+t.initial+"</span></div> "+t.label}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}),i.exit().remove()},optionClick:function(t){this.focusHasResumed=!0,this.selectedOption=_.find(this.visibleOptions,function(i){return i.value===t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.hide(),this.trigger("change")},divKeyDownHandler:function(t){var i=t.keyCode||t.which,e=!1;if(this.open)switch(i){case 9:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!1;break;case 13:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!0;break;case 27:this.open&&(this.hide(),e=!0);break;case 38:-1===this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,e=!0;break;case 40:-1===this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,e=!0}return this.renderOptions(),!e},focusHandler:function(){this.open&&(this.focusHasResumed=!0)},listScrollHandler:function(){this.open&&(this.focusHasResumed=!0)},blurHandler:function(){var t=this;this.focusHasResumed=!1,window.ATIconDropDownGlobalTimeout&&clearTimeout(window.ATIconDropDownGlobalTimeout),window.ATIconDropDownGlobalTimeout=setTimeout(function(){t.focusLost()},200)},focusLost:function(){this.focusHasResumed||this.hide(),this.focusHasResumed=!1,window.ATIconDropDownGlobalTimeout=null}});module.exports=ATIconContextMenu;

},{"./templates/iconContextMenuTemplate.html":152,"backbone":220,"d3":320,"jquery":331,"lodash":333}],82:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/importCsvTemplate.html"),firstPageHtml=require("./templates/importCsvFirstPageTemplate.html"),secondPageHtml=require("./templates/importCsvSecondPageTemplate.html"),ATImportCsvView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.page1Template=_.template(firstPageHtml),this.page2Template=_.template(secondPageHtml),this.page=1,this.importCsvColumns={headers:[],options:[]},this.d3El=d3.select("#"+t),this.d3El.html(e()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.d3ContentDiv=d3.select("#importCsvContent"),this.$cancelButton=$("#importCsvCancel"),this.$previousButton=$("#importCsvPrevious"),this.$nextButton=$("#importCsvNext"),$("#importCsvCancel").on("click",this.cancelBtnHandler.bind(this)),$("#importCsvPrevious").on("click",this.previousBtnHandler.bind(this)),$("#importCsvForm").on("submit",this.nextBtnHandler.bind(this)),this.renderPage1()},configureAsPage1:function(){this.page=1,this.renderPage1()},configureAsPage2:function(t,e){this.importCsvColumns.headers=t,this.page=2,this.renderPage2(e)},renderPage1:function(){1==this.page?(this.d3ContentDiv.html(this.page1Template()),this.$delimiterCommaInput=$("#importCsvDelimiterInputComma"),this.$headerRowInput=$("#importCsvHeaderRow"),this.$nextButton.attr("value","Next"),this.$previousButton.attr("disabled",!0),this.$nextButton.attr("disabled",!1),this.$internalDelimiterCommaInput=$("#importCsvInternalDelimiterInputComma"),this.$internalDelimiterPipeInput=$("#importCsvInternalDelimiterInputPipe"),this.$internalDelimiterEitherInput=$("#importCsvInternalDelimiterInputEither")):this.d3ContentDiv.html("An error has occurred")},renderPage2:function(t){var e=this,i=[],n=[];2==this.page?(_.each(t.properties,function(t){i.push(t.name)}),_.each(t.types,function(t){_.each(t.roles,function(t){n.push(t.name)})}),this.importCsvColumns.options=[],this.importCsvColumns.options.push("Ignore this column","Unique ID","Title","Start","Duration","End","Parent","Color","Tags","Links"),this.importCsvColumns.options=this.importCsvColumns.options.concat(i),this.importCsvColumns.options=this.importCsvColumns.options.concat(n),this.d3ContentDiv.html(this.page2Template(this.importCsvColumns)),this.columnDropdowns={},_.each(this.importCsvColumns.headers,function(t){e.columnDropdowns[t]=new ATDropdown({el:"#csvImportOption_"+t.replace(/\W/g,"_")}),e.columnDropdowns[t].setValue("Ignore this column"),e.listenTo(e.columnDropdowns[t],"change",e.validateForm.bind(e))}),this.$nextButton.attr("value","Import"),this.$previousButton.attr("disabled",!1),this.validateForm()):this.d3ContentDiv.html("An error has occurred")},validateForm:function(){var t=[],e=[],i=!1,n=!1,r=!0,o=!1,s=this;if(_.each(this.importCsvColumns.headers,function(a){var l=s.columnDropdowns[a].getValue();"Ignore this column"!==l&&(_.includes(t,l)&&(r=!1,o=!0,_.includes(e,l)||e.push(l)),t.push(l),"Title"===l&&(i=!0),"Start"===l&&(n=!0))}),i&&n||(r=!1),i)if(n)if(!0===o){for(var a="Error: Duplicate copies of: ",l=0;l<e.length;l++)l==e.length-1?a+='"'+e[l]+'".':a+='"'+e[l]+'", ';$("#errorFieldImportCsv").text(a)}else $("#errorFieldImportCsv").empty();else $("#errorFieldImportCsv").text("A column for Start Date must be selected.");else $("#errorFieldImportCsv").text("A column for Title must be selected.");return this.$nextButton.prop("disabled",!r),r},cancelBtnHandler:function(t){return window.mainApp.removeExistingModal(),t.preventDefault(),!1},previousBtnHandler:function(t){return this.page>1&&(this.page--,this.renderPage1()),t.preventDefault(),!1},nextBtnHandler:function(t){var e=this;if(1==this.page){if(window.ApplicationInterface){var i=this.$delimiterCommaInput.is(":checked"),n=this.$headerRowInput.is(":checked");window.ApplicationInterface.importCsvFirstModal(window.timelineDocumentId,i,n)}}else if(2==this.page){var r=[];if(!this.validateForm())return t.preventDefault(),!1;_.each(this.importCsvColumns.headers,function(t){var i=t,n=e.columnDropdowns[t].getValue();"Ignore this column"!=n&&r.push({header:i,option:n})});var o=JSON.stringify(r),s=this.$internalDelimiterCommaInput.is(":checked")||this.$internalDelimiterEitherInput.is(":checked"),a=this.$internalDelimiterPipeInput.is(":checked")||this.$internalDelimiterEitherInput.is(":checked");window.ApplicationInterface&&window.ApplicationInterface.importCsvSecondModal(window.timelineDocumentId,o,s,a),window.mainApp.removeExistingModal()}return t.preventDefault(),!1}});module.exports=ATImportCsvView;

},{"./ATDropdown":63,"./templates/importCsvFirstPageTemplate.html":153,"./templates/importCsvSecondPageTemplate.html":154,"./templates/importCsvTemplate.html":155,"backbone":220,"d3":320,"jquery":331,"lodash":333}],83:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATInspectorListView=require("./ATInspectorListView"),templateHtml=require("./templates/linkPageTemplate.html"),expressTemplateHtml=require("./templates/expressLinkPageTemplate.html"),addLinkHtml=require("./templates/addLinkTemplate.html"),ATInspectorLinkPageView=Backbone.View.extend({events:{},initialize:function(e){this.isExpressMode=e.isExpressMode,this.elementName=this.$el.attr("id"),this.isExpressMode?this.elTemplate=_.template(expressTemplateHtml):this.elTemplate=_.template(templateHtml),this.addLinkTemplate=_.template(addLinkHtml),this.d3El=d3.select("#"+this.elementName),this.editingLinkIndex=-1,this.listenTo(this.model,"change:eventData",this.render),this.renderTemplate()},renderTemplate:function(){var e=this,t=this.elementName+"-links",i=this.elementName+"-attachments",n=this.elementName+"-sync";this.d3El.html(this.elTemplate()),this.d3El.select("#inspectorRemoveImageButton").on("click",function(){e.model.get("eventData").enabled&&window.ApplicationInterface&&window.ApplicationInterface.selectedEventsRemoveImage(window.timelineDocumentId,e.currentEventIds.join())}),this.d3El.select("#inspectorAddImageButton").on("click",function(){var t=e.model.get("eventData");t.enabled&&!t.image&&window.ApplicationInterface&&window.ApplicationInterface.selectedEventsBrowseForImage(window.timelineDocumentId,e.currentEventIds.join())}),this.isExpressMode||(this.d3AttachmentsListElement=this.d3El.select(".attachments").attr("id",i),this.attachmentsListView=new ATInspectorListView({el:"#"+i}),this.attachmentsListView.setUseAttachmentTemplate(!0),this.attachmentsListView.setListId(0),this.attachmentsListView.setAddCallback(this.addAttachmentClicked.bind(this)),this.attachmentsListView.setRemoveCallback(this.removeAttachmentClicked.bind(this)),this.attachmentsListView.setQuicklookCallback(this.quicklookAttachmentClicked.bind(this)),this.attachmentsListView.setOpenCallback(this.openAttachmentClicked.bind(this)),this.d3LinksListElement=this.d3El.select(".links").attr("id",t),this.linksListView=new ATInspectorListView({el:"#"+t}),this.linksListView.setUseExternalLinkTemplate(!0),this.linksListView.setListId(0),this.linksListView.setAddCallback(this.addLinkClicked.bind(this)),this.linksListView.setEditCallback(this.editLinkClicked.bind(this)),this.linksListView.setRemoveCallback(this.removeLinkClicked.bind(this)),this.linksListView.setQuicklookCallback(this.quicklookLinkClicked.bind(this)),this.linksListView.setRevealCallback(this.revealLinkClicked.bind(this)),this.linksListView.setOpenCallback(this.openLinkClicked.bind(this)),this.d3SyncListElement=this.d3El.select(".sync").attr("id",n),this.syncListView=new ATInspectorListView({el:"#"+n}),this.syncListView.setUseSyncTemplate(!0),this.syncListView.setListId(0),this.syncListView.setRemoveCallback(this.removeSyncClicked.bind(this)),this.syncListView.setQuicklookCallback(this.quicklookSyncClicked.bind(this)),this.syncListView.setRevealCallback(this.revealSyncClicked.bind(this)),this.syncListView.setOpenCallback(this.openSyncClicked.bind(this)))},render:function(){var e=this.model.get("eventData"),t=e.externalLinks,i=e.attachments,n=e.image,s=[],o=e.syncItems,a=[],l=0;this.currentEventIds=e.eventIds,n?(this.d3El.select(".imageWell").style("display",null).classed("empty",!1).classed("showPrompt",!1).select("img").attr("src",n.thumbnailPath),this.d3El.select("#inspectorAddImageButton").style("display","none")):(this.d3El.select(".imageWell").style("display","none"),this.d3El.select("#inspectorAddImageButton").style("display",null),this.d3El.select("#inspectorAddImageButton").classed("disabled",!e.enabled)),this.isExpressMode||(_.each(i,function(e){s.push({id:l,title:e.description,extra:"",quicklookDisabled:!1,revealDisabled:!0,openDisabled:!1}),l++}),this.attachmentsListView.render(s),this.attachmentsListView.setDisabled(!e.enabled),s=[],l=0,_.each(t,function(e){s.push({id:l,title:e.description,extra:e.filepath,quicklookDisabled:!1,revealDisabled:e.isWebLink,openDisabled:!1}),l++}),this.linksListView.render(s),this.linksListView.setDisabled(!e.enabled),l=0,_.each(o,function(e){a.push({id:l,title:e.itemName,extra:e.projectName,removeDisabled:e.removeDisabled,quicklookPath:e.quicklookPath,quicklookDisabled:!1,revealPath:null,revealDisabled:!1,openPath:e.openPath,openDisabled:!1}),l++}),this.syncListView.render(a),this.syncListView.setDisabled(!e.enabled))},addLinkClicked:function(e,t){var i=this;this.removeExistingPopover(),this.sourceElement=t,t.popover({content:this.addLinkTemplate(),title:'<span>Add External Link</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),s=i.height(),o=312*window.mainApp.timelineView.physicalScaleFactor,a=n.offset();return a.top+o+50<s?"bottom":a.top-o-50>0?"top":a.left-50>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(t),this.adjustPopoverTabbing(),$("#addLink-delete").css("display","none"),$("#addLink-browse").on("click",function(){i.popoverBrowseClick()}),$("#addLink-form").on("submit",function(){return i.popoverSubmit(),!1}),$("#popoverClose").on("click",function(){i.removeExistingPopover()})},showPopover:function(e){var t=this;this.sourceElement=e,this.$backdrop=$('<div class="backdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){t.removeExistingPopover()}),e.popover("show")},adjustPopoverTabbing:function(){var e=this,t=$(".popover").find("select, input, textarea, button, div.bselect");t.first().focus(),t.on("keydown",function(t){var i=t.keycode||t.which;9===i?e.tabNext(t):27===i&&(e.removeExistingPopover(),t.preventDefault())})},tabNext:function(e){var t=$(".popover").find('.pure-modal-field > select, .pure-modal-field > input[type="text"], .pure-modal-field > textarea, .pure-modal-field > div.bselect').filter(":visible"),i=_.indexOf(t,e.target);-1===i?(e.preventDefault(),t.first().focus()):!e.shiftKey&&i>=t.length-1?(e.preventDefault(),t.first().focus()):e.shiftKey&&0===i&&(e.preventDefault(),t.last().focus())},popoverBrowseClick:function(){this.removeExistingPopover(),window.ApplicationInterface&&window.ApplicationInterface.selectedEventsBrowseExternalLink(window.timelineDocumentId,this.currentEventIds.join())},popoverSubmit:function(){var e=$("#addLinkPath").val(),t=this.model.get("eventData").externalLinks,i=$("#addLinkDescription").val();return e?(""===i&&(i=e),window.ApplicationInterface&&this.editingLinkIndex>=0&&this.editingLinkIndex<t.length&&e?window.ApplicationInterface.selectedEventsEditExternalLink(window.timelineDocumentId,this.currentEventIds.join(),t[this.editingLinkIndex].linkId,e,i):window.ApplicationInterface&&e&&window.ApplicationInterface.selectedEventsAddExternalLink(window.timelineDocumentId,this.currentEventIds.join(),e,i),this.removeExistingPopover(),!1):(this.removeExistingPopover(),!1)},editLinkClicked:function(e,t,i){var n=this,s=this.model.get("eventData").externalLinks[t];this.removeExistingPopover(),this.editingLinkIndex=t,this.sourceElement=i,i.popover({content:this.addLinkTemplate(),title:'<span>Add External Link</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),s=i.height(),o=312*window.mainApp.timelineView.physicalScaleFactor,a=n.offset();return a.top+o+50<s?"bottom":a.top-o-50>0?"top":a.left-50>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(i),this.adjustPopoverTabbing(),$("#addLinkPath").val(s.filepath),$("#addLinkDescription").val(s.description),$("#addLink-browse").on("click",function(){n.popoverBrowseClick()}),$("#addLink-delete").on("click",function(){return n.removeLinkClicked(e,t,i),!1}),$("#addLink-form").on("submit",function(){return n.popoverSubmit(),!1}),$("#popoverClose").on("click",function(){n.removeExistingPopover()})},removeLinkClicked:function(e,t,i){var n=this.model.get("eventData").externalLinks;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.selectedEventsRemoveExternalLink(window.timelineDocumentId,this.currentEventIds.join(),n[t].linkId),this.removeExistingPopover()},quicklookLinkClicked:function(e,t,i){var n=this.model.get("eventData").externalLinks;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(n),t)},revealLinkClicked:function(e,t,i){var n=this.model.get("eventData").externalLinks;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.revealExternalLink(window.timelineDocumentId,n[t].filepath)},openLinkClicked:function(e,t,i){var n=this.model.get("eventData").externalLinks;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.openExternalLink(window.timelineDocumentId,n[t].filepath,n[t].isWebLink)},removeSyncClicked:function(e,t,i){var n=this.model.get("eventData").syncItems;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.selectedEventsRemoveSyncLinkForProject(window.timelineDocumentId,this.currentEventIds.join(),n[t].projectSyncId)},quicklookSyncClicked:function(e,t,i){var n=this.model.get("eventData").syncItems;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.quicklookSingleFile(window.timelineDocumentId,n[t].quicklookPath,"")},revealSyncClicked:function(e,t,i){},openSyncClicked:function(e,t,i){var n=this.model.get("eventData").syncItems;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.openExternalLink(window.timelineDocumentId,n[t].openPath,!0)},addAttachmentClicked:function(){window.ApplicationInterface&&window.ApplicationInterface.selectedEventsBrowseForAttachment(window.timelineDocumentId,this.currentEventIds.join())},removeAttachmentClicked:function(e,t,i){var n=this.model.get("eventData").attachments;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.selectedEventsRemoveAttachment(window.timelineDocumentId,this.currentEventIds.join(),n[t].linkId),this.removeExistingPopover()},quicklookAttachmentClicked:function(e,t,i){var n=this.model.get("eventData").attachments;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(n),t)},openAttachmentClicked:function(e,t,i){var n=this.model.get("eventData").attachments;window.ApplicationInterface&&t>=0&&t<n.length&&window.ApplicationInterface.openExternalLink(window.timelineDocumentId,n[t].filepath,!1)},removeExistingPopover:function(){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&this.$backdrop.remove(),this.editingLinkIndex=-1}});module.exports=ATInspectorLinkPageView;

},{"./ATInspectorListView":84,"./templates/addLinkTemplate.html":106,"./templates/expressLinkPageTemplate.html":143,"./templates/linkPageTemplate.html":157,"backbone":220,"d3":320,"jquery":331,"lodash":333}],84:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/listTemplate.html"),displayOnlyTemplateHtml=require("./templates/listDisplayOnlyTemplate.html"),attachmentTemplateHtml=require("./templates/attachmentListTemplate.html"),linkTemplateHtml=require("./templates/externalLinkListTemplate.html"),syncTemplateHtml=require("./templates/syncLinkListTemplate.html"),bootstrap=require("bootstrap"),ATInspectorListView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.attachmentTemplate=_.template(attachmentTemplateHtml),this.linkTemplate=_.template(linkTemplateHtml),this.syncTemplate=_.template(syncTemplateHtml),this.displayOnlyTemplate=_.template(displayOnlyTemplateHtml),this.useTemplate=this.elTemplate,this.titleClickCallback=null,this.d3El=d3.select("#"+this.elementName),this.useExternalLinkTemplate=!1,this.render([])},setUseRegularTemplate:function(){this.useTemplate=this.elTemplate},setUseExternalLinkTemplate:function(){this.useTemplate=this.linkTemplate},setUseAttachmentTemplate:function(){this.useTemplate=this.attachmentTemplate},setUseSyncTemplate:function(){this.useTemplate=this.syncTemplate},setUseDisplayOnlyTemplate:function(){this.useTemplate=this.displayOnlyTemplate},setTitleClickCallback:function(e){this.titleClickCallback=e},render:function(e){var t=this;this.d3El.html(this.useTemplate({items:e})),this.d3El.select(".addButton").attr("id",this.elementName+"-add").on("click",function(){t.addClick()}),_.each(e,function(e){var l=t.elementName+"-item"+e.id;t.d3El.select(".remove-"+e.id).attr("id",l+"-remove").on("click",function(){t.removeClick(e.id)}),t.d3El.select(".edit-"+e.id).attr("id",l+"-edit").on("click",function(){t.editClick(e.id)}),t.d3El.select(".quicklook-"+e.id).attr("id",l+"-quicklook").on("click",function(){t.quicklookClick(e.id)}),t.d3El.select(".reveal-"+e.id).attr("id",l+"-reveal").on("click",function(){t.revealClick(e.id)}),t.d3El.select(".open-"+e.id).attr("id",l+"-open").on("click",function(){t.openClick(e.id)}),t.d3El.select(".title-"+e.id).attr("id",l+"-title").classed("clickable",null!=t.titleClickCallback).on("click",function(){t.titleClick(e.id)})})},setDisabled:function(e){this.disabled=e,this.d3El.classed("disabled",e)},setListId:function(e){this.listId=e},setAddCallback:function(e){this.addCallback=e},setRemoveCallback:function(e){this.removeCallback=e},setEditCallback:function(e){this.editCallback=e},setQuicklookCallback:function(e){this.quicklookCallback=e},setRevealCallback:function(e){this.revealCallback=e},setOpenCallback:function(e){this.openCallback=e},addClick:function(){this.addCallback&&this.addCallback(this.listId,$("#"+this.elementName+"-add"))},removeClick:function(e){var t=this.elementName+"-item"+e+"-edit";this.removeCallback&&this.removeCallback(this.listId,e,$("#"+t))},editClick:function(e){var t=this.elementName+"-item"+e+"-edit";this.editCallback&&this.editCallback(this.listId,e,$("#"+t))},quicklookClick:function(e){var t=this.elementName+"-item"+e+"-quicklook";this.quicklookCallback&&this.quicklookCallback(this.listId,e,$("#"+t))},revealClick:function(e){var t=this.elementName+"-item"+e+"-reveal";this.revealCallback&&this.revealCallback(this.listId,e,$("#"+t))},openClick:function(e){var t=this.elementName+"-item"+e+"-open";this.openCallback&&this.openCallback(this.listId,e,$("#"+t))},titleClick:function(e){this.titleClickCallback&&this.titleClickCallback(e)}});module.exports=ATInspectorListView;

},{"./templates/attachmentListTemplate.html":108,"./templates/externalLinkListTemplate.html":148,"./templates/listDisplayOnlyTemplate.html":158,"./templates/listTemplate.html":159,"./templates/syncLinkListTemplate.html":174,"backbone":220,"bootstrap":222,"d3":320,"jquery":331,"lodash":333}],85:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/propertyPageTemplate.html"),expressTemplateHtml=require("./templates/expressPropertyPageTemplate.html"),ignore2=require("jquery-ui/autocomplete"),ignore=require("../../../lib/bootstrap-tokenfield"),ATInspectorPropertyPageView=Backbone.View.extend({events:{},initialize:function(e){var t=this.$el.attr("id"),i=this;this.isExpressMode=!!e.isExpressMode,this.isExpressMode?this.elTemplate=_.template(expressTemplateHtml):this.elTemplate=_.template(templateHtml),this.dropdowns={},this.d3El=d3.select("#"+t),this.listenTo(this.model,"change:template",function(){i.renderTemplate(),i.render()}),this.listenTo(this.model,"change:eventData",this.render),this.renderTemplate(),this.render()},renderTemplate:function(){var e=this,t=this.model.get("template").properties;this.$lastElement=null,this.$lastMultilineElement=null,this.$tagField&&(this.$tagField.tokenfield("destroy"),this.$tagField=null),this.$inputViews={},this.$checkboxes={},this.dropdowns={},this.d3El.html(this.elTemplate({properties:t})),this.isExpressMode||(this.$tagField=$("#inspectorTagsField"),this.$tagField.tokenfield({createTokensOnBlur:!0}),this.$tagField.on("tokenfield:createdtoken",this.addTagHandler.bind(this)),this.$tagField.on("tokenfield:removedtoken",this.removeTagHandler.bind(this)),this.$tagField.on("tokenfield:editedtoken",this.editTagHandler.bind(this))),_.each(t,function(t){var i="inspector-property-"+t.propertyId,n=$("#"+i);if("string"==t.type||"text"==t.type||"number"==t.type||"decimal"==t.type||"percentage"==t.type||"currency"==t.type||"multitext"==t.type||"richtext"==t.type)e.$inputViews[t.propertyId]=n,"multitext"!=t.type&&"richtext"!=t.type?n.blurOnEnter():e.$lastMultilineElement=n,n.on("input",function(){e.inputHandler(t.propertyId)}),n.on("blur",function(){e.blurHandler(t.propertyId)});else if("boolean"==t.type)e.$checkboxes[t.propertyId]=n,n.on("change",function(){e.changeHandler(t.propertyId)});else if("list"==t.type){e.dropdowns[t.propertyId]=new ATDropdown({el:"#"+i}),e.listenTo(e.dropdowns[t.propertyId],"change",function(){e.selectChangeHandler(t.propertyId)});var r=[{name:"None",value:""}];_.each(t.options,function(e){r.push({name:e.name,value:e.uuid})}),e.dropdowns[t.propertyId].setOptions(r)}e.$lastElement=n}),this.resizeMultilineElement()},resizeMultilineElement:function(){if(!this.isExpressMode&&this.$lastMultilineElement&&this.$lastElement){var e=this.$el.parent(),t=this.$lastElement.parent().parent(),i=e.offset().top+e.height(),n=this.$lastMultilineElement.height(),r=t.offset(),s=n+i-(r?r.top+t.height():i)-10,l=Math.max(s,120);this.$lastMultilineElement.css("min-height",l)}},render:function(){var e=this,t=this.model.get("eventData"),i=this.model.get("tags"),n=t.values?t.values:{};this.currentEventIds=t.eventIds,this.insideRender=!0,this.isExpressMode||(this.$tagField.tokenfield("setTokens",t.tags?t.tags:[]),this.$tagField.data("bs.tokenfield").$input.autocomplete({source:i||[]})),_.each(this.$inputViews,function(i,r){var s=!!t.allowEditProperty&&t.allowEditProperty[r];if(n[r]){var l=e.model.get("template").properties,o="unknown";_.each(l,function(e){e.propertyId==r&&(o=e.type)}),"number"==o?i.val(parseInt(n[r].value)):"currency"==o?i.val(parseFloat(n[r].value).toFixed(2)):"percentage"==o?i.val(parseInt(n[r].value)):i.val(n[r].value)}else i.val("");i.prop("disabled",!t.enabled||!s)}),_.each(this.$checkboxes,function(e,i){var r=!!t.allowEditProperty&&t.allowEditProperty[i];n[i]&&1==n[i].value?e.prop("checked",!0):e.prop("checked",!1),e.prop("disabled",!t.enabled||!r)}),_.each(this.dropdowns,function(e,i){n[i]&&n[i].value?e.setValue(n[i].value):e.setValue(""),e.setDisabled(!t.enabled)}),this.isExpressMode||(t.enabled?this.$tagField.tokenfield("enable"):this.$tagField.tokenfield("disable")),this.resizeMultilineElement(),this.insideRender=!1},changeHandler:function(e){if(this.$checkboxes[e]&&window.ApplicationInterface){var t=this.$checkboxes[e].is(":checked");window.ApplicationInterface.selectedEventsValueChanged(window.timelineDocumentId,this.currentEventIds.join(),t?"1":"0",e)}},inputHandler:function(e){this.$inputViews[e]&&(this.recordedInputPropertyId=e,this.recordedInputValue=this.$inputViews[e].val(),this.recordedInputEvents=this.currentEventIds)},blurHandler:function(e){null!==this.recordedInputValue&&void 0!==this.recordedInputValue&&e==this.recordedInputPropertyId&&this.$inputViews[e]&&window.ApplicationInterface&&window.ApplicationInterface.selectedEventsValueChanged(window.timelineDocumentId,this.recordedInputEvents.join(),this.recordedInputValue,e),this.recordedInputValue=null,this.recordedInputPropertyId=null},addTagHandler:function(e){this.insideRender||window.ApplicationInterface&&window.ApplicationInterface.selectedEventsAddTags(window.timelineDocumentId,this.currentEventIds.join(),e.attrs.value)},removeTagHandler:function(e){var t=this,i=e.attrs.length;this.insideRender||window.ApplicationInterface&&(i>1?_.each(e.attrs,function(e){window.ApplicationInterface.selectedEventsRemoveTag(window.timelineDocumentId,t.currentEventIds.join(),e.value)}):window.ApplicationInterface.selectedEventsRemoveTag(window.timelineDocumentId,this.currentEventIds.join(),e.attrs.value))},editTagHandler:function(e){this.insideRender||window.ApplicationInterface&&window.ApplicationInterface.selectedEventsRemoveTag(window.timelineDocumentId,this.currentEventIds.join(),e.attrs.value)},selectChangeHandler:function(e){var t=this.dropdowns[e].getValue();window.ApplicationInterface&&window.ApplicationInterface.selectedEventsValueChanged(window.timelineDocumentId,this.currentEventIds.join(),t,e)}});module.exports=ATInspectorPropertyPageView;

},{"../../../lib/bootstrap-tokenfield":3,"./ATDropdown":63,"./templates/expressPropertyPageTemplate.html":146,"./templates/propertyPageTemplate.html":166,"backbone":220,"d3":320,"jquery":331,"jquery-ui/autocomplete":326,"lodash":333}],86:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDatePicker=require("./ATDatePicker"),ATTimeSpan=require("../../model/ATTimeSpan"),ATDurationPicker=require("./ATDurationPicker"),ATDropdown=require("./ATDropdown"),ATRangeControlManager=require("./ATRangeControlManager"),ATInspectorListView=require("./ATInspectorListView"),ATSearchDropdown=require("./ATSearchDropdown"),templateHtml=require("./templates/rangePageTemplate.html"),addDependencyHtml=require("./templates/addDependencyTemplate.html"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),ATInspectorRangePageView=Backbone.View.extend({events:{},initialize:function(){this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.addDependencyTemplate=_.template(addDependencyHtml),this.rangePropertyId=-1,this.d3El=d3.select("#"+this.elementName),this.listenTo(this.model,"change:template",this.renderTemplate),this.listenTo(this.model,"change:eventData",this.clearBlockedDependencyList),this.listenTo(this.model,"change:eventData",this.render),this.blockedDependencies=null,this.renderTemplate()},setRangeId:function(e){this.rangePropertyId=e},setRangeConversion:function(e){this.rangeConversion=e,this.rangeControlManager&&this.rangeControlManager.setRangeConversion(e)},renderTemplate:function(){var e=this,t=this.elementName+"-predecessor",i=this.elementName+"-startDate",n=this.elementName+"-duration",s=this.elementName+"-endDate",o=this.elementName+"-successor";this.d3El.html(this.elTemplate({})),this.d3StartDate=this.d3El.select(".startDate").attr("id",i),this.startDatePickerView=new ATDatePicker({el:"#"+i}),this.d3EndDate=this.d3El.select(".endDate").attr("id",s),this.endDatePickerView=new ATDatePicker({el:"#"+s}),this.d3Duration=this.d3El.select(".duration").attr("id",n),this.durationPickerView=new ATDurationPicker({el:"#"+n}),this.rangeControlManager=new ATRangeControlManager(this.startDatePickerView,this.durationPickerView,this.endDatePickerView),this.rangeControlManager.setRangeConversion(this.rangeConversion),this.rangeControlManager.setStartChangeCallback(function(t,i){e.startChangeHandler(t,i,e.handlerEventIds)}),this.rangeControlManager.setEndChangeCallback(function(t,i){e.endChangeHandler(t,i,e.handlerEventIds)}),this.rangeControlManager.setDurationChangeCallback(function(t){e.durationChangeHandler(t,e.handlerEventIds)}),this.startDatePickerView.setAllowEmptyValues(!1),this.endDatePickerView.setAllowEmptyValues(!1),this.startDatePickerView.setResetCallback(function(){window.setTimeout(e.resetStartDateField.bind(e),0)}),this.endDatePickerView.setResetCallback(function(){window.setTimeout(e.resetEndDateField.bind(e),0)}),this.d3predecessorList=this.d3El.select(".basedOn").attr("id",t),this.predecessorListView=new ATInspectorListView({el:"#"+t}),this.d3successorList=this.d3El.select(".successor").attr("id",o),this.successorListView=new ATInspectorListView({el:"#"+o}),this.predecessorListView.setListId(this.rangePropertyId),this.predecessorListView.setAddCallback(this.addPredecessorClicked.bind(this)),this.predecessorListView.setEditCallback(this.editPredecessorClicked.bind(this)),this.predecessorListView.setRemoveCallback(this.removePredecessorClicked.bind(this)),this.predecessorListView.setTitleClickCallback(this.goToPredecessorClicked.bind(this)),this.successorListView.setListId(this.rangePropertyId),this.successorListView.setAddCallback(this.addSuccessorClicked.bind(this)),this.successorListView.setEditCallback(this.editSuccessorClicked.bind(this)),this.successorListView.setRemoveCallback(this.removeSuccessorClicked.bind(this)),this.successorListView.setTitleClickCallback(this.goToSuccessorClicked.bind(this)),this.successorListView.setUseDisplayOnlyTemplate()},render:function(){var e=this,t=this.model.get("eventData"),i=t.rangeValues?t.rangeValues[this.rangePropertyId]:null,n=[],s=[],o=i?i.position:{value:null,precision:null},r=i?i.endPosition:{value:null,precision:null},d=i?i.span:"",a=t.allowEditStart&&t.enabled,c=t.allowEditDuration&&t.enabled,l=t.allowAddPredecessor&&t.enabled;this.handlerEventIds=t.eventIds,this.startDatePickerView.commit(),this.endDatePickerView.commit(),this.durationPickerView.commit(),this.currentEventIds=t.eventIds,i&&(_.each(i.predecessors,function(t){var i;i="date"===e.rangeConversion.type?ATTimeSpan.fromComponents(t.offset).toString():t.offset.length?t.offset[0].value:"0",n.push({actionIcon:"pencil-square-o",id:t.predecessorId,title:t.predecessorTitle,extra:i+" from "+(t.addToEnd?"end":"start")})}),_.each(i.successors,function(t){var i;i="date"===e.rangeConversion.type?ATTimeSpan.fromComponents(t.offset).toString():t.offset.length?t.offset[0].value:"0",s.push({actionIcon:null,id:t.successorId,title:t.successorTitle,extra:i+" from "+(t.addToEnd?"end":"start")})})),this.predecessorListView.render(n),this.successorListView.render(s),this.startDatePickerView.setTimestamp(o.value,o.precision),this.endDatePickerView.setTimestamp(r.value,r.precision),this.durationPickerView.setDurationComponents(d),this.rangeControlManager.updateEndPicker(),this.durationPickerView.setDisabled(!c),this.startDatePickerView.setDisabled(!a),this.endDatePickerView.setDisabled(!c),this.predecessorListView.setDisabled(!l),this.successorListView.setDisabled(!l)},resetStartDateField:function(){var e=this.model.get("eventData"),t=e.rangeValues?e.rangeValues[this.rangePropertyId]:null,i=t?t.position:{value:null,precision:null};this.startDatePickerView.setTimestamp(i.value,i.precision),this.rangeControlManager.updateEndPicker()},resetEndDateField:function(){var e=this.model.get("eventData"),t=e.rangeValues?e.rangeValues[this.rangePropertyId]:null,i=t?t.endPosition:{value:null,precision:null};this.endDatePickerView.setTimestamp(i.value,i.precision),this.rangeControlManager.updateSpan()},startChangeHandler:function(e,t,i){var n=String(e);this.startDatePickerView.getValid()&&window.ApplicationInterface&&i&&i.length&&window.ApplicationInterface.selectedEventsRangePositionChanged(window.timelineDocumentId,i.join(),n,t,this.rangePropertyId)},endChangeHandler:function(e,t,i){var n=String(e);this.endDatePickerView.getValid()&&window.ApplicationInterface&&i&&i.length&&window.ApplicationInterface.selectedEventsRangeEndPositionChanged(window.timelineDocumentId,i.join(),n,t,this.rangePropertyId)},durationChangeHandler:function(e,t){window.ApplicationInterface&&t&&t.length&&window.ApplicationInterface.selectedEventsRangeSpanChanged(window.timelineDocumentId,t.join(),e,this.rangePropertyId)},addPredecessorClicked:function(e,t){this.editingPredecessor=!0,this.editingSuccessor=!1,this.addClicked(e,t)},addSuccessorClicked:function(e,t){this.editingPredecessor=!1,this.editingSuccessor=!0,this.addClicked(e,t)},addClicked:function(e,t){var i=this;this.editingRelationshipWithEventId=null,this.removeExistingPopover(),t.popover({content:this.addDependencyTemplate(),title:"<span>Add "+(this.editingPredecessor?"Predecessor":"Successor")+'</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),s=i.height(),o=312*window.mainApp.timelineView.physicalScaleFactor,r=n.offset();return r.top+o+50<s?"bottom":r.top-o-50>0?"top":r.left-50>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(t),this.eventSearchDropdown=new ATSearchDropdown({el:"#addDependencyEvent"}),this.eventSearchDropdown.setSearchWordByWord(!0),this.updateEventSearchDropdown(),this.fromDropdown=new ATDropdown({el:"#addDependency-from"}),"date"===this.rangeConversion.type?$("#addDependency-offset").val("0 seconds"):$("#addDependency-offset").val("0"),this.dependencyOffsetPickerView=new ATDurationPicker({el:"#addDependency-offset"}),this.dependencyOffsetPickerView.setRangeConversion(this.rangeConversion),this.adjustPopoverTabbing(),$("#addDependency-delete").css("display","none"),$("#addDependency-form").on("submit",function(){return i.popoverSubmitClick(),!1}),$("#popoverClose").on("click",function(){i.removeExistingPopover()})},editPredecessorClicked:function(e,t,i){this.editingPredecessor=!0,this.editingSuccessor=!1,this.editClicked(e,t,i)},editSuccessorClicked:function(e,t,i){this.editingPredecessor=!1,this.editingSuccessor=!0,this.editClicked(e,t,i)},editClicked:function(e,t,i){var n=this,s=this.model.get("eventData"),o=s.rangeValues?s.rangeValues[this.rangePropertyId]:null,r=this.editingPredecessor?o.predecessors:o.successors,d=this.editingPredecessor?"predecessorId":"successorId",a=!0,c=null;_.each(r,function(e){e[d]===t&&(a=e.addToEnd,c="date"===n.rangeConversion.type?ATTimeSpan.fromComponents(e.offset):e.offset.length?e.offset[0].value:0)}),this.removeExistingPopover(),this.editingRelationshipWithEventId=t,i.popover({content:this.addDependencyTemplate(),title:"<span>Edit "+(this.editingPredecessor?"Predecessor":"Successor")+'</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:function(e,t){var i=$(window),n=$(t),s=i.height(),o=312*window.mainApp.timelineView.physicalScaleFactor,r=n.offset();return r.top+o+50<s?"bottom":r.top-o-50>0?"top":r.left-50>0?"left":"right"},trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(i),this.eventSearchDropdown=new ATSearchDropdown({el:"#addDependencyEvent"}),this.eventSearchDropdown.setSearchWordByWord(!0),this.updateEventSearchDropdown(t),this.eventSearchDropdown.setValue(t),this.fromDropdown=new ATDropdown({el:"#addDependency-from"}),this.fromDropdown.setValue(a?0:1),this.dependencyOffsetPickerView=new ATDurationPicker({el:"#addDependency-offset"}),this.dependencyOffsetPickerView.setRangeConversion(this.rangeConversion),this.dependencyOffsetPickerView.setValue(c),$("#addDependency-delete").on("click",function(){return n.editingPredecessor?n.removePredecessorClicked(e,t,i):n.removeSuccessorClicked(e,t,i),!1}),this.adjustPopoverTabbing(),$("#addDependency-form").on("submit",function(){return n.popoverSubmitClick(),!1}),$("#popoverClose").on("click",function(){n.removeExistingPopover()})},addChildrenOfEventsToArray:function(e,t){var i=this;_.each(t,function(t){t.children.each(function(t){e.push(t),i.addChildrenOfEventsToArray(e,[t])})})},adjustPopoverTabbing:function(){var e=this,t=$(".popover").find("select, input, textarea, button, div.bselect");t.first().focus(),t.on("keydown",function(t){var i=t.keycode||t.which;9===i?e.tabNext(t):27===i&&(e.removeExistingPopover(),t.preventDefault())})},tabNext:function(e){var t=$(".popover").find('.pure-modal-field > select, .pure-modal-field > input[type="text"], .pure-modal-field > textarea, .pure-modal-field > div.bselect').filter(":visible"),i=_.indexOf(t,e.target);-1===i?(e.preventDefault(),t.first().focus()):!e.shiftKey&&i>=t.length-1?(e.preventDefault(),t.first().focus()):e.shiftKey&&0===i&&(e.preventDefault(),t.last().focus())},showPopover:function(e){var t=this;this.sourceElement=e,this.$backdrop=$('<div class="backdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){t.removeExistingPopover()}),e.popover("show")},popoverSubmitClick:function(){var e=this.eventSearchDropdown.getValue(),t=$("#addDependency-offset").val(),i=1===parseInt(this.fromDropdown.getValue());window.ApplicationInterface&&e&&(this.editingPredecessor?this.editingRelationshipWithEventId?window.ApplicationInterface.selectedEventsEditPredecessor(window.timelineDocumentId,this.currentEventIds.join(),this.editingRelationshipWithEventId,e,t,i,this.rangePropertyId):window.ApplicationInterface.selectedEventsAddPredecessor(window.timelineDocumentId,this.currentEventIds.join(),e,t,i,this.rangePropertyId):this.editingRelationshipWithEventId?window.ApplicationInterface.selectedEventsEditSuccessor(window.timelineDocumentId,this.currentEventIds.join(),this.editingRelationshipWithEventId,e,t,i,this.rangePropertyId):window.ApplicationInterface.selectedEventsAddSuccessor(window.timelineDocumentId,this.currentEventIds.join(),e,t,i,this.rangePropertyId)),this.removeExistingPopover()},updateEventSearchDropdown:function(e){var t=this,i=this.model.get("timeline").get("events").models,n=this.model.get("eventData").eventIds,s=this.fullAncestryList(n),o=_.union(n,s),r=_.clone(i),d=[];this.blockedDependencies||this.buildBlockedDependencyList(),_.each(r,function(i){(!_.includes(o,i.id)&&t.validateDependencyLoop(o,i.id)||i.id===e)&&d.push({value:i.id,sortValue:i.get("displayId"),label:i.get("displayId")+". "+i.get("title")}),t.addChildrenOfEventsToOptions(d,i,o,e)}),d.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),s=Math.min(i.length,n.length),o=0;for(o=0;o<s;o++)if(i[o]!==n[o])return i[o]-n[o];return i.length-n.length}),this.eventSearchDropdown.setOptions(d)},addChildrenOfEventsToOptions:function(e,t,i,n){var s=this;t.children.each(function(t){(!_.includes(i,t.id)&&s.validateDependencyLoop(i,t.id)||t.id===n)&&e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),s.addChildrenOfEventsToOptions(e,t,i,n)})},clearBlockedDependencyList:function(){this.blockedDependencies=null},buildBlockedDependencyList:function(){var e=this,t=this.model.get("timeline").get("events"),i=this.model.get("eventData").eventIds,n=this.fullAncestryList(i),s=_.union(i,n),o=[];this.blockedDependencies=_.clone(s),_.each(s,function(i){e.addSuccessorsToBlockedDependenciesList(t,i,o)}),_.each(i,function(i){var n=t.findChild(i),s=_.map(_.keys(n.get("dependencies")),function(e){return parseInt(e)});e.blockedDependencies=_.union(e.blockedDependencies,s)}),this.blockedDependencies=_.uniq(this.blockedDependencies)},addSuccessorsToBlockedDependenciesList:function(e,t,i){var n,s,o,r=this;_.indexOf(i,t)>=0||(i.push(t),n=e.findChild(t).get("successors"),s=this.fullAncestryList(n),o=_.union(n,s),this.blockedDependencies=_.union(this.blockedDependencies,o),_.each(o,function(t){r.addSuccessorsToBlockedDependenciesList(e,t,i)}))},validateDependencyLoop:function(e,t){return!_.includes(this.blockedDependencies,t)},fullAncestryList:function(e){var t=this,i=this.model.get("timeline").get("events"),n=[];return _.each(e,function(e){t.addAncestorsOfEventToList(i,e,n)}),n},addAncestorsOfEventToList:function(e,t,i){var n=e.findChild(t).get("parentId");n!==ATEmptyGuidString&&(i.push(n),this.addAncestorsOfEventToList(e,n,i))},removePredecessorClicked:function(e,t,i){window.ApplicationInterface&&t&&window.ApplicationInterface.selectedEventsRemovePredecessor(window.timelineDocumentId,this.currentEventIds.join(),t,this.rangePropertyId),this.removeExistingPopover()},removeSuccessorClicked:function(e,t,i){window.ApplicationInterface&&t&&window.ApplicationInterface.selectedEventsRemoveSuccessor(window.timelineDocumentId,this.currentEventIds.join(),t,this.rangePropertyId),this.removeExistingPopover()},goToPredecessorClicked:function(e){window.mainApp.timeline.clearSelection(!0),window.mainApp.timeline.selectEventWithID(e),window.mainApp.timelineView.revealChildNode(e)},goToSuccessorClicked:function(e){window.mainApp.timeline.clearSelection(!0),window.mainApp.timeline.selectEventWithID(e),window.mainApp.timelineView.revealChildNode(e)},removeExistingPopover:function(){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&this.$backdrop.remove(),this.editingRelationshipWithEventId=null}});module.exports=ATInspectorRangePageView;

},{"../../model/ATEmptyGuidString":26,"../../model/ATTimeSpan":39,"./ATDatePicker":60,"./ATDropdown":63,"./ATDurationPicker":64,"./ATInspectorListView":84,"./ATRangeControlManager":93,"./ATSearchDropdown":95,"./templates/addDependencyTemplate.html":102,"./templates/rangePageTemplate.html":167,"backbone":220,"d3":320,"jquery":331,"lodash":333}],87:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATInspectorListView=require("./ATInspectorListView"),ATSearchableContextMenu=require("./ATSearchableContextMenu"),ATDropdown=require("./ATDropdown"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/rolePageTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),addRoleHtml=require("./templates/addRoleTemplate.html"),bootstrap=require("bootstrap"),ATInspectorRolePageView=Backbone.View.extend({events:{},initialize:function(e){this.isExpressMode=!!e.isExpressMode,this.elementName=this.$el.attr("id"),this.elTemplate=_.template(templateHtml),this.optionsTemplate=_.template(optionsHtml),this.addRoleTemplate=_.template(addRoleHtml),this.d3Elements={},this.listViews={},this.dropdowns={},this.d3El=d3.select("#"+this.elementName),this.listenTo(this.model,"change:template",this.renderTemplate),this.listenTo(this.model,"change:entitiesByType",this.renderEntities),this.listenTo(this.model,"change:eventData",this.render),this.renderTemplate()},renderTemplate:function(){var e=this,t=[];this.d3Elements={},this.listViews={},this.dropdowns={},_.each(this.model.get("template").types,function(e){_.each(e.roles,function(e){e.roleId||(e.roleId=e.id),t.push(e)})}),this.d3El.html(this.elTemplate({roles:t})),this.entitySearchContextMenu=new ATSearchableContextMenu({el:"#inspectorRoleEntitySearch"}),this.listenTo(this.entitySearchContextMenu,"change",this.contextEntityClick.bind(this)),_.each(t,function(t){var i=e.elementName+"-"+t.roleId;e.d3Elements[t.roleId]=e.d3El.select(".role_"+t.roleId).attr("id",i),t.multiplePerEvent?(e.listViews[t.roleId]=new ATInspectorListView({el:"#"+i}),e.listViews[t.roleId].setListId(t.roleId),e.listViews[t.roleId].setAddCallback(e.addClicked.bind(e)),e.listViews[t.roleId].setEditCallback(e.editClicked.bind(e)),e.listViews[t.roleId].setRemoveCallback(e.removeClicked.bind(e))):(e.dropdowns[t.roleId]=new ATDropdown({el:"#"+i}),e.listenTo(e.dropdowns[t.roleId],"change",function(){e.selectChangeHandler(t.roleId)}))}),this.renderEntities()},renderEntities:function(){var e=this,t=this.model.get("template").types,i=this.model.get("entitiesByType");_.each(t,function(t){var n=i[t.name],o=this.isExpressMode?[]:[{name:"None",value:ATEmptyGuidString}];_.each(n,function(e){o.push({name:e.name,value:e.entityId})}),_.each(t.roles,function(t){t.multiplePerEvent||e.dropdowns[t.roleId].setOptions(o)})}),this.render()},render:function(){var e=this.model.get("eventData");this.model.get("template").types;this.currentEventIds=e.eventIds,_.each(this.listViews,function(t,i){var n=e.relationshipsPerRole?e.relationshipsPerRole[i]:[],o=[];_.each(n,function(e){o.push({actionIcon:null,id:e.entityId,title:e.entityName,extra:e.entityAge})}),t.render(o),t.setDisabled(!e.enabled)}),_.each(this.dropdowns,function(t,i){var n=e.relationshipsPerRole?e.relationshipsPerRole[i]:[];n&&n[0]?t.setValue(n[0].entityId):t.setValue(ATEmptyGuidString),t.setDisabled(!e.enabled)}),this.entitySearchContextMenu.hide()},addClicked:function(e,t){var i=this.model.get("template").types,n=_.find(i,function(t){return _.find(t.roles,function(t){return t.roleId==e})});_.find(n.roles,function(t){return t.roleId==e});this.sourceElement=t,this.editingRoleId=e,this.updateEntitySearchDropdown(e),this.entitySearchContextMenu.clearStr(),this.entitySearchContextMenu.show(t)},updateEntitySearchDropdown:function(e){var t=this.model.get("template").types,i=_.find(t,function(t){return _.find(t.roles,function(t){return t.roleId==e})}),n=(_.find(i.roles,function(t){return t.roleId==e}),this.model.get("entitiesByType")),o=this.model.get("eventData").relationshipsPerRole[e],s=_.reject(n[i.name],function(e){return _.find(o,function(t){return t.entityId==e.entityId})});options=[],_.each(s,function(e){options.push({value:e.entityId,label:e.name})}),this.entitySearchContextMenu.setOptions(options)},validateEntityName:function(e){var t=!1,i=this.model.get("entitiesByType");return _.each(i,function(i,n){null!=_.find(i,function(t){return t.name==e})&&(t=!0)}),_.each(["Event","Entity","Tag","Color","Parent","Link","Any","All","Timeline"],function(i){e==i&&(t=!0)}),!t},contextEntityClick:function(){var e=this.entitySearchContextMenu.getNewItemText(),t=this.entitySearchContextMenu.getValue();window.ApplicationInterface&&(t?window.ApplicationInterface.selectedEventsAddRelationship(window.timelineDocumentId,this.currentEventIds.join(),t,this.editingRoleId,1):e&&(this.validateEntityName(e)?window.ApplicationInterface.selectedEventsAddRelationshipToNewEntity(window.timelineDocumentId,this.currentEventIds.join(),e,this.editingRoleId,1):window.ApplicationInterface.showMessageDialog(window.timelineDocumentId,"Cannot create an entity with the name "+e+".")))},editClicked:function(e,t,i){},removeClicked:function(e,t,i){window.ApplicationInterface&&t&&window.ApplicationInterface.selectedEventsRemoveRelationship(window.timelineDocumentId,this.currentEventIds.join(),t)},selectChangeHandler:function(e){var t=this.dropdowns[e].getValue();window.ApplicationInterface&&window.ApplicationInterface.selectedEventsAddRelationship(window.timelineDocumentId,this.currentEventIds.join(),t,e,1)}});module.exports=ATInspectorRolePageView;

},{"../../model/ATEmptyGuidString":26,"./ATDropdown":63,"./ATInspectorListView":84,"./ATSearchableContextMenu":96,"./templates/addRoleTemplate.html":107,"./templates/optionsTemplate.html":164,"./templates/rolePageTemplate.html":169,"backbone":220,"bootstrap":222,"d3":320,"jquery":331,"lodash":333}],88:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATInspectorRangePageView=require("./ATInspectorRangePageView"),ATInspectorPropertyPageView=require("./ATInspectorPropertyPageView"),ATInspectorRolePageView=require("./ATInspectorRolePageView"),ATInspectorLinkPageView=require("./ATInspectorLinkPageView"),ATSearchDropdown=require("./ATSearchDropdown"),ATColorDropdown=require("./ATColorDropdown"),ATDropdown=require("./ATDropdown"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/inspectorTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),tabGroupHtml=require("./templates/tabGroupTemplate.html"),ATInspectorView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml),n=_.template(tabGroupHtml);this.minWidth=200,this.maxWidth=400,this.stackedWidth=280,this.currentWidthWhenOpen=350,this.optionsTemplate=_.template(optionsHtml),this.d3El=d3.select("#"+e),this.d3El.html(i({})),this.listenTo(this.model,"change:template",this.renderTemplate),this.listenTo(this.model,"change:eventData",this.render),this.listenTo(this.model,"change:timeline",this.updateParentDropdown),this.$headerText=$("#inspectorHeaderText"),this.$headerEventId=$("#inspectorHeaderEventID"),this.d3HeaderEventId=d3.select("#inspectorHeaderEventID"),this.$topBox=$("#inspectorTopBox"),this.$titleInput=$("#inspectorTitle"),$("#inspectorCloseArrow").on("click",function(){window.ApplicationInterface&&window.ApplicationInterface.closeInspector(window.timelineDocumentId)}),$("#inspectorForm").on("submit",function(){return!1}),this.colorDropdown=new ATColorDropdown({el:"#inspectorColor"}),this.colorDropdown.setNoOptionPlaceholder("No Color"),this.parentSearchDropdown=new ATSearchDropdown({el:"#inspectorParent"}),this.parentSearchDropdown.setNoOptionPlaceholder("No Parent"),this.parentSearchDropdown.setSearchWordByWord(!0),this.$titleInput.on("input",function(){t.titleInputHandler()}),this.$titleInput.blurOnEnter().on("blur",function(){t.titleBlurHandler()}),this.listenTo(this.colorDropdown,"change",function(){t.colorChangeHandler()}),this.listenTo(this.parentSearchDropdown,"change",function(){t.parentChangeHandler()}),this.d3TabGroup=this.d3El.select("#inspectorTabGroup"),this.tabs=[{index:0,name:"Range",icon:"flag"},{index:1,name:"Values",icon:"tags"},{index:2,name:"Roles",icon:"users"},{index:3,name:"Links",icon:"link"}],this.d3TabGroup.html(n({tabs:this.tabs})),this.$tabBar=$("#inspectorTabGroup .tabs"),this.d3TabContentGroup=this.d3TabGroup.select(".tabContentGroup"),_.each(this.tabs,function(e){e.button=t.d3El.select("#"+e.name+"-tab-button").on("click",function(){t.tabClicked(e.index)}),e.page=t.d3El.select("#"+e.name+"-page")}),this.rangePageView=new ATInspectorRangePageView({el:"#"+this.tabs[0].name+"-page",model:this.model}),this.propertyPageView=new ATInspectorPropertyPageView({el:"#"+this.tabs[1].name+"-page",model:this.model}),this.rolePageView=new ATInspectorRolePageView({el:"#"+this.tabs[2].name+"-page",model:this.model}),this.linkPageView=new ATInspectorLinkPageView({el:"#"+this.tabs[3].name+"-page",model:this.model}),this.resizeDrag=d3.behavior.drag().on("dragstart",this.resizeDragStarted.bind(this)).on("drag",this.resizeDragged.bind(this)).on("dragend",this.resizeDragEnded.bind(this)),d3.select("#inspectorResizeGrabber").call(this.resizeDrag),this.tabClicked(0),this.renderTemplate(),this.render(),this.updateParentDropdown(),window.addEventListener("resize",this.resize.bind(this),!1),this.resize()},resize:function(){var e=this.$el.innerWidth(),t=this.$el.innerHeight()-this.$topBox.outerHeight(),i=t-this.$tabBar.outerHeight(),n=window.mainApp&&window.mainApp.displaySettings?this.stackedWidth*window.mainApp.displaySettings.size/100:this.stackedWidth;this.d3El.classed("stacked",e<n),this.d3TabGroup.style("height",t+"px"),this.d3TabContentGroup.style("height",i+"px"),d3.selectAll(".tabcontent").style("min-height",i+"px"),this.propertyPageView.resizeMultilineElement()},renderTemplate:function(){var e=this.model.get("template"),t=e.colors;this.colorDropdown.setOptions(t),this.rangePageView.setRangeId(e.rangeProperties[0].rangePropertyId)},resizeDragStarted:function(e){},resizeDragged:function(e){var t,i=d3.event.sourceEvent.clientX;this.resizeDragStartX||(this.resizeDragStartX=i,this.resizeDragOriginalWidth=this.$el.innerWidth()),(t=this.resizeDragOriginalWidth+(this.resizeDragStartX-i))<this.minWidth?t=this.minWidth:t>this.maxWidth&&(t=this.maxWidth),this.currentWidthWhenOpen=t,window.mainApp.resizeInspector(t),window.ApplicationInterface&&window.ApplicationInterface.setInspectorWidth(window.timelineDocumentId,t)},resizeDragEnded:function(e){this.resizeDragStartX=null,this.originalWidth=null},setRangeConversion:function(e){this.rangePageView.setRangeConversion(e)},render:function(){var e,t,i,n=this,r=this.model.get("eventData"),s="Event:",o=[];if(this.currentEventIds=r.eventIds,r.eventIds)for(e=0;e<r.eventIds.length;e++)o.push({id:r.eventIds[e],displayId:r.displayEventIds[e]});o.sort(function(e,t){return e.displayIndex<t.displayIndex?-1:e.displayIndex==t.displayIndex?0:1}),this.commitTitle(),0==o.length?s="Events: None selected":o.length>1&&(s="Events:",o.length>5&&(s+=" (Multiple)",o=[])),(t=this.d3HeaderEventId.selectAll("span").data(o)).select("a").text(function(e){return e.displayId}),t.select("i").text(function(e,t){return t<o.length-1?", ":""}),(i=t.enter().append("span")).append("a").text(function(e){return e.displayId}).on("click",function(e){n.eventIdClicked(e.id)}),i.append("i").text(function(e,t){return t<o.length-1?", ":""}),t.exit().remove(),this.$headerText.text(s),this.$titleInput.val(r.title),this.colorDropdown.setValue(r.color),this.updateParentDropdown(),this.parentSearchDropdown.setValue(r.parentId),this.$titleInput.prop("disabled",!r.enabled),this.colorDropdown.setDisabled(!r.enabled),this.parentSearchDropdown.setDisabled(!r.enabled),this.setTitleFieldIsInvalid(!1)},updateParentDropdown:function(){var e=this,t=this.model.get("timeline").get("events").models,i=this.model.get("eventData").eventIds,n=[{value:ATEmptyGuidString,sortValue:"-1",label:"(No Parent)"}];_.each(t,function(t){_.includes(i,t.id)||(n.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),e.addChildrenOfEventsToOptions(n,t,i))},e),n.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),r=Math.min(i.length,n.length),s=0;for(s=0;s<r;s++)if(i[s]!=n[s])return i[s]-n[s];return i.length-n.length}),this.parentSearchDropdown.setOptions(n),this.parentSearchDropdown.setValue(this.model.get("eventData").parentId)},addChildrenOfEventsToOptions:function(e,t,i){var n=this;t.children.each(function(t){_.includes(i,t.id)||(e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),n.addChildrenOfEventsToOptions(e,t,i))})},titleInputHandler:function(){this.recordedInputTitle=this.$titleInput.val(),this.recordedInputEvents=this.currentEventIds,this.setTitleFieldIsInvalid(!this.$titleInput.val())},setTitleFieldIsInvalid:function(e){this.$titleInput&&this.$titleInput[0].setCustomValidity(e?"Error":"")},titleBlurHandler:function(){var e=this.model.get("eventData");this.recordedInputTitle&&this.recordedInputEvents?window.ApplicationInterface&&window.ApplicationInterface.setSelectedEventsTitle(window.timelineDocumentId,this.recordedInputEvents.join(),this.recordedInputTitle):(this.$titleInput.val(e?e.title:""),this.setTitleFieldIsInvalid(!1)),this.recordedInputTitle=null,this.recordedInputEvents=null},commitTitle:function(){this.recordedInputTitle&&this.titleBlurHandler()},colorChangeHandler:function(){window.ApplicationInterface&&window.ApplicationInterface.setSelectedEventsColor(window.timelineDocumentId,this.currentEventIds.join(),this.colorDropdown.getValue())},parentChangeHandler:function(){var e=this.parentSearchDropdown.getValue(),t=this.currentEventIds.join();window.mainApp.showNewParentPromptIfNeeded(e,function(i){window.ApplicationInterface.setSelectedEventsParent(window.timelineDocumentId,t,e,i)})},tabClicked:function(e){var t=0;for(t=0;t<this.tabs.length;t++)this.tabs[t].button.classed("selected",t==e),this.tabs[t].page.classed("visible",t==e);this.propertyPageView.resizeMultilineElement()},eventIdClicked:function(e){return d3.event.preventDefault(),d3.event.stopPropagation(),window.mainApp.timelineView.revealChildNode(e),!1}});module.exports=ATInspectorView;

},{"../../model/ATEmptyGuidString":26,"./ATColorDropdown":59,"./ATDropdown":63,"./ATInspectorLinkPageView":83,"./ATInspectorPropertyPageView":85,"./ATInspectorRangePageView":86,"./ATInspectorRolePageView":87,"./ATSearchDropdown":95,"./templates/inspectorTemplate.html":156,"./templates/optionsTemplate.html":164,"./templates/tabGroupTemplate.html":178,"backbone":220,"d3":320,"jquery":331,"lodash":333}],89:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATSearchDropdown=require("./ATSearchDropdown"),ATDropdown=require("./ATDropdown"),ATDatePicker=require("./ATDatePicker"),ATDurationPicker=require("./ATDurationPicker"),ATUtilities=require("../../utils/ATUtilities"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/manageEntitiesTemplate.html"),optionsHtml=require("./templates/optionsTemplate.html"),ATManageEntitiesView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,i=_.template(templateHtml);this.swatchList=[{name:"red",color:String("#d0011b").toLowerCase()},{name:"peach",color:String("#ff9b7b").toLowerCase()},{name:"orange",color:String("#e79102").toLowerCase()},{name:"yellow",color:String("#f5e309").toLowerCase()},{name:"mint",color:String("#a1eda3").toLowerCase()},{name:"apple",color:String("#73c619").toLowerCase()},{name:"lightTeal",color:String("#2fc286").toLowerCase()},{name:"darkTeal",color:String("#0a7b75").toLowerCase()},{name:"lightBlue",color:String("#89e4ff").toLowerCase()},{name:"denim",color:String("#6592c7").toLowerCase()},{name:"midBlue",color:String("#00a2ef").toLowerCase()},{name:"darkBlue",color:String("#004fef").toLowerCase()},{name:"darkPurple",color:String("#6434ff").toLowerCase()},{name:"lightPurple",color:String("#b59dff").toLowerCase()},{name:"pastelPink",color:String("#f89dff").toLowerCase()},{name:"fuschia",color:String("#bc28c8").toLowerCase()},{name:"lightPink",color:String("#ff629e").toLowerCase()},{name:"darkPink",color:String("#fe3d5a").toLowerCase()},{name:"deepPurple500",color:String("#673AB7").toLowerCase()},{name:"lightGreen500",color:String("#8BC34A").toLowerCase()},{name:"lime500",color:String("#CDDC39").toLowerCase()},{name:"brown500",color:String("#795548").toLowerCase()},{name:"grey",color:"##8c8c8c"},{name:"mono",color:String("#white").toLowerCase()},{name:"red200",color:String("#EF9A9A").toLowerCase()},{name:"red300",color:String("#E57373").toLowerCase()},{name:"red500",color:String("#F44336").toLowerCase()},{name:"red700",color:String("#D32F2F").toLowerCase()},{name:"red900",color:String("#B71C1C").toLowerCase()},{name:"red200A",color:String("#FF5252").toLowerCase()},{name:"red400A",color:String("#FF1744").toLowerCase()},{name:"red700A",color:String("#D50000").toLowerCase()},{name:"pink200",color:String("#F48FB1").toLowerCase()},{name:"pink300",color:String("#F06292").toLowerCase()},{name:"pink500",color:String("#E91E63").toLowerCase()},{name:"pink700",color:String("#C2185B").toLowerCase()},{name:"pink900",color:String("#880E4F").toLowerCase()},{name:"pink200A",color:String("#FF4081").toLowerCase()},{name:"pink400A",color:String("#F50057").toLowerCase()},{name:"pink700A",color:String("#C51162").toLowerCase()},{name:"purple200",color:String("#CE93D8").toLowerCase()},{name:"purple300",color:String("#BA68C8").toLowerCase()},{name:"purple500",color:String("#9C27B0").toLowerCase()},{name:"purple700",color:String("#7B1FA2").toLowerCase()},{name:"purple900",color:String("#4A148C").toLowerCase()},{name:"purple200A",color:String("#E040FB").toLowerCase()},{name:"purple400A",color:String("#D500F9").toLowerCase()},{name:"purple700A",color:String("#AA00FF").toLowerCase()},{name:"indigo200",color:String("#9FA8DA").toLowerCase()},{name:"indigo300",color:String("#7986CB").toLowerCase()},{name:"indigo500",color:String("#3F51B5").toLowerCase()},{name:"indigo700",color:String("#303F9F").toLowerCase()},{name:"indigo900",color:String("#1A237E").toLowerCase()},{name:"indigo200A",color:String("#536DFE").toLowerCase()},{name:"indigo400A",color:String("#3D5AFE").toLowerCase()},{name:"indigo700A",color:String("#304FFE").toLowerCase()},{name:"blue200",color:String("#90CAF9").toLowerCase()},{name:"blue300",color:String("#64B5F6").toLowerCase()},{name:"blue500",color:String("#2196F3").toLowerCase()},{name:"blue700",color:String("#1976D2").toLowerCase()},{name:"blue900",color:String("#0D47A1").toLowerCase()},{name:"blue200A",color:String("#448AFF").toLowerCase()},{name:"blue400A",color:String("#2979FF").toLowerCase()},{name:"blue700A",color:String("#2962FF").toLowerCase()},{name:"teal200",color:String("#80CBC4").toLowerCase()},{name:"teal300",color:String("#4DB6AC").toLowerCase()},{name:"teal500",color:String("#009688").toLowerCase()},{name:"teal700",color:String("#00796B").toLowerCase()},{name:"teal900",color:String("#004D40").toLowerCase()},{name:"teal200A",color:String("#64FFDA").toLowerCase()},{name:"teal400A",color:String("#1DE9B6").toLowerCase()},{name:"teal700A",color:String("#00BFA5").toLowerCase()},{name:"green200",color:String("#A5D6A7").toLowerCase()},{name:"green300",color:String("#81C784").toLowerCase()},{name:"green500",color:String("#4CAF50").toLowerCase()},{name:"green700",color:String("#388E3C").toLowerCase()},{name:"green900",color:String("#1B5E20").toLowerCase()},{name:"green200A",color:String("#69F0AE").toLowerCase()},{name:"green400A",color:String("#00E676").toLowerCase()},{name:"green700A",color:String("#00C853").toLowerCase()},{name:"yellow200",color:String("#FFF59D").toLowerCase()},{name:"yellow300",color:String("#FFF176").toLowerCase()},{name:"yellow500",color:String("#FFEB3B").toLowerCase()},{name:"yellow700",color:String("#FBC02D").toLowerCase()},{name:"yellow900",color:String("#F57F17").toLowerCase()},{name:"yellow200A",color:String("#FFFF01").toLowerCase()},{name:"yellow400A",color:String("#FFEA00").toLowerCase()},{name:"yellow700A",color:String("#FFD601").toLowerCase()},{name:"deepOrange200",color:String("#FFAB91").toLowerCase()},{name:"deepOrange300",color:String("#FF8A65").toLowerCase()},{name:"deepOrange500",color:String("#FF5722").toLowerCase()},{name:"deepOrange700",color:String("#E64A19").toLowerCase()},{name:"deepOrange900",color:String("#BF360C").toLowerCase()},{name:"deepOrange200A",color:String("#FF6E40").toLowerCase()},{name:"deepOrange400A",color:String("#FF3D00").toLowerCase()},{name:"deepOrange700A",color:String("#DD2C00").toLowerCase()},{name:"grey300",color:String("#E0E0E0").toLowerCase()},{name:"grey500",color:String("#9E9E9E").toLowerCase()},{name:"grey700",color:String("#616161").toLowerCase()},{name:"grey900",color:String("#212121").toLowerCase()},{name:"blueGrey300",color:String("#90A4AE").toLowerCase()},{name:"blueGrey500",color:String("#607D8B").toLowerCase()},{name:"blueGrey700",color:String("#455A64").toLowerCase()},{name:"blueGrey900",color:String("#263238").toLowerCase()},{name:"pureMaroon",color:String("#800000").toLowerCase()},{name:"pureCrimson",color:String("#db133b").toLowerCase()},{name:"pureRed",color:String("#ff0000").toLowerCase()},{name:"pureOrange",color:String("#e16e31").toLowerCase()},{name:"pureOlive",color:String("#808000").toLowerCase()},{name:"pureGreen",color:String("#008000").toLowerCase()},{name:"pureTeal",color:String("#008080").toLowerCase()},{name:"pureLightGreen",color:String("#2ec994").toLowerCase()},{name:"pureLime",color:String("#00ff00").toLowerCase()},{name:"pureNavy",color:String("#000080").toLowerCase()},{name:"pureBlue",color:String("#0000ff").toLowerCase()},{name:"pureCyan",color:String("#00ffff").toLowerCase()},{name:"pureGold",color:String("#ffd600").toLowerCase()},{name:"pureYellow",color:String("#ffff00").toLowerCase()},{name:"pureLightYellow",color:String("#fffacd").toLowerCase()},{name:"purePurple",color:String("#800080").toLowerCase()},{name:"pureLilac",color:String("#8373c0").toLowerCase()},{name:"pureMagenta",color:String("#ff00ff").toLowerCase()},{name:"pureLavendar",color:String("#e6e6f9").toLowerCase()},{name:"purePink",color:String("#ffbfca").toLowerCase()},{name:"pureBlack",color:String("#000000").toLowerCase()},{name:"pureGray",color:String("#808080").toLowerCase()},{name:"pureSilver",color:String("#bfbfbf").toLowerCase()},{name:"pureWhite",color:String("#ffffff").toLowerCase()}],this.spectrumPalette=_.chunk(_.map(this.swatchList,"color"),8),this.disabledPaletteColor=_.find(this.swatchList,function(e){return"grey"==e.name}).color,this.optionsTemplate=_.template(optionsHtml),this.displayGroups=[],this.expandedTypeId=null,this.selectedEntity=null,this.requireSelectAndFocus=!1,this.selectAndFocusName=null,this.BadWords=["Event","Entity","Tag","Color","Parent","Link","Any","All","Timeline"],this.d3El=d3.select("#"+e),this.d3El.html(i()),this.d3El.classed("modal",!0).classed("fade",!0).classed("wide-modal",!0).attr("tabindex",-1).attr("role","dialog"),this.listenTo(this.model,"change:template change:entitiesByType",function(){t.renderMasterList(),t.updateDetailFields()}),this.listenTo(this.model.get("timeline"),"change:events",this.updateEventDropdowns.bind(this)),this.d3MasterList=this.d3El.select(".masterViewList"),this.d3AgeGroupDiv=this.d3El.select("#manageEntitiesAgeGroup"),$("#manageEntitiesForm").on("submit",function(){return!1}),this.$nameInput=$("#manageEntitiesName"),this.$nameInput.on("change",this.entityNameChanged.bind(this)),this.$nameInput.on("input",this.entityNameInput.bind(this)),this.$notesInput=$("#manageEntitiesNotes"),this.$notesInput.on("change",this.entityNotesChanged.bind(this)),this.$colorInput=$("#manageEntitiesColor"),this.$colorInput.spectrum({color:this.disabledPaletteColor,showInput:!1,showInitial:!1,allowEmpty:!1,showPalette:!0,showPaletteOnly:!0,showButtons:!1,hideAfterPaletteSelect:!0,disabled:!1,preferredFormat:"hex",palette:this.spectrumPalette,appendTo:"#"+e,change:this.entityColorChanged.bind(this)}),this.createOffsetPickerView=new ATDurationPicker({el:"#manageEntitiesCreateOffset"}),this.createOffsetFromDropdown=new ATDropdown({el:"#manageEntitiesCreateOffsetFrom"}),this.destroyOffsetPickerView=new ATDurationPicker({el:"#manageEntitiesDestroyOffset"}),this.destroyOffsetFromDropdown=new ATDropdown({el:"#manageEntitiesDestroyOffsetFrom"}),$("#manageEntitiesRemoveButton").on("click",this.removeSelectedItem.bind(this)),this.createEventSearchDropdown=new ATSearchDropdown({el:"#manageEntitiesCreateEvent"}),this.createEventSearchDropdown.setNoOptionPlaceholder("No Event"),this.createEventSearchDropdown.setSearchWordByWord(!0),this.destroyEventSearchDropdown=new ATSearchDropdown({el:"#manageEntitiesDestroyEvent"}),this.destroyEventSearchDropdown.setNoOptionPlaceholder("No Event"),this.destroyEventSearchDropdown.setSearchWordByWord(!0),this.d3CreateDate=this.d3El.select("#manageEntitiesCreateDate"),this.createDatePickerView=new ATDatePicker({el:"#manageEntitiesCreateDate"}),this.d3DestroyDate=this.d3El.select("#manageEntitiesDestroyDate"),this.destroyDatePickerView=new ATDatePicker({el:"#manageEntitiesDestroyDate"}),this.createDatePickerView.setResetCallback(function(){window.setTimeout(t.resetCreateDateField.bind(t),0)}),this.destroyDatePickerView.setResetCallback(function(){window.setTimeout(t.resetDestroyDateField.bind(t),0)}),this.listenTo(this.createEventSearchDropdown,"change",this.createEventChangeHandler.bind(this)),this.listenTo(this.destroyEventSearchDropdown,"change",this.destroyEventChangeHandler.bind(this)),this.listenTo(this.createOffsetFromDropdown,"change",this.createEventChangeHandler.bind(this)),this.listenTo(this.destroyOffsetFromDropdown,"change",this.destroyEventChangeHandler.bind(this)),this.createOffsetPickerView.setChangeCallback(this.createEventChangeHandler.bind(this)),this.destroyOffsetPickerView.setChangeCallback(this.destroyEventChangeHandler.bind(this)),this.createDatePickerView.setChangeCallback(this.createPositionChangeHandler.bind(this)),this.destroyDatePickerView.setChangeCallback(this.destroyPositionChangeHandler.bind(this)),$("#manageEntitiesSortAlphaButton").on("click",this.sortItemsAlphabetically.bind(this)),$("#manageEntitiesMoveUpButton").on("click",this.moveSelectedItemUp.bind(this)),$("#manageEntitiesMoveDownButton").on("click",this.moveSelectedItemDown.bind(this)),this.renderMasterList(),this.displayGroups.length&&this.clickOnGroupHeading(this.displayGroups[0])},setRangeConversion:function(e){this.rangeConversion=e,this.createDatePickerView.setRangeConversion(e),this.destroyDatePickerView.setRangeConversion(e),this.createOffsetPickerView.setRangeConversion(e),this.destroyOffsetPickerView.setRangeConversion(e)},renderMasterList:function(){var e,t,i,n,o,r=this,s=this.model.get("template"),a=this.model.get("entitiesByType"),l=s.types,c=0,d=null;c=0,_.each(l,function(e){r.displayGroups.length<=c?r.displayGroups.push({type:e,icon:"star",items:[]}):(r.displayGroups[c].type=e,r.displayGroups[c].icon="star",r.displayGroups[c].items=[]),c++}),l.length<this.displayGroups.length&&this.displayGroups.splice(l.length,this.displayGroups.length-l.length),_.each(a,function(e,t){var i=_.find(r.displayGroups,function(e){return ATUtilities.caseInsensitiveCompare(e.type.name,t)},r);i&&_.each(e,function(e){e.icon||(e.icon=i.icon),i.items.push(e),r.selectedEntity&&e.entityId===r.selectedEntity.entityId?d=e:r.requireSelectAndFocus&&e.name===r.selectAndFocusName&&(d=e)})}),(e=this.d3MasterList.selectAll(".group").data(this.displayGroups)).select(".groupHeading").select("span").html(function(e){return e.type.name}),(n=e.select("ul").selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e===d})).select("span").html(function(e){return e.name}),n.select("svg").attr("class",function(e){return"icon "+(e.color?e.color:"")}).select("use").attr("xlink:href",function(e){return"#"+e.icon}),(o=n.enter().append("li").classed("selected",function(e){return e===d}).on("click",function(e){return r.clickOnListItem(e)})).append("svg").attr("class",function(e){return"icon "+(e.color?e.color:"")}).append("use").attr("xlink:href",function(e){return"#"+e.icon}),o.append("span").html(function(e){return e.name}),n.exit().remove(),(i=(t=e.enter().append("div").classed("group",!0)).append("div").classed("groupHeading",!0).on("click",function(e){r.clickOnGroupHeading(e)})).append("span").html(function(e){return e.type.name}),i.append("i").classed("fa fa-plus-circle",!0).on("click",this.addListItem.bind(this)),(o=(n=t.append("ul").style("max-height","0px").selectAll("li").data(function(e){return e.items}).classed("selected",function(e){return e===d})).enter().append("li").classed("selected",function(e){return e===d}).on("click",function(e){return r.clickOnListItem(e)})).append("svg").attr("class",function(e){return"icon "+(e.color?e.color:"")}).append("use").attr("xlink:href",function(e){return"#"+e.icon}),o.append("span").html(function(e){return e.name}),e.exit().remove(),this.selectedEntity=d,this.updateDetailFields(),this.animateExpansion()},updateEventDropdowns:function(){var e=this,t=this.model.get("timeline").get("events").models,i=[{value:ATEmptyGuidString,sortValue:"-1",label:"(No Event)"}];_.each(t,function(t){i.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),e.addChildrenOfEventsToOptions(i,t)}),i.sort(function(e,t){var i=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),n=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),o=Math.min(i.length,n.length),r=0;for(r=0;r<o;r++)if(i[r]!==n[r])return i[r]-n[r];return i.length-n.length}),this.createEventSearchDropdown.setOptions(i),this.destroyEventSearchDropdown.setOptions(i)},addChildrenOfEventsToOptions:function(e,t){var i=this;t.children.each(function(t){e.push({value:t.id,sortValue:t.get("displayId"),label:t.get("displayId")+". "+t.get("title")}),i.addChildrenOfEventsToOptions(e,t)})},updateDetailFields:function(){var e,t=this,i=this.model.get("template").types,n=null,o=null,r=null;this.rangeConversion&&(this.expandedTypeId&&(n=_.find(i,function(e){return e.typeId===t.expandedTypeId})),!n||n.persistent?this.d3AgeGroupDiv.style("display","none"):this.d3AgeGroupDiv.style("display",null),this.updateEventDropdowns(),this.selectedEntity?(e=_.find(this.swatchList,function(e){return e.name===t.selectedEntity.color}),this.$nameInput.val(this.selectedEntity.name),this.$notesInput.val(this.selectedEntity.notes),this.$nameInput.prop("disabled",!1),this.$notesInput.prop("disabled",!1),this.$colorInput.val(e.color),this.$colorInput.prop("disabled",!1),this.$colorInput.spectrum("set",e.color),this.$colorInput.spectrum("enable"),this.createEventSearchDropdown.setDisabled(!1),this.destroyEventSearchDropdown.setDisabled(!1),this.selectedEntity.createPosition&&this.rangeConversion&&(o=this.rangeConversion.valueForPartialString(this.selectedEntity.createPosition)),o?this.createDatePickerView.setValue(o.value):this.createDatePickerView.setValue(null),this.selectedEntity.destroyPosition&&this.rangeConversion&&(r=this.rangeConversion.valueForPartialString(this.selectedEntity.destroyPosition)),r?this.destroyDatePickerView.setValue(r.value):this.destroyDatePickerView.setValue(null),this.selectedEntity.createEvent.eventId!==ATEmptyGuidString?(this.createEventSearchDropdown.setValue(this.selectedEntity.createEvent.eventId),this.createDatePickerView.setDisabled(!0),this.createOffsetPickerView.setText(this.selectedEntity.createEvent.offsetString),this.createOffsetPickerView.setDisabled(!1),this.createOffsetFromDropdown.setValue(this.selectedEntity.createEvent.baseString),this.createOffsetFromDropdown.setDisabled(!1)):(this.createEventSearchDropdown.setValue(ATEmptyGuidString),this.createDatePickerView.setDisabled(!1),this.createOffsetPickerView.setDurationComponents([]),this.createOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setValue("start"),this.createOffsetFromDropdown.setDisabled(!0)),this.selectedEntity.destroyEvent.eventId!==ATEmptyGuidString?(this.destroyEventSearchDropdown.setValue(this.selectedEntity.destroyEvent.eventId),this.destroyDatePickerView.setDisabled(!0),this.destroyOffsetPickerView.setText(this.selectedEntity.destroyEvent.offsetString),this.destroyOffsetPickerView.setDisabled(!1),this.destroyOffsetFromDropdown.setValue(this.selectedEntity.destroyEvent.baseString),this.destroyOffsetFromDropdown.setDisabled(!1)):(this.destroyEventSearchDropdown.setValue(ATEmptyGuidString),this.destroyDatePickerView.setDisabled(!1),this.destroyOffsetPickerView.setDurationComponents([]),this.destroyOffsetPickerView.setDisabled(!0),this.destroyOffsetFromDropdown.setValue("start"),this.destroyOffsetFromDropdown.setDisabled(!0)),this.requireSelectAndFocus&&(window.setTimeout(function(){t.$nameInput.focus(),t.$nameInput.select()},100),this.requireSelectAndFocus=!1)):(this.$nameInput.val(""),this.$notesInput.val(""),this.$nameInput.prop("disabled",!0),this.$notesInput.prop("disabled",!0),this.$colorInput.val(""),this.$colorInput.prop("disabled",!0),this.$colorInput.spectrum("set",this.disabledPaletteColor),this.$colorInput.spectrum("disable"),this.createOffsetPickerView.setDurationComponents([]),this.destroyOffsetPickerView.setDurationComponents([]),this.createOffsetFromDropdown.setValue("start"),this.destroyOffsetFromDropdown.setValue("start"),this.createEventSearchDropdown.setValue(ATEmptyGuidString),this.destroyEventSearchDropdown.setValue(ATEmptyGuidString),this.createDatePickerView.setValue(null),this.destroyDatePickerView.setValue(null),this.createEventSearchDropdown.setDisabled(!0),this.createDatePickerView.setDisabled(!0),this.destroyEventSearchDropdown.setDisabled(!0),this.destroyDatePickerView.setDisabled(!0),this.createOffsetPickerView.setDisabled(!0),this.destroyOffsetPickerView.setDisabled(!0),this.createOffsetFromDropdown.setDisabled(!0),this.destroyOffsetFromDropdown.setDisabled(!0)),this.setNameFieldIsInvalid(!1))},resetCreateDateField:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityCreatePosition(window.timelineDocumentId,"",this.selectedEntity.entityId),this.createDatePickerView.setValue(null)},resetDestroyDateField:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityDestroyPosition(window.timelineDocumentId,"",this.selectedEntity.entityId),this.destroyDatePickerView.setValue(null)},clickOnGroupHeading:function(e){var t=this;this.expandedTypeId===e.type.typeId?(this.expandedTypeId=null,this.selectedEntity=null):(this.expandedTypeId=e.type.typeId,this.selectedEntity=e.items.length?e.items[0]:null),this.animateExpansion(),this.updateDetailFields(),window.setTimeout(function(){t.animateExpansion()},265)},immediateUpdateExpandedGroupHeight:function(){var e=this;this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedTypeId===t.type.typeId}).select("ul").style("max-height",function(t){var i=0;return e.expandedTypeId!==t.type.typeId?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedEntity===t})},animateExpansion:function(){var e=this;this.d3MasterList.selectAll(".group").classed("expanded",function(t){return e.expandedTypeId===t.type.typeId}).select("ul").transition().duration(250).style("max-height",function(t){var i=0;return e.expandedTypeId!==t.type.typeId?"0px":($(this).children("li").each(function(){i+=Math.max(23,$(this).outerHeight())}),i+"px")}),this.d3MasterList.selectAll("li").classed("selected",function(t){return e.selectedEntity===t})},clickOnListItem:function(e){var t=this;this.selectedEntity=e,this.d3MasterList.selectAll("li").classed("selected",function(e){return t.selectedEntity===e}),this.updateDetailFields()},findEntityWithName:function(e){var t=null,i=this.model.get("entitiesByType");return _.each(i,function(i,n){var o=_.find(i,function(t){return t.name===e});o&&(t=o)}),t},addListItem:function(e){for(var t="New Entity",i=0;this.findEntityWithName(t);)t="New Entity "+ ++i;return this.selectedEntity=null,this.requireSelectAndFocus=!0,this.selectAndFocusName=t,window.ApplicationInterface&&window.ApplicationInterface.addEntity(window.timelineDocumentId,t,e.type.typeId,ATEmptyGuidString,"",!1,""),d3.event.stopPropagation(),!1},removeSelectedItem:function(e){var t=this,i=this.selectedEntity?this.selectedEntity.entityId:ATEmptyGuidString,n=_.find(this.displayGroups,function(e){return e.type.typeId===t.expandedTypeId}),o=_.indexOf(n.items,this.selectedEntity);return this.selectedEntity?(o===n.items.length-1?this.selectedEntity=o>0?n.items[o-1]:null:this.selectedEntity=n.items[o+1],window.ApplicationInterface&&window.ApplicationInterface.removeEntity(window.timelineDocumentId,i),e.stopPropagation(),e.preventDefault(),!1):(e.stopPropagation(),e.preventDefault(),!1)},moveSelectedItemUp:function(){var e,t=this,i=this.selectedEntity?this.selectedEntity.entityId:ATEmptyGuidString,n=_.find(this.displayGroups,function(e){return e.type.typeId===t.expandedTypeId}),o=_.indexOf(n.items,this.selectedEntity);this.selectedEntity&&0!==o&&(e=n.items[o-1],window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,i,e.entityId))},moveSelectedItemDown:function(){var e,t=this,i=this.selectedEntity?this.selectedEntity.entityId:ATEmptyGuidString,n=_.find(this.displayGroups,function(e){return e.type.typeId===t.expandedTypeId}),o=_.indexOf(n.items,this.selectedEntity);!this.selectedEntity||o>=n.items.length||(e=n.items[o+1],window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,i,e.entityId))},sortItemsAlphabetically:function(){window.ApplicationInterface&&window.ApplicationInterface.sortEntitiesOfType(window.timelineDocumentId,this.expandedTypeId)},entityNameInput:function(){var e,t=this.$nameInput.val(),i=this.BadWords,n=new RegExp(/[<>{}[\]]/),o=!1;this.selectedEntity&&(e=this.selectedEntity.name,t&&0!==t.length?_.find(i,function(e){return e===t})?o=!0:n.test(t)?o=!0:t!==e&&this.findEntityWithName(t)&&(o=!0):o=!0),this.setNameFieldIsInvalid(o)},setNameFieldIsInvalid:function(e){this.$nameInput[0].setCustomValidity(e?"Error":"")},entityNameChanged:function(){var e,t=this.$nameInput.val(),i=this.BadWords,n=new RegExp(/[<>{}[\]]/);this.selectedEntity&&(e=this.selectedEntity.name,t&&0!==t.length?_.find(i,function(e){return e===t},this)?t=e:n.test(t)?t=e:this.findEntityWithName(t)&&(t=e):t=e,this.setNameFieldIsInvalid(!1),this.$nameInput.val(t),window.ApplicationInterface&&window.ApplicationInterface.setEntityName(window.timelineDocumentId,t,this.selectedEntity.entityId))},entityNotesChanged:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityNotes(window.timelineDocumentId,this.$notesInput.val(),this.selectedEntity.entityId)},entityColorChanged:function(){var e=this.$colorInput.val(),t=_.find(this.swatchList,function(t){return t.color===e});this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityColor(window.timelineDocumentId,t.name,this.selectedEntity.entityId)},createPositionChangeHandler:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityCreatePosition(window.timelineDocumentId,this.createDatePickerView.text(),this.selectedEntity.entityId)},destroyPositionChangeHandler:function(){this.selectedEntity&&window.ApplicationInterface&&window.ApplicationInterface.setEntityDestroyPosition(window.timelineDocumentId,this.destroyDatePickerView.text(),this.selectedEntity.entityId)},createEventChangeHandler:function(){var e=this.createEventSearchDropdown.getValue();this.selectedEntity&&(e!==ATEmptyGuidString?(this.destroyOffsetPickerView.setDisabled(!0),0===this.createOffsetPickerView.text().length&&(this.createOffsetPickerView.setText("0 seconds"),this.createOffsetFromDropdown.setValue("start")),window.ApplicationInterface&&window.ApplicationInterface.setEntityCreateEvent(window.timelineDocumentId,e,this.createOffsetPickerView.text(),"start"===this.createOffsetFromDropdown.getValue(),this.selectedEntity.entityId)):window.ApplicationInterface&&window.ApplicationInterface.removeEntityCreateEvent(window.timelineDocumentId,this.selectedEntity.entityId))},destroyEventChangeHandler:function(){var e=this.destroyEventSearchDropdown.getValue();this.selectedEntity&&(e!==ATEmptyGuidString?(0===this.destroyOffsetPickerView.text().length&&(this.destroyOffsetPickerView.setText("0 seconds"),this.destroyOffsetFromDropdown.setValue("start")),window.ApplicationInterface&&window.ApplicationInterface.setEntityDestroyEvent(window.timelineDocumentId,e,this.destroyOffsetPickerView.text(),"start"===this.destroyOffsetFromDropdown.getValue(),this.selectedEntity.entityId)):window.ApplicationInterface&&window.ApplicationInterface.removeEntityDestroyEvent(window.timelineDocumentId,this.selectedEntity.entityId))}});module.exports=ATManageEntitiesView;

},{"../../model/ATEmptyGuidString":26,"../../utils/ATUtilities":51,"./ATDatePicker":60,"./ATDropdown":63,"./ATDurationPicker":64,"./ATSearchDropdown":95,"./templates/manageEntitiesTemplate.html":161,"./templates/optionsTemplate.html":164,"backbone":220,"d3":320,"jquery":331,"lodash":333}],90:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/newParentTemplate.html"),ATNewParentView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,n=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(n({eventTitle:"New Event"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$eventTitle=$("#newParentEventTitle"),$("#newParentYesButton").on("click",function(e){t.resultHandler(!0,e)}),$("#newParentNoButton").on("click",function(e){t.resultHandler(!1,e)})},setParentEventTitle:function(e){this.$eventTitle.text(e)},setCallback:function(e){this.callbackFunction=e},resultHandler:function(e,t){return this.callbackFunction&&this.callbackFunction(e),window.mainApp.removeExistingModal(),t.preventDefault(),!1}});module.exports=ATNewParentView;

},{"./templates/newParentTemplate.html":162,"backbone":220,"d3":320,"jquery":331,"lodash":333}],91:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("../../utils/ATUtilities"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/onboardingTemplate.html"),ATOnboardingView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.pages=[],this.currentPage=0,this.currentCategory=null,this.categoryTitle="",this.categoryHelpUrl="",this.d3El=d3.select("#"+e),this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.d3CategorySpan=d3.select("#onboardingCategory"),this.d3ContentDiv=d3.select("#onboardingContent"),this.d3TitleText=d3.select("#onboardingTitle"),this.d3PageSpan=d3.select("#onboardingPage"),this.d3TotalPagesSpan=d3.select("#onboardingPages"),this.$nextButton=$("#onboardingNext"),this.$prevButton=$("#onboardingPrev"),this.$nextButton.on("click",this.nextClickHandler.bind(this)),this.$prevButton.on("click",this.prevClickHandler.bind(this)),$("#btnOnboardingHelp").on("click",this.helpClickHandler.bind(this))},configureForCategory:function(e){"version1-upgrade"==e?this.configureAsV1Upgrade():"first-time-user"==e?this.configureAsFirstTimeUser():"filter"==e?this.configureAsFilter():"scrivener"==e?this.configureAsScrivener():this.pages=[],this.currentPage=0,this.currentCategory=e,this.render()},configureAsV1Upgrade:function(){this.pages=[{title:"Version 2: Some Important Changes",template:"<p></p><p>Click through these tips for a quick overview, but we highly recommend clicking on <strong>Online Help</strong> below for a summary of the changes and where you can find things in Aeon Timeline 2.</p>"},{title:"Arcs are entities",template:'<p>The only way to group events in version 1 was to divide them into different "Arcs". In Aeon Timeline 2, Arcs are now just another type of Entity.</p><p>Each template (Fiction, Legal, Project Management, etc.) defines its own entity types.</p><p>When upgrading a version 1 file, we use a template that matches your original version 1 timeline as closely as possible.</p>'},{title:"Group by any entity type",template:'<p>Aeon Timeline 2 allows you to group events by any entity type.</p><p>Click on the Group by button in the toolbar <i class="fa fa-align-justify"></i><i class = "fa fa-angle-down"></i> to switch from grouping by Arc to grouping by another type such as Person.</p><p>As events can have relationships with multiple People, it is possible for the same event to appear in multiple groups. When you click on such an event to select it, all copies of that event will be highlighted.</p>'},{title:"Setting relationships",template:'<p>Relationships between events and entities (including Arcs) are configured in the "Roles" tab in the Inspector.</p><p>Set birth dates/events for people in the Manage Entities dialog.</p><p> Once set, group by "Person" to see their ages shown at the top of each group.</p>'},{title:"Settings",template:"<p>Under Timeline Settings, you can define your own Entity Types, Roles and Properties. If you have been using version 1 for something other than fiction, you can also rename the existing entity types in your upgraded file to something more suitable (e.g. rename Arc to Project).</p><p>Under Display Settings, choose your preferred skin color, font size, and what information is displayed when you expand an event.</p>"},{title:"Dependencies and parents",template:'<p>Some new features you may want to explore:<ul><li>Make events depend on other events (e.g. tie an event to be exactly 10 years after an earlier event) under the "Range" tab in the Inspector.</li><li>Make events a sub-event under a parent in the Inspector, or hold "Alt" while dragging an event onto a parent.</li></ul></p>'},{title:"Navigation",template:'<p>Some tips to help you navigate quickly around your timeline:<ul><li>Click "First" or "Last" in the Bookmarks Bar at the bottom of the screen to go to the first or last event.</li><li>Add your own Bookmarks to quickly navigate to a set zoom and time.</li><li>Type a date in the search bar to scroll to that date.</li></ul></p>'}],this.categoryTitle="Upgrading Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/upgrading-from-version1/"},configureAsFirstTimeUser:function(){this.pages=[{title:"Welcome to Aeon Timeline 2",template:"<p></p><p>Click through these tips to help get you started with Version 2.</p><p>We highly recommend clicking on <strong>Online Help</strong> below for a broader introduction to Aeon Timeline 2.</p>"},{title:"Adding events",template:'<p>Add Events using the toolbar icon <i class="fa fa-plus-circle"></i> or by double clicking on the timeline (this pre-fills the dialog with the date where you clicked).</p><p>If you are new to Aeon Timeline, the best way to get started is to fill your timeline with events.</p><p>When it starts to feel a bit cluttered, you can then begin to bring in other elements (such as People/Places/Arcs/Projects) to give your timeline more structure.</p>'},{title:"Adding entities",template:'<p>Add entities (eg. people, places, projects) to your timeline with the "Add Entity" button on the toolbar.</p><p>Available entity types and roles depend on your chosen template, for example:<br /><ul><li><strong>Fiction</strong> contains Arc, Place, and Character.</li><li><strong>Project Management</strong> contains Project and Employee.</li><li><strong>Legal</strong> contains Person (with Client/Witness roles) and Category.</li></ul>You can configure your own entity types under Timeline Settings.</p>'},{title:"Adding relationships",template:"<p>Click on the Roles tab in the Inspector to set relationships between events and entities.</p>"},{title:"Group by any entity type",template:'<p>As you add events, you will eventually want to divide them into groups on your timeline.</p><p>Click on the "Group by" button in the toolbar <i class="fa fa-align-justify"></i><i class = "fa fa-angle-down"></i> to choose the entity type to use when grouping events.</p><p>If you have added a creation date/event for an entity (e.g. a character\'s birth), entity ages will be shown at the top of each group.</p>'},{title:"Navigation",template:'<p>Some tips to help you navigate quickly around your timeline:<ul><li>Click "First" or "Last" in the Bookmarks Bar at the bottom of the screen to go to the first or last event.</li><li>Add your own Bookmarks to quickly navigate to a set zoom and time.</li><li>Type a date in the search bar to scroll to that date.</li></ul></p>'},{title:"Explore more",template:"<p>When you are comfortable with the basics, go to the Help menu for more advanced onboarding tips.</p>"}],this.categoryTitle="Getting Started Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/getting-started/"},configureAsFilter:function(){this.pages=[{title:"Available filters",template:"<p>Click on the filter bar to add a new filtering criteria.</p><p>For 'field', you can enter 'title', 'date', 'color', 'parent', 'tag', or the name of any property, entity type or role.</p><p>When you begin typing a field name, the filter bar will auto-complete the first available option that begins with your typed text. If your desired option is shown as the auto-complete, you can hit 'tab' to begin entering the value. Otherwise, continue typing additional characters until your intended value is shown."},{title:"Available values",template:"<p>When filtering by entity type or role, the 'value' can be an entity name or 'None' if you want to find unallocated events.</p><p>When filtering by date or a numeric value, the 'value' can including comparisons such as '> 2000' or 'before August 2010'.</p>"},{title:"Saving filters",template:'<p>You can save and reload filters that you expect to use frequently by clicking on the Settings icon <i class="fa fa-cog"></i> in the Filter Bar.</p>'}],this.categoryTitle="Filtering Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/filtering/"},configureAsScrivener:function(){this.pages=[{title:"Introduction to Scrivener syncing",template:"<p>Scrivener syncing allows you to link events in your timeline with documents in your Scrivener project.</p><p>Aeon Timeline will keep track of changes made to timeline events or Scrivener documents. Each time you sync, any changes made to the event will be copied across to the corresponding metadata for the Scrivener document, and vice versa.</p><p>When a Scrivener project is opened, its Binder is represented on the left side of the Aeon Timeline interface. This is a fully functional Binder - you can drag documents around in this binder and it will be reflected in Scrivener when you next run that application.</p>"},{title:"Sync settings",template:'<p>The first time you sync, you will be asked to choose which timeline values you want to sync with the Scrivener project.</p><p>You can sync any timeline event fields, including title, dates, properties, and relationships.</p><p>On the Scrivener side, you can sync with the document title, synopsis, label, existing custom metadata fields, or you can choose to create a new custom metadata field for certain timeline properties</p><p>You can change your sync settings at any time by clicking on the Settings icon <i class="fa fa-cog"></i> in the Scrivener binder.</p>'},{title:"Creating new items",template:"<p>To create a new timeline event from a Scrivener document, simply drag documents from the binder into the timeline area.</p><p>To create a new Scrivener document from a timeline event, simply drag events from the timeline and drop them into the binder.</p>"},{title:"Linking existing items",template:"<p>If you are starting with a pre-existing timeline and Scrivener project, you will want to link together existing items.</p><p>To do so, right-click on the Scrivener document and choose 'Link to event...'.</p>"},{title:"Syncing status",template:'<p>Each time you sync, the status will be shown next to each document in the binder:</p><p><i class="fa fa-check-circle onboardingSyncIcon" style="color: #5cb85c"></i> Event and document are in sync (no changes)<br /><i class="fa fa-exclamation-circle onboardingSyncIcon" style="color: #f0ad4e"></i> Changes need to be synced<br /><i class="fa fa-exclamation-triangle onboardingSyncIcon" style="color: #d9534f"></i> Conflicting changes must be manually resolved<br /><i class="fa fa-question-circle onboardingSyncIcon" style="color: #bbb"></i> New document</p><p>Click the Sync icon <i class="fa fa-refresh"></i> to sync all changes between the project  and timeline.</p><p>If there are any conflicts, you can resolve them manually by right clicking on the document.</p>'}],this.categoryTitle="Syncing Tip",this.categoryHelpUrl="http://www.aeontimeline.com/support/scrivener-syncing/"},render:function(){var e=this.pages[this.currentPage];e&&(this.d3ContentDiv.html(e.template),this.d3TitleText.text(e.title),this.d3PageSpan.text(this.currentPage+1),this.d3TotalPagesSpan.text(this.pages.length),this.d3CategorySpan.text(this.categoryTitle)),this.currentPage>=this.pages.length-1?this.$nextButton.attr("value","Done"):this.$nextButton.attr("value","Next"),this.$prevButton.attr("disabled",0==this.currentPage)},nextClickHandler:function(e){return this.currentPage>=this.pages.length-1?(window.ApplicationInterface&&window.ApplicationInterface.onboardingSequenceComplete(window.timelineDocumentId,this.currentCategory),window.mainApp.removeExistingModal()):(this.currentPage++,this.render()),e.preventDefault(),!1},prevClickHandler:function(e){return this.currentPage>0&&(this.currentPage--,this.render()),e.preventDefault(),!1},helpClickHandler:function(e){if(window.ApplicationInterface&&this.categoryHelpUrl){var t=[{filepath:this.categoryHelpUrl}];window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(t),0)}return e.preventDefault(),!1}});module.exports=ATOnboardingView;

},{"../../utils/ATUtilities":51,"./ATDropdown":63,"./templates/onboardingTemplate.html":163,"backbone":220,"d3":320,"jquery":331,"lodash":333}],92:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATViewMode=require("../ATViewMode"),ATDropdown=require("./ATDropdown"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),templateHtml=require("./templates/printTemplate.html"),ATRect=require("../../utils/ATRect"),ATDatePicker=require("./ATDatePicker"),ATPrintView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),i=_.template(templateHtml);this.d3El=d3.select("#"+e),this.d3El.html(i({windowTitle:"Print Options"})),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.$windowTitle=$("#printWindowTitle"),this.d3StartDate=this.d3El.select("#startDateInputPrint"),this.startDatePickerView=new ATDatePicker({el:"#startDateInputPrint"}),this.d3EndDate=this.d3El.select("#endDateInputPrint"),this.endDatePickerView=new ATDatePicker({el:"#endDateInputPrint"}),this.endDatePickerView.setupAsEndPickerForStartPicker(this.startDatePickerView),this.skinDropdown=new ATDropdown({el:"#printSettingsSkin"}),this.listenTo(this.skinDropdown,"change",this.skinChanged.bind(this)),this.sizeDropdown=new ATDropdown({el:"#printSettingsSize"}),this.listenTo(this.sizeDropdown,"change",this.sizeChanged.bind(this)),this.skinDropdown.setValue("print"),this.sizeDropdown.setValue("100"),this.exportViewport=new ATRect(0,0,0,0),this.printSkin="print",this.printSize=100,this.omitCollapsedLanes=!0,this.currentFormat(),this.$submitButton=$("#printSubmit"),$("#entireTimelinePrint").on("click",this.entireTimeline.bind(this)),$("#formatCurrentPrint").on("click",this.currentFormat.bind(this)),$("#betweenDatesPrint").on("click",this.betweenDates.bind(this)),this.startDatePickerView.setChangeCallback(this.updateDates.bind(this)),this.endDatePickerView.setChangeCallback(this.updateDates.bind(this)),$("#printSettingsOmitCollapsedLanes").on("click",this.omitCollapsedLanesChange.bind(this)),$("#printForm").on("submit",this.addClickHandler.bind(this))},calculateRangeOnShow:function(){window.mainApp.getUnitScale(),this.printSize;var e=$("input[name=Format]:checked","#printForm").val();window.mainApp.timelineView.viewMode==ATViewMode.RELATIONSHIP_VIEW?($("#betweenDatesPrint").prop("disabled","disabled"),$("#formatCurrentPrint").prop("disabled","disabled"),e="All",$("#entireTimelinePrint").prop("checked",!0),$("#betweenDatesPrint").prop("checked",!1),$("#formatCurrentPrint").prop("checked",!1)):($("#betweenDatesPrint").prop("disabled",null),$("#formatCurrentPrint").prop("disabled",null)),"Current"==e?this.currentFormat():"All"==e?this.entireTimeline():this.betweenDates()},setRangeConversion:function(e){this.startDatePickerView.setRangeConversion(e),this.endDatePickerView.setRangeConversion(e)},currentFormat:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),$("#printSettingsOmitCollapsedLanes").prop("disabled",!0),$("#printSettingsOmitCollapsedLanes").prop("checked",!1),this.exportViewport=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?window.mainApp.timelineView.viewport.deepCopy():window.mainApp.relationshipView.viewport.deepCopy(),$("#widthLabel").text(Math.round(this.exportViewport.size.width)),$("#heightLabel").text(Math.round(this.exportViewport.size.height))},entireTimeline:function(){this.startDatePickerView.setDisabled(!0),this.endDatePickerView.setDisabled(!0),$("#printSettingsOmitCollapsedLanes").prop("disabled",!1),$("#printSettingsOmitCollapsedLanes").prop("checked",!0),this.exportViewport.origin.x=window.mainApp.getEarliestEventPixel(),this.exportViewport.origin.y=window.mainApp.timelineView.viewMode==ATViewMode.TIMELINE_VIEW?0:-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,this.exportViewport.size.width=window.mainApp.getLatestEventPixel()-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeightForExport()},betweenDates:function(){$("#printSettingsOmitCollapsedLanes").prop("disabled",!1),$("#printSettingsOmitCollapsedLanes").prop("checked",!0),this.startDatePickerView.setDisabled(!1),this.endDatePickerView.setDisabled(!1),this.updateDates()},updateDates:function(){var e,i;null!==this.startDatePickerView.getValue()&&(e=this.startDatePickerView.getTimestamp()),null!==this.endDatePickerView.getValue()&&(i=this.endDatePickerView.getTimestamp()),isNaN(e)&&isNaN(i)||i>=e&&(this.exportViewport.origin.x=window.mainApp.pixelForTimestamp(e),this.exportViewport.origin.y=0,this.exportViewport.size.width=window.mainApp.pixelForTimestamp(i)-this.exportViewport.origin.x,this.exportViewport.size.height=window.mainApp.getTimelineHeightForExport())},skinChanged:function(){this.printSkin=this.skinDropdown.getValue()},sizeChanged:function(){this.printSize=parseInt(this.sizeDropdown.getValue())},omitCollapsedLanesChange:function(){this.omitCollapsedLanes=$("#printSettingsOmitCollapsedLanes").is(":checked")},setWindowTitle:function(e){this.$windowTitle.text(e)},addClickHandler:function(e){var i,t,n=window.mainApp.getUnitScale(),r=this.printSize/100,s=$("input[name=Format]:checked","#printForm").val();return"Current"==s&&(this.exportViewport=window.mainApp.timelineView.viewport.deepCopy(),this.exportViewport.size.height-=TimelineDisplayConstants.navFooterHeight),i=this.exportViewport.size.width*r,t=this.exportViewport.size.height*r,window.ApplicationInterface.printWithSettings(window.timelineDocumentId,""+this.exportViewport.origin.x,""+this.exportViewport.origin.y,i,t,""+n,this.printSkin,this.printSize,this.omitCollapsedLanes,"Current"!=s),window.mainApp.removeExistingModal(),e.preventDefault(),!1}});module.exports=ATPrintView;

},{"../../controller/ATDisplayConstants":16,"../../utils/ATRect":48,"../ATViewMode":53,"./ATDatePicker":60,"./ATDropdown":63,"./templates/printTemplate.html":165,"backbone":220,"d3":320,"jquery":331,"lodash":333}],93:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATCalendarPicker=require("./ATCalendarPicker"),bootstrap=require("bootstrap"),ATRangeControlManager=function(e,t,a){this.startPicker=e,this.durationPicker=t,this.endPicker=a,this.startPicker.setManagerCallback(this.startChangeHandler.bind(this)),this.durationPicker.setManagerCallback(this.durationChangeHandler.bind(this)),this.endPicker.setManagerCallback(this.endChangeHandler.bind(this)),this.endPicker.setupAsEndPickerForStartPicker(this.startPicker)};ATRangeControlManager.prototype.startChangeHandler=function(e,t){this.updateEndPicker()},ATRangeControlManager.prototype.durationChangeHandler=function(e){this.updateEndPicker()},ATRangeControlManager.prototype.endChangeHandler=function(e,t){this.updateSpan()},ATRangeControlManager.prototype.updateEndPicker=function(){if(this.rangeConversion){var e=this.startPicker.getValue(),t=this.durationPicker.getValue(),a=e&&t?this.rangeConversion.valueByAddingSpanToValue(e,t):e;a&&e&&(a.timestamp&&a.timestamp<e.timestamp||!a.timestamp&&a<e)&&(a=e),this.endPicker.setValue(a)}},ATRangeControlManager.prototype.updateSpan=function(){if(this.rangeConversion){var e=this.startPicker.getValue(),t=this.endPicker.getValue(),a=this.rangeConversion.spanBetweenValues(e,t);null!=t&&null!=e&&(t.timestamp&&t.timestamp<e.timestamp||!t.timestamp&&t<e)&&(t=e,this.endPicker.setValue(t),a=this.rangeConversion.spanBetweenValues(e,t)),this.durationPicker.setValue(a)}},ATRangeControlManager.prototype.setStartChangeCallback=function(e){this.startChangeCallback=e,this.startPicker.setChangeCallback(e)},ATRangeControlManager.prototype.setDurationChangeCallback=function(e){this.durationChangeCallback=e,this.durationPicker.setChangeCallback(e)},ATRangeControlManager.prototype.setEndChangeCallback=function(e){this.endChangeCallback=e,this.endPicker.setChangeCallback(e)},ATRangeControlManager.prototype.setRangeConversion=function(e){this.rangeConversion=e,this.startPicker.setRangeConversion(e),this.durationPicker.setRangeConversion(e),this.endPicker.setRangeConversion(e)},module.exports=ATRangeControlManager;

},{"./ATCalendarPicker":57,"backbone":220,"bootstrap":222,"d3":320,"jquery":331,"lodash":333}],94:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/searchDropdownTemplate.html"),ATSearchDropdown=Backbone.View.extend({initialize:function(){var t=this.$el.attr("id"),i=t+"-searchInput",e=t+"-label",s=t+"-caret",n=t+"-dropdown",h=t+"-list",o=_.template(templateHtml),l=this;this.rawOptions=[],this.visibleOptions=this.rawOptions.slice(),ATSearchDropDownGlobalTimeout=null,this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.searchFunction=this.matchAnywhereSearch,this.d3El=d3.select("#"+t),this.d3El.classed("bselect",!0),this.d3El.attr("tabindex",0),this.d3El.html(o({})),this.d3El.on("click",function(){l.open||l.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",e).on("click",this.toggle.bind(this)),this.d3El.select(".bselect-caret").attr("id",s).on("click",this.toggle.bind(this)),this.$el.keydown(function(t){return l.divKeyDownHandler(t)}).on("focus",function(){l.focusHandler()}).on("blur",function(){l.blurHandler()}),this.$searchDiv=$(this.d3El.select(".bselect-search").node()),this.d3SearchInput=this.d3El.select(".bselect-search-input").attr("id",i).on("input",function(){l.inputHandler()}).on("blur",function(){l.blurHandler()}),this.$searchInput=$("#"+i),this.$searchInput.keydown(function(t){return l.searchKeyDownHandler(t)}),this.$searchInput.on("focus",this.searchFocus.bind(this)),this.d3El.select(".bselect-search-icon").on("click",function(){l.$searchInput.focus()}),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",n),this.$dropdown=$("#"+n),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",h),this.$list=$("#"+h),this.$list.on("scroll",this.listScrollHandler.bind(this)),this.updateTitle()},setSearchWordByWord:function(){this.searchFunction=this.wordByWordSearch},setOptions:function(t){this.rawOptions=t,this.visibleOptions=this.rawOptions.slice(),this.selectedOption&&this.setValue(this.selectedOption.value)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.rawOptions,function(i){return i.value==t}),this.updateTitle(),this.renderOptions()},getValue:function(){return this.selectedOption?this.selectedOption.value:null},toggle:function(){this.disabled||this.open?this.hide():this.show(),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.attr("id")+"-list",i=(this.selectedOption&&this.selectedOption.value,this.$el.height()+this.$el.offset().top),e=$(window).height()-i<250;if(!this.disabled){this.d3El.classed("open",!0),this.$dropdown.slideDown(250),this.d3El.classed("flipped",e);var s=this.$searchInput.parent().width()-this.$searchInput.next().outerWidth();this.$searchInput.innerWidth(s),this.renderOptions(),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.scrollItemIntoView(),this.$searchInput.focus(),this.open=!0}},hide:function(){var t=this;this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.clearSearch(),this.$searchInput.is(":focus")&&window.setTimeout(function(){t.$el.focus()},0),this.open=!1},clearSearch:function(){this.$searchInput.val(""),this.visibleOptions=this.rawOptions.slice()},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id")+"-list";i.attr("id",function(t){return e+"-"+t.value}).classed("active",function(i){return!!t.selectedOption&&i.value==t.selectedOption.value}).classed("highlight",function(i,e){return e==t.highlightIndex}).select("span").text(function(t){return t.label}),i.enter().append("li").attr("id",function(t){return e+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return!!t.selectedOption&&i.value==t.selectedOption.value}).classed("highlight",function(i,e){return e==t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}).append("span").text(function(t){return t.label}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id")+"-list",i=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,e=i?t+"-"+i.value:null,s=null;if(e){s=$("#"+e);var n=this.$list.scrollTop(),h=this.$list.height(),o=s.position()?s.position().top:0,l=s.height(),c=this.$searchDiv.position().top+this.$searchDiv.height()+5;(o<c||o+l>h+c)&&this.$list.scrollTop(n-c+o-h/2+l/2)}},updateTitle:function(){this.selectedOption&&this.selectedOption.value!=ATEmptyGuidString?this.d3Label.text(this.selectedOption.label):this.d3Label.html(this.noOptionPlaceholder)},optionClick:function(t){this.focusHasResumed=!0,this.selectedOption=_.find(this.visibleOptions,function(i){return i.value==t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change")},divKeyDownHandler:function(t){var i=!1;switch(t.keyCode||t.which){case 13:this.open||(this.$el.closest("form").submit(),i=!0);break;case 38:case 40:this.open||(this.show(),i=!0)}return this.renderOptions(),!i},searchKeyDownHandler:function(t){var i=!1;switch(t.keyCode||t.which){case 9:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),i=!1;break;case 13:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),i=!0;break;case 27:this.open&&(this.hide(),i=!0);case 38:-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,i=!0;break;case 40:-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,i=!0}return this.renderOptions(),!i},inputHandler:function(){var t=this.$searchInput.val().toLocaleLowerCase();if(this.$searchInput.data("lastval")!=this.$searchInput.val()){this.$searchInput.val();this.visibleOptions=this.searchFunction(t,this.rawOptions),this.highlightIndex=0,this.renderOptions(),0==this.visibleOptions.length&&(this.highlightIndex=-1)}},wordByWordSearch:function(t,i){var e=[],s=t.split(" ");return 0==t.length?i.slice():(_.each(i,function(t){var i=t.label.toLocaleLowerCase().split(" "),n=0;_.each(s,function(t){t.length&&_.each(i,function(i){0==i.indexOf(t)&&n++})}),n>0&&(t.matchCount=n,e.push(t))}),e.sort(function(t,i){return i.matchCount-t.matchCount}),e)},matchAnywhereSearch:function(t,i){var e=[];return 0==t.length?i:(_.each(i,function(t){t.label.toLocaleLowerCase().indexOf(lowerStr)>-1&&e.push(t)}),e)},focusHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},listScrollHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},blurHandler:function(){var t=this;this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout&&clearTimeout(ATSearchDropDownGlobalTimeout),ATSearchDropDownGlobalTimeout=setTimeout(function(){t.focusLost()},100)},searchFocus:function(){this.focusHasResumed=!0},focusLost:function(){this.focusHasResumed||this.hide(),this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout=null}});module.exports=ATSearchDropdown;

},{"../../model/ATEmptyGuidString":26,"./templates/searchDropdownTemplate.html":170,"backbone":220,"d3":320,"jquery":331,"lodash":333}],95:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/searchDropdownTemplate.html"),ATSearchDropdown=Backbone.View.extend({initialize:function(){var t=this.$el.attr("id"),i=t+"-searchInput",e=t+"-label",s=t+"-caret",n=t+"-dropdown",h=t+"-list",o=_.template(templateHtml),l=this;this.rawOptions=[],this.visibleOptions=this.rawOptions.slice(),ATSearchDropDownGlobalTimeout=null,this.disabled=!1,this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.noOptionPlaceholder="&nbsp;",this.searchFunction=this.matchAnywhereSearch,this.d3El=d3.select("#"+t),this.d3El.classed("bselect",!0),this.d3El.attr("tabindex",0),this.d3El.html(o({})),this.d3El.on("click",function(){l.open||l.toggle()}),this.d3Label=this.d3El.select(".bselect-label").attr("id",e).on("click",this.toggle.bind(this)),this.d3El.select(".bselect-caret").attr("id",s).on("click",this.toggle.bind(this)),this.$el.keydown(function(t){return l.divKeyDownHandler(t)}).on("focus",function(){l.focusHandler()}).on("blur",function(){l.blurHandler()}),this.$searchDiv=$(this.d3El.select(".bselect-search").node()),this.d3SearchInput=this.d3El.select(".bselect-search-input").attr("id",i).on("input",function(){l.inputHandler()}).on("blur",function(){l.blurHandler()}),this.$searchInput=$("#"+i),this.$searchInput.keydown(function(t){return l.searchKeyDownHandler(t)}),this.$searchInput.on("focus",this.searchFocus.bind(this)),this.d3El.select(".bselect-search-icon").on("click",function(){l.$searchInput.focus()}),this.d3Dropdown=this.d3El.select(".bselect-dropdown").attr("id",n),this.$dropdown=$("#"+n),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",h),this.$list=$("#"+h),this.$list.on("scroll",this.listScrollHandler.bind(this)),this.updateTitle()},setSearchWordByWord:function(){this.searchFunction=this.wordByWordSearch},setOptions:function(t){this.rawOptions=t,this.visibleOptions=this.rawOptions.slice(),this.selectedOption&&this.setValue(this.selectedOption.value)},setDisabled:function(t){this.disabled=t,this.open&&this.hide(),this.d3El.classed("disabled",t)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.rawOptions,function(i){return i.value==t}),this.updateTitle(),this.renderOptions()},getValue:function(){return this.selectedOption?this.selectedOption.value:null},toggle:function(){this.disabled||this.open?this.hide():this.show(),d3.event&&d3.event.stopPropagation()},show:function(){var t=this.$el.attr("id")+"-list",i=(this.selectedOption&&this.selectedOption.value,this.$el.height()+this.$el.offset().top),e=$(window).height()-i<250;if(!this.disabled){this.d3El.classed("open",!0),this.$dropdown.slideDown(250),this.d3El.classed("flipped",e);var s=this.$searchInput.parent().width()-this.$searchInput.next().outerWidth();this.$searchInput.innerWidth(s),this.renderOptions(),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.scrollItemIntoView(),this.$searchInput.focus(),this.open=!0}},hide:function(){var t=this;this.$dropdown.slideUp(250),this.d3El.classed("open",!1),this.clearSearch(),this.$searchInput.is(":focus")&&window.setTimeout(function(){t.$el.focus()},0),this.open=!1},clearSearch:function(){this.$searchInput.val(""),this.visibleOptions=this.rawOptions.slice()},renderOptions:function(){var t=this,i=this.d3OptionList.selectAll("li").data(this.visibleOptions),e=this.$el.attr("id")+"-list";i.attr("id",function(t){return e+"-"+t.value}).classed("active",function(i){return!!t.selectedOption&&i.value==t.selectedOption.value}).classed("highlight",function(i,e){return e==t.highlightIndex}).select("span").text(function(t){return t.label}),i.enter().append("li").attr("id",function(t){return e+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(i){return!!t.selectedOption&&i.value==t.selectedOption.value}).classed("highlight",function(i,e){return e==t.highlightIndex}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}).append("span").text(function(t){return t.label}).on("click",function(i){return d3.event.stopPropagation(),t.optionClick(i.value)}),i.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id")+"-list",i=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,e=i?t+"-"+i.value:null,s=null;if(e){s=$("#"+e);var n=this.$list.scrollTop(),h=this.$list.height(),o=s.position()?s.position().top:0,l=s.height(),c=this.$searchDiv.position().top+this.$searchDiv.height()+5;(o<c||o+l>h+c)&&this.$list.scrollTop(n-c+o-h/2+l/2)}},updateTitle:function(){this.selectedOption&&this.selectedOption.value!=ATEmptyGuidString?this.d3Label.text(this.selectedOption.label):this.d3Label.html(this.noOptionPlaceholder)},optionClick:function(t){this.focusHasResumed=!0,this.selectedOption=_.find(this.visibleOptions,function(i){return i.value==t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.updateTitle(),this.hide(),this.trigger("change")},divKeyDownHandler:function(t){var i=!1;switch(t.keyCode||t.which){case 13:this.open||(this.$el.closest("form").submit(),i=!0);break;case 38:case 40:this.open||(this.show(),i=!0)}return this.renderOptions(),!i},searchKeyDownHandler:function(t){var i=!1;switch(t.keyCode||t.which){case 9:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),i=!1;break;case 13:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),i=!0;break;case 27:this.open&&(this.hide(),i=!0);case 38:-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,i=!0;break;case 40:-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,i=!0}return this.renderOptions(),!i},inputHandler:function(){var t=this.$searchInput.val().toLocaleLowerCase();if(this.$searchInput.data("lastval")!=this.$searchInput.val()){this.$searchInput.val();this.visibleOptions=this.searchFunction(t,this.rawOptions),this.highlightIndex=0,this.renderOptions(),0==this.visibleOptions.length&&(this.highlightIndex=-1)}},wordByWordSearch:function(t,i){var e=[],s=t.split(" ");return 0==t.length?i.slice():(_.each(i,function(t){var i=t.label.toLocaleLowerCase().split(" "),n=0;_.each(s,function(t){t.length&&_.each(i,function(i){0==i.indexOf(t)&&n++})}),n>0&&(t.matchCount=n,e.push(t))}),e.sort(function(t,i){return i.matchCount-t.matchCount}),e)},matchAnywhereSearch:function(t,i){var e=[];return 0==t.length?i:(_.each(i,function(t){t.label.toLocaleLowerCase().indexOf(lowerStr)>-1&&e.push(t)}),e)},focusHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},listScrollHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},blurHandler:function(){var t=this;this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout&&clearTimeout(ATSearchDropDownGlobalTimeout),ATSearchDropDownGlobalTimeout=setTimeout(function(){t.focusLost()},100)},searchFocus:function(){this.focusHasResumed=!0},focusLost:function(){this.focusHasResumed||this.hide(),this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout=null}});module.exports=ATSearchDropdown;

},{"../../model/ATEmptyGuidString":26,"./templates/searchDropdownTemplate.html":170,"backbone":220,"d3":320,"jquery":331,"lodash":333}],96:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/searchableContextMenuTemplate.html");const CREATE_NEW_FLAG="__create_new__";var ATSearchableContextMenu=Backbone.View.extend({setSearchCallback:function(t){this.searchCallback=fn},setAllowNewItems:function(t){this.allowNewItems=t},setOptions:function(t){this.rawOptions=t.slice(),this.allowNewItems&&(this.createNewLabel={value:CREATE_NEW_FLAG,label:"Create New"},this.rawOptions.push(this.createNewLabel)),this.visibleOptions=this.rawOptions.slice(),this.selectedOption&&this.setValue(this.selectedOption.value)},setNoOptionPlaceholder:function(t){this.noOptionPlaceholder=t},setValue:function(t){this.selectedOption=_.find(this.rawOptions,function(e){return e.value==t}),this.renderOptions()},getValue:function(){return this.selectedOption?this.wasNewItemSelected()?null:this.selectedOption.value:null},wasNewItemSelected:function(){return!!this.selectedOption&&this.selectedOption.value==CREATE_NEW_FLAG},getNewItemText:function(){return this.wasNewItemSelected()?this.createNewText:null},initialize:function(){var t=this.$el.attr("id"),e=t+"-searchInput",i=t+"-list",s=_.template(templateHtml),n=this;this.rawOptions=[],this.visibleOptions=this.rawOptions.slice(),this.allowNewItems=!0,this.createNewText="",this.open=!1,this.selectedOption=null,this.highlightIndex=-1,this.searchCallback=null,this.$el.html(s({elementName:t})),this.d3El=d3.select("#"+t),this.d3El.classed("searchContextMenu bselect-dropdown",!0).style("display","none"),this.$el.keydown(function(t){return n.divKeyDownHandler(t)}).on("focus",function(){n.focusHandler()}).on("blur",function(){n.blurHandler()}),this.$searchDiv=$(this.d3El.select(".bselect-search").node()),this.d3SearchInput=this.d3El.select("#"+e).on("input",function(){n.inputHandler()}).on("blur",function(){n.blurHandler()}),this.$searchInput=$("#"+e),this.$searchInput.keydown(function(t){return n.searchKeyDownHandler(t)}),this.$searchInput.on("focus",this.searchFocus.bind(this)),this.d3El.select(".bselect-search-icon").on("click",function(){n.$searchInput.focus()}),this.d3OptionList=this.d3El.select(".bselect-option-list").attr("id",i),this.$list=$("#"+i),this.$list.on("scroll",this.listScrollHandler.bind(this))},show:function(t,e,i){this.highlightIndex=-1,this.renderOptions();var s=this.$el.attr("id")+"-list",n=(this.selectedOption&&this.selectedOption.value,t.offset()),h=(t.outerWidth(),t.outerHeight()),l=$(window).width(),o=$(window).height(),a=this.$el.width(),c=this.$el.height(),r=isNaN(e)||isNaN(i)?{left:Math.min(n.left,l-a-5),top:n.top+h}:{left:Math.min(n.left+e,l-a-5),top:n.top+i};r.top+c>o-10?(this.d3El.style("left",r.left+"px"),this.d3El.style("bottom",o-n.top+4+"px"),this.d3El.style("top",null)):(this.d3El.style("left",r.left+"px"),this.d3El.style("top",r.top+"px"),this.d3El.style("bottom",null)),this.d3El.classed("open",!0),this.$el.slideDown(250);var u=this.$searchInput.parent().width()-this.$searchInput.next().outerWidth();this.$searchInput.innerWidth(u),this.$searchInput.attr("placeholder","Search"+(this.allowNewItems?" or create new":"")+"..."),this.$searchInput.focus(),this.open=!0},hide:function(){this.$el.slideUp(250),this.d3El.classed("open",!1),this.clearSearch(),this.open=!1},clearSearch:function(){this.$searchInput.val(""),this.visibleOptions=this.rawOptions.slice()},renderOptions:function(){var t=this,e=this.d3OptionList.selectAll("li").data(this.visibleOptions),i=this.$el.attr("id")+"-list";e.attr("id",function(t){return i+"-"+t.value}).classed("active",function(e){return!!t.selectedOption&&e.value==t.selectedOption.value}).classed("highlight",function(e,i){return i==t.highlightIndex}).select("span").text(function(t){return t.label}),e.enter().append("li").attr("id",function(t){return i+"-"+t.value}).classed("bselect-option",!0).attr("role","option").classed("active",function(e){return!!t.selectedOption&&e.value==t.selectedOption.value}).classed("highlight",function(e,i){return i==t.highlightIndex}).on("click",function(e){return d3.event.stopPropagation(),t.optionClick(e.value)}).append("span").text(function(t){return t.label}).on("click",function(e){return d3.event.stopPropagation(),t.optionClick(e.value)}),e.exit().remove(),this.scrollItemIntoView()},scrollItemIntoView:function(){var t=this.$el.attr("id")+"-list",e=this.highlightIndex>0?this.visibleOptions[this.highlightIndex]:null,i=e?t+"-"+e.value:null,s=null;if(i){s=$("#"+i);var n=this.$list.scrollTop(),h=this.$list.height(),l=s.position()?s.position().top:0,o=s.height(),a=this.$searchDiv.position().top+this.$searchDiv.height()+5;(l<a||l+o>h+a)&&this.$list.scrollTop(n-a+l-h/2+o/2)}},optionClick:function(t){this.focusHasResumed=!0,this.selectedOption=_.find(this.visibleOptions,function(e){return e.value==t}),this.highlightIndex=_.indexOf(this.visibleOptions,this.selectedOption),this.hide(),this.trigger("change")},divKeyDownHandler:function(t){var e=!1;switch(t.keyCode||t.which){case 13:this.open||(this.show(),e=!0)}return this.renderOptions(),!e},searchKeyDownHandler:function(t){var e=!1;switch(t.keyCode||t.which){case 9:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!1;break;case 13:this.highlightIndex>=0?this.optionClick(this.visibleOptions[this.highlightIndex].value):this.hide(),e=!0;break;case 27:this.open&&(this.hide(),e=!0);case 38:-1==this.highlightIndex?this.highlightIndex=this.visibleOptions.length-1:this.highlightIndex>0&&this.highlightIndex--,e=!0;break;case 40:-1==this.highlightIndex?this.highlightIndex=0:this.highlightIndex<this.visibleOptions.length-1&&this.highlightIndex++,e=!0}return this.renderOptions(),!e},inputHandler:function(){var t=this,e=(i=this.$searchInput.val()).toLocaleLowerCase();if(this.$searchInput.data("lastval")!=this.$searchInput.val()){var i=this.$searchInput.val();this.searchCallback?this.visibleOptions=this.searchCallback(i):0==i.length?(this.visibleOptions.length=0,_.each(this.rawOptions,function(e){e.value!=CREATE_NEW_FLAG&&t.visibleOptions.push(e)})):(this.visibleOptions.length=0,_.each(this.rawOptions,function(s){s.label.toLocaleLowerCase().indexOf(e)>-1&&t.visibleOptions.push(s),t.allowNewItems&&s.value==CREATE_NEW_FLAG&&(s.label='Create New: "'+i+'"',t.visibleOptions.push(s))})),this.createNewText=i,this.highlightIndex=0,this.renderOptions(),0==this.visibleOptions.length&&(this.highlightIndex=-1)}},focusHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},listScrollHandler:function(){this.open&&(this.focusHasResumed=!0,this.$searchInput.focus())},blurHandler:function(){var t=this;this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout&&clearTimeout(ATSearchDropDownGlobalTimeout),ATSearchDropDownGlobalTimeout=setTimeout(function(){t.focusLost()},200)},searchFocus:function(){this.focusHasResumed=!0},focusLost:function(){this.focusHasResumed||this.hide(),this.focusHasResumed=!1,ATSearchDropDownGlobalTimeout=null},clearStr:function(){this.createNewText=""}});module.exports=ATSearchableContextMenu;

},{"./templates/searchableContextMenuTemplate.html":171,"backbone":220,"d3":320,"jquery":331,"lodash":333}],97:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),jstree=require("jstree"),ATPoint=require("../../utils/ATPoint"),ProgressBar=require("progressbar.js"),ATSearchableContextMenu=require("./ATSearchableContextMenu"),ATSearchDropdown=require("./ATSearchDropdown"),ATViewMode=require("../ATViewMode"),ATUtilities=require("../../utils/ATUtilities"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),templateHtml=require("./templates/syncBinderTemplate.html"),linkEventHtml=require("./templates/syncLinkWithEventTemplate.html"),statusPopoverHtml=require("./templates/syncItemStatusPopoverTemplate.html"),dhtmlXMenuObject=require("../../../lib/dhtmlxmenu"),defaultPlacement=function(e,t){return function(){var n=e.offset(),i=e.width(),s=e.height(),a=n.left+i/2,o=n.top+s/2,r=$(window).width(),c=$(window).height();return"left"==t||"right"==t?o<c/3?t+"Top":o>2*c/3?t+"Bottom":t:"top"==t||"bottom"==t?a<r/3?t+"Left":a>2*r/3?t+"Right":t:t}},ATSyncBinderView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=this,n=_.template(templateHtml);this.minWidth=250,this.maxWidth=400,this.currentWidthWhenOpen=350,this.draggedEventsToCreate={},this.linkEventTemplate=_.template(linkEventHtml),this.statusPopoverTemplate=_.template(statusPopoverHtml),this.d3El=d3.select("#"+e),this.d3El.html(n({})),this.errorMsg=null,this.errorIsLoading=!1,this.d3ErrorDiv=d3.select("#syncBinderErrorDiv"),this.$errorMessageDiv=$("#syncBinderErrorMessage"),this.resizeDrag=d3.behavior.drag().on("dragstart",this.resizeDragStarted.bind(this)).on("drag",this.resizeDragged.bind(this)).on("dragend",this.resizeDragEnded.bind(this)),d3.select("#syncBinderResizeGrabber").call(this.resizeDrag),this.syncData={},this.jsonTreeData=[],this.progressShowing=!1,this.disableClose=!1,this.settingsButtonsEnabled=!1,this.showUnchangedItems=!0,this.showIgnoredItems=!0,this.syncProjectIsLoading=!1,this.binderSearchTerm=null,this.dropOnlyInFolder=!0,this.d3TopRowDiv=this.d3El.select("#syncBinderTopRow"),this.$syncBinderTitle=this.$("#syncBinderTitle"),$("#syncBinderCloseButton").on("click",this.closeClicked.bind(this)),$("#syncBinderSyncButton").on("click",this.updateAllClicked.bind(this)),$("#syncBinderSettingsButton").on("click",this.syncSettingsClicked.bind(this)),this.$syncBinderTitle.on("click",function(){return t.syncData&&t.syncData.projectPath&&window.ApplicationInterface&&window.ApplicationInterface.revealExternalLink(window.timelineDocumentId,t.syncData.projectPath),!1}),$("#syncBinderTryAgainButton").on("click",this.tryAgainClicked.bind(this)),$("#syncBinderUnchangedCheckbox").on("click",this.unchangedCheckboxClicked.bind(this)),$("#syncBinderIgnoredCheckbox").on("click",this.ignoredCheckboxClicked.bind(this)),this.d3TreeContainer=d3.select("#syncBinderTreeContainer"),this.$treeContainer=$("#syncBinderTreeContainer"),this.d3BinderFilterOptions=d3.select("#syncBinderFilter"),this.d3HomeTabButton=d3.select("#syncBinderTabHome").on("click",function(){t.switchTab(0)}),this.d3WarningsTabButton=d3.select("#syncBinderTabWarnings").on("click",function(){t.switchTab(1)}),this.d3EventsTabButton=d3.select("#syncBinderTabEvents").on("click",function(){t.switchTab(2)}),this.d3WarningsCount=d3.select("#syncBinderWarningsCount"),this.d3EventsCount=d3.select("#syncBinderEventsCount"),this.activeTab=0,this.openNodeIdsPerTab={0:[],1:[],2:[]},this.openNodeIds=[],this.currentScrollTop=0,this.showActiveTab(),this.$treeContainer.jstree({core:{check_callback:t.treeCallback.bind(t),data:function(e,n){return n.call(this,t.jsonTreeData)},dblclick_toggle:!1},plugins:["questionmark","wholerow","dnd","types","search"],dnd:{large_drag_target:!0,large_drop_target:!0,is_draggable:function(e,n){if(0!=t.activeTab)return n&&n.preventDefault(),!1;for(var i=0,s=e.length;i<s;i++)if("draft"==e[i].type||"research"==e[i].type||"trash"==e[i].type)return n&&n.preventDefault(),!1;return!0}},types:{default:{icon:"fa fa-file-text-o"},document:{icon:"fa fa-file-text-o"},folder:{icon:"fa fa-folder"},draft:{icon:"fa fa-book"},research:{icon:"fa fa-newspaper-o"},trash:{icon:"fa fa-trash-o"},image:{icon:"fa fa-file-image-o"},pdf:{icon:"fa fa-file-pdf-o"},media:{icon:"fa fa-movie"},web:{icon:"fa fa-file-archive-o"},icloud:{icon:"fa fa-cloud"},onmymac:{icon:"fa fa-hdd-o"},conflicts:{icon:"fa fa-exclamation-triangle"},deletedEvents:{icon:"fa fa-minus-circle"},newItems:{icon:"fa fa-question-circle"},deletedItems:{icon:"fa fa-minus-circle"},newEvents:{icon:"fa fa-question-circle"}},search:{show_only_matches:!0}}),this.folderTypes=["folder","draft","research","trash","icloud","onmymac"],this.jsTreeInstance=this.$treeContainer.jstree(!0),$(document).on("dnd_move.vakata",t.binderDragAndDropMove.bind(t)).on("dnd_stop.vakata",t.binderDragAndDropRelease.bind(t)),this.$treeContainer.on("move_node.jstree",t.binderMoveNode.bind(t)),this.$treeContainer.on("rename_node.jstree",t.binderRenameNode.bind(t)),this.$treeContainer.on("open_node.jstree",function(e,n){-1==_.indexOf(t.openNodeIds,n.node.id)&&t.openNodeIds.push(n.node.id),t.openNodeIdsPerTab[""+t.activeTab]=_.clone(t.openNodeIds),window.ApplicationInterface&&window.ApplicationInterface.expandedSyncItemsChanged(window.timelineDocumentId,t.openNodeIds.join(),t.activeTab)}),this.$treeContainer.on("close_node.jstree",function(e,n){t.openNodeIds=_.without(t.openNodeIds,n.node.id),t.openNodeIdsPerTab[""+t.activeTab]=_.clone(t.openNodeIds),window.ApplicationInterface&&window.ApplicationInterface.expandedSyncItemsChanged(window.timelineDocumentId,t.openNodeIds.join(),t.activeTab)}),this.$treeContainer.on("select_node.jstree",t.changeSelection.bind(t)),this.$treeContainer.on("deselect_node.jstree",t.changeSelection.bind(t)),this.$treeContainer.on("refresh.jstree",t.binderRefreshFinished.bind(t)),this.$treeContainer.on("contextmenu",".jstree-anchor",this.showContextMenu.bind(this)),this.$treeContainer.on("click.jstree",".syncBinder-item-status",this.itemStatusClick.bind(this)),this.$treeContainer.on("dblclick",".jstree-anchor",this.itemDblClick.bind(this)),this.eventSearchContextMenu=new ATSearchableContextMenu({el:"#syncBinderLinkEventSearch"}),this.eventSearchContextMenu.setAllowNewItems(!1),this.listenTo(this.eventSearchContextMenu,"change",this.contextEventLinkClick.bind(this)),this.$("#syncBinderSearch").on("input",this.filterBinder.bind(this)),this.$("#syncBinderSearch").on("focus",function(){t.$("#syncBinderSearchDiv").addClass("focused")}),this.$("#syncBinderSearch").on("blur",function(){t.$("#syncBinderSearchDiv").removeClass("focused")}),this.$(".binder-search-clear-icon").on("click",this.filterClear.bind(this)),this.progressBarLine=new ProgressBar.Line("#syncBinderProgressDiv",{strokeWidth:1,trailWidth:1,color:"#2185d0",trailColor:"#ccc",svgStyle:{height:"3px",width:"100%"}})},resize:function(){},resizeDragStarted:function(e){},resizeDragged:function(e){var t,n=d3.event.sourceEvent.clientX;this.resizeDragStartX||(this.resizeDragStartX=n,this.resizeDragOriginalWidth=this.$el.innerWidth()),(t=this.resizeDragOriginalWidth+(n-this.resizeDragStartX))<this.minWidth?t=this.minWidth:t>this.maxWidth&&(t=this.maxWidth),this.currentWidthWhenOpen=t,window.mainApp.resizeSyncBinder(t),window.ApplicationInterface&&window.ApplicationInterface.setSyncBinderWidth(window.timelineDocumentId,t)},resizeDragEnded:function(e){this.resizeDragStartX=null,this.originalWidth=null},switchTab:function(e){this.activeTab!=e&&(this.activeTab=e,this.showActiveTab())},showActiveTab:function(){0==this.activeTab?(this.d3HomeTabButton.classed("selectedTab",!0),this.d3WarningsTabButton.classed("selectedTab",!1),this.d3EventsTabButton.classed("selectedTab",!1)):1==this.activeTab?(this.d3HomeTabButton.classed("selectedTab",!1),this.d3WarningsTabButton.classed("selectedTab",!0),this.d3EventsTabButton.classed("selectedTab",!1)):(this.d3HomeTabButton.classed("selectedTab",!1),this.d3WarningsTabButton.classed("selectedTab",!1),this.d3EventsTabButton.classed("selectedTab",!0)),this.openNodeIds=this.openNodeIdsPerTab[""+this.activeTab]?this.openNodeIdsPerTab[""+this.activeTab]:[],this.restoreStateAfterRefresh=!0,this.pruneTree()},receiveDrag:function(e,t,n){var i=this;0!=this.activeTab?(this.waitingDragStartCallback=function(){i.startEventDragIntoTree(e,t,n)},this.switchTab(0)):this.startEventDragIntoTree(e,t,n)},startEventDragIntoTree:function(e,t,n){$.vakata.dnd.start(e,t,'<div id="jstree-dnd" class="jstree-default"><i class="jstree-icon jstree-er"></i>'+n+"</div>")},setRemoteProgress:function(e){this.progressShowing=e.show,this.disableClose=e.disableClose,this.d3TopRowDiv.classed("progressShowing",this.progressShowing),this.$("#syncBinderCloseButton").toggleClass("disabled",this.disableClose),this.progressShowing?this.$syncBinderTitle.text(e.label):this.syncData?this.$syncBinderTitle.text("Project: "+this.syncData.projectName):this.$syncBinderTitle.text("Project"),this.progressBarLine.set(e.progress)},setSyncData:function(e){this.reopenPopoverTargetAfterRefresh=null,this.syncDataStr=e,this.currentScrollTop=this.$treeContainer.scrollTop(),this.errorMsg=null,this.errorIsLoading=!1,this.d3ErrorDiv.style("display","none"),this.d3TreeContainer.style("display",null),this.settingsButtonsEnabled=!0,this.syncData=JSON.parse(this.syncDataStr),this.syncData.expandedItems&&(this.openNodeIdsPerTab=_.cloneDeep(this.syncData.expandedItems),this.openNodeIds=this.openNodeIdsPerTab[""+this.activeTab]?this.openNodeIdsPerTab[""+this.activeTab]:[],this.restoreStateAfterRefresh=!0),this.showActiveTab(),this.settingsButtonsEnabled=!0,d3.select("#syncBinderSettingsButton").classed("disabled",!1);var t=JSON.stringify(this.syncData.warningsTree),n=JSON.stringify(this.syncData.eventsTree),i=ATUtilities.countOccurrencesOfSubstring(t,'"status":"syncStatusConflict"'),s=ATUtilities.countOccurrencesOfSubstring(t,'"status":"syncStatusEventDeleted"'),a=i+s+ATUtilities.countOccurrencesOfSubstring(t,'"status":"syncStatusNewItem"'),o=ATUtilities.countOccurrencesOfSubstring(n,'"status":"syncStatusItemDeleted"'),r=o+ATUtilities.countOccurrencesOfSubstring(n,'"status":"syncStatusNewEvent"');d3.select("#syncBinderSyncButton").classed("disabled",i>0).attr("title",i?i+" conflict"+(1==i?"":"s")+" must be resolved":"Update All"),this.d3WarningsCount.classed("conflictCount",i>0).classed("warningCount",0==i&&s>0).text(a),this.d3EventsCount.classed("warningCount",o>0).text(r)},pruneTree:function(){var e=this;this.waitingForRefresh=!0,this.syncDataStr&&(this.syncData=JSON.parse(this.syncDataStr),this.progressShowing||this.$syncBinderTitle.text("Project: "+this.syncData.projectName),this.dropOnlyInFolder="Ulysses"==this.syncData.projectType,0==this.activeTab?this.jsonTreeData=this.syncData.binderTree:1==this.activeTab?this.jsonTreeData=this.syncData.warningsTree:this.jsonTreeData=this.syncData.eventsTree,this.jsonTreeData=_.filter(this.jsonTreeData,function(t){return e.pruneItemNode(t)}),this.insideTreeRefresh=!0,this.jsTreeInstance.refresh(!0),this.insideTreeRefresh=!1,this.restoreStateAfterRefresh=!0)},pruneItemNode:function(e){var t=this,n=!0;return e.children=_.filter(e.children,function(e){return t.pruneItemNode(e)}),"syncStatusIgnored"!=e.data.status||this.showIgnoredItems?"syncStatusUnchanged"!=e.data.status||this.showUnchangedItems||(n=!1):n=!1,e.children.length>0||n},binderRefreshFinished:function(){var e=this;this.waitingForRefresh=!1,this.restoreStateAfterRefresh&&_.each(this.openNodeIds,function(t){e.jsTreeInstance.open_node(t,null,!1)}),this.$treeContainer.scrollTop(this.currentScrollTop),this.editItemAfterRefresh&&this.editItemInBinder(this.editItemAfterRefresh),this.itemStatusData&&this.requestItemStatusData(this.itemStatusData.itemId),this.waitingDragStartCallback&&(this.waitingDragStartCallback(),this.waitingDragStartCallback=null),this.editItemAfterRefresh=!1,this.reopenPopoverTargetAfterRefresh=null,this.changeSelection(),this.filterBinder(),this.setSyncBinderIsLoading(this.errorIsLoading)},setErrorMessage:function(e,t){this.errorMsg=e,this.errorIsLoading=t,e&&(this.$errorMessageDiv.html(e),this.d3ErrorDiv.style("display",null),this.d3TreeContainer.style("display","none"),this.settingsButtonsEnabled=!1,d3.select("#syncBinderSyncButton").classed("disabled",!0),d3.select("#syncBinderSettingsButton").classed("disabled",!0),d3.select("#syncBinderTryAgainDiv").style("display",t?"none":null),this.setSyncBinderIsLoading(t),this.jsonTreeData=[],this.jsTreeInstance.refresh(!0))},setSyncBinderIsLoading:function(e){var t=e?"disabled":null;this.syncProjectIsLoading=e,$("#itemStatusSyncBtn").prop("disabled",t),$("#itemStatusUnlinkBtn").prop("disabled",t),$("#itemStatusCreateEventBtn").prop("disabled",t),$("#itemStatusIgnoreBtn").prop("disabled",t),$("#itemStatusTrashBtn").prop("disabled",t),d3.selectAll(".syncItemStatusLoading").classed("notLoading",!e),$("#syncBinderSyncButton").toggleClass("disabled",e),$("#syncBinderSettingsButton").toggleClass("disabled",e),$("#syncBinderUnchangedCheckbox").prop("disabled",t),$("#syncBinderIgnoredCheckbox").prop("disabled",t),$("#syncBinderTabHome").prop("disabled",t),$("#syncBinderTabWarnings").prop("disabled",t),$("#syncBinderTabEvents").prop("disabled",t),d3.select("#syncBinderSyncButton").classed("fa-refresh",!e).classed("fa-spinner",e).classed("fa-spin",e)},filterBinder:function(){this.binderSearchTerm=this.$("#syncBinderSearch").val(),this.binderSearchTerm?(this.$("#syncBinderSearchDiv").removeClass("emptyText"),this.jsTreeInstance.search(this.binderSearchTerm)):(this.$("#syncBinderSearchDiv").addClass("emptyText"),this.jsTreeInstance.clear_search())},filterClear:function(){this.$("#syncBinderSearchDiv").addClass("emptyText"),this.binderSearchTerm=null,this.$("#syncBinderSearch").val(""),this.$("#syncBinderSearchDiv").removeClass("focused"),this.jsTreeInstance.clear_search()},expandItemInBinder:function(e){var t,n=e.split(","),i=n.length;for(t=0;t<i;t++)this.jsTreeInstance.open_all(n[t])},collapseItemInBinder:function(e){var t,n=e.split(","),i=n.length;for(t=0;t<i;t++)this.jsTreeInstance.close_all(n[t])},editItemInBinder:function(e){this.waitingForRefresh?this.editItemAfterRefresh=e:(this.jsTreeInstance._data.core.li_height=24,this.jsTreeInstance.edit(e))},binderRenameNode:function(e,t){window.ApplicationInterface&&window.ApplicationInterface.renameSyncItem(window.timelineDocumentId,t.node.id,t.text)},treeCallback:function(e,t,n,i,s){if("move_node"==e){if(t.eventId&&_.includes(this.syncData.linkedEvents,t.eventId))return!1;if(this.dropOnlyInFolder&&_.indexOf(this.folderTypes,n.type)<0)return!1}return"copy_node"!=e||!(this.dropOnlyInFolder&&_.indexOf(this.folderTypes,n.type)<0)&&(t.eventId&&(_.includes(this.syncData.linkedEvents,t.eventId)||(_.isEmpty(this.draggedEventsToCreate)&&(this.draggedEventsToCreate.parent=n.id,this.draggedEventsToCreate.position=i,this.draggedEventsToCreate.eventIds=[]),this.draggedEventsToCreate.eventIds.push(t.eventId))),!1)},binderMoveNode:function(e,t){window.ApplicationInterface&&window.ApplicationInterface.moveSyncItemsToParent(window.timelineDocumentId,t.node.id,t.parent,t.position)},binderDragAndDropMove:function(e,t){var n=this,i=!0;if(t.data.jstree&&t.data.origin){var s=$(t.event.target);nodeIds=t.data?t.data.nodes:[],_.each(nodeIds,function(e){var t=n.jsTreeInstance.get_node(e);t?"syncStatusNewItem"!=t.data.status&&"syncStatusIgnore"!=t.data.status?i=!1:"draft"!=t.type&&"research"!=t.type&&"trash"!=t.type||(i=!1):i=!1}),s.closest(".jstree").length||(s.closest(".contentDiv").length&&i&&0!=nodeIds.length?t.helper.find(".jstree-icon").removeClass("jstree-er").addClass("jstree-ok"):t.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"))}},binderDragAndDropRelease:function(e,t){var n,i=this,s=window.mainApp.timelineView,a=window.mainApp.relationshipView,o=$(t.event.target),r=(t.event.altKey,!0);if(t.data.draggingEvents)return window.ApplicationInterface&&this.draggedEventsToCreate.eventIds&&this.draggedEventsToCreate.eventIds.length&&window.ApplicationInterface.createSyncItemsFromEvents(window.timelineDocumentId,this.draggedEventsToCreate.eventIds.join(),this.draggedEventsToCreate.parent,this.draggedEventsToCreate.position),void(this.draggedEventsToCreate={});t.data.jstree&&t.data.origin&&(n=t.data.nodes,_.each(n,function(e){var t=i.jsTreeInstance.get_node(e);t?"syncStatusNewItem"!=t.data.status&&"syncStatusIgnore"!=t.data.status?r=!1:"draft"!=t.type&&"research"!=t.type&&"trash"!=t.type||(r=!1):r=!1}),r&&(o.closest(".jstree").length||o.closest(".contentDiv").length&&(s.viewMode==ATViewMode.TIMELINE_VIEW?s.dropSyncItem(n.join(),t.event.clientX,t.event.clientY):a.dropSyncItem(n.join(),t.event.clientX,t.event.clientY))))},changeSelection:function(){var e=this.jsTreeInstance.get_selected(),t=this.jsTreeInstance.get_selected(!0),n=null,i=0==this.activeTab,s=2==this.activeTab;_.each(t,function(e){null==n?n=e.data.status:e.data.status!=n&&(n="syncStatusVariable")}),null==n&&(n="syncStatusVariable"),window.ApplicationInterface&&window.ApplicationInterface.changeSyncItemSelection(window.timelineDocumentId,e.join(),i,s,n)},showContextMenu:function(e){var t=this.jsTreeInstance.get_node(e.target),n=t?t.id:null,i=this.jsTreeInstance.get_selected(),s=this.jsTreeInstance.get_selected(!0),a=t&&t.data?t.data.status:"syncStatusVariable",o=0==this.activeTab,r=2==this.activeTab;0!=_.includes(i,n)&&0!=s.length||(s=[t],i=[n]),"syncStatusChangedEvent"!=a&&"syncStatusChangedItem"!=a&&"syncStatusChangedBoth"!=a&&"syncStatusUnchanged"!=a||(a="syncStatusChangedBoth"),_.each(s,function(e){var t=e.data.status;"syncStatusChangedEvent"!=t&&"syncStatusChangedItem"!=t&&"syncStatusChangedBoth"!=t&&"syncStatusUnchanged"!=t||(t="syncStatusChangedBoth"),t!=a&&(a="syncStatusVariable")}),this.syncContextMenuMouseLocation=new ATPoint(e.clientX,e.clientY),this.syncContextMenuElement=$(e.target),window.ApplicationInterface&&!this.syncProjectIsLoading&&window.ApplicationInterface.showSyncContextMenu(window.timelineDocumentId,i.join(),o,r,a,window.mainApp.defaultRangeString())},itemDblClick:function(e){var t=this.jsTreeInstance.get_node(e.target).id;if(e.target==e.currentTarget)return this.editItemInBinder(t),e.stopPropagation(),e.preventDefault(),!1;this.jsTreeInstance.toggle_node(e.target)},itemStatusClick:function(e){var t=e.target,n=this.jsTreeInstance.get_node(t).id;"2"==this.activeTab?window.mainApp.selectAndScrollToEvents(n):this.requestItemStatusData(n)},requestItemStatusData:function(e){window.ApplicationInterface&&window.ApplicationInterface.showSyncItemStatus(window.timelineDocumentId,e)},showItemStatusPopover:function(e){var t,n=this;this.removeExistingPopover(!1),"loading"==e.status?e.syncStatusIcon="fa-spinner fa-spin":"conflict"==e.status?e.syncStatusIcon="fa-exclamation-triangle":"itemDeleted"==e.status||"eventDeleted"==e.status?e.syncStatusIcon="fa-minus-circle":"unchanged"==e.status?e.syncStatusIcon="fa-check-circle":"changedEvent"==e.status||"changedItem"==e.status||"changedBoth"==e.status?e.syncStatusIcon="fa-exclamation-circle":e.syncStatusIcon="fa-question-circle",this.itemStatusData=e,this.$itemStatusPopoverTarget||(this.$itemStatusPopoverTarget=$('<div class="popoverFixedTarget" />'),this.$itemStatusPopoverTarget.appendTo(document.body));var i=this.jsTreeInstance.get_node(e.itemId,!0),s=i?i.children(".syncBinder-item-status"):null;s&&(this.$itemStatusPopoverTarget.width(s.width()),this.$itemStatusPopoverTarget.height(s.height()),this.$itemStatusPopoverTarget.offset(s.offset())),t=this.statusPopoverTemplate(this.itemStatusData),this.$itemStatusPopoverTarget.popover({content:t,title:"<span>Document: "+e.itemName+'</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:defaultPlacement(this.$itemStatusPopoverTarget,"right"),trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(this.$itemStatusPopoverTarget),popoverInst=this.$itemStatusPopoverTarget.data("popover"),popoverInst.tip().find(".popover-content").html(t),popoverInst.tip().find(".popover-title span").text("Document: "+e.itemName),$("#popoverClose").on("click",function(){n.removeExistingPopover(!0)}),$("#itemStatusSyncBtn").on("click",this.syncItemPopoverSyncClicked.bind(this)),$("#itemStatusUnlinkBtn").on("click",this.syncItemPopoverUnlinkClicked.bind(this)),$("#itemStatusCreateEventBtn").on("click",this.syncItemPopoverCreateEventClicked.bind(this)),$("#itemStatusIgnoreBtn").on("click",this.syncItemPopoverIgnoreClicked.bind(this)),$("#itemStatusTrashBtn").on("click",this.syncItemPopoverTrashClicked.bind(this)),this.connectItemStatusChooseButtons(),this.setSyncBinderIsLoading(this.syncProjectIsLoading)},chooseItemResolution:function(e,t,n){window.ApplicationInterface&&window.ApplicationInterface.chooseSyncItemResolution(window.timelineDocumentId,n,t,e)},connectItemStatusChooseButtons:function(){var e=this;_.each(this.itemStatusData.fields,function(t,n){$("#sync-choose-"+n+"-item").on("click",function(){e.chooseItemResolution(e.itemStatusData.itemId,n,"keepItem")}),$("#sync-choose-"+n+"-event").on("click",function(){e.chooseItemResolution(e.itemStatusData.itemId,n,"keepEvent")})})},renderJsContextMenuWithItems:function(e){var t=this,n=e.split(","),i=[],s=null,a=[],o=0;_.each(n,function(e){"-"==e?null!=s&&a.push(s):i.push({id:e,text:e}),s=e}),this.syncContextMenu?(this.syncContextMenu.clearAll(),this.syncContextMenu.loadStruct(i),_.each(a,function(e){t.syncContextMenu.addNewSeparator(e,"sep"+o),o++})):(this.syncContextMenu=new dhtmlXMenuObject({context:!0,items:i}),_.each(a,function(e){t.syncContextMenu.addNewSeparator(e,"sep"+o),o++}),this.syncContextMenu.setAutoShowMode(!1),this.syncContextMenu.setAutoHideMode(!0),this.syncContextMenu.setContextMenuHideAllMode(!1),this.syncContextMenu.attachEvent("onClick",this.syncContextMenuItemClick.bind(this))),setTimeout(function(){t.syncContextMenu.showContextMenu(t.syncContextMenuMouseLocation.x,t.syncContextMenuMouseLocation.y)})},syncContextMenuItemClick:function(e,t,n){var i=this.syncContextMenu.getItemText(e);return window.ApplicationInterface&&window.ApplicationInterface.syncContextMenuItemClicked(window.timelineDocumentId,i),!1},tryAgainClicked:function(){window.ApplicationInterface&&window.ApplicationInterface.reloadSyncBinder(window.timelineDocumentId)},unchangedCheckboxClicked:function(){this.showUnchangedItems=$("#syncBinderUnchangedCheckbox").prop("checked"),this.pruneTree(!0)},ignoredCheckboxClicked:function(){this.showIgnoredItems=$("#syncBinderIgnoredCheckbox").prop("checked"),this.pruneTree(!0)},syncSettingsClicked:function(){window.ApplicationInterface&&this.settingsButtonsEnabled&&!this.syncProjectIsLoading&&window.ApplicationInterface.showSyncSettings(window.timelineDocumentId)},closeClicked:function(){!this.disableClose&&window.ApplicationInterface&&window.ApplicationInterface.closeSyncBinder(window.timelineDocumentId)},updateAllClicked:function(){window.ApplicationInterface&&this.settingsButtonsEnabled&&!this.syncProjectIsLoading&&window.ApplicationInterface.syncUpdateAll(window.timelineDocumentId)},syncItemPopoverSyncClicked:function(){window.ApplicationInterface&&this.itemStatusData&&!this.syncProjectIsLoading&&window.ApplicationInterface.updateSyncItems(window.timelineDocumentId,this.itemStatusData.itemId)},syncItemPopoverUnlinkClicked:function(){window.ApplicationInterface&&this.itemStatusData&&!this.syncProjectIsLoading&&window.ApplicationInterface.unlinkSyncItems(window.timelineDocumentId,this.itemStatusData.itemId)},syncItemPopoverCreateEventClicked:function(){window.ApplicationInterface&&!this.syncProjectIsLoading&&"loading"!=this.itemStatusData.status&&window.ApplicationInterface.createEventsFromSyncItems(window.timelineDocumentId,this.itemStatusData.itemId,window.mainApp.defaultRangeString(),ATEmptyGuidString)},syncItemPopoverIgnoreClicked:function(){window.ApplicationInterface&&this.itemStatusData&&!this.syncProjectIsLoading&&window.ApplicationInterface.ignoreSyncItems(window.timelineDocumentId,this.itemStatusData.itemId)},syncItemPopoverTrashClicked:function(){var e=this.itemStatusData?this.itemStatusData.itemId:null;this.removeExistingPopover(!0),window.ApplicationInterface&&e&&!this.syncProjectIsLoading&&window.ApplicationInterface.trashSyncItems(window.timelineDocumentId,e)},showLinkEventPopoverForItem:function(e){var t=this.jsTreeInstance.get_node(e,!0).children(".jstree-anchor");t&&(this.linkContextEventWithSyncItem=e,this.updateEventSearchDropdown(),this.eventSearchContextMenu.show(t))},updateEventSearchDropdown:function(){var e=this.syncData.linkedEvents,t=this.model.get("events").models,n=[];_.each(t,function(e){n.push(e)}),this.addChildrenOfEventsToArray(n,t),n=_.filter(n,function(t){return!_.includes(e,t.id)}),options=[],_.each(n,function(e){options.push({value:e.id,sortValue:e.get("displayId"),label:e.get("displayId")+". "+e.get("title")})}),options.sort(function(e,t){var n=_.map(e.sortValue.split("."),function(e){return parseInt(e)}),i=_.map(t.sortValue.split("."),function(e){return parseInt(e)}),s=Math.min(n.length,i.length),a=0;for(a=0;a<s;a++)if(n[a]!=i[a])return n[a]-i[a];return n.length-i.length}),this.eventSearchContextMenu.setOptions(options)},contextEventLinkClick:function(){var e=this.eventSearchContextMenu.getValue();window.ApplicationInterface&&e&&window.ApplicationInterface.linkEventAndSyncItem(window.timelineDocumentId,e,this.linkContextEventWithSyncItem)},addChildrenOfEventsToArray:function(e,t){var n=this;_.each(t,function(t){t.children.each(function(t){e.push(t),n.addChildrenOfEventsToArray(e,[t])})})},showPopover:function(e){var t=this;this.sourceElement=e,this.$backdrop=$('<div class="backdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){t.removeExistingPopover(!0)}),e.popover("show"),window.mainApp.signalPopoverOpened()},removeExistingPopover:function(e){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&(this.$backdrop.remove(),this.$backdrop=null),this.$itemStatusPopoverTarget&&e&&this.$itemStatusPopoverTarget.offset({top:-100,left:-100}),this.itemStatusData&&(this.itemStatusData=null),window.mainApp.signalPopoverClosed()}});module.exports=ATSyncBinderView;

},{"../../../lib/dhtmlxmenu":5,"../../model/ATEmptyGuidString":26,"../../utils/ATPoint":46,"../../utils/ATUtilities":51,"../ATViewMode":53,"./ATSearchDropdown":95,"./ATSearchableContextMenu":96,"./templates/syncBinderTemplate.html":172,"./templates/syncItemStatusPopoverTemplate.html":173,"./templates/syncLinkWithEventTemplate.html":175,"backbone":220,"d3":320,"jquery":331,"jstree":332,"lodash":333,"progressbar.js":339}],98:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),templateHtml=require("./templates/syncManagerTemplate.html"),ATInspectorListView=require("./ATInspectorListView"),ATProjectManagerView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id"),t=_.template(templateHtml);this.d3El=d3.select("#"+e),this.projectList=[],this.d3El.html(t()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.d3ProjectsListElement=this.d3El.select("#syncManagerProjects"),this.projectsListView=new ATInspectorListView({el:"#syncManagerProjects"}),this.projectsListView.setUseSyncTemplate(!0),this.projectsListView.setListId(0),this.projectsListView.setRemoveCallback(this.removeProjectClicked.bind(this)),this.projectsListView.setRevealCallback(this.revealProjectClicked.bind(this)),this.projectsListView.setOpenCallback(this.openProjectClicked.bind(this)),this.projectsListView.setQuicklookCallback(this.quicklookProjectClicked.bind(this))},setProjects:function(e){this.projectList=e,this.render()},render:function(){var e=[],t=0;_.each(this.projectList,function(i){e.push({id:t,title:i.name,extra:i.fullPath,quicklookPath:i.fullPath,quicklookDisabled:!1,revealPath:i.fullPath,revealDisabled:!1,openPath:i.fullPath,openDisabled:i.openDisabled}),t++}),this.projectsListView.render(e)},removeProjectClicked:function(e,t,i){window.ApplicationInterface&&t>=0&&t<this.projectList.length&&window.ApplicationInterface.forgetSyncProject(window.timelineDocumentId,this.projectList[t].id)},quicklookProjectClicked:function(e,t,i){window.ApplicationInterface&&t>=0&&t<this.projectList.length&&window.ApplicationInterface.quicklookSingleFile(window.timelineDocumentId,this.projectList[t].fullPath,"")},revealProjectClicked:function(e,t,i){window.ApplicationInterface&&t>=0&&t<this.projectList.length&&window.ApplicationInterface.revealExternalLink(window.timelineDocumentId,this.projectList[t].fullPath)},openProjectClicked:function(e,t,i){window.ApplicationInterface&&t>=0&&t<this.projectList.length&&window.ApplicationInterface.openExternalLink(window.timelineDocumentId,this.projectList[t].fullPath,!1)}});module.exports=ATProjectManagerView;

},{"./ATInspectorListView":84,"./templates/syncManagerTemplate.html":176,"backbone":220,"d3":320,"jquery":331,"lodash":333}],99:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/syncSettingsTemplate.html"),ATSyncSettingsView=Backbone.View.extend({events:{},initialize:function(){var e=this.$el.attr("id");this.dropdowns={},this.elTemplate=_.template(templateHtml),this.settings={fields:[{name:"title",displayName:"Title",options:["Title","Synopsis"]},{name:"location",displayName:"Location",options:["Title","Location","Synopsis"]}]},this.d3El=d3.select("#"+e),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.listenTo(this.model,"change:template",this.renderTemplate),this.renderTemplate()},setScrivenerFields:function(e){this.settings=e,this.renderTemplate()},renderTemplate:function(){var e=this;this.d3El.html(this.elTemplate(this.settings)),_.each(this.settings.fields,function(t){var n=t.name,i=n.replace(/\s/g,"__space__").replace(/\[/g,"__opensq__").replace(/\]/g,"__closesq__").replace(/:/g,"__colon__").replace(/\//g,"__slash__"),s=t.value?t.value.replace(/\s/g,"__space__").replace(/\[/g,"__opensq__").replace(/\]/g,"__closesq__").replace(/:/g,"__colon__").replace(/\//g,"__slash__"):t.value,o="#syncSettingsOption"+i;e.dropdowns[n]=new ATDropdown({el:o}),e.listenTo(e.dropdowns[n],"change",e.validateForm.bind(e)),t.value?e.dropdowns[n].setValue(s):e.dropdowns[n].setValue("None")}),d3.select("#syncSettingsAutoIgnoreNonText").attr("checked",this.settings.autoIgnoreNonText?"checked":null),$("#syncSettingsAutoIgnoreNonText").on("change",this.autoIgnoreNonTextChange.bind(this)),this.$submitButton=$("#syncSettingsSubmit"),this.$submitForm=$("#syncSettingsForm"),this.$submitForm.on("submit",this.okClickHandler.bind(this))},validateForm:function(){var e=this,t=[],n=[],i=!1,s=!0;if(_.each(this.settings.fields,function(o){var a=o.name,l=e.dropdowns[a],r=l.getValue();"None"!=r&&"New Custom Field"!==r&&(_.includes(n,r)&&(s=!1,i=!0,_.includes(t,l.getText())||t.push(l.getText())),n.push(r))}),!0===i){for(var o="Error: Duplicate copies of: ",a=0;a<t.length;a++)a==t.length-1?o+='"'+t[a]+'".':o+='"'+t[a]+'", ';$("#errorFieldScrivener").text(o)}else $("#errorFieldScrivener").empty();return this.$submitButton.prop("disabled",!s),s},autoIgnoreNonTextChange:function(){this.settings.autoIgnoreNonText=$("#syncSettingsAutoIgnoreNonText").prop("checked")},okClickHandler:function(e){var t=this;if(!this.validateForm())return e.preventDefault(),!1;var n={dateFormat:0,autoIgnoreNonText:this.settings.autoIgnoreNonText,fields:[]};return _.each(this.settings.fields,function(e){var i=e.name,s=t.dropdowns[i].getValue().replace(/__space__/g," ").replace(/__opensq__/g,"[").replace(/__closesq__/g,"]").replace(/ __colon__/g,":").replace(/__slash__/g,"/");n.fields.push({name:e.name,displayName:e.displayName,type:e.type,value:s})}),window.mainApp.removeExistingModal(),window.ApplicationInterface&&window.ApplicationInterface.updateSyncSettings(window.timelineDocumentId,JSON.stringify(n)),e.preventDefault(),!1}});module.exports=ATSyncSettingsView;

},{"./ATDropdown":63,"./templates/syncSettingsTemplate.html":177,"backbone":220,"d3":320,"jquery":331,"lodash":333}],100:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATDropdown=require("./ATDropdown"),templateHtml=require("./templates/tagManagerTemplate.html"),ignore=require("../../../lib/bootstrap-tokenfield"),ATTagManagerView=Backbone.View.extend({events:{},initialize:function(){var t=this.$el.attr("id"),e=_.template(templateHtml);this.d3El=d3.select("#"+t),this.d3El.html(e()),this.d3El.classed("modal",!0).classed("fade",!0).attr("tabindex",-1).attr("role","dialog"),this.currentEditTag=null,this.$tagField=$("#tagManagerText"),this.$tagField.tokenfield({}),d3.select("#tagManagerForm .tokenfield").classed("largeHeight",!0),this.$tagField.on("tokenfield:createtoken",this.testAddTagHandler.bind(this)),this.$tagField.on("tokenfield:createdtoken",this.addTagHandler.bind(this)),this.$tagField.on("tokenfield:removedtoken",this.removeTagHandler.bind(this)),this.$tagField.on("tokenfield:editedtoken",this.editTagHandler.bind(this))},setTags:function(t){this.tagList=t,this.tagsInitialized=!1,this.$tagField.tokenfield("enable"),this.$tagField.tokenfield("setTokens",t),this.tagsInitialized=!0},testAddTagHandler:function(t){var e=t.attrs.value;return!this.tagsInitialized||!!this.currentEditTag&&(this.currentEditTag==e||!_.includes(this.tagList,e))},addTagHandler:function(t){var e=t.attrs.value;this.tagsInitialized&&(this.currentEditTag&&this.currentEditTag!=e&&(window.ApplicationInterface.editTagInAllEvents(window.timelineDocumentId,e,this.currentEditTag),this.tagList=_.without(this.tagList,this.currentEditTag),this.tagList.push(e)),this.currentEditTag=null)},removeTagHandler:function(t){var e=this,i=t.attrs.length;window.ApplicationInterface&&(i>1?_.each(t.attrs,function(t){window.ApplicationInterface.removeTagFromAllEvents(window.timelineDocumentId,t.value),e.tagList=_.without(e.tagList,t.value)}):(window.ApplicationInterface.removeTagFromAllEvents(window.timelineDocumentId,t.attrs.value),this.tagList=_.without(this.tagList,t.attrs.value)))},editTagHandler:function(t){this.currentEditTag=t.attrs.value}});module.exports=ATTagManagerView;

},{"../../../lib/bootstrap-tokenfield":3,"./ATDropdown":63,"./templates/tagManagerTemplate.html":179,"backbone":220,"d3":320,"jquery":331,"lodash":333}],101:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),Backbone=require("backbone"),dhtmlXToolbarObject=require("../../../lib/dhtmlxconcat"),dhtmlXSlider=require("../../../lib/dhtmlxslider"),dhtmlXMenuObject=require("../../../lib/dhtmlxmenu"),ignore4=require("mousetrap"),ignore5=require("../../../lib/mousetrap-global-bind"),ATToolbar=Backbone.View.extend({initialize:function(){var i=this.$el.attr("id");this.sliders={},this.textfields={},this.windowMenu=new dhtmlXMenuObject({parent:"menuDiv",icons_path:"../../../Images/"}),this.windowMenu.setOpenMode("win"),this.toolbar=new dhtmlXToolbarObject({parent:i,icons_path:"images/"}),this.sliderMinValue=0,this.sliderMaxValue=100,this.toolbar.attachEvent("onClick",this.itemClick.bind(this)),this.toolbar.attachEvent("onStateChange",this.itemStateChange.bind(this)),this.toolbar.attachEvent("onEnter",this.itemTextInput.bind(this)),this.toolbar.attachEvent("onValueChange",this.itemSliderChange.bind(this)),this.windowMenu.attachEvent("onClick",this.itemClick.bind(this)),this.shortcutMap={},this.flattenedMenuCommands=[],window.addEventListener("resize",this.resize.bind(this),!1)},setMenuCommands:function(i){var t=this,e=null;this.menuCommands=i,this.windowMenu.clearAll(),this.menuSepId=0,_.each(i,function(i){t.addTopLevelMenu(i,e),e=i.identifier}),this.mapAllShortcuts(),this.resize()},addTopLevelMenu:function(i,t){var e=this,n=0,o=null;this.windowMenu.addNewSibling(t,i.identifier,i.text,!1,null,null),i.shortcut&&(i.shortcut instanceof Array?this.windowMenu.setHotKey(i.identifier,i.shortcut[0]):this.windowMenu.setHotKey(i.identifier,i.shortcut)),_.each(i.options,function(t){e.addSubMenu(i.identifier,n,o,t),n++,o=t.identifier})},addSubMenu:function(i,t,e,n){var o=this,s=0,a=null;if("-"==n.identifier)return this.windowMenu.addNewSeparator(e,"sep"+this.menuSepId),void this.menuSepId++;this.windowMenu.addNewChild(i,t,n.identifier,n.text,!1,null,null),this.flattenedMenuCommands.push(n.identifier),n.shortcut&&(n.shortcut instanceof Array?this.windowMenu.setHotKey(n.identifier,n.shortcut[0]):this.windowMenu.setHotKey(n.identifier,n.shortcut)),n.options&&_.each(n.options,function(i){o.addSubMenu(n.identifier,s,a,i),s++,a=i.identifier})},setToolbarCommands:function(i){var t=this,e=!0;this.commands=i,this.toolbar.clearAll(),this.position=0,this.sepId=0,this.spacerId=0,this.gapId=0,this.sliders={},this.textfields={},_.each(i,function(i){e||!i.type||i.noSep||t.toolbar.addSeparator("sep"+t.sepId++,t.position++),e=!1,"button"==i.type?t.addButton(i):"buttonSelect"==i.type?t.addButtonSelect(i):"buttonTwoState"==i.type?t.addButtonTwoState(i):"input"==i.type?t.addInput(i):"slider"==i.type?t.addSlider(i):(t.toolbar.addText("spacer"+t.spacerId++,t.position++,'<div style="width: 25px;">&nbsp;</div>'),e=!0),i.center&&(t.toolbar.addSpacer(i.identifier),e=!0)}),this.mapAllShortcuts(),this.resize()},updateOptionsForIdentifier:function(i,t){var e=this,n=this.toolbar.getPosition(i),o=null,s=null;_.each(this.commands,function(t){t.identifier==i&&(o=t)}),o&&(o.options=t,this.toolbar.removeItem(i),this.addButtonSelect(o,n)),o=null,_.each(this.menuCommands,function(t){t.identifier==i&&(o=t),_.each(t.options,function(t){t.identifier==i&&(o=t)})}),o&&(_.each(o.options,function(i){e.windowMenu.removeItem(i.identifier)}),o.options=t,n=0,_.each(o.options,function(i){e.addSubMenu(o.identifier,n,s,i),n++,s=i.identifier})),this.mapAllShortcuts()},mapAllShortcuts:function(){var i=this;this.shortcutMap={},Mousetrap.reset(),_.each(this.commands,function(t){var e;t.shortcut&&(e="buttonTwoState"==t.type?i.itemStateChange.bind(i):i.itemClick.bind(i),t.shortcut instanceof Array?_.each(t.shortcut,function(n){i.mapShortcut(n,t.identifier,e)}):i.mapShortcut(t.shortcut,t.identifier,e)),"buttonSelect"==t.type&&_.each(t.options,function(e){e.shortcut&&i.mapShortcut(e.shortcut,e.identifier,i.itemClick.bind(i),t.global)})}),_.each(this.menuCommands,function(t){t.shortcut&&i.mapShortcut(t.shortcut,t.identifier,i.itemClick.bind(i),t.global),i.mapChildShortcuts(t)})},mapChildShortcuts:function(i){var t=this;_.each(i.options,function(i){i.shortcut&&(i.shortcut instanceof Array?_.each(i.shortcut,function(e){t.mapShortcut(e,i.identifier,t.itemClick.bind(t),i.global)}):t.mapShortcut(i.shortcut,i.identifier,t.itemClick.bind(t),i.global)),t.mapChildShortcuts(i)})},mapShortcut:function(i,t,e,n){var o=this,s=function(i){var n,s=!1,a=_.find(o.commands,function(i){return i.identifier==t});return _.find(o.flattenedMenuCommands,function(i){return i==t})?s=o.windowMenu.isItemEnabled(t):a?s=o.toolbar.isEnabled(t):(n=o.toolbar.getParentId(t))&&(s=o.toolbar.isListOptionEnabled(n,t)),!s||(e(t),!1)};n?Mousetrap.bindGlobal(i.toLowerCase(),s):Mousetrap.bind(i.toLowerCase(),s),window.mainApp&&window.mainApp.bindKeyEvents()},addButton:function(i){this.toolbar.addButton(i.identifier,this.position++,window.isAeonWebExport?i.text:"",i.image,i.disabledImage),this.toolbar.setItemToolTip(i.identifier,i.text)},addButtonSelect:function(i,t){var e=this,n=[],o=t||this.position++;_.each(i.options,function(i){var t,o;"-"==i.identifier?n.push(["sep"+e.sepId++,"sep"]):(o=i.shortcut?'<div class="menuShortcut">'+i.shortcut+"</div>":"",t=i.text+o,n.push([i.identifier,"obj",t,i.image]))}),this.toolbar.addButtonSelect(i.identifier,o,"",n,i.image,i.disabledImage,i.selectable,!0),this.toolbar.setItemToolTip(i.identifier,i.text)},addButtonTwoState:function(i){this.toolbar.addButtonTwoState(i.identifier,this.position++,"",i.image,i.disabledImage),this.toolbar.setItemToolTip(i.identifier,i.text)},addInput:function(i){var t,e,n=this,o="toolbarText-"+i.identifier,s=o+"-input",a=o+"-clear",r="searchClearHidden";this.toolbar.addText(i.identifier,this.position++,'<div class="toolbarSearch" id="'+o+'"><span class="toolbarSearchIcon fa fa-search"></span><input id="'+s+'" placeholder="'+(i.placeholder?i.placeholder:"")+'"><span id="'+a+'" class="toolbarSearchClear fa fa-times-circle '+r+'"></span></div>'),t=$("#"+s),e=$("#"+a),this.textfields[i.identifier]=t,t.on("focus",function(i){t.select()}),t.on("blur",function(e){t.val()||(n.itemTextInput(i.identifier,""),t.removeClass("searchError"))}),t.on("keydown",function(e){var o=e.keycode||e.which;13===o?(n.itemTextInput(i.identifier,t.val()),t.select()):27===o&&(t.val(""),t.blur(),n.itemTextInput(i.identifier,""),t.removeClass("searchError"))}),t.on("input",function(o){t.val()?e.removeClass(r):(e.hasClass(r)||e.addClass(r),n.itemTextInput(i.identifier,"")),t.removeClass("searchError")}),e.on("click",function(e){t.val(""),t.blur(),n.itemTextInput(i.identifier,""),t.removeClass("searchError")})},focusTextItem:function(i){var t=this.textfields[i];t&&(t.select(),t.focus())},markErrorTextItem:function(i,t){var e=this.textfields[i];e&&(t&&!e.hasClass("searchError")?e.addClass("searchError"):t||e.removeClass("searchError"))},addSlider:function(i,t,e,n,o){var s=this,a=t||this.position++,r=n||(i.maxWidth?i.maxWidth:250),d=e||50;sliderId="toolbarSlider-"+i.identifier,this.toolbar.addText(i.identifier,a,' <span id="'+sliderId+'"></span>'),this.toolbar.setItemToolTip(i.identifier,i.text),this.toolbar.setItemToolTipTemplate(i.identifier,""),this.sliders[i.identifier]=new dhtmlXSlider(sliderId,r,"",!1,this.sliderMinValue,this.sliderMaxValue,d,1),this.sliders[i.identifier].attachEvent("onChange",function(t,e){s.itemSliderChange(i.identifier,t)})},setDisabled:function(i,t){var e=this;_.each(i,function(i){var n;"-"!=i&&(_.includes(e.flattenedMenuCommands,i)&&(t?e.windowMenu.setItemDisabled(i):e.windowMenu.setItemEnabled(i)),(n=_.find(e.commands,function(t){return t.identifier==i}))&&("input"==n.type?e.textfields[n.identifier]&&e.textfields[n.identifier].prop("disabled",t):"slider"==n.type?e.sliders[n.identifier]&&(t?e.sliders[n.identifier].disable():e.sliders[n.identifier].enable()):t?e.toolbar.disableItem(i):e.toolbar.enableItem(i)))})},setSelectionCount:function(i){var t=this;_.each(this.commands,function(e){e.minSelectionCount&&(e.minSelectionCount>i?t.toolbar.disableItem(e.identifier):t.toolbar.enableItem(e.identifier)),"buttonSelect"==e.type&&_.each(e.options,function(n){n.minSelectionCount>i?t.toolbar.disableListOption(e.identifier,n.identifier):t.toolbar.enableListOption(e.identifier,n.identifier)})}),_.each(this.menuCommands,function(e){e.minSelectionCount&&(e.minSelectionCount>i?t.windowMenu.setItemDisabled(e.identifier):t.windowMenu.setItemEnabled(e.identifier)),t.testSelectionCountForChildren(e,i)})},testSelectionCountForChildren:function(i,t){var e=this;_.each(i.options,function(i){i.minSelectionCount&&(i.minSelectionCount>t?e.windowMenu.setItemDisabled(i.identifier):e.windowMenu.setItemEnabled(i.identifier)),e.testSelectionCountForChildren(i,t)})},setState:function(i,t){var e=_.find(this.commands,function(t){return t.identifier==i});e?this.toolbar.setItemState(i,t):t&&(e=_.find(this.commands,function(t){return _.find(t.options,function(t){return t.identifier==i})}))&&this.toolbar.setListItemSelected(e.identifier,i)},setValue:function(i,t){this.toolbar.setValue(i,t,!1)},resize:function(){if(this.toolbar){var i,t,e,n,o=this,s=this.$el.attr("id"),a=this.$el.outerWidth(),r=this.$el.outerHeight(),d=$("#"+s+" .dhxtoolbar_float_left"),l=$("#"+s+" .dhxtoolbar_float_right"),u=[];_.each(o.commands,function(i){var t,e,n;"input"==i.type?(o.toolbar.setWidth(i.identifier,i.maxWidth),u.push(i.identifier)):"slider"==i.type?(t=o.toolbar.getPosition(i.identifier),e=o.sliders[i.identifier].getValue(),n=!o.sliders[i.identifier]||o.sliders[i.identifier].isEnabled(),o.toolbar.removeItem(i.identifier),o.addSlider(i,t,e),u.push(i.identifier),n||o.sliders[i.identifier].disable()):i.type&&i.text}),d=$("#"+s+" .dhxtoolbar_float_left"),l=$("#"+s+" .dhxtoolbar_float_right"),i=d?d.outerWidth():0,t=d?d.outerHeight():0,e=l?l.outerWidth():0,n=l?l.outerHeight():0,i+e<=a-20&&t<=r&&n<=r||(_.each(this.commands,function(i){"input"==i.type&&o.toolbar.setWidth(i.identifier,i.minWidth)}),d=$("#"+s+" .dhxtoolbar_float_left"),l=$("#"+s+" .dhxtoolbar_float_right"),i=d?d.outerWidth():0,t=d?d.outerHeight():0,e=l?l.outerWidth():0,n=l?l.outerHeight():0,i+e<=a-20&&t<=r&&n<=r||_.each(this.commands,function(i){var t,e,n;"slider"==i.type&&(t=o.toolbar.getPosition(i.identifier),e=o.toolbar.getValue(i.identifier),n=!o.sliders[i.identifier]||o.sliders[i.identifier].isEnabled(),o.toolbar.removeItem(i.identifier),o.addSlider(i,t,e,i.minWidth,!0),n||o.sliders[i.identifier].disable())}))}},itemClick:function(i){var t=!!window.mainApp&&window.mainApp.formInputHasFocus();window.ApplicationInterface?window.ApplicationInterface.toolbarItemClick&&window.setTimeout(function(){window.ApplicationInterface.toolbarItemClick(window.timelineDocumentId,i,t)},10):window.isAeonWebExport&&("zoomIn"==i?window.mainApp.zoomIn():"zoomOut"==i?window.mainApp.zoomOut():"findPrevious"==i?window.mainApp.timelineView.findPrevious():"findNext"==i?window.mainApp.timelineView.findNext():"expandAllLanes"==i?window.mainApp.timelineView.expandAllLanes():"collapseAllLanes"==i?window.mainApp.timelineView.collapseAllLanes():"hideAllDetails"==i?window.mainApp.timelineView.hideAllEventDetails():"aeonLink"==i&&window.mainApp.timelineView.linkToAeonHome())},itemStateChange:function(i,t){window.ApplicationInterface&&window.ApplicationInterface.toolbarItemStateChange&&window.ApplicationInterface.toolbarItemStateChange(window.timelineDocumentId,i,t)},itemTextInput:function(i,t){window.ApplicationInterface?window.ApplicationInterface.toolbarItemTextInput&&window.ApplicationInterface.toolbarItemTextInput(window.timelineDocumentId,i,t):window.isAeonWebExport&&"search"===i&&window.mainApp.findFirst(t)},itemSliderChange:function(i,t){window.mainApp&&window.mainApp.setUnitScale(this.sliderPositionToValue(t))},setItemSliderValue:function(i,t){this.sliders[i].setValue(this.sliderValueToPosition(t))},adjustItemSliderValue:function(i,t){var e=this.sliders[i].getValue();(e+=t)<1&&(e=1),e>100&&(e=100),this.sliders[i].setValue(e),this.itemSliderChange("zoom",e)},setSliderPositionRange:function(i,t){var e=1/(this.sliderMaxValue-this.sliderMinValue);this.sliderMinPosition=i,this.sliderMaxPosition=t,this.sliderSValue=Math.pow(this.sliderMaxPosition/this.sliderMinPosition,e)},sliderPositionToValue:function(i){var t=this.sliderMaxValue-i;return this.sliderMinPosition*Math.pow(this.sliderSValue,t)},sliderValueToPosition:function(i){var t=Math.round(Math.log(i/this.sliderMinPosition)/Math.log(this.sliderSValue));return _.isNil(t)?50:this.sliderMaxValue-t}});module.exports=ATToolbar;

},{"../../../lib/dhtmlxconcat":4,"../../../lib/dhtmlxmenu":5,"../../../lib/dhtmlxslider":6,"../../../lib/mousetrap-global-bind":10,"backbone":220,"jquery":331,"lodash":333,"mousetrap":334}],102:[function(require,module,exports){
module.exports='<form class="pure-form pure-form-aligned" id="addDependency-form">\n\t<div class="pure-modal-group">\n\t\t<div class="pure-modal-field">\n\t\t    <label for="Event">Event:</label>\n\t\t    <div id="addDependencyEvent"></div>\n\t\t</div>\t\n\t\t<div class="pure-modal-field">\n    \t\t<label for="offset">Offset:</label>\n    \t\t<input type="text" class="offsetBox" name="offset" id="addDependency-offset" value="0" />\n\t\t</div>\t\n\t\t<div class="pure-modal-field">\n   \t\t\t<label for="fromSelect">From:</label>\n\t\t\t<select name="from" class="fromSelect" id="addDependency-from">\n\t\t\t\t<option value="0">End</option>\n\t\t\t\t<option value="1">Start</option>\n\t\t\t</select>\n\t\t</div>\n\t</div>\n<div class="popover-footer">\n\t<div class="pure-modal-field">\n\t\t<input type="button" class="btn btn-danger" name="deleteButton" value="Delete" style="float: left;" id="addDependency-delete" />\n    \t<input type="submit" class="btn btn-primary" name="addButton" value="OK" id="addDependency-submit"/>\n\t</div>\t\n</div>\n</form>';

},{}],103:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="addEntityWindowTitle"><%= windowTitle %></h4>\n      </div>\n\t\t<form id="addEntityForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n\t\t\t<div class="pure-modal-group">\n\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t<label for="addEntityInput">Name</label>\n\t\t\t\t\t        <input id="addEntityInput" type="text" placeholder="Enter Name...">\n\t\t\t\t</div>\t\t\n\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t<label>&nbsp;</label>\n\t\t\t\t\t<span class="textDisplay" id="addEntityWindowBelowMessage"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t  \t<div id="addEntityBirthInput">\n\t\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t\t<div class="pure-modal-heading">Birth / Creation</div>\n\t\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t    <label for="addEntityCreateEvent">Event</label>\n\t\t\t\t\t\t    <div id="addEntityCreateEvent"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="pure-modal-field sideBySide">\n\t\t\t\t\t\t    <label for="addEntityCreateOffset">Offset</label>\n\t\t\t\t\t\t\t<input type="text" id="addEntityCreateOffset" />\n\t\t\t\t\t\t    <select id="addEntityCreateOffsetFrom">\n\t\t\t\t\t\t    \t<option value="start">from start</option>\n\t\t\t\t\t\t    \t<option value="end">from end</option>\n\t\t\t\t\t\t    </select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t    <label for="addEntityCreateDate">Date</label>\n\t\t\t\t\t\t    <div id="addEntityCreateDate"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t  </div>\n\t\t</div>\n      <div class="modal-footer">\n\t    <input class="btn btn-primary" name="commit" type="submit" id="addEntitySubmit" value="OK" />\n      </div>\n\t\t</form>\n\n    </div>\n  </div>';

},{}],104:[function(require,module,exports){
module.exports='<% var loopCount = 0;\n\t_.each(roles,function(role) { \n\t\tloopCount++;\n%>\n\t<div class="pure-modal-group <%= (loopCount%2==0)?\'alternate\':\'\' %>">\n\t\t<div class="pure-modal-field">\n\t\t    <label for="addEvent-<%= role.roleId %>"><%= role.name %></label>\n\t\t    <% if(role.multiplePerEvent) { %>\n\t\t\t\t<div class="valueList" id="addEvent-<%= role.roleId%>"></div>\n\t\t\t<% } else { %>\n\t\t\t\t<div id="addEvent-<%= role.roleId%>"></div>\n\t\t\t<% } %>\n\t\t</div>\n\t</div>\t\t\t\t\t\t\n<% }); %>';

},{}],105:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content">\n\t\t<div class="modal-header">\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title" id="addEventWindowTitle">Add Event</h4>\n\t\t</div>\n\t\t<form id="addEventForm" class="pure-form pure-form-aligned">\n\t\t\t<div class="modal-body">\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="addEventTitle">Title </label>\n\t\t\t\t\t\t<input id="addEventTitle" type="text" placeholder="Title">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<label for="addEventColor">Color</label>\n\t\t\t\t\t\t\t<div id="addEventColor"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<label for="addEventParent">Parent</label>\n\t\t\t\t\t\t\t<div id="addEventParent"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<label for="addEventStartDate">Start</label>\n\t\t\t\t\t\t\t<div id="addEventStartDate"></div>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<label for="addEventDuration">Duration</label>\n\t\t\t\t\t\t\t<input type="text" name="duration" id="addEventDuration" value="">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<label for="addEventEndDate">End</label>\n\t\t\t\t\t\t\t<div id="addEventEndDate"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\t\n\t\t\t\t<div id="addEventRoleDiv"></div>\n\t\t\t\t<div id="addEventEntitySearch"></div>\t\n\x3c!--\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="addEventLane">Lane</label>\n\t\t\t\t\t\t<div id="addEventLane"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>--\x3e\n\t\t\t</div>\n\t\t\t<div class="modal-footer">\n\t\t\t\t<input id="addEventSubmit" class="btn btn-primary" name="commit" type="submit" value="Add Event" />\n\t\t\t</div>\n\t\t</form>\n\t</div>\n</div>';

},{}],106:[function(require,module,exports){
module.exports='<form id="addLink-form" class="pure-form pure-form-aligned">\n\t<div class="pure-modal-group">\n\t\t<div class="pure-modal-field">\n\t\t\t<label>Title</label>\n\t\t\t<input name="description" id="addLinkDescription" type="text" />\n\t\t</div>\n\t\t<div class="pure-modal-field">\n\t\t\t<label>Link</label>\n\t\t\t<input name="url" id="addLinkPath" type="text" placeholder="Type URL or file path" />\n\t\t</div>\n\x3c!--\n\t\t<div class="pure-modal-field">\n\t\t\t<label>Import</label>\n\t\t\t<input name="import" id="addLinkImport" type="checkbox" placeholder="Import into timeline file" />\n\t\t</div>\n--\x3e\n\t\t<div>\n\t\t\t<label></label>\n\t\t\t<a class="btn btn-default" id="addLink-browse">Browse for file</a>\n\t\t</div>\n\x3c!--\t\t<div class="pure-modal-field">\n\t\t\t<label></label>\n\t\t\t<input type="radio" name="pathtype" value="web">Web\n\t\t\t<input type="radio" name="pathtype" value="file" checked="true">File\n\t\t</div>--\x3e\n\t</div>\n\t<div class="popover-footer">\n\t\t<div class="pure-modal-field">\n\t\t\t<input type="button" class="btn btn-danger" name="deleteButton" value="Delete Link" style="float: left;" id="addLink-delete" />\n\t\t\t<input type="submit" class="btn btn-primary" name="addButton" value="OK" id="addLink-submit" />\n\t\t</div>\t\n\t</div>\n</form>';

},{}],107:[function(require,module,exports){
module.exports='<form class="pure-form pure-form-aligned">\n\t<div class="pure-modal-group">\n\t\t<div class="pure-modal-field">\n\t\t    <label for="entitySearchField"><%= typeName %>:</label>\n\t    \t<div id="entitySearchField"></div>\n\t\t</div>\t\n\t</div>\n\t<div class="popover-footer">\n\t\t<div class="pure-modal-field">\n\t\t    <input type="button" class="btn btn-primary" name="addButton" value="Add" id="addRole-submit"/>\n\t\t</div>\t\n\t</div>\n</form>';

},{}],108:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div>\n        <a type="button" class="imageButton fa fa-minus-square remove-<%= item.id %>" href="#" tabIndex="0" title="Remove Link"></a>\n\t\t<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n\t\t<span class="list-item-actions">\n\t\t\t<a type="button" class="imageButton fa fa-eye quicklook-<%= item.id %>" href="#" tabIndex="0" <% if(item.quicklookDisabled) { %>disabled="disabled" <% } %> title="Quicklook Document"></a>\n\t\t\t<a type="button" class="imageButton fa fa-external-link open-<%= item.id %>" href="#" tabIndex="0" <% if(item.openDisabled) { %>disabled="disabled" <% } %> title="Open Document"></a>\n\t\t</span>\n\t</div>\n<% }); %>\n<div>\n\t<a type="button" tabIndex="0" class="addButton imageButton fa fa-plus-square" href="#" title="Add"></a>\n</div>';

},{}],109:[function(require,module,exports){
module.exports='<input type="text" autocomplete="off" spellcheck="false" class="autosuggestPlaceholder" readonly="" tabindex="-1" placeholder="<%= placeholder ? placeholder : \'\' %>"/>\n<input type="text" autocomplete="off" spellcheck="false" class="autosuggestBehind" readonly="" tabindex="-1" />\n<input type="text" autocomplete="off" spellcheck="false" class="autosuggestFront" type="text" />\n<div class="bselect-dropdown" style="display: none;">\n    <ul class="bselect-option-list" role="listbox">\n    </ul>\n</div>';

},{}],110:[function(require,module,exports){
module.exports='\x3c!-- Assuming the outer div is created dynamically and the content inside is then read. --\x3e\n\x3c!-- TODO : Need to switch from id to class so that we can have multiple calendar pickers loaded? --\x3e\n\x3c!--div id="calendar"--\x3e\n\t<div id="yearDiv">\n\t\t<span id="yearDivLower" class="fa fa-caret-left"></span>\n\t\t<input type="text" id="calendarYearInput" />\n\t\t<span id="yearDivHigher" class="fa fa-caret-right"></span>\n\t</div>\n\t<div id="restrictions">\n\t\t<div id="yearOnly">Year Only</div>\n\t\t<div id="monthYearOnly">Month + Year Only</div>\n\t\t<div id="months"></div>\n\t</div>\n\t<table>\n\t\t<thead>\n\t\t\t<tr id="headerRow">\n\t\t\t</tr> \n\t\t</thead>\n\t</table>\n\t<div id="scrollbody">\n\t\t<table>\n\t\t\t<tbody id="tableBody"></tbody>\n\t\t</table>\n\t</div>\n\x3c!--/div--\x3e';

},{}],111:[function(require,module,exports){
module.exports='\t<span class="bselect-label"><div class="colorSquareLabel"></div><span>&nbsp;</span></span>\n\t<button type="button" class="bselect-caret" tabindex="-1">\n\t\t<span class="fa fa-chevron-down"></span>\n\t</button>\n\t<div class="bselect-dropdown" style="display: none;">\n\t\t<ul class="bselect-option-list" id="bselect-option-list-1" role="listbox">\n\t\t</ul>\n\t</div>';

},{}],112:[function(require,module,exports){
module.exports='<div class=\'eventMoreHeadingGroup\' style="pointer-events: none">ATTACHMENTS</div>\n<ul class=\'eventMoreList\' style="pointer-events: none">\n    <li style="pointer-events: none"><span style="pointer-events: none">Attached File.pdf</span></li>\n\t<li style="pointer-events: none"><span style="pointer-events: none">Reference Document.png</span></li>\n</ul>\n';

},{}],113:[function(require,module,exports){
module.exports='<img class="eventImage" style="pointer-events: none;" src="images/placeholder.jpg" />\n';

},{}],114:[function(require,module,exports){
module.exports='<div class=\'eventMoreHeadingGroup\' style="pointer-events: none">EXTERNAL LINKS</div>\n<ul class=\'eventMoreList\' style="pointer-events: none">\n    <li style="pointer-events: none"><span style="pointer-events: none">file://path/to/file1</span></li>\n\t<li style="pointer-events: none"><span style="pointer-events: none">http://address.to/url</span></li>\n</ul>\n';

},{}],115:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style=\"pointer-events: none\">\n    <div class='eventMoreHeading' style=\"pointer-events: none\">LABEL</div>\n    <div class='eventMoreNormalValue' style=\"pointer-events: none\">Yes</div>\n</div>";

},{}],116:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style=\"pointer-events: none\">\n    <div class='eventMoreHeading' style=\"pointer-events: none\">LABEL</div>\n    <div class='eventMoreNormalValue' style=\"pointer-events: none\">50</div>\n</div>\n";

},{}],117:[function(require,module,exports){
module.exports="<div class='eventMoreParagraph' style=\"pointer-events: none\">LABEL: Lorem ipsum dolor sit amet, consectetur adipiscing elit.</div>\n";

},{}],118:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style='pointer-events: none'>\n    <div class='eventMoreHeading' style='pointer-events: none'>LABEL</div>\n    <div class='eventMoreProgressValue' style='pointer-events: none'>80%</div>\n    <div class='eventProgressBar' style='pointer-events: none'>\n        <span style='width: 80%; pointer-events: none'></span>\n    </div>\n</div>\n";

},{}],119:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup' style=\"pointer-events: none\">\n    <div class='eventMoreHeading' style=\"pointer-events: none\">LABEL</div>\n    <div class='eventMoreNormalValue' style=\"pointer-events: none\">Lorem Ipsum.</div>\n</div>";

},{}],120:[function(require,module,exports){
module.exports='<div class=\'eventMoreHeadingGroup\' style="pointer-events: none">LABEL</div>\n<ul class=\'eventMoreList\' style="pointer-events: none">\n    <li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">TYPE 1</strong></span></li>\n\t<li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">TYPE 2</strong></span></li>\n</ul>\n';

},{}],121:[function(require,module,exports){
module.exports='<div class=\'eventMoreHeadingGroup\' style="pointer-events: none">TAGS</div>\n<ul class=\'eventMoreList\' style="pointer-events: none">\n    <li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">Tag 1</strong></span></li>\n\t<li style="pointer-events: none"><span style="pointer-events: none"><strong style="pointer-events: none">Tag 2</strong></span></li>\n</ul>\n';

},{}],122:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content" id="displaySettingsWindow">\n\t\t<div class="modal-header">\n\t        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title" id="displaySettingsWindowTitle">Display Settings</h4>\n\t\t</div>\n\t\t<form id="displaySettingsForm" class="pure-form pure-form-aligned">\n\t\t\t<div class="modal-body">\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsSkin">Skin</label>\n\t\t\t\t\t\t<select id="displaySettingsSkin">\n\t\t\t\t\t\t    <option value="dark">Dark</option>\n\t\t\t\t\t\t    <option value="light">Light</option>\n\t\t\t\t\t\t    <option value="writer">Writer</option>\n\t\t\t\t\t\t    <option value="ocean">Ocean</option>\n\t\t\t\t\t\t    <option value="borealis">Borealis</option>\n\x3c!-- \t\t\t\t\t\t    <option value="ios_blue">iOS Blue</option> --\x3e\n\t\t\t\t\t\t    <option value="print">Print</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsSize">Size</label>\n\t\t\t\t\t\t<select id="displaySettingsSize">\n\t\t\t\t\t\t    <option value="80">80%</option>\n\t\t\t\t\t\t    <option value="90">90%</option>\n\t\t\t\t\t\t    <option value="100">100%</option>\n\t\t\t\t\t\t    <option value="110">110%</option>\n\t\t\t\t\t\t    <option value="120">120%</option>\n\t\t\t\t\t\t    <option value="130">130%</option>\n\t\t\t\t\t\t    <option value="150">150%</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsScrollingBounds">Scrolling</label>\n\t\t\t\t\t\t<select id="displaySettingsScrollingBounds">\n\t\t\t\t\t\t\t<option value="free">Do not constrain scrolling</option>\n\t\t\t\t\t\t\t<option value="bounce">Bounce once at first/last event, then continue</option>\n\t\t\t\t\t\t\t<option value="restrict">Restrict scrolling to first/last event</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsLayout">Layout</label>\n\t\t\t\t\t\t<select id="displaySettingsLayout">\n\t\t\t\t\t\t\t<option value="compact">Use minimum space possible</option>\n\t\t\t\t\t\t\t<option value="waterfall">Cascade unbroken groups from top</option>\n\t\t\t\t\t\t\t<option value="cascade">Only return to top when clear of all previous</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsOptions">Options</label>\n\t\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t\t    <input id="displaySettingsShowIds" type="checkbox" /> Show event IDs on timeline\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t\t    <input id="displaySettingsShowDates" type="checkbox" /> Show event dates\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsOptions">&nbsp;</label>\n\t\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t\t    <input id="displaySettingsShowToday" type="checkbox" /> Indicate Today\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t\t    <input id="displaySettingsShowDurationInTitle" type="checkbox" /> Show duration in title\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\x3c!--\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label></label>\n\t\t\t\t\t</div>\n--\x3e\n                    \x3c!--\n\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t    <input id="displaySettingsShowDependencies" type="checkbox" /> Draw dependencies\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t    <input id="displaySettingsExpandAll" type="checkbox" /> Permanently expand all events\n\t\t\t\t\t</div> \n\t\t\t\t\t--\x3e\n\t\t\t\t</div>\n\t\t\t\t<div class="pure-modal-group alternate no-border">\n\t\t\t\t\t<div class="pure-modal-heading">Display contents for expanded events</div>\n\t\t\t\t\t<div class="expandedView">\n\t\t\t\t\t\t<div class="columnWrapper">\n\t\t\t\t\t\t\t<div class="displayColumn" id="leftDisplayColumn">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="displayColumnDropTarget" id="leftAddDropTarget"><span class="fa fa-plus-circle"></span>DROP TO ADD AN ITEM</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="columnWrapper">\n\t\t\t\t\t\t\t<div class="displayColumn" id="rightDisplayColumn">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="displayColumnDropTarget" id="rightAddDropTarget"><span class="fa fa-plus-circle"></span>DROP TO ADD AN ITEM</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field" id="availableGroup">\n\t\t\t\t\t\t<label for="available">Other</label> \n\t\t\t\t\t\t<div id="available"></div>\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\n\t\t\t<div class="modal-footer">\n\t\t\t\t\x3c!--<input id="displaySettingsCancel" class="btn" name="commit" type="button" value="Cancel" />--\x3e\n\t\t\t\t<input id="displaySettingsApply" class="btn" name="commit" type="button" value="Apply" />\n\t\t\t\t<input id="displaySettingsOk" class="btn btn-primary" name="commit" type="submit" value="Save" />\n\t\t\t</div>\n\t\t</form>\n\t</div>\n</div>';

},{}],123:[function(require,module,exports){
module.exports='\t<span class="bselect-label">&nbsp;</span>\n\t<button type="button" class="bselect-caret" tabindex="-1">\n\t\t<span class="fa fa-chevron-down"></span>\n\t</button>\n\t<div class="bselect-dropdown" style="display: none;">\n\t\t<ul class="bselect-option-list" id="bselect-option-list-1" role="listbox">\n\t\t</ul>\n\t</div>';

},{}],124:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<h4 class="modal-title" id="editCalendarWindowTitle">Edit Calendar</h4>\r\n\t\t</div>\r\n\t\t<form id="editCalendarForm" class="pure-form pure-form-aligned" onsubmit="return false;">\r\n\t\t\t<div class="modal-body">\r\n\t\t\t\t<div class="masterDetailWindow">      \r\n\t\t\t\t\t<div class="masterView withControls">\r\n\t\t\t\t\t\t<div class="masterViewList"></div>\r\n\t\t\t\t\t\t<div class="masterViewControls">\r\n\t\t\t\t\t\t\t<i id="editCalendarRemoveButton" class="fa fa-minus-circle"></i>\r\n\t\t\t\t\t\t\t<i id="editCalendarMoveDownButton" class="fa fa-chevron-circle-down" style="float: right"></i>\r\n\t\t\t\t\t\t\t<i id="editCalendarMoveUpButton" class="fa fa-chevron-circle-up" style="float: right"></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="detailView" id="editCalendarDetailView"></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>  \r\n\t\t\t\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<input id="editCalendarCancel" class="btn btn-cancel" name="commit" type="button" value="Cancel" />\r\n\t\t\t\t<input id="editCalendarOk" class="btn btn-primary" name="commit" type="submit" value="OK" />\r\n                \r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>\r\n</div>';

},{}],125:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n\t<div class="pure-modal-field">\n\t    <label for="editColorName">Name</label>\n\t    <input id="editColorName" type="text" placeholder="Name" />\n\t</div>\n\t<div class="pure-modal-field">\n\t    <label for="editColorColor">Color</label>\n\t\t<input id="editColorColor" type="text" />\n\t</div>\n</div>';

},{}],126:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n\t<div class="pure-modal-field longLabelName">\r\n\t    <label for="editEraName">Name</label>\r\n\t    <input id="editEraName" type="text" placeholder="Name" />\r\n\t</div>\r\n    <div class="pure-modal-field longLabelName">\r\n        <label for="editEraShortName">Short Name</label>\r\n        <input id="editEraShortName" type="text" placeholder="Short Name" />\r\n    </div>\r\n    <div class = "pure-modal-field shortInput">\r\n        <label for ="editEraDuration"> Duration</label>\r\n        <input id="editEraDuration" type="number" placeholder="Duration" /><span>years</span>\r\n    </div>\r\n    <div class="pure-modal-field">\r\n        <input type="checkbox" id="editEraBackwards" /> Years counted Backwards\r\n    </div>\r\n    <div class = "pure-modal-field">\r\n        <input type = "checkbox" id = "editEraLeapYear" /> Era contains leap years\r\n    </div>\r\n     \r\n</div>';

},{}],127:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n\t<div class="pure-modal-field longLabelName">\r\n\t    <label for="editMonthName">Name</label>\r\n\t    <input id="editMonthName" type="text" placeholder="Name" />\r\n\t</div>\r\n    <div class="pure-modal-field longLabelName">\r\n        <label for="editMonthShortName">Short Name</label>\r\n        <input id="editMonthShortName" type="text" placeholder="Short Name" />\r\n    </div>\r\n    <div class = "pure-modal-field shortInput">\r\n        <label for = "editMonthRegularYearDuration"> Regular Year</label>\r\n        <input id = "editMonthRegularYearDuration" type="number" placeholder="Regular Year Duration"/><span>days</span>\r\n    </div>\r\n    <div class = "pure-modal-field shortInput">\r\n        <label for = "editMonthLeapYearDuration"> Leap Year</label>\r\n        <input id = "editMonthLeapYearDuration" type="number" placeholder="Leap Year Duration"/><span>days</span>\r\n    </div>\r\n</div>';

},{}],128:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div class="editPropertyOptionList">\n\t\t<a type="button" class="imageButton fa fa-minus-circle remove-<%= item.id %>" href="#"></a>\n\t\t<input type="text" class="edit-name-<%= item.id %>" value="<%= item.title %>" />\t</div>\n<% }); %>\n\n<div>\n\t<a type="button" tabIndex="7" class="addButton imageButton fa fa-plus-circle" href="#"></a>\n</div>';

},{}],129:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n\t<div class="pure-modal-field">\n\t    <label for="name">Name</label>\n\t    <input id="editPropertyName" type="text" placeholder="Name" />\n\t</div>\n\t<div class="pure-modal-field">\n\t    <label for="name">Type</label>\n\t\t<select id="editPropertyType">\n\t\t\t<option value="text">Single-line Text</option>\n\t\t\t<option value="multitext">Multi-line Text</option>\n\t\t\t<option value="list">List of options</option>\n\t\t\t<option value="number">Integer Number</option>\n\t\t\t<option value="decimal">Decimal Number</option>\n\t\t\t<option value="percentage">Percentage</option>\n\t\t\t<option value="currency">Currency</option>\n\t\t\t<option value="boolean">Yes / No</option>\n\t\t</select>\n\t</div>\n</div>\n<div class="pure-modal-group alternate">\n\t<div class="pure-modal-field">\n\t    \x3c!--<label for="name">Calc</label>--\x3e\n        <input type="checkbox" id="editPropertyCalculate" /> Automatically calculate parent\'s value from children.\n    </div>\n\t<div class="pure-modal-field">\n\t    <label for="name">Mode</label>\n\t\t<select id="editPropertyCalcMode"></select>\n    </div>\n</div>\n<div class="pure-modal-group">\n\t<div class="pure-modal-field">\n        <input type="checkbox" id="editPropertyFadeCheckbox" /> Fade events based on this property\n    </div>\n</div>\n<div class="pure-modal-group alternate">\n\t<div class="pure-modal-field">\t\n\t    <label for="roles">Options</label>\n\t    <div class="valueList" id="editPropertyOptions" style="max-height: 18.0rem; overflow: auto;"></div>\n\t</div>\t\t\t\t\t\t\t\n</div>\n';

},{}],130:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n\t<div class="pure-modal-heading">Range Type: <span id="editRangePropertyType">None Selected</span></div>\n\t<div class="pure-modal-field">\n\t    <label for="name">Name</label>\n\t    <input id="editRangePropertyName" type="text" placeholder="Name" />\n\t</div>\n\x3c!--    <div class="pure-modal-field">\n    \t<label for="editRangePropertyType">Type</label>\n    <select id="editRangePropertyType">\n        <option value = "date">Date</option>\n        <option value = "integer">Number</option>\n    </select>\n\t</div>--\x3e\n</div>\n<div id = \'editRangePropertyDateOptions\'>\n\t<div class="pure-modal-group">\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyCalendarType">Style</label>\n\t\t\t<select id="editRangePropertyCalendarType">\n\t\t\t\t<option value = "0">Regular Dates</option>\n\t\t\t\t<option value = "1">Weekly (Week 1, Week 2)</option>\n\t\t\t\t<option value = "2">Daily (Day 1, Day 2)</option>\n\t\t\t\t<option value = "3">Time (2:25:30)</option>\n\t\t\t</select>\n\t\t</div>\n\t</div>\n\t<div class="pure-modal-group alternate">\n\t\t<div class="pure-modal-heading">Zoom Limits</div>\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyDateMinZoom">From</label>\n\t\t\t<select id="editRangePropertyDateMinZoom">\n\t\t\t\t<option value = "second">Seconds</option>\n\t\t\t\t<option value = "minute">Minutes</option>\n\t\t\t\t<option value = "hour">Hours</option>\n\t\t\t\t<option value = "day" selected="selected">Days</option>\n\t\t\t\t<option value = "week">Weeks</option>\n\t\t\t\t<option value = "month">Months</option>\n\t\t\t\t<option value = "year">Years</option>\n\t\t\t\t<option value = "decade">Ten Years</option>\n\t\t\t\t<option value = "century">Hundred Years</option>\n\t\t\t\t<option value = "thousand">Thousand Years</option>\n\t\t\t\t<option value = "million">Million Years</option>\n\t\t\t\t<option value = "billion">Billion Years</option>\n\t\t\t</select>\n\t\t</div>\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyDateMaxZoom">To</label>\n\t\t\t<select id="editRangePropertyDateMaxZoom">\n\t\t\t\t<option value = "second">Seconds</option>\n\t\t\t\t<option value = "minute">Minutes</option>\n\t\t\t\t<option value = "hour">Hours</option>\n\t\t\t\t<option value = "day">Days</option>\n\t\t\t\t<option value = "week">Weeks</option>\n\t\t\t\t<option value = "month">Months</option>\n\t\t\t\t<option value = "year" selected="selected">Years</option>\n\t\t\t\t<option value = "decade">Ten Years</option>\n\t\t\t\t<option value = "century">Hundred Years</option>\n\t\t\t\t<option value = "thousand">Thousand Years</option>\n\t\t\t\t<option value = "million">Million Years</option>\n\t\t\t\t<option value = "billion">Billion Years</option>\n\t\t\t</select>\n\t\t</div>\n\t</div>\n\t<div class="pure-modal-group">\n\t\t<div class="pure-modal-heading">Date Formatting</div>\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyDateFormat">Date</label>\n\t\t\t<select id="editRangePropertyDateFormat">\n\t\t\t\t<option value = "0">Short (5/7/1993)</option>\n\t\t\t\t<option value = "1">Medium (12 Apr 1991)</option>\n\t\t\t\t<option value = "2">Long (23 September 1994)</option>\n\t\t\t</select>\n\t\t</div>\n\x3c!--\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyIncludeDayName">&nbsp;</label>\n\t\t    <input type="checkbox" id="editRangePropertyIncludeDayName" /> Include day name\n\t\t</div>\n--\x3e\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyTimeFormat">Time</label>\n\t\t\t<select id="editRangePropertyTimeFormat">\n\t\t\t\t<option value = "0">24 hour</option>\n\t\t\t\t<option value = "1">12 hour</option>\n\t\t\t</select>\n\t\t</div>\n\t</div>\n\t<div class="pure-modal-group alternate">\n\t    <div class = "pure-modal-field">\n\t     <button id="editCalendarButton" class="btn btn-xs btn-default" type="button">Edit Calendar</button>\n\t    </div>\n\t     <div id="editCalendarDisableExplanation">Note: Calendars can only be edited for empty timelines.</div>\n\t</div>\n</div>\n<div id = \'editRangePropertyNumericOptions\'>\n\t<div class="pure-modal-group alternate">\n\t\t<div class="pure-modal-heading">Zoom Limits</div>\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyNumericMinZoom">From</label>\n\t\t    <input id="editRangePropertyNumericMinZoom" type="number" placeholder="Minimum Zoom" value="10" min="0.025" step="any" />\n\t\t</div>\n\t\t<div class="pure-modal-field">\n\t\t    <label for="editRangePropertyNumericMaxZoom">To</label>\n\t\t    <input id="editRangePropertyNumericMaxZoom" type="number" placeholder="Maximum Zoom" value="1000" min="0.025" step="any" />\n\t\t</div>\n\t</div>\n</div>';

},{}],131:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div class="editRoleList">\n\t\t<a type="button" class="imageButton deleteRoleButton fa fa-minus-circle remove-<%= item.id %>" href="#"></a>\n\t\t<input type="text" class="edit-name-<%= item.id %>" value="<%= item.title %>" />\n\t\t<button class="btn btn-default iconPickerBtn roleIconPickerBtn edit-role-icon-<%= item.id %>"><svg class="selectedIcon icon"><use xlink:href="#none"></use></svg><svg class="downArrow"><use xlink:href="#down"></use></svg></button>\n\t\t\x3c!-- <button class="btn btn-default iconpicker edit-role-icon-<%= item.id %>" role="iconpicker"></button> --\x3e\n\t\t<span class="multipleOption"><input type="checkbox" class="edit-multiple-<%= item.id %>" <% if(item.multiplePerEvent) { %>checked="checked" <% } %> /> Allow multiple per event</span>\n\t</div>\n<% }); %>\n\n<div>\n\t<a type="button" tabIndex="7" class="addButton imageButton fa fa-plus-circle" href="#"></a>\n</div>';

},{}],132:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content">\n\t\t<div class="modal-header">\n\t        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title" id="editTemplateWindowTitle">Timeline Settings</h4>\n\t\t</div>\n\t\t<form id="editTemplateForm" class="pure-form pure-form-aligned" onsubmit="return false;">\n\t\t\t<div class="modal-body">\n\t\t\t\t<div class="masterDetailWindow">      \n\t\t\t\t\t<div class="masterView withControls">\n\t\t\t\t\t\t<div class="masterViewList"></div>\n\t\t\t\t\t\t<div class="masterViewControls">\n\t\t\t\t\t\t\t<i id="editTemplateRemoveButton" class="fa fa-minus-circle"></i>\n\t\t\t\t\t\t\t<i id="editTemplateMoveDownButton" class="fa fa-chevron-circle-down" style="float: right"></i>\n\t\t\t\t\t\t\t<i id="editTemplateMoveUpButton" class="fa fa-chevron-circle-up" style="float: right"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="detailView" id="editTemplateDetailView"></div>\n\t\t\t\t</div>\n\t\t\t</div>  \n\t\t\t\n\t\t\t<div class="modal-footer">\n\t\t\t\t<a id="editTemplateSave" style="float: left;" class="btn btn-default"> Save As Custom Template...</a>\n\t\t\t\t<input id="editTemplateCancel" class="btn btn-cancel" name="commit" type="button" value="Cancel" />\n\t\t\t\t<input id="editTemplateOk" class="btn btn-primary" name="commit" type="submit" value="OK" />\n\t\t\t</div>\n\t\t</form>\n\t</div>\n</div>';

},{}],133:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\n\t<div class="pure-modal-field alongsideButton">\n\t    <label for="name">Name</label>\n\t    <input id="editTypeName" type="text" placeholder="Name" />\n\t\t<button class="btn btn-default iconPickerBtn" id="editTypeIcon"><svg class="selectedIcon"><use xlink:href="#none"></use></svg><svg class="downArrow"><use xlink:href="#down"></use></svg></button>\n\t</div>\n\t<div class="pure-modal-field">\n\t    <label for="persistent">Bounds</label>\n\t    <input id="editTypePersistent" type="checkbox" /> Allow start/end events and age calculations\n\t</div>\n</div>\n<div class="pure-modal-group alternate">\n\t<div class="pure-modal-field">\t\n\t    <label for="roles">Roles</label>\n\t    <div class="valueList" id="editRangeRoles" style="max-height: 29.6rem; overflow: auto;"></div>\n\t</div>\t\t\t\t\t\t\t\n</div>';

},{}],134:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n\t<div class="pure-modal-field longLabelName">\r\n\t    <label for="editWeekdayName">Name</label>\r\n\t    <input id="editWeekdayName" type="text" placeholder="Name" />\r\n\t</div>\r\n    <div class="pure-modal-field longLabelName">\r\n        <label for="editWeekdayShortName">Short Name</label>\r\n        <input id="editWeekdayShortName" type="text" placeholder="Short Name" />\r\n    </div>\r\n    <div class="pure-modal-field">\r\n        <input type="radio" id="firstDayFinalEra" />This is the first day of the final era\r\n    </div>\r\n     <div class = "modal-footer">\r\n        <label for ="editHoursInDay"> Hours in Day</label>\r\n        <input id="editHoursInDay" type = "number" placeholder = "Hours in Day" />\r\n       \r\n    </div>\r\n    \r\n</div>';

},{}],135:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content">\n\t\t<div class="modal-header">\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title">Add New Parent Event</h4>\n\t\t</div>\n\t\t<form id="embedInParentForm" class="pure-form pure-form-aligned">\n\t\t\t<div class="modal-body">\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="embedInParentTitle">Title </label>\n\t\t\t\t\t\t<input id="embedInParentTitle" type="text" placeholder="Title">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<label for="embedInParentColor">Color</label>\n\t\t\t\t\t\t\t<div id="embedInParentColor"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<label for="embedInParentParent">Parent</label>\n\t\t\t\t\t\t\t<div id="embedInParentParent"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t<div class="modal-footer">\n\t\t\t\t<input id="embedInParentSubmit" class="btn btn-primary" name="commit" type="submit" value="Create New Parent" />\n\t\t\t</div>\n\t\t</form>\n\t</div>\n</div>';

},{}],136:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="enterDateWindowTitle"><%= windowTitle %></h4>\n      </div>\n\t\t<form id="enterDateForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n\t\t\t<div class="pure-modal-group">\n\t\t\t    <label id="enterDateWindowAboveMessage"></label>\n\t\t\t</div>\n\t\t\t<div class="pure-modal-group no-border">\n\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t<label for="enterDatePicker">Date</label>\n\t\t\t\t\t<div id="enterDatePicker"></div>\n\t\t\t\t</div>\t\t\n\t\t\t</div>\t\n\t\t\t<div class="pure-modal-group">\n\t\t\t    <label id="enterDateWindowBelowMessage"></label>\n\t\t\t</div>\n      <div class="modal-footer">\n\t    <input class="btn btn-primary" name="commit" type="submit" id="enterDateSubmit" value="OK" />\n      </div>\n\t\t</form>\n\n    </div>\n  </div>';

},{}],137:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="enterDurationWindowTitle"><%= windowTitle %></h4>\n      </div>\n\t\t<form id="enterDurationForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n\t\t\t<div class="pure-modal-group no-border">\n\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t<label for="enterDurationPicker">Duration</label>\n\t\t\t\t\t<input type="text" id="enterDurationPicker" name="duration" class="duration" value="">\n\t\t\t\t</div>\t\t\n\t\t\t</div>\t\n      <div class="modal-footer">\n\t    <input class="btn btn-primary" name="commit" type="submit" id="enterDurationSubmit" value="OK" />\n      </div>\n\t\t</form>\n\n    </div>\n  </div>';

},{}],138:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="enterNameWindowTitle"><%= windowTitle %></h4>\n      </div>\n\t\t<form id="enterNameForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n\t\t\t<div class="pure-modal-group">\n\t\t\t    <label id="enterNameWindowAboveMessage"></label>\n\t\t\t</div>\n\t\t\t<div class="pure-modal-group no-border">\n\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t<label for="enterNameInput">Name</label>\n\t\t\t\t\t        <input id="enterNameInput" type="text" placeholder="Enter Name...">\n\t\t\t\t</div>\t\t\n\t\t\t</div>\t\n\t\t\t<div class="pure-modal-group">\n\t\t\t    <label id="enterNameWindowBelowMessage"></label>\n\t\t\t</div>\n      <div class="modal-footer">\n\t    <input class="btn btn-primary" name="commit" type="submit" id="enterNameSubmit" value="OK" />\n      </div>\n\t\t</form>\n\n    </div>\n  </div>';

},{}],139:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n\t\t\t<h4 class="modal-title" id="exportCSVWindowTitle"><%= windowTitle %></h4>\r\n\t\t</div>\r\n\t\t<form id="exportCSVForm" class="pure-form pure-form-aligned">\r\n\t\t\t<div class="modal-body">\t\t\r\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        <label for="delimiter">Delimiter</label>\r\n                        <input id="delimiterInputComma" type="radio" name="Delimiter" value="0" checked>Comma\r\n                        <input id="delimiterInputTab" type="radio" name="Delimiter" value="1">Tab\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group alternate">\r\n                    <div class="pure-modal-field">\r\n                        <label for="dateFormatInput">Date Format</label>\r\n                        <select id="dateFormatInput">\r\n                            <option value="0">27 November 1940</option>\r\n                            <option value="1">1940-11-27</option>\r\n                            <option value="2">27/11/1940</option>\r\n                            <option value="3">11/27/1940</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        <label for="timeFormat">Time Format</label>\r\n                        <select id="timeFormatInput">\r\n                            <option value="0">5:43PM</option>\r\n                            <option value="1">17:43</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n\t\t\t</div>\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<input class="btn btn-primary" name="commit" type="submit" id="exportCSVSubmit" value="OK" />\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t\r\n\t</div>\r\n</div>';

},{}],140:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n\t\t\t<h4 class="modal-title" id="exportImageWindowTitle"><%= windowTitle %></h4>\r\n\t\t</div>\r\n\t\t<form id="exportImageForm" class="pure-form pure-form-aligned">\r\n\t\t\t<div class="modal-body">\r\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        <label for="Format">Format</label>\r\n                        <input id="formatCurrentImage" type="radio" name="Format" value="Current" checked />Current Window\r\n                        <input id="entireTimelineImage" type="radio" name="Format" value="All" />Entire Timeline\r\n                        <input id="betweenDatesImage" type="radio" name="Format" value="Interval" />Between Dates\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group alternate">\r\n                    <div class="pure-modal-field">\r\n                        <label for="startDateInputImage">Start Date</label>\r\n                        <div id="startDateInputImage"></div>\r\n                    </div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="endDateInputImage">End Date</label>\r\n                        <div id="endDateInputImage"></div>\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group">\r\n                    <div>\r\n                        <label>Image Dimensions</label>\r\n                        <div>\r\n                            <span id="widthLabelImage"></span><span> x </span><span id="heightLabelImage"></span><span> pixels</span>\r\n                        </div>\r\n                        <div>\r\n                            <span id="exportImageWarningLabel" style="color: red;"></span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\t\t\t</div>\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<input class="btn btn-primary" name="commit" type="submit" id="exportImageSubmit" value="OK" />\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>\r\n</div>';

},{}],141:[function(require,module,exports){
module.exports='<div class="pageContentGroup">\n<% _.each(tabs,function(tab) { %>\n\t<div class="pagecontent" id="<%= tab.name %>-page">\n\t</div>\n<% }); %>\n</div>';

},{}],142:[function(require,module,exports){
module.exports='<div id="inspectorResizeWrapper">\n\t<div id="inspectorResizeGrabber"></div>\n\t<div id="inspectorContent">\n\t\t<form id="inspectorForm" class="pure-form pure-form-aligned">\n\t\t \t<div id="inspectorTopBox">\n\t\t \t\t<div class="pure-inspector-group">\n\t\t\t\t   <h4 id="inspectorHeader"><span id="inspectorHeaderText">Event:</span> <span id="inspectorHeaderEventID"></span> <i id="inspectorCloseArrow" class="fa fa-chevron-right"></i></h4>\n\t\t\t\t</div>\n\t\t \t</div>\n\t\t \t<div id="inspectorScrollBox" style="overflow: scroll">\n\t\t\t\t<div class="pure-inspector-group no-border">\n\t\t\t\t\t<div class="pure-inspector-field">\n\t\t\t\t        <label for="name">Title</label>\n\t\t\t\t        <input id="inspectorTitle" type="text">\n\t\t\t\t    </div>\n\t\t\t\t\t<div class="pure-inspector-field">\n\t\t\t\t\t\t<label for="color">Color</label>\n\t\t\t\t\t    <div id="inspectorColor"></div>\n\t\t\t\t    </div>\n\x3c!--\n\t\t\t\t\t<div class="pure-inspector-field">\n\t\t\t\t\t    <label for="parent">Parent</label>\n\t\t\t\t\t    <div id="inspectorParent"></div>\n\t\t\t\t\t</div>\n--\x3e\n\t\t\t\t</div>\n\t\t\t\t<div id="inspectorPageGroup"></div>\t\t\t\t\t\n\t\t\t</div>\n\t\t</form>\t\n\t</div>\n</div>';

},{}],143:[function(require,module,exports){
module.exports='<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\n\t    <label for="links">Image</label>\n\t    <div class="imageWell">\n\t\t    <img class="inspectorImage" />\n\t\t    <i class="inspectorDeleteImage fa fa-times-circle"></i>\n\t\t</div>\n\x3c!-- \t\t<div class="valueList links"></div> --\x3e\n\t</div>\t\t\t\t\t\t\n</div>';

},{}],144:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div class="manageRowsList">\n\t\t<a type="button" class="imageButton deleteRowButton fa fa-minus-circle remove-<%= item.id %>" href="#"></a>\n\t\t<input type="text" class="manageRowsInput edit-name-<%= item.id %>" value="<%= item.title %>" />\n\t</div>\n<% }); %>\n\n<div>\n\t<a type="button" tabIndex="7" class="addButton imageButton fa fa-plus-circle" href="#"></a>\n</div>';

},{}],145:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content">\n\t\t<div class="modal-header">\n\t        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title">Manage Rows</h4>\n\t\t</div>\n\t\t<form id="editTemplateForm" class="pure-form pure-form-aligned" onsubmit="return false;">\n\t\t\t<div class="modal-body">\n\x3c!-- \t\t\t\t<div class="manageRowsWrapper"> --\x3e\n\t\t\t\t\t<div class="valueList" id="manageRowsList" style=""></div>\n\x3c!-- \t\t\t\t</div> --\x3e\n\t\t\t</div>  \n\t\t</form>\n\t</div>\n</div>';

},{}],146:[function(require,module,exports){
module.exports='<% _.each(properties,function(prop) { %>\n<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\n\t    <label for="<%= prop.name %>"><%= prop.name %></label>\n\t    <% if(prop.type == \'text\' || prop.type == \'string\') { %>\n\t\t\t<input type="text" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'multitext\' || prop.type == \'richtext\') { %>\n\t\t\t<textarea id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>"></textarea>\n\t\t<% } else if(prop.type == \'number\') { %>\n\t\t\t<input type="number" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'decimal\') { %>\n\t\t\t<input type="number" step="any" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'percentage\') { %>\n\t\t\t<input type="number" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'currency\') { %>\n\t\t\t<input type="number" step="any" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'boolean\') { %>\n\t\t\t<input type="checkbox" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'list\') { %>\n\t\t\t<div class="property_<%= prop.propertyId %>" id="inspector-property-<%= prop.propertyId %>"></div>\n\t\t<% } %>\n\t</div>\t\t\t\t\t\t\n</div>\n<% }); %>\n';

},{}],147:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content" id="displaySettingsWindow">\n\t\t<div class="modal-header">\n\t        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title" id="displaySettingsWindowTitle">Settings</h4>\n\t\t</div>\n\t\t<form id="displaySettingsForm" class="pure-form pure-form-aligned">\n\t\t\t<div class="modal-body">\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsSkin">Skin</label>\n\t\t\t\t\t\t<select id="displaySettingsSkin">\n\t\t\t\t\t\t    <option value="dark">Dark</option>\n\t\t\t\t\t\t    <option value="light">Light</option>\n\t\t\t\t\t\t    <option value="writer">Writer</option>\n\t\t\t\t\t\t    <option value="ocean">Ocean</option>\n\t\t\t\t\t\t    <option value="borealis">Borealis</option>\n\x3c!-- \t\t\t\t\t\t    <option value="ios_blue">iOS Blue</option> --\x3e\n\t\t\t\t\t\t    <option value="print">Print</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsSize">Size</label>\n\t\t\t\t\t\t<select id="displaySettingsSize">\n\t\t\t\t\t\t    <option value="80">80%</option>\n\t\t\t\t\t\t    <option value="90">90%</option>\n\t\t\t\t\t\t    <option value="100">100%</option>\n\t\t\t\t\t\t    <option value="110">110%</option>\n\t\t\t\t\t\t    <option value="120">120%</option>\n\t\t\t\t\t\t    <option value="130">130%</option>\n\t\t\t\t\t\t    <option value="150">150%</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsScrollingBounds">Scrolling</label>\n\t\t\t\t\t\t<select id="displaySettingsScrollingBounds">\n\t\t\t\t\t\t\t<option value="free">Do not constrain scrolling</option>\n\t\t\t\t\t\t\t<option value="bounce">Bounce once at first/last event, then continue</option>\n\t\t\t\t\t\t\t<option value="restrict">Restrict scrolling to first/last event</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsLayout">Layout</label>\n\t\t\t\t\t\t<select id="displaySettingsLayout">\n\t\t\t\t\t\t\t<option value="compact">Use minimum space possible</option>\n\t\t\t\t\t\t\t<option value="waterfall">Cascade unbroken groups from top</option>\n\t\t\t\t\t\t\t<option value="cascade">Only return to top when clear of all previous</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t<div class="pure-modal-heading">Zoom Limits</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t    <label for="displaySettingsMinZoom">From</label>\n\t\t\t\t\t\t<select id="displaySettingsMinZoom">\n\t\t\t\t\t\t\t<option value = "second">Seconds</option>\n\t\t\t\t\t\t\t<option value = "minute">Minutes</option>\n\t\t\t\t\t\t\t<option value = "hour">Hours</option>\n\t\t\t\t\t\t\t<option value = "day" selected="selected">Days</option>\n\t\t\t\t\t\t\t<option value = "week">Weeks</option>\n\t\t\t\t\t\t\t<option value = "month">Months</option>\n\t\t\t\t\t\t\t<option value = "year">Years</option>\n\t\t\t\t\t\t\t<option value = "decade">Ten Years</option>\n\t\t\t\t\t\t\t<option value = "century">Hundred Years</option>\n\t\t\t\t\t\t\t<option value = "thousand">Thousand Years</option>\n\t\t\t\t\t\t\t<option value = "million">Million Years</option>\n\t\t\t\t\t\t\t<option value = "billion">Billion Years</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t    <label for="displaySettingsMaxZoom">To</label>\n\t\t\t\t\t\t<select id="displaySettingsMaxZoom">\n\t\t\t\t\t\t\t<option value = "second">Seconds</option>\n\t\t\t\t\t\t\t<option value = "minute">Minutes</option>\n\t\t\t\t\t\t\t<option value = "hour">Hours</option>\n\t\t\t\t\t\t\t<option value = "day">Days</option>\n\t\t\t\t\t\t\t<option value = "week">Weeks</option>\n\t\t\t\t\t\t\t<option value = "month">Months</option>\n\t\t\t\t\t\t\t<option value = "year" selected="selected">Years</option>\n\t\t\t\t\t\t\t<option value = "decade">Ten Years</option>\n\t\t\t\t\t\t\t<option value = "century">Hundred Years</option>\n\t\t\t\t\t\t\t<option value = "thousand">Thousand Years</option>\n\t\t\t\t\t\t\t<option value = "million">Million Years</option>\n\t\t\t\t\t\t\t<option value = "billion">Billion Years</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-heading">Date Formatting</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t    <label for="displaySettingsDateFormat">Date</label>\n\t\t\t\t\t\t<select id="displaySettingsDateFormat">\n\t\t\t\t\t\t\t<option value = "0">Short (5/7/1993)</option>\n\t\t\t\t\t\t\t<option value = "1">Medium (12 Apr 1991)</option>\n\t\t\t\t\t\t\t<option value = "2">Long (23 September 1994)</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t    <label for="displaySettingsTimeFormat">Time</label>\n\t\t\t\t\t\t<select id="displaySettingsTimeFormat">\n\t\t\t\t\t\t\t<option value = "0">24 hour</option>\n\t\t\t\t\t\t\t<option value = "1">12 hour</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsOptions">Options</label>\n\t\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t\t    <input id="displaySettingsShowIds" type="checkbox" /> Show event IDs on timeline\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t\t    <input id="displaySettingsShowDates" type="checkbox" /> Show event dates\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="displaySettingsOptions">&nbsp;</label>\n\t\t\t\t\t\t<div class="settingsCheckboxDiv">\n\t\t\t\t\t\t    <input id="displaySettingsShowToday" type="checkbox" /> Indicate Today\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\t\t\n\t\t\t<div class="modal-footer">\n\t\t\t\t\x3c!--<input id="displaySettingsCancel" class="btn" name="commit" type="button" value="Cancel" />--\x3e\n\t\t\t\t<input id="displaySettingsApply" class="btn" name="commit" type="button" value="Apply" />\n\t\t\t\t<input id="displaySettingsOk" class="btn btn-primary" name="commit" type="submit" value="Save" />\n\t\t\t</div>\n\t\t</form>\n\t</div>\n</div>';

},{}],148:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div>\n\t\t<a type="button" class="imageButton fa fa-pencil-square-o edit-<%= item.id %>" href="#" tabIndex="0" title="Edit/Delete"></a>\n\t\t<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n\t\t<% if(item.extra) { %>\n\t\t\t<span class="list-item-extra"><%= item.extra %></span>\n\t\t<% } %>\n\t\t<span class="list-item-actions">\n\t\t\t<a type="button" class="imageButton fa fa-eye quicklook-<%= item.id %>" href="#" tabIndex="0" <% if(item.quicklookDisabled) { %>disabled="disabled" <% } %> title="Quicklook Document"></a>\n\t\t\t<a type="button" class="imageButton fa fa-folder-open reveal-<%= item.id %>" href="#" tabIndex="0" <% if(item.revealDisabled) { %>disabled="disabled" <% } %> title="Open Folder Location"></a>\n\t\t\t<a type="button" class="imageButton fa fa-external-link open-<%= item.id %>" href="#" tabIndex="0" <% if(item.openDisabled) { %>disabled="disabled" <% } %> title="Open Document"></a>\n\t\t</span>\n\t</div>\n<% }); %>\n\n<div>\n\t<a type="button" tabIndex="0" class="addButton imageButton fa fa-plus-square" href="#" title="Add"></a>\n</div>';

},{}],149:[function(require,module,exports){
module.exports='<% var index = 0;\n\t_.each(items, function(item) { \n\t\tif(index > 0) { %>\n\t\t<div class="filterBarLogic"><%= item.logic %></div>\n\t\t\x3c!--<div class="filterBarLogic"><a class="filterBarLogicSpan"><%= item.logic %> <i class="fa fa-caret-down"></i></a></div>--\x3e\n<% } %>\n\t\t<div class="filterBarItem">\n<% if(item.negate) {%>\n\t\t\t<span class="filterNegate"><%= item.negate %></span>\n<% } %>\n\t\t\t<span class="filterScope"><%= item.scope %></span>\n\t\t\t<span class="filterValue"><%= item.value %></span>\n\t\t\t<a href="#" class="remove" tabindex="-1">×</a>\n\t\t</div>\n<% index++; }); %>';

},{}],150:[function(require,module,exports){
module.exports='<div class="filterControl">\n\t<span class="fa fa-cog filterIcon manageFilterIcon"></span>\n\t<div class="filterBarWrapper">\n\t\t<div id="filterBarItems" class="filterBarItems"></div>\n\t\t<div id="filterBarInlineAdd" class="filterBarInlineAdd">\n\t\t\t<form id="filterBarInlineAddForm">\n\t\t\t\t<div class="filterBarInlineAddLogic" id="filterBarInlineAddLogic">\n\t\t\t\t\t<div class="logicValue" id="filterBarInlineAddLogicValue">AND</div>\n\t\t\t\t\t<div class="bselect-dropdown" id="filterBarInlineAddLogicList" style="display: none;">\n\t\t\t\t\t    <ul class="bselect-option-list" role="listbox">\n\t\t\t\t\t    \t<li id="filterBarInlineAddLogicValue-AND" class="bselect-option" role="option"><span>AND</span></li>\n\t\t\t\t\t    \t<li id="filterBarInlineAddLogicValue-OR"  class="bselect-option" role="option"><span>OR</span></li>\n\t\t\t\t\t    </ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="filterBarInlineAddLogic" id="filterBarInlineAddNegate">\n\t\t\t\t\t<div class="logicValue" id="filterBarInlineAddNegateValue">HAS</div>\n\t\t\t\t\t<div class="bselect-dropdown" id="filterBarInlineAddNegateList" style="display: none;">\n\t\t\t\t\t    <ul class="bselect-option-list" role="listbox">\n\t\t\t\t\t    \t<li id="filterBarInlineAddNegateValue-HAS" class="bselect-option" role="option"><span>HAS</span></li>\n\t\t\t\t\t    \t<li id="filterBarInlineAddNegateValue-NOT"  class="bselect-option" role="option"><span>NOT</span></li>\n\t\t\t\t\t    </ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="filterBarInlineAddScope" class="filterBarInlineAddScope autosuggestDiv"></div>\n\t\t\t\t<span class="filterBarSeparator">:</span>\n\t\t\t\t<div id="filterBarInlineAddValue" class="filterBarInlineAddValue autosuggestDiv"></div>\n\t\t\t\t<button id="filterBarInlineAddButton" type="submit" tabIndex="0"><i class="imageButton fa fa-plus-circle" tabIndex="0"></i></button>\n\t\t\t\t<input type="submit" value="" style="display:none" />\n\t\t\t</form>\n\t\t</div>\n\t</div>\n\t<span class="fa fa-times-circle filterIcon filterClear clearFilterIcon"></span>\n</div>';

},{}],151:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n\t\t\t<h4 class="modal-title" id="findReplaceWindowTitle">Find And Replace</h4>\r\n\t\t</div>\r\n\t\t<form id="findReplaceForm" class="pure-form pure-form-aligned">\r\n\t\t\t<div class="modal-body">\r\n\t\t\t\t<div class="pure-modal-group no-border">\r\n\t\t\t\t\t<div class="pure-modal-field">\r\n\t\t\t\t\t\t<label for="findInput">Find:</label>\r\n\t\t\t\t\t\t<input id="findInput" type="text" placeholder="Enter Text...">\r\n\t\t\t\t\t</div>\t\t\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="pure-modal-group no-border">\r\n\t\t\t\t\t<div class="pure-modal-field">\r\n\t\t\t\t\t\t<label for="replaceInput">Replace:</label>\r\n\t\t\t\t\t\t<input id="replaceInput" type="text" placeholder="Enter Text...">\r\n\t\t\t\t\t</div>\t\t\r\n\t\t\t\t</div>\t\r\n\t\t\t\t\r\n\t\t\t\t<div class="pure-modal-group alternate">\r\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label>Include:</label>\n\t\t\t\t\t\t<div class="checkboxGroup">\n\t\t\t\t\t\t\t<span class="checkboxColumn"><input type="checkbox" id="eventTitlesCheckbox" /> Titles</span>\n\t\t\t\t\t\t\t<span class="checkboxColumn"><input type="checkbox" id="eventPropertiesCheckbox" /> Properties</span>\n\t\t\t\t\t\t\t<span class="checkboxColumn"><input type="checkbox" id="tagsCheckbox" /> Tags</span>\n\t\t\t\t\t\t\t<span class="checkboxColumn"><input type="checkbox" id="entityNamesCheckbox" /> Entities</span>\n\t\t\t\t\t\t\t<span class="checkboxColumn"><input type="checkbox" id="bookmarksCheckbox" /> Bookmarks</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<input id="findReplaceCancel" class="btn btn-cancel" name="commit" type="button" value="Cancel" />\r\n\t\t\t\t<input class="btn btn-primary" name="commit" type="submit" id="findReplaceSubmit" value="Replace All" />\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>\r\n</div>';

},{}],152:[function(require,module,exports){
module.exports='\t<form id="<%= elementName %>-form" class="pure-form">\n\t\t<ul class="bselect-option-list"   id="<%= elementName %>-list" role="listbox">\n\t\t</ul>\n\t</form>\n';

},{}],153:[function(require,module,exports){
module.exports='<div class="pure-modal-group">\r\n\t<div class="pure-modal-field">\r\n\t\t<label for="delimiter">Delimiter</label>\r\n\t\t<input id="importCsvDelimiterInputComma" type="radio" name="Delimiter" value="0" checked> Comma&nbsp;&nbsp;&nbsp;\r\n\t\t<input id="importCsvDelimiterInputTab" type="radio" name="Delimiter" value="1"> Tab\r\n\t</div>\r\n\t<div class="pure-modal-field">\r\n\t\t<label for="delimiter">Internal Delimiter</label>\r\n\t\t<input id="importCsvInternalDelimiterInputComma" type="radio" name="InternalDelimiter" value="0"> Comma&nbsp;&nbsp;&nbsp;\r\n\t\t<input id="importCsvInternalDelimiterInputPipe" type="radio" name="InternalDelimiter" value="1"> Pipe (|)&nbsp;&nbsp;&nbsp;\r\n\t\t<input id="importCsvInternalDelimiterInputEither" type="radio" name="InternalDelimiter" value="2" checked> Either\r\n\t</div>\r\n\t<div class="pure-modal-field">\r\n\t\t<label for="importCsvHeaderRow">Headers</label>\r\n\t\t<input id="importCsvHeaderRow" type="checkbox" name="Header" value="1"> First row of CSV file contains column names\r\n\t</div>\r\n</div>';

},{}],154:[function(require,module,exports){
module.exports='<div class="pure-modal-group alternate">\r\n    <label>For each column in your CSV file, specify what you want to do with the data. At a minimum, you must specify Start and Title.</label>\r\n</div>\r\n\r\n<div class="pure-modal-group" id="importHeaderContainer">\r\n<% _.each(headers,function(header) { %>\r\n\t<div class="pure-modal-field">\r\n\t\t<label for="csvImportOption_<%= header.replace(/\\W/g, "_") %>"><%= header %></label>\r\n\t\t<select id="csvImportOption_<%= header.replace(/\\W/g, "_") %>">\r\n\t\t<% _.each(options,function(option) { %>\r\n\t\t\t<option><%= option %></option>\t\r\n\t\t<% }); %>\r\n\t\t</select>\r\n\t</div>\r\n<% }); %>\r\n    <div id="errorFieldImportCsv" class="modalErrorMessage"></div>\r\n</div>\t\r\n';

},{}],155:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n\t\t\t<h4 class="modal-title">Import CSV File</h4>\r\n\t\t</div>\r\n\t\t<form id="importCsvForm" class="pure-form pure-form-aligned">\r\n\t\t\t<div class="modal-body">\r\n\t\t\t\t<div id="importCsvContent"></div>\n\t\t\t</div>\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<input class="btn btn-default" name="cancel" type="button" id="importCsvCancel" value="Cancel" />\r\n\t\t\t\t<input class="btn btn-default" name="previous" type="button" id="importCsvPrevious" value="Previous" />\n\t\t\t\t<input class="btn btn-primary" name="commit" type="submit" id="importCsvNext" value="Next" />\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t\r\n\t</div>\r\n</div>';

},{}],156:[function(require,module,exports){
module.exports='<div id="inspectorResizeWrapper">\n\t<div id="inspectorResizeGrabber"></div>\n\t<div id="inspectorContent">\n\t\t<form id="inspectorForm" class="pure-form pure-form-aligned">\n\t\t \t<div id="inspectorTopBox">\n\t\t \t\t<div class="pure-inspector-group">\n\t\t\t\t   <h4 id="inspectorHeader"><span id="inspectorHeaderText">Event:</span> <span id="inspectorHeaderEventID"></span> <i id="inspectorCloseArrow" class="fa fa-chevron-right"></i></h4>\n\t\t\t\t</div>\n\t\t\t\t<div class="pure-inspector-group no-border">\n\t\t\t\t\t<div class="pure-inspector-field">\n\t\t\t\t        <label for="name">Title</label>\n\t\t\t\t        <input id="inspectorTitle" type="text">\n\t\t\t\t    </div>\n\t\t\t\t\t<div class="pure-inspector-field">\n\t\t\t\t\t\t<label for="color">Color</label>\n\t\t\t\t\t    <div id="inspectorColor"></div>\n\t\t\t\t    </div>\n\t\t\t\t\t<div class="pure-inspector-field">\n\t\t\t\t\t    <label for="parent">Parent</label>\n\t\t\t\t\t    <div id="inspectorParent"></div>\n\t\t\t\t\t</div>\n\x3c!--\n\t\t\t\t\t<div class="pure-inspector-field">\n\t\t\t\t        <label for="priority">Priority</label>\n\t\t\t\t\t    <div id="inspectorPriority"></div>\n\t\t\t\t    </div>\n--\x3e\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id="inspectorTabGroup"></div>\t\t\t\t\t\n\t\t</form>\t\n\t</div>\n</div>';

},{}],157:[function(require,module,exports){
module.exports='<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\t\t\n\t\t<label for="links">Image</label>\n\t\t<div class="imageWell">\n\t\t\t<a id="inspectorRemoveImageButton" type="button" tabIndex="0" class="imageButton fa fa-minus-square" href="#" title="Remove"></a>\n\t\t\t<img class="inspectorImage" />\n\t\t</div>\n\t\t<div class="valueList">\n\t\t\t<div>\n\t\t\t\t<a id="inspectorAddImageButton" type="button" tabIndex="0" class="addButton imageButton fa fa-plus-square" href="#" title="Add"></a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\n\t    <label for="attachments">Attachments</label>\n\t\t<div class="valueList attachments"></div>\n\t</div>\t\t\t\t\t\t\n</div>\n<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\n\t    <label for="links">Links</label>\n\t\t<div class="valueList links"></div>\n\t</div>\t\t\t\t\t\t\n</div>\n<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\n\t    <label for="sync">Sync</label>\n\t\t<div class="valueList sync"></div>\n\t</div>\t\t\t\t\t\t\n</div>';

},{}],158:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div>\n\t\t<a type="button" class="imageButton fa fa-minus-circle remove-<%= item.id %>" style="display: none;" href="#"></a>\n\t\t<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n\t\t<% if(item.extra) { %>\n\t\t\t<span class="list-item-extra">\n\t\t\t\t<% if(item.actionIcon) { %>\n\t\t\t\t\t\t<a type="button" class="imageButton fa fa-<%= item.actionIcon %> edit-<%= item.id %>" href="#"></a>\n\t\t\t\t<% } %>\n\t\t\t\t\t\t<%= item.extra %></span>\n\t\t<% } %>\n\t</div>\n<% }); %>';

},{}],159:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div>\n\t\t<% if(item.actionIcon) { %>\n\t\t\t<a type="button" class="imageButton fa fa-<%= item.actionIcon %> edit-<%= item.id %>" href="#" tabIndex="0" title="Edit/Delete"></a>\n\t\t<% } else { %>\n\t\t\t<a type="button" class="imageButton fa fa-minus-square remove-<%= item.id %>" href="#" tabIndex="0" title="Delete"></a>\n\t\t<% } %>\n\t\t<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n\t\t<% if(item.extra) { %>\n\t\t\t<span class="list-item-extra"><%= item.extra %></span>\n\t\t<% } %>\n\t</div>\n<% }); %>\n\n<div>\n\t<a type="button" tabIndex="0" class="addButton imageButton fa fa-plus-square" href="#" title="Add"></a>\n</div>';

},{}],160:[function(require,module,exports){
module.exports='<div id="syncBinder" style="width: 0px;"></div>\n<div id="inspector" style="width: 0px;"></div>\n<div id="mainTimelineCanvas">\n\t<div id="filterBarDiv" class="filterBar" style="height: 0px;"></div>\n\t<div class="contentDiv" id="mainTimelineContentDiv" style="top: 0px;">\n\t\t<img class="backgroundImage" />\n\t\t<div class="backgroundOvercoat"></div>\n\t\t<div id="timelineContentUnderHeader">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="timelineSvgWrapper" width="100%" height="100%" style="overflow: visible">\n\t\t        <svg  xmlns = "http://www.w3.org/2000/svg" class="timelineContent svgViewport" viewbox="0 0 1 1" preserveAspectRatio="xMinYMin meet" style="overflow: visible">\n\t\t            <g class="lifetime_bg_layer" />\n\t\t            <g class="bg_layer" />\n\t\t            <g class="dependency_layer" />\n\t\t        </svg>\n\t\t\t</svg>\n\n\t\t\t<div id="event_layer" class="event_layer"></div>\n\t\t\t<div class="laneOverlay"></div>\n\t\t\t<svg id="ui_drawing_svg"></svg>\n\n\t\t\t<svg class="laneNavSvgWrap svgViewport" width="24" height="100%" viewbox="0 0 1 1" preserveAspectRatio="xMaxYMin meet" style="overflow: visible">\n\t        \t<g class="laneNavSvg" />\n\t        </svg>\n\t\t</div>\n\t\t<svg class="header svgViewport" viewbox="0 0 1 1" preserveAspectRatio="xMinYMin meet" />\n\t\t<svg class="contextBarWrap svgViewport" x="0" y="100%" viewbox="0 0 1 1" preserveAspectRatio="xMinYMax meet" style="overflow: visible">\n\t\t\t<g class="contextBar">\n\t            <g class="contextLayer" />\n\t            <g class="contextLens" />\n\t        </g>\n        </svg>\n\t</div>\n\n\t<div class="contentDiv" id="relationshipContentDiv" style="top: 0px;">\n\t\t<img class="backgroundImage" />\n\t\t<div class="backgroundOvercoat"></div>\n\t\t<div id="relationship_bg_layer"></div>\n\t\t<div id="relationship_intersection_layer"></div>\n\t\t<div id="relationship_offset_layer"></div>\n\t\t<div id="relationship_event_layer"></div>\n\t\t<div id="relationship_lane_layer"></div>\n\t\t<div id="relationship_entity_header"></div>\n\t\t<svg id="relationship_ui_drawing_svg"></svg>\n\t\t<div id="relationship_settings_layer">\n\t\t\t<div id="relationshipSettingsButton" class="fa fa-cog" title="Settings"></div>\n\t\t\t<div id="relationshipOffsetButtonGroup" class="btn-group" role="group" aria-label="...">\n\t\t\t\t<button id="relationshipOffsetButton" type="button" title="Show/hide offsets" class="btn btn-default"><i class="fa fa-list-ol"></i></button>\n\t\t\t</div>\n\t\t\t<div id="relationshipNestingButtonGroup" class="btn-group" role="group" aria-label="...">\n\t\t\t\t<button id="relationshipTreeNestingButton" type="button" title="Nest parent/child events" class="btn btn-default"><i class="fa fa-indent"></i></button>\n\t\t\t\t<button id="relationshipFlattenNestingButton" type="button" title="Flatten parent/child events" class="btn btn-default"><i class="fa fa-align-justify"></i></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<svg class="laneNavSvgWrap svgViewport" width="24" height="100%" viewbox="0 0 1 1" preserveAspectRatio="xMaxYMin meet" style="overflow: visible">\n\t    \t<g class="laneNavSvg" />\n\t    </svg>\n\t\t<svg class="xScrollSvgWrap svgViewport" width="100%" height="24" viewbox="0 0 1 1" preserveAspectRatio="xMinYMax meet" style="overflow: visible">\n\t    \t<g class="xScrollSvg" />\n\t    </svg>\n\t</div>\n\n\t<div id="bookmarks" class="bookmarks">\n\t\t<div class=\'bookmarkFirst\'>First</div>\n\t\t<div class=\'bookmarkPrevious\'>Previous</div>\n\t\t<div class="bookmarkGroup"></div>\n\t\t<div class=\'bookmarkLast\'>Last</div>\n\t\t<div class=\'bookmarkNext\'>Next</div>\n\t\t<div class=\'bookmarkAdd\'>Add</div>\n\t</div>\n\n\t\x3c!--\n\t<svg xmlns = "http://www.w3.org/2000/svg" id="relationshipModeSvgWrapper" width="100%" height="100%" style="overflow: visible">\n\t    <svg  xmlns = "http://www.w3.org/2000/svg" id="relationshipModeContent" class="svgViewport" viewbox="0 0 1 1" preserveAspectRatio="xMinYMin meet" style="overflow: visible">\n\t    </svg>\n\t</svg>\n--\x3e\n\n</div>\n\n<div id="onboardingModal"></div>\n<div id="relationshipViewRoleContextMenu"></div>\n<div id="addEventModal"></div>\n<div id="addEntityModal"></div>\n<div id="embedInNewParentModal"></div>\n<div id="manageEntitiesModal"></div>\n<div id="editTemplateModal"></div>\n<div id="displaySettingsModal"></div>\n<div id="tagManagerModal"></div>\n<div id="syncSettingsModal"></div>\n<div id="syncManagerModal"></div>\n<div id="exportCsvModal"></div>\n<div id="importCsvModal"></div>\n<div id="exportImageModal"></div>\n<div id="findReplaceModal"></div>\n<div id="printModal"></div>\n<div id="newParentModal"></div>\n\x3c!-- must be below others as it may be used over top --\x3e\n<div id="enterNameModal"></div>\n\x3c!-- must be below others as it is used over top --\x3e\n<div id="enterDateModal"></div>\n\x3c!-- must be below others as it is used over top --\x3e\n<div id="enterDurationModal"></div>\n\x3c!-- must be below others as it is used over top --\x3e\n<div id="editCalendarModal"></div>\n\x3c!-- must be below others as it is used over top --\x3e\n<input type="text" id="modalInputCatcher" />';

},{}],161:[function(require,module,exports){
module.exports='\x3c!--<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">--\x3e\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n        <h4 class="modal-title" id="manageEntitiesWindowTitle">Manage Entities</h4>\n      </div>\n\t\t<form id="manageEntitiesForm" class="pure-form pure-form-aligned">\n      <div class="modal-body">\n      \t<div class="masterDetailWindow">      \n\t\t\t<div class="masterView withControls">\n\t\t\t\t<div class="masterViewList"></div>\n\t\t\t\t<div class="masterViewControls">\n\t\t\t\t\t<i id="manageEntitiesSortAlphaButton" class="fa fa-sort-alpha-asc"></i>\t\t\t\n\t\t\t\t\t<i id="manageEntitiesMoveDownButton" class="fa fa-chevron-circle-down" style="float: right"></i>\n\t\t\t\t\t<i id="manageEntitiesMoveUpButton" class="fa fa-chevron-circle-up" style="float: right"></i>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class="detailView">\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field alongsideButton">\n\t\t\t\t\t\t<label for="manageEntitiesName">Name</label>\n\t\t\t\t\t\t<input id="manageEntitiesName" type="text" placeholder="Name">\n\t\t\t\t\t\t<input id="manageEntitiesColor" type="text" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="manageEntitiesNotes">Notes</label>\n                        <textarea id="manageEntitiesNotes"></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="manageEntitiesAgeGroup">\n\t\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t\t<div class="pure-modal-heading">Birth / Creation</div>\n\t\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t    <label for="manageEntitiesCreateEvent">Event</label>\n\t\t\t\t\t\t    <div id="manageEntitiesCreateEvent"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="pure-modal-field sideBySide">\n\t\t\t\t\t\t    <label for="manageEntitiesCreateOffset">Offset</label>\n\t\t\t\t\t\t\t<input type="text" id="manageEntitiesCreateOffset" />\n\t\t\t\t\t\t    <select id="manageEntitiesCreateOffsetFrom">\n\t\t\t\t\t\t    \t<option value="start">from start</option>\n\t\t\t\t\t\t    \t<option value="end">from end</option>\n\t\t\t\t\t\t    </select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t    <label for="manageEntitiesCreateDate">Date</label>\n\t\t\t\t\t\t    <div id="manageEntitiesCreateDate"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t\t<div class="pure-modal-heading">Death / Destruction</div>\n\t\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t    <label for="manageEntitiesDestroyEvent">Event</label>\n\t\t\t\t\t\t    <div id="manageEntitiesDestroyEvent"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="pure-modal-field sideBySide">\n\t\t\t\t\t\t    <label for="manageEntitiesDestroyOffset">Offset</label>\n\t\t\t\t\t\t\t<input type="text" id="manageEntitiesDestroyOffset" />\n\t\t\t\t\t\t    <select id="manageEntitiesDestroyOffsetFrom">\n\t\t\t\t\t\t\t\t<option value="start">from start</option>\n\t\t\t\t\t\t\t\t<option value="end">from end</option>\n\t\t\t\t\t\t    </select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t    <label for="manageEntitiesDestroyDate">Date</label>\n\t\t\t\t\t\t    <div id="manageEntitiesDestroyDate"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="detailViewControls">\n\t\t\t\t    <button  type="button" id="manageEntitiesRemoveButton" class="btn btn-delete">Delete entity</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t      </div>\n      </div>  \n\t\t</form>\n\n    </div>\n  </div>\n\x3c!--</div>--\x3e';

},{}],162:[function(require,module,exports){
module.exports='  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title">Convert "<span id="newParentEventTitle"><%= eventTitle %></span>" to Parent</h4>\n      </div>\n      <div class="modal-body modalForm">\n      \t<div class="pure-modal-group">\n\t      \t<label>\n\t\t      \t<p>You are converting this event to a parent container. The start and end positions of parent container events are determined by their child positions.</p>\n\t\t      \t<p>Do you wish to create new start and end child events to preserve the current start and end positions of this event?</p>\n\t\t    </label>\n      \t</div>\n\t  </div>\n      <div class="modal-footer">\n\t    <input class="btn" name="commit" type="button" id="newParentNoButton" value="No" />\n\t    <input class="btn btn-primary" name="commit" type="button" id="newParentYesButton" value="Yes" />\n      </div>\n    </div>\n  </div>\n';

},{}],163:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content" id="onboardingWindow">\n\t\t<div class="modal-header">\n\t        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title" id="displaySettingsWindowTitle"><span id="onboardingCategory">Tip</span> <span id="onboardingPage">1</span>/<span id="onboardingPages">5</span>: <span id="onboardingTitle">Arcs are Entities</span></h4>\n\t\t</div>\n\t\t<div class="modal-body">\n\t\t\t<div class="pure-modal-group">\n\t\t\t\t<div id="onboardingContent"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="modal-footer">\n\t\t  <a id="btnOnboardingHelp" style="float: left;" class="btn btn-default">Online Help</a>\n\t\t  <input class="btn btn-default" name="previous" type="button" id="onboardingPrev" value="Previous" />\n\t\t  <input class="btn btn-primary" name="commit" type="button" id="onboardingNext" value="Next" />\n\t\t</div>\n\t</div>\n</div>';

},{}],164:[function(require,module,exports){
module.exports='<% _.each(options, function(option) { %>\n\t<option value="<%= option[valueProperty] %>"><%= option[textProperty] %></option>\n<% }); %>\n';

},{}],165:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n\t\t\t<h4 class="modal-title" id="printWindowTitle"><%= windowTitle %></h4>\r\n\t\t</div>\r\n\t\t<form id="printForm" class="pure-form pure-form-aligned">\r\n\t\t\t<div class="modal-body">\r\n\t\t\t\t<div class="pure-modal-group">\r\n\t\t\t\t\t<div class="pure-modal-field">\r\n\t\t\t\t\t\t<label for="printSettingsSkin">Skin</label>\r\n\t\t\t\t\t\t<select id="printSettingsSkin">\r\n\t\t\t\t\t\t    <option value="dark">Dark</option>\r\n\t\t\t\t\t\t    <option value="light">Light</option>\r\n\t\t\t\t\t\t    <option value="writer">Writer</option>\r\n\t\t\t\t\t\t    <option value="ocean">Ocean</option>\r\n\t\t\t\t\t\t    <option value="borealis">Borealis</option>\r\n\t\t\t\t\t\t    <option value="print">Print</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="pure-modal-field">\r\n\t\t\t\t\t\t<label for="printSettingsSize">Size</label>\r\n\t\t\t\t\t\t<select id="printSettingsSize">\r\n\t\t\t\t\t\t    <option value="50">50%</option>\r\n\t\t\t\t\t\t    <option value="60">60%</option>\r\n\t\t\t\t\t\t    <option value="70">70%</option>\r\n\t\t\t\t\t\t    <option value="80">80%</option>\r\n\t\t\t\t\t\t    <option value="90">90%</option>\r\n\t\t\t\t\t\t    <option value="100">100%</option>\r\n\t\t\t\t\t\t    <option value="110">110%</option>\r\n\t\t\t\t\t\t    <option value="120">120%</option>\r\n\t\t\t\t\t\t    <option value="130">130%</option>\r\n\t\t\t\t\t\t    <option value="150">150%</option>\r\n\t\t\t\t\t\t    <option value="150">175%</option>\r\n\t\t\t\t\t\t    <option value="200">200%</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="Format">Format</label>\r\n                        <input id="formatCurrentPrint" type="radio" name="Format" value="Current" checked />&nbsp;&nbsp;Current Window&nbsp;&nbsp;&nbsp;\r\n                        <input id="entireTimelinePrint" type="radio" name="Format" value="All" />&nbsp;&nbsp;Entire Timeline&nbsp;&nbsp;&nbsp;\r\n                        <input id="betweenDatesPrint" type="radio" name="Format" value="Interval" />&nbsp;&nbsp;Between Dates\r\n                    </div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="printSettingsOmitCollapsedLanes">Include</label>\r\n                        <input type="checkbox" id="printSettingsOmitCollapsedLanes" checked="checked" />&nbsp;&nbsp;Print expanded groups only\r\n                    </div>\r\n                </div>\r\n                <div class="pure-modal-group alternate">\r\n                    <div class="pure-modal-field">\r\n                        <label for="startDateInputPrint">Start Date</label>\r\n                        <div id="startDateInputPrint"></div>\r\n                    </div>\r\n                    <div class="pure-modal-field">\r\n                        <label for="endDateInputPrint">End Date</label>\r\n                        <div id="endDateInputPrint"></div>\r\n                    </div>\r\n                </div>\r\n\t\t\t</div>\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<input class="btn btn-primary" name="commit" type="submit" id="printSubmit" value="OK" />\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>\r\n</div>';

},{}],166:[function(require,module,exports){
module.exports='<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\n\t    <label for="Tags">Tags</label>\n\t\t<input type="text" class="form-control" id="inspectorTagsField" name="inspectorTags" value="" />\n\t</div>\n</div>\n<% _.each(properties,function(prop) { %>\n<div class="pure-inspector-group">\n\t<div class="pure-inspector-field">\n\t    <label for="<%= prop.name %>"><%= prop.name %></label>\n\t    <% if(prop.type == \'text\' || prop.type == \'string\') { %>\n\t\t\t<input type="text" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'multitext\' || prop.type == \'richtext\') { %>\n\t\t\t<textarea id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>"></textarea>\n\t\t<% } else if(prop.type == \'number\') { %>\n\t\t\t<input type="number" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'decimal\') { %>\n\t\t\t<input type="number" step="any" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'percentage\') { %>\n\t\t\t<input type="number" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'currency\') { %>\n\t\t\t<input type="number" step="any" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'boolean\') { %>\n\t\t\t<input type="checkbox" id="inspector-property-<%= prop.propertyId %>" name="<%= prop.name %>" />\n\t\t<% } else if(prop.type == \'list\') { %>\n\t\t\t<div class="property_<%= prop.propertyId %>" id="inspector-property-<%= prop.propertyId %>"></div>\n\t\t<% } %>\n\t</div>\t\t\t\t\t\t\n</div>\n<% }); %>\n';

},{}],167:[function(require,module,exports){
module.exports='\x3c!--<fieldset>--\x3e\n\t<div class="pure-inspector-group">\n\t\t<div class="pure-inspector-field">\n\t\t    <label for="basedOn">Based on</label>\n\t\t\t<div class="valueList basedOn"></div>\n\t\t</div>\n\t</div>\t\t\n\t<div class="pure-inspector-group">\n\t\t<div class="pure-inspector-field">\n\t\t    <label for="startDate">Start</label>\n\t\t    <div class="startDate"></div>\t\t\t\t\t\t\t\t\t\t\n\t\t</div>\n\t\t<div class="pure-inspector-field">\n\t\t    <label for="duration">Duration</label>\n\t\t\t<input type="text" name="duration" class="duration" value="">\n\t\t</div>\n\t\t<div class="pure-inspector-field">\n\t\t    <label for="endDate">End</label>\n\t\t    <div class="endDate"></div>\n\t\t</div>\n\t</div>\n\t<div class="pure-inspector-group">\n\t\t<div class="pure-inspector-field">\n\t\t    <label for="name">Followers</label>\n\t\t\t<div class="valueList successor"></div>\n\t\t</div>\n\t</div>\t\n\x3c!--</fieldset>--\x3e';

},{}],168:[function(require,module,exports){
module.exports='<div class="pure-modal-limit-height">\n\t<% _.each(groups,function(group) { \n\t\tvar safeGroupName = group.name.replace(/\\s/g, "__space__").replace(/\\//g, "__slash__");\n\t\t%>\n\t\t<div class="selectColumnsGroupWrap-<%= safeGroupName %>">\n\t\t\t<div class="checkboxGroupHeading pure-modal-group">\n\t\t\t\t<span class="fa fa-caret-down selectColumnGroupDisplayToggle collapse-group-<%= safeGroupName %>" data-groupName="<%= safeGroupName %>"></span>\n\t\t\t\t<input type="checkbox" value="<%= safeGroupName%>" class="selectColumnGroupCheckbox show-group-<%= safeGroupName %>" /> \n\t\t\t\t<span><%= group.name %></span>\n\t\t\t</div>\n\t\t\t<div class="selectColumnsRowWrap">\n\t\t\t\t<% _.each(group.items,function(item) { %>\n\t\t\t\t\t<div class="pure-modal-group checkboxRow">\n\t\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t\t<input type="checkbox" value="<%= item.id%>" class="selectColumnListItemCheckbox show-column-<%= item.id %>" <%= item.isChecked ? \'checked="checked"\' : \'\' %> /> <%= item.name %>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t<% }); %>\n\t\t\t</div>\n\t\t</div>\n\t<% }); %>\n</div>\n<div class="popover-footer">\n\t<div class="pure-modal-field">\n\t\t<input type="button" class="btn btn-default" name="noneButton" value="None" id="selectColumnNoneBtn" />\n\t\t<input type="button" class="btn btn-default" name="allButton" value="All" id="selectColumnAllBtn" />\n\t</div>\t\n</div>\n';

},{}],169:[function(require,module,exports){
module.exports='<% _.each(roles,function(role) { %>\n\t<div class="pure-inspector-group">\n\t\t<div class="pure-inspector-field">\n\t\t    <label for="<%= role.roleId %>"><%= role.name %></label>\n\t\t    <% if(role.multiplePerEvent) { %>\n\t\t\t\t<div class="valueList role_<%= role.roleId %>"></div>\n\t\t\t<% } else { %>\n\t\t\t\t<div class="role_<%= role.roleId %>" ></div>\n\t\t\t<% } %>\n\t\t</div>\n\t</div>\t\t\t\t\t\t\n<% }); %>\n\t<div id="inspectorRoleEntitySearch"></div>\t\n';

},{}],170:[function(require,module,exports){
module.exports='<span class="bselect-label">&nbsp;</span>\n<button type="button" class="bselect-caret" tabindex="-1">\n\t<span class="fa fa-chevron-down"></span>\n</button>\n<div class="bselect-dropdown" style="display: none;">\n\t<div class="bselect-search">\n\t\t<input type="text" class="bselect-search-input" role="combobox" tabindex="0" aria-expanded="false" aria-owns="bselect-option-list-1" style="width: 169px;">\n\t\t<span class="bselect-search-icon" style="margin-left: -6px;">\n\t\t\t<i class="fa fa-search"></i>\n\t\t</span>\n\t</div>\n\t<div class="bselect-message" role="status" style="display: none;">No matches</div>\n\t<ul class="bselect-option-list" id="bselect-option-list-1" role="listbox">\n\t</ul>\n</div>\n';

},{}],171:[function(require,module,exports){
module.exports='\x3c!--<div id="<%= elementName %>" class="searchContextMenu bselect-dropdown" style="display: none;">--\x3e\n\t<form id="<%= elementName %>-form" class="pure-form">\n\t\t<div class="bselect-search">\n\t\t\t<input   id="<%= elementName %>-searchInput" type="text" class="bselect-search-input" role="combobox" tabindex="1" aria-expanded="false" aria-owns="bselect-option-list-1" style="width: 169px;">\n\t\t\t<span class="bselect-search-icon" style="margin-left: -6px;">\n\t\t\t\t<i class="fa fa-search"></i>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="bselect-message"   id="<%= elementName %>-noMatchMessage" role="status" style="display: none;">No matches</div>\n\t\t<ul class="bselect-option-list"   id="<%= elementName %>-list" role="listbox">\n\t\t</ul>\n\t</form>\n\x3c!--</div>--\x3e\n';

},{}],172:[function(require,module,exports){
module.exports='<div id="syncBinderResizeWrapper">\n\t<div id="syncBinderResizeGrabber"></div>\n\t<div id="syncBinderContent">\n\t\t<form id="syncBinderForm">\n\t\t\t<div id="syncBinderTopRow"> \n\t\t\t\t<i id="syncBinderSettingsButton" class="fa fa-cog" title="Settings"></i>\n\t\t        <i id="syncBinderCloseButton" class="fa fa-times-circle" title="Close"></i>\n\t\t        <i id="syncBinderSyncButton" class="fa fa-refresh" title="Update All"></i>\n\t\t        <span id="syncBinderTitle">Scrivener Project</span>\n\t\t        <div id="syncBinderProgressDiv"></div>\n\t\t\t</div>\n\t\t\t<div id="syncBinderTopNav">\n\t\t\t\t<ul class="syncBinderTabRow">\n\t\t\t\t   <li id="syncBinderTabHome">Binder</li><li id="syncBinderTabWarnings">Warnings <span id="syncBinderWarningsCount" class="count">0</span></li><li id="syncBinderTabEvents">Events <span id="syncBinderEventsCount" class="count">0</span></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t    <div id="syncBinderTreeContainer">\n\t\t    </div>\n\t\t\t<div id="syncBinderErrorDiv">\n\t\t\t\t<div>\n\t\t\t\t\t<p id="syncBinderErrorMessage"></p>\n\t\t\t\t</div>\n\t\t\t\t<div id="syncBinderTryAgainDiv">\n\t\t\t\t\t<button id="syncBinderTryAgainButton" class="btn btn-default btn-xs" type="button">Try Again</button>\n\t\t   \t\t</div>\n\t\t\t</div>   \n\t\t\t<div id="syncBinderBottomRow"> \n\t\t\t\t<div id="syncBinderSearchDiv" class="emptyText">\n\t\t\t\t\t<span class="binder-search-icon">\n\t\t\t\t\t\t<i class="fa fa-search"></i>\n\t\t\t\t\t</span>\n\t\t\t\t\t<input id="syncBinderSearch" type="text" class="binder-search-input" placeholder="Filter" />\n\t\t\t\t\t<span class="binder-search-clear-icon">\n\t\t\t\t\t\t<i class="fa fa-times-circle"></i>\n\t\t\t\t\t</span>\n\t\t\t\t</div> \n\t\t\t\t<span id="syncBinderFilter">\n\t\t\t\t\tShow: <label><input type="checkbox" id="syncBinderUnchangedCheckbox" checked="checked" /> Unchanged</label> <label><input type="checkbox" id="syncBinderIgnoredCheckbox" checked="checked" /> Ignored</label>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\n\t\t</form>\t\n\t</div>\n</div>\n<div id="syncBinderLinkEventSearch"></div>\t\n';

},{}],173:[function(require,module,exports){
module.exports="<div class=\"comparison-table pure-modal-field\">\n\t<div class=\"comparison-table-fixed-header\">\n\t\t<div class=\"comp-status-cell\"><strong>Sync Status:</strong> <i class=\"fa <%= syncStatusIcon %> comp-status-<%= status %>\"></i> <%= displayStatus %></div>\n\t\t<div class=\"comp-row\">\n\t\t<% if(status != 'new' && status != 'ignored' && status != 'eventDeleted') { %>\n\t\t\t\t<div class=\"comp-head comp-cell-single\">Document</div>\n\t\t\t\t<div class=\"comp-cell-spacer comp-head\"></div>\n\t\t\t\t<div class=\"comp-head comp-cell-single\">Timeline Event</div>\n\t\t<% } else { %>\n\t\t\t\t<div class=\"comp-head comp-cell-single\">Document Contents</div>\t\t\n\t\t<% } %>\n\t\t</div>\n\t</div>\n\t<div class=\"comparison-table-scroll-body\">\n\t<% _.each(fields,function(field, propId) {\n\t\t\tvar pStr = field.singleLine ? '<p class=\"singleLine\">' : '<p>',\n\t\t\t\tp2Str = '</p>' + pStr, \n\t\t\t\titemRaw = field.itemVal.length > 0 ? field.itemVal : '&nbsp;',\n\t\t\t\teventRaw = field.eventVal.length > 0 ? field.eventVal : '&nbsp;',\t\t\t\t\n\t\t\t\titemStr = \tpStr + itemRaw\n\t\t\t\t\t\t\t\t\t.split('[aeon-insert]').join('<span class=\"new\">')\n\t\t\t\t\t\t\t\t\t.split('[/aeon-insert]').join('</span>')\n\t\t\t\t\t\t\t\t\t.split('[aeon-delete]').join('<span class=\"old\">')\n\t\t\t\t\t\t\t\t\t.split('[/aeon-delete]').join('</span>')\n\t\t\t\t\t\t\t\t\t.split('\\n').join(p2Str) +\n\t\t\t\t\t\t\t'</p>';\n\t\t\t\teventStr = \tpStr + eventRaw\n\t\t\t\t\t\t\t\t\t.split('[aeon-insert]').join('<span class=\"new\">')\n\t\t\t\t\t\t\t\t\t.split('[/aeon-insert]').join('</span>')\n\t\t\t\t\t\t\t\t\t.split('[aeon-delete]').join('<span class=\"old\">')\n\t\t\t\t\t\t\t\t\t.split('[/aeon-delete]').join('</span>')\n\t\t\t\t\t\t\t\t\t.split('\\n').join(p2Str) +\n\t\t\t\t\t\t\t'</p>',\n\t\t\t\titemCellClass = field.resolution == 'unchanged' ? 'unchanged' :\n\t\t\t\t\t\t\t\t\tfield.resolution == 'conflict' ? 'conflict' : \n\t\t\t\t\t\t\t\t\t\tfield.resolution == 'keepItem' || field.resolution == 'merged' ? 'selected' : '',\n\t\t\t\teventCellClass = field.resolution == 'unchanged' ? 'unchanged' :\n\t\t\t\t\t\t\t\t\tfield.resolution == 'conflict' ? 'conflict' : \n\t\t\t\t\t\t\t\t\t\tfield.resolution == 'keepEvent' || field.resolution == 'merged' ? 'selected' : '';\t\t\t\t\n\t%>\n\t\t\t<div class=\"comp-cell-label <%= field.resolution == 'conflict' ? 'comp-cell-label-conflict' : ''%>\"><%= field.displayName %></div>\n\t<% \t\tif(field.resolution == 'unchanged') { %>\n\t\t\t\t<div class=\"comp-cell comp-cell-stride <%= itemCellClass %>\"><%= itemStr %></div>\n\t<% \t\t} else { %>\n\t\t\t\t<div class=\"comp-row\">\n\t\t\t\t\t<div class=\"comp-cell comp-cell-single <%= itemCellClass %>\"><%= itemStr %><button class=\"btn btn-xs btn-default\" id=\"sync-choose-<%= propId %>-item\">Choose</button></div>\n\t\t\t\t\t<div class=\"comp-cell-spacer\"></div>\n\t\t\t\t\t<div class=\"comp-cell comp-cell-single <%= eventCellClass %>\"><%= eventStr %><button class=\"btn btn-xs btn-default\" id=\"sync-choose-<%= propId %>-event\">Choose</button></div>\n\t\t\t\t</div>\n\t<% \t\t} \n\t\t});%>\n\t</div>\n</div>\n<div class=\"popover-footer\">\n<div class=\"pure-modal-field\">\n\t<% if(status != 'loading' && status != 'new' && status != 'ignored' && status != 'eventDeleted') { %>\n\t\t<input type=\"button\" class=\"btn btn-delete\"  style=\"float: left;\" name=\"unlinkButton\" value=\"Break Link\" id=\"itemStatusUnlinkBtn\" />\n\t\t<i class=\"fa fa-spinner fa-pulse syncItemStatusLoading notLoading\"></i>\n\t\t<input type=\"button\" class=\"btn btn-primary <%= status == 'conflict' ? 'disabled' : ''%>\" name=\"syncButton\" value=\"Sync Now\" id=\"itemStatusSyncBtn\" <%= status == 'conflict' ? 'disabled=\"disabled\"' : ''%> />\n\t<% } else { %>\n\t\t<input type=\"button\" class=\"btn btn-delete\"  style=\"float: left;\" name=\"trashButton\" value=\"Move to Trash\" id=\"itemStatusTrashBtn\" />\n\t\t<% if(status != 'ignored') { %>\n\t\t\t<input type=\"button\" class=\"btn btn-default\"  name=\"unlinkButton\" value=\"Ignore\" id=\"itemStatusIgnoreBtn\" />\n\t\t<% } %> \n\t\t<i class=\"syncItemStatusLoading fa fa-spinner fa-pulse notLoading\"></i>\n\t\t<input type=\"button\" class=\"btn btn-primary <%= status == 'loading' ? 'disabled' : ''%>\" name=\"syncButton\" value=\"Create Event\" id=\"itemStatusCreateEventBtn\" <%= status == 'loading' ? 'disabled=\"disabled\"' : ''%> />\n\t<% } %>\n</div>\t\n</div>\n";

},{}],174:[function(require,module,exports){
module.exports='<% _.each(items,function(item) { %>\n\t<div>\n\t\t<a type="button" class="imageButton fa fa-minus-square remove-<%= item.id %>" href="#" tabIndex="0" title="Remove Link" <% if(item.removeDisabled) { %>disabled="disabled" <% } %>></a>\n\t\t<span class="list-item-title title-<%= item.id %>"><%= item.title %></span>\n\t\t<% if(item.extra) { %>\n\t\t\t<span class="list-item-extra"><%= item.extra %></span>\n\t\t<% } %>\n\n\t\t<span class="list-item-actions">\n\t\t<% if(item.quicklookPath) { %>\n \t\t\t<a type="button" class="imageButton fa fa-eye quicklook-<%= item.id %>" href="#" tabIndex="0" <% if(item.quicklookDisabled) { %>disabled="disabled" <% } %> title="Quicklook Document"></a>\n \t\t<% } %>\n\t\t<% if(item.revealPath) { %>\n\t\t\t<a type="button" class="imageButton fa fa-folder-open reveal-<%= item.id %>" href="#" tabIndex="0" <% if(item.revealDisabled) { %>disabled="disabled" <% } %> title="Open Folder Location"></a>\n \t\t<% } %>\t\t\t\n\t\t<% if(item.openPath) { %>\n\t\t\t<a type="button" class="imageButton fa fa-external-link open-<%= item.id %>" href="#" tabIndex="0" <% if(item.openDisabled) { %>disabled="disabled" <% } %> title="Open Document"></a>\n \t\t<% } %>\n\t\t</span>\n\n\t</div>\n<% }); %>\n<% if(items.length == 0) { %>\n<div>Not linked to any items</div>\n<% } %>';

},{}],175:[function(require,module,exports){
module.exports='<form class="pure-form pure-form-aligned">\n\t<div class="pure-modal-group">\n\t\t<div class="pure-modal-field">\n\t\t\t<label for="syncLinkEvent">Event:</label>\n\t\t\t<div id="syncLinkEvent"></div>\n\t\t</div>\t\n\t</div>\n\t<div class="popover-footer">\n\t\t<div class="pure-modal-field">\n\t\t    <input type="button" class="btn btn-primary" name="addButton" value="Add" id="syncLink-submit"/>\n\t\t</div>\t\n\t</div>\n</form>';

},{}],176:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n\t\t\t<h4 class="modal-title">Manage Sync Projects</h4>\r\n\t\t</div>\r\n\t\t<form id="tagManagerForm" class="pure-form pure-form-aligned">\r\n\t\t\t<div class="modal-body">\t\t\r\n\x3c!--\r\n\t\t\t\t<div class="pure-modal-group">\r\n\t\t\t\t    <label>Delete or rename existing tags to apply those changes to all associated events.</label>\r\n\t\t\t\t</div>\r\n--\x3e\r\n\t\t\t\t<div class="pure-modal-group">\r\n\t\t\t\t\t<div class="pure-modal-field">\t\r\n\x3c!-- \t\t\t\t\t    <label for="roles">Roles</label> --\x3e\r\n\t\t\t\t\t    <div class="valueList" id="syncManagerProjects" style="max-height: 30.0rem; overflow: auto;"></div>\r\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t\r\n\t</div>\r\n</div>';

},{}],177:[function(require,module,exports){
module.exports='<div class="modal-dialog">\n\t<div class="modal-content">\n\t\t<div class="modal-header">\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\n\t\t\t<h4 class="modal-title">Project Sync Settings</h4>\n\t\t</div>\n\t\t<form id="syncSettingsForm" class="pure-form pure-form-aligned">\n\t\t\t<div class="modal-body">\n\n\t\t\t\t<div class="pure-modal-group alternate">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t    <input id="syncSettingsAutoIgnoreNonText" type="checkbox" /> Automatically ignore all non-text items (folders, PDFs, media, etc.)\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<label>Sync timeline event fields with project properties:</label>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class="pure-modal-group" id="syncSettingsFieldOptionsDiv">\n\t\t\t\t\n\t\t\t\t<% _.each(fields,function(field) { \n\t\t\t\t\tvar cleanName = field.name.replace(/\\s/g,\'__space__\').replace(/\\[/g,\'__opensq__\').replace(/\\]/g,\'__closesq__\').replace(/:/g,\'__colon__\').replace(/\\//g,\'__slash__\');\n\t\t\t\t%>\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="syncSettingsOption<%= cleanName %>"><%= field.displayName %></label>\n\t\t\t\t\t\t<select id="syncSettingsOption<%= cleanName %>">\n\t\t\t\t\t\t<% _.each(field.options,function(opt) { \n\t\t\t\t\t\t\tvar cleanOptValue = opt.value ? opt.value.replace(/\\s/g,\'__space__\').replace(/\\[/g,\'__opensq__\').replace(/\\]/g,\'__closesq__\').replace(/:/g,\'__colon__\').replace(/\\//g,\'__slash__\') : opt.value;\n\t\t\t\t\t\t\t%>\n\t\t\t\t\t\t\t<option value="<%= cleanOptValue %>"><%= opt.displayName %></option>\t\n\t\t\t\t\t\t<% }); %>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t<% }); %>\n                 <div id="errorFieldScrivener" class="modalErrorMessage"></div>\n\t\t\t\t</div>\n\x3c!--\t\t\t\t<legend>Use date format in project:</legend>\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t\t<div class="pure-modal-field">\n\t\t\t\t\t\t<label for="syncSettingsDateFormat">Format</label>\n\t\t\t\t\t\t<select id="syncSettingsDateFormat">\n\t\t\t\t\t\t\t<option>Long format (23 November 2014)</option>\t\n\t\t\t\t\t\t\t<option>Short format (03/05/2014)</option>\t\n\t\t\t\t\t\t\t<option>Sortable (2014-09-23)</option>\t\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>--\x3e\n\t\t\t</div>\n\t\t\t<div class="modal-footer">\n\t\t\t\t<input id="syncSettingsSubmit" class="btn btn-primary" name="commit" type="submit" value="OK" />\n\t\t\t</div>\n\t\t</form>\n\t</div>\n</div>';

},{}],178:[function(require,module,exports){
module.exports='\x3c!-- Assume div for tabGroup already exists --\x3e\n\x3c!--div class="tabGroup" id="inspectorTabGroup"--\x3e\n\t<ul class="tabs">\n\t<% _.each(tabs,function(tab) { %>\n\t    <li id="<%= tab.name %>-tab-button">\n\t    \t<span class="fa fa-<%= tab.icon %>"></span><span class="tabGroupName"><%= tab.name %></span>\n\t    </li>\n\t<% }); %>\n\t</ul>\n\n\t<div class="tabContentGroup">\n\t<% _.each(tabs,function(tab) { %>\n\t\t<div class="tabcontent" id="<%= tab.name %>-page">\n\t\t</div>\n\t<% }); %>\n\t</div>\n\n\x3c!--/div--\x3e\t';

},{}],179:[function(require,module,exports){
module.exports='<div class="modal-dialog">\r\n\t<div class="modal-content">\r\n\t\t<div class="modal-header">\r\n\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="fa fa-times-circle"></span></button>\r\n\t\t\t<h4 class="modal-title" id="tagManagerTitle">Tag Manager</h4>\r\n\t\t</div>\r\n\t\t<form id="tagManagerForm" class="pure-form pure-form-aligned">\r\n\t\t\t<div class="modal-body">\t\t\r\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t    <label>Delete or rename existing tags to apply those changes to all associated events.</label>\n\t\t\t\t</div>\n                <div class="pure-modal-group">\r\n                    <div class="pure-modal-field">\r\n                        \x3c!--<textarea id="tagManagerText" name"tagText" rows="10" cols="50"></textarea> --\x3e\n                        <input type="text" class="form-control" id="tagManagerText" name="tagText" value="" />\r\n                    </div>\r\n                </div>\r\n\t\t\t\t<div class="pure-modal-group">\n\t\t\t\t    <label>Note: new tags can only be created in the Inspector.</label>\n\t\t\t\t</div>\n\t\t\t</div>\r\n\t\t</form>\r\n\t\r\n\t</div>\r\n</div>';

},{}],180:[function(require,module,exports){
const _=require("lodash"),Backbone=require("backbone");var ATBaseView=Backbone.View.extend({beforeRender:function(){},afterRender:function(){},serialize:function(){return{}},defaultSettings:function(){return{}},defaultStyles:function(){return{}},afterCustomize:function(e){},beforeDestruct:function(){},defaultInsertSelector:function(){return""},getPreferredHeight:function(){return null},customize:function(e){var s=this;return _.each(e,function(e,i){s.settings[i]=e}),this.afterCustomize(e),this},updateStyles:function(e){var s=this;return _.each(e,function(e,i){s.styles[i]=e}),this.render(),this},hasClass:function(e,s){return s?(this.classes=_.union(this.classes,[e]),this.$el&&this.$el.addClass(e)):(this.classes=_.without(this.classes,e),this.$el&&this.$el.removeClass(e)),this},clearSubviews:function(e){var s=this;return _.isNil(e)?(_.each(this.subviews,function(e,i){_.isArray(e)?_.each(e,function(e){s.stopListening(e),e._remove()}):(s.stopListening(e),e._remove())}),this.subviews={}):(_.isArray(this.subviews[e])?_.each(this.subviews[e],function(e){s.stopListening(e),e._remove()}):_.isObject(this.subviews[e])&&(s.stopListening(this.subviews[e]),this.subviews[e]._remove()),delete this.subviews[e]),this},removeSubview:function(e){var s=this,i=null;_.each(this.subviews,function(t,n){_.isArray(t)?(_.each(t,function(i){i===e&&(s.stopListening(i),i._remove())}),_.pull(t,e),0===t.length&&(i=n)):t===e&&(s.stopListening(t),t._remove(),i=n)}),i&&delete this.subviews[i]},assignSubview:function(e,s){return s?(_.isNil(e.parentView)||e.parentView.removeSubview(e),this.subviews[s]&&(this.stopListening(this.subviews[s]),this.subviews[s]._remove()),this.subviews[s]=e,e._setParentView(this),this.listenTo(e,"view:resize",this.triggerResize.bind(this)),this):(console.log("ERROR: Cannot assignSubview without selector... if you want a child under the main el, call insertSubviews"),this)},insertSubviews:function(e,s){var i=this,t=s;return t||(t=this.defaultInsertSelector()),_.isArray(e)?_.each(e,function(e){_.isNil(e.parentView)||e.parentView.removeSubview(e)}):_.isNil(e.parentView)||e.parentView.removeSubview(e),_.isArray(this.subviews[t])||(this.subviews[t]?this.subviews[t]=[this.subviews[t]]:this.subviews[t]=[]),_.isArray(e)?_.each(e,function(s){i.subviews[t].push(s),s._setParentView(i),i.listenTo(e,"view:resize",i.triggerResize.bind(i))}):(this.subviews[t].push(e),e._setParentView(this),this.listenTo(e,"view:resize",this.triggerResize.bind(this))),this},render:function(){var e=this;return this.beforeRender(),this.$el.html(this.template?this.template(this.serialize()):""),this.$el.removeClass(),_.each(this.classes,function(s){e.$el.addClass(s)}),this.$el.attr("style",""),_.each(this.styles,function(s,i){_.isNil(s)||e.$el.css(i,s)}),_.each(this.subviews,function(s,i){e.renderSubviews(i)}),this.afterRender(),this.triggerResize(),this},renderSubviews:function(e){var s=this.subviews[e],i=e?this.$(e):this.$el;_.isArray(s)?_.each(s,function(e){e.recreateElement(),i.append(e.render().$el)}):s.setElement(i).render()},triggerResize:function(){this.trigger("view:resize")},recreateElement:function(){return this.el=null,this._ensureElement(),this.setElement(this.$el),this},commitChanges:function(){return this},constructor:function(e){this.settings=this.defaultSettings(),this.styles=this.defaultStyles(),this.classes=[this.className],this.subviews={},this.d3El=null,Backbone.View.apply(this,arguments)},_remove:function(){this.$el&&this.$el.detach(),this.beforeDestruct(),this._setParentView(null)},_setParentView:function(e){this.parentView=e}});module.exports=ATBaseView;

},{"backbone":220,"lodash":333}],181:[function(require,module,exports){
const _=require("lodash"),ATBaseView=require("./ATBaseView"),templateHtml=require("./templates/controlStackTemplate.html");var ATControlStackView=ATBaseView.extend({tagName:"div",className:"iosControlStack",template:_.template(templateHtml),transitionDuration:350,events:{},defaultInsertSelector:function(){return".iosControlStackControls"},setHeaderView:function(t){this.insertSubviews(t,".iosControlStackHeader")},setFooterView:function(t){this.insertSubviews(t,".iosControlStackFooter")},initialize:function(){this.d3El=null,this.reset(),this.rendered=!1},reset:function(){this.settings=this.defaultSettings(),this.clearSubviews()},afterRender:function(){}});module.exports=ATControlStackView;

},{"./ATBaseView":180,"./templates/controlStackTemplate.html":192,"lodash":333}],182:[function(require,module,exports){
var $=require("jquery");module.exports={fixPosition:function(){var e,n,t,i,a,o=window.getSelection(),l=document.activeElement;l&&((e=$(l)).is("div")?o.rangeCount&&(n=o.getRangeAt(0).cloneRange(),o.removeAllRanges(),o.addRange(n)):e.is(":input")&&(a=e.val(),t=l.selectionStart,i=l.selectionEnd,e.val(a+" ").val(a),l.setSelectionRange(t,i)))}};

},{"jquery":331}],183:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),ATBaseView=require("./ATBaseView"),templateHtml=require("./templates/modalTemplate.html"),ATFloatingMessageControl=ATBaseView.extend({tagName:"div",className:"floatingMessageControl",template:_.template(templateHtml),transitionDuration:350,zIndexShowing:750,defaultSettings:function(){return{container:"body",text:"",errorClass:!1}},initialize:function(){this.transitionDuration=350,this.attached=!1,this.reset()},serialize:function(){return{settings:this.settings}},reset:function(){this.settings=this.defaultSettings()},afterRender:function(){this._update()},afterCustomize:function(){this.$el&&this._update()},_update:function(){this.$el.html(this.settings.text),this.settings.errorClass?this.$el.addClass("messageError"):this.$el.removeClass("messageError")},show:function(){this.attached||(this.render(),$("body").append(this.$el),this.attached=!0),this.$el.addClass("showing"),this.trigger("message:shown")},hide:function(){this.attached&&(this.$el.removeClass("showing"),this.trigger("message:hidden"),this.$el.detach(),this.attached=!1)}});module.exports=ATFloatingMessageControl;

},{"./ATBaseView":180,"./templates/modalTemplate.html":194,"d3":320,"jquery":331,"lodash":333}],184:[function(require,module,exports){
var d3=require("d3"),_=require("lodash"),ATBaseView=require("./ATBaseView"),ATIconPickerControl=ATBaseView.extend({tagName:"div",className:"iosIconPickerControl",events:{"click .iosIconPickerIcon":"_iconClick"},initialize:function(){this.d3El=null,this.reset()},serialize:function(){return{}},defaultSettings:function(){return{allowMultiple:!1}},reset:function(){this.settings=this.defaultSettings(),this.iconOptions=[]},setIconOptions:function(e,t){this.iconOptions=t?JSON.parse(JSON.stringify(e)):e,this.update()},afterRender:function(){return this.d3El=d3.select(this.el),this.update(),this},update:function(){this.d3El&&(this.iconsD3=this.d3El.selectAll(".iosIconPickerIcon").data(this.iconOptions),this.iconsD3.enter().append("svg").classed("iosIconPickerIcon",!0).append("use"),this.iconsD3.attr("class",function(e){return"iosIconPickerIcon icon "+e.color+(e.selected?" selected":"")}).select("use").attr("xlink:href",function(e){return e.src}),this.iconsD3.exit().remove())},_iconClick:function(e){var t=d3.select(e.target).datum();this.settings.allowMultiple?(t.selected?(t.selected=!1,this.trigger("icon:unselect",t.id)):t.selected||(t.selected=!0,this.trigger("icon:select",t.id)),this.update()):(_.each(this.iconOptions,function(e){e.selected=!1}),t.selected=!0,this.trigger("icon:select",t.id))},selectedIcons:function(){var e=[];return _.each(this.iconOptions,function(t){t.selected&&e.push(_.clone(t))}),e}});module.exports=ATIconPickerControl;

},{"./ATBaseView":180,"d3":320,"lodash":333}],185:[function(require,module,exports){
var d3=require("d3"),_=require("lodash"),ATBaseView=require("./ATBaseView"),templateHtml=require("./templates/listControlTemplate.html"),matchAnyTerm=function(t,e){var i=!1,s=e.text.toLowerCase().split(" ");return _.each(t,function(t){_.each(s,function(e){e.length&&t.length&&0===e.indexOf(t.toLowerCase())&&(i=!0)})}),i},matchAllTerms=function(t,e){var i=!0,s=e.text.toLowerCase().split(/\s/);return _.each(t,function(t){var e=!1;_.each(s,function(i){0===i.indexOf(t)&&(e=!0)}),e||(i=!1)}),i},ATListControl=ATBaseView.extend({tagName:"div",className:"iosListControl",template:_.template(templateHtml),transitionDuration:350,events:{"input .iosListControlSearch":"_search","keypress .iosListControlSearch":"_commitOnEnter","blur .iosListControlSearch":"_inputBlur","click .iosListControlSearchClear":"_clearSearch","click .iosListItem":"_itemClick"},initialize:function(){this.d3El=null,this.reset()},serialize:function(){return{settings:this.settings,items:this.itemList}},defaultSettings:function(){return{maxHeight:"35.0rem",itemHeight:3.6,decoration:null,showSearch:!1,splitSearchTerms:!0,searchFunction:matchAllTerms,heading:null,allowMultiple:!1,moveSelectedToTop:!1,allowCreateNew:!1,placeholder:null}},reset:function(){this.settings=this.defaultSettings(),this.itemList=[]},setItemList:function(t,e){var i=0;this.itemList=e?JSON.parse(JSON.stringify(t)):t,this.itemCreateNew={id:"createNew",icon:null,color:null,text:"Create New",selected:!1,hide:!0},this.itemList.push(this.itemCreateNew),_.each(this.itemList,function(t){t.origIndex=i++}),this.render()},afterRender:function(){return this.$input=this.$(".iosListControlSearch"),this.settings.allowCreateNew&&this.$input.prop("Placeholder","Type to create new"),this.$(".iosListControlWrapper").css("max-height",this.settings.maxHeight),this.d3El=d3.select(this.el),this.itemsD3=this.d3El.selectAll(".iosListItem").data(this.itemList),this._update(!1),this},_update:function(t){var e=this,i=null,s=null,n=0,l=0,r=0,o=t?this.transitionDuration:0;this.settings.moveSelectedToTop&&this.itemList.sort(function(t,e){return t.selected&&!e.selected?-1:e.selected&&!t.selected?1:t.origIndex-e.origIndex}),_.each(this.itemList,function(t){t.lastSelected=null,t.lastVisible=null,t.hide?t.index=r++:(t.index=l++,n++,s=t,r++),t.selected&&(i=t)}),i&&(i.lastSelected=!0),s&&(s.lastVisible=!0),this.itemsD3.classed("selected",function(t){return t.selected}).classed("lastSelected",function(t){return t.lastSelected&&e.settings.moveSelectedToTop}).classed("lastItem",function(t){return t.lastVisible}).style("top",function(t){return t.index*e.settings.itemHeight+"rem"}).style("height",this.settings.itemHeight+"rem").style("opacity",function(t){return t.hide?0:1}).style("left",function(t){return t.hide?e.settings.maxWidth:"0px"}),this.itemsD3.select(".iosListItemText").text(function(t){return t.text}),this.d3El.select(".iosListControlItems").style("height",n*this.settings.itemHeight+"rem"),this.d3El.select(".iosListPlaceholder").style("display",n?"none":null),d3.select({}).transition().duration(o).tween("repositionPopover",function(){return function(t){e.trigger("view:resize")}})},_search:function(){var t=this,e=this.$input.val().toLowerCase(),i=e?this.settings.splitSearchTerms?e.split(" "):[e]:[];this.settings.searchFunction&&(0===i.length?_.each(this.itemList,function(t){t.hide=!1}):_.each(this.itemList,function(e){e.hide=!e.selected&&!t.settings.searchFunction(i,e)})),this.settings.allowCreateNew&&e?(this.itemCreateNew.hide=!1,this.itemCreateNew.text=e):this.itemCreateNew.hide=!0,this._update(!0)},_inputBlur:function(){var t=this;this.inputJustHadFocus=!0,window.setTimeout(function(){t.inputJustHadFocus=!1},10)},_clearSearch:function(){this.$input.val(""),this.inputJustHadFocus&&this.$input.focus(),this._search()},_commitOnEnter:function(t){13===t.keyCode&&(this.settings.allowCreateNew?this._listItemClick(this.itemCreateNew):document.activeElement.blur())},_itemClick:function(t){var e=d3.select(t.target).datum();this._listItemClick(e)},_listItemClick:function(t){this.settings.allowMultiple?(t.selected?(t.selected=!1,this.trigger("item:unselect",t)):t.selected||(t.selected=!0,this.trigger("item:select",t)),this.settings.showSearch?this._search():this._update(!0)):(t.selected=!0,this.trigger("item:select",t)),"createNew"===t.id&&this.settings.allowCreateNew&&this._clearSearch()},selectedItems:function(){var t=[];return _.each(this.itemList,function(e){e.selected&&t.push(_.clone(e))}),t}});module.exports=ATListControl;

},{"./ATBaseView":180,"./templates/listControlTemplate.html":193,"d3":320,"lodash":333}],186:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),ATBaseView=require("./ATBaseView"),templateHtml=require("./templates/modalTemplate.html"),ATModal=ATBaseView.extend({tagName:"div",className:"atModalBackdrop",template:_.template(templateHtml),transitionDuration:350,zIndexShowing:750,events:{click:"_backdropClick"},defaultSettings:function(){return{container:"body",height:"64.5rem",width:"21.6rem",heading:null,placement:"right",extraClasses:null,hideOnBackdropClick:!1}},initialize:function(){this.transitionDuration=350,this.attached=!1,this.modalIsHiding=!1,this.reset()},serialize:function(){return{settings:this.settings}},reset:function(){return this.settings=this.defaultSettings(),this},setMainView:function(t){return this.clearSubviews(),this.insertSubviews(t,".atModal"),this},afterRender:function(){this.d3El=d3.select(this.el),this.d3El.select(".atModal").style("height",this.settings.height?this.settings.height:null)},show:function(){var t=this;return this.modalIsHiding=!1,this.attached||(this.render(),$("body").append(this.$el),this.attached=!0,this.d3El=d3.select(this.el)),window.setTimeout(function(){t.$el.addClass("showing")},10),this.trigger("modal:shown"),window.mainApp&&(window.mainApp.iosModalCount++,window.ApplicationInterface&&window.ApplicationInterface.modalOpened(window.timelineDocumentId)),this},hide:function(){var t=this;return this.modalIsHiding=!0,this.attached&&(this.$el.removeClass("showing"),this.trigger("modal:hidden"),window.setTimeout(function(){t.attached&&t.$el&&t.modalIsHiding&&(t.$el.detach(),t.attached=!1)},500)),window.mainApp&&(window.mainApp.iosModalCount--,window.ApplicationInterface&&window.mainApp.iosModalCount<=0&&(window.mainApp.iosModalCount=0,window.ApplicationInterface.lastModalClosed(window.timelineDocumentId))),this},scrollToTop:function(){return this.$(".atModal").scrollTop(0),this},_backdropClick:function(t){this.settings.hideOnBackdropClick&&t.target===this.el&&this.hide()}});module.exports=ATModal;

},{"./ATBaseView":180,"./templates/modalTemplate.html":194,"d3":320,"jquery":331,"lodash":333}],187:[function(require,module,exports){
var _=require("lodash"),d3=require("d3"),Backbone=require("backbone"),ATControlStackView=require("./ATControlStackView"),ATRowControl=require("./ATRowControl"),ATPageCollectionView=require("./ATPageCollectionView"),ATOnboardSuggestions=require("../../controller/ATOnboardSuggestions"),ATCursorBugFix=require("./ATCursorBugFix"),ATModal=require("./ATModal"),scrollTopTween=function(t){return function(){var o=d3.interpolateNumber(this.scrollTop,t);return function(t){this.scrollTop=o(t),ATCursorBugFix.fixPosition()}}},ATNotificationManager=Backbone.View.extend({events:{},reservedKeywords:["Event","Entity","Tag","Color","Parent","Link","Any","None","All","Timeline"],initialize:function(){this.pageCollection=new ATPageCollectionView,this.infoId=null,this.editMode=!1,this.selectedTodoIds=[],this.selectedSuggestionIds=[],this.pageCollection.customize({width:"38.4rem",height:"64.5rem",backText:"Back",doneText:"Close",showDone:!0}),this.pageCollection.addPage({id:"todoMain",title:"Notifications",showBackAsCancel:!0,backText:this.editMode?"Delete":"Edit",doneText:this.editMode?"Done":"Close",backColorDestructive:this.editMode,control:this._createMainStackView()}),this.pageCollection.addPage({id:"todoInfo",title:"Suggestion Info",control:this._createInfoStackView()}),this.pageCollection.setFirstPageId("todoMain"),this.listenTo(this.model,"change:todos change:suggestions",_.debounce(this._updateTodoRows.bind(this),1)),this.listenTo(this.pageCollection,"page:back",this._pageBack.bind(this)),this.listenTo(this.pageCollection,"page:forward",this._pageForward.bind(this)),this.listenTo(this.pageCollection,"page:done",this._pageDone.bind(this)),this.listenTo(this.pageCollection,"page:cancel",this._pageCancel.bind(this))},_updateNavigation:function(){this.pageCollection.updatePage({id:"todoMain",backText:this.editMode?"Delete":"Edit",doneText:this.editMode?"Done":"Close",backColorDestructive:this.editMode})},show:function(){this.modal||(this.modal=new ATModal,this.modal.setMainView(this.pageCollection)),this._isShowing=!0,this.listenTo(this.modal,"modal:shown",this._modalShown.bind(this)),this.listenTo(this.modal,"modal:hidden",this._modalHidden.bind(this)),this._updateTodoRows(),this.modal.show()},hide:function(){this._isShowing=!1,this.modal.hide()},isShowing:function(){return Boolean(this._isShowing)},_createMainStackView:function(){return this.mainStack=(new ATControlStackView).hasClass("boxControls",!0),this.suggestionRowControl=new ATRowControl,this.todoRowControl=new ATRowControl,this.suggestionRowControl.customize({heading:"Suggestions",footer:"Clear list"}),this.todoRowControl.customize({heading:"Reminders",footer:"Clear completed"}),this.listenTo(this.suggestionRowControl,"row:click",this._suggestionRowClick.bind(this)),this.listenTo(this.suggestionRowControl,"row:select",this._suggestionRowSelect.bind(this)),this.listenTo(this.suggestionRowControl,"row:deselect",this._suggestionRowDeselect.bind(this)),this.listenTo(this.suggestionRowControl,"footer:click",this._suggestionFooterClick.bind(this)),this.listenTo(this.todoRowControl,"row:edit",this._todoRowEdit.bind(this)),this.listenTo(this.todoRowControl,"row:focus",this._rowFocus.bind(this)),this.listenTo(this.todoRowControl,"row:select",this._todoRowSelect.bind(this)),this.listenTo(this.todoRowControl,"row:deselect",this._todoRowDeselect.bind(this)),this.listenTo(this.todoRowControl,"row:move",this._todoRowMove.bind(this)),this.listenTo(this.todoRowControl,"footer:click",this._todoFooterClick.bind(this)),this.mainStack.insertSubviews([this.suggestionRowControl,this.todoRowControl]),this.mainStack},_createInfoStackView:function(){return this.infoStack=(new ATControlStackView).hasClass("boxControls",!0),this.descriptionRowControl=new ATRowControl,this.stepsRowControl=new ATRowControl,this.descriptionRowControl.customize({heading:""}),this.stepsRowControl.customize({heading:"Steps to complete"}),this.infoStack.insertSubviews([this.descriptionRowControl,this.stepsRowControl]),this.infoStack},_updateTodoRows:function(){var t,o,e=this,i=[],n=[],s=0,d=0,l=null;_.each(this.model.get("suggestions"),function(t){var o=ATOnboardSuggestions[t.id];o&&(t.complete||d++,i.push({id:t.id,text:o.title,faded:t.complete,leftDecoration:t.complete&&!e.editMode?"tick":"empty",decoration:e.editMode?"empty":"chevron",separateDecorators:!0,selectable:e.editMode,selected:e.editMode&&-1!==_.indexOf(e.selectedSuggestionIds,t.id)}))}),0===i.length?(l="none",t=""):t=this.editMode||d>0?"":"Clear list",_.each(this.model.get("todos"),function(t){t.complete&&s++,n.push({id:t.id,text:t.text,editable:!e.editMode&&!t.complete,selected:e.editMode?-1!==_.indexOf(e.selectedTodoIds,t.id):t.complete,selectable:!0,selectableStyle:e.editMode?"circle":"square",faded:t.complete,fadeSelected:!e.editMode,moveable:!0})}),n.push({id:"add_todo",placeholder:"Tap to add item",instruction:"Type text and hit enter",editable:!0,leftDecoration:"add",decoration:"empty",moveable:!1,separateDecorators:!0,disabled:this.editMode}),o=this.editMode||0===s?"":"Clear completed",this.suggestionRowControl.customize({footer:t}),this.suggestionRowControl.setRowList(i),this.suggestionRowControl.updateStyles({display:l}),this.todoRowControl.customize({footer:o}),this.todoRowControl.setRowList(n)},_suggestionRowClick:function(t,o,e){this.infoId=t.id,this._updateInfoPage(),this.pageCollection.moveForwardToPage("todoInfo",!0)},_suggestionRowSelect:function(t,o){this.editMode&&this.selectedSuggestionIds.push(t.id)},_suggestionRowDeselect:function(t,o){this.editMode&&_.pull(this.selectedSuggestionIds,[t.id])},_suggestionFooterClick:function(){var t=this.model.get("suggestions"),o=_.filter(t,function(t){return t.complete}),e=_.map(o,"id");window.ApplicationInterface&&e.length&&o.length===t.length&&window.ApplicationInterface.deleteSuggestions(window.timelineDocumentId,e.join(","))},_todoRowEdit:function(t,o,e){window.ApplicationInterface&&("add_todo"===t.id?o&&window.ApplicationInterface.addTodo(window.timelineDocumentId,o):o?window.ApplicationInterface.editTodo(window.timelineDocumentId,t.id,o):window.ApplicationInterface.deleteTodo(window.timelineDocumentId,t.id))},_todoRowSelect:function(t,o){this.editMode?this.selectedTodoIds.push(t.id):window.ApplicationInterface&&window.ApplicationInterface.markTodo(window.timelineDocumentId,t.id,!0)},_todoRowDeselect:function(t,o){this.editMode?_.pull(this.selectedTodoIds,[t.id]):window.ApplicationInterface&&window.ApplicationInterface.markTodo(window.timelineDocumentId,t.id,!1)},_todoRowMove:function(t,o,e,i,n){window.ApplicationInterface&&window.ApplicationInterface.moveTodo(window.timelineDocumentId,t.id,i)},_todoFooterClick:function(){var t=this.model.get("todos"),o=_.filter(t,function(t){return t.complete}),e=_.map(o,"id");window.ApplicationInterface&&e.length&&window.ApplicationInterface.deleteTodos(window.timelineDocumentId,e.join(","))},_updateInfoPage:function(){var t=ATOnboardSuggestions[this.infoId],o=[],e=[],i=1;o.push({id:"description",text:t.description}),window.mainApp.isIos?_.each(t.iosSteps,function(t){e.push({id:i,listOrdinal:i,text:t}),i++}):_.each(t.desktopSteps,function(t){e.push({id:i,listOrdinal:i,text:t}),i++}),this.descriptionRowControl.setRowList(o),this.descriptionRowControl.updateStyles({display:t.description?null:"none"}),this.stepsRowControl.setRowList(e)},_pageBack:function(t,o){},_pageForward:function(t,o){},_pageDone:function(){if(this.editMode)return this.editMode=!1,this.selectedSuggestionIds=[],this.selectedTodoIds=[],this._updateTodoRows(),void this._updateNavigation();this.hide()},_pageCancel:function(){this.editMode?(window.ApplicationInterface&&(this.selectedTodoIds.length&&window.ApplicationInterface.deleteTodos(window.timelineDocumentId,this.selectedTodoIds.join(",")),this.selectedSuggestionIds.length&&window.ApplicationInterface.deleteSuggestions(window.timelineDocumentId,this.selectedSuggestionIds.join(","))),this.selectedSuggestionIds=[],this.selectedTodoIds=[]):(this.editMode=!0,this._updateNavigation(),this._updateTodoRows())},_modalShown:function(){},_modalHidden:function(){var t=this;this.stopListening(this.modal),window.setTimeout(function(){t.pageCollection.moveFirst()},250)},_rowFocus:function(t,o,e){this.$editingRow=o,this.keyboardOpened&&this._scrollToEditingRowWithDuration(350)},keyboardOpenedWithHeightAndDuration:function(t,o){this.keyboardHeight=t,this.keyboardOpened=!0,this.modal.d3El.classed("keyboardShowing",!0),this.modal.d3El.selectAll(".iosControlStackKeyboardPadding").style("height",t+"px").transition(),this._scrollToEditingRowWithDuration(o),this.cursorUpdateStartTime=performance.now(),window.clearInterval(this.cursorUpdateInterval),this.cursorUpdateInterval=window.setInterval(this._updateCursorPosition.bind(this),25)},_updateCursorPosition:function(){var t=performance.now()-this.cursorUpdateStartTime;ATCursorBugFix.fixPosition(),t>700&&(window.clearInterval(this.cursorUpdateInterval),this.cursorUpdateInterval=null)},_scrollToEditingRowWithDuration:function(t){var o,e,i,n,s,d=this.modal.$el.height()-this.keyboardHeight,l=window.mainApp.isIphone?20:100;this.$editingRow&&(e=(o=this.$editingRow.closest(".iosControlStack")).parent(),i=o.offset().top,n=(this.$editingRow.offset()?this.$editingRow.offset().top-i:0)+this.$editingRow.outerHeight()+l,(s=Math.max(0,n-d))>e[0].scrollTop&&d3.select(e[0]).transition().duration(t).tween("keyboardScrollTreen",scrollTopTween(s)))},keyboardClosedWithDuration:function(t){this.modal.d3El.selectAll(".iosControlStackKeyboardPadding").transition().delay(t).style("height","0px"),this.modal.d3El.classed("keyboardShowing",!1),this.keyboardOpened=!1}});module.exports=ATNotificationManager;

},{"../../controller/ATOnboardSuggestions":18,"./ATControlStackView":181,"./ATCursorBugFix":182,"./ATModal":186,"./ATPageCollectionView":188,"./ATRowControl":190,"backbone":220,"d3":320,"lodash":333}],188:[function(require,module,exports){
const d3=require("d3"),_=require("lodash"),ATBaseView=require("./ATBaseView"),ATCursorBugFix=require("./ATCursorBugFix"),templateHtml=require("./templates/pageCollectionTemplate.html"),uuidV1=require("uuid/v1");var ATPageCollectionView=ATBaseView.extend({tagName:"div",className:"iosPageCollection",template:_.template(templateHtml),events:{"click .iosPageBack":"_backClick","click .iosPageDone":"_doneClick"},defaultSettings:function(){return{height:"35.0rem",width:"34.5rem",showDone:!1,doneText:"Done",showBack:!0,backText:null,showBackAsCancel:!1,cancelHasArrow:!1,backColorDestructive:!1,enableNavigation:!0}},serialize:function(){return{settings:this.settings,pages:this.pages,firstPageId:this.firstPageId}},initialize:function(){this.d3El=null,this.reset(),this.rendered=!1},reset:function(){this.settings=this.defaultSettings(),this.pages={},this.currentPage=null,this.historyPages=[]},setFirstPageId:function(t){this.firstPageId=t},getPreferredHeight:function(){return this.settings.height},setPages:function(t){var e=this;this.pages={},_.each(t,function(t){e.addPage(t)})},addPage:function(t){t.domId="x"+uuidV1(),this.pages[t.id]=t,t.control&&this.insertSubviews(t.control,"#"+t.domId)},updatePage:function(t){var e,i=_.find(this.pages,function(e){return e.id===t.id});i&&(_.extend(i,t),t.control&&(e="#"+i.domId,this.clearSubviews(e),this.insertSubviews(i.control,e),this.rendered&&this.renderSubviews(e)),i===this.currentPage&&this._updateNavigation())},afterRender:function(){return this.d3El=d3.select(this.el),this.d3PageTitleSpan=this.d3El.select(".iosPageTitle").select("span"),this.d3BackButton=this.d3El.select(".iosPageBack"),this.d3DoneButton=this.d3El.select(".iosPageDone"),this.rendered=!0,this.moveFirst(),this},afterCustomize:function(){this.currentPage&&this._updateNavigation()},moveFirst:function(){var t=this;this.rendered&&this._navigationEnabled()&&(this.currentPage=null,this.historyPages=[],_.each(this.pages,function(e){t._positionClass(e.domId,"future")}),this.moveForwardToPage(this.firstPageId,!1))},moveForwardToPage:function(t){var e=this.currentPage;this._navigationEnabled()&&(this.currentPage&&(this._positionClass(this.currentPage.domId,"history"),this.historyPages.push(this.currentPage)),this.currentPage=_.find(this.pages,function(e){return e.id===t}),this.currentPage&&this._positionClass(this.currentPage.domId,"current"),this._updateNavigation(),this.trigger("page:forward",e,this.currentPage))},moveBack:function(){var t=this.currentPage;this._navigationEnabled()&&(this.currentPage&&0!==this.historyPages.length?(this._positionClass(this.currentPage.domId,"future"),this.currentPage=this.historyPages.pop(),this.currentPage&&this._positionClass(this.currentPage.domId,"current"),this._updateNavigation(),this.trigger("page:back",t,this.currentPage)):this.currentPage.showBackAsCancel||_.isNil(this.currentPage.showBackAsCancel)&&this.settings.showBackAsCancel?this.trigger("page:cancel",this.currentPage):console.log("Error: moveBack called on first page without cancel enabled"))},commitChanges:function(){this.trigger("page:commit")},currentPageId:function(){return this.currentPage?this.currentPage.id:null},settingForPageId:function(t,e){var i=this.pages[t];return _.has(i,e)?i[e]:null},_updateNavigation:function(){var t=(_.isNil(this.currentPage.showBack)?this.settings.showBack:this.currentPage.showBack)&&(this.historyPages.length>0||this.currentPage.showBackAsCancel||_.isNil(this.currentPage.showBackAsCancel)&&this.settings.showBackAsCancel),e=this.historyPages.length>0||(_.isNil(this.currentPage.showBackAsCancel)?this.settings.cancelHasArrow:this.currentPage.cancelHasArrow),i=this.currentPage.backText?this.currentPage.backText:this.settings.backText?this.settings.backText:this.historyPages.length>0?_.last(this.historyPages).title:"Back",s=_.isNil(this.currentPage.backColorDestructive)?!!this.settings.backColorDestructive&&this.settings.backColorDestructive:this.currentPage.backColorDestructive,n=this._backEnabled(),a=_.isNil(this.currentPage.showDone)?this.settings.showDone:this.currentPage.showDone,r=this.currentPage.doneText?this.currentPage.doneText:this.settings.doneText,o=this._doneEnabled();return this.d3BackButton.classed("backAsCancel",!e).classed("disabled",!n).classed("destructive",s).style("display",t?null:"none").select("span").text(i),this.d3DoneButton.classed("disabled",!o).style("display",a?null:"none").text(r),this.d3PageTitleSpan.text(this.currentPage.title),this},_backClick:function(){this._backEnabled()&&this.moveBack(!0)},_doneClick:function(){this._doneEnabled()&&this.trigger("page:done",this.currentPage)},_positionClass:function(t,e){this.$("#"+t).removeClass("history").removeClass("future").removeClass("current").addClass(e),"current"===e&&(this.cursorUpdateStartTime=performance.now(),window.clearInterval(this.cursorUpdateInterval),this.cursorUpdateInterval=window.setInterval(this._updateCursorPosition.bind(this),25))},_updateCursorPosition:function(){var t=performance.now()-this.cursorUpdateStartTime;ATCursorBugFix.fixPosition(),t>600&&(window.clearInterval(this.cursorUpdateInterval),this.cursorUpdateInterval=null)},_doneEnabled:function(){return this.currentPage&&!_.isNil(this.currentPage.enableDone)?this.currentPage.enableDone:_.isNil(this.settings.enableDone)?this._navigationEnabled():this.settings.enableDone},_backEnabled:function(){return this.currentPage&&!_.isNil(this.currentPage.enableBack)?this.currentPage.enableBack:_.isNil(this.settings.enableBack)?this._navigationEnabled():this.settings.enableBack},_navigationEnabled:function(){return this.currentPage&&!_.isNil(this.currentPage.enableNavigation)?this.currentPage.enableNavigation:!!_.isNil(this.settings.enableNavigation)||this.settings.enableNavigation}});module.exports=ATPageCollectionView;

},{"./ATBaseView":180,"./ATCursorBugFix":182,"./templates/pageCollectionTemplate.html":195,"d3":320,"lodash":333,"uuid/v1":366}],189:[function(require,module,exports){
var $=require("jquery"),ATBaseView=require("./ATBaseView");const uuidV1=require("uuid/v1");var defaultPlacement=function(i,t){return function(){var e=i.offset(),o=i.width(),n=i.height(),s=e.left+o/2,r=e.top+n/2,p=$(window).width(),a=$(window).height(),h=t.split(" "),d=h[h.length-1],w=h.length>1?h[0]+" ":"";return"left"===d||"right"===d?r<a/3?w+d+"Top":r>2*a/3?w+d+"Bottom":w+d:"top"===d||"bottom"===d?s<p/3?w+d+"Left":s>2*p/3?w+d+"Right":w+d:w+d}},ATPopover=ATBaseView.extend({viewClassName:"ATPopover",defaultSettings:function(){return{container:"body",maxHeight:"35.0rem",width:"21.6rem",heading:null,placement:"right"}},initialize:function(){this.transitionDuration=350,this.uuid=uuidV1(),this.reset()},reset:function(){this.settings=this.defaultSettings()},setView:function(i){return this.view&&this.stopListening(this.view),this.view=i,this.listenTo(this.view,"view:resize",this.reposition.bind(this)),this.reposition(),this},getView:function(){return this.view},show:function(i){var t=this,e=performance.now(),o=this.view.getPreferredHeight();(this.$backdrop||this.$target)&&this.hide(),this.$target=i,i.popover({content:"",container:this.settings.container,html:!0,placement:defaultPlacement(i,this.settings.placement),trigger:"manual",template:'<div id="'+this.uuid+'" class="popover iosPopover popoverForm" role="tooltip" style="width:'+this.settings.width+";max-width:"+this.settings.width+(o?";height:"+o:"")+';"><div class="arrow"></div><div class="popover-content"></div></div>',animation:!1}),this.$backdrop=$('<div class="iosPopoverBackdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){performance.now()-e<200||t.hide()}),i.popover("show"),this.$popover=$(".popover"),$("#"+this.uuid+" .popover-content").append(this.view.$el),this.view.render(),this.trigger("popover:shown"),window.mainApp&&(window.mainApp.iosModalCount++,window.ApplicationInterface&&window.ApplicationInterface.modalOpened(window.timelineDocumentId))},hide:function(){this.view&&this.view.commitChanges(),this.$backdrop&&(this.$backdrop.off("click"),this.$backdrop.remove(),this.$backdrop=null),this.$target&&(this.$target.popover("destroy"),this.$target=null,this.trigger("popover:hidden")),window.mainApp&&(window.mainApp.iosModalCount--,window.ApplicationInterface&&window.mainApp.iosModalCount<=0&&(window.mainApp.iosModalCount=0,window.ApplicationInterface.lastModalClosed(window.timelineDocumentId)))},reposition:function(){this.$target&&this.$target.popover("reposition")}});module.exports=ATPopover;

},{"./ATBaseView":180,"jquery":331,"uuid/v1":366}],190:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),ATBaseView=require("./ATBaseView"),templateHtml=require("./templates/rowControlTemplate.html"),ATRowControl=ATBaseView.extend({tagName:"div",className:"iosRowControl",template:_.template(templateHtml),events:{"click .iosRowItem":"_rowClick","click .iosRowControlFooter":"_footerClick","click .iosRowItemLeftDecoration":"_rowSelect","click .iosRowItemDecorationWrapper":"_rowDecoratorClick","click .iosRowItemMoveBars":"_suppressMoveClick","click .iosRowItemDeleteImg":"_rowDelete","click .iosRowItemSegment":"_rowSegmentClick","input .iosRowItem":"_rowInput","keypress .iosRowItem":"_updateOnEnter","focus .iosRowItemData":"_rowFocused","blur .iosRowItem":"_commitEditor","change .iosRowItemSwitch":"_switchChange"},initialize:function(){this.d3El=null,this.$currentEditor=null,this.$currentRowDataDiv=null,this.currentEditingRow=null,this.highlightRowId=null,this.slipInst=null,this.reset()},serialize:function(){return{settings:this.settings,rows:this.rowList}},defaultSettings:function(){return{heading:null,placeholder:null,validate:null,allowDomUpdate:!0,highlightText:!1,wholeRowSelect:!1}},reset:function(){return this.settings=this.defaultSettings(),this.rowList=[],this.selectedRows=[],this.nextClickEditForRow=null,this},setRowList:function(t,e){var i,r,s=0,o=this.rowList&&this.rowsD3&&this.rowList.length===t.length;if(this.selectedRows=[],o)for(s=0;s<t.length;s++)i=t[s],r=this.rowList[s],(i.id!==r.id||i.numeric!==r.numeric||i.selectable!==r.selectable||i.moveable!==r.moveable||i.editable!==r.editable||i.imageRow!==r.imageRow||i.extraClasses!==r.extraClasses||i.deletable!==r.deletable||i.segmented!==r.segmented||i.decoration!==r.decoration||i.leftDecoration!==r.leftDecoration||i.title&&!r.title||r.title&&!i.title||i.subtext&&!r.subtext||r.subtext&&!i.subtext||i.colorDot&&!r.colorDot||r.colorDot&&!i.colorDot||i.icon&&!r.icon||r.icon&&!i.icon||i.listOrdinal&&!r.listOrdinal||r.listOrdinal&&!i.listOrdinal||i.clickableDecorator!==r.clickableDecorator)&&(o=!1);return this.rowList=e?JSON.parse(JSON.stringify(t)):t,this.selectedRows=_.filter(this.rowList,function(t){return t.selectable&&t.selected}),o&&this.settings.allowDomUpdate?this._updateExistingRows():this.render(),this},selectRow:function(t){t.selected=!t.selected,t.selected?(this.selectedRows.push(t),this.trigger("row:select",t,this)):(_.pull(this.selectedRows,t),this.trigger("row:deselect",t,this)),this._updateExistingRows()},getSelectedRows:function(){return this.selectedRows},setHighlightRow:function(t){return t&&t.id?this.highlightRowId=t.id:this.highlightRowId=null,this._updateHighlightRows(),this},isCurrentInputValid:function(){return!this.editingValid||this.editingValid.valid},startEditingRow:function(t){var e,i,r;this.rowsD3&&(i=(e=this.rowsD3.filter(function(e){return e.id===t.id}))&&e[0]?$(e[0][0]):null,r=d3.select(i[0]).datum(),i[0]&&this._setupEditor(r,i))},beforeRender:function(){this._destroySlipInst()},afterRender:function(){var t=_.filter(this.rowList,function(t){return t.moveable});return this.d3El=d3.select(this.el),this.$(".iosRowControlForm").mobiscroll().form({theme:window.currentMobiscrollTheme()}),this.mbForm=this.$(".iosRowControlForm").mobiscroll("getInst"),this.rowsD3=this.d3El.selectAll(".iosRowItem").data(this.rowList),this.d3Placeholder=this.d3El.select(".iosRowPlaceholder").style("display",this.rowList.length||!this.settings.placeholder?"none":null),this.rowsD3.select(".iosRowItemDeleteWrapper").style("display",function(t){return t.text?null:"none"}),this.d3Footer=this.d3El.select(".iosRowControlFooter"),this._updateHighlightRows(),t.length>1&&this._createSlipInst(),this},_createSlipInst:function(){this.slipContainerDomEl=this.$(".iosRowControlItems")[0],this.slipInst=new window.Slip(this.slipContainerDomEl,{moveableClass:"moveable"}),this.slipReorderListener=this._onDragEnd.bind(this),this.slipBeforeSwipeListener=function(t){t.preventDefault()},this.slipBeforeWaitListener=function(t){t.preventDefault()},this.slipBeforeReorderListener=function(t){var e,i=$(t.srcElement).closest(".iosRowItemMoveBars");0!==i.length&&0!==(e=i.closest(".iosRowItem")).length?d3.select(e[0]).datum().moveable||t.preventDefault():t.preventDefault()},this.slipContainerDomEl.addEventListener("slip:beforeswipe",this.slipBeforeSwipeListener),this.slipContainerDomEl.addEventListener("slip:beforereorder",this.slipBeforeReorderListener),this.slipContainerDomEl.addEventListener("slip:beforewait",this.slipBeforeWaitListener),this.slipContainerDomEl.addEventListener("slip:reorder",this.slipReorderListener)},_destroySlipInst:function(){this.slipInst&&(this.slipContainerDomEl.removeEventListener("slip:beforeswipe",this.slipBeforeSwipeListener,!1),this.slipContainerDomEl.removeEventListener("slip:beforereorder",this.slipBeforeReorderListener,!1),this.slipContainerDomEl.removeEventListener("slip:beforewait",this.slipBeforeWaitListener,!1),this.slipContainerDomEl.removeEventListener("slip:reorder",this.slipReorderListener,!1),this.slipInst.detach(),this.slipInst=null,this.slipContainerDomEl=null,this.slipBeforeSwipeListener=null,this.slipBeforeReorderListener=null,this.slipBeforeWaitListener=null,this.slipReorderListener=null)},_onDragEnd:function(t){var e=t.detail.originalIndex,i=t.detail.spliceIndex,r=this.rowList[e],s=this.rowList[i];e!==i&&s.moveable&&(t.target.parentNode.insertBefore(t.target,t.detail.insertBefore),this.trigger("row:move",r,s,e,i,this))},_updateExistingRows:function(){var t=this,e=this.settings.highlightText?"highlightText":"highlight",i=_.filter(this.rowList,function(t){return t.moveable});this._destroySlipInst(),this.rowsD3=this.d3El.selectAll(".iosRowItem").data(this.rowList),this.rowsD3.each(function(i){var r,s,o,l,n=d3.select(this),a="iosRowItem";i.disabled&&(a+=" disabled"),i.id===t.highlightRowId&&(a+=" "+e),i.color&&(a+=" borderColor "+i.color),i.extraClasses&&(a+=" "+i.extraClasses),(i.leftDecoration||i.selectable)&&(a+=" leftDecorated"),i.selectable&&(a+=" selectable"),i.faded&&(a+=" faded"),i.selectable&&i.selected&&i.fadeSelected&&(a+=" fadeSelected"),i.moveable&&(a+=" moveable"),i.separateDecorators&&(a+=" separateDecorators"),i.clickableDecorator&&(a+=" clickableDecorator"),n.attr("class",a),n.select(".iosRowItemTitle").text(i.title),i.editable&&i.numeric?n.select(".iosRowItemEditor").property("value",i.text?i.text:"").attr("placeholder",i.placeholder?i.placeholder:"").attr("disabled",i.disabled?"true":null):i.editable?n.select(".iosRowItemData").text(i.text?i.text:"").attr("disabled",i.disabled?"true":null):n.select(".iosRowItemData").html(i.text?i.text:i.placeholder?i.placeholder:""),i.imageRow&&n.select(".iosRowItemImageWell").classed("hasImage",Boolean(i.image)).select(".iosRowItemImage").attr("src",i.image),i.selectable&&(l=("square"===i.selectableStyle?"#squareCheckbox":"#checkbox")+(i.selected?"Tick":""),n.select(".iosRowItemLeftDecoration svg").select("use").attr("xlink:href",l)),i.listOrdinal&&n.select(".iosRowItemLeftDecoration span").text(i.listOrdinal),i.leftDecoration&&n.select(".iosRowItemLeftDecoration svg").attr("class",i.iconColor),n.select(".iosRowItemSubtext").text(i.subtext),n.select(".iosRowItemError").text(""),n.select(".iosRowItemColorDot").attr("class","iosRowItemColorDot "+(i.colorDot?i.colorDot:"")),n.select(".iosRowItemIcon").attr("class","iosRowItemIcon icon "+(i.iconColor?i.iconColor:"")).select("use").attr("xlink:href",i.icon?i.icon:null),n.select(".iosRowItemDeleteWrapper").style("display",i.text?null:"none"),(s=(r=n.select(".iosRowItemSwitch"))?$(r[0]):null)[0]&&s.prop("checked",i.switchVal).prop("disabled",i.disabled).mobiscroll("refresh"),(o=n.select(".iosRowItemSegmentDiv").selectAll(".iosRowItemSegment").data(i.segments)).enter().append("span").classed("iosRowItemSegment",!0),o.classed("selected",function(t){return t.selected}).text(function(t){return t.text}),o.exit().remove()}),this.d3Placeholder.text(this.settings.placeholder).style("display",this.rowList.length||!this.settings.placeholder?"none":null),this.d3Footer.text(this.settings.footer),i.length>1&&this._createSlipInst()},_updateHighlightRows:function(){var t=this,e=this.settings.highlightText?"highlightText":"highlight";this.rowsD3&&(this.rowsD3.classed(e,function(e){return e.id===t.highlightRowId}),this.rowsD3.each(function(e){d3.select(this).select(".iosRowItemData").attr("contenteditable",e.id===t.highlightRowId&&e.editableOnHighlight||e.editable&&!e.numeric?"plaintext-only":null)}))},_rowClick:function(t){var e=d3.select(t.currentTarget).datum(),i=$(t.currentTarget);e.disabled||this.isCurrentInputValid()&&(e.editable&&_.isEqual(this.currentEditingRow,e)||(this.$currentEditor&&this.clearEditor(!0),e.editable||e.editableOnHighlight&&this.highlightRowId===e.id?this._setupEditor(e,i):e.selectable&&this.settings.wholeRowSelect?this.selectRow(e):this.trigger("row:click",e,i,this)))},_rowFocused:function(t){var e=$(t.currentTarget).closest(".iosRowItem"),i=d3.select(e[0]).datum();_.isEqual(this.currentEditingRow,i)||this.isCurrentInputValid()&&(this.$currentEditor&&this.clearEditor(!0),(i.editable||i.editableOnHighlight&&this.highlightRowId===i.id)&&this._setupEditor(i,e))},_resetValidation:function(){this.editingValid={valid:!0}},_validateInput:function(t,e,i){this._resetValidation(),this.settings.validate&&(this.editingValid=this.settings.validate(t,e)),i?this.$currentRowErrorDiv.text(null):this.editingValid.valid?this.$currentRowErrorDiv.text(null):this.$currentRowErrorDiv.text(this.editingValid.errorMsg)},_switchChange:function(t){var e=$(t.target),i=e.attr("name"),r=e.is(":checked"),s=_.find(this.rowList,function(t){return t.id===i});$(":focus").blur(),this.trigger("row:edit",s,!!r,this)},_rowDelete:function(t){var e=$(t.currentTarget).parent().parent(),i=d3.select(e[0]).datum();i&&!i.disabled&&(_.isEqual(this.currentEditingRow,i)||this.isCurrentInputValid())&&(this.$currentEditor&&this.clearEditor(!0),this.trigger("row:delete",i,e,this),t.stopPropagation(),t.preventDefault())},_suppressMoveClick:function(t){t.stopPropagation(),t.preventDefault()},_rowSelect:function(t){var e=$(t.currentTarget).parent(),i=d3.select(e[0]).datum();i.disabled||i.selectable&&(_.isEqual(this.currentEditingRow,i)||this.isCurrentInputValid())&&(this.$currentEditor&&this.clearEditor(!0),this.selectRow(i),t.stopPropagation(),t.preventDefault())},_rowDecoratorClick:function(t){var e=$(t.currentTarget).parent(),i=d3.select(e[0]).datum();i.disabled||i.clickableDecorator&&(_.isEqual(this.currentEditingRow,i)||this.isCurrentInputValid())&&(this.$currentEditor&&this.clearEditor(!0),this.trigger("row:iconClick",i,e,this),t.stopPropagation(),t.preventDefault())},_rowSegmentClick:function(t){var e=$(t.currentTarget),i=e.parent().parent().parent(),r=d3.select(i[0]).datum(),s=e.text();r.disabled||(_.isEqual(this.currentEditingRow,r)||this.isCurrentInputValid())&&(this.$currentEditor&&this.clearEditor(!0),this.trigger("row:edit",r,s,this),t.stopPropagation(),t.preventDefault())},_rowInput:function(t){var e,i;this.$currentEditor&&((i=(e=this.currentEditingRow).numeric?this.$currentEditor.val():this.$currentEditor.text())||e.numeric||this.$currentEditor.empty(),this._validateInput(e,i,!1),this.trigger("row:input",e,i,this,this.editingValid.valid))},_setupEditor:function(t,e){var i=t.text===t.replaceable?"":t.text;i||(i=""),t.disabled||!t.editable&&!t.editableOnHighlight||t.switch||t.segmented||(this.trigger("row:focus",t,e,this),this.currentEditingRow=t,this.$currentRowDiv=e,this.$currentRowErrorDiv=e.find(".iosRowItemError"),t.numeric?(this.$currentEditor=e.find(".iosRowItemEditor"),this.$currentEditor.val(i),this.$currentEditor.get(0).setSelectionRange(i.length,i.length)):(this.$currentEditor=e.find(".iosRowItemData"),this.$currentEditor.text(i),this.$currentEditor.prop("data-placeholder",t.placeholder),t.leaveCursorAtTapLocation||this._moveCursorToEndOfEditor()),this._validateInput(t,i,!0))},clearEditor:function(t){this.$currentEditor&&(this.currentEditingRow.numeric||this.$currentEditor.html(this.$currentEditor[0].innerText),this.setHighlightRow(null),this.currentEditingRow=null,this.$currentEditor=null,this.$currentRowDataDiv=null,this.$currentRowDiv=null,this.$currentRowErrorDiv.text(null),this.$currentRowErrorDiv=null,this._resetValidation(),t&&document.activeElement.blur())},_commitEditor:function(t){var e,i=this.currentEditingRow;this.$currentEditor&&this.currentEditingRow&&(this.isCurrentInputValid()?(e=i.numeric?this.$currentEditor.val():this.$currentEditor[0].innerText,this.clearEditor(!0),this.trigger("row:edit",i,e,this)):(this.$currentRowErrorDiv.text(null),this.currentEditingRow.numeric?this.$currentEditor.val(i.text):this.$currentEditor.html(i.text),this.clearEditor(!0),this.trigger("row:edit",i,i.text,this)))},_updateOnEnter:function(t){if(this.$currentEditor){if(13===t.keyCode&&!this.currentEditingRow.multiline)return this._commitEditor(),!1;if(this.currentEditingRow.numeric&&(t.keyCode<48||t.keyCode>57))return 46===t.keyCode&&!this.currentEditingRow.integerOnly&&-1===this.$currentEditor.val().indexOf(".")}return!0},_moveCursorToEndOfEditor:function(){var t,e;document.createRange&&((t=document.createRange()).selectNodeContents(this.$currentEditor[0]),t.collapse(!1),(e=window.getSelection()).removeAllRanges(),e.addRange(t))},_footerClick:function(){this.trigger("footer:click")}});module.exports=ATRowControl;

},{"./ATBaseView":180,"./templates/rowControlTemplate.html":196,"d3":320,"jquery":331,"lodash":333}],191:[function(require,module,exports){
module.exports={WIDE_SCREEN_MODE:0,MEDIUM_SCREEN_MODE:1,IPHONE_LANDSCAPE_SCREEN_MODE:2,NARROW_SCREEN_MODE:3,remWidthToScreenMode:function(E){return E<50?this.NARROW_SCREEN_MODE:window.mainApp&&window.mainApp.isIphone?this.IPHONE_LANDSCAPE_SCREEN_MODE:E<80?this.MEDIUM_SCREEN_MODE:this.WIDE_SCREEN_MODE},stringForScreenMode:function(E){return E===this.WIDE_SCREEN_MODE?"wideScreenMode":E===this.MEDIUM_SCREEN_MODE?"mediumScreenMode":E===this.IPHONE_LANDSCAPE_SCREEN_MODE?"iPhoneLandscapeScreenMode":E===this.NARROW_SCREEN_MODE?"narrowScreenMode":"mediumScreenMode"},fullScreenEverything:function(E){return E===this.IPHONE_LANDSCAPE_SCREEN_MODE||E===this.NARROW_SCREEN_MODE},stringsForAllScreenModes:function(){return["wideScreenMode","mediumScreenMode","iPhoneLandscapeScreenMode","narrowScreenMode"]}};

},{}],192:[function(require,module,exports){
module.exports='<div class="iosControlStackHeader"></div>\n<div class="iosControlStackControls"></div>\n<div class="iosControlStackFooter"></div>\n<div class="iosControlStackKeyboardPadding"></div>';

},{}],193:[function(require,module,exports){
module.exports='<% if(settings.heading) { %>\n\t<div class="iosListControlHeading">\n\t\t<%= settings.heading %>\n\t</div>\n<% } %>\n<% if(settings.showSearch) { %>\n\t<div class="iosListControlSearchWrapper"><input class="iosListControlSearch" placeholder="Filter" /><svg class="iosListControlSearchIcon"><use xlink:href="#smallSearch"></use></svg>\t\t\t\t<svg class="iosListControlSearchClear"><use xlink:href="#clear"></use></svg></div>\n<% } %>\n<div class="iosListControlWrapper">\n\t<div class="iosListControlItems" style="height: <%= (items.length * settings.itemHeight) %>px;">\n\t\t<% _.each(items, function(item) { %>\n\t\t\t<div class="iosListItem<%= item.selected ? \' selected\' : \'\' %>">\n\t\t\t\t<% if(settings.decoration === \'color\') { %>\n\t\t\t\t\t<span class="iosDecoration <%= item.color %>" />\n\t\t\t\t<% } %>\n\t\t\t\t<span class="iosListItemText"><%= item.text %></span>\n\t\t\t\t<svg class="iosListItemSelectedTick"><use xlink:href="#tick"></use></svg>\n\t\t\t</div>\n\t\t<%\t}); %>\n\t</div>\n</div>\n<% if(settings.placeholder) { %>\n\t<div class="iosListPlaceholder">\n\t\t<%= settings.placeholder %>\n\t</div>\n<%\t} %>';

},{}],194:[function(require,module,exports){
module.exports="<div class=\"atModal <%= settings.extraClasses ? settings.extraClasses : ''%>\"></div>";

},{}],195:[function(require,module,exports){
module.exports='<div class="iosPageHeading">\n\t<div class="iosPageBack <%= settings.backColorDestructive ? \'destructive\' : \'\'%>"><svg><use xlink:href="#backArrow"></use></svg><span><%= settings.backText ? settings.backText : \'Back\' %></span></div>\n\t<div class="iosPageTitle"><span></span></div>\n\t<div class="iosPageDone">Done</div>\n</div>\n<div class="iosPageSpace">\n\t<% _.each(pages, function(page) { %>\n\t\t<div id="<%= page.domId %>" class="iosPageHolder <%= page.id === firstPageId ? \'current\' : \'future\'%>"></div>\n\t<% }); %>\n</div>';

},{}],196:[function(require,module,exports){
module.exports='<% if(settings.heading) { %>\n<div class="iosRowControlHeading"><%= settings.heading %></div>\n<% } %>\n<form class="iosRowControlForm">\n<div class="iosRowControlItems">\n\t<% _.each(rows, function(row) { %>\n\t\t<div class="iosRowItem <%= row.extraClasses ? row.extraClasses : \'\' %> <%= row.leftDecoration || row.selectable ? \'leftDecorated\' : \'\' %> <%= row.selectable ? \'selectable\' : \'\' %> <%= row.clickableDecorator ? \'clickableDecorator\' : \'\' %> <%= row.separateDecorators ? \'separateDecorators\' : \'\' %> <%= row.moveable ? \'moveable\' : \'\' %> <%= row.switch ? \'switch\' : \'\' %> <%= row.disabled ? \'disabled\' : \'\' %> <%= row.faded ? \'faded\' : \'\' %> <%= (row.selectable && row.selected && row.fadeSelected) ? \'fadeSelected\' : \'\' %> <%= row.color ? \'borderColor \' + row.color : \'\'%>">\n\t\t\t<% if(!row.selectable && row.moveable) { %>\n\t\t\t\t<div class="iosRowItemMoveBars">\n\t\t\t\t\t<svg><use xlink:href="#move"></use></svg>\n\t\t\t\t</div>\n\t\t\t<% } %>\n\t\t\t<% if(row.leftDecoration || row.selectable || row.listOrdinal) { %>\n\t\t\t\t<div class="iosRowItemLeftDecoration">\n\t\t\t\t\t<% if(row.selectable) { \n\t\t\t\t\t\t var shape = (row.selectableStyle === \'square\' ? \'squareCheckbox\' : \'checkbox\') + (row.selected ? \'Tick\' : \'\');\t\n\t\t\t\t\t%>\n\t\t\t\t\t\t<svg><use xlink:href="#<%= shape %>"></use></svg>\n\t\t\t\t\t<% } else if(row.listOrdinal) { %>\n\t\t\t\t\t\t<span class="iosRowItemOrdinal"><%= row.listOrdinal %></span>\n\t\t\t\t\t<% } else if(row.leftDecoration) { %>\n\t\t\t\t\t\t<svg class="<%= row.iconColor%>"><use xlink:href="#<%= row.leftDecoration %>"></use></svg>\n\t\t\t\t\t<% } %>\n\t\t\t\t</div>\n\t\t\t<% } %>\t\t\t\t\n\t\t\t<div class="iosRowItemContent">\n\t\t\t\t<% if(row.title) { %>\n\t\t\t\t\t<div class="iosRowItemTitle"><%= row.title %></div>\n\t\t\t\t<% } %>\n\t\t\t\t<% if(row.editable && row.numeric) {%>\n\t\t\t\t\t<input type="number" class="iosRowItemEditor" <%= row.disabled ? \'disabled="true"\' : \'\' %> value="<%= row.text ? row.text : \'\' %>" data-enhance="false"  placeholder="<%= row.placeholder ? row.placeholder : \'\' %>" />\n\t\t\t\t<% } else if(row.segmented) { %>\n\t\t\t\t\t<div class="iosRowItemSegmentDiv"><% _.each(row.segments, function(seg) { %><span class="iosRowItemSegment <%= seg.selected ? \'selected\' : \'\'%>"><%= seg.text %></span><% }); %></div>\t\t\t\n\t\t\t\t<% } else if(row.editable) { %>\n\t\t\t\t\t<div class="iosRowItemData <%= row.multiline ? \' multiline\' : \'\' %>" contenteditable="plaintext-only" <%= row.disabled ? \'disabled="true"\' : \'\' %> data-placeholder="<%= row.placeholder ? row.placeholder : \'\' %>" data-instruction="<%= row.instruction ? row.instruction : \'\' %>"><%= row.text ? row.text : \'\' %></div>\t\t\t\n\t\t\t\t<% } else {%>\n\t\t\t\t\t<div class="iosRowItemData <%= row.multiline ? \' multiline\' : \'\' %>"><%= row.text ? row.text : (row.placeholder ? row.placeholder : \'\') %></div>\t\t\t\n\t\t\t\t<% } %>\n\t\t\t\t<% if(row.subtext) { %>\n\t\t\t\t\t<div class="iosRowItemSubtext"><%= row.subtext %></div>\n\t\t\t\t<% } %>\n\t\t\t\t<% if(row.editable || row.numeric) { %>\n\t\t\t\t\t<div class="iosRowItemError"></div>\n\t\t\t\t<% } %>\n\t\t\t\t<% if(row.imageRow) { %>\n\t\t\t\t\t<div class="iosRowItemImageWell">\n\t\t\t\t\t\t<img class="iosRowItemImage" src="<%= row.image %>" />\n\t\t\t\t\t\t<div class="iosRowItemImagePlaceholder">\n\t\t\t\t\t\t\t<svg class="iosRowItemImagePlaceholder"><use xlink:href="#picture"></use></svg>\t\t\t\t\t\n\t\t\t\t\t\t\t<span>No image</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t<% } %>\t\n\t\t\t</div>\n\t\t\t<% if(row.colorDot) { %>\n\t\t\t\t<div class="iosRowItemColorDotWrapper">\n\t\t\t\t\t<div class="iosRowItemColorDot <%= row.colorDot %>"></div>\n\t\t\t\t</div>\n\t\t\t<% } %>\n\t\t\t<% if(row.switch) { %>\n\t\t\t\t<div class="iosRowItemSwitchWrapper"><div class="iosRowItemSwitchDiv"><input data-role="switch" type="checkbox" name="<%= row.id %>" class="iosRowItemSwitch" <%= row.switchVal ? \'checked\' : \'\' %> <%= row.disabled ? \' disabled\' : \'\' %> /></div></div>\n\t\t\t<% } %>\t\t\t\n\t\t\t<% if(row.deletable) { %>\n\t\t\t\t<div class="iosRowItemDeleteWrapper">\n\t\t\t\t\t<svg class="iosRowItemDeleteImg"><use xlink:href="#clear"></use></svg>\n\t\t\t\t</div>\n\t\t\t<% } %>\t\t\t\n\t\t\t<% if(row.icon) { %>\n\t\t\t\t<div class="iosRowItemIconWrapper">\n\t\t\t\t\t<svg class="iosRowItemIcon icon <%= row.iconColor%>"><use xlink:href="<%= row.icon %>"></use></svg>\n\t\t\t\t</div>\n\t\t\t<% } %>\t\t\t\n\t\t\t<% if(row.clickableDecorator) { %>\n\t\t\t\t<div class="iosRowItemDecorationWrapper">\n\t\t\t\t\t<svg class="iosRowItemDecoration clickable"><use xlink:href="#<%= row.decoration %>"></use></svg>\n\t\t\t\t\t<svg class="iosRowItemDecoration"><use xlink:href="#chevron"></use></svg>\n\t\t\t\t</div>\n\t\t\t<% } else if(row.decoration) { %>\n\t\t\t\t<div class="iosRowItemDecorationWrapper">\n\t\t\t\t\t<svg class="iosRowItemDecoration"><use xlink:href="#<%= row.decoration %>"></use></svg>\n\t\t\t\t</div>\n\t\t\t<% } %>\n\t\t\t<% if(row.selectable && row.moveable) { %>\n\t\t\t\t<div class="iosRowItemMoveBars">\n\t\t\t\t\t<svg><use xlink:href="#move"></use></svg>\n\t\t\t\t</div>\n\t\t\t<% } %>\t\t\t\n\t\t</div>\n\t<%\t}); %> \t\n\t<% if(!rows || rows.length == 0) { %>\n\t<div class="iosRowPlaceholder"><%= settings.placeholder %></div>\n\t<% } %>\n</div>\n</form>\n<% if(settings.heading) { %>\n\t<div class="iosRowControlFooter"><%= settings.footer %></div>\n<% } %>';

},{}],197:[function(require,module,exports){
var $=require("jquery"),_=require("lodash"),Backbone=require("backbone"),ATSize=require("../../utils/ATSize"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),ATEventTextCalculator=Backbone.View.extend({initialize:function(){this.clearList()},clearList:function(){this.eventsAwaitingCalc={}},addEvent:function(e){this.eventsAwaitingCalc[e.fastId]={event:e}},calculateSizes:function(){window.mainApp.isIos?this.calculateSizesIos():this.calculateSizesDesktop()},calculateSizesIos:function(){var e,t,i,n,a;0!==Object.keys(this.eventsAwaitingCalc).length&&(e=$("<div />").addClass("iosMeasureDiv"),n=$("<div />").addClass("timelineMeasure"),t=$("<div />").addClass("narrowMeasure"),i=$("<div />").addClass("wideMeasure"),a=TimelineDisplayConstants.eventTextWrapSafetyBuffer*window.mainApp.timelineView.physicalScaleFactor,e.append(t),e.append(i),e.append(n),_.each(this.eventsAwaitingCalc,function(e,a){var s=Boolean(e.event.get("parent")),l=e.event.get("displayId").split(".").length-1,d=e.event.get("displayTitle"),o=e.event.get("dateString"),c=d.length>=o.length?d:o;Math.abs(d.length-o.length)<5?(e.$t=$("<div />").text(d),e.$t2=$("<div />").text(o),n.append(e.$t),n.append(e.$t2)):(e.$t=$("<div />").text(c),n.append(e.$t)),e.$n=e.$t.clone(),s&&e.$n.addClass("isParent"),l>0&&e.$n.addClass("indent"+l),e.$w=e.$n.clone(),t.append(e.$n),i.append(e.$w)}),e.appendTo($("body")),_.each(this.eventsAwaitingCalc,function(e,t){const i=e.$t2?Math.max(e.$t[0].offsetWidth,e.$t2[0].offsetWidth):e.$t[0].offsetWidth;e.ts=new ATSize(i+a,e.$t[0].offsetHeight),e.ns=new ATSize(e.$n[0].offsetWidth,e.$n[0].offsetHeight),e.ws=new ATSize(e.$w[0].offsetWidth,e.$w[0].offsetHeight)}),e.remove(),_.each(this.eventsAwaitingCalc,function(e,t){window.mainApp.timelineView.showEventDate&&(e.ts.width+=.001),e.event.set({narrowRelTextSize:e.ns,wideRelTextSize:e.ws},{silent:!0}),e.event.set("textSize",e.ts)}),this.clearList())},calculateSizesDesktop:function(){var e,t,i,n=window.mainApp.timelineView.physicalScaleFactor;0!==Object.keys(this.eventsAwaitingCalc).length&&(e=$("<div />").addClass("desktopMeasureDiv"),t=$("<div />").addClass("timelineMeasure"),i=TimelineDisplayConstants.eventTextWrapSafetyBuffer*n,e.append(t),_.each(this.eventsAwaitingCalc,function(e,i){var n=e.event.get("displayTitle"),a=e.event.get("dateString"),s=n.length>=a.length?n:a;Math.abs(n.length-a.length)<5?(e.$t=$("<div />").text(n),e.$t2=$("<div />").text(a),t.append(e.$t),t.append(e.$t2)):(e.$t=$("<div />").text(s),t.append(e.$t))}),e.appendTo($("body")),_.each(this.eventsAwaitingCalc,function(e,t){const n=e.$t2?Math.max(e.$t[0].offsetWidth,e.$t2[0].offsetWidth):e.$t[0].offsetWidth;e.ts=new ATSize(n+i,e.$t[0].offsetHeight)}),e.remove(),_.each(this.eventsAwaitingCalc,function(e,t){e.event.set("textSize",e.ts)}),this.clearList())}});module.exports=ATEventTextCalculator;

},{"../../controller/ATDisplayConstants":16,"../../utils/ATSize":49,"backbone":220,"jquery":331,"lodash":333}],198:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATIconContextMenu=require("../desktop/ATIconContextMenu"),Opentip=require("../../../lib/opentip"),Hammer=require("hammerjs"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),ATRelationshipViewTablePainter=require("./ATRelationshipViewTablePainter"),ATRelationshipViewPainter=require("./ATRelationshipViewPainter"),ATListControl=require("../ios/ATListControl"),ATPopover=require("../ios/ATPopover"),ATTimeUnit=require("../../model/ATTimeUnit"),ATPoint=require("../../utils/ATPoint"),ATRect=require("../../utils/ATRect"),ATBounds=require("../../utils/ATBounds"),ATSize=require("../../utils/ATSize"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),ATScreenMode=require("../ios/ATScreenMode"),selectColumnHtml=require("../desktop/templates/relationshipViewSelectColumnsTemplate.html"),ATRelationshipView=Backbone.View.extend({initialize:function(){var e=this.$el.attr("id");this.listControl=new ATListControl,this.listPopover=new ATPopover,this.listPopover.setView(this.listControl),this.selectColumnTemplate=_.template(selectColumnHtml),this.columnGroupName=null,this.usePruneDataFunction=null,this.eventRowsByGroup=[],this.entityColumnsByType=[],this.showOffsets=!0,this.timeline=this.model.get("timeline"),this.timelineView=null,this.d3El=d3.select("#"+e),this.firstRender=!0,this.viewport=new ATRect(0,0,0,0),this.rangeX=new ATBounds(0,0),this.rangeY=new ATBounds(-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,350),this.physicalScaleFactor=1,this.filterBarDiv=d3.select("#filterBarDiv"),this.bookmarksDiv=d3.select("#bookmarks"),this.layers={},this.layers.entity_header=this.d3El.select("#relationship_entity_header"),this.layers.bg_layer=this.d3El.select("#relationship_bg_layer"),this.layers.intersection_layer=this.d3El.select("#relationship_intersection_layer"),this.layers.offset_layer=this.d3El.select("#relationship_offset_layer"),this.layers.event_layer=this.d3El.select("#relationship_event_layer"),this.layers.lane_layer=this.d3El.select("#relationship_lane_layer"),this.layers.lane_nav_svg=this.d3El.select(".laneNavSvg"),this.layers.x_scroll_svg=this.d3El.select(".xScrollSvg"),this.layers.ui_drawing_svg=this.d3El.select("#relationship_ui_drawing_svg"),this.roleContextMenu=new ATIconContextMenu({el:"#relationshipViewRoleContextMenu"}),this.listenTo(this.roleContextMenu,"change",this.contextRoleClick.bind(this))},configureInteraction:function(e){this.platform=e,"ios"===e?(this._configureMobileInteraction(),this.relationshipPainter=new ATRelationshipViewTablePainter(this),this.usePruneDataFunction=this.tableData.bind(this)):(this._configureDesktopInteraction(),this.relationshipPainter=new ATRelationshipViewPainter(this),this.usePruneDataFunction=this.pruneData.bind(this))},editModeToggled:function(e){},_configureMobileInteraction:function(){var e=this,t=this.$el[0],i=new Hammer.Manager(t),n=new Hammer.Press({time:500}),o=new Hammer.Tap,s=function(e){var t=$(e.target),i=t.closest(".relationshipTableEventRow"),n=t.closest(".relationshipTableEventIntersection"),o=i.length>0?d3.select(i[0]):null,s=o?o.datum():null,r=n.length?d3.select(n[0]):null,a=r?r.datum():null;return{eventId:s?s.id:null,entityId:a?a.entityId:null}};i.add([n,o]),i.on("tap",function(t){var i=s(t);$(t.target).hasClass("relationshipTableParentArrow")||(i.entityId&&i.eventId?(e.relationshipIntersectionClick(i.eventId,i.entityId,$(t.target)),t.srcEvent.stopPropagation(),t.srcEvent.preventDefault()):i.eventId?e.timeline.toggleEventSelectionWithID(i.eventId):e.editModeEnabled||e.timeline.clearSelection())}),i.on("press",function(t){var i;window.mainApp.canvasManager.editModeActivated?window.mainApp.canvasManager.showEditControl(t):(window.mainApp.canvasManager.showEditBar(!0),(i=s(t)).eventId?e.timeline.toggleEventSelectionWithID(i.eventId):e.editModeEnabled||e.timeline.clearSelection())})},_configureDesktopInteraction:function(){var e=this,t=this.$el[0],i=new Hammer.Manager(t),n=new Hammer.Pan,o=new Hammer.Tap({time:49});this.el.addEventListener("wheel",this.mouseWheel.bind(this),!1),this.d3El.on("click",this.canvasClick.bind(this)),window.isAeonWebExport?$("#relationshipSettingsButton").css("display","none"):$("#relationshipSettingsButton").on("click",this.relationshipSettingsClick.bind(this)),$("#relationshipTreeNestingButton").on("click",this.relationshipTreeNestingClick.bind(this)),$("#relationshipFlattenNestingButton").on("click",this.relationshipFlattenClick.bind(this)),$("#relationshipOffsetButton").on("click",this.relationshipShowOffsetsClick.bind(this)),i.add([n,o]),i.on("tap",function(t){var i,n,o;Boolean(t.touches)&&(e.stopFlickScroll(),i=e.rawMousePositionToScaledCanvasPosition(new ATPoint(t.center.x,t.center.y)),n=e.relativeToAbsolutePoint(i),(o=e.model.eventNodeForAbsolutePosition(n,!0))?e.timeline.selectEventWithID(o.id):e.timeline.clearSelection())}),i.on("panstart",function(t){e.stopFlickScroll(),e.flingDeltas=[]}),i.on("panmove",function(t){e.stopFlickScroll(),"mouse"!==t.pointerType&&(e.disablePan||e.grabScrolled(t.deltaX,t.deltaY),e.flingDeltas.push({time:t.deltaTime,x:t.deltaX,y:t.deltaY}),e.flingDeltas.length>5&&e.flingDeltas.shift())}),i.on("panend",function(t){var i,n,o,s,r,a,l,h=e.flingDeltas.pop(),d=e.flingDeltas[0],c=e.flingDeltas.pop(),g=e.flingDeltas.pop();if("mouse"!==t.pointerType&&(e.grabScrollEnded(),e.flingDeltas&&!(e.flingDeltas.length<2))){for(;h.time-c.time<15&&g;)c=g,g=e.flingDeltas.pop();i=Math.abs(h.x-c.x)/(h.time-c.time),n=Math.abs(h.y-c.y)/(h.time-c.time),o=Math.abs(h.x-d.x)/(h.time-d.time),s=Math.abs(h.y-d.y)/(h.time-d.time),r=800*Math.min(i,o)*(h.x>c.x?1:-1),a=800*Math.min(n,s)*(h.y>c.y?1:-1),e.flingDeltas=[],(r>60||r<-60||a>60||a<-60)&&(e.flickScrollAmplitude={x:r,y:a},e.flickScrollStartTimestamp=Date.now(),l=e.viewport.origin.copy(),e.flickScrollTimer=d3.timer(function(t){var i,n,o,s=d3.ease("exp-out");return t>1e3||!e.flickScrollAmplitude.x&&!e.flickScrollAmplitude.y?(e.stopFlickScroll(),!0):(i=s(t/1e3),n=-e.flickScrollAmplitude.x*i,o=-e.flickScrollAmplitude.y*i,e.scrollTopLeftToPoint(l.x+n,l.y+o),!1)}))}}),i.on("pancancel",function(t){"mouse"!==t.pointerType&&e.grabScrollEnded()}),this.eventDrag=d3.behavior.drag().on("dragstart",this.eventNodeDragStarted.bind(this)).on("drag",this.eventNodeDragged.bind(this)).on("dragend",this.eventNodeDragEnded.bind(this)),this.columnDrag=d3.behavior.drag().on("dragstart",this.columnDragStarted.bind(this)).on("drag",this.columnDragged.bind(this)).on("dragend",this.columnDragEnded.bind(this)),this.columnGroupDrag=d3.behavior.drag().on("dragstart",this.columnGroupDragStarted.bind(this)).on("drag",this.columnGroupDragged.bind(this)).on("dragend",this.columnGroupDragEnded.bind(this)),this.laneDrag=d3.behavior.drag().on("dragstart",this.laneDragStarted.bind(this)).on("drag",this.laneDragged.bind(this)).on("dragend",this.laneDragEnded.bind(this)),this.verticalScrollDrag=d3.behavior.drag().on("dragstart",this.verticalScrollDragStarted.bind(this)).on("drag",this.verticalScrollDragged.bind(this)).on("dragend",this.verticalScrollDragEnded.bind(this)),this.horizontalScrollDrag=d3.behavior.drag().on("dragstart",this.horizontalScrollDragStarted.bind(this)).on("drag",this.horizontalScrollDragged.bind(this)).on("dragend",this.horizontalScrollDragEnded.bind(this))},setInspectorModel:function(e){this.inspectorModel=e},setShowOffsets:function(e){this.timelineView.holdRendering(),this.showOffsets=e,this.model.relationshipViewShowOffsets=e,TimelineDisplayConstants.relationshipViewDateOffsetWidth=e?TimelineDisplayConstants.relationshipViewDateOffsetDefaultWidth:TimelineDisplayConstants.relationshipViewDateOffsetHideWidth,this.showOffsets?$("#relationshipOffsetButton").addClass("selected"):$("#relationshipOffsetButton").removeClass("selected"),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()},setTreeFlattened:function(e){this.timelineView.holdRendering(),this.model.relationshipViewFlattenTree=e,this.updateRelationshipFlattenButtonStates(),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()},toggleView:function(e){this.timelineView.holdRendering(),this.d3El.style("display",e?null:"none"),this.adjustWindowScale(),this.timelineView.releaseRendering()},setTimelineView:function(e){this.timelineView=e},getScrollableDimensions:function(){var e=this.$(".relationship_entity_name_spacer"),t=this.$("#relationship_entity_header .rTableColGroup"),i=this.$("#relationship_event_layer");return this.rangeX.min=0,this.rangeX.max=e.outerWidth()+t.outerWidth()+100*this.physicalScaleFactor,this.rangeY.min=window.mainApp.isIos?0:-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,this.rangeY.max=i.innerHeight(),{viewWidth:this.rangeX.max,viewHeight:this.rangeY.max,scrollLeft:this.$el.scrollLeft(),scrollTop:this.$el.scrollTop()-TimelineDisplayConstants.relationshipViewIosOverscrollHeight}},scrollTopLeftToPoint:function(e,t){var i,n;if(window.mainApp.isIos)return this.viewport.origin.x=e,this.viewport.origin.y=t+TimelineDisplayConstants.relationshipViewIosOverscrollHeight,this.$el.scrollLeft(this.viewport.origin.x),window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE?this.$el.scrollTop(this.viewport.origin.y):(this.timelineView.renderFlags.viewport=!0,this.timelineView.renderIfRequired()),void(window.mainApp&&window.mainApp.scrollPositionChanged());i=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width)),n=new ATBounds(this.rangeY.min,Math.max(this.rangeY.min,this.rangeY.max-this.viewport.size.height)),this.viewport.origin.x=i.constrain(e),this.viewport.origin.y=n.constrain(t),this.timelineView.renderFlags.viewport=!0,this.timelineView.renderIfRequired(),window.mainApp&&window.mainApp.scrollPositionChanged()},scrollLeftToPoint:function(e){this.scrollTopLeftToPoint(e,this.viewport.top())},scrollTopToPoint:function(e){this.scrollTopLeftToPoint(this.viewport.left(),e)},scrollToPixelXY:function(e,t,i){var n=this,o=e,s=t,r=i;null===o&&(o=this.viewport.origin.x),null===s&&(s=this.viewport.origin.y),r||(r=1e3),d3.transition().duration(r).tween("animatedscroll",function(e,t,i,r){return function(){var a=d3.interpolateNumber(e,t),l=d3.interpolateNumber(i,r);return function(e){n.timelineView.holdRendering(),n.scrollTopLeftToPoint(a(e),l(e)),a(e)===o&&l(e)===s&&(n.gestureCallReceivedFromCpp||(n.lastWheelTime=null)),n.timelineView.releaseRendering()}}}(this.viewport.origin.x,o,this.viewport.origin.y,s)),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},scrollIncrement:function(e,t){return this.scrollTopLeftToPoint(this.viewport.origin.x+e,this.viewport.origin.y+t)},clientXRightOfSyncBinder:function(e){var t;return window.mainApp.canvasManager.syncBinderVisible?(t=$("#syncBinder").innerWidth(),e-t):e},clientYBelowFilterBar:function(e){return e-this.$el.offset().top},rawMousePositionToScaledCanvasPosition:function(e){var t=new ATPoint(e);return t.x=this.clientXRightOfSyncBinder(e.x),t.y=this.clientYBelowFilterBar(e.y),t.x/=this.physicalScaleFactor,t.y/=this.physicalScaleFactor,t},mouseWheel:function(e){var t=window.mainApp.isWindows&&e.shiftKey&&!e.ctrlKey&&!e.metaKey,i=e.wheelDeltaX||40*-e.deltaX,n=e.wheelDeltaY||40*-e.deltaY,o=t?n:i,s=t?i:n,r=e.clientX,a=e.clientY;return this.mouseWheelWorkaround(o,s,r,a,e.ctrlKey||e.metaKey),e.preventDefault(),!1},mouseWheelWorkaround:function(e,t,i,n,o){var s,r,a,l;this.roleContextMenu.open||(this.timelineView.holdRendering(),!1!==i&&!1!==n&&(s=this.rawMousePositionToScaledCanvasPosition(new ATPoint(Number(i),Number(n))),(r=s.x)<0||r>this.viewport.size.width)?this.timelineView.releaseRendering():o?this.timelineView.releaseRendering():(a=this.viewport.origin.x-e,l=this.viewport.origin.y-t,this.scrollTopLeftToPoint(a,l),this.timelineView.releaseRendering()))},canvasSize:function(){var e=this.el.getBoundingClientRect();return window.mainApp&&window.mainApp.isIos&&window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE?new ATSize(e.width,e.height):new ATSize(e.width/this.physicalScaleFactor,e.height/this.physicalScaleFactor)},adjustWindowScale:function(){var e=this.canvasSize();window.mainApp&&window.mainApp.isIos&&window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE&&(e.height-=TimelineDisplayConstants.relationshipViewEntityHeaderHeight*this.physicalScaleFactor),this.viewport=new ATRect(this.viewport.origin.x,this.viewport.origin.y,e.width,e.height),this.d3El.select(".laneNavSvgWrap").attr("viewBox","0 0 28 "+e.height),this.d3El.select(".xScrollSvgWrap").attr("viewBox","0 0 "+e.width+" 16")},absoluteToRelativePoint:function(e){return new ATPoint(e.x-this.viewport.origin.x,e.y-this.viewport.origin.y)},relativeToAbsolutePoint:function(e){return new ATPoint(e.x+this.viewport.origin.x,e.y+this.viewport.origin.y)},topVisibleEvent:function(){var e=$("#relationshipContentDiv").offset(),t=(TimelineDisplayConstants.lifetimeHeight+2)*this.timelineView.physicalScaleFactor,i=document.elementFromPoint(e.left+10,e.top+t),n=i?$(i):null,o=n?n.closest(".relationshipTableEventRow"):null,s=o?o.attr("id"):null,r=s?s.substr(s.indexOf("-x-")+3):null;return window.mainApp.timeline.get("events").findChild(r)},topTimestamp:function(){var e,t,i,n,o;return window.mainApp.isIos&&window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE?i=this.topVisibleEvent():(e=this.viewport.top()+TimelineDisplayConstants.lifetimeHeight+2,i=(t=this.eventNodeForYPosition(e))?t.get("event"):null),i||(n=this.model.lanes.at(0))&&(i=(t=n.nodes.at(0))?t.get("event"):null),i?i.get("startTS"):(o=this.timeline.rangeConversion.todayTimestamp(),_.isNil(o)?0:o)},render:function(e){var t,i;if(this.firstRender)return this.firstRender=!1,this.storedFlagsForNextRender=e,this.relationshipPainter.transitionDuration=0,void this.scrollTopLeftToPoint(0,this.rangeY.min);if(!window.mainApp.isIos){if(this.viewport.bottom()>this.rangeY.max&&this.viewport.origin.y>this.rangeY.min)return this.storedFlagsForNextRender=e,void this.scrollTopToPoint(Math.max(this.rangeY.min,this.rangeY.max-this.viewport.size.height));if(this.viewport.origin.y<this.rangeY.min)return this.storedFlagsForNextRender=e,void this.scrollTopToPoint(this.rangeY.min)}t=this.usePruneDataFunction(this.model),i=_.clone(e),this.storedFlagsForNextRender&&_.assign(i,this.storedFlagsForNextRender),this.relationshipPainter.render(t,i),this.firstRender&&(this.firstRender=!1),this.storedFlagsForNextRender=null,i.data&&this.updateGroupCheckboxStates()},tableData:function(){var e,t,i,n=this,o=this.model,s=o.displayLanes.length,r=o.displayLanes[s-1],a=this.viewport.deepCopy(),l=a.top()-TimelineDisplayConstants.relationshipViewIosOverscrollHeight,h=a.bottom(),d=r.top+r.height,c=s>1&&d>a.size.height+TimelineDisplayConstants.bookmarksHeight,g=c?o.navigationLanes:[],p=[],u=!window.mainApp.isIos||window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE;return TimelineDisplayConstants.scrollKnobXPosition=c?TimelineDisplayConstants.scrollKnobDefaultXPosition:TimelineDisplayConstants.scrollKnobNoLaneNavXPosition,TimelineDisplayConstants.scrollTrackThickness=c?TimelineDisplayConstants.scrollTrackDefaultThickness:TimelineDisplayConstants.scrollTrackNoLaneNavThickness,this.columnGroupName=this.timeline.get("columnTypeName"),e=[],t=[],u&&_.each(o.displayColumnGroups,function(i){e.push({name:i.name,xPixel:i.xPixel,columns:_.map(i.entityColumns,function(e){return{name:e.name,color:e.color}})}),t=_.union(t,i.entityColumns)}),p=_.map(o.displayLanes,function(e){var t=_.clone(e),i=e.top,s=null,r=null,a=null;return t.nodes=_.filter(t.nodes,function(e){var t=e.totalRect.origin.y+i,d=t+e.totalRect.size.height;return null===s&&(s=t),a=d,(t<=h&&d>=l||!u)&&(e.selected=e.original.get("selected"),e.intersectionGroups=[],e.absoluteTop=n.absoluteToRelativePoint(new ATPoint(0,t-TimelineDisplayConstants.lifetimeHeight+TimelineDisplayConstants.relationshipViewIosOverscrollHeight)).y,u&&(null===r&&(r=t),_.each(o.displayColumnGroups,function(t){var i={intersections:[]};_.each(t.entityColumns,function(t){var n=_.find(e.intersections,function(i){return i.fastNodeId===e.fastId&&i.fastEntityId===t.fastId});n?i.intersections.push(n):i.intersections.push({icon:null,color:"transparent",age:null,shortAge:null,role:null,xPixel:t.xPixel,yPixel:null,id:e.id+"-"+t.id,nodeId:e.id,entityId:t.id})}),e.intersectionGroups.push(i)})),!0)}),u?(t.topPadding=0,t.bottomPadding=a-s):(t.topPadding=0,t.bottomPadding=0),t}),i=this.relationshipColumnsExpanded?window.mainApp.canvasManager.editModeActivated?TimelineDisplayConstants.relationshipViewIosExpandedEditModeEventWidth:TimelineDisplayConstants.relationshipViewIosExpandedEventWidth:window.mainApp.canvasManager.editModeActivated?TimelineDisplayConstants.relationshipViewIosNarrowEditModeEventWidth:TimelineDisplayConstants.relationshipViewIosNarrowEventWidth,i+=t.length?t.length*TimelineDisplayConstants.relationshipViewEntityColumnSpacing:TimelineDisplayConstants.relationshipViewIosEmptyColumnStateWidth,i+=TimelineDisplayConstants.relationshipViewIosEntityColGroupRightPadding,i*=this.physicalScaleFactor,this.rangeX.max=i,{lanes:p,navigationLanes:g,columnGroups:e,columns:t,bookmarks:this.model.get("timeline").get("bookmarks"),filters:this.model.get("timeline").get("filters"),size:{width:this.rangeX.span(),height:this.rangeY.span()}}},pruneData:function(){var e,t,i=this,n=this.model,o=n.displayLanes.length,s=n.displayLanes[o-1],r=this.viewport,a=s.top+s.height,l=o>1&&a>r.size.height+TimelineDisplayConstants.bookmarksHeight,h=l?n.navigationLanes:[],d=[],c=TimelineDisplayConstants.relationshipViewEventAreaWidth+TimelineDisplayConstants.relationshipViewDateOffsetWidth+TimelineDisplayConstants.relationshipViewEntityColumnSpacing;return TimelineDisplayConstants.scrollKnobXPosition=l?TimelineDisplayConstants.scrollKnobDefaultXPosition:TimelineDisplayConstants.scrollKnobNoLaneNavXPosition,TimelineDisplayConstants.scrollTrackThickness=l?TimelineDisplayConstants.scrollTrackDefaultThickness:TimelineDisplayConstants.scrollTrackNoLaneNavThickness,d=_.map(n.displayLanes,function(e){var t=_.clone(e),n=e.top;return t.intersections=[],e.top<=r.bottom()&&e.top+e.height>=r.top()?t.nodes=_.filter(t.nodes,function(e){var o=e.totalRect;return!!new ATRect(r.origin.x,o.origin.y+n,o.size.width,o.size.height).overlaps(r)&&(e.selected=e.original.get("selected"),_.each(e.intersections,function(e){i.absoluteToRelativePoint(new ATPoint(e.xPixel,0)).x>=c&&t.intersections.push(e)}),!0)}):t.nodes=[],t}),e=[],t=[],_.each(n.displayColumnGroups,function(i){e.push({name:i.name,xPixel:i.xPixel}),t=_.union(t,i.entityColumns)}),_.each(t,function(e){var t=i.absoluteToRelativePoint(new ATPoint(e.xPixel,0));e.drawInEventArea=t.x>=c}),{lanes:d,navigationLanes:h,columnGroups:e,columns:t,bookmarks:this.model.get("timeline").get("bookmarks"),filters:this.model.get("timeline").get("filters")}},eventNodeClick:function(e,t){var i,n,o,s,r,a,l,h=this,d=t||d3.event,c=Boolean(d.touches);if(this.hideRoleContextMenuIfOpen(),this.timelineView.holdRendering(),d.shiftKey&&d.altKey)this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id);else if(d.shiftKey&&this.nodeToStartShiftSelection){if(i=_.findIndex(this.model.displayLanes,function(e){return e.id===h.nodeToStartShiftSelection.laneId}),n=_.findIndex(this.model.displayLanes[i].nodes,function(e){return e.id===h.nodeToStartShiftSelection.id}),o=_.findIndex(this.model.displayLanes,function(t){return t.id===e.laneId}),s=_.findIndex(this.model.displayLanes[o].nodes,function(t){return t.id===e.id}),this.timeline.clearSelection(!0),o>i){for(l=(a=this.model.displayLanes[i]).nodes.length,r=n;r<l;r++)this.timeline.selectEventWithID(a.nodes[r].id);for(r=i+1;r<o;r++)a=this.model.displayLanes[r],_.each(a.nodes,function(e){h.timeline.selectEventWithID(e.id)});for(a=this.model.displayLanes[o],r=0;r<=s;r++)this.timeline.selectEventWithID(a.nodes[r].id)}else if(o===i&&s>n)for(a=this.model.displayLanes[o],r=n;r<=s;r++)this.timeline.selectEventWithID(a.nodes[r].id);else if(o===i&&s<n)for(a=this.model.displayLanes[o],r=s;r<=n;r++)this.timeline.selectEventWithID(a.nodes[r].id);else if(o<i){for(l=(a=this.model.displayLanes[o]).nodes.length,r=s;r<l;r++)this.timeline.selectEventWithID(a.nodes[r].id);for(r=o+1;r<i;r++)a=this.model.displayLanes[r],_.each(a.nodes,function(e){h.timeline.selectEventWithID(e.id)});for(a=this.model.displayLanes[i],r=0;r<=n;r++)this.timeline.selectEventWithID(a.nodes[r].id)}}else d.metaKey||d.ctrlKey?e.selected?this.timeline.unselectEventWithID(e.id):this.timeline.selectEventWithID(e.id):c||e.selected||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id));return d.shiftKey||(this.nodeToStartShiftSelection=e),this.timelineView.releaseRendering(),!1},eventNodeForYPosition:function(e){var t=this,i=null;return this.model.lanes.each(function(n){var o=n.get("top"),s=e-n.get("top");o<=e&&o+n.get("height")>=e&&n.nodes.each(function(e){var n=e.get("relationshipTotalRect"),o=null;n.top()<s&&n.bottom()>=s?i=e:e.get("showChildNodes")&&n.bottom()<s&&(o=t.eventNodeForYInChildList(e.childNodes,s),!i&&o&&(i=o))})}),i},eventNodeForYInChildList:function(e,t){var i=this,n=null;return e.each(function(e){var o=e.get("relationshipTotalRect"),s=null;o.top()<t&&o.bottom()>=t?n=e:e.get("showChildNodes")&&o.bottom()<t&&(s=i.eventNodeForYInChildList(e.childNodes,t),!n&&s&&(n=s))}),n},nodesSurroundingYPosition:function(e,t){var i=null,n=null;return _.each(this.model.displayLanes,function(o){var s=o.top,r=e-o.top,a=!1,l=null;s<=e&&s+o.height>=e&&_.each(o.nodes,function(e){a&&!n&&(n=e),e.totalRect.top()<r&&e.totalRect.bottom()>=r&&(a=!0,t?(i=l,n=e):i=e),l=e})}),{match:i,next:n}},visibleEntityColumnForXPosition:function(e){var t=this,i=null,n=TimelineDisplayConstants.relationshipViewEventAreaWidth+TimelineDisplayConstants.relationshipViewDateOffsetWidth+TimelineDisplayConstants.relationshipViewEntityColumnSpacing;return _.each(this.model.displayColumnGroups,function(o){_.each(o.entityColumns,function(o){t.absoluteToRelativePoint(new ATPoint(o.xPixel,0)).x>=n&&o.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing<e&&o.xPixel>=e&&(i=o)})}),i?i.id:ATEmptyGuidString},canvasClick:function(e){var t=this.rawMousePositionToScaledCanvasPosition(new ATPoint(d3.event.x,d3.event.y)),i=this.relativeToAbsolutePoint(t),n=this.eventNodeForYPosition(i.y),o=n?n.id:ATEmptyGuidString,s=this.visibleEntityColumnForXPosition(i.x),r=this.clientYBelowFilterBar(d3.event.y),a=this.clientXRightOfSyncBinder(d3.event.x);return document.activeElement!==document.body&&document.activeElement.blur(),t.y<=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.lifetimeHeight||t.y>=this.viewport.size.height-TimelineDisplayConstants.bookmarksHeight-TimelineDisplayConstants.scrollTrackNoLaneNavThickness?(this.roleContextMenu.hide(),this.timeline.clearSelection(),!1):s===ATEmptyGuidString?(this.roleContextMenu.hide(),!1):(this.timelineView.holdRendering(),o===ATEmptyGuidString&&this.timeline.clearSelection(),this.roleContextMenu.open||o===ATEmptyGuidString||s===ATEmptyGuidString?this.roleContextMenu.hide():(this.eventIdForContextMenu=o,this.entityIdForContextMenu=s,this.updateRoleContextOptions(),this.roleContextMenu.show(this.$el,a,r)),this.timelineView.releaseRendering(),d3.event.stopPropagation(),d3.event.preventDefault(),!1)},hideRoleContextMenuIfOpen:function(){this.roleContextMenu.open&&(this.roleContextMenu.hide(),this.roleContextMenu.open=!1)},updateRoleContextOptions:function(){var e=this.timeline,t=this.inspectorModel.get("template"),i=e.get("entities").get(this.entityIdForContextMenu).get("type"),n=_.find(t.types,function(e){return e.name===i}).roles,o=[];o.push({value:ATEmptyGuidString,icon:"blank",label:"None",initial:""}),_.each(n,function(e){o.push({value:e.roleId,icon:e.icon,initial:e.name.charAt(0),label:e.name})}),this.roleContextMenu.setOptions(o)},contextRoleClick:function(e){var t=this.roleContextMenu.getValue();window.ApplicationInterface&&(t!==ATEmptyGuidString?window.ApplicationInterface.selectedEventsAddRelationship(window.timelineDocumentId,String(this.eventIdForContextMenu),this.entityIdForContextMenu,t,1):window.ApplicationInterface.selectedEventsRemoveRelationship(window.timelineDocumentId,String(this.eventIdForContextMenu),this.entityIdForContextMenu))},relationshipTreeNestingClick:function(){this.setTreeFlattened(!1),window.ApplicationInterface&&window.ApplicationInterface.setRelationshipViewFlattenTree(window.timelineDocumentId,!1)},relationshipFlattenClick:function(){this.setTreeFlattened(!0),window.ApplicationInterface&&window.ApplicationInterface.setRelationshipViewFlattenTree(window.timelineDocumentId,!0)},relationshipShowOffsetsClick:function(){this.setShowOffsets(!this.showOffsets),window.ApplicationInterface&&window.ApplicationInterface.setRelationshipViewShowOffsets(window.timelineDocumentId,this.showOffsets)},updateRelationshipFlattenButtonStates:function(){this.model.relationshipViewFlattenTree?($("#relationshipTreeNestingButton").removeClass("selected"),$("#relationshipFlattenNestingButton").addClass("selected")):($("#relationshipTreeNestingButton").addClass("selected"),$("#relationshipFlattenNestingButton").removeClass("selected"))},relationshipSettingsClick:function(e){var t,i=this,n=this.timeline.get("entities"),o=this.inspectorModel.get("entitiesByType"),s=this.inspectorModel.get("template").types,r=[],a=$(e.target);_.each(s,function(e){var t=e.name,i=o[t],s=[];_.each(i,function(e){var t=n.get(e.entityId);s.push({id:t.id,name:t.get("name"),isChecked:t.get("visibleAsColumn")})}),r.push({name:t,items:s})}),this.hideRoleContextMenuIfOpen(),this.removeExistingPopover(),t=this.selectColumnTemplate({groups:r}),a.popover({content:t,title:'<span>Select Columns</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>',container:"body",html:!0,placement:"bottomLeft",trigger:"manual",template:'<div class="popover popoverForm" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',animation:!1}),this.showPopover(a),$(".popover-title").html('<span>Select Columns</span><a class="fa fa-times-circle" data-dismiss="popover" id="popoverClose"></a>'),$(".popover-content").html(t),$(".selectColumnGroupCheckbox").on("click",this.groupToggleClick.bind(this)),$(".selectColumnListItemCheckbox").on("click",this.columnToggleClick.bind(this)),$(".selectColumnGroupDisplayToggle").on("click",this.groupDisplayToggleClick.bind(this)),$("#selectColumnAllBtn").on("click",this.allButtonClick.bind(this)),$("#selectColumnNoneBtn").on("click",this.noneButtonClick.bind(this)),$("#popoverClose").on("click",function(){i.removeExistingPopover()}),this.updateGroupCheckboxStates()},updateGroupCheckboxStates:function(){var e=this.timeline.get("entities"),t=this.inspectorModel.get("entitiesByType");_.each(t,function(t,i){var n=!1,o=!1,s=".show-group-"+i.replace(/\s/g,"__space__").replace(/\//g,"__slash__");_.each(t,function(t){e.get(t.entityId).get("visibleAsColumn")?n=!0:o=!0}),$(s).prop("checked",!o),$(s).prop("indeterminate",n&&o)})},columnToggleClick:function(e){var t,i,n,o,s;e&&e.target&&(i=(t=$(e.target)).val(),o=(n=t.is(":checked"))?i:"",s=n?"":i,window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsState(window.timelineDocumentId,o,s)),this.updateGroupCheckboxStates()},groupDisplayToggleClick:function(e){var t,i,n;this.timelineView.holdRendering(),e&&e.target&&(i=(t=$(e.target)).data("groupname"),n=$(".selectColumnsGroupWrap-"+i+" .selectColumnsRowWrap"),t.hasClass("fa-caret-down")?(t.removeClass("fa-caret-down"),t.addClass("fa-caret-right"),n.slideUp()):(t.removeClass("fa-caret-right"),t.addClass("fa-caret-down"),n.slideDown())),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering(),this.updateGroupCheckboxStates()},groupToggleClick:function(e){var t,i,n,o,s,r=this.timeline.get("entities"),a=[],l="",h="";e&&e.target&&(i=(t=$(e.target)).val(),n=i.replace(/__space__/g," ").replace(/__slash__/g,"/"),o=t.is(":checked"),s=".selectColumnsGroupWrap-"+i+" .selectColumnListItemCheckbox",r.each(function(e){e.get("type")===n&&a.push(e.id)}),o?l=a.join():h=a.join(),window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsState(window.timelineDocumentId,l,h),$(s).prop("checked",o)),this.updateGroupCheckboxStates()},allButtonClick:function(e){var t=[];this.timeline.get("entities").each(function(e){t.push(e.id)}),window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsState(window.timelineDocumentId,t.join(),""),$(".selectColumnListItemCheckbox").prop("checked",!0),this.updateGroupCheckboxStates()},noneButtonClick:function(e){var t=[];this.timeline.get("entities").each(function(e){t.push(e.id)}),window.ApplicationInterface&&window.ApplicationInterface.setEntityColumnsState(window.timelineDocumentId,"",t.join()),$(".selectColumnListItemCheckbox").prop("checked",!1),this.updateGroupCheckboxStates()},relationshipColumnGroupNameClick:function(e){var t=this,i=this.inspectorModel.get("template").types,n=$(d3.event.target),o=[];_.each(i,function(e){o.push({id:e.typeId,text:e.name,selected:t.columnGroupName===e.name})}),this.listControl.reset(),this.listControl.customize({decoration:null,heading:"Show Columns",allowMultiple:!1,showSearch:!1}),this.listControl.setItemList(o,!0),this.listenToOnce(this.listControl,"item:select",this._columnGroupChanged.bind(this)),this.listPopover.reset(),this.listPopover.customize({placement:"bottom",width:"216px"}),this.listPopover.show(n)},toggleExpandedColumnsClick:function(e){var t=!0;window.mainApp.isIphone?this.$el.removeClass("expandRelationshipEventColumns"):(this.timelineView.holdRendering(),_.isNil(e)?this.$el.toggleClass("expandRelationshipEventColumns"):e?this.$el.addClass("expandRelationshipEventColumns"):this.$el.removeClass("expandRelationshipEventColumns"),t=this.$el.hasClass("expandRelationshipEventColumns"),this.relationshipColumnsExpanded=t,this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering(),window.setTimeout(function(){window.mainApp&&window.mainApp.sendAllDimensionsToAppInterface(),window.ApplicationInterface&&window.ApplicationInterface.setRelationshipEventColumnExpanded(window.timelineDocumentId,t)},1))},_columnGroupChanged:function(e){window.ApplicationInterface&&(window.ApplicationInterface.setEntityColumnType(window.timelineDocumentId,e.id),window.ApplicationInterface.markSuggestions(window.timelineDocumentId,"ios_relationship_columns")),this.listPopover.hide()},relationshipIntersectionClick:function(e,t,i){var n=this.inspectorModel.get("template").types,o=this.timeline.get("entities").get(t),s=this.timeline.get("events").findChild(e),r=_.find(s.get("relationships"),function(e){return e.entityId===o.id}),a=_.find(n,function(e){return e.name===o.get("type")}).roles,l=[],h=i.offset().top,d=$(window).height();_.each(a,function(i){l.push({id:i.roleId,text:i.name,selected:r&&r.role===i.name,data:{eventId:e,entityId:t}})}),l.push({id:ATEmptyGuidString,text:"None",selected:!r,data:{eventId:e,entityId:t}}),this.listControl.reset(),this.listControl.customize({decoration:null,allowMultiple:!1,showSearch:!1}),this.listControl.setItemList(l,!0),this.listenToOnce(this.listControl,"item:select",this._relationshipRoleSelect.bind(this)),this.listPopover.reset(),this.listPopover.customize({placement:h>d/2?"top":"bottom",width:"216px"}),this.listPopover.show(i)},_relationshipRoleSelect:function(e){window.ApplicationInterface&&(e.id!==ATEmptyGuidString?window.ApplicationInterface.selectedEventsAddRelationship(window.timelineDocumentId,e.data.eventId,e.data.entityId,e.id,1):window.ApplicationInterface.selectedEventsRemoveRelationship(window.timelineDocumentId,e.data.eventId,e.data.entityId)),this.listPopover.hide()},showPopover:function(e){var t=this;this.sourceElement=e,this.$backdrop=$('<div class="backdrop" />'),this.$backdrop.appendTo(document.body),this.$backdrop.on("click",function(){t.removeExistingPopover()}),e.popover("show")},removeExistingPopover:function(){this.sourceElement&&this.sourceElement.popover("destroy"),this.$backdrop&&this.$backdrop.remove()},clickInVerticalScrollTrack:function(){var e=this,t=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,i=isNaN(d3.event.clientY)?d3.event.touches[0].clientY:d3.event.clientY,n=this.clientYBelowFilterBar(i)-t,o=this.rangeY.min+n/(this.viewport.size.height-t-TimelineDisplayConstants.navFooterHeight)*(this.rangeY.max-this.rangeY.min);this.hideRoleContextMenuIfOpen(),d3.transition().duration(this.relationshipPainter.transitionDuration).tween("animatedscroll",function(t,i,n,o){return function(){var t=d3.interpolateNumber(n,o);return function(i){e.scrollTopToPoint(t(i))}}}(this.viewport.origin.x,this.viewport.origin.x,this.viewport.origin.y,o)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},clickInHorizontalScrollTrack:function(){var e=this,t=TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft+TimelineDisplayConstants.scrollTrackTopMargin,i=isNaN(d3.event.clientX)?d3.event.touches[0].clientX:d3.event.clientX,n=this.clientXRightOfSyncBinder(i)-t,o=this.rangeX.min+n/(this.viewport.size.width-t)*(this.rangeX.max-this.rangeX.min);this.hideRoleContextMenuIfOpen(),d3.transition().duration(this.relationshipPainter.transitionDuration).tween("animatedscroll",function(t,i){return function(){var n=d3.interpolateNumber(t,i);return function(t){e.scrollLeftToPoint(n(t))}}}(this.viewport.origin.x,o)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragStarted:function(e){this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null,this.hideRoleContextMenuIfOpen(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragged:function(e){var t,i=isNaN(d3.event.sourceEvent.clientY)?d3.event.sourceEvent.touches[0].clientY:d3.event.sourceEvent.clientY,n=this.clientYBelowFilterBar(i),o=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,s=this.viewport.size.height-o-TimelineDisplayConstants.relationshipNavFooterHeight,r=this.rangeY.max-TimelineDisplayConstants.relationshipNavFooterHeight;this.verticalScrollDragStartY||(this.verticalScrollDragStartY=n||1,this.verticalScrollDragStartAbsY=this.viewport.top()),t=this.verticalScrollDragStartAbsY+(n-this.verticalScrollDragStartY)/this.physicalScaleFactor/s*r,this.scrollTopToPoint(t),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragEnded:function(e){d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null},horizontalScrollDragStarted:function(e){this.horizontalScrollDragStartX=null,this.horizontalScrollDragStartAbsX=null,this.hideRoleContextMenuIfOpen(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},horizontalScrollDragged:function(e){var t,i=isNaN(d3.event.sourceEvent.clientX)?d3.event.sourceEvent.touches[0].clientX:d3.event.sourceEvent.clientX,n=this.clientXRightOfSyncBinder(i),o=TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft+TimelineDisplayConstants.scrollTrackTopMargin,s=this.viewport.size.width-o,r=this.rangeX.max-o;this.horizontalScrollDragStartX||(this.horizontalScrollDragStartX=n||1,this.horizontalScrollDragStartAbsX=this.viewport.left()),t=this.horizontalScrollDragStartAbsX+(n-this.horizontalScrollDragStartX)/this.physicalScaleFactor/s*r,this.scrollLeftToPoint(t),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},horizontalScrollDragEnded:function(e){d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.horizontalScrollDragStartX=null,this.horizontalScrollDragStartAbsX=null},scrollToLane:function(e){this.hideRoleContextMenuIfOpen(),this.scrollToPixelXY(null,e.top-TimelineDisplayConstants.relationshipViewEntityHeaderHeight,this.relationshipPainter.transitionDuration)},getTableNodeDimensions:function(e){var t=$("#rTableRow-"+e.get("lane").id+"-x-"+e.id);return new ATRect(0,t.position().top-TimelineDisplayConstants.lifetimeHeight,t.outerWidth(),t.outerHeight())},scrollToTimestamp:function(e){var t=this.model.displayLanes,i=t.length?t[0]:null,n=0;(n=_.findIndex(i.nodes,function(t){return t.original.get("event").get("startTS")>=e}))>0?n--:n<0&&(n=i.nodes.length-1),this.scrollToNode(i.nodes[n].original)},scrollToNode:function(e){var t,i;if(this.hideRoleContextMenuIfOpen(),window.mainApp.isIos)return window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE?((i=this.getTableNodeDimensions(e)).origin.y<0&&(i.origin.y=0),t=i.origin.y):t=e.get("lane").get("top")+e.get("relationshipTotalRect").origin.y-TimelineDisplayConstants.lifetimeHeight,void this.scrollToPixelXY(null,t,1e3);this.hideRoleContextMenuIfOpen(),this.scrollToPixelXY(null,e.get("lane").get("top")+e.get("relationshipTotalRect").origin.y-TimelineDisplayConstants.relationshipViewEntityHeaderHeight-TimelineDisplayConstants.lifetimeHeight,1e3)},scrollToNodeIfOffScreen:function(e){var t,i,n=e.get("lane"),o=window.mainApp.isIos&&window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE;n.get("collapsed")&&this.toggleLane(n.id),(t=this.viewport.deepCopy()).size.height-=TimelineDisplayConstants.bookmarksHeight+TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.filterBarHeight,t.origin.y-=TimelineDisplayConstants.relationshipViewIosOverscrollHeight,o?i=this.getTableNodeDimensions(e):(i=e.get("relationshipTotalRect").deepCopy()).origin.y+=e.get("lane").get("top"),t.containsRect(i)||this.scrollToNode(e)},scrollToEventsIfOffScreen:function(e){var t,i=this,n=this.model.findAllNodesForEventIds(e),o=!1,s=null,r=window.mainApp.isIos&&window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE;(t=this.viewport.deepCopy()).size.height-=TimelineDisplayConstants.bookmarksHeight+TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.filterBarHeight,t.origin.y-=TimelineDisplayConstants.relationshipViewIosOverscrollHeight,n.length&&(_.each(n,function(e){var n,a=e.get("lane");r?n=i.getTableNodeDimensions(e):(n=e.get("relationshipTotalRect").deepCopy()).origin.y+=e.get("lane").get("top"),a.get("collapsed")||(t.containsRect(n)?o=!0:s=e)}),o||(s?this.scrollToNode(s):n.length>0&&(this.toggleLane(n[0].get("lane").id),this.scrollToNode(n[0]))))},resultForDropAtAbsY:function(e,t){var i,n,o,s,r,a,l,h,d,c,g=this.model.laneForAbsoluteY(e),p=g?_.find(this.model.displayLanes,function(e){return e.id===g.id}):null,u=p?p.top:0,v=t&&e<u+t.totalRect.origin.y,m=this.nodesSurroundingYPosition(e,v),w=this.timeline.get("events"),D=m.match,f=m.next,T=D?w.findChild(D.id):null,E=f?w.findChild(f.id):null;if(T&&E)if(o=T.get("startTS"),s=E.get("startTS"),o===s)d=this.timeline.rangeConversion.valueFromTimestamp(o,T.get("precision"));else for(a=(T.get("startTS")+E.get("startTS"))/2,c=Math.max(T.get("precision"),E.get("precision")),h=this.timeline.rangeConversion.spanForPrecision(c),d=this.timeline.rangeConversion.valueAtEvenSpanBeforeTimestamp(a,h),r=isNaN(d.timestamp)?d:d.timestamp;r===o&&c<ATTimeUnit.SECOND;)c++,h=this.timeline.rangeConversion.spanForPrecision(c),d=this.timeline.rangeConversion.valueAtEvenSpanBeforeTimestamp(a,h),r=isNaN(d.timestamp)?d:d.timestamp;else v?(E||g.nodes.length>0&&(f=p.nodes[0],E=w.findChild(f.id)),o=E.get("startTS"),l=this.timeline.rangeConversion.valueFromTimestamp(o,E.get("precision")),c=E.get("precision"),h=this.timeline.rangeConversion.spanForPrecision(c,!0),d=this.timeline.rangeConversion.valueByAddingSpanToValue(l,h)):(T||g.nodes.length>0&&(D=p.nodes[p.nodes.length-1],T=w.findChild(D.id)),o=T.get("startTS"),l=this.timeline.rangeConversion.valueFromTimestamp(o,T.get("precision")),c=T.get("precision"),h=this.timeline.rangeConversion.spanForPrecision(c),d=this.timeline.rangeConversion.valueByAddingSpanToValue(l,h));return i=!0,(T&&t&&T.id===t.id||E&&t&&E.id===t.id)&&(i=!1),n=u+(v?f.totalRect.top():D.totalRect.bottom()),{rangeValue:d,yPosition:n,allowMove:i}},dropSyncItem:function(e,t,i){var n,o=this.clientXRightOfSyncBinder(t),s=this.clientYBelowFilterBar(i),r=new ATPoint(o,s),a=this.relativeToAbsolutePoint(r),l=this.model.laneForAbsoluteY(a.y),h=l?l.id:"",d=this.resultForDropAtAbsY(a.y,null).rangeValue;d&&(n=this.timeline.rangeConversion.naturalStringFromValue(d,!1),window.ApplicationInterface&&window.ApplicationInterface.createEventsFromSyncItems(window.timelineDocumentId,e,n,h))},eventNodeDragStarted:function(e){var t,i,n,o,s,r=Boolean(d3.event.sourceEvent.touches),a=d3.event.sourceEvent.altKey,l=d3.event.sourceEvent.shiftKey;document.activeElement!==document.body&&document.activeElement.blur(),this.eventNodeDragStartTimestamp=d3.event.sourceEvent.timeStamp,r&&d3.event.sourceEvent.touches.length>1||this.disablePan?this.eventDragDisabled=!0:window.isAeonWebExport||(this.eventDragDisabled=!1,t=this.model.lanes.get(e.laneId).get("top"),i=new ATPoint(0,e.totalRect.origin.y+t),n=this.absoluteToRelativePoint(i),o=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),s=this.rawMousePositionToScaledCanvasPosition(o),this.timelineView.holdRendering(),this.draggingEvent=!0,this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.dragEventForPositionAllowed=!1,this.draggingEventForEndPosition=!1,this.eventDragStartPos=null,this.eventDragEndPos=this.eventDragStartPos,this.eventDragOffsetX=n.x-s.x,this.eventDragOffsetY=n.y-s.y,this.eventDraggingNode=e,this.eventDragFarEnough=!1,this.eventNodeClick(e,d3.event.sourceEvent),this.eventDragMeasureDistanceStartPos=this.relativeToAbsolutePoint(s),l&&a&&(this.draggingEventForDistanceMeasure=!0),this.eventDragStartedWithRightClick=2===d3.event.sourceEvent.button,this.eventDragStartedWithRightClick||(this.dragEventForPositionAllowed=this.timeline.selectedEventsDraggable()&&1===this.timeline.selectedEvents.length,this.timelineView.eventDragTooltip||(this.timelineView.eventDragTooltip=new Opentip($("#mainTimelineCanvas"),{style:"eventDragTooltipStyle"}))),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.timelineView.releaseRendering())},eventNodeDragged:function(e){var t,i,n,o,s,r,a,l,h,d,c=d3.event.sourceEvent.timeStamp-this.eventNodeDragStartTimestamp,g=this,p=d3.event.sourceEvent.altKey,u=d3.event.sourceEvent.shiftKey,v=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey;if(!(this.eventDragDisabled||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan||this.eventDragStartedWithRightClick||2===d3.event.sourceEvent.button)){if(!this.timeline.isEventWithIdSelected(e.id)){if(c<TimelineDisplayConstants.touchEventMinimumHoldTimeBeforeMove)return void(this.eventDragDisabled=!0);this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)}this.eventDragDisabled=!1,window.isAeonWebExport||(this.timelineView.holdRendering(),this.draggingEvent&&(o=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),r=(s=this.rawMousePositionToScaledCanvasPosition(o)).x,a=s.y,t=new ATPoint(r+this.eventDragOffsetX,a+this.eventDragOffsetY),i=this.relativeToAbsolutePoint(t),n=this.relativeToAbsolutePoint(new ATPoint(r,a)),i.y=n.y,this.eventDragEndPos=i,this.eventDragEndLane=this.model.laneForAbsoluteY(n.y),this.eventDragStartPos||(this.eventDragStartPos=i,this.eventDragStartingLane=this.eventDragEndLane),window.mainApp.canvasManager.syncBinderVisible&&r<0?(this.eventDragIntoBinder||(h={jstree:!0,draggingEvents:!0,obj:$(this),nodes:[]},_.each(this.timeline.selectedEvents,function(e){var t=g.timeline.get("events").findChild(e);h.nodes.push({id:!0,text:t.get("title"),eventId:t.id}),d=t.get("title")}),this.timeline.selectedEvents.length>1&&(d="Sync "+this.timeline.selectedEvents.length+" new events"),window.mainApp.syncBinderView.receiveDrag(d3.event.sourceEvent,h,d),this.eventDragIntoBinder=!0),this.eventDragTick=null,this.viewDragTick=null,this.eventNodeDragEnded(e)):(this.eventDragIntoBinder=!1,Math.abs(this.eventDragStartPos.x-i.x)+Math.abs(this.eventDragStartPos.y-i.y)>5&&(this.eventDragFarEnough=!0),p&&u?(this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.draggingEventForDistanceMeasure=!0,this.eventDragMeasureDistanceFromNode||(this.eventDragMeasureDistanceFromNode=this.eventDragStartingLane.nodes.findNode(e.id)),this.eventDragMeasureDistanceToNode=this.eventNodeForYPosition(n.y),this.eventDragMeasureDistanceEndPos=n,this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id),this.eventDragMeasureDistanceToNode&&this.timeline.selectEventWithID(this.eventDragMeasureDistanceToNode.id)):v?(this.draggingEventForParent=!0,this.draggingEventForEndPosition=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragTargetEventDrop=this.eventNodeForYPosition(n.y),!this.eventDragTargetEventDrop||this.eventDragTargetEventDrop.id!==e.id&&this.timeline.selectedEventsCanHaveParent(this.eventDragTargetEventDrop.id)||(this.eventDragTargetEventDrop=null),this.eventDragChangingParent=!0):(this.draggingEventForEndPosition=!1,this.draggingEventForParent=!1,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragEndLane!==this.eventDragStartingLane?(this.draggingEventForLane=!0,this.draggingEventForPosition=!1):(this.draggingEventForLane=!1,this.draggedEventNode=e,this.dragEventForPositionAllowed?this.draggingEventForPosition=!0:this.draggingEventForPosition=!1)),l=this.viewport.size.height,this.dragScrollIncrementY=0,a<70&&(this.dragScrollIncrementY=-10),a>l-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementY?(this.draggingEventForParent&&(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1),this.d3EventPt=t,this.scrollIncrement(0,this.dragScrollIncrementY),this.eventDragTick=this.eventNodeDraggedNearEdge.bind(this),window.setTimeout(this.eventDragTick,5)):this.eventDragTick&&(this.eventDragTick=null)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()),this.eventDragFarEnough&&(this.eventNodeDraggedCalculateActions(),this.relationshipPainter.drawMoveEventLine()),this.timelineView.releaseRendering())}},eventNodeDraggedNearEdge:function(){var e;window.isAeonWebExport||(this.timelineView.holdRendering(),e=this.relativeToAbsolutePoint(this.d3EventPt),this.eventDragEndPos=e,this.eventDragEndLane=this.model.laneForAbsoluteY(e.y),this.scrollIncrement(0,this.dragScrollIncrementY),this.draggingEventForParent?(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1):this.draggingEventForDistanceMeasure&&(this.eventDragMeasureDistanceToNode=null),this.eventDragTick&&window.setTimeout(this.eventDragTick,15),this.eventDragFarEnough&&(this.draggingEvent&&this.eventNodeDraggedCalculateActions(),this.relationshipPainter.drawMoveEventLine()),this.timelineView.releaseRendering())},eventNodeDraggedCalculateActions:function(){var e,t,i,n,o,s,r,a,l="tooltipNormal";if(this.draggingEventForDistanceMeasure)this.eventDragMeasureDistanceToNode&&(i=this.eventDragMeasureDistanceFromNode.get("event"))!==(n=this.eventDragMeasureDistanceToNode.get("event"))?(n.get("startTS")>i.get("endTS")?(o=this.timeline.rangeConversion.valueFromTimestamp(i.get("endTS")),t="end"):(o=this.timeline.rangeConversion.valueFromTimestamp(i.get("startTS")),t="start"),s=this.timeline.rangeConversion.valueFromTimestamp(n.get("startTS")),e="Distance from "+t+" of event: "+this.timeline.rangeConversion.spanBetweenValues(o,s).toString()):e="Hover over event to measure distance between events";else if(this.draggingEventForParent)e=this.eventDragTargetEventDrop?'Make child of "'+this.eventDragTargetEventDrop.get("event").get("title")+'"':"Drop on event to become child";else if(this.draggingEventForLane)e="Add relationship to "+this.eventDragEndLane.get("entity").get("name");else if(this.draggingEventForPosition)this.snapDragLine=null,(r=this.resultForDropAtAbsY(this.eventDragEndPos.y,this.draggedEventNode)).allowMove?(a=r.rangeValue,this.eventDragDropY=r.yPosition,e="Move event to "+this.timeline.rangeConversion.naturalStringFromValue(a,!0)):(this.eventDragDropY=null,e=null);else{if(!this.draggingEvent||this.dragEventForPositionAllowed)return this.timelineView.eventDragTooltip.hide(),void this.timelineView.eventDragTooltip.deactivate();e=1===this.timeline.selectedEvents.length?"Cannot drag dependent events. Move its predecessor instead.":"You can only drag one event at a time in Relationship View",l="tooltipError"}(e=e?'<span class="'+l+'">'+e+"</span>":null)?(this.timelineView.eventDragTooltip.setContent(e),this.timelineView.eventDragTooltip.prepareToShow()):(this.timelineView.eventDragTooltip.hide(),this.timelineView.eventDragTooltip.deactivate())},eventNodeDragEnded:function(e){var t,i,n,o,s,r,a=d3.event.sourceEvent.shiftKey,l=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey;if(this.eventDragStartedWithRightClick||this.eventDragDisabled||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan)return this.eventDragStartedWithRightClick=!1,this.eventDragDisabled=!1,this.eventDragTick=null,this.draggingEvent=!1,this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,void this.relationshipPainter.drawMoveEventLine();this.eventDragDisabled=!1,window.isAeonWebExport||(this.eventDragTick=null,this.draggingEvent=!1,this.timelineView.holdRendering(),this.eventDragIntoBinder||(t=this.timeline.selectedEvents.join(),this.eventDragIntoBinder=!1,this.eventDragFarEnough?this.draggingEventForParent&&this.eventDragChangingParent?window.ApplicationInterface&&(i=this.eventDragTargetEventDrop?this.eventDragTargetEventDrop.id:ATEmptyGuidString,window.mainApp.showNewParentPromptIfNeeded(i,function(e){window.ApplicationInterface.moveEventsWithIdsToParent(window.timelineDocumentId,t,i,e)})):this.draggingEventForLane&&this.eventDragEndLane!==this.eventDragStartingLane?window.ApplicationInterface&&window.ApplicationInterface.copyEventsWithIdsToLane(window.timelineDocumentId,t,this.eventDragEndLane.id):this.draggingEventForPosition?window.ApplicationInterface&&1===this.timeline.selectedEvents.length&&(n=this.resultForDropAtAbsY(this.eventDragEndPos.y,this.draggedEventNode)).allowMove&&(o=n.rangeValue,s=String(isNaN(o.timestamp)?o:o.timestamp),r=isNaN(o.precision)?0:o.precision,window.ApplicationInterface.moveEventWithIdToTimestamp(window.timelineDocumentId,this.timeline.selectedEvents[0],s,r)):a||l||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)):l||a||l||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id))),this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.eventDragDropY=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,this.relationshipPainter.drawMoveEventLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.timelineView.eventDragTooltip.hide(),this.timelineView.eventDragTooltip.deactivate(),this.timelineView.releaseRendering())},laneDragStarted:function(e){var t=Boolean(d3.event.sourceEvent.touches);document.activeElement!==document.body&&document.activeElement.blur(),window.isAeonWebExport||t||e.id!==ATEmptyGuidString&&(this.draggingLane=!0,this.laneDragStartPos=null,this.laneDragEndLane=null,this.laneDragEndPos=this.laneDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.timelineView.holdRendering(),this.timeline.clearSelection(),this.timelineView.releaseRendering())},laneDragged:function(e){var t,i,n,o,s,r,a=Boolean(d3.event.sourceEvent.touches);window.isAeonWebExport||a||e.id!==ATEmptyGuidString&&this.draggingLane&&(t=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),i=this.rawMousePositionToScaledCanvasPosition(t),n=this.relativeToAbsolutePoint(i),o=i.y,(r=this.model.laneForAbsoluteY(n.y)).id!==ATEmptyGuidString&&(this.laneDragEndLane=r),this.laneDragEndPos=n,this.laneDragStartPos||(this.laneDragStartPos=n,this.laneDragStartingLane=this.laneDragEndLane),s=this.viewport.size.height,this.dragScrollIncrementY=0,o<70&&(this.dragScrollIncrementY=-10),o>s-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementY?(this.d3EventPt=i,this.scrollIncrement(0,this.dragScrollIncrementY),this.laneDragTick=this.laneDraggedNearEdge.bind(this),window.setTimeout(this.laneDragTick,5)):this.laneDragTick&&(this.laneDragTick=null),this.relationshipPainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},laneDraggedNearEdge:function(){var e,t;window.isAeonWebExport||(e=this.relativeToAbsolutePoint(this.d3EventPt),this.laneDragEndPos=e,(t=this.model.laneForAbsoluteY(e.y)).id!==ATEmptyGuidString&&(this.laneDragEndLane=t),this.scrollIncrement(0,this.dragScrollIncrementY),this.laneDragTick&&(this.relationshipPainter.drawMoveLaneLine(),window.setTimeout(this.laneDragTick,15)))},laneDragEnded:function(e){var t=Boolean(d3.event.sourceEvent.touches),i=e.id;window.isAeonWebExport||t||e.id!==ATEmptyGuidString&&(this.laneDragTick=null,this.draggingLane=!1,this.laneDragEndLane&&this.laneDragEndLane.id!==i&&window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,i,this.laneDragEndLane.id),this.laneDragEndPos=null,this.laneDragStartingLane=null,this.laneDragEndLane=null,this.relationshipPainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},viewDragStarted:function(e){document.activeElement!==document.body&&document.activeElement.blur()},viewDragged:function(e){var t=Boolean(d3.event.sourceEvent.touches)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.x,d3.event.sourceEvent.y),i=this.rawMousePositionToScaledCanvasPosition(t),n=i.x,o=i.y;d3.event.sourceEvent.touches||window.isAeonWebExport&&this.grabScrolled(n,o)},viewDragEnded:function(e){d3.event.sourceEvent.touches||this.grabScrollDrag&&this.grabScrollEnded()},grabScrolled:function(e,t,i){var n,o,s,r;e&&t&&(n=new ATPoint(e,t),o=new ATPoint(0,0),window.isAeonWebExport&&$("html,body").css("cursor","move"),this.grabScrollDrag=!0,this.timelineView.holdRendering(),this.grabScrollViewOrigin||(this.grabScrollMoveOrigin=new ATPoint(e,t),this.grabScrollViewOrigin=new ATPoint(this.viewport.origin.x,this.viewport.origin.y)),i||(s=this.grabScrollMoveOrigin.x-n.x,r=this.grabScrollMoveOrigin.y-n.y),o.x=this.grabScrollViewOrigin.x+s,o.y=this.grabScrollViewOrigin.y+r,this.scrollTopLeftToPoint(o.x,o.y),this.timelineView.releaseRendering())},grabScrollEnded:function(){null!==this.grabScrollMoveOrigin&&(this.grabScrollMoveOrigin=null,this.grabScrollViewOrigin=null,$("html,body").css("cursor","default")),this.grabScrollDrag=!1},stopFlickScroll:function(){this.flickScrollAmplitude={x:0,y:0},this.flickScrollTimer&&this.flickScrollTimer.stop()},temporarilyMoveColumnToPixel:function(e,t){var i,n=this.model.columnForEntityId(e),o=_.find(this.model.displayColumnGroups,function(e){return e.name===n.type}),s=_.indexOf(o.entityColumns,n),r=_.findIndex(o.entityColumns,function(e){return e.xPixel>t}),a=r<0,l=0===r;if(a?r=o.entityColumns.length-1:r--,this.timelineView.holdRendering(),r>s)for(i=s+1;i<=r;i++)o.entityColumns[i].xPixel=o.xPixel+(i-1)*TimelineDisplayConstants.relationshipViewEntityColumnSpacing;else if(r<s)for(i=s-1;i>r;i--)o.entityColumns[i].xPixel=o.xPixel+(i+1)*TimelineDisplayConstants.relationshipViewEntityColumnSpacing;n.xPixel=a?Math.min(t,o.xPixel+r*TimelineDisplayConstants.relationshipViewEntityColumnSpacing+TimelineDisplayConstants.relationshipViewEntityColumnSpacing/2):l?Math.max(t,o.xPixel):t,o.entityColumns.sort(function(e,t){return e.xPixel-t.xPixel}),this.model.calculateNodesRelationshipView(!0),this.timelineView.setRenderFlag("data"),this.timelineView.releaseRendering()},temporarilyMoveColumnGroupToPixel:function(e,t){var i=this.model.displayColumnGroups,n=_.find(i,function(t){return t.name===e}),o=_.findIndex(i,function(e){return e.xPixel>t});o<0?o=i-1:o--,this.timelineView.holdRendering(),n.xPixel=t,i.sort(function(e,t){return e.xPixel-t.xPixel}),this.model.calculateRelationshipViewColumns(!0,!1),n.xPixel=t,this.model.calculateRelationshipViewColumns(!1,!1),this.model.calculateNodesRelationshipView(!0),this.timelineView.setRenderFlag("data"),this.timelineView.releaseRendering()},columnDragStarted:function(e){var t=Boolean(d3.event.sourceEvent.touches);window.isAeonWebExport||t||e.id!==ATEmptyGuidString&&(this.draggingColumn=!0,this.columnDragStartPos=null,this.columnDragStartingType=null,this.columnDragEndPos=this.columnDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.relationshipPainter.draggingColumn=!0,this.timelineView.holdRendering(),this.timeline.clearSelection(),this.timelineView.releaseRendering())},columnDragged:function(e){var t,i,n,o,s,r=Boolean(d3.event.sourceEvent.touches),a=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));window.isAeonWebExport||r||e.id!==ATEmptyGuidString&&this.draggingColumn&&(t=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),i=this.rawMousePositionToScaledCanvasPosition(t),n=this.relativeToAbsolutePoint(i),o=i.x,this.columnDragStartPos||(this.columnDragStartPos=n,this.columnDragStartingColumn=this.model.relationshipColumnForAbsoluteX(n.x,this.columnDragStartingType),this.columnDragStartingType=this.columnDragStartingColumn.type),s=this.viewport.size.width,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,o<TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft&&this.viewport.origin.x>a.min&&(this.dragScrollIncrementX=-10),o>s-30&&this.viewport.origin.x<a.max&&(this.dragScrollIncrementX=10),this.dragScrollIncrementX?(this.d3EventPt=i,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnDragTick=this.columnDraggedNearEdge.bind(this),window.setTimeout(this.columnDragTick,5)):this.columnDragTick&&(this.columnDragTick=null),this.temporarilyMoveColumnToPixel(e.id,n.x),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},columnDraggedNearEdge:function(){var e=this.relativeToAbsolutePoint(this.d3EventPt),t=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));window.isAeonWebExport||(this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnDragTick&&(this.temporarilyMoveColumnToPixel(this.columnDragStartingColumn.id,e.x),this.viewport.origin.x>t.min&&this.viewport.origin.x<t.max&&window.setTimeout(this.columnDragTick,45)))},columnDragEnded:function(e){var t,i,n,o,s=Boolean(d3.event.sourceEvent.touches),r=e.id;window.isAeonWebExport||s||e.id!==ATEmptyGuidString&&(t=_.find(this.model.displayColumnGroups,function(t){return t.name===e.type}),i=_.clone(t.entityColumns).sort(function(e,t){return e.sortOrder-t.sortOrder}),o=(n=_.findIndex(t.entityColumns,function(t){return t.id===e.id}))<i.length?i[n]:_.last(i),this.columnDragTick=null,this.draggingColumn=!1,this.relationshipPainter.draggingColumn=!1,o.id!==r?window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,r,o.id):(this.timelineView.holdRendering(),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()),this.columnDragStartingColumn=null,this.columnDragStartingType=null,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},columnGroupDragStarted:function(e){var t=Boolean(d3.event.sourceEvent.touches);window.isAeonWebExport||t||(this.draggingColumnGroup=!0,this.columnGroupDragStartPos=null,this.columnGroupDragStartingType=null,this.columnGroupDragEndPos=this.columnGroupDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.relationshipPainter.draggingColumnGroup=!0,this.timelineView.holdRendering(),this.timeline.clearSelection(),this.timelineView.releaseRendering())},columnGroupDragged:function(e){var t,i,n,o,s,r=Boolean(d3.event.sourceEvent.touches),a=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));window.isAeonWebExport||r||this.draggingColumnGroup&&(t=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),i=this.rawMousePositionToScaledCanvasPosition(t),n=this.relativeToAbsolutePoint(i),o=i.x,this.columnGroupDragStartPos||(this.columnGroupDragStartPos=n,this.columnGroupDragStartingColumnGroup=e),s=this.viewport.size.width,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,o<TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft&&this.viewport.origin.x>a.min&&(this.dragScrollIncrementX=-10),o>s-30&&this.viewport.origin.x<a.max&&(this.dragScrollIncrementX=10),this.dragScrollIncrementX?(this.d3EventPt=i,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnGroupDragTick=this.columnGroupDraggedNearEdge.bind(this),window.setTimeout(this.columnGroupDragTick,5)):this.columnGroupDragTick&&(this.columnGroupDragTick=null),this.temporarilyMoveColumnGroupToPixel(e.name,n.x),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},columnGroupDraggedNearEdge:function(){var e=this.relativeToAbsolutePoint(this.d3EventPt),t=new ATBounds(this.rangeX.min,Math.max(this.rangeX.min,this.rangeX.max-this.viewport.size.width));window.isAeonWebExport||(this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.columnGroupDragTick&&(this.temporarilyMoveColumnGroupToPixel(this.columnGroupDragStartingColumnGroup.name,e.x),this.viewport.origin.x>t.min&&this.viewport.origin.x<t.max&&window.setTimeout(this.columnGroupDragTick,45)))},columnGroupDragEnded:function(e){var t,i=Boolean(d3.event.sourceEvent.touches),n=_.clone(this.model.displayColumnGroups).sort(function(e,t){return e.sortOrder-t.sortOrder});window.isAeonWebExport||i||(t=n[_.findIndex(this.model.displayColumnGroups,function(t){return t.name===e.name})],this.columnGroupDragTick=null,this.draggingColumnGroup=!1,this.relationshipPainter.draggingColumnGroup=!1,t&&t.name!==e.name?window.ApplicationInterface&&window.ApplicationInterface.moveEntityTypeToPositionOfEntityType(window.timelineDocumentId,e.name,t.name):(this.timelineView.holdRendering(),this.timelineView.setRenderFlag("calculate"),this.timelineView.releaseRendering()),this.columnGroupDragStartingColumnGroup=null,this.columnGroupDragStartingType=null,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},bookmarkClick:function(e){var t=e.timestamp-e.scale*this.viewport.size.width/2,i=this.timeline.firstEventAfterTimestamp(t),n=i?this.model.findAllNodesForEventId(i.id):[],o=null,s=null,r=this.viewport.origin.y;_.each(n,function(e){var t=e.get("lane").get("top")+e.get("relationshipTotalRect").origin.y,i=Math.abs(t-r);(null===o||i<o)&&(s=e,o=i)}),this.hideRoleContextMenuIfOpen(),s&&this.scrollToNode(s),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoFirstBookmark:function(){var e=this.model.findEarliestEventNode();e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoLastBookmark:function(){var e=this.model.findLatestEventNode();e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoPreviousEvent:function(){var e=this.viewport.size.height-TimelineDisplayConstants.bookmarksHeight-TimelineDisplayConstants.relationshipViewEntityHeaderHeight-TimelineDisplayConstants.lifetimeHeight,t=this.viewport.origin.y-e;this.scrollToPixelXY(null,t,this.relationshipPainter.transitionDuration),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},gotoNextEvent:function(){var e=this.viewport.size.height-TimelineDisplayConstants.bookmarksHeight-TimelineDisplayConstants.relationshipViewEntityHeaderHeight-TimelineDisplayConstants.lifetimeHeight,t=this.viewport.origin.y+e;this.scrollToPixelXY(null,t,this.relationshipPainter.transitionDuration),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},fakeCenterTsForBookmark:function(){var e,t,i=this.viewport.origin.y+TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.lifetimeHeight,n=this.eventNodeForYPosition(i),o=n?n.id:ATEmptyGuidString;return o===ATEmptyGuidString?null:(e=this.timeline.get("events").findChild(o),t=e.get("startTS"),t+=this.model.get("unitScale")*this.viewport.size.width/2)}});module.exports=ATRelationshipView;

},{"../../../lib/opentip":11,"../../controller/ATDisplayConstants":16,"../../model/ATEmptyGuidString":26,"../../model/ATTimeUnit":40,"../../utils/ATBounds":44,"../../utils/ATPoint":46,"../../utils/ATRect":48,"../../utils/ATSize":49,"../desktop/ATIconContextMenu":81,"../desktop/templates/relationshipViewSelectColumnsTemplate.html":168,"../ios/ATListControl":185,"../ios/ATPopover":189,"../ios/ATScreenMode":191,"./ATRelationshipViewPainter":199,"./ATRelationshipViewTablePainter":200,"backbone":220,"d3":320,"hammerjs":322,"jquery":331,"lodash":333}],199:[function(require,module,exports){
function MyRound(t,e){return Math.round(t*e)}function MyCeil(t,e){return Math.ceil(t*e)}var $=require("jquery"),d3=require("d3"),_=require("lodash"),Hilitor2=require("../../../lib/hilitor2"),ATUtilities=require("../../utils/ATUtilities"),Opentip=require("../../../lib/opentip"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),ATPoint=require("../../utils/ATPoint"),ATRect=require("../../utils/ATRect"),testForTransformSupport=function(){return void 0!==document.createElement("div").style.transform},ATRelationshipViewPainter=function(t){this.relationshipView=t,this.transformLabel=testForTransformSupport()?"transform":"-webkit-transform",this.scaleFactor=1,this.bgLayer=t.layers.bg_layer,this.intersectionLayer=t.layers.intersection_layer,this.offsetLayer=t.layers.offset_layer,this.eventLayer=t.layers.event_layer,this.laneLayer=t.layers.lane_layer,this.headerLayer=t.layers.entity_header,this.laneNavSvg=t.layers.lane_nav_svg,this.xScrollSvg=t.layers.x_scroll_svg,this.uiDrawingSvg=t.layers.ui_drawing_svg,this.bookmarksDiv=t.bookmarksDiv,this.bookmarkGroup=this.bookmarksDiv.select(".bookmarkGroup"),this.bookmarkAdd=this.bookmarksDiv.select(".bookmarkAdd"),this.bookmarksConfigured=!1,this.columnGroupNameHeader=this.headerLayer.append("div").classed("relationship_group_name_header",!0),this.columnEntityNameHeader=this.headerLayer.append("div").classed("relationship_entity_name_header",!0),this.verticalAnimateToggledLaneIds=[],this.hilitor=new Hilitor2("relationship_event_layer"),this.hilitor.setMatchType("open"),this.highlightString=null,this.defaultTransitionDuration=300,this.transitionDuration=this.defaultTransitionDuration;var e=0;this.RENDER_LEVEL_SELECTION=e++,this.RENDER_LEVEL_POSITION=e++,this.RENDER_LEVEL_VIEWPORT=e++,this.RENDER_LEVEL_SIZE=e++,this.RENDER_LEVEL_ZOOM=e++,this.RENDER_LEVEL_DATA=e++};ATRelationshipViewPainter.prototype.drawMoveEventLine=function(){var t,e,i,n,a,o,r,s,l,h=this.relationshipView.draggingEventForLane,p=this.relationshipView.draggingEventForParent,c=this.relationshipView.draggingEventForDistanceMeasure,d=this.relationshipView.draggingEventForPosition;p?((e=this.relationshipView.eventDragTargetEventDrop)?(this.moveEventDragTargetBox||(this.moveEventDragTargetBox=this.uiDrawingSvg.append("rect").attr("class","dragEventTargetDrop")),a=(n=e.get("totalRect")).top()+this.relationshipView.eventDragEndLane.get("top"),i=this.relationshipView.absoluteToRelativePoint(new ATPoint(n.left(),a)),this.moveEventDragTargetBox.attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",n.size.width).attr("height",n.size.height),this.uiDrawingSvg.attr("width",n.size.width*this.scaleFactor).attr("height",n.size.height*this.scaleFactor).attr("viewBox","0 0 "+n.size.width+" "+n.size.height).style("left",i.x*this.scaleFactor).style("top",i.y*this.scaleFactor)):this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null),this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null)):h||d||c?(t=this.relationshipView.eventDragEndPos,o=this.relationshipView.absoluteToRelativePoint(t),this.moveEventDragLine||(this.moveEventDragLine=this.uiDrawingSvg.append("line").attr("class","dragEventLine")),c?(r=this.relationshipView.absoluteToRelativePoint(this.relationshipView.eventDragMeasureDistanceStartPos),s=this.relationshipView.absoluteToRelativePoint(this.relationshipView.eventDragMeasureDistanceEndPos)):h?(r=new ATPoint(0,o.y),s=new ATPoint(this.relationshipView.viewport.size.width,o.y)):this.relationshipView.eventDragDropY?(r=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,this.relationshipView.eventDragDropY)),s=this.relationshipView.absoluteToRelativePoint(new ATPoint(this.relationshipView.viewport.size.width,this.relationshipView.eventDragDropY))):(r=null,s=null),r&&s?((l=new ATRect(0,0,0,0)).origin.x=Math.min(r.x,s.x)-2,l.origin.y=Math.min(r.y,s.y)-2,l.size.width=Math.max(Math.abs(r.x-s.x)+2,5),l.size.height=Math.max(Math.abs(r.y-s.y)+2,5),r.x-=l.origin.x,r.y-=l.origin.y,s.x-=l.origin.x,s.y-=l.origin.y,this.moveEventDragLine.attr("x1",Math.floor(r.x)+.5).attr("y1",Math.floor(r.y)+.5).attr("x2",Math.floor(s.x)+.5).attr("y2",Math.floor(s.y)+.5),this.uiDrawingSvg.attr("width",l.size.width?l.size.width*this.scaleFactor:1).attr("height",l.size.height?l.size.height*this.scaleFactor:1).attr("viewBox","0 0 "+l.size.width+" "+l.size.height).style("left",l.origin.x*this.scaleFactor).style("top",l.origin.y*this.scaleFactor)):this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null)):(this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null))},ATRelationshipViewPainter.prototype.drawMoveLaneLine=function(){var t,e;this.relationshipView.laneDragEndLane!=this.relationshipView.laneDragStartingLane?(t=this.relationshipView.laneDragEndPos.y<this.relationshipView.laneDragStartPos.y?new ATPoint(0,this.relationshipView.laneDragEndLane.get("top")+1):new ATPoint(0,this.relationshipView.laneDragEndLane.get("top")+this.relationshipView.laneDragEndLane.get("height")),e=this.relationshipView.absoluteToRelativePoint(t),this.moveLaneDragLine||(this.moveLaneDragLine=this.uiDrawingSvg.append("line").attr("class","dragLaneLine")),this.uiDrawingSvg.attr("width","100%").attr("height",5).attr("viewBox","0 0 100% 5").style("left",0).style("top",e.y*this.scaleFactor-2),this.moveLaneDragLine.attr("x1",0).attr("y1",2).attr("x2","100%").attr("y2",2)):this.moveLaneDragLine&&(this.moveLaneDragLine.remove(),this.moveLaneDragLine=null)},ATRelationshipViewPainter.prototype.setHighlightString=function(t){this.highlightString=ATUtilities.regexEscapedString(t),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove()},ATRelationshipViewPainter.prototype.render=function(t,e){this.relationshipView.model&&!_.isEmpty(e)&&(this.renderFlags=e,this.renderLevel=this.RENDER_LEVEL_SELECTION,this.renderFlags.position&&(this.renderLevel=this.RENDER_LEVEL_POSITION),this.renderFlags.viewport&&(this.renderLevel=this.RENDER_LEVEL_VIEWPORT),this.renderFlags.size&&(this.renderLevel=this.RENDER_LEVEL_SIZE),this.renderFlags.zoom&&(this.renderLevel=this.RENDER_LEVEL_ZOOM),this.renderFlags.data&&(this.renderLevel=this.RENDER_LEVEL_DATA),(this.renderFlags.viewport||this.renderFlags.zoom||this.draggingColumn||this.draggingColumnGroup)&&(this.transitionDuration=0),this.scaleFactor=this.relationshipView.physicalScaleFactor,this.renderFlags.data&&(this.bookmarkAdd.style("display","none"),window.isAeonWebExport&&$("#relationshipSettingsButton").css("display","none")),this.updateEventLayer(t),this.updateBgLayer(t),this.renderLevel>this.RENDER_LEVEL_SELECTION&&(this.updateOffsetLayer(t),this.updateIntersectionLayer(t),this.updateLaneLayer(t),this.updateHeaderLayer(t),this.updateNavigationLayer(t)),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove(),this.verticalAnimateToggledLaneIds=[],this.transitionDuration=this.defaultTransitionDuration)},ATRelationshipViewPainter.prototype.scrollBackgroundLayer=function(t){},ATRelationshipViewPainter.prototype.dataChangedBackgroundLayer=function(t){},ATRelationshipViewPainter.prototype.updateBgLayer=function(t){var e,i,n,a=this;(i=this.bgLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),this.renderLevel>this.RENDER_LEVEL_SELECTION&&(this.transitionDuration?i.transition().duration(this.transitionDuration):i).style("top",function(t){var e=a.relationshipView.absoluteToRelativePoint(new ATPoint(0,t.top));return Math.round(e.y*a.scaleFactor)+"px"}),i.exit().remove(),(n=i.selectAll(".relationshipEventLineDiv").data(function(t){return t.nodes},function(t){return t.id})).classed("selected",function(t){return t.selected&&!t.isLaneCollapsed}),n.enter().append("div").classed("relationshipEventLineDiv",!0),n.classed("odd",function(t){return t.isOdd}),(this.transitionDuration?n.transition().duration(this.transitionDuration):n).style("top",function(t){return MyRound(t.totalRect.top(),a.scaleFactor)+"px"}).style("height",function(t){return MyRound(t.totalRect.size.height,a.scaleFactor)+"px"}).style("left",0),n.exit().remove(),(e=this.bgLayer.selectAll(".relationshipEntityLine").data(_.values(t.columns),function(t){return t.name})).enter().append("div").classed("relationshipEntityLine",!0).style("left",function(t){return MyRound(a.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing,0)).x,a.scaleFactor)+"px"}),e.classed("odd",function(t){return t.isOdd}).classed("last",function(t){return t.isLast}),(this.transitionDuration?e.transition().duration(this.transitionDuration):e).style("left",function(t){return MyRound(a.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing,0)).x,a.scaleFactor)+"px"}).style("display",function(t){return t.drawInEventArea?null:"none"}),e.exit().remove()},ATRelationshipViewPainter.prototype.updateOffsetLayer=function(t){var e,i=this;(e=this.offsetLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),e.each(function(t){i.renderIndividualLaneOffsetGroup(this,t)}),e.exit().remove()},ATRelationshipViewPainter.prototype.updateIntersectionLayer=function(t){var e,i,n,a=this,o=this.relationshipView.timelineView.showEventDate;(e=this.intersectionLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").classed("laneDivWrapper",!0).style("top","0px"),(this.transitionDuration?e.transition().duration(this.transitionDuration):e).style("top",function(t){var e=a.relationshipView.absoluteToRelativePoint(new ATPoint(0,t.top));return Math.round(e.y*a.scaleFactor)+"px"}),e.exit().remove(),(i=e.selectAll(".relationshipEventIntersectionDiv").data(function(t){return t.intersections},function(t){return t.id})).enter().append("div").style("top",function(t){return MyRound(t.yPixel,a.scaleFactor)+"px"}).style("left",function(t){return MyRound(a.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing/2,0)).x,a.scaleFactor)+"px"}).append("span"),i.attr("class",function(t){return"relationshipEventIntersectionDiv "+t.icon+" "+t.color}).select("span").text(function(t){return t.role.charAt(0)}),(this.transitionDuration?i.transition().duration(this.transitionDuration):i).style("top",function(t){return MyRound(t.yPixel,a.scaleFactor)+"px"}).style("left",function(t){return MyRound(a.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing/2,0)).x,a.scaleFactor)+"px"}).attr("title",function(t){return t.role+(t.age?": "+t.age:"")}),i.exit().remove(),n=e.selectAll(".relationshipEventIntersectionAgeDiv").data(function(t){return t.intersections},function(t){return t.id}),o?(n.enter().append("div").classed("relationshipEventIntersectionAgeDiv",!0),(this.transitionDuration?n.transition().duration(this.transitionDuration):n).style("top",function(t){return MyRound(t.yPixel+22,a.scaleFactor)+"px"}).style("left",function(t){return MyRound(a.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel-TimelineDisplayConstants.relationshipViewEntityColumnSpacing/2,0)).x,a.scaleFactor)+"px"}).text(function(t){return t.shortAge}),n.exit().remove()):n.remove()},ATRelationshipViewPainter.prototype.updateHeaderLayer=function(t){var e,i,n,a,o,r=this;(e=this.columnGroupNameHeader.selectAll(".relationshipColumnGroupName").data(_.values(t.columnGroups),function(t){return t.name})).enter().append("div").classed("relationshipColumnGroupName",!0).call(this.relationshipView.columnGroupDrag).append("span").classed("relationshipColumnGroupNameText",!0),(i=this.transitionDuration?e.transition().duration(this.transitionDuration):e).style("left",function(t){return MyRound(r.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0)).x,r.scaleFactor)+"px"}),i.select(".relationshipColumnGroupNameText").text(function(t){return t.name}),e.exit().remove(),(n=this.columnEntityNameHeader.selectAll(".relationshipEntityName").data(_.values(t.columns),function(t){return t.name})).enter().append("div").classed("relationshipEntityName",!0).style("left",function(t){return MyRound(r.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0)).x,r.scaleFactor)+"px"}).call(this.relationshipView.columnDrag),o=this.transitionDuration?n.transition().duration(this.transitionDuration):n,n.html(function(t){return'<i class="fa fa-circle '+t.color+'"></i> '+t.name}).attr("title",function(t){return t.name}),o.style("left",function(t){return MyRound(r.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0)).x,r.scaleFactor)+"px"}),n.classed("odd",function(t){return t.isOdd}).classed("last",function(t){return t.isLast}),n.exit().remove(),(a=this.columnEntityNameHeader.selectAll(".relationshipEntityNameLine").data(_.values(t.columns),function(t){return t.name})).enter().append("div").classed("relationshipEntityNameLine",!0).style("left",function(t){return MyRound(r.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0)).x,r.scaleFactor)+"px"}),(this.transitionDuration?a.transition().duration(this.transitionDuration):a).style("left",function(t){return MyRound(r.relationshipView.absoluteToRelativePoint(new ATPoint(t.xPixel,0)).x,r.scaleFactor)+"px"}),a.exit().remove()},ATRelationshipViewPainter.prototype.updateLaneLayer=function(t){var e,i=this;(e=this.laneLayer.selectAll(".laneHeaderDiv").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").each(function(t){i.createIndividualLaneHeaderDiv(this)}),e.each(function(t,e){i.renderIndividualLaneHeaderDiv(this,t,e)}),e.exit().remove()},ATRelationshipViewPainter.prototype.updateEventLayer=function(t){var e,i,n,a=this;(e=this.eventLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").classed("laneDivWrapper",!0).style("top","0px").append("div").classed("relationshipLaneDivEmptyState",!0).text("You have no events in this group. Click to Add Event."),e.each(function(t){a.renderIndividualLaneEventGroup(this,t)}),e.exit().remove(),(i=e.selectAll(".relationshipEventLeftLineDiv").data(function(t){return t.nodes},function(t){return t.id})).enter().append("div").classed("relationshipEventLeftLineDiv",!0),(this.transitionDuration?i.transition().duration(this.transitionDuration):i).style("top",function(t){return MyRound(t.lineY,a.scaleFactor)+"px"}).style("left",function(t){return MyRound(t.lineX,a.scaleFactor)+"px"}).style("width",function(t){return MyRound(t.lineWidth,a.scaleFactor)+"px"}),i.exit().remove(),(n=e.selectAll(".relationshipEventUpLineDiv").data(function(t){return t.nodes},function(t){return t.id})).enter().append("div").classed("relationshipEventUpLineDiv",!0),(this.transitionDuration?n.transition().duration(this.transitionDuration):n).style("top",function(t){return MyRound(t.prevLineY?t.prevLineY:t.lineY,a.scaleFactor)+"px"}).style("height",function(t){return MyRound(t.lineY-(t.prevLineY?t.prevLineY:0),a.scaleFactor)+"px"}).style("visibility",function(t){return t.prevLineY?null:"hidden"}).style("left",function(t){return MyRound(t.verticalLineX,a.scaleFactor)+"px"}).style("width","1px"),n.exit().remove()},ATRelationshipViewPainter.prototype.updateNavigationLayer=function(t){var e,i=this,n=this.laneNavSvg.selectAll(".laneNav").data(t.navigationLanes,function(t){return t.id});this.renderLevel>this.RENDER_LEVEL_VIEWPORT?this.dataChangedLaneNav(n):this.renderLaneNav(n),this.verticalScrollKnob||(this.verticalScrollTrack=this.laneNavSvg.append("rect").attr("class","scrollTrack").attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("rx",0).attr("ry",0).on("click",function(t){return i.relationshipView.clickInVerticalScrollTrack()}),this.verticalScrollKnob=this.laneNavSvg.append("rect").attr("class","scrollknob verticalScroller").attr("width",TimelineDisplayConstants.scrollKnobThickness).attr("rx",TimelineDisplayConstants.scrollKnobThickness/2).attr("ry",TimelineDisplayConstants.scrollKnobThickness/2).call(this.relationshipView.verticalScrollDrag),this.$verticalScrollKnob=$(".relationshipContentDiv .verticalScroller"),this.horizontalScrollTrack=this.xScrollSvg.append("rect").attr("class","scrollTrack").attr("height",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).attr("rx",0).attr("ry",0).on("click",function(t){return i.relationshipView.clickInHorizontalScrollTrack()}),this.horizontalScrollKnob=this.xScrollSvg.append("rect").attr("class","scrollknob horizontalScroller").attr("height",TimelineDisplayConstants.scrollKnobThickness).attr("rx",TimelineDisplayConstants.scrollKnobThickness/2).attr("ry",TimelineDisplayConstants.scrollKnobThickness/2).call(this.relationshipView.horizontalScrollDrag),this.$horizontalScrollKnob=$(".relationshipContentDiv .horizontalScroller")),(e=this.bookmarkGroup.selectAll(".bookmarkItem").data(t.bookmarks)).select("span.bookmarkName").text(function(t){return t.name}),e.select("span.bookmarkItemRemove").classed("fa",!0),this.renderNewBookmarks(e.enter().append("div")),e.exit().remove(),this.renderVerticalScrollBar(this.verticalScrollKnob,this.verticalScrollTrack),this.renderHorizontalScrollBar(this.horizontalScrollKnob,this.horizontalScrollTrack)},ATRelationshipViewPainter.prototype.renderNewBookmarks=function(t){return t.attr("class","bookmarkItem").on("click",function(t){window.mainApp.timelineView.bookmarkClick(t)}).append("span").classed("bookmarkName",!0).text(function(t){return t.name}),t.append("span").classed("bookmarkItemRemove fa fa-times-circle",!0).on("click",function(t){if(window.ApplicationInterface)return window.ApplicationInterface.removeBookmark(window.timelineDocumentId,t.id),d3.event.stopPropagation(),!1}),t},ATRelationshipViewPainter.prototype.renderIndividualLaneOffsetGroup=function(t,e){var i,n=this,a=d3.select(t),o=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,e.top)),r=a.selectAll(".relationshipEventOffsetLabel").data(e.nodes,function(t){return t.id}),s=a.select(".relationshipLaneOffsetLineDiv"),l=e.nodes.length>0?e.nodes[0].totalRect.top()+TimelineDisplayConstants.relationshipViewDateOffsetLineOffsetFromNodeTop:0,h=e.nodes.length>0?e.nodes[e.nodes.length-1].totalRect.top()+TimelineDisplayConstants.relationshipViewDateOffsetLineOffsetFromNodeTop:0;(this.transitionDuration?a.transition().duration(this.transitionDuration):a).style("top",Math.round(o.y*this.scaleFactor)+"px"),r.enter().append("div").classed("relationshipEventOffsetLabel",!0),(i=this.transitionDuration?r.transition().duration(this.transitionDuration):r).style("top",function(t){return MyRound(t.offsetTextY,n.scaleFactor)+"px"}).style("left",function(t){return MyRound(t.offsetTextX,n.scaleFactor)+"px"}).text(function(t){return t.offsetText}),i.select(".relationshipEventOffsetLabel").style("left",MyRound(TimelineDisplayConstants.relationshipViewDateOffsetLeft,this.scaleFactor)+"px"),r.exit().remove(),(this.transitionDuration?s.transition().duration(this.transitionDuration):s).style("top",MyRound(l,this.scaleFactor)+"px").style("height",MyRound(h-l,this.scaleFactor)+"px")},ATRelationshipViewPainter.prototype.renderIndividualLaneEventGroup=function(t,e){var i,n=this,a=d3.select(t),o=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,e.top)),r=a.selectAll(".eventDivWrapper").data(e.nodes,function(t){return t.id});this.renderLevel>this.RENDER_LEVEL_SELECTION&&(i=this.transitionDuration?a.transition().duration(this.transitionDuration):a,a.classed("collapsed",e.collapsed),i.style("top",Math.round(o.y*this.scaleFactor)+"px"),r.each(function(t){n.updateIndividualEvent(this,t)}),r.enter().append("div").each(function(t){var e=d3.select(this),i=n.transitionDuration?e.transition().duration(n.transitionDuration):e;n.createIndividualEvent(this,e,t),n.updateIndividualEventPosition(this,i,t)}),a.select(".relationshipLaneDivEmptyState").style("display",e.empty&&!e.collapsed?null:"none").html(e.emptyText)),this.renderLevel>this.RENDER_LEVEL_SELECTION&&r.exit().remove()},ATRelationshipViewPainter.prototype.createIndividualEvent=function(t,e,i){var n=this.verticalAnimateToggledLaneIds.length;e.classed("eventDivWrapper",!0).style("top",MyRound(i.totalRect.origin.y,this.scaleFactor)+"px").style("left",MyRound(i.totalRect.origin.x,this.scaleFactor)+"px").style("width",MyRound(i.totalRect.size.width,this.scaleFactor)+"px").style("height",MyRound(i.totalRect.size.height,this.scaleFactor)+"px").style("opacity",n?1:0).call(this.relationshipView.eventDrag),this.updateIndividualEventContent(t,e,i),this.updateIndividualEventSize(t,e,e,i)},ATRelationshipViewPainter.prototype.updateIndividualEvent=function(t,e){var i=d3.select(t),n=this.transitionDuration?i.transition().duration(this.transitionDuration):i;this.renderLevel>=this.RENDER_LEVEL_DATA&&this.updateIndividualEventContent(t,i,e),this.renderLevel>=this.RENDER_LEVEL_SIZE&&this.updateIndividualEventSize(t,i,n,e),this.renderLevel>=this.RENDER_LEVEL_POSITION&&this.updateIndividualEventPosition(t,n,e)},ATRelationshipViewPainter.prototype.updateIndividualEventContent=function(t,e,i){var n,a=this.relationshipView.timelineView.showEventDate;e.attr("pointer-events",i.visible?null:"none").classed("isFaded",i.isFaded).classed("expanded",i.showMore).classed("parent",i.showChildNodes),i.isLaneCollapsed?(e.select(".eventContentWrapper").remove(),e.select(".showMoreSpan").remove(),e.select(".relationshipEventDot").remove(),e.select(".relationshipEventParentToggle").remove()):(e.select(".eventContentWrapper").empty()&&this.createIndividualEventContents(e),e.select(".eventTitle").text(i.displayTitle),e.select(".eventDate").text(i.dateString).style("display",a?null:"none"),e.select(".relationshipEventDot").attr("class",function(t){return"relationshipEventDot "+i.color}),e.select(".relationshipEventParentToggle").style("visibility",function(t){return t.isParent?null:"hidden"}).style("display",window.mainApp.relationshipView.model.relationshipViewFlattenTree?"none":null).classed("fa-caret-right",function(t){return!t.showChildNodes}).classed("fa-caret-down",function(t){return!!t.showChildNodes}),n=e.select(".expandedWrapper").html(i.showMore?i.contentHTML:""),i.showMore&&this.listenToEventLinkClicks(n,i),e.select(".showMoreSpan").classed("fa-chevron-down",!i.showMore).classed("fa-chevron-up",i.showMore)),e.select(".markerRect").style("fill",i.isFaded?null:i.color).style("stroke",i.isFaded?null:i.color)},ATRelationshipViewPainter.prototype.updateIndividualEventSize=function(t,e,i,n){i.style("width",MyCeil(n.totalRect.size.width,this.scaleFactor)+"px").style("height",MyCeil(n.totalRect.size.height,this.scaleFactor)+"px"),i.select(".eventContentWrapper").style("width",MyCeil(n.textRect.size.width,this.scaleFactor)+"px").style("height",MyCeil(n.textRect.size.height,this.scaleFactor)+"px"),e.select(".expandedWrapper").style("width",n.showMore?MyRound(n.textRect.size.width,this.scaleFactor)+"px":"0px"),i.select(".expandedWrapper").style("height",n.showMore?MyRound(n.textRect.size.height,this.scaleFactor)+"px":"0px")},ATRelationshipViewPainter.prototype.updateIndividualEventPosition=function(t,e,i){e.style("top",MyRound(i.totalRect.origin.y,this.scaleFactor)+"px").style("left",MyRound(i.totalRect.origin.x,this.scaleFactor)+"px").style("opacity",i.visible?1:0)},ATRelationshipViewPainter.prototype.createIndividualEventContents=function(t){t.append("span").classed("showMoreSpan fa",!0).on("click",function(t){window.mainApp.timelineView.toggleMoreEventInfo(t)}),t.append("span").classed("relationshipEventParentToggle fa",!0).on("click",function(t){window.mainApp.timelineView.toggleShowChildNodes(t.id,t.laneId)}),t.append("span").classed("relationshipEventDot",!0);var e=t.append("div").classed("eventContentWrapper",!0);e.append("div").classed("eventTitle draggable",!0),e.append("div").classed("eventDate draggable",!0),e.append("div").classed("expandedWrapper draggable",!0)},ATRelationshipViewPainter.prototype.listenToEventLinkClicks=function(t,e){t.selectAll(".externalLinkAnchor").on("click",function(t,i){if(window.isAeonWebExport)return!0;var n=[];return _.each(e.links,function(t){n.push({filepath:t.path})}),window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(n),i),d3.event.stopPropagation(),d3.event.preventDefault(),!1}),t.select(".eventImage").on("dblclick",function(t){var e=[{filepath:t.fullImagePath}];return!!window.isAeonWebExport||(window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(e),0),d3.event.stopPropagation(),d3.event.preventDefault(),!1)})},ATRelationshipViewPainter.prototype.createIndividualLaneHeaderDiv=function(t){var e=d3.select(t).classed("laneHeaderDiv",!0).style(this.transformLabel,"translateY(0px)").call(this.relationshipView.laneDrag);e.append("span").classed("laneDivArrow fa",!0).on("click",function(t){window.mainApp.timelineView.toggleLane(t.id)}),e.append("span").classed("laneDivLabel",!0)},ATRelationshipViewPainter.prototype.renderIndividualLaneHeaderDiv=function(t,e){var i=d3.select(t),n=this.relationshipView.absoluteToRelativePoint(new ATPoint(0,e.top)).y;n<TimelineDisplayConstants.relationshipViewEntityHeaderHeight&&(n+=Math.min(-n+TimelineDisplayConstants.relationshipViewEntityHeaderHeight,e.height-TimelineDisplayConstants.lifetimeHeight)),i.classed("collapsed",e.collapsed).classed("odd",e.odd),i.select(".laneDivArrow").classed("fa-chevron-up",!e.collapsed).classed("fa-chevron-down",e.collapsed),i.select(".laneDivLabel").text(e.entityName),this.transitionDuration?i.transition().duration(this.transitionDuration).style("top",n*this.scaleFactor+"px"):i.style("top",n*this.scaleFactor+"px")},ATRelationshipViewPainter.prototype.dataChangedLaneNav=function(t){this.renderLaneNav(t.transition().duration(this.transitionDuration)),this.renderLaneNav(t.enter().append("rect").attr("width",TimelineDisplayConstants.laneNavNodeWidth).attr("rx",TimelineDisplayConstants.laneNavNodeWidth/2).attr("ry",TimelineDisplayConstants.laneNavNodeWidth/2).attr("x",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).on("click",function(t){window.mainApp.relationshipView.scrollToLane(t)})),t.exit().transition().duration(this.transitionDuration).remove()},ATRelationshipViewPainter.prototype.renderLaneNav=function(t){var e=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,i=this.relationshipView.viewport.top()+e,n=this.relationshipView.viewport.size.height-e-TimelineDisplayConstants.relationshipNavFooterHeight,a=this.relationshipView.rangeY.max-TimelineDisplayConstants.relationshipNavFooterHeight;return t.attr("class",function(t){return i>=t.top&&i<t.top+t.height?"laneNav current":"laneNav"}).attr("y",function(t){return t.top/a*n+e+1}).attr("height",function(t){return Math.max(0,t.height/a*n-2)}),t.each(function(t){var e=$(this),i=Math.max(0,t.height/a*n-2),o=e.data("opentips");o&&o[0]?window.mainApp.isMac||(o[0].options.offset=[0,i/2]):new Opentip(this,t.entityName,{style:"laneNodeTooltipStyle",offset:window.mainApp.isMac?[0,0]:[0,i/2]})}),t},ATRelationshipViewPainter.prototype.renderVerticalScrollBar=function(t,e){var i=TimelineDisplayConstants.relationshipViewEntityHeaderHeight+TimelineDisplayConstants.scrollTrackTopMargin,n=this.relationshipView.viewport.top()+i,a=this.relationshipView.viewport.size.height-i-TimelineDisplayConstants.relationshipNavFooterHeight,o=this.relationshipView.rangeY.max-TimelineDisplayConstants.relationshipNavFooterHeight,r=o>0?ATUtilities.floatToInt(n/o*a+i):0,s=o>0?ATUtilities.floatToInt(a/o*a):o,l=Math.max(.5,TimelineDisplayConstants.scrollKnobXPosition-2.5),h=s<a;return e.attr("x",l).attr("y",i).attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("height",a).style("fill-opacity",h?TimelineDisplayConstants.scrollTrackOpacity:0).style("stroke-opacity",h?null:0),s==a||r===this.verticalScrollKnobTop&&s==this.verticalScrollKnobHeight&&this.relationshipView.viewport.size.width==this.verticalScrollKnobRight||t.attr("x",TimelineDisplayConstants.scrollKnobXPosition).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobOpacity:0).attr("y",r).attr("height",s).transition().delay(1e3).duration(500).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobFadeOpacity:0),this.verticalScrollTrackHeight=a,this.verticalScrollKnobTop=r,this.verticalScrollKnobHeight=s,this.verticalScrollKnobRight=this.relationshipView.viewport.size.width,t},ATRelationshipViewPainter.prototype.renderHorizontalScrollBar=function(t,e){var i=TimelineDisplayConstants.relationshipViewEntityOffsetFromLeft+TimelineDisplayConstants.scrollTrackTopMargin,n=this.relationshipView.viewport.left(),a=this.relationshipView.viewport.size.width-i,o=this.relationshipView.rangeX.max-i,r=o>0?ATUtilities.floatToInt(n/o*a+i):0,s=o>0?ATUtilities.floatToInt(a/o*a):o,l=Math.max(.5,TimelineDisplayConstants.scrollKnobDefaultXPosition-2.5),h=s<a;return e.attr("y",l).attr("x",0).attr("height",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).attr("width","100%").style("fill-opacity",h?TimelineDisplayConstants.scrollTrackOpacity:0).style("stroke-opacity",h?null:0),s==a||r===this.horizontalScrollKnobLeft&&s==this.horizontalScrollKnobWidth&&this.relationshipView.viewport.size.height==this.horizontalScrollKnobBottom||t.attr("y",TimelineDisplayConstants.scrollKnobDefaultXPosition).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobOpacity:0).attr("x",r).attr("width",s).transition().delay(1e3).duration(500).style("fill-opacity",h?TimelineDisplayConstants.scrollKnobFadeOpacity:0),this.horizontalScrollTrackWidth=a,this.horizontalScrollKnobLeft=r,this.horizontalScrollKnobWidth=s,this.horizontalScrollKnobBottom=this.relationshipView.viewport.size.height,t},module.exports=ATRelationshipViewPainter;

},{"../../../lib/hilitor2":7,"../../../lib/opentip":11,"../../controller/ATDisplayConstants":16,"../../utils/ATPoint":46,"../../utils/ATRect":48,"../../utils/ATUtilities":51,"d3":320,"jquery":331,"lodash":333}],200:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Hilitor2=require("../../../lib/hilitor2"),ATUtilities=require("../../utils/ATUtilities"),ATScreenMode=require("../ios/ATScreenMode"),ATPoint=require("../../utils/ATPoint"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),applyPhysicalScale=function(e,t){return Math.round(e*t)},ATRelationshipViewTablePainter=function(e){var t=0;this.relationshipView=e,this.scaleFactor=1,this.bgLayer=e.layers.bg_layer,this.intersectionLayer=e.layers.intersection_layer,this.offsetLayer=e.layers.offset_layer,this.eventLayer=e.layers.event_layer,this.laneLayer=e.layers.lane_layer,this.headerLayer=e.layers.entity_header,this.laneNavSvg=e.layers.lane_nav_svg,this.xScrollSvg=e.layers.x_scroll_svg,this.uiDrawingSvg=e.layers.ui_drawing_svg,this.bookmarksDiv=e.bookmarksDiv,this.bookmarkGroup=this.bookmarksDiv.select(".bookmarkGroup"),this.bookmarkAdd=this.bookmarksDiv.select(".bookmarkAdd"),this.bookmarksConfigured=!1,this.verticalAnimateToggledLaneIds=[],this.hilitor=new Hilitor2("relationship_event_layer"),this.hilitor.setMatchType("open"),this.highlightString=null,this.defaultTransitionDuration=300,this.transitionDuration=this.defaultTransitionDuration,this.RENDER_LEVEL_POSITION=t++,this.RENDER_LEVEL_VIEWPORT=t++,this.RENDER_LEVEL_SELECTION=t++,this.RENDER_LEVEL_SIZE=t++,this.RENDER_LEVEL_ZOOM=t++,this.RENDER_LEVEL_DATA=t++};ATRelationshipViewTablePainter.prototype.setHighlightString=function(e){this.highlightString=ATUtilities.regexEscapedString(e),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove()},ATRelationshipViewTablePainter.prototype.render=function(e,t){this.relationshipView.model&&!_.isEmpty(t)&&(this.renderFlags=t,this.renderLevel=this.RENDER_LEVEL_POSITION,this.renderFlags.position&&(this.renderLevel=this.RENDER_LEVEL_POSITION),this.renderFlags.viewport&&(this.renderLevel=this.RENDER_LEVEL_VIEWPORT),this.renderFlags.selection&&(this.renderLevel=this.RENDER_LEVEL_SELECTION),this.renderFlags.size&&(this.renderLevel=this.RENDER_LEVEL_SIZE),this.renderFlags.zoom&&(this.renderLevel=this.RENDER_LEVEL_ZOOM),this.renderFlags.data&&(this.renderLevel=this.RENDER_LEVEL_DATA),(this.renderFlags.viewport||this.renderFlags.zoom||this.draggingColumn||this.draggingColumnGroup)&&(this.transitionDuration=0),this.scaleFactor=this.relationshipView.physicalScaleFactor,this.renderFlags.data&&window.isAeonWebExport&&(this.bookmarkAdd.style("display","none"),$("#relationshipSettingsButton").css("display","none")),this.renderLevel>=this.RENDER_LEVEL_DATA&&this.updateHeaderLayer(e),this.renderLevel>=this.RENDER_LEVEL_SELECTION?(this.updateEventLayer(e),this.scrollEventLayer(e)):this.scrollEventLayer(e),this.verticalAnimateToggledLaneIds=[],this.transitionDuration=this.defaultTransitionDuration)},ATRelationshipViewTablePainter.prototype.updateHeaderLayer=function(e){var t,n,i,a,l=this;window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE?(this.columnEntityNameHeader||(this.columnEntityNameHeader=this.headerLayer.append("div").classed("relationship_table_entity_name_header rTableRow",!0),a=this.columnEntityNameHeader.append("div").classed("relationship_entity_name_spacer rTableEventCol",!0),this.d3CurrentColumnGroupName=a.append("div").classed("relationshipTableColumnGroupName",!0).on("click",this.relationshipView.relationshipColumnGroupNameClick.bind(this.relationshipView)),this.d3CurrentColumnGroupName.append("span"),this.d3CurrentColumnGroupName.append("svg").classed("relationshipTableColumnGroupArrow",!0).append("use").attr("xlink:href","#down"),this.d3ExpandEventWidthArrow=a.append("svg").classed("relationshipTableEventWidthArrow",!0).on("click",function(){l.relationshipView.toggleExpandedColumnsClick(null)}).append("use").attr("xlink:href","#left"),this.columnEntityNameHeader.append("div").classed("relationshipEntityNameZeroColumns",!0).append("span").text("You have no columns. Add them via the Side Bar.")),this.d3CurrentColumnGroupName.select("span").text(this.relationshipView.columnGroupName),this.columnEntityNameHeader.select(".relationshipEntityNameZeroColumns").style("display",e.columnGroups.length?"none":null).html("There are no columns to display.<br />Add your first "+this.relationshipView.columnGroupName+" using the side bar, or select a different type with the dropdown to the left."),(t=this.columnEntityNameHeader.selectAll(".rTableColGroup").data(e.columnGroups)).enter().append("div").classed("rTableColGroup",!0),(i=(n=t.selectAll(".relationshipTableEntityName").data(function(e){return e.columns})).enter().append("div").classed("relationshipTableEntityName rTableEntityCol",!0).append("div").classed("relationshipTableEntityNameText",!0).append("div").classed("rtRotate",!0)).append("span").classed("entityDot",!0),i.append("span").classed("entityName",!0),(i=n.select(".relationshipTableEntityNameText").select(".rtRotate")).select(".entityName").text(function(e){return e.name}).attr("title",function(e){return e.name}),i.select(".entityDot").attr("class",function(e){return"entityDot "+e.color}),n.classed("odd",function(e){return e.isOdd}).classed("last",function(e){return e.isLast}),n.exit().remove(),t.exit().remove()):this.columnEntityNameHeader&&(this.columnEntityNameHeader.remove(),this.columnEntityNameHeader=null)},ATRelationshipViewTablePainter.prototype.updateEventLayer=function(e){var t,n,i,a,l,r,s,o,d,p,c,h,u,v,E,T=this,m=this.relationshipView.timelineView.showEventDate;(n=(i=(t=this.eventLayer.selectAll(".relationshipTableLane").data(_.values(e.lanes))).enter().append("div").classed("relationshipTableLane",!0)).append("div").classed("relationshipTableLaneHeader  rTableRow",!0)).append("div").classed("relationshipTableLaneHeaderText  rTableEventCol",!0),n.append("div").classed("relationshipEntityNameZeroColumns",!0),i.append("div").classed("relationshipTableLaneTopPadding",!0),u=i.append("div").classed("relationshipTableLaneEventsWrapper",!0),i.append("div").classed("relationshipTableLaneBottomPadding",!0),(o=u.append("div").classed("relationshipTableLaneEmptyRow",!0).classed("rTableRow",!0)).append("div").classed("relationshipTableLaneEmptyDiv",!0).classed("rTableEventCol",!0),o.append("div").classed("relationshipEntityNameZeroColumns",!0),window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE?((p=t.select(".relationshipTableLaneHeader").selectAll(".relationshipTableEventHeaderColumnGroup").data(e.columnGroups)).enter().append("div").classed("relationshipTableEventHeaderColumnGroup rTableColGroup",!0),(c=p.selectAll(".relationshipTableEventHeaderColumn").data(function(e){return e.columns})).enter().append("div").classed("relationshipTableEventHeaderColumn rTableEntityCol",!0),c.exit().remove(),p.exit().remove()):t.select(".relationshipTableLaneHeader").selectAll(".relationshipTableEventHeaderColumnGroup").remove(),t.select(".relationshipTableLaneHeaderText").text(function(e){return e.entityName}),t.select(".relationshipTableLaneTopPadding").style("height",function(e){return e.topPadding+"px"}),t.select(".relationshipTableLaneBottomPadding").style("height",function(e){return e.bottomPadding+"px"}),t.select(".relationshipTableLaneEmptyRow").style("display",function(e){return e.empty?null:"none"}),t.select(".relationshipTableLaneEmptyDiv").html(function(e){return e.emptyText}),l=(a=window.mainApp.canvasManager.screenMode===ATScreenMode.NARROW_SCREEN_MODE?t.select(".relationshipTableLaneEventsWrapper").selectAll(".relationshipTableEventRow").data(function(e){return e.nodes}):t.select(".relationshipTableLaneEventsWrapper").selectAll(".relationshipTableEventRow").data(function(e){return e.nodes},function(e){return e.id})).enter().append("div").attr("id",function(e){return"rTableRow-"+e.laneId+"-x-"+e.id}).classed("relationshipTableEventRow rTableRow",!0).classed("odd",function(e){return e.isOdd}),window.mainApp.canvasManager.screenMode,ATScreenMode.NARROW_SCREEN_MODE,(r=l.append("div").classed("relationshipTableEventData rTableEventCol",!0)).append("svg").classed("editModeCheckbox",!0).append("use").attr("xlink:href","#checkbox"),r.append("div").classed("relationshipTableEventDot",!0),r.append("svg").classed("relationshipTableParentArrow",!0).on("click",function(e){window.mainApp.timelineView.toggleShowChildNodes(e.id,e.laneId)}).append("use").attr("xlink:href","#right"),(s=r.append("div").classed("relationshipTableEventDataWrap",!0)).append("div").classed("eventTitle",!0),s.append("div").classed("eventDate",!0),l.append("div").classed("relationshipEntityNameZeroColumns",!0),a.attr("id",function(e){return"rTableRow-"+e.laneId+"-x-"+e.id}).classed("odd",function(e){return e.isOdd}).classed("selected",function(e){return e.selected}),window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE&&a.style("transform",function(e){return"translateY("+applyPhysicalScale(e.absoluteTop,T.scaleFactor)+"px)"}),(d=a.select(".relationshipTableEventData").classed("isParent",function(e){return e.isParent}).classed("indent1",function(e){return 1===e.nestingLevel}).classed("indent2",function(e){return 2===e.nestingLevel}).classed("indent3",function(e){return 3===e.nestingLevel}).classed("indent4",function(e){return 4===e.nestingLevel}).classed("indent5",function(e){return 5===e.nestingLevel}).classed("indent6",function(e){return 6===e.nestingLevel}).classed("indent7",function(e){return 7===e.nestingLevel}).classed("indent8",function(e){return 8===e.nestingLevel})).select(".relationshipTableParentArrow").classed("showChildNodes",function(e){return e.showChildNodes}),d.select(".editModeCheckbox").select("use").attr("xlink:href",function(e){return e.selected?"#checkboxTick":"#checkbox"}),d.select(".relationshipTableEventDot").attr("class",function(e){return"relationshipTableEventDot "+e.color}),d.select(".eventTitle").text(function(e){return e.displayTitle}),d.select(".eventDate").text(function(e){return e.dateString}).style("display",m?null:"none"),window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE?((v=t.select(".relationshipTableLaneEmptyRow").selectAll(".relationshipTableEmptyRowColumnGroup").data(e.columnGroups)).enter().append("div").classed("relationshipTableEmptyRowColumnGroup rTableColGroup",!0),(E=v.selectAll(".relationshipTableEmptyRowColumn").data(function(e){return e.columns})).enter().append("div").classed("relationshipTableEmptyRowColumn rTableEntityCol",!0),E.exit().remove(),v.exit().remove(),(p=a.selectAll(".relationshipTableEventIntersectionGroup").data(function(e){return e.intersectionGroups})).enter().append("div").classed("relationshipTableEventIntersectionGroup  rTableColGroup",!0),(h=(c=p.selectAll(".relationshipTableEventIntersection").data(function(e){return e.intersections})).enter().append("div").classed("relationshipTableEventIntersection",!0)).append("div").classed("relationshipEventIntersectionDiv rTableEntityCol",!0).append("span"),h.append("div").classed("relationshipTableEventIntersectionAge",!0),c.attr("title",function(e){return e.role?e.role+(e.age?": "+e.age:""):null}).select(".relationshipEventIntersectionDiv").attr("class",function(e){return"relationshipEventIntersectionDiv "+(e.icon?e.icon+" ":" ")+(e.color?e.color:"")}).select("span").text(function(e){return e.role?e.role.charAt(0):null}),c.select(".relationshipTableEventIntersectionAge").text(function(e){return e.shortAge}),c.exit().remove(),p.exit().remove(),this.eventLayer.selectAll(".relationshipEntityNameZeroColumns").style("display",e.columnGroups.length>0?"none":null),d3.selectAll(".rTableRow").style("width",this.relationshipView.rangeX.max+"px")):(a.selectAll(".relationshipTableEventIntersectionGroup").remove(),d3.selectAll(".rTableRow").style("width",null),a.style("height",null),this.eventLayer.selectAll(".relationshipEntityNameZeroColumns").remove()),a.exit().remove(),t.exit().remove()},ATRelationshipViewTablePainter.prototype.scrollEventLayer=function(e){var t,n,i,a,l,r,s,o,d=this,p=this.relationshipView.timelineView.showEventDate;t=this.eventLayer.selectAll(".relationshipTableLane").data(_.values(e.lanes)),window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE?((r=t.select(".relationshipTableLaneHeader").selectAll(".relationshipTableEventHeaderColumnGroup").data(e.columnGroups)).enter().append("div").classed("relationshipTableEventHeaderColumnGroup rTableColGroup",!0),(s=r.selectAll(".relationshipTableEventHeaderColumn").data(function(e){return e.columns})).enter().append("div").classed("relationshipTableEventHeaderColumn rTableEntityCol",!0),s.exit().remove(),r.exit().remove()):t.select(".relationshipTableLaneHeader").selectAll(".relationshipTableEventHeaderColumnGroup").remove(),i=(n=t.select(".relationshipTableLaneEventsWrapper").selectAll(".relationshipTableEventRow").data(function(e){return e.nodes},function(e){return e.id})).enter().append("div").attr("id",function(e){return"rTableRow-"+e.laneId+"-x-"+e.id}).classed("relationshipTableEventRow rTableRow",!0).classed("odd",function(e){return e.isOdd}).classed("selected",function(e){return e.selected}).style("width",this.relationshipView.rangeX.max+"px"),window.mainApp.canvasManager.screenMode,ATScreenMode.NARROW_SCREEN_MODE,(a=i.append("div").classed("relationshipTableEventData rTableEventCol",!0).classed("isParent",function(e){return e.isParent}).classed("indent1",function(e){return 1===e.nestingLevel}).classed("indent2",function(e){return 2===e.nestingLevel}).classed("indent3",function(e){return 3===e.nestingLevel}).classed("indent4",function(e){return 4===e.nestingLevel}).classed("indent5",function(e){return 5===e.nestingLevel}).classed("indent6",function(e){return 6===e.nestingLevel}).classed("indent7",function(e){return 7===e.nestingLevel}).classed("indent8",function(e){return 8===e.nestingLevel})).append("svg").classed("editModeCheckbox",!0).append("use").attr("xlink:href",function(e){return e.selected?"#checkboxTick":"#checkbox"}),a.append("div").attr("class",function(e){return"relationshipTableEventDot "+e.color}),a.append("svg").classed("relationshipTableParentArrow",!0).classed("showChildNodes",function(e){return e.showChildNodes}).on("click",function(e){window.mainApp.timelineView.toggleShowChildNodes(e.id,e.laneId)}).append("use").attr("xlink:href","#right"),(l=a.append("div").classed("relationshipTableEventDataWrap",!0)).append("div").classed("eventTitle",!0).text(function(e){return e.displayTitle}),l.append("div").classed("eventDate",!0).text(function(e){return e.dateString}).style("display",p?null:"none"),window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE?((r=i.selectAll(".relationshipTableEventIntersectionGroup").data(function(e){return e.intersectionGroups})).enter().append("div").classed("relationshipTableEventIntersectionGroup  rTableColGroup",!0),(o=(s=r.selectAll(".relationshipTableEventIntersection").data(function(e){return e.intersections})).enter().append("div").classed("relationshipTableEventIntersection",!0).attr("title",function(e){return e.role?e.role+(e.age?": "+e.age:""):null})).append("div").attr("class",function(e){return"relationshipEventIntersectionDiv "+(e.icon?e.icon+" ":" ")+(e.color?e.color:"")}).append("span").text(function(e){return e.role?e.role.charAt(0):null}),o.append("div").classed("relationshipTableEventIntersectionAge",!0).text(function(e){return e.shortAge}),s.exit().remove(),r.exit().remove()):n.selectAll(".relationshipTableEventIntersectionGroup").remove(),window.mainApp.canvasManager.screenMode!==ATScreenMode.NARROW_SCREEN_MODE?n.style("transform",function(e){return"translateY("+applyPhysicalScale(e.absoluteTop,d.scaleFactor)+"px)"}).style("height",function(e){return applyPhysicalScale(e.totalRect.size.height,d.scaleFactor)-1+"px"}):n.style("transform",null),n.exit().remove()},module.exports=ATRelationshipViewTablePainter;

},{"../../../lib/hilitor2":7,"../../controller/ATDisplayConstants":16,"../../utils/ATPoint":46,"../../utils/ATUtilities":51,"../ios/ATScreenMode":191,"d3":320,"jquery":331,"lodash":333}],201:[function(require,module,exports){
var $=require("jquery"),d3=require("d3"),_=require("lodash"),Backbone=require("backbone"),ATUtilities=require("../../utils/ATUtilities"),Opentip=require("../../../lib/opentip"),ATFloatingMessageControl=require("../ios/ATFloatingMessageControl"),Hammer=require("hammerjs"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),ATTimelineViewPainter=require("./ATTimelineViewPainter"),ATPoint=require("../../utils/ATPoint"),ATLine=require("../../utils/ATLine"),ATRect=require("../../utils/ATRect"),ATBounds=require("../../utils/ATBounds"),ATSize=require("../../utils/ATSize"),ATViewMode=require("../ATViewMode"),ATEventTextCalculator=require("./ATEventTextCalculator"),ATEmptyGuidString=require("../../model/ATEmptyGuidString"),ATFilterResult=require("../../model/ATFilterResult"),dhtmlXMenuObject=require("../../../lib/dhtmlxmenu"),expandedContentPreambleHtml=require("./templates/expandedEventContentPreamble.html"),expandedContentPostambleHtml=require("./templates/expandedEventContentPostamble.html"),expandedImageHtml=require("./templates/expandedEventImage.html"),expandedPropertyBooleanHtml=require("./templates/expandedEventPropertyBoolean.html"),expandedPropertyNumberHtml=require("./templates/expandedEventPropertyNumber.html"),expandedPropertyParagraphHtml=require("./templates/expandedEventPropertyParagraph.html"),expandedPropertyPercentageHtml=require("./templates/expandedEventPropertyPercentage.html"),expandedPropertyStringHtml=require("./templates/expandedEventPropertyString.html"),expandedRoleListHtml=require("./templates/expandedEventRoleList.html"),expandedTagListHtml=require("./templates/expandedEventTagList.html"),expandedLinkListHtml=require("./templates/expandedEventLinkList.html"),expandedLinkAttachmentHtml=require("./templates/expandedEventAttachmentList.html"),ATTimelineView=Backbone.View.extend({initialize:function(){var e,t=this,i=this.$el.attr("id"),n=$("html").css("font-size");this.timeline=this.model.get("timeline"),this.d3El=d3.select("#"+i),this.$contentUnderHeader=this.$("#timelineContentUnderHeader"),this.viewMode=ATViewMode.RELATIONSHIP_VIEW,this.renderFlags={viewport:!0,data:!0,selection:!1,calculate:!0},n&&(this.physicalScaleFactor=parseFloat(n)/10),this.physicalScaleFactor||(this.physicalScaleFactor=1),this.layers={},this.filterBarDiv=d3.select("#filterBarDiv"),this.bookmarksDiv=d3.select("#bookmarks"),this.layers.timeline_content_svg=this.d3El.selectAll(".timelineContent"),this.layers.lane_nav_svg=this.d3El.select(".laneNavSvg"),this.layers.header_svg=this.d3El.select(".header"),this.layers.contextBar_svg=this.d3El.select(".contextBar"),this.layers.context_layer=this.d3El.select(".contextLayer"),this.layers.context_lens_layer=this.d3El.select(".contextLens"),this.layers.lifetime_bg_layer=this.d3El.select(".lifetime_bg_layer"),this.layers.bg_layer=this.d3El.select(".bg_layer"),this.layers.dependency_layer=this.d3El.select(".dependency_layer"),this.layers.event_layer=this.d3El.select(".event_layer"),this.layers.lane_overlay_layer=this.d3El.select(".laneOverlay"),this.holdRenderingCount=1,this.moreTemplate="<div></div>",this.eventTextCalculator=new ATEventTextCalculator,this.appendMeasurementDiv(),e=this.canvasSize(),this.viewport=new ATRect(0,0,e.width,e.height),this.rangeX=new ATBounds(-Number.MAX_VALUE,Number.MAX_VALUE),this.rangeY=new ATBounds(0,350),this.scrollBounceStartX=null,this.scrollMayBounceAtLeft=!1,this.scrollMayBounceAtRight=!1,this.bounceRangeX=new ATBounds(-Number.MAX_VALUE,Number.MAX_VALUE),this.scrollBounceMaxOver=200,this.scrollBounceTreacleFactor=4;this.maximumRangeTS=new ATBounds(-632448e13,632448e13),this.maximumUnitScale=316224e10,this.minimumUnitScale=1,this.minMarkerSeparation=200,this.calculateContextScale(),this.contextLeftTS=0,this.contextLeftLensPixel=0,this.contextRightLensPixel=0,this.dragStartPos=null,this.dragBoxBounds=null,this.grabScrollMoveOrigin=null,this.grabScrollViewOrigin=null,this.timelinePainter=new ATTimelineViewPainter(this),this.listenTo(this.model,"selectionChanged",function(){t.renderFlags.selection=!0,t.renderIfRequired(),window.mainApp.enableToolbarItemsForSelection()}),this.listenTo(this.timeline,"rangeConversionChanged",function(){t.calculateContextScale(),t.renderFlags.data=!0,t.renderFlags.viewport=!0}),this.listenTo(this.model,"change:unitScale",function(){t.calculateContextScale(),window.mainApp.unitScaleChanged(),t.renderFlags.calculate=!0,t.renderFlags.zoom=!0}),this.listenTo(this.timeline,"change:bookmarks",function(){t.renderFlags.data=!0}),this.listenTo(this.timeline,"change:filters",function(){t.renderFlags.data=!0}),this.listenTo(this.model.lanes,"add remove",function(){t.renderFlags.data=!0}),this.listenTo(this.timeline.get("events"),"add remove",function(){t.renderFlags.data=!0}),this.listenTo(this.model,"childNodeAdded",function(){t.renderFlags.data=!0}),this.listenTo(this.model,"laneCollapsed",function(){t.renderFlags.calculate=!0,t.renderFlags.data=!0,t.renderIfRequired()}),this.listenTo(this.timeline,"nodeLayoutRequired",function(){t.renderFlags.calculate=!0}),this.listenTo(this.model,"nodeLayoutChanged",this.calcScrollLimits.bind(this)),window.addEventListener("resize",this.resizeWindow.bind(this),!1),this.el.addEventListener("wheel",this.mouseWheel.bind(this),!1),this.el.addEventListener("contextmenu",function(e){window.ApplicationInterface&&(t.defaultContextMenuMouseLocation=new ATPoint(e.clientX,e.clientY),window.ApplicationInterface.showDefaultContextMenu(window.timelineDocumentId,t.timeline.selectedEvents.length))}),this.eventDrag=d3.behavior.drag().on("dragstart",this.eventNodeDragStarted.bind(this)).on("drag",this.eventNodeDragged.bind(this)).on("dragend",this.eventNodeDragEnded.bind(this)),this.platform=null,this.editModeEnabled=!1,this.adjustWindowScale()},configureInteraction:function(e){this.platform=e,"ios"===e?this._configureMobileInteraction():this._configureDesktopInteraction()},editModeToggled:function(e){this.editModeEnabled=e,e?this.timelinePainter.enableEventDrag():this.timelinePainter.disableEventDrag()},_configureMobileInteraction:function(){var e=this,t=this.$el[0],i=new Hammer.Manager(t),n=new Hammer.Press({time:500}),s=new Hammer.Tap,o=function(t){var i=e.rawMousePositionToScaledCanvasPosition(new ATPoint(t.center.x,t.center.y));return e.relativeToAbsolutePoint(i)},r=function(t){return e.model.eventNodeForAbsolutePosition(t,!1)};i.add([n,s]),i.on("tap",function(t){var i=o(t),n=r(i);$(t.target).closest(".parentArrowSpan").length>0||(n?e.timeline.toggleEventSelectionWithID(n.id):e.editModeEnabled||e.timeline.clearSelection())}),i.on("press",function(t){var i;window.mainApp.canvasManager.editModeActivated?window.mainApp.canvasManager.showEditControl(t):(window.mainApp.canvasManager.showEditBar(!0),(i=r(o(t)))?e.timeline.selectEventWithID(i.id):e.timeline.clearSelection())}),this.timelinePainter.disableEventDrag()},_configureDesktopInteraction:function(){var e,t=this,i=this.$el[0],n=new Hammer.Manager(i),s=new Hammer.Pinch,o=new Hammer.Pan,r=new Hammer.Tap({time:49});this.d3El.on("dblclick",this.dblClickHandler.bind(this)),n.add([s,o,r]),o.requireFailure(s),n.on("tap",function(e){var i=t.rawMousePositionToScaledCanvasPosition(new ATPoint(e.center.x,e.center.y)),n=t.relativeToAbsolutePoint(i),s=t.model.eventNodeForAbsolutePosition(n,!0);"mouse"!==e.pointerType&&(t.stopFlickScroll(),s?t.timeline.selectEventWithID(s.id):t.timeline.clearSelection())}),n.on("pinch",function(e){var i=e.scale;"mouse"!==e.pointerType&&(t.stopFlickScroll(),t.disablePan=!0,i>1.5?i=1.5:i<.75&&(i=.75),t.zoomWithMagnification(i,e.center.x,e.center.y),t.enablePanTimeout&&window.clearTimeout(t.enablePanTimeout),t.enablePanTimeout=window.setTimeout(function(){t.disablePan=!1},100))}),n.on("panstart",function(e){t.stopFlickScroll(),t.flingDeltas=[]}),n.on("panmove",function(e){t.stopFlickScroll(),"mouse"!==e.pointerType&&(t.disablePan||t.grabScrolled(e.deltaX,e.deltaY),t.flingDeltas.push({time:e.deltaTime,x:e.deltaX,y:e.deltaY}),t.flingDeltas.length>5&&t.flingDeltas.shift())}),n.on("panend",function(e){var i,n,s,o,r,a,l,h,d,c,g;if("mouse"!==e.pointerType&&(t.grabScrollEnded(),t.flingDeltas&&!(t.flingDeltas.length<2))){for(i=t.flingDeltas.pop(),n=t.flingDeltas[0],s=t.flingDeltas.pop(),o=t.flingDeltas.pop();i.time-s.time<15&&o;)s=o,o=t.flingDeltas.pop();r=Math.abs(i.x-s.x)/(i.time-s.time),a=Math.abs(i.y-s.y)/(i.time-s.time),l=Math.abs(i.x-n.x)/(i.time-n.time),h=Math.abs(i.y-n.y)/(i.time-n.time),d=800*Math.min(r,l)*(i.x>s.x?1:-1),c=800*Math.min(a,h)*(i.y>s.y?1:-1),t.flingDeltas=[],(d>60||d<-60||c>60||c<-60)&&(t.flickScrollAmplitude={x:d,y:c},t.flickScrollStartTimestamp=Date.now(),g=t.viewport.origin.copy(),t.flickScrollTimer=d3.timer(function(e){var i,n,s,o=d3.ease("exp-out");return e>1e3||!t.flickScrollAmplitude.x&&!t.flickScrollAmplitude.y?(t.stopFlickScroll(),!0):(i=o(e/1e3),n=-t.flickScrollAmplitude.x*i,s=-t.flickScrollAmplitude.y*i,t.scrollTopLeftToPoint(g.x+n,g.y+s),!1)}))}}),n.on("pancancel",function(e){"mouse"!==e.pointerType&&t.grabScrollEnded()}),e=d3.behavior.drag().on("dragstart",this.viewDragStarted.bind(this)).on("drag",this.viewDragged.bind(this)).on("dragend",this.viewDragEnded.bind(this)),this.d3El.call(e),this.laneDrag=d3.behavior.drag().on("dragstart",this.laneDragStarted.bind(this)).on("drag",this.laneDragged.bind(this)).on("dragend",this.laneDragEnded.bind(this)),this.verticalScrollDrag=d3.behavior.drag().on("dragstart",this.verticalScrollDragStarted.bind(this)).on("drag",this.verticalScrollDragged.bind(this)).on("dragend",this.verticalScrollDragEnded.bind(this)),this.contextLensDrag=d3.behavior.drag().on("dragstart",this.contextLensDragStarted.bind(this)).on("drag",this.contextLensDragged.bind(this)).on("dragend",this.contextLensDragEnded.bind(this)),this.timelinePainter.enableEventDrag()},editModeCheckboxClicked:function(e){this.timeline.toggleEventSelectionWithID(e.id)},setViewMode:function(e){this.holdRendering(),this.viewMode=e,this.d3El.style("display",e===ATViewMode.TIMELINE_VIEW?null:"none"),e===ATViewMode.TIMELINE_VIEW&&this.adjustWindowScale(),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},setRelationshipView:function(e){this.relationshipView=e,e.setTimelineView(this),e.physicalScaleFactor=this.physicalScaleFactor},calcScrollLimits:function(){var e=this.model.findEarliestEventNode(),t=this.model.findLatestEventNode(!0);e&&t?(this.bounceRangeX.min=e.get("startPixel")-this.viewport.size.width/2,this.bounceRangeX.max=t.get("startPixel")+t.get("markerRect").size.width-this.viewport.size.width/2):(this.bounceRangeX.min=-Number.MAX_VALUE,this.bounceRangeX.max=Number.MAX_VALUE),"restrict"===this.scrollingBehaviour?(this.rangeX.min=this.bounceRangeX.min-this.viewport.size.width/2,this.rangeX.max=this.bounceRangeX.max+3*this.viewport.size.width/2):this.model.get("unitScale")&&(this.rangeX=new ATBounds(this.maximumRangeTS.min/this.model.get("unitScale"),this.maximumRangeTS.max/this.model.get("unitScale")))},setDisplayTemplateSettings:function(e){var t="",i=/LABEL/g,n=e.size/100,s=!1;this.holdRendering(),s=this.showEventId!==e.showEventId||this.showEventDate!==e.showEventDate||this.showDurationInTitle!==e.showDurationInTitle,this.showEventId=e.showEventId,this.showDurationInTitle=e.showDurationInTitle,this.showEventDate=e.showEventDate,this.showTodayLine=e.showTodayLine,this.showEventImage=!0,this.skin=e.skin,this.scrollingBehaviour=window.isAeonWebExport?"restrict":e.scrollingBehaviour,d3.select("body").classed("dark","dark"===this.skin).classed("light","light"===this.skin).classed("writer","writer"===this.skin).classed("ocean","ocean"===this.skin).classed("borealis","borealis"===this.skin).classed("print","print"===this.skin).classed("ios_blue","ios_blue"===this.skin).classed("ios_dark","ios_dark"===this.skin).classed("ios_light","ios_light"===this.skin).classed("ios_red","ios_red"===this.skin).classed("ios_green","ios_green"===this.skin),this.timelinePainter.skinChanged(),this.moreInfoColumnCount=0,e.moreInfoLeftColumn.length>0&&(this.moreInfoColumnCount++,t+=expandedContentPreambleHtml,_.each(e.moreInfoLeftColumn,function(e){var n;n=(n="percentage"===e.type?expandedPropertyPercentageHtml:"multitext"===e.type||"richtext"===e.type?expandedPropertyParagraphHtml:"role"===e.type?expandedRoleListHtml:"number"===e.type||"currency"===e.type||"decimal"===e.type?expandedPropertyNumberHtml:"boolean"===e.type?expandedPropertyBooleanHtml:"image"===e.type?expandedImageHtml:"tags"===e.type?expandedTagListHtml:"links"===e.type?expandedLinkListHtml:"attachments"===e.type?expandedLinkAttachmentHtml:expandedPropertyStringHtml).replace(i,e.name),t+=n}),t+=expandedContentPostambleHtml),e.moreInfoRightColumn.length>0&&(this.moreInfoColumnCount++,t+=expandedContentPreambleHtml,_.each(e.moreInfoRightColumn,function(e){var n;n=(n="percentage"===e.type?expandedPropertyPercentageHtml:"multitext"===e.type||"richtext"===e.type?expandedPropertyParagraphHtml:"role"===e.type?expandedRoleListHtml:"number"===e.type||"currency"===e.type||"decimal"===e.type?expandedPropertyNumberHtml:"boolean"===e.type?expandedPropertyBooleanHtml:"image"===e.type?expandedImageHtml:"tags"===e.type?expandedTagListHtml:"links"===e.type?expandedLinkListHtml:"attachments"===e.type?expandedLinkAttachmentHtml:expandedPropertyStringHtml).replace(i,e.name),t+=n}),t+=expandedContentPostambleHtml),this.setMoreTemplate(t),s&&this.timeline.get("events").each(function(e){e.displayTitleSettingsChanged()}),n!==this.physicalScaleFactor&&(this.physicalScaleFactor=n,this.relationshipView&&(this.relationshipView.physicalScaleFactor=n),this.adjustWindowScale(),window.mainApp.isIos&&window.mainApp.canvasManager.windowResized()),this.calcScrollLimits(),this.renderFlags.calculate=!0,this.releaseRendering()},setMoreTemplate:function(e){this.holdRendering(),this.oldMoreTemplate=e,this.moreTemplate=_.template(e),this.timeline.get("events").each(function(e){e.displayTemplateChanged()}),_.each(this.model.lanes.models,function(e){_.each(e.nodes.models,function(e){e.displayTemplateChanged()})}),this.releaseRendering()},holdRendering:function(){this.holdRenderingCount++},releaseRendering:function(){this.holdRenderingCount--,this.holdRenderingCount<=0&&(this.renderIfRequired(),this.holdRenderingCount=0)},setRenderFlag:function(e){this.renderFlags[e]=!0},renderIfRequired:function(){this.holdRenderingCount>0||(_.isEmpty(this.renderFlags)||(this.calculateIfRequired(),this.render(this.renderFlags)),this.renderFlags={},window.setTimeout(function(){$("#loadingDiv").addClass("done")},200))},calculateIfRequired:function(){var e=this;this.renderFlags.calculate&&(this.model.lanes.each(function(t){t.relationshipUpdatePending&&t.updateRelationshipNodes(),e.calcNodesIfRequired(t.nodes.models)}),this.model.calculateNodes(),this.renderFlags=_.omit(this.renderFlags,"calculate"),this.renderFlags.data=!0,window.setTimeout(function(){window.mainApp&&window.mainApp.sendAllDimensionsToAppInterface()},1))},calcNodesIfRequired:function(e){var t=this;this.eventTextCalculator.calculateSizes(),_.each(e,function(e){!window.mainApp.isIos&&e.calcBigTextRequired&&e.calcEventTextRequired?t.calcEventTextSize(e):e.calcRectsRequired&&e.calcRects(),t.calcNodesIfRequired(e.childNodes.models)})},pruneData:function(){var e,t,i,n,s,o,r,a,l,h=this,d=this.model,c=d.displayLanes.length,g=d.displayLanes[c-1],u=this.viewport,v=d.dependencyPaths.length,m=g.top+g.height,p=c>1&&m>u.size.height,w=d.get("timeline").get("events").models,f=w.length,T=null,x=null,S=p?d.navigationLanes:[],D=[],E=[],P=[];for(TimelineDisplayConstants.scrollKnobXPosition=p?TimelineDisplayConstants.scrollKnobDefaultXPosition:TimelineDisplayConstants.scrollKnobNoLaneNavXPosition,TimelineDisplayConstants.scrollTrackThickness=p?TimelineDisplayConstants.scrollTrackDefaultThickness:TimelineDisplayConstants.scrollTrackNoLaneNavThickness,D=_.map(d.displayLanes,function(e){var t=_.clone(e),i=e.top;return e.top<=u.bottom()&&e.top+e.height>=u.top()?t.nodes=_.filter(t.nodes,function(e){var t,n,s,o,r=e.totalRect,a=e.markerRect,l=e.childRect;return t=new ATRect(r.origin.x,r.origin.y+i,r.size.width,r.size.height),!!(t=l?new ATRect(t.origin.x,t.origin.y,Math.max(t.size.width,l.size.width),t.size.height+l.size.height):t).overlaps(u)&&(e.selected=e.original.get("selected"),!h.isExport&&t.size.width>TimelineDisplayConstants.eventOptimiseMaxPolygonWidth?(s=t.origin.x+a.right())<u.right()?(n=(o=h.absoluteToRelativePoint(new ATPoint(s,0))).x-TimelineDisplayConstants.eventOptimiseFurthestOffscreen,e.widthAdjustToOptimise=n-a.size.width,e.positionAdjustToOptimise=-e.widthAdjustToOptimise,e.translateMarkerX=a.size.width+e.widthAdjustToOptimise-TimelineDisplayConstants.eventOptimiseMaxPolygonWidth-TimelineDisplayConstants.eventMarkerOffsetFromBoundsLeft):(e.widthAdjustToOptimise=TimelineDisplayConstants.eventOptimiseMaxPolygonWidth-a.size.width,(o=h.absoluteToRelativePoint(new ATPoint(t.origin.x,0))).x<TimelineDisplayConstants.eventOptimiseFurthestOffscreen?e.positionAdjustToOptimise=TimelineDisplayConstants.eventOptimiseFurthestOffscreen-o.x:e.positionAdjustToOptimise=0,e.translateMarkerX=0):(e.positionAdjustToOptimise=0,e.widthAdjustToOptimise=0,e.translateMarkerX=0),!0)}):t.nodes=[],t.lifetimeMarks=h.lifetimeMarksForLaneBetweenStartAndStopPixel(e.original,h.viewport.left()+e.marginForLane,h.viewport.right(),h.viewport.left()+e.marginForLane),t}),e=0;e<v;e++)(t=d.dependencyPaths[e]).startPt.x<u.left()&&t.endPt.x<u.left()||t.startPt.x>u.right()&&t.endPt.x>u.right()||t.startPt.y<u.top()&&t.endPt.y<u.top()||t.startPt.y>u.bottom()&&t.endPt.y>u.bottom()||t.node1.get("lane").get("collapsed")||E.push({name:t.name,start:t.startPt,path:t.path,color:t.node1.get("event").displayColor()});for(this.calculateContextScale(),a=this.contextLeftTS+this.viewport.size.width*this.contextUnitScale,i=0;i<f;i++)(s=w[i]).get("endTS")>=this.contextLeftTS&&s.get("startTS")<=a&&s.get("filterResult")!==ATFilterResult.NO_MATCH&&((l=(s.get("startTS")-this.contextLeftTS)/this.contextUnitScale)<-10&&(l=-10),(n=(s.get("endTS")-this.contextLeftTS)/this.contextUnitScale)>this.viewport.size.width+10&&(n=this.viewport.size.width+10),P.push({id:s.id,startPixel:l,stopPixel:n,color:s.displayColor()}));return o=this.headerLabelsBetweenStartAndStopPixel(this.viewport.origin.x,this.viewport.right()),r=this.contextLabelsBetweenTimestamps(this.contextLeftTS,a),this.showTodayLine&&(x=(T=this.timeline.rangeConversion.nowTimestamp())?T/this.model.get("unitScale"):null),{lanes:D,dependencyPaths:E,navigationLanes:S,headerData:o,contextLabels:r,contextDots:P,bookmarks:this.model.get("timeline").get("bookmarks"),filters:this.model.get("timeline").get("filters"),nowXPosition:x}},contextLabelsBetweenTimestamps:function(e,t){var i,n=this,s=this.contextUnitScale;return this.timeline.rangeConversion?(i=this.timeline.rangeConversion.labelsBetweenBounds(e,t,s,this.contextMarkers.mainMarkerSpacing,this.contextMarkers.mainMarkerFormat),_.each(i,function(e){e.xPosition=ATUtilities.floatToInt(e.xPosition-n.contextLeftTS/s)}),i):[]},lifetimeMarksForLaneBetweenStartAndStopPixel:function(e,t,i,n){var s,o,r,a=this.model.get("unitScale"),l=t*a,h=i*a,d=e.get("entity"),c=d.get("hasStart"),g=d.get("hasStop");return this.timeline.rangeConversion?(r="date"===this.timeline.rangeConversion.type?this.headerMarkers.subMarkerSpacing.copy():this.headerMarkers.subMarkerSpacing,c&&(s=d.get("startTS")),g&&(o=d.get("stopTS")),this.timeline.rangeConversion.lifetimeMarks(l,h,a,c,s,g,o,r)):[]},lifetimeBoundsForLane:function(e){var t=this.model.get("unitScale"),i=e.get("entity"),n=i.get("hasStart"),s=i.get("hasStop"),o=0,r=0;return n&&(o=e.get("entity").get("startTS")/t),s&&(r=e.get("entity").get("stopTS")/t),{hasStart:n,start:o,hasStop:s,stop:r}},headerLabelsBetweenStartAndStopPixel:function(e,t){var i=this.model.get("unitScale"),n=Math.round(e*i),s=Math.round(t*i),o={labels:[],sublabels:[]};return this.timeline.rangeConversion&&(o.labels=this.timeline.rangeConversion.labelsBetweenBounds(n,s,i,this.headerMarkers.mainMarkerSpacing,this.headerMarkers.mainMarkerFormat,this.headerMarkers.endMarkerFormat),o.sublabels=this.timeline.rangeConversion.labelsBetweenBounds(n,s,i,this.headerMarkers.subMarkerSpacing,this.headerMarkers.subMarkerFormat)),o},calcRangeMarkerSpacing:function(e,t){return this.timeline.rangeConversion?this.timeline.rangeConversion.calculateMarkerSpacing(e,t):[]},render:function(e){var t,i=this,n=1e3*this.model.get("unitScale");if(this.liveRenderTimeout&&window.clearTimeout(this.liveRenderTimeout),this.viewMode===ATViewMode.TIMELINE_VIEW){if(this.viewport.bottom()>this.rangeY.max&&this.viewport.origin.y>this.rangeY.min)return void this.scrollTopToPoint(Math.max(this.rangeY.min,this.rangeY.max-this.viewport.size.height));if(this.viewport.origin.y<this.rangeY.min)return void this.scrollTopToPoint(this.rangeY.min);t=this.pruneData(this.model),this.timelinePainter.render(t,e),this.showTodayLine&&(this.liveRenderTimeout=window.setTimeout(function(){i.renderFlags.viewport=!0,i.renderIfRequired()},n))}else this.relationshipView&&this.relationshipView.render(e)},addNewLayer:function(e){this.layers[e]=this.d3El.append("g").attr("class",e)},canvasSize:function(){var e=this.$("#timelineContentUnderHeader")[0].getBoundingClientRect();return new ATSize(e.width/this.physicalScaleFactor,e.height/this.physicalScaleFactor)},calculateContextScale:function(){this.contextUnitScale=this.model.get("unitScale")*this.viewport.size.width/TimelineDisplayConstants.contextLensWidth,this.headerMarkers=this.calcRangeMarkerSpacing(this.model.get("unitScale"),this.minMarkerSeparation),this.contextMarkers=this.calcRangeMarkerSpacing(this.contextUnitScale,this.minMarkerSeparation)},roundedDateForPixel:function(e){var t=this.model.get("unitScale"),i=e*t;return this.timeline.rangeConversion.roundedValueForValue(i,t)},centerTimestamp:function(){var e=this.viewport.origin.x+this.viewport.size.width/2,t=this.roundedDateForPixel(e);return _.isNil(t.timestamp)?t:t.timestamp},absoluteToRelativePoint:function(e){return new ATPoint(e.x-this.viewport.origin.x,e.y-this.viewport.origin.y)},relativeToAbsolutePoint:function(e){return new ATPoint(e.x+this.viewport.origin.x,e.y+this.viewport.origin.y)},clientXRightOfSyncBinder:function(e){var t;return window.mainApp.canvasManager.syncBinderVisible?(t=$("#syncBinder").innerWidth(),e-t):e},clientYBelowFilterBar:function(e){return e-this.$el.offset().top},clientYBelowHeader:function(e){return e-this.$("#timelineContentUnderHeader").offset().top},rawMousePositionToScaledCanvasPosition:function(e){var t=new ATPoint(e),i=this.$contentUnderHeader.offset();return t.x=e.x-i.left,t.y=e.y-i.top,t.x/=this.physicalScaleFactor,t.y/=this.physicalScaleFactor,t},rawMousePositionToOffsetFromEdges:function(e){var t={},i=this.$el.offset(),n=this.$el.width(),s=this.$el.height();return t.left=e.x-i.left,t.top=e.y-i.top,t.right=i.left+n-e.x,t.bottom=i.top+s-e.y,t},scrollIncrement:function(e,t){return this.scrollTopLeftToPoint(this.viewport.origin.x+e,this.viewport.origin.y+t)},scrollTopLeftToPoint:function(e,t,i){var n,s;i?(this.viewport.origin.x=e,this.viewport.origin.y=t):(n=new ATBounds(this.rangeX.min,this.rangeX.max-this.viewport.size.width),s=new ATBounds(this.rangeY.min,Math.max(this.rangeY.min,this.rangeY.max-this.viewport.size.height)),this.viewport.origin.x=n.constrain(e),this.viewport.origin.y=s.constrain(t)),this.adjustContextViewport(),this.renderFlags.viewport=!0,this.renderIfRequired()},scrollLeftToPoint:function(e){this.scrollTopLeftToPoint(e,this.viewport.top())},scrollTopToPoint:function(e){this.scrollTopLeftToPoint(this.viewport.left(),e)},scrollTopLeftToUnconstrainedPoint:function(e,t){var i=new ATBounds(this.rangeY.min,this.rangeY.max-this.viewport.size.height);this.viewport.origin.x=e,this.viewport.origin.y=i.constrain(t),this.renderFlags.viewport=!0,this.adjustContextViewport(),this.renderIfRequired()},scrollLeftToUnconstrainedPoint:function(e){this.scrollTopLeftToUnconstrainedPoint(e,this.viewport.top())},setContextLeftTS:function(e){this.contextLeftTS=e,this.adjustContextViewport(),this.renderFlags.viewport=!0,this.renderIfRequired()},adjustContextViewport:function(){var e,t=this.model.get("unitScale"),i=this.viewport.size.width,n=this.viewport.left()*t,s=this.viewport.right()*t;this.contextLeftLensPixel=(n-this.contextLeftTS)/this.contextUnitScale,this.contextRightLensPixel=(s-this.contextLeftTS)/this.contextUnitScale,e=i-this.contextRightLensPixel,this.contextLeftLensPixel<TimelineDisplayConstants.contextLensMinMargin?(this.contextLeftTS=n-TimelineDisplayConstants.contextLensMinMargin*this.contextUnitScale,n=this.viewport.left()*t,s=this.viewport.right()*t,this.contextLeftLensPixel=(n-this.contextLeftTS)/this.contextUnitScale,this.contextRightLensPixel=(s-this.contextLeftTS)/this.contextUnitScale):e<TimelineDisplayConstants.contextLensMinMargin&&(this.contextLeftTS=this.contextLeftTS-(e-TimelineDisplayConstants.contextLensMinMargin)*this.contextUnitScale,n=this.viewport.left()*t,s=this.viewport.right()*t,this.contextLeftLensPixel=(n-this.contextLeftTS)/this.contextUnitScale,this.contextRightLensPixel=(s-this.contextLeftTS)/this.contextUnitScale),window.mainApp&&window.mainApp.scrollPositionChanged()},immediateContextBarReturn:function(){var e=(this.viewport.origin.x+this.viewport.size.width/2)*this.model.get("unitScale")-this.viewport.size.width/2*this.contextUnitScale;this.setContextLeftTS(e)},animateContextBarReturn:function(e,t){var i,n=this;if(!e&&!t)return this.cancelAnimations(),void this.immediateContextBarReturn();i=(this.viewport.origin.x+this.viewport.size.width/2)*this.model.get("unitScale")-this.viewport.size.width/2*this.contextUnitScale,d3.transition().delay(e).duration(t).tween("animatedContextReturn",function(e,t){return function(){var i=d3.interpolateNumber(e,t);return function(e){n.setContextLeftTS(i(e))}}}(this.contextLeftTS,i))},cancelAnimations:function(){d3.transition().delay(0).duration(0).tween("animatedContextReturn",null)},setUnitScale:function(e){var t=e;return isNaN(e)?this.model.get("unitScale"):(e>this.maximumUnitScale&&(t=this.maximumUnitScale),e<this.minimumUnitScale&&(t=this.minimumUnitScale),t<=0&&(t=Math.max(this.minimumUnitScale,100)),this.rangeX=new ATBounds(this.maximumRangeTS.min/t,this.maximumRangeTS.max/t),this.model.set("unitScale",t),t)},zoomWithMagnification:function(e,t,i){var n,s,o=this.rawMousePositionToScaledCanvasPosition(new ATPoint(Number(t),Number(i))),r=o.x,a=o.y,l=r+this.viewport.left(),h=a+this.viewport.top(),d=this.model.get("unitScale"),c=l*d;this.holdRendering(),this.nearestLaneToMouse&&a===this.lastMagnifyMouseY||(this.nearestLaneToMouse=this.model.closestLaneTopToAbsoluteY(h),this.lastMagnifyMouseY=a,this.magnifyMouseOffsetFromLane=h-this.nearestLaneToMouse.get("top")),d=this.setUnitScale(d/Number(e)),this.calculateIfRequired(),n=c/d-r,this.timelinePainter.transitionDuration=0,s=this.nearestLaneToMouse.get("top")+this.magnifyMouseOffsetFromLane,this.scrollTopLeftToPoint(n,s-a),this.animateContextBarReturn(0,0),this.timelinePainter.transitionDuration=this.timelinePainter.defaultTransitionDuration,this.releaseRendering()},zoomToScaleAtPoint:function(e,t,i){var n,s=this.rawMousePositionToScaledCanvasPosition(new ATPoint(Number(t),Number(i))).x;n=(this.viewport.left()+s)*this.model.get("unitScale")/this.setUnitScale(e)-s,this.timelinePainter.transitionDuration=0,this.holdRendering(),this.scrollLeftToUnconstrainedPoint(n),this.immediateContextBarReturn(),this.timelinePainter.transitionDuration=this.timelinePainter.defaultTransitionDuration,this.releaseRendering()},zoomToScale:function(e){var t,i=this.viewport.size.width/2,n=this.viewport.centerX()*this.model.get("unitScale");this.holdRendering(),t=n/this.setUnitScale(e)-i,this.timelinePainter.transitionDuration=0,this.scrollLeftToUnconstrainedPoint(t),this.immediateContextBarReturn(),this.timelinePainter.transitionDuration=this.timelinePainter.defaultTransitionDuration,this.releaseRendering()},zoomToContextLensBounds:function(e,t){var i=this,n=e*this.contextUnitScale+this.contextLeftTS,s=t*this.contextUnitScale+this.contextLeftTS,o=this.model.get("unitScale"),r=(s-n)/this.viewport.size.width;d3.transition().duration(500).tween("animatedZoom",function(e,t,s){return function(){var s=d3.interpolateNumber(e,t),r=d3.interpolateNumber(i.viewport.origin.x*o,n);return function(e){var t=r(e)/s(e);i.holdRendering(),i.zoomToScale(s(e)),i.scrollLeftToPoint(t),i.immediateContextBarReturn(),i.releaseRendering()}}}(o,r))},mouseWheel:function(e){var t=window.mainApp.isWindows&&e.shiftKey&&!e.ctrlKey&&!e.metaKey,i=e.wheelDeltaX||40*-e.deltaX,n=e.wheelDeltaY||40*-e.deltaY,s=t?n:i,o=t?i:n,r=e.clientX,a=e.clientY;return this.mouseWheelWorkaround(s,o,r,a,e.ctrlKey||e.metaKey),e.preventDefault(),!1},nativeGestureStarted:function(){var e=performance.now();this.gestureCallReceivedFromCpp=!0,this.bounceCompleteTime&&this.bounceCompleteTime<e+100&&this.restartBounceTracking()},restartBounceTracking:function(){this.scrollBounceStartX=this.viewport.origin.x,"bounce"===this.scrollingBehaviour?(this.scrollMayBounceAtLeft=this.viewport.origin.x>this.bounceRangeX.min+this.viewport.size.width/8,this.scrollMayBounceAtRight=this.viewport.origin.x+this.viewport.size.width/8<this.bounceRangeX.max):"restrict"===this.scrollingBehaviour?(this.scrollMayBounceAtLeft=!0,this.scrollMayBounceAtRight=!0):(this.scrollMayBounceAtLeft=!1,this.scrollMayBounceAtRight=!1),this.scrollBounceCrossoverTime=null,this.maxWheelInterval=0,this.minAbsDeltaX=1e3,this.blockFurtherScrolling=!1,this.bounceCompleteTime=null},mouseWheelWorkaround:function(e,t,i,n,s){var o,r,a,l,h=performance.now(),d=this.lastWheelTime?h-this.lastWheelTime:1e4,c=e,g=t;if(this.holdRendering(),!1!==i&&!1!==n&&(l=this.rawMousePositionToScaledCanvasPosition(new ATPoint(Number(i),Number(n))),(a=l.x)<0||a>this.viewport.size.width))this.releaseRendering();else{if(s)return this.zoomWithMagnification(g>0?1.2:.8,i,n),void this.releaseRendering();this.maxWheelInterval=Math.max(d,this.maxWheelInterval),this.minAbsDeltaX=Math.min(this.minAbsDeltaX,Math.abs(c)),d>600&&this.restartBounceTracking(),this.lastWheelTime=h,this.blockFurtherScrolling?this.releaseRendering():("bounce"===this.scrollingBehaviour?(this.scrollMayBounceAtLeft=this.scrollMayBounceAtLeft||this.viewport.origin.x>this.bounceRangeX.min+this.viewport.size.width/8,this.scrollMayBounceAtRight=this.scrollMayBounceAtRight||this.viewport.origin.x+this.viewport.size.width/8<this.bounceRangeX.max):"restrict"===this.scrollingBehaviour?(this.scrollMayBounceAtLeft=!0,this.scrollMayBounceAtRight=!0):(this.scrollMayBounceAtLeft=!1,this.scrollMayBounceAtRight=!1),o=this.viewport.origin.x-c,r=this.viewport.origin.y-g,(this.scrollMayBounceAtLeft&&this.viewport.origin.x<this.bounceRangeX.min||this.scrollMayBounceAtRight&&this.viewport.origin.x>this.bounceRangeX.max)&&(this.scrollBounceCrossoverTime||(this.scrollBounceCrossoverTime=h),c/=this.scrollBounceTreacleFactor,this.viewport.origin.x<=this.bounceRangeX.min-this.scrollBounceMaxOver&&(this.blockFurtherScrolling=!0,o=this.bounceRangeX.min-this.scrollBounceMaxOver),this.viewport.origin.x>=this.bounceRangeX.max+this.scrollBounceMaxOver&&(this.blockFurtherScrolling=!0,o=this.bounceRangeX.max+this.scrollBounceMaxOver)),(this.scrollMayBounceAtLeft||this.scrollMayBounceAtRight)&&(this.scrollBounceTimeout&&window.clearTimeout(this.scrollBounceTimeout),this.scrollBounceTimeout=window.setTimeout(this.scrollBounceAsRequired.bind(this),80)),this.scrollTopLeftToPoint(o,r),this.animateContextBarReturn(0,0),this.releaseRendering())}},scrollBounceAsRequired:function(){var e=performance.now(),t=Math.max(e-this.scrollBounceCrossoverTime,500);this.scrollMayBounceAtLeft&&this.viewport.origin.x<this.bounceRangeX.min?this.scrollToPixelXY(this.bounceRangeX.min,null,t):this.scrollMayBounceAtRight&&this.viewport.origin.x>this.bounceRangeX.max&&this.scrollToPixelXY(this.bounceRangeX.max,null,t),this.scrollBounceTimeout=null,this.bounceCompleteTime=e+t},adjustWindowScale:function(){var e=this.canvasSize(),t=Number(10*this.physicalScaleFactor).toFixed(1),i=parseFloat($("html").css("font-size")).toFixed(1);this.viewport=new ATRect(this.viewport.origin.x,this.viewport.origin.y,e.width,e.height),t!==i&&d3.select("html").style("font-size",t+"px"),this.relationshipView&&this.relationshipView.adjustWindowScale(),window.mainApp&&window.mainApp.sendAllDimensionsToAppInterface(),this.adjustSvgScales(),window.setTimeout(this.adjustSvgScales.bind(this),500)},adjustSvgScales:function(){var e=this.canvasSize();this.viewport=new ATRect(this.viewport.origin.x,this.viewport.origin.y,e.width,e.height),this.layers.timeline_content_svg.attr("viewBox","0 0 "+e.width+" "+e.height),this.d3El.select(".laneNavSvgWrap").attr("viewBox","0 0 28 "+e.height),this.layers.header_svg.attr("viewBox","0 0 "+e.width+" "+TimelineDisplayConstants.timeHeaderHeight),d3.select(".contextBarWrap").attr("viewBox","0 0 "+e.width+" "+TimelineDisplayConstants.contextHeight)},resizeWindow:function(e,t){return this.holdRendering(),this.adjustWindowScale(),this.calculateContextScale(),this.immediateContextBarReturn(0,0),this.renderFlags.viewport=!0,this.renderIfRequired(),t||window.mainApp.adjustFilterBar(!1),this.calcScrollLimits(),this.releaseRendering(),e&&e.preventDefault(),!1},clickHandler:function(e){var t=this.rawMousePositionToScaledCanvasPosition(new ATPoint(e.clientX,e.clientY)),i=this.relativeToAbsolutePoint(t),n=this.model.laneForAbsoluteY(i.y);t.x<TimelineDisplayConstants.laneMarginWidth&&Math.abs(i.y-n.get("top"))<20&&this.toggleLane(n.id)},dblClickHandler:function(){var e,t=d3.event,i=isNaN(t.clientX)?new ATPoint(t.touches[0].clientX,t.touches[0].clientY):new ATPoint(t.clientX,t.clientY),n=this.rawMousePositionToScaledCanvasPosition(i),s=this.relativeToAbsolutePoint(n),o=this.model.laneForAbsoluteY(s.y),r=this.model.eventNodeForAbsolutePosition(s,!0),a=this.viewport.size.height;this.model.eventNodeForAbsolutePosition(s,!1)||window.isAeonWebExport||n.y>a||n.x<TimelineDisplayConstants.laneMarginWidth||(e=this.roundedDateForPixel(s.x),window.mainApp.showAddEventModal(e,o.id,r?r.id:ATEmptyGuidString))},toggleLane:function(e){var t,i=this.model.lanes.get(e);this.holdRendering(),this.timelinePainter.verticalAnimateToggledLaneIds.push(e),i.get("collapsed")?i.set("collapsed",!1):(i.set("collapsed",!0),this.absoluteToRelativePoint(new ATPoint(0,i.get("top"))).y<0&&(t=i.get("top"),this.scrollTopToPoint(t))),window.ApplicationInterface&&window.ApplicationInterface.setLaneCollapsedState(window.timelineDocumentId,e,i.get("collapsed")),this.releaseRendering()},toggleMoreEventInfo:function(e){var t=this.model.lanes.get(e.laneId).nodes.findNode(e.id);this.holdRendering(),t.get("showMore")?t.set("showMore",!1):t.set("showMore",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},setShowMoreEventInfo:function(e,t){var i=this.model.lanes.get(t),n=i?i.nodes.findNode(e):null;i&&n&&(this.holdRendering(),n.set("showMore",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering())},toggleShowChildNodes:function(e,t){var i,n=this.model.laneForEntityId(t);n&&(i=n.nodes.findNode(e))&&(i.get("event").children.length>0&&(i.get("showChildNodes")?(this.holdRendering(),i.set("showChildNodes",!1),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()):(this.holdRendering(),i.set("showChildNodes",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering())),d3.event.sourceEvent&&(d3.event.sourceEvent.stopPropagation(),d3.event.sourceEvent.cancelBubble()),d3.event.stopPropagation())},setShowChildNodes:function(e,t){var i=this.model.lanes.get(t),n=i?i.nodes.findNode(e):null;i&&n&&(this.holdRendering(),n.set("showChildNodes",!0),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering())},revealChildNode:function(e){for(var t,i,n,s,o,r=this,a=this.timeline.get("events"),l=this.model.findNodeForEventId(e).get("lane"),h=a.findChild(e).get("parentId"),d=[],c=this.model.get("unitScale");h!==ATEmptyGuidString&&!l.nodes.findNode(h).get("showChildNodes");)d.push(h),h=(i=a.findChild(h)).get("parentId");for(t=d.length-1;t>=0;t--)h=d[t],(s=0===(n=(i=a.findChild(h)).get("endTS")-i.get("startTS"))?c:n/TimelineDisplayConstants.animatedExpansionParentWidth)<this.minimumUnitScale&&(s=this.minimumUnitScale),(!o||s<o)&&(o=s);if(o&&o!==c)d3.transition().duration(1e3).tween("animatedZoom",function(i,n){return function(){var s=d3.interpolateNumber(i,n);return function(o){var a=s(o);if(r.holdRendering(),n<i&&a<n?a=n:n>i&&a>n&&(a=n),r.zoomToScale(a),r.releaseRendering(),a===n){for(r.holdRendering(),t=d.length-1;t>=0;t--)r.setShowChildNodes(d[t],l.id);r.releaseRendering(),r.calculateIfRequired(),r.scrollToEventsIfOffScreen([e])}}}}(c,o));else{for(t=d.length-1;t>=0;t--)this.setShowChildNodes(d[t],l.id);this.calculateIfRequired(),this.scrollToEventsIfOffScreen([e])}},collapseAllLanes:function(){var e=this;this.holdRendering(),this.model.lanes.each(function(t){t.get("collapsed")||e.toggleLane(t.id)}),this.releaseRendering()},expandAllLanes:function(){var e=this;this.holdRendering(),this.model.lanes.each(function(t){t.get("collapsed")&&e.toggleLane(t.id)}),this.releaseRendering()},hideSelectedEventDetails:function(){var e=this;this.holdRendering(),_.each(this.timeline.selectedEvents,function(t){e.model.lanes.each(function(e){var i=e.nodes.findNode(t);i&&i.set("showMore",!1)})}),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},hideAllEventDetails:function(){this.holdRendering(),this.model.hideAllEventDetails(),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},showSelectedEventDetails:function(){var e=this;this.holdRendering(),_.each(this.timeline.selectedEvents,function(t){e.model.lanes.each(function(e){var i=e.nodes.findNode(t);i&&!i.get("showChildNodes")&&i.set("showMore",!0)})}),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},expandSelectedParentEvents:function(){var e=this,t=[],i=this.timeline.get("events"),n=null;_.each(this.timeline.selectedEvents,function(s){var o=i.findChild(s);o.children.length&&e.model.lanes.each(function(i){var s=i.nodes.findNode(o);s&&!s.get("showChildNodes")&&(t.push(s),n=e.absoluteToRelativePoint(s.get("totalRect").origin))})}),t.length&&n&&(this.holdRendering(),_.each(t,function(e){e.set("showChildNodes",!0)}),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering())},collapseSelectedParentEvents:function(){var e=this;this.holdRendering(),_.each(this.timeline.selectedEvents,function(t){e.model.lanes.each(function(e){var i=e.nodes.findNode(t);i&&i.get("showChildNodes")&&i.set("showChildNodes",!1)})}),this.renderFlags.calculate=!0,this.renderFlags.data=!0,this.releaseRendering()},addBookmark:function(){window.mainApp.showAddBookmarkModal()},addFilter:function(){window.ApplicationInterface&&window.ApplicationInterface.addFilter(window.timelineDocumentId)},filterClick:function(e){window.ApplicationInterface&&window.ApplicationInterface.removeFilterItemWithId(window.timelineDocumentId,e.uniqueId)},boundsForAddFilterDiv:function(){var e=$("#filterBarAdd"),t=null;return e&&(t=e[0].getBoundingClientRect()),t?t.left+" "+t.right+" "+t.bottom+" "+t.top:""},boundsForManageFilterDiv:function(){var e=$("#filterBarManage"),t=null;return e&&(t=e[0].getBoundingClientRect()),t?t.left+" "+t.right+" "+t.bottom+" "+t.top:""},removeFilter:function(e){window.ApplicationInterface&&window.ApplicationInterface.removeFilter(window.timelineDocumentId,e.scope+":"+e.value)},manageFilters:function(e){window.ApplicationInterface&&window.ApplicationInterface.manageFilters(window.timelineDocumentId)},viewDragStarted:function(e){document.activeElement!==document.body&&document.activeElement.blur(),d3.event.sourceEvent.touches||window.isAeonWebExport||(this.clearRequired=!0)},viewDragged:function(e){var t,i,n=Boolean(d3.event.sourceEvent.touches)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.x,d3.event.sourceEvent.y),s=this.rawMousePositionToScaledCanvasPosition(n),o=s.x,r=s.y,a=0;d3.event.sourceEvent.touches||(window.isAeonWebExport?this.grabScrolled(o,r):(this.grabScrollDrag=!1,this.draggingEvent||(this.holdRendering(),this.clearRequired=!1,this.dragBoxBounds||(this.dragStartAbsPos=this.relativeToAbsolutePoint(new ATPoint(o,r)),this.dragBoxBounds=new ATRect(o,r,0,0)),this.updateViewDragBox(o,r),this.viewDragClientPos&&(a=o-this.viewDragClientPos.x),this.viewDragClientPos=new ATPoint(o,r),t=this.viewport.size.width,i=this.viewport.size.height,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,o<70&&a<=0&&(this.dragScrollIncrementX=-10),r<70&&(this.dragScrollIncrementY=-10),o>t-30&&a>=0&&(this.dragScrollIncrementX=10),r>i-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementX||this.dragScrollIncrementY?(this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.viewDragTick=this.viewDraggedNearEdge.bind(this),window.setTimeout(this.viewDragTick,5)):this.viewDragTick&&(this.viewDragTick=null),this.releaseRendering(),this.timelinePainter.drawDragBox())))},updateViewDragBox:function(e,t){var i,n,s,o=this.absoluteToRelativePoint(this.dragStartAbsPos),r=this.dragBoxBounds;r.origin.x=Math.min(e,o.x),r.origin.y=Math.min(t,o.y),r.size.width=Math.max(e,o.x)-r.origin.x,r.size.height=Math.max(t,o.y)-r.origin.y,i=this.relativeToAbsolutePoint(new ATPoint(r.left(),r.top())),n=this.relativeToAbsolutePoint(new ATPoint(r.right(),r.bottom())),s=new ATRect(i.x,i.y,n.x-i.x,n.y-i.y),this.model.selectEventsInRect(s)},viewDraggedNearEdge:function(){window.isAeonWebExport||this.viewDragTick&&(this.holdRendering(),this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.updateViewDragBox(this.viewDragClientPos.x,this.viewDragClientPos.y),this.viewDragTick&&window.setTimeout(this.viewDragTick,15),this.releaseRendering(),this.timelinePainter.drawDragBox())},viewDragEnded:function(e){this.viewDragTick=null,d3.event.sourceEvent.touches||(this.grabScrollDrag?this.grabScrollEnded():(this.holdRendering(),this.clearRequired&&this.timeline.clearSelection(),_.isNil(this.dragBoxBounds)||(this.dragBoxBounds=null,this.timelinePainter.drawDragBox()),this.releaseRendering()))},grabScrolled:function(e,t,i){var n,s,o=e,r=t;o&&r&&(n=new ATPoint(o,r),s=new ATPoint(0,0),window.isAeonWebExport&&$("html,body").css("cursor","move"),this.grabScrollDrag=!0,this.holdRendering(),this.grabScrollViewOrigin||(this.grabScrollMoveOrigin=new ATPoint(o,r),this.grabScrollViewOrigin=new ATPoint(this.viewport.origin.x,this.viewport.origin.y)),i||(o=this.grabScrollMoveOrigin.x-n.x,r=this.grabScrollMoveOrigin.y-n.y),s.x=this.grabScrollViewOrigin.x+o,s.y=this.grabScrollViewOrigin.y+r,this.scrollTopLeftToPoint(s.x,s.y),this.releaseRendering())},grabScrollEnded:function(){_.isNil(this.grabScrollMoveOrigin)||(this.grabScrollMoveOrigin=null,this.grabScrollViewOrigin=null,$("html,body").css("cursor","default")),this.grabScrollDrag=!1},stopFlickScroll:function(){this.flickScrollAmplitude={x:0,y:0},this.flickScrollTimer&&this.flickScrollTimer.stop()},dropSyncItem:function(e,t,i){var n=this.clientXRightOfSyncBinder(t),s=this.clientYBelowFilterBar(i),o=new ATPoint(n,s),r=this.relativeToAbsolutePoint(o),a=this.roundedDateForPixel(r.x),l=this.timeline.rangeConversion.naturalStringFromValue(a,!1),h=this.model.laneForAbsoluteY(r.y),d=h?h.id:"";window.ApplicationInterface&&window.ApplicationInterface.createEventsFromSyncItems(window.timelineDocumentId,e,l,d)},eventNodeDragStarted:function(e){var t,i,n,s,o,r=Boolean(d3.event.sourceEvent.touches),a=d3.event.sourceEvent.altKey,l=d3.event.sourceEvent.shiftKey,h=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey,d=a&&!l;document.activeElement!==document.body&&document.activeElement.blur(),this.eventNodeDragStartTimestamp=d3.event.sourceEvent.timeStamp,r&&d3.event.sourceEvent.touches.length>1||this.disablePan?this.eventDragDisabled=!0:window.isAeonWebExport||(this.eventDragDisabled=!1,t=this.model.lanes.get(e.laneId).get("top"),i=new ATPoint(d?e.stopPixel:e.startPixel,e.totalRect.origin.y+t),n=this.absoluteToRelativePoint(i),s=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),o=this.rawMousePositionToScaledCanvasPosition(s),this.holdRendering(),this.draggingEvent=!0,this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.dragEventForPositionAllowed=!1,this.draggingEventForEndPosition=!1,this.eventDragStartPos=null,this.eventDragEndPos=this.eventDragStartPos,this.eventDragOffsetX=n.x-o.x,this.eventDragOffsetY=n.y-o.y,this.eventDraggingNode=e,this.eventDragFarEnough=!1,this.eventDragMeasureDistanceStartPos=this.relativeToAbsolutePoint(o),l&&a?(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id),this.draggingEventForDistanceMeasure=!0):l||h?(this.clickedEventWasOriginallySelected=e.selected,e.selected?l&&this.timeline.unselectEventWithID(e.id):this.timeline.selectEventWithID(e.id)):r||e.selected||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)),this.eventDragStartedWithRightClick=2===d3.event.sourceEvent.button,this.eventDragStartedWithTouch=Boolean(d3.event.sourceEvent.touches),this.eventDragStartedWithRightClick||(this.dragEventForPositionAllowed=this.timeline.selectedEventsDraggable(),window.mainApp.isIos?this.floatingMessageControl||(this.floatingMessageControl=new ATFloatingMessageControl):this.eventDragTooltip||(this.eventDragTooltip=new Opentip($("#mainTimelineCanvas"),{style:"eventDragTooltipStyle"}))),d3.event.sourceEvent?(d3.event.sourceEvent.stopPropagation(),d3.event.sourceEvent.preventDefault()):d3.event.stopPropagation(),this.releaseRendering())},eventNodeDragged:function(e){var t,i,n,s,o,r,a,l,h,d,c=this,g=d3.event.sourceEvent.timeStamp-this.eventNodeDragStartTimestamp,u=d3.event.sourceEvent.altKey,v=d3.event.sourceEvent.shiftKey,m=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey,p=0;if(!(this.eventDragDisabled||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan||this.eventDragStartedWithRightClick||2===d3.event.sourceEvent.button)){if(!this.timeline.isEventWithIdSelected(e.id)){if(g<TimelineDisplayConstants.touchEventMinimumHoldTimeBeforeMove)return void(this.eventDragDisabled=!0);this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)}this.eventDragDisabled=!1,window.isAeonWebExport||(this.holdRendering(),this.draggingEvent&&(s=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),r=(o=this.rawMousePositionToScaledCanvasPosition(s)).x,a=o.y,t=new ATPoint(r+this.eventDragOffsetX,a+this.eventDragOffsetY),i=this.relativeToAbsolutePoint(t),n=this.relativeToAbsolutePoint(new ATPoint(r,a)),i.y=n.y,this.eventDragEndPos&&(p=i.x-this.eventDragEndPos.x),this.eventDragEndPos=i,this.eventDragEndLane=this.model.laneForAbsoluteY(n.y),this.eventDragStartPos||(this.eventDragStartPos=i,this.eventDragStartingLane=this.eventDragEndLane),window.mainApp.canvasManager.syncBinderVisible&&r<0?(this.eventDragIntoBinder||(h={jstree:!0,draggingEvents:!0,obj:$(this),nodes:[]},_.each(this.timeline.selectedEvents,function(e){var t=c.timeline.get("events").findChild(e);h.nodes.push({id:!0,text:t.get("title"),eventId:t.id}),d=t.get("title")}),this.timeline.selectedEvents.length>1&&(d="Sync "+this.timeline.selectedEvents.length+" new events"),window.mainApp.syncBinderView.receiveDrag(d3.event.sourceEvent,h,d),this.eventDragIntoBinder=!0),this.eventDragTick=null,this.viewDragTick=null,this.eventNodeDragEnded(e)):(this.eventDragIntoBinder=!1,Math.abs(this.eventDragStartPos.x-i.x)+Math.abs(this.eventDragStartPos.y-i.y)>5&&(this.eventDragFarEnough=!0),u&&v?(this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.draggingEventForDistanceMeasure=!0,this.eventDragMeasureDistanceFromNode||(this.eventDragMeasureDistanceFromNode=this.eventDragStartingLane.nodes.findNode(e.id)),this.eventDragMeasureDistanceToNode=this.model.eventNodeForAbsolutePosition(n,!0),this.eventDragMeasureDistanceEndPos=n,this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id),this.eventDragMeasureDistanceToNode&&this.timeline.selectEventWithID(this.eventDragMeasureDistanceToNode.id)):this.draggingEventForEndPosition||u?(this.draggingEventForEndPosition=!0,this.draggingEventForParent=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1):m?(this.draggingEventForParent=!0,this.draggingEventForEndPosition=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragTargetEventDrop=this.model.eventNodeForAbsolutePosition(n,!0),!this.eventDragTargetEventDrop||this.eventDragTargetEventDrop.id!==e.id&&this.timeline.selectedEventsCanHaveParent(this.eventDragTargetEventDrop.id)||(this.eventDragTargetEventDrop=null),this.eventDragChangingParent=!0):(this.draggingEventForEndPosition=!1,this.draggingEventForParent=!1,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1,this.draggingEventForDistanceMeasure=!1,this.eventDragEndLane!==this.eventDragStartingLane?(this.draggingEventForLane=!0,this.draggingEventForPosition=!1):(this.draggingEventForLane=!1,this.dragEventForPositionAllowed?this.draggingEventForPosition=!0:this.draggingEventForPosition=!1)),this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,(l=this.rawMousePositionToOffsetFromEdges(s)).left<70&&p<=0&&(this.dragScrollIncrementX=-5),l.top<70&&(this.dragScrollIncrementY=-5),l.right<70&&p>=0&&(this.dragScrollIncrementX=5),l.bottom<70&&(this.dragScrollIncrementY=5),this.dragScrollIncrementX||this.dragScrollIncrementY?(this.draggingEventForParent&&(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1),this.d3EventPt=t,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.eventDragTick=this.eventNodeDraggedNearEdge.bind(this),window.setTimeout(this.eventDragTick,5)):this.eventDragTick&&(this.eventDragTick=null)),d3.event.sourceEvent?(d3.event.sourceEvent.stopPropagation(),d3.event.sourceEvent.preventDefault()):d3.event.stopPropagation()),this.eventDragFarEnough&&(this.eventNodeDraggedCalculateActions(),this.timelinePainter.drawMoveEventLine()),this.releaseRendering())}},eventNodeDraggedNearEdge:function(){var e;window.isAeonWebExport||(this.holdRendering(),e=this.relativeToAbsolutePoint(this.d3EventPt),this.eventDragEndPos=e,this.eventDragEndLane=this.model.laneForAbsoluteY(e.y),this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.draggingEventForParent?(this.eventDragTargetEventDrop=null,this.eventDragChangingParent=!1):this.draggingEventForDistanceMeasure&&(this.eventDragMeasureDistanceToNode=null),this.eventDragTick&&window.setTimeout(this.eventDragTick,15),this.eventDragFarEnough&&(this.draggingEvent&&this.eventNodeDraggedCalculateActions(),this.timelinePainter.drawMoveEventLine()),this.releaseRendering())},eventNodeDraggedCalculateActions:function(){var e,t,i,n,s,o,r,a,l,h,d,c,g,u,v="tooltipNormal",m=this.eventDraggingNode;if(this.draggingEventForDistanceMeasure)this.eventDragMeasureDistanceToNode&&(d=this.eventDragMeasureDistanceFromNode.get("event"))!==(c=this.eventDragMeasureDistanceToNode.get("event"))?(c.get("startTS")>d.get("endTS")?(g=this.timeline.rangeConversion.valueFromTimestamp(d.get("endTS")),t="end"):(g=this.timeline.rangeConversion.valueFromTimestamp(d.get("startTS")),t="start"),u=this.timeline.rangeConversion.valueFromTimestamp(c.get("startTS")),e="Distance from "+t+" of event: "+this.timeline.rangeConversion.spanBetweenValues(g,u).toString()):e="Hover over event to measure distance between events";else if(this.draggingEventForParent)e=this.eventDragTargetEventDrop?'Make child of "'+this.eventDragTargetEventDrop.get("event").get("title")+'"':"Drop on event to become child";else if(this.draggingEventForLane)e="Add relationship to "+this.eventDragEndLane.get("entity").get("name");else if(this.draggingEventForPosition||this.draggingEventForEndPosition)1===this.timeline.selectedEvents.length&&(o=this.model.eventNodeForSnapDrag(m.id,this.eventDragStartingLane.id,this.eventDragEndPos,this.viewport)),o?(r=this.timeline.get("events").findChild(o.node.id),a="start"===o.location?r.get("startTS"):r.get("endTS"),l=o.node.get("lane").get("top")+o.node.get("totalRect").origin.y+o.node.get("markerRect").centerY(),this.snapDragLine=new ATLine(o.xValue,l-TimelineDisplayConstants.snapDragLineLength/2,o.xValue,l+TimelineDisplayConstants.snapDragLineLength/2),this.snapDragLineColor=r.get("color"),e="Snap "+(this.draggingEventForEndPosition?"end ":"")+" to "+o.location+' of "'+r.get("title")+'"',e+="<br />New "+(this.draggingEventForEndPosition?"end ":"")+"date: "+this.timeline.rangeConversion.naturalStringFromValue(a,!0)):(this.snapDragLine=null,i=this.eventDragEndPos.x-this.eventDragStartPos.x,n=ATUtilities.floatToInt(i*this.model.get("unitScale")),s=this.timeline.rangeConversion.roundedSpanForUnitsAtScale(n,this.model.get("unitScale")),h=this.draggingEventForEndPosition?this.timeline.endDateAfterDraggingEvent(m.id,s):this.timeline.dateAfterDraggingEvent(m.id,s),e="Shift event "+(this.draggingEventForEndPosition?"end ":"")+"by "+s.toString()+" to "+this.timeline.rangeConversion.naturalStringFromValue(h,!0),this.timeline.selectedEvents.length>1&&(e+="<br />(Multiple events are selected)"));else{if(!this.draggingEvent||this.dragEventForPositionAllowed)return;e="Cannot drag dependent events. Move its predecessor instead.",v="tooltipError"}window.mainApp.isIos?(this.floatingMessageControl.customize({text:e,errorClass:"tooltipError"===v}),this.floatingMessageControl.show()):(e='<span class="'+v+'">'+e+"</span>",this.eventDragTooltip.setContent(e),this.eventDragTooltip.prepareToShow())},eventNodeDragEnded:function(e){var t,i,n,s,o,r,a,l=d3.event.sourceEvent.shiftKey,h=window.mainApp.isMac?d3.event.sourceEvent.metaKey:d3.event.sourceEvent.ctrlKey,d=this.timeline.selectedEvents.join(),c=this.eventDragEndPos?this.eventDragEndPos.x-this.eventDragStartPos.x:null;if(this.eventDragStartedWithRightClick||d3.event.sourceEvent.touches&&d3.event.sourceEvent.touches.length>1||this.disablePan)return this.eventDragStartedWithRightClick=!1,this.eventDragDisabled=!1,this.eventDragTick=null,this.draggingEvent=!1,this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,void this.timelinePainter.drawMoveEventLine();this.eventDragDisabled=!1,window.isAeonWebExport||(this.eventDragTick=null,this.draggingEvent=!1,this.holdRendering(),this.eventDragIntoBinder||(this.eventDragIntoBinder=!1,this.eventDragFarEnough&&!this.eventDragDisabled?this.draggingEventForParent&&this.eventDragChangingParent?window.ApplicationInterface&&(t=this.eventDragTargetEventDrop?this.eventDragTargetEventDrop.id:ATEmptyGuidString,window.mainApp.showNewParentPromptIfNeeded(t,function(e){window.ApplicationInterface.moveEventsWithIdsToParent(window.timelineDocumentId,d,t,e)})):this.draggingEventForLane&&this.eventDragEndLane!==this.eventDragStartingLane?window.ApplicationInterface&&window.ApplicationInterface.copyEventsWithIdsToLane(window.timelineDocumentId,d,this.eventDragEndLane.id):(this.draggingEventForEndPosition||this.draggingEventForPosition)&&c?window.ApplicationInterface&&(1===this.timeline.selectedEvents.length&&(i=this.model.eventNodeForSnapDrag(e.id,this.eventDragStartingLane.id,this.eventDragEndPos,this.viewport)),i?(n=this.timeline.get("events").findChild(i.node.id),s="start"===i.location?n.get("startTS"):n.get("endTS"),o=n.get("precision"),this.draggingEventForPosition?window.ApplicationInterface.moveEventWithIdToTimestamp(window.timelineDocumentId,this.timeline.selectedEvents[0],String(s),o):this.draggingEventForEndPosition&&window.ApplicationInterface.resizeEventWithIdToEndTimestamp(window.timelineDocumentId,this.timeline.selectedEvents[0],String(s),o)):(r=ATUtilities.floatToInt(c*this.model.get("unitScale")),a=this.timeline.rangeConversion.roundedSpanForUnitsAtScale(r,this.model.get("unitScale")),this.draggingEventForPosition?(a.hasOwnProperty("years")?window.ApplicationInterface.moveEventsWithIdsBySpan(window.timelineDocumentId,d,String(a.years),String(a.months),String(a.weeks),String(a.days),String(a.hours),String(a.minutes),String(a.seconds)):window.ApplicationInterface.moveEventsWithIdsByValue(window.timelineDocumentId,d,a),window.mainApp.isIos&&window.ApplicationInterface.markSuggestions(window.timelineDocumentId,"ios_drag_event"),window.ApplicationInterface.markSuggestions(window.timelineDocumentId,"drag_event")):this.draggingEventForEndPosition&&(a.hasOwnProperty("years")?window.ApplicationInterface.resizeEventsWithIdsBySpan(window.timelineDocumentId,d,String(a.years),String(a.months),String(a.weeks),String(a.days),String(a.hours),String(a.minutes),String(a.seconds)):window.ApplicationInterface.resizeEventsWithIdsByValue(window.timelineDocumentId,d,a)))):l||h||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id)):"ios"===this.platform?this.timeline.toggleEventSelectionWithID(e.id):h&&this.clickedEventWasOriginallySelected?this.timeline.unselectEventWithID(e.id):l||h||(this.timeline.clearSelection(!0),this.timeline.selectEventWithID(e.id))),this.draggingEventForParent=!1,this.draggingEventForDistanceMeasure=!1,this.draggingEventForLane=!1,this.draggingEventForPosition=!1,this.draggingEventForEndPosition=!1,this.eventDragMeasureDistanceFromNode=null,this.eventDragMeasureDistanceToNode=null,this.eventDragMeasureDistanceStartPos=null,this.eventDragMeasureDistanceEndPos=null,this.snapDragLine=null,this.eventDragEndPos=null,this.eventDragStartingLane=null,this.eventDragEndLane=null,this.eventDragTargetEventDrop=null,this.eventDragChangingParent=null,this.eventDragIntoBinder=!1,this.timelinePainter.drawMoveEventLine(),d3.event.sourceEvent?(d3.event.sourceEvent.stopPropagation(),d3.event.sourceEvent.preventDefault()):d3.event.stopPropagation(),window.mainApp.isIos?this.floatingMessageControl.hide():(this.eventDragTooltip.hide(),this.eventDragTooltip.deactivate()),this.releaseRendering())},laneDragStarted:function(e){var t=Boolean(d3.event.sourceEvent.touches);document.activeElement!==document.body&&document.activeElement.blur(),window.isAeonWebExport||t||e.id!==ATEmptyGuidString&&(this.draggingLane=!0,this.laneDragStartPos=null,this.laneDragEndLane=null,this.laneDragEndPos=this.laneDragStartPos,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.holdRendering(),this.timeline.clearSelection(),this.releaseRendering())},laneDragged:function(e){var t,i,n,s,o,r,a=Boolean(d3.event.sourceEvent.touches);window.isAeonWebExport||a||e.id!==ATEmptyGuidString&&this.draggingLane&&(t=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),i=this.rawMousePositionToScaledCanvasPosition(t),n=this.relativeToAbsolutePoint(i),s=i.y,(r=this.model.laneForAbsoluteY(n.y)).id!==ATEmptyGuidString&&(this.laneDragEndLane=r),this.laneDragEndPos=n,this.laneDragStartPos||(this.laneDragStartPos=n,this.laneDragStartingLane=this.laneDragEndLane),o=this.viewport.size.height,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,s<70&&(this.dragScrollIncrementY=-10),s>o-30&&(this.dragScrollIncrementY=10),this.dragScrollIncrementY?(this.d3EventPt=i,this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.laneDragTick=this.laneDraggedNearEdge.bind(this),window.setTimeout(this.laneDragTick,5)):this.laneDragTick&&(this.laneDragTick=null),this.timelinePainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},laneDraggedNearEdge:function(){var e,t;window.isAeonWebExport||(e=this.relativeToAbsolutePoint(this.d3EventPt),this.laneDragEndPos=e,(t=this.model.laneForAbsoluteY(e.y)).id!==ATEmptyGuidString&&(this.laneDragEndLane=t),this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.animateContextBarReturn(0,0),this.laneDragTick&&(this.timelinePainter.drawMoveLaneLine(),window.setTimeout(this.laneDragTick,15)))},laneDragEnded:function(e){var t=Boolean(d3.event.sourceEvent.touches),i=e.id;window.isAeonWebExport||t||e.id!==ATEmptyGuidString&&(this.laneDragTick=null,this.draggingLane=!1,this.laneDragEndLane&&this.laneDragEndLane.id!==i&&window.ApplicationInterface&&window.ApplicationInterface.moveEntityToPositionOfEntity(window.timelineDocumentId,i,this.laneDragEndLane.id),this.laneDragEndPos=null,this.laneDragStartingLane=null,this.laneDragEndLane=null,this.timelinePainter.drawMoveLaneLine(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},clickInScrollTrack:function(){var e=this,t=Number(TimelineDisplayConstants.scrollTrackTopMargin),i=isNaN(d3.event.sourceEvent.clientY)?d3.event.sourceEvent.touches[0].clientY:d3.event.sourceEvent.clientY,n=this.clientYBelowFilterBar(i)-t,s=this.rangeY.min+n/(this.viewport.size.height-t-TimelineDisplayConstants.navFooterHeight)*(this.rangeY.max-this.rangeY.min);d3.transition().duration(350).tween("animatedscroll",function(t,i,n,s){return function(){var t=d3.interpolateNumber(n,s);return function(i){e.scrollTopToPoint(t(i))}}}(this.viewport.origin.x,this.viewport.origin.x,this.viewport.origin.y,s)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragStarted:function(e){this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null,d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragged:function(e){var t,i=isNaN(d3.event.sourceEvent.clientY)?d3.event.sourceEvent.touches[0].clientY:d3.event.sourceEvent.clientY,n=this.clientYBelowFilterBar(i),s=TimelineDisplayConstants.scrollTrackTopMargin,o=this.viewport.size.height-s-TimelineDisplayConstants.navFooterHeight,r=this.rangeY.max-TimelineDisplayConstants.navFooterHeight;this.verticalScrollDragStartY||(this.verticalScrollDragStartY=n||1,this.verticalScrollDragStartAbsY=this.viewport.top()),t=this.verticalScrollDragStartAbsY+(n-this.verticalScrollDragStartY)/this.physicalScaleFactor/o*r,this.scrollTopToPoint(t),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},verticalScrollDragEnded:function(e){d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),this.verticalScrollDragStartY=null,this.verticalScrollDragStartAbsY=null},contextLensDragStarted:function(e){var t=this.contextRightLensPixel-this.contextLeftLensPixel,i=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),n=this.rawMousePositionToScaledCanvasPosition(i);this.contextDragOffsetX=n.x-this.contextLeftLensPixel,this.contextDragZoomFromLeft=!1,this.contextDragZoomFromRight=!1,this.contextDragOffsetX<TimelineDisplayConstants.contextLensResizeGrabWidth?this.contextDragZoomFromLeft=!0:this.contextDragOffsetX>t-TimelineDisplayConstants.contextLensResizeGrabWidth&&(this.contextDragZoomFromRight=!0),this.contextDragZoomMinPhysicalWidth=TimelineDisplayConstants.contextLensDragMinGap,this.contextDragZoomMaxPhysicalWidth=this.viewport.size.width/2,this.minimumUnitScale&&(this.contextDragZoomMinPhysicalWidth=Math.max(TimelineDisplayConstants.contextLensDragMinGap,this.minimumUnitScale*this.viewport.size.width/this.contextUnitScale)),this.maximumUnitScale&&(this.contextDragZoomMaxPhysicalWidth=Math.min(this.contextDragZoomMaxPhysicalWidth,this.maximumUnitScale*this.viewport.size.width/this.contextUnitScale)),d3.transition().delay(0).duration(0).tween("animatedContextReturn",null),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},contextLensDragged:function(e){var t,i,n,s,o;t=isNaN(d3.event.sourceEvent.clientX)?new ATPoint(d3.event.sourceEvent.touches[0].clientX,d3.event.sourceEvent.touches[0].clientY):new ATPoint(d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),i=this.rawMousePositionToScaledCanvasPosition(t).x,s=this.viewport.size.width,o=this.contextRightLensPixel-this.contextLeftLensPixel,this.dragScrollIncrementX=0,this.dragScrollIncrementY=0,i<0?this.dragScrollIncrementX=-40:i<TimelineDisplayConstants.contextLensMinMargin+20?this.dragScrollIncrementX=-10:i>s?this.dragScrollIncrementX=40:i>s-TimelineDisplayConstants.contextLensMinMargin-o-20&&(this.dragScrollIncrementX=10),this.contextDragZoomFromLeft?(this.contextLeftLensPixel=Math.max(Math.min(i,this.contextRightLensPixel-this.contextDragZoomMinPhysicalWidth),this.contextRightLensPixel-this.contextDragZoomMaxPhysicalWidth),this.timelinePainter.redrawContextLens()):this.contextDragZoomFromRight?(this.contextRightLensPixel=Math.min(Math.max(i,this.contextLeftLensPixel+this.contextDragZoomMinPhysicalWidth),this.contextLeftLensPixel+this.contextDragZoomMaxPhysicalWidth),this.timelinePainter.redrawContextLens()):this.dragScrollIncrementX?(this.contextDragClientX=this.dragScrollIncrementX<0?TimelineDisplayConstants.contextLensMinMargin:s-TimelineDisplayConstants.contextLensMinMargin,this.contextLensDragTick=this.contextLensDraggedNearEdge.bind(this),window.setTimeout(this.contextLensDragTick,5)):this.contextLensDragTick?this.contextLensDragTick=null:(n=((i-this.contextDragOffsetX)*this.contextUnitScale+this.contextLeftTS)/this.model.get("unitScale"),this.scrollLeftToPoint(n)),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},contextLensDraggedNearEdge:function(){this.scrollIncrement(this.dragScrollIncrementX,this.dragScrollIncrementY),this.contextLensDragTick&&(this.timelinePainter.drawMoveEventLine(),window.setTimeout(this.contextLensDragTick,15))},contextLensDragEnded:function(e){this.contextLensDragTick=null,this.contextDragZoomFromLeft||this.contextDragZoomFromRight?this.zoomToContextLensBounds(this.contextLeftLensPixel,this.contextRightLensPixel):this.animateContextBarReturn(500,1e3),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},scrollToLane:function(e){this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?this.scrollToPixelXY(null,e.top,350):this.relationshipView.scrollToLane(e)},scrollToNode:function(e){this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?this.scrollToPixelXY(e.get("totalRect").origin.x-this.viewport.size.width/2,e.get("lane").get("top")+e.get("totalRect").origin.y-this.viewport.size.height/2,1e3):this.relationshipView.scrollToNode(e)},scrollToNodeIfOffScreen:function(e){var t,i,n=e.get("lane");this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?(n.get("collapsed")&&this.toggleLane(n.id),(t=this.viewport.deepCopy()).size.height-=TimelineDisplayConstants.filterBarHeight,(i=e.get("totalRect").deepCopy()).origin.y+=e.get("lane").get("top"),t.containsRect(i)||this.scrollToNode(e)):this.relationshipView.scrollToNodeIfOffScreen(e)},scrollToEventsIfOffScreen:function(e){var t,i=this.model.findAllNodesForEventIds(e),n=!1,s=null;this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?((t=this.viewport.deepCopy()).size.height-=TimelineDisplayConstants.filterBarHeight,_.each(i,function(e){var i=e.get("lane"),o=e.get("totalRect").deepCopy();o.origin.y+=e.get("lane").get("top"),i.get("collapsed")||(t.containsRect(o)?n=!0:s=e)}),n||(s?this.scrollToNode(s):i.length>0&&(this.toggleLane(i[0].get("lane").id),this.scrollToNode(i[0])))):this.relationshipView.scrollToEventsIfOffScreen(e)},scrollToTimestamp:function(e){var t;this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?(t=this.model.get("unitScale"),this.scrollToPixelXY(e/t-this.viewport.size.width/2,null,1e3)):this.relationshipView.scrollToTimestamp(e)},scrollToPixelXY:function(e,t,i){var n=this,s=_.isNil(e)?this.viewport.origin.x:e,o=_.isNil(t)?this.viewport.origin.y:t,r=_.isNil(i)?1e3:i;d3.transition().duration(r).tween("animatedscroll",function(e,t,i,r){return function(){var a=d3.interpolateNumber(e,t),l=d3.interpolateNumber(i,r);return function(e){n.holdRendering(),n.scrollTopLeftToPoint(a(e),l(e)),n.immediateContextBarReturn(),a(e)===s&&l(e)===o&&(n.gestureCallReceivedFromCpp||(n.lastWheelTime=null)),n.releaseRendering()}}}(this.viewport.origin.x,s,this.viewport.origin.y,o)),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())},scrollPageDown:function(){var e=this.viewport.size.height-TimelineDisplayConstants.lifetimeHeight;this.scrollToPixelXY(null,this.viewport.origin.y+e)},scrollPageUp:function(){var e=this.viewport.size.height-TimelineDisplayConstants.lifetimeHeight;this.scrollToPixelXY(null,this.viewport.origin.y-e)},animatedZoomToUnitScale:function(e,t){var i=this,n=this.model.get("unitScale"),s=_.isNil(t)?1e3:t;e!==n&&(d3.transition().duration(s).tween("animatedZoom",function(e,t){return function(){var n=d3.interpolateNumber(e,t);return function(s){var o=n(s);i.holdRendering(),t<e&&o<t?o=t:t>e&&o>t&&(o=t),i.zoomToScale(o),i.releaseRendering()}}}(n,e)),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()))},animatedZoomToFit:function(){var e=this,t=this.model.findEarliestEventNode(),i=this.model.findLatestEventNode(!0),n=i.get("totalRect").size.width,s=t.get("event").get("startTS"),o=i.get("event").get("endTS"),r=o-s,a=this.viewport.size.width-n-80,l=this.model.get("unitScale"),h=r/a,d=((s+o)/2+n*h/2)/l-this.viewport.size.width/2;d3.transition().duration(1e3).tween("animatedScrollToPoint",function(t){return function(){var i=d3.interpolateNumber(e.viewport.origin.x,t);return function(t){e.holdRendering(),e.scrollLeftToPoint(i(t)),e.immediateContextBarReturn(),e.releaseRendering()}}}(d)).transition().duration(1e3).tween("animatedZoom",function(t,i){return function(){var n=d3.interpolateNumber(t,i);return function(s){var o=n(s);e.holdRendering(),i<t&&o<i?o=i:i>t&&o>i&&(o=i),e.zoomToScale(o),e.releaseRendering()}}}(l,h))},contextBarClick:function(){var e;e=((this.rawMousePositionToScaledCanvasPosition(new ATPoint(d3.event.clientX,d3.event.clientY)).x-(this.contextRightLensPixel-this.contextLeftLensPixel)/2)*this.contextUnitScale+this.contextLeftTS)/this.model.get("unitScale"),this.scrollToPixelXY(e,null,500)},bookmarkClick:function(e){var t,i=this,n=e.timestamp,s=e.scale,o=this.model.get("unitScale"),r=function(e,t){return function(){var n=d3.interpolateNumber(e,t);return function(s){var o=n(s);i.holdRendering(),t<e&&o<t?o=t:t>e&&o>t&&(o=t),i.zoomToScale(o),i.releaseRendering()}}},a=function(e){return function(){var t=d3.interpolateNumber(i.viewport.origin.x,e);return function(e){i.holdRendering(),i.scrollLeftToPoint(t(e)),i.immediateContextBarReturn(),i.releaseRendering()}}};this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?(s===o?(t=n/s-this.viewport.size.width/2,d3.transition().duration(1e3).tween("animatedScrollToPoint",a(t))):s>=o?(t=n/s-this.viewport.size.width/2,d3.transition().duration(1e3).tween("animatedZoom",r(o,s)).transition().duration(1e3).tween("animatedScrollToPoint",a(t))):(t=n/o-this.viewport.size.width/2,d3.transition().duration(1e3).tween("animatedScrollToPoint",a(t)).transition().duration(1e3).tween("animatedZoom",r(o,s))),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())):this.relationshipView.bookmarkClick(e)},gotoFirstBookmark:function(){var e=this.model.findEarliestEventNode();this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?(e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())):this.relationshipView.gotoFirstBookmark()},gotoLastBookmark:function(){var e=this.model.findLatestEventNode();this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?(e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())):this.relationshipView.gotoLastBookmark()},gotoPreviousEvent:function(){var e=this.model.findPreviousEventNodeBeforeTS(this.viewport.origin.x*this.model.get("unitScale"));this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?(e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())):this.relationshipView.gotoPreviousEvent()},gotoNextEvent:function(){var e=this.model.findNextEventNodeAfterTS(this.viewport.right()*this.model.get("unitScale"));this.viewMode!==ATViewMode.RELATIONSHIP_VIEW?(e&&this.scrollToNode(e),d3.event&&(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation())):this.relationshipView.gotoNextEvent()},appendMeasurementDiv:function(){this.measurementDiv||(this.boundsElement=d3.select("#bounds"),this.measurementDiv=this.boundsElement.append("div").attr("class","eventContentWrapper measurement").attr("id","contentMeasurement"),this.measureDivDOM=document.getElementById("contentMeasurement"),this.d3MeasureDivTitle=this.measurementDiv.append("div").attr("class","eventTitle draggable").attr("id","contentMeasurementTitle").text("Example title"),this.measureTitleDOM=document.getElementById("contentMeasurementTitle"),this.d3MeasureDivDate=this.measurementDiv.append("div").attr("class","eventDate draggable").attr("id","contentMeasurementDate").text("1 January 2014"),this.measureDateDOM=document.getElementById("contentMeasurementDate"),this.d3MeasureDivContent=this.measurementDiv.append("div").attr("class","expandedWrapper draggable").attr("id","contentMeasurementContent").text(""),this.measureContentDOM=document.getElementById("contentMeasurementContent"),this.entityMeasureDiv=this.boundsElement.append("div").attr("class","laneLabel measurement").attr("id","entityMeasurement"),this.entityMeasureDivDOM=document.getElementById("entityMeasurement"))},removeMeasurementDiv:function(){this.measurementDiv.remove(),this.measurementDiv=null,this.measureDivDOM=null,this.d3MeasureDivTitle=null,this.d3MeasureDivDate=null,this.d3MeasureDivContent=null,this.measureTitleDOM=null,this.entityMeasureDiv.remove(),this.entityMeasureDiv=null,this.entityMeasureDivDOM=null},calcEntityTextWidth:function(e){return this.entityMeasureDiv.text(e),this.entityMeasureDivDOM.offsetWidth},calcEventTextSize:function(e){var t,i=TimelineDisplayConstants.eventTextWrapSafetyBuffer*this.physicalScaleFactor;e.calcBigTextRequired&&e.get("showMore")&&(this.d3MeasureDivTitle.text(e.get("displayTitle")),this.d3MeasureDivDate.text(e.get("event").get("dateString")),this.d3MeasureDivContent.html(e.get("event").get("contentHTML")),this.measurementDiv.classed("expanded",!0),(t=new ATSize(this.measureDivDOM.offsetWidth+i,this.measureDivDOM.offsetHeight)).scale(1/this.physicalScaleFactor),e.calcBigTextRequired=!1,e.set("bigTextSize",t),e.calcEventTextRequired=!1,e.calcRects())},checkBrowser:function(){return navigator.BrowserInfo=function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===i[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),i.join(" "))}(),navigator.BrowserInfo},findFirst:function(e,t){var i,n,s,o,r=ATEmptyGuidString;if(this.searchString=e,this.currentSearchIndex=-1,this.eventList=[],this.eventList.length>0||(this.eventList=this.timeline.flattenedEventList(t)),!e)return this.timeline.clearSelection(),this.timelinePainter.highlightString=null,this.renderFlags.selection=!0,void this.renderIfRequired();if(this.timeline.rangeConversion&&(i=this.timeline.rangeConversion.valueForPartialString(e,e.length,!1)).matchFound)return n=this.timeline.rangeConversion.calendar?i.value.timestamp:i.value,this.scrollToTimestamp(n),this.timeline.clearSelection(),void(this.timelinePainter.highlightString=null);for(s=0;s<this.eventList.length;s++)if(this.eventList[s].matchString(e)){this.currentSearchIndex=s,r=this.eventList[s].id;break}this.searchString.length>0&&(o={highlightString:this.searchString,scrollPosition:null,selectEventId:r},window.mainApp.applySearchResult(JSON.stringify(o),!0))},findNext:function(){var e,t=ATEmptyGuidString;if(this.searchString&&this.eventList){for(this.currentSearchIndex++;this.currentSearchIndex<this.eventList.length;this.currentSearchIndex++)if(this.eventList[this.currentSearchIndex].matchString(this.searchString)){t=this.eventList[this.currentSearchIndex].id;break}this.searchString.length>0&&(e={highlightString:this.searchString,scrollPosition:null,selectEventId:t},window.mainApp.applySearchResult(JSON.stringify(e),!0))}},findPrevious:function(){var e,t=ATEmptyGuidString;if(this.searchString&&this.eventList){for(0!==this.currentSearchIndex&&this.currentSearchIndex--;this.currentSearchIndex>0;--this.currentSearchIndex)if(this.eventList[this.currentSearchIndex].matchString(this.searchString)){t=this.eventList[this.currentSearchIndex].id;break}this.searchString.length>0&&(e={highlightString:this.searchString,scrollPosition:null,selectEventId:t},window.mainApp.applySearchResult(JSON.stringify(e),!0))}},renderJsContextMenuWithItems:function(e){var t=this,i=JSON.parse(e),n=[],s=null,o=[],r=0;_.each(i,function(e){"-"===e.name?_.isNil(s)||o.push(s):n.push({id:e.name,text:e.name,disabled:e.disabled}),s=e.name}),this.defaultContextMenu?(this.defaultContextMenu.clearAll(),this.defaultContextMenu.loadStruct(n),_.each(o,function(e){t.defaultContextMenu.addNewSeparator(e,"sep"+r),r++})):(this.defaultContextMenu=new dhtmlXMenuObject({context:!0,items:n}),_.each(o,function(e){t.defaultContextMenu.addNewSeparator(e,"sep"+r),r++}),this.defaultContextMenu.setAutoShowMode(!1),this.defaultContextMenu.setAutoHideMode(!0),this.defaultContextMenu.setContextMenuHideAllMode(!1),this.defaultContextMenu.attachEvent("onClick",this.defaultContextMenuItemClick.bind(this))),setTimeout(function(){t.defaultContextMenu.showContextMenu(t.defaultContextMenuMouseLocation.x,t.defaultContextMenuMouseLocation.y)})},defaultContextMenuItemClick:function(e,t,i){var n=this.defaultContextMenu.getItemText(e);return window.ApplicationInterface&&window.ApplicationInterface.defaultContextMenuItemClicked(window.timelineDocumentId,n),!1},linkToAeonHome:function(){var e=window.open("http://aeontimeline.com/","_blank");e?e.focus():alert("Please visit http://aeontimeline.com for more information.")}});module.exports=ATTimelineView;

},{"../../../lib/dhtmlxmenu":5,"../../../lib/opentip":11,"../../controller/ATDisplayConstants":16,"../../model/ATEmptyGuidString":26,"../../model/ATFilterResult":36,"../../utils/ATBounds":44,"../../utils/ATLine":45,"../../utils/ATPoint":46,"../../utils/ATRect":48,"../../utils/ATSize":49,"../../utils/ATUtilities":51,"../ATViewMode":53,"../ios/ATFloatingMessageControl":183,"./ATEventTextCalculator":197,"./ATTimelineViewPainter":202,"./templates/expandedEventAttachmentList.html":203,"./templates/expandedEventContentPostamble.html":204,"./templates/expandedEventContentPreamble.html":205,"./templates/expandedEventImage.html":206,"./templates/expandedEventLinkList.html":207,"./templates/expandedEventPropertyBoolean.html":208,"./templates/expandedEventPropertyNumber.html":209,"./templates/expandedEventPropertyParagraph.html":210,"./templates/expandedEventPropertyPercentage.html":211,"./templates/expandedEventPropertyString.html":212,"./templates/expandedEventRoleList.html":213,"./templates/expandedEventTagList.html":214,"backbone":220,"d3":320,"hammerjs":322,"jquery":331,"lodash":333}],202:[function(require,module,exports){
function MyRound(t,e){return Math.round(t*e)}function MyCeil(t,e){return Math.ceil(t*e)}var $=require("jquery"),d3=require("d3"),_=require("lodash"),Hilitor2=require("../../../lib/hilitor2"),ATUtilities=require("../../utils/ATUtilities"),Opentip=require("../../../lib/opentip"),TimelineDisplayConstants=require("../../controller/ATDisplayConstants"),ATPoint=require("../../utils/ATPoint"),ATRect=require("../../utils/ATRect"),testForTransformSupport=function(){return void 0!==document.createElement("div").style.transform},ATTimelineViewPainter=function(t){this.timelineView=t,this.transformLabel=testForTransformSupport()?"transform":"-webkit-transform",this.eventDragEnabled=!1,this.scaleFactor=this.timelineView.physicalScaleFactor,this.lifetimeBgLayer=t.layers.lifetime_bg_layer,this.bgLayer=t.layers.bg_layer,this.dependencyLayer=t.layers.dependency_layer,this.eventLayer=t.layers.event_layer,this.laneOverlayLayer=t.layers.lane_overlay_layer,this.laneNavSvg=t.layers.lane_nav_svg,this.headerSvg=t.layers.header_svg,this.uiDrawingSvg=d3.select("#ui_drawing_svg"),this.bookmarksDiv=t.bookmarksDiv,this.bookmarkFirst=this.bookmarksDiv.select(".bookmarkFirst").on("click",function(){window.mainApp.timelineView.gotoFirstBookmark()}),this.bookmarkLast=this.bookmarksDiv.select(".bookmarkLast").on("click",function(){window.mainApp.timelineView.gotoLastBookmark()}),this.bookmarkPrevious=this.bookmarksDiv.select(".bookmarkPrevious").on("click",function(){window.mainApp.timelineView.gotoPreviousEvent()}),this.bookmarkNext=this.bookmarksDiv.select(".bookmarkNext").on("click",function(){window.mainApp.timelineView.gotoNextEvent()}),this.bookmarkAdd=this.bookmarksDiv.select(".bookmarkAdd").on("click",function(){window.mainApp.timelineView.addBookmark()}),this.bookmarkGroup=this.bookmarksDiv.select(".bookmarkGroup"),this.filtersDiv=t.filterBarDiv,this.filterAdd=this.filtersDiv.select(".filterBarAdd").on("click",function(){window.mainApp.timelineView.addFilter()}),this.filterManage=this.filtersDiv.select(".filterBarManage").on("click",function(){window.mainApp.timelineView.manageFilters()}),this.filterGroup=this.filtersDiv.select(".filterGroup"),this.verticalAnimateToggledLaneIds=[],this.bookmarksConfigured=!1,this.contextLayer=t.layers.context_layer,this.contextLensLayer=t.layers.context_lens_layer,this.dependencyG=this.dependencyLayer.append("g").attr("class","dependencyG"),this.staticTimeHeaderG=this.headerSvg.append("g").attr("class","timeHdrG"),this.staticTimeHeaderG.append("rect").attr("class","timeHdr").attr("width","100%").attr("height",TimelineDisplayConstants.timeHeaderHeight).attr("x",0).attr("y",0),this.staticTimeHeaderG.append("line").attr("class","timeHdrBottomLine").attr("x1",0).attr("y1",TimelineDisplayConstants.timeHeaderHeight-.5).attr("x2","100%").attr("y2",TimelineDisplayConstants.timeHeaderHeight-.5),this.staticTimeHeaderNowG=this.headerSvg.append("g").attr("class","timeHdrNowG").style("opacity",0),this.staticTimeHeaderNowG.append("rect").attr("class","timeHdrNowRect").attr("width",41.5).attr("height",18).attr("x",-21).attr("y",42).attr("rx",2).attr("ry",2),this.staticTimeHeaderNowG.append("text").text("NOW").attr("class","timeHdrNowLabel").attr("x",0).attr("y",51),this.staticTimeHeaderNowG.append("line").attr("class","timeHdrNowLine").attr("x1",0).attr("y1",60).attr("x2",0).attr("y2",4e3),this.contextBarG=this.contextLayer.append("g").attr("class","contextBarG"),this.contextBarRect=this.contextBarG.append("rect").attr("class","contextBar").attr("width","100%").attr("height",TimelineDisplayConstants.contextHeight).attr("x",0).attr("y",0).on("click",function(){window.mainApp.timelineView.contextBarClick()}),this.hilitor=new Hilitor2("event_layer"),this.hilitor.setMatchType("open"),this.highlightString=null,this.defaultTransitionDuration=0,this.transitionDuration=this.defaultTransitionDuration;var e=0;this.RENDER_LEVEL_SELECTION=e++,this.RENDER_LEVEL_POSITION=e++,this.RENDER_LEVEL_VIEWPORT=e++,this.RENDER_LEVEL_SIZE=e++,this.RENDER_LEVEL_ZOOM=e++,this.RENDER_LEVEL_DATA=e++};ATTimelineViewPainter.prototype.drawDragBox=function(){var t=this.timelineView.dragBoxBounds;t?(this.selectionDragBox||(this.selectionDragBox=this.uiDrawingSvg.append("rect").attr("class","dragBox")),this.selectionDragBox.attr("width",t.size.width).attr("height",t.size.height).attr("x",0).attr("y",0),this.uiDrawingSvg.attr("width",t.size.width*this.scaleFactor).attr("height",t.size.height*this.scaleFactor).attr("viewBox","0 0 "+t.size.width+" "+t.size.height).style("left",t.origin.x*this.scaleFactor).style("top",t.origin.y*this.scaleFactor)):this.selectionDragBox&&(this.selectionDragBox.remove(),this.selectionDragBox=null)},ATTimelineViewPainter.prototype.drawMoveEventLine=function(){var t,e,i,n,a,r,s,o,l,c=this.timelineView.draggingEventForLane,d=this.timelineView.draggingEventForParent,h=this.timelineView.draggingEventForDistanceMeasure,p=this.timelineView.draggingEventForPosition,m=this.timelineView.draggingEventForEndPosition;d?((e=this.timelineView.eventDragTargetEventDrop)?(this.moveEventDragTargetBox||(this.moveEventDragTargetBox=this.uiDrawingSvg.append("rect").attr("class","dragEventTargetDrop")),a=(n=e.get("totalRect")).top()+this.timelineView.eventDragEndLane.get("top"),i=this.timelineView.absoluteToRelativePoint(new ATPoint(n.left(),a)),this.moveEventDragTargetBox.attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",n.size.width).attr("height",n.size.height),this.uiDrawingSvg.attr("width",n.size.width*this.scaleFactor).attr("height",n.size.height*this.scaleFactor).attr("viewBox","0 0 "+n.size.width+" "+n.size.height).style("left",i.x*this.scaleFactor).style("top",i.y*this.scaleFactor)):this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null),this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null)):c||p||m||h?(t=this.timelineView.eventDragEndPos,r=this.timelineView.absoluteToRelativePoint(t),this.moveEventDragLine||(this.moveEventDragLine=this.uiDrawingSvg.append("line").attr("class","dragEventLine")),h?(s=this.timelineView.absoluteToRelativePoint(this.timelineView.eventDragMeasureDistanceStartPos),o=this.timelineView.absoluteToRelativePoint(this.timelineView.eventDragMeasureDistanceEndPos)):c?(s=new ATPoint(0,r.y),o=new ATPoint(this.timelineView.viewport.size.width,r.y)):this.timelineView.snapDragLine?(s=this.timelineView.absoluteToRelativePoint(this.timelineView.snapDragLine.origin),o=this.timelineView.absoluteToRelativePoint(this.timelineView.snapDragLine.destination)):(s=new ATPoint(r.x,0),o=new ATPoint(r.x,this.timelineView.viewport.size.height)),(l=new ATRect(0,0,0,0)).origin.x=Math.min(s.x,o.x)-2,l.origin.y=Math.min(s.y,o.y)-2,l.size.width=Math.max(Math.abs(s.x-o.x)+2,5),l.size.height=Math.max(Math.abs(s.y-o.y)+2,5),s.x-=l.origin.x,s.y-=l.origin.y,o.x-=l.origin.x,o.y-=l.origin.y,this.moveEventDragLine.attr("x1",Math.floor(s.x)+.5).attr("y1",Math.floor(s.y)+.5).attr("x2",Math.floor(o.x)+.5).attr("y2",Math.floor(o.y)+.5),this.uiDrawingSvg.attr("width",l.size.width?l.size.width*this.scaleFactor:1).attr("height",l.size.height?l.size.height*this.scaleFactor:1).attr("viewBox","0 0 "+l.size.width+" "+l.size.height).style("left",l.origin.x*this.scaleFactor).style("top",l.origin.y*this.scaleFactor),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null)):(this.moveEventDragLine&&(this.moveEventDragLine.remove(),this.moveEventDragLine=null),this.moveEventDragTargetBox&&(this.moveEventDragTargetBox.remove(),this.moveEventDragTargetBox=null))},ATTimelineViewPainter.prototype.drawMoveLaneLine=function(){var t,e;this.timelineView.laneDragEndLane!=this.timelineView.laneDragStartingLane?(t=this.timelineView.laneDragEndPos.y<this.timelineView.laneDragStartPos.y?new ATPoint(0,this.timelineView.laneDragEndLane.get("top")+1):new ATPoint(0,this.timelineView.laneDragEndLane.get("top")+this.timelineView.laneDragEndLane.get("height")),e=this.timelineView.absoluteToRelativePoint(t),this.moveLaneDragLine||(this.moveLaneDragLine=this.uiDrawingSvg.append("line").attr("class","dragLaneLine")),this.uiDrawingSvg.attr("width","100%").attr("height",5).attr("viewBox","0 0 100% 5").style("left",0).style("top",e.y*this.scaleFactor-2),this.moveLaneDragLine.attr("x1",0).attr("y1",2).attr("x2","100%").attr("y2",2)):this.moveLaneDragLine&&(this.moveLaneDragLine.remove(),this.moveLaneDragLine=null)},ATTimelineViewPainter.prototype.redrawContextLens=function(){this.renderContextLens(this.contextLensLeftArrow,this.contextLensMiddle,this.contextLensRightArrow)},ATTimelineViewPainter.prototype.setHighlightString=function(t){this.highlightString=ATUtilities.regexEscapedString(t),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove()},ATTimelineViewPainter.prototype.render=function(t,e){this.timelineView.model&&!_.isEmpty(e)&&(this.renderFlags=e,this.renderLevel=this.RENDER_LEVEL_SELECTION,this.renderFlags.position&&(this.renderLevel=this.RENDER_LEVEL_POSITION),this.renderFlags.viewport&&(this.renderLevel=this.RENDER_LEVEL_VIEWPORT),this.renderFlags.size&&(this.renderLevel=this.RENDER_LEVEL_SIZE),this.renderFlags.zoom&&(this.renderLevel=this.RENDER_LEVEL_ZOOM),this.renderFlags.data&&(this.renderLevel=this.RENDER_LEVEL_DATA),this.renderFlags.viewport||this.renderFlags.zoom?(this.transitionDuration=0,$("#mainTimelineCanvas").addClass("immediate")):$("#mainTimelineCanvas").removeClass("immediate"),this.scaleFactor=this.timelineView.physicalScaleFactor,this.bookmarkAdd.style("display",null),this.renderFlags.data?(this.dataChangedLifetimeBgLayer(t),this.dataChangedAboveLayer(t),this.dataChangedOverlayLayer(t),(this.renderFlags.viewport||this.renderFlags.zoom)&&(this.scrollBackgroundLayer(t),this.scrollOverlayLayer(t)),window.isAeonWebExport&&this.bookmarkAdd.style("display","none")):(this.renderFlags.viewport||this.renderFlags.zoom)&&(this.scrollLifetimeBgLayer(t),this.scrollBackgroundLayer(t),this.scrollAboveLayer(t),this.scrollOverlayLayer(t)),this.updateEventLayer(t),this.highlightString?this.hilitor.apply(this.highlightString):this.hilitor.remove(),this.verticalAnimateToggledLaneIds=[],this.transitionDuration=this.defaultTransitionDuration)},ATTimelineViewPainter.prototype.scrollBackgroundLayer=function(t){var e;e=this.bgLayer.selectAll(".bgDateLine").data(t.headerData.sublabels),this.renderBackgroundDateLines(e)},ATTimelineViewPainter.prototype.scrollLifetimeBgLayer=function(t){var e;e=this.lifetimeBgLayer.selectAll(".laneG").data(_.values(t.lanes),function(t){return t.id}),this.transformLaneG(e),this.renderLifetimeBoundsStart(e.select(".bgBoundsStart"),0),this.renderLifetimeBoundsEnd(e.select(".bgBoundsEnd"),0),this.renderNewBgLanes(e.enter().append("g")),e.exit().remove()},ATTimelineViewPainter.prototype.dataChangedLifetimeBgLayer=function(t){var e;e=this.lifetimeBgLayer.selectAll(".laneG").data(_.values(t.lanes),function(t){return t.id}),this.transformLaneG(e.transition().duration(this.transitionDuration)),this.renderLifetimeBoundsStart(e.select(".bgBoundsStart"),this.transitionDuration),this.renderLifetimeBoundsEnd(e.select(".bgBoundsEnd"),this.transitionDuration),this.renderNewBgLanes(e.enter().append("g")),e.exit().remove()},ATTimelineViewPainter.prototype.renderNewBgLanes=function(t){this.transformLaneG(t.attr("class","laneG")),this.renderLifetimeBoundsStart(t.append("rect").attr("class","bgBoundsStart").attr("x",0).attr("y",0)),this.renderLifetimeBoundsEnd(t.append("rect").attr("class","bgBoundsEnd").attr("y",0).attr("width","100%"))},ATTimelineViewPainter.prototype.renderLifetimeBoundsStart=function(t,e){var i=this;return e>0?t.transition().duration(e).attr("width",function(t){if(t.lifetimeBounds.hasStart){var e=i.timelineView.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.start,0));return Math.max(0,Math.round(e.x))}return 0}).attr("height",function(t){return t.height}):t.attr("width",function(t){if(t.lifetimeBounds.hasStart){var e=i.timelineView.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.start,0));return Math.max(0,Math.round(e.x))}return 0}).attr("height",function(t){return t.height}),t},ATTimelineViewPainter.prototype.renderLifetimeBoundsEnd=function(t,e){var i=this;return e>0?t.transition().duration(e).attr("x",function(t){if(t.lifetimeBounds.hasStop){var e=i.timelineView.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.stop,0));return Math.max(0,Math.round(e.x))}return 1e5}).attr("height",function(t){return t.height}):t.attr("x",function(t){if(t.lifetimeBounds.hasStop){var e=i.timelineView.absoluteToRelativePoint(new ATPoint(t.lifetimeBounds.stop,0));return Math.max(0,Math.round(e.x))}return 1e5}).attr("height",function(t){return t.height}),t},ATTimelineViewPainter.prototype.enableEventDrag=function(){if(!this.eventDragEnabled){this.eventDragEnabled=!0;this.eventLayer.selectAll(".eventDivWrapper").call(this.timelineView.eventDrag)}},ATTimelineViewPainter.prototype.disableEventDrag=function(){if(this.eventDragEnabled){this.eventDragEnabled=!1;this.eventLayer.selectAll(".eventDivWrapper").on(".drag",null)}},ATTimelineViewPainter.prototype.updateEventLayer=function(t){var e,i=this;(e=this.eventLayer.selectAll(".laneDivWrapper").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").classed("laneDivWrapper",!0).style(this.transformLabel,"translate(0px,0px)").append("div").classed("laneDivEmptyState",!0).text("You have no events in this group. Click to Add Event."),e.each(function(t){i.renderIndividualLaneEventGroup(this,t)}),e.exit().remove()},ATTimelineViewPainter.prototype.renderIndividualLaneEventGroup=function(t,e){var i,n=this,a=d3.select(t),r=this.timelineView.absoluteToRelativePoint(new ATPoint(0,e.top)),s=a.selectAll(".eventDivWrapper").data(e.nodes,function(t){return t.id});this.renderLevel>this.RENDER_LEVEL_SELECTION&&(i=this.transitionDuration?a.transition().duration(this.transitionDuration):a,a.classed("collapsed",e.collapsed),i.style(this.transformLabel,"translate(0px,"+Math.round(r.y*this.scaleFactor)+"px)"),s.each(function(t){n.updateIndividualEvent(this,t)}),s.enter().append("div").each(function(t){var e=d3.select(this),i=n.transitionDuration?e.transition().duration(n.transitionDuration):e;n.createIndividualEvent(this,e,t),n.updateIndividualEventPosition(this,i,t)}),a.select(".laneDivEmptyState").style("display",e.empty&&!e.collapsed?null:"none").html(e.emptyText)),this.renderFlags.selection&&(s.classed("selected",function(t){return t.selected&&!t.isLaneCollapsed}),s.selectAll(".editModeCheckbox").select("use").attr("xlink:href",function(t){return t.selected?"#checkboxTick":"#checkbox"})),this.renderLevel>this.RENDER_LEVEL_SELECTION&&s.exit().remove()},ATTimelineViewPainter.prototype.createIndividualEvent=function(t,e,i){var n=this.timelineView.absoluteToRelativePoint(new ATPoint(i.totalRect.left(),0)),a=this.verticalAnimateToggledLaneIds.length,r=i.totalRect.top();e.classed("eventDivWrapper",!0).style("width",MyRound(i.totalRect.size.width,this.scaleFactor)+"px").style("height",MyRound(i.totalRect.size.height,this.scaleFactor)+"px").style("opacity",a?1:0),window.mainApp.isIos?e.style(this.transformLabel,"translate("+MyRound(n.x,this.scaleFactor)+"px,"+MyRound(r,this.scaleFactor)+"px)"):e.style("top",MyRound(r,this.scaleFactor)+"px").style("left",MyRound(n.x,this.scaleFactor)+"px"),this.eventDragEnabled&&this.timelineView.eventDrag&&e.call(this.timelineView.eventDrag),e.append("svg").classed("markerSvg",!0).attr("xmlns","http://www.w3.org/2000/svg").append("polygon").classed("markerRect",!0),this.updateIndividualEventContent(t,e,i),this.updateIndividualEventSize(t,e,e,i)},ATTimelineViewPainter.prototype.updateIndividualEvent=function(t,e){var i=d3.select(t),n=this.transitionDuration?i.transition().duration(this.transitionDuration):i;this.renderLevel>=this.RENDER_LEVEL_DATA&&this.updateIndividualEventContent(t,i,e),this.renderLevel>=this.RENDER_LEVEL_SIZE&&this.updateIndividualEventSize(t,i,n,e),this.renderLevel>=this.RENDER_LEVEL_POSITION&&this.updateIndividualEventPosition(t,n,e)},ATTimelineViewPainter.prototype.updateIndividualEventContent=function(t,e,i){var n,a,r=this.timelineView.showEventDate,s=e.select(".markerSvg"),o=i.color;e.attr("pointer-events",i.visible?null:"none").classed("isFaded",i.isFaded).classed("expanded",i.showMore).classed("parent",i.showChildNodes).classed("selected",i.selected&&!i.isLaneCollapsed),i.isLaneCollapsed?(e.select(".eventContentWrapper").remove(),e.select(".showMoreSpan").remove(),e.select(".editModeCheckbox").remove()):(e.select(".eventContentWrapper").empty()&&this.createIndividualEventContents(e),e.select(".eventTitle").text(i.displayTitle),e.select(".eventDate").text(i.dateString).classed("parent",i.showChildNodes).style("display",i.showMore||r?null:"none"),window.mainApp.isIos||(a=e.select(".expandedWrapper").html(i.showMore?i.contentHTML:""),i.showMore&&this.listenToEventLinkClicks(a,i),e.select(".showMoreSpan").classed("fa-chevron-circle-right",!i.showMore).classed("fa-chevron-circle-left",i.showMore)),e.select(".editModeCheckbox").style("top",i.totalRect.size.height/2-10+"px").select("use").attr("xlink:href",i.selected?"#checkboxTick":"#checkbox")),(n=e.select(".markerSvg").selectAll(".markerRect").data(i.markerPoints).attr("class","markerRect "+o)).enter().append("polygon").attr("class","markerRect "+o),n.exit().remove(),i.isParent&&!i.isLaneCollapsed?(e.select(".childRectDiv").empty()&&this.createIndividualParentComponents(e,s,i),e.select(".childRectDiv").style("opacity",i.showChildNodes?1:0).attr("class","childRectDiv "+o),(n=e.select(".markerSvg").selectAll(".parentStack2").data(i.markerPoints).attr("class","parentStack2 "+o)).enter().insert("polygon",":first-child").classed("parentStack2",!0).attr("transform","translate(6,6)").attr("class","parentStack2 "+o),n.exit().remove(),(n=e.select(".markerSvg").selectAll(".parentStack1").data(i.markerPoints).attr("class","parentStack1 "+o)).enter().insert("polygon",".markerRect").classed("parentStack1",!0).attr("transform","translate(3,3)").attr("class","parentStack1 "+o),n.exit().remove(),window.mainApp.isIos?e.select(".parentArrowSpan").classed("downArrow",i.visible&&!i.showChildNodes).classed("upArrow",i.visible&&i.showChildNodes):e.select(".parentBulletSpan").classed("fa-plus-circle",i.visible&&!i.showChildNodes).classed("fa-minus-circle",i.visible&&i.showChildNodes)):this.removeIndividualParentComponents(e,s)},ATTimelineViewPainter.prototype.updateIndividualEventSize=function(t,e,i,n){var a=window.mainApp.isIos?5:3;i.style("width",MyCeil(n.totalRect.size.width+n.widthAdjustToOptimise,this.scaleFactor)+"px").style("height",MyCeil(n.totalRect.size.height,this.scaleFactor)+"px"),i.select(".eventContentWrapper").style("width",MyCeil(n.textSize.width,this.scaleFactor)+"px").style("height",MyCeil(n.textSize.height,this.scaleFactor)+"px"),window.mainApp.isIos||(e.select(".expandedWrapper").style("width",n.showMore?MyRound(n.textSize.width,this.scaleFactor)+"px":"0px"),i.select(".expandedWrapper").style("height",n.showMore?MyRound(n.textSize.height,this.scaleFactor)+"px":"0px")),i.select(".markerSvg").attr("viewBox","0 0 "+(n.markerRect.size.width+n.widthAdjustToOptimise)+" "+n.markerRect.size.height).attr("width",MyCeil(n.markerRect.size.width+n.widthAdjustToOptimise,this.scaleFactor)+"px").attr("height",MyCeil(n.markerRect.size.height,this.scaleFactor)+"px"),this.transitionDuration?e.select(".markerSvg").selectAll(".markerRect").data(n.markerPoints).transition().duration(this.transitionDuration).attr("points",function(t){return t}).attr("transform","translate("+n.translateMarkerX+",0)"):e.select(".markerSvg").selectAll(".markerRect").data(n.markerPoints).attr("points",function(t){return t}).attr("transform","translate("+n.translateMarkerX+",0)"),n.isParent&&!n.isLaneCollapsed&&(this.transitionDuration?(e.select(".childRectDiv").transition().duration(this.transitionDuration).style("width",n.childRect.size.width>0?MyRound(n.childRect.size.width+n.widthAdjustToOptimise+10,this.scaleFactor)+"px":"0px").style("height",MyRound(n.childRect.size.height,this.scaleFactor)+"px"),e.selectAll(".parentStack2").data(n.markerPoints).transition().duration(this.transitionDuration).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+2*a)+","+2*a+")"),e.selectAll(".parentStack1").data(n.markerPoints).transition().duration(this.transitionDuration).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+a)+","+a+")")):(e.select(".childRectDiv").style("width",n.childRect.size.width>0?MyRound(n.childRect.size.width+n.widthAdjustToOptimise+10,this.scaleFactor)+"px":"0px").style("height",MyRound(n.childRect.size.height,this.scaleFactor)+"px"),e.selectAll(".parentStack2").data(n.markerPoints).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+2*a)+","+2*a+")"),e.selectAll(".parentStack1").data(n.markerPoints).attr("points",function(t){return t}).attr("transform","translate("+(n.translateMarkerX+a)+","+a+")")),window.mainApp.isIos?i.select(".parentArrowSpan").style("left",n.bulletPos?MyRound(n.bulletPos.x+n.widthAdjustToOptimise,this.scaleFactor)+"px":null):i.select(".parentBulletSpan").style("left",n.bulletPos?MyRound(n.bulletPos.x+n.widthAdjustToOptimise,this.scaleFactor)+"px":null))},ATTimelineViewPainter.prototype.updateIndividualEventPosition=function(t,e,i){var n=window.mainApp.isIos?5:3,a=this.timelineView.absoluteToRelativePoint(new ATPoint(i.totalRect.left(),0));a.x+=i.positionAdjustToOptimise,window.mainApp.isIos?e.style(this.transformLabel,"translate("+MyRound(a.x,this.scaleFactor)+"px,"+MyRound(i.totalRect.top(),this.scaleFactor)+"px)"):e.style("top",MyRound(i.totalRect.top(),this.scaleFactor)+"px").style("left",MyRound(a.x,this.scaleFactor)+"px"),e.style("opacity",i.visible?1:0),(i.widthAdjustToOptimise||i.translateMarkerX)&&(e.style("width",MyRound(i.totalRect.size.width+i.widthAdjustToOptimise,this.scaleFactor)+"px"),e.select(".markerSvg").attr("viewBox","0 0 "+(i.markerRect.size.width+i.widthAdjustToOptimise)+" "+i.markerRect.size.height).attr("width",MyRound(i.markerRect.size.width+i.widthAdjustToOptimise,this.scaleFactor)+"px"),e.select(".markerRect").attr("transform","translate("+i.translateMarkerX+",0)"),i.isParent&&!i.isLaneCollapsed&&(e.select(".childRectDiv").style("width",i.childRect.size.width>0?MyRound(i.childRect.size.width+i.widthAdjustToOptimise+10,this.scaleFactor)+"px":"0px"),e.select(".parentStack2").attr("transform","translate("+(i.translateMarkerX+2*n)+","+2*n+")"),e.select(".parentStack1").attr("transform","translate("+(i.translateMarkerX+n)+","+n+")"),window.mainApp.isIos?e.select(".parentArrowSpan").style("left",i.bulletPos?MyRound(i.bulletPos.x+i.widthAdjustToOptimise,this.scaleFactor)+"px":null):e.select(".parentBulletSpan").style("left",i.bulletPos?MyRound(i.bulletPos.x+i.widthAdjustToOptimise,this.scaleFactor)+"px":null)))},ATTimelineViewPainter.prototype.createIndividualEventContents=function(t){window.mainApp.isIos?t.append("svg").classed("editModeCheckbox",!0).on("click",function(t){window.mainApp.timelineView.editModeCheckboxClicked(t)}).append("use").attr("xlink:href","#checkbox"):t.append("span").classed("showMoreSpan fa",!0).on("click",function(t){window.mainApp.timelineView.toggleMoreEventInfo(t)});var e=t.append("div").classed("eventContentWrapper",!0);e.append("div").classed("eventTitle draggable",!0),e.append("div").classed("eventDate draggable",!0),window.mainApp.isIos||e.append("div").classed("expandedWrapper draggable",!0)},ATTimelineViewPainter.prototype.createIndividualParentComponents=function(t,e,i){var n=window.mainApp.isIos?5:3;t.insert("div",".markerSvg").classed("childRectDiv",!0).style("left",MyRound(i.childRect.origin.x,this.scaleFactor)+"px").style("width",i.childRect.size.width>0?MyRound(i.childRect.size.width-i.widthAdjustToOptimise+10,this.scaleFactor)+"px":"10px").style("height",0).style("opacity",0),e.insert("polygon",".markerRect").classed("parentStack2",!0).attr("transform","translate("+2*n+","+2*n+")"),e.insert("polygon",".markerRect").classed("parentStack1",!0).attr("transform","translate("+n+","+n+")"),e.on("dblclick",function(){i.visible&&(window.mainApp.timelineView.toggleShowChildNodes(i.id,i.laneId),d3.event.stopPropagation())}),window.mainApp.isIos?t.insert("span",".editModeCheckbox").classed("parentArrowSpan",!0).on("click",function(){window.mainApp.timelineView.toggleShowChildNodes(i.id,i.laneId),d3.event.stopPropagation(),d3.event.preventDefault()}).on("dblclick",function(){d3.event.stopPropagation(),d3.event.preventDefault()}).append("svg").append("use").attr("xlink:href","#up"):t.insert("span",".showMoreSpan").classed("parentBulletSpan fa",!0).on("click",function(){window.mainApp.timelineView.toggleShowChildNodes(i.id,i.laneId),d3.event.stopPropagation()}).on("dblclick",function(){d3.event.stopPropagation()})},ATTimelineViewPainter.prototype.removeIndividualParentComponents=function(t,e){t.select(".childRectDiv").remove(),e.selectAll(".parentStack2").remove(),e.selectAll(".parentStack1").remove(),window.mainApp.isIos?t.select(".parentArrowSpan").remove():t.select(".parentBulletSpan").remove(),e.on("dblclick",null)},ATTimelineViewPainter.prototype.listenToEventLinkClicks=function(t,e){t.selectAll(".externalLinkAnchor").on("click",function(t,i){var n=[];return!!window.isAeonWebExport||(_.each(e.links,function(t){n.push({filepath:t.path})}),window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(n),i),d3.event.stopPropagation(),d3.event.preventDefault(),!1)}),t.selectAll(".attachmentAnchor").on("click",function(t,i){var n=[];return!!window.isAeonWebExport||(_.each(e.attachments,function(t){n.push({filepath:t.path})}),window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(n),i),d3.event.stopPropagation(),d3.event.preventDefault(),!1)}),t.select(".eventImage").on("dblclick",function(t){var e=[{filepath:t.fullImagePath}];return!!window.isAeonWebExport||(window.ApplicationInterface&&window.ApplicationInterface.quicklookExternalLinkGroup(window.timelineDocumentId,JSON.stringify(e),0),d3.event.stopPropagation(),d3.event.preventDefault(),!1)})},ATTimelineViewPainter.prototype.createIndividualLaneHeaderDiv=function(t){var e=d3.select(t).classed("laneHeaderDiv",!0).style(this.transformLabel,"translateY(0px)");this.timelineView.laneDrag&&e.call(this.timelineView.laneDrag),window.mainApp.isIos||e.append("span").classed("laneDivArrow fa",!0).on("click",function(t){window.mainApp.timelineView.toggleLane(t.id)}),e.append("span").classed("laneDivLabel",!0)},ATTimelineViewPainter.prototype.renderIndividualLaneHeaderDiv=function(t,e){var i=this,n=d3.select(t),a=n.selectAll(".lifetimeMarkerSpan").data(e.lifetimeMarks),r=i.timelineView.absoluteToRelativePoint(new ATPoint(0,e.top)).y;r<0&&(r+=Math.min(-r,e.height-TimelineDisplayConstants.lifetimeHeight)),n.classed("collapsed",e.collapsed).classed("odd",e.odd),window.mainApp.isIos||n.select(".laneDivArrow").classed("fa-chevron-up",!e.collapsed).classed("fa-chevron-down",e.collapsed),n.select(".laneDivLabel").text(e.entityName),a.enter().append("span").classed("lifetimeMarkerSpan",!0).style(this.transformLabel,"translateX(0px)"),a.classed("lifetimeMarkerDot",function(t){return t.showDot}).text(function(t){return t.text}),a.exit().remove(),this.transitionDuration?(n.transition().duration(this.transitionDuration).style(this.transformLabel,"translate(0px,"+r*this.scaleFactor+"px)"),a.transition().duration(this.transitionDuration).style("left",function(t){return i.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x*i.scaleFactor+"px"})):(n.style(this.transformLabel,"translate(0px,"+r*this.scaleFactor+"px)"),a.style("left",function(t){return i.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x*i.scaleFactor+"px"}))},ATTimelineViewPainter.prototype.transformLaneG=function(t){var e=this,i=t.select(".lifetimeG");return this.transformLifetimeG(i),t.attr("class",function(t){return t.collapsed?"laneG collapsed":"laneG"}).attr("transform",function(t){var i=e.timelineView.absoluteToRelativePoint(new ATPoint(0,t.top));return"translate(0,"+Math.round(i.y)+")"})},ATTimelineViewPainter.prototype.transformLifetimeG=function(t){var e=this;return t.attr("transform",function(t){var i,n=e.timelineView.absoluteToRelativePoint(new ATPoint(0,t.top));return i=n.y<0?Math.min(-n.y,t.height-TimelineDisplayConstants.lifetimeHeight):0,"translate(0,"+Math.round(i)+")"})},ATTimelineViewPainter.prototype.scrollAboveLayer=function(t){var e=this.dependencyG.selectAll(".dependencyPath").data(t.dependencyPaths,function(t){return t.name});window.mainApp.isIos&&!this.iosDependencyTranslated&&(this.dependencyG.attr("transform","translate(0,3.0)"),this.iosDependencyTranslated=!0),this.renderDependencyPaths(e,0)},ATTimelineViewPainter.prototype.dataChangedAboveLayer=function(t){var e=this.dependencyG.selectAll(".dependencyPath").data(t.dependencyPaths,function(t){return t.name});window.mainApp.isIos&&!this.iosDependencyTranslated&&(this.dependencyG.attr("transform","translate(0,3.0)"),this.iosDependencyTranslated=!0),this.renderDependencyPaths(e,this.transitionDuration)},ATTimelineViewPainter.prototype.renderDependencyPaths=function(t,e){var i=this;return e>0?t.attr("class",function(t){return"dependencyPath "+t.color}).transition().duration(e).attr("d",function(t){var e=i.timelineView.absoluteToRelativePoint(t.start);return"M"+e.x+","+e.y+t.path}):t.attr("class",function(t){return"dependencyPath "+t.color}).attr("d",function(t){var e=i.timelineView.absoluteToRelativePoint(t.start);return"M"+e.x+","+e.y+t.path}),t.enter().append("path").attr("class",function(t){return"dependencyPath "+t.color}).attr("d",function(t){var e=i.timelineView.absoluteToRelativePoint(t.start);return"M"+e.x+","+e.y+t.path}),t.exit().remove(),t},ATTimelineViewPainter.prototype.scrollOverlayLayer=function(t){var e,i,n,a,r,s,o,l,c,d,h,p=window.mainApp.isIphone?10:0,m=this;(e=this.laneOverlayLayer.selectAll(".laneHeaderDiv").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").each(function(){m.createIndividualLaneHeaderDiv(this)}),e.each(function(t,e){m.renderIndividualLaneHeaderDiv(this,t,e)}),e.exit().remove(),i=this.staticTimeHeaderG.selectAll(".timeHdrLabel").data(t.headerData.labels),this.renderHeaderLabels(i),n=this.staticTimeHeaderG.selectAll(".timeHdrLine").data(t.headerData.labels),this.renderHeaderLines(n),a=this.staticTimeHeaderG.selectAll(".timeHdrSubLabel").data(t.headerData.sublabels),this.renderSubHeaderLabels(a),r=this.staticTimeHeaderG.selectAll(".timeHdrSubDot").data(t.headerData.sublabels),this.renderSubHeaderDots(r),null!=t.nowXPosition?((d=m.timelineView.absoluteToRelativePoint(new ATPoint(t.nowXPosition,0))).x<-100&&(d.x=-100),d.x>this.timelineView.viewport.size.width+100&&(d.x=this.timelineView.viewport.size.width+100),this.staticTimeHeaderNowG.style(this.transformLabel,"translate("+(ATUtilities.floatToInt(d.x)+.5)+"px,"+p+"px)").style("opacity",1),this.staticTimeHeaderNowG.select("rect").attr("y",window.mainApp.isIos?-9:42),this.staticTimeHeaderNowG.select("text").attr("y",window.mainApp.isIos?0:51),this.staticTimeHeaderNowG.select("line").attr("y1",window.mainApp.isIos?-9:60).attr("y2",window.mainApp.isIos?-4e3:4e3)):this.staticTimeHeaderNowG.style("opacity",0),c=this.laneNavSvg.selectAll(".laneNav").data(t.navigationLanes,function(t){return t.id}),this.renderLaneNav(c),this.verticalScrollKnob||(this.verticalScrollTrack=this.laneNavSvg.append("rect").attr("class","scrollTrack").attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("rx",0).attr("ry",0).on("click",function(){return m.timelineView.clickInScrollTrack()}),this.verticalScrollKnob=this.laneNavSvg.append("rect").attr("class","scrollknob").attr("width",TimelineDisplayConstants.scrollKnobThickness).attr("rx",TimelineDisplayConstants.scrollKnobThickness/2).attr("ry",TimelineDisplayConstants.scrollKnobThickness/2),this.timelineView.verticalScrollDrag&&this.verticalScrollKnob.call(this.timelineView.verticalScrollDrag),this.$verticalScrollKnob=$(".timelineContentDiv .scrollknob"),this.contextLensG=this.contextLensLayer.append("g").attr("class","contextLensG"),this.lastDisplayedSkin=this.timelineView.skin,h=TimelineDisplayConstants.contextLensRootFolder+this.timelineView.skin+"/",this.contextLensLeftArrow=this.contextLensG.append("image").attr("width",13).attr("height",TimelineDisplayConstants.contextHeight).attr("xlink:href",h+TimelineDisplayConstants.contextLensImageLeftArrowHref).attr("preserveAspectRatio","none").attr("class","contextLensImage resizable"),this.contextLensMiddle=this.contextLensG.append("image").attr("width",24).attr("height",TimelineDisplayConstants.contextHeight).attr("xlink:href",h+TimelineDisplayConstants.contextLensImageMiddleHref).attr("preserveAspectRatio","none").attr("class","contextLensImage"),this.contextLensRightArrow=this.contextLensG.append("image").attr("width",13).attr("height",TimelineDisplayConstants.contextHeight).attr("xlink:href",h+TimelineDisplayConstants.contextLensImageRightArrowHref).attr("preserveAspectRatio","none").attr("class","contextLensImage resizable"),this.timelineView.contextLensDrag&&(this.contextLensLeftArrow.call(this.timelineView.contextLensDrag),this.contextLensMiddle.call(this.timelineView.contextLensDrag),this.contextLensRightArrow.call(this.timelineView.contextLensDrag))),this.renderVerticalScrollBar(this.verticalScrollKnob,this.verticalScrollTrack),s=this.contextBarG.selectAll(".contextBarLabel").data(t.contextLabels,function(t){return t.text}),this.renderContextBarLabels(s),o=this.contextBarG.selectAll(".contextBarDot").data(t.contextDots,function(t){return t.id}),this.renderContextBarDots(o,0),l=this.contextBarG.selectAll(".contextBarLine").data(t.contextLabels,function(t){return t.text}),this.renderContextBarLines(l),this.renderContextLens(this.contextLensLeftArrow,this.contextLensMiddle,this.contextLensRightArrow)},ATTimelineViewPainter.prototype.skinChanged=function(){if(this.lastDisplayedSkin&&this.lastDisplayedSkin!=this.timelineView.skin){var t=TimelineDisplayConstants.contextLensRootFolder+this.timelineView.skin+"/";this.lastDisplayedSkin=this.timelineView.skin,this.contextLensLeftArrow.attr("xlink:href",t+TimelineDisplayConstants.contextLensImageLeftArrowHref),this.contextLensMiddle.attr("xlink:href",t+TimelineDisplayConstants.contextLensImageMiddleHref),this.contextLensRightArrow.attr("xlink:href",t+TimelineDisplayConstants.contextLensImageRightArrowHref)}},ATTimelineViewPainter.prototype.dataChangedOverlayLayer=function(t){var e,i,n,a,r,s,o,l,c,d=this;(i=this.laneOverlayLayer.selectAll(".laneHeaderDiv").data(_.values(t.lanes),function(t){return t.id})).enter().append("div").each(function(){d.createIndividualLaneHeaderDiv(this)}),i.each(function(t,e){d.renderIndividualLaneHeaderDiv(this,t,e)}),i.exit().remove(),e=this.laneNavSvg.selectAll(".laneNav").data(t.navigationLanes,function(t){return t.id}),this.renderLaneNav(e.transition().duration(this.transitionDuration)),this.renderLaneNav(e.enter().append("rect").attr("width",TimelineDisplayConstants.laneNavNodeWidth).attr("rx",TimelineDisplayConstants.laneNavNodeWidth/2).attr("ry",TimelineDisplayConstants.laneNavNodeWidth/2).attr("x",TimelineDisplayConstants.scrollTrackNoLaneNavThickness).on("click",function(t){window.mainApp.timelineView.scrollToLane(t)})),e.exit().transition().duration(this.transitionDuration).remove(),r=this.staticTimeHeaderG.selectAll(".timeHdrLabel").data(t.headerData.labels),this.renderHeaderLabels(r),s=this.staticTimeHeaderG.selectAll(".timeHdrLine").data(t.headerData.labels),this.renderHeaderLines(s),o=this.staticTimeHeaderG.selectAll(".timeHdrSubLabel").data(t.headerData.sublabels),this.renderSubHeaderLabels(o),a=this.staticTimeHeaderG.selectAll(".timeHdrSubDot").data(t.headerData.sublabels),this.renderSubHeaderDots(a),null!=t.nowXPosition?(c=d.timelineView.absoluteToRelativePoint(new ATPoint(t.nowXPosition,0)),this.staticTimeHeaderNowG.style(this.transformLabel,"translate("+(ATUtilities.floatToInt(c.x)+.5)+"px,0)").style("opacity",1)):this.staticTimeHeaderNowG.style("opacity",0),(n=this.bookmarkGroup.selectAll(".bookmarkItem").data(t.bookmarks)).select("span.bookmarkName").text(function(t){return t.name}),n.select("span.bookmarkItemRemove").classed("fa",!0),this.renderNewBookmarks(n.enter().append("div")),n.exit().remove(),l=this.contextBarG.selectAll(".contextBarDot").data(t.contextDots,function(t){return t.id}),this.renderContextBarDots(l,this.transitionDuration),this.verticalScrollKnob&&this.verticalScrollTrack&&this.renderVerticalScrollBar(this.verticalScrollKnob,this.verticalScrollTrack)},ATTimelineViewPainter.prototype.renderHeaderLabels=function(t){var e=this;return t.attr("x",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition+5,0)).x}).text(function(t){return t.text}),t.enter().append("text").text(function(t){return t.text}).attr("class","timeHdrLabel").attr("x",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition+5,0)).x}).attr("y",TimelineDisplayConstants.mainTickTextOffsetY),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderHeaderLines=function(t){var e=this;return t.attr("x1",function(t){var i=e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(i.x)+.5}).attr("x2",function(t){var i=e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(i.x)+.5}),t.enter().append("line").attr("class","timeHdrLine").attr("x1",function(t){var i=e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(i.x)+.5}).attr("x2",function(t){var i=e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(i.x)+.5}).attr("y1",0).attr("y2",TimelineDisplayConstants.mainTickLineHeight),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderSubHeaderLabels=function(t){var e=this;return t.attr("x",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x}).text(function(t){return t.text}),t.enter().append("text").text(function(t){return t.text}).attr("class","timeHdrSubLabel").attr("x",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x}).attr("y",TimelineDisplayConstants.subTickTextOffsetY).style("text-anchor","middle"),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderSubHeaderDots=function(t){var e=this;return t.attr("cx",function(t){var i=e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(i.x)}),t.enter().append("circle").attr("class","timeHdrSubDot").attr("cx",function(t){var i=e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0));return Math.round(i.x)}).attr("cy",TimelineDisplayConstants.subTickCircleOffsetY).attr("r",TimelineDisplayConstants.subTickCircleRadius),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderBackgroundDateLines=function(t){var e=this;return t.attr("x1",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x+.5}).attr("x2",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x+.5}),t.enter().append("line").attr("class","bgDateLine").attr("x1",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x+.5}).attr("x2",function(t){return e.timelineView.absoluteToRelativePoint(new ATPoint(t.xPosition,0)).x+.5}).attr("y1",0).attr("y2","120%"),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderLaneNav=function(t){var e=TimelineDisplayConstants.scrollTrackTopMargin,i=this.timelineView.viewport.top()+e,n=this.timelineView.viewport.size.height-e,a=this.timelineView.rangeY.max;return t.attr("class",function(t){return i>=t.top&&i<t.top+t.height?"laneNav current":"laneNav"}).attr("y",function(t){return t.top/a*n+e+1}).attr("height",function(t){return Math.max(0,t.height/a*n-2)}),t.each(function(t){var e=$(this),i=Math.max(0,t.height/a*n-2),r=e.data("opentips");r&&r[0]?window.mainApp.isMac||(r[0].options.offset=[0,i/2]):new Opentip(this,t.entityName,{style:"laneNodeTooltipStyle",offset:window.mainApp.isMac?[0,0]:[0,i/2]})}),t},ATTimelineViewPainter.prototype.renderVerticalScrollBar=function(t,e){var i=TimelineDisplayConstants.scrollTrackTopMargin,n=this.timelineView.viewport.top()+i,a=this.timelineView.viewport.size.height-i,r=this.timelineView.rangeY.max,s=r>0?ATUtilities.floatToInt(n/r*a+i):0,o=r>0?ATUtilities.floatToInt(a/r*a):r,l=Math.max(.5,TimelineDisplayConstants.scrollKnobXPosition-2.5),c=o<a;return e.attr("x",l).attr("y",i).attr("width",TimelineDisplayConstants.scrollTrackThickness).attr("height",a).style("fill-opacity",c?TimelineDisplayConstants.scrollTrackOpacity:0).style("stroke-opacity",c?null:0),o==a||s===this.verticalScrollKnobTop&&o==this.verticalScrollKnobHeight&&this.timelineView.viewport.size.width==this.verticalScrollKnobRight||t.attr("x",TimelineDisplayConstants.scrollKnobXPosition).style("fill-opacity",c?TimelineDisplayConstants.scrollKnobOpacity:0).attr("y",s).attr("height",o).transition().delay(1e3).duration(500).style("fill-opacity",c?TimelineDisplayConstants.scrollKnobFadeOpacity:0),this.verticalScrollTrackHeight=a,this.verticalScrollKnobTop=s,this.verticalScrollKnobHeight=o,this.verticalScrollKnobRight=this.timelineView.viewport.size.width,t},ATTimelineViewPainter.prototype.renderContextBarLabels=function(t){return t.attr("x",function(t){return t.xPosition+TimelineDisplayConstants.contextBarLabelOffsetX}),t.enter().append("text").text(function(t){return t.text}).on("click",function(){window.mainApp.timelineView.contextBarClick()}).attr("class","contextBarLabel").attr("x",function(t){return t.xPosition+TimelineDisplayConstants.contextBarLabelOffsetX}).attr("y",TimelineDisplayConstants.contextBarLabelOffsetY),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderContextBarDots=function(t,e){return e>0?t.attr("class",function(t){return"contextBarDot "+t.color}).transition().duration(e).attr("x",function(t){return t.startPixel}).attr("width",function(t){return Math.max(t.stopPixel-t.startPixel,2*TimelineDisplayConstants.contextDotRadius)}):t.attr("class",function(t){return"contextBarDot "+t.color}).attr("x",function(t){return t.startPixel}).attr("width",function(t){return Math.max(t.stopPixel-t.startPixel,2*TimelineDisplayConstants.contextDotRadius)}),t.enter().append("rect").on("click",function(){window.mainApp.timelineView.contextBarClick()}).attr("class",function(t){return"contextBarDot "+t.color}).attr("x",function(t){return t.startPixel}).attr("width",function(t){return Math.max(t.stopPixel-t.startPixel,2*TimelineDisplayConstants.contextDotRadius)}).attr("y",TimelineDisplayConstants.contextDotOffsetY).attr("height",2*TimelineDisplayConstants.contextDotRadius).attr("rx",TimelineDisplayConstants.contextDotRadius).attr("ry",TimelineDisplayConstants.contextDotRadius),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderContextBarLines=function(t){return t.attr("x1",function(t){return t.xPosition+.5}).attr("x2",function(t){return t.xPosition+.5}),t.enter().append("line").attr("class","contextBarLine").attr("x1",function(t){return t.xPosition+.5}).attr("x2",function(t){return t.xPosition+.5}).attr("y1",0).attr("y1",TimelineDisplayConstants.contextHeight),t.exit().remove(),t},ATTimelineViewPainter.prototype.renderContextLens=function(t,e,i){t.attr("x",this.timelineView.contextLeftLensPixel-TimelineDisplayConstants.contextLensImageArrowWidth).attr("width",TimelineDisplayConstants.contextLensImageArrowWidth),e.attr("x",this.timelineView.contextLeftLensPixel).attr("width",Math.max(0,this.timelineView.contextRightLensPixel-this.timelineView.contextLeftLensPixel)),i.attr("x",this.timelineView.contextRightLensPixel).attr("width",TimelineDisplayConstants.contextLensImageArrowWidth)},ATTimelineViewPainter.prototype.renderNewBookmarks=function(t){return t.attr("class","bookmarkItem").on("click",function(t){window.mainApp.timelineView.bookmarkClick(t)}).append("span").classed("bookmarkName",!0).text(function(t){return t.name}),t.append("span").classed("bookmarkItemRemove fa fa-times-circle",!0).on("click",function(t){if(window.ApplicationInterface)return window.ApplicationInterface.removeBookmark(window.timelineDocumentId,t.id),d3.event.stopPropagation(),!1}),t},module.exports=ATTimelineViewPainter;

},{"../../../lib/hilitor2":7,"../../../lib/opentip":11,"../../controller/ATDisplayConstants":16,"../../utils/ATPoint":46,"../../utils/ATRect":48,"../../utils/ATUtilities":51,"d3":320,"jquery":331,"lodash":333}],203:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>Attachments</div>\n<% var listCount = 0; %>\n    <ul class='eventMoreList'>\n        <% _.each(event.get('attachments'),function(att) {\n                listCount++;\n        %>\n            <li><span><a href=\"<%= att.path %>\" <% if(window.isAeonWebExport) { %> target=\"_blank\" <% } %> class=\"attachmentAnchor\"><%= att.title %></a></span></li>\n        <%}); %>\n    <% if(listCount == 0) { %>\n        <li><span>None</span></li>\n    <% } %>\n    </ul>";

},{}],204:[function(require,module,exports){
module.exports="</div>";

},{}],205:[function(require,module,exports){
module.exports="<div class='eventContentColumn expanded'>\n";

},{}],206:[function(require,module,exports){
module.exports="\n<% \nif(event.get('imagePath')) { %>\n<img class=\"eventImage\" src=\"<%= event.get('imagePath').replace(/\\s/g,'%20') %>\" />\n<% } %>";

},{}],207:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>LINKS</div>\n<% var listCount = 0; %>\n    <ul class='eventMoreList'>\n        <% _.each(event.get('links'),function(link) {\n                listCount++;\n        %>\n            <li><span><a href=\"<%= link.path %>\" <% if(window.isAeonWebExport) { %> target=\"_blank\" <% } %> class=\"externalLinkAnchor\"><%= link.title %></a></span></li>\n        <%}); %>\n    <% if(listCount == 0) { %>\n        <li><span>None</span></li>\n    <% } %>\n    </ul>";

},{}],208:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreNormalValue'><%= event.get('values')['LABEL'] ? event.get('values')['LABEL'] : 'No' %></div>\n</div>";

},{}],209:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreNormalValue'><%= (event.get('values')['LABEL'] ? event.get('values')['LABEL']  : 0)%></div>\n</div>\n";

},{}],210:[function(require,module,exports){
module.exports="<% if(event.get('values')['LABEL'] && event.get('values')['LABEL'].length > 0) { %>\n<div class='eventMoreParagraph'><%= event.get('values')['LABEL'].replace(/\\n/g,'<br />') %></div>\n<% } %>";

},{}],211:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreProgressValue'><%= (event.get('values')['LABEL'] ? parseInt(event.get('values')['LABEL']) : '0') %>%</div>\n    <div class='eventProgressBar'>\n        <span style='width: <%= (event.get('values')['LABEL'] ? event.get('values')['LABEL'] : '0') %>%'></span>\n    </div>\n</div>\n";

},{}],212:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>\n    <div class='eventMoreHeading'>LABEL</div>\n    <div class='eventMoreNormalValue'><%= event.get('values')['LABEL'] %></div>\n</div>";

},{}],213:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>LABEL</div>\n<% var listCount = 0; %>\n    <ul class='eventMoreList'>\n        <% _.each(event.get('relationships'),function(relationship) {\n            if(relationship.role == 'LABEL') {\n                listCount++;\n        %>\n            <li><span><strong><%= relationship.entityName %></strong>\n            <% if(relationship.age) { %>\n                is <%= relationship.age %>\n            <% } %>\n            </span></li>\n        <% }\n        }); %>\n    <% if(listCount == 0) { %>\n        <li><span>None</span></li>\n    <% } %>\n    </ul>";

},{}],214:[function(require,module,exports){
module.exports="<div class='eventMoreHeadingGroup'>TAGS</div>\n<% var listCount = 0; %>\n    <ul class='eventMoreList'>\n        <% _.each(event.get('tags'),function(tag) {\n                listCount++;\n        %>\n            <li><span><%= tag %></span></li>\n        <%}); %>\n    <% if(listCount == 0) { %>\n        <li><span>None</span></li>\n    <% } %>\n    </ul>";

},{}],215:[function(require,module,exports){
module.exports=[{identifier:"tools",type:"buttonSelect",image:"Cog.png",selectable:!0,options:[{identifier:"expandAllLanes",text:"Expand All Groups",shortcut:"Ctrl+Shift+Down",global:!0},{identifier:"collapseAllLanes",text:"Collapse All Groups",shortcut:"Ctrl+Shift+Up",global:!0},{identifier:"hideAllDetails",text:"Hide All Event Details",shortcut:"Shift+Ctrl+Left",global:!0}]},{identifier:"search",type:"input",text:"Search",minWidth:150,maxWidth:300,placeholder:"Enter search term...",noSep:!0},{identifier:"findPrevious",type:"button",text:"",image:"FindPrevious.png",noSep:!0},{identifier:"findNext",type:"button",text:"",image:"FindNext.png",noSep:!0},{identifier:"zoomOut",type:"button",text:"Zoom",image:"ZoomOut.png",shortcut:"Ctrl+-",global:!0},{identifier:"zoom",type:"slider",text:"",minWidth:50,maxWidth:150,minValue:1,maxValue:100,noSep:!0},{identifier:"zoomIn",type:"button",text:"",image:"ZoomIn.png",noSep:!0,center:!0,shortcut:"Ctrl+=",global:!0},{identifier:"aeonLink",type:"button",text:"Powered by Aeon Timeline",image:"aeonIcon.png"}];

},{}],216:[function(require,module,exports){
function ATWelcomeScreen(){this.navMode=ATWelcomeNavMode.RECENT,d3.select("body").classed("welcomeScreen",!0),this.standardTemplates=[],this.customTemplates=[],this.exampleTimelines=[],this.recentTimelines=[],this.clickedIndex=-99,this.clickedNavMode=-99,d3.select("#bounds").html(welcomeHtml),this.templatesDiv=d3.select("#navItemTemplates"),this.customDiv=d3.select("#navItemCustom"),this.examplesDiv=d3.select("#navItemExamples"),this.recentDiv=d3.select("#navItemRecent"),this.standardCollectionDiv=d3.select("#standardCollection .collection"),this.customCollectionDiv=d3.select("#customCollection .collection"),this.d3FileListDiv=d3.select("#fileListRecent");var e=this;this.examplesDiv.on("click",function(t){e.exampleNavClicked()}),this.recentDiv.on("click",function(t){e.recentNavClicked()}),$("#openFileButton").on("click",function(){window.ApplicationInterface&&window.ApplicationInterface.openFile(window.timelineDocumentId)}),this.updateDisplay()}var $=require("jquery"),_=require("lodash"),d3=require("d3"),utf8=require("utf8"),Opentip=require("../lib/opentip"),Backbone=require("backbone"),ATToolbar=require("../timeline/view/desktop/ATToolbar"),welcomeHtml=require("./templates/welcomeWindow.html"),ATWelcomeNavMode={TEMPLATES:0,CUSTOM:1,EXAMPLES:2,RECENT:3};ATWelcomeScreen.prototype.findClickedItem=function(e){switch(e){case ATWelcomeNavMode.TEMPLATES:return this.standardTemplates[this.clickedIndex];case ATWelcomeNavMode.CUSTOM:return this.customTemplates[this.clickedIndex];case ATWelcomeNavMode.EXAMPLES:return this.exampleTimelines[this.clickedIndex];case ATWelcomeNavMode.RECENT:return this.recentTimelines[this.clickedIndex]}return null},ATWelcomeScreen.prototype.setStandardTemplates=function(e){this.standardTemplates=JSON.parse(e),_.each(this.standardTemplates,function(e){e.navMode=ATWelcomeNavMode.TEMPLATES}),this.updateDisplay()},ATWelcomeScreen.prototype.setCustomTemplates=function(e){this.customTemplates=JSON.parse(e),_.each(this.customTemplates,function(e){e.navMode=ATWelcomeNavMode.CUSTOM}),this.updateDisplay()},ATWelcomeScreen.prototype.setRecentFiles=function(e){var t=utf8.decode(atob(e));if(this.recentTimelines=JSON.parse(t),_.each(this.recentTimelines,function(e){e.navMode=ATWelcomeNavMode.RECENT}),this.updateDisplay(),window.appToolbar){var o=[],n=0;_.each(this.recentTimelines,function(e){o.push({identifier:"openRecent_"+n,text:e.name}),n++}),window.appToolbar.updateOptionsForIdentifier("openRecent",o)}},ATWelcomeScreen.prototype.setExampleFiles=function(e){this.exampleTimelines=JSON.parse(e),this.updateDisplay()},ATWelcomeScreen.prototype.enableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!1):console.log("enableToolbarItem FAILED because toolbar does not exist yet")},ATWelcomeScreen.prototype.disableToolbarItem=function(e){window.appToolbar?window.appToolbar.setDisabled([e],!0):console.log("disableToolbarItem FAILED because toolbar does not exist yet")},ATWelcomeScreen.prototype.exampleNavClicked=function(e){this.navMode!=ATWelcomeNavMode.EXAMPLES&&(this.navMode=ATWelcomeNavMode.EXAMPLES,this.examplesDiv.classed("selected",!0),this.recentDiv.classed("selected",!1),this.updateDisplay())},ATWelcomeScreen.prototype.recentNavClicked=function(e){this.navMode!=ATWelcomeNavMode.RECENT&&(this.navMode=ATWelcomeNavMode.RECENT,this.examplesDiv.classed("selected",!1),this.recentDiv.classed("selected",!0),this.updateDisplay())},ATWelcomeScreen.prototype.itemDblClicked=function(e,t){this.itemChooseClicked(e,t)},ATWelcomeScreen.prototype.itemClicked=function(e,t){this.clickedNavMode=e.navMode,this.clickedIndex=t,this.updateDisplay()},ATWelcomeScreen.prototype.itemChooseClicked=function(e,t){if(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),window.ApplicationInterface){var o=this.findClickedItem(e.navMode);e.navMode==ATWelcomeNavMode.TEMPLATES||e.navMode==ATWelcomeNavMode.CUSTOM?window.ApplicationInterface.chooseTemplate(window.timelineDocumentId,e.navMode,o.name,!1):window.ApplicationInterface.chooseFile(window.timelineDocumentId,e.navMode,o.url)}},ATWelcomeScreen.prototype.itemCustomizeClicked=function(e,t){if(d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation(),window.ApplicationInterface){var o=this.findClickedItem(e.navMode);e.navMode!=ATWelcomeNavMode.TEMPLATES&&e.navMode!=ATWelcomeNavMode.CUSTOM||window.ApplicationInterface.chooseTemplate(window.timelineDocumentId,e.navMode,o.name,!0)}},ATWelcomeScreen.prototype.itemCancelClicked=function(e,t){this.clickedIndex=-99,this.clickedNavMode=-99,this.updateDisplay(),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},ATWelcomeScreen.prototype.itemDeleteClicked=function(e){window.ApplicationInterface&&window.ApplicationInterface.deleteCustomTemplate(window.timelineDocumentId,e),d3.event.sourceEvent?d3.event.sourceEvent.stopPropagation():d3.event.stopPropagation()},ATWelcomeScreen.prototype.updateNavDisplay=function(){var e=this,t=this.navMode==ATWelcomeNavMode.EXAMPLES?this.exampleTimelines:this.recentTimelines,o=this.d3FileListDiv.selectAll(".fileListItem").data(t);o.text(function(e){return e.name}).attr("title",function(e){return e.url}),o.enter().append("div").classed("fileListItemWrapper",!0).append("div").classed("fileListItem",!0).text(function(e){return e.name}).attr("title",function(e){return e.url}).on("click",function(t){return window.ApplicationInterface&&window.ApplicationInterface.chooseFile(window.timelineDocumentId,e.navMode,t.url),!1}),o.exit().remove()},ATWelcomeScreen.prototype.updateDisplay=function(){this.updateCollectionDisplay(this.standardCollectionDiv,this.standardTemplates,!1),this.updateCollectionDisplay(this.customCollectionDiv,this.customTemplates,!0),this.updateNavDisplay(),d3.select("#customCollection").style("display",this.customTemplates.length?null:"none")},ATWelcomeScreen.prototype.updateCollectionDisplay=function(e,t,o){var n=this,i=e.selectAll(".templateItem").data(t,function(e){return e.name});i.select(".templateItemIcon").select("span").attr("class",function(e){return"fa "+e.icon}),i.select(".templateItemLabel").text(function(e){return e.name}),i.classed("clicked",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode}),i.select(".templateItemIcon").transition().delay(250).duration(500).style("height",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"40px":"128px"}).style("line-height",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"40px":"128px"}).style("font-size",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"32px":"64px"}),i.select(".templateItemLabel").transition().delay(250).duration(500).style("height",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"46px":"75px"}).style("font-size",function(e,t){return t==n.clickedIndex&&(e.navMode,n.clickedNavMode),"16px"});var c=i.enter().append("div").attr("class","templateItem").classed("clicked",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode}).on("dblclick",function(e,t){n.itemDblClicked(e,t)}).on("click",function(e,t){n.itemClicked(e,t)});c.append("div").attr("class","templateItemIcon").style("height",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"40px":"128px"}).style("line-height",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"40px":"128px"}).style("font-size",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"32px":"64px"}).append("span").attr("class",function(e){return"fa "+e.icon}),c.append("div").attr("class","templateItemLabel").text(function(e){return e.name}).style("height",function(e,t){return t==n.clickedIndex&&e.navMode==n.clickedNavMode?"46px":"75px"}).style("font-size",function(e,t){return t==n.clickedIndex&&(e.navMode,n.clickedNavMode),"16px"}),c.append("div").attr("class","templateItemAction choose").text("Choose").on("click",function(e,t){n.itemChooseClicked(e,t)}),c.append("div").attr("class","templateItemAction customize").text("Customise").on("click",function(e,t){n.itemCustomizeClicked(e,t)}),c.append("div").attr("class","templateItemAction cancel").text("Cancel").on("click",function(e,t){n.itemCancelClicked(e,t)}),o?c.append("div").attr("class","templateItemDelete").on("click",function(e,t){n.itemDeleteClicked(e.name)}).append("i").attr("class","fa fa-times-circle").on("click",function(e,t){n.itemDeleteClicked(e.name)}):c.append("div").attr("class","templateItemInfo").append("i").attr("class","fa fa-info-circle").each(function(e){new Opentip($(this),e.description,{style:"welcomeTooltipStyle",showOn:"mouseover",group:"templateInfo"})}),i.exit().remove()},ATWelcomeScreen.prototype.createToolbar=function(){if(!window.appToolbar){$("#toolbarDiv");window.appToolbar=new ATToolbar({el:"#toolbarDiv"}),window.appToolbar.setToolbarCommands(window.toolbarCommands),window.appToolbar.setMenuCommands(window.menuCommands)}d3.select("#bounds").classed("underToolbar",!0),window.appToolbar.setDisabled(_.map(window.toolbarCommands,"identifier"),!0),window.appToolbar.setDisabled(_.map(window.menuCommands[0].options,"identifier"),!0),window.appToolbar.setDisabled(["newDoc","openDoc","openRecent","checkUpdates","preferences","exit"],!1),window.appToolbar.setDisabled(_.map(window.menuCommands[1].options,"identifier"),!0),window.appToolbar.setDisabled(_.map(window.menuCommands[2].options,"identifier"),!0),window.appToolbar.setDisabled(_.map(window.menuCommands[3].options,"identifier"),!0),window.appToolbar.setDisabled(_.map(window.menuCommands[4].options,"identifier"),!0),window.appToolbar.setDisabled(_.map(window.menuCommands[5].options,"identifier"),!1)},module.exports=ATWelcomeScreen;

},{"../lib/opentip":11,"../timeline/view/desktop/ATToolbar":101,"./templates/welcomeWindow.html":217,"backbone":220,"d3":320,"jquery":331,"lodash":333,"utf8":362}],217:[function(require,module,exports){
module.exports='<div id="welcomeNav">\n\t<div id="appIconWrapper"><img id="appIcon" src="images/aeonIcon.png" /></div>\n\t<div id="navItemWrapper">\n\t\t<div id="navItemRecent" class="navItem selected"><i class="fa fa-clock-o"></i>Recent</div><div id="navItemExamples" class="navItem"><i class="fa fa-file-o"></i>Examples</div>\n\t</div>\n\t<div id="fileListRecent">\n\t</div>\n\t\n\t<div id="openButtonDiv">\n\t\t<button id="openFileButton" class="btn btn-sm btn-default">Open Existing File...</button>\n\t</div>\n</div>\n\n<div id="right">\n\t<div id="createNewHeading">Create New Timeline</div>\n\t<div id="standardCollection">\n\t\t<div class="collectionHeading">Standard Templates</div>\n\t\t<div class="collection"></div>\n\t</div>\n\t<div id="customCollection">\n\t\t<div class="collectionHeading">Custom Templates</div>\n\t\t<div id="customCollection" class="collection"></div>\n\t</div>\n</div>\n';

},{}],218:[function(require,module,exports){
module.exports=[{identifier:"file",text:"File",options:[{identifier:"newDoc",text:"New",shortcut:"Ctrl+Shift+N",global:!0},{identifier:"openDoc",text:"Open...",shortcut:"Ctrl+O",global:!0},{identifier:"openRecent",text:"Open Recent",options:[]},{identifier:"-"},{identifier:"closeDoc",text:"Close",shortcut:"Ctrl+F4",global:!0},{identifier:"saveDoc",text:"Save",shortcut:"Ctrl+S",global:!0},{identifier:"saveAsDoc",text:"Save As...",shortcut:"Ctrl+Shift+S",global:!0},{identifier:"-"},{identifier:"preferences",text:"Options..."},{identifier:"-"},{identifier:"attachments",text:"Attachments",options:[{identifier:"attachLocalImages",text:"Convert Local Image Links to Inline Images"},{identifier:"attachLocalLinks",text:"Convert Local Links to Attachments"},{identifier:"attachRemoteImages",text:"Download and Attach Remote Image Links"}]},{identifier:"-"},{identifier:"import",text:"Import",options:[{identifier:"importCsv",text:"CSV/Text...",shortcut:"Ctrl+Shift+I",global:!0}]},{identifier:"export",text:"Export",options:[{identifier:"exportImage",text:"Image/PDF"},{identifier:"exportWeb",text:"Web"},{identifier:"exportCsv",text:"CSV/Text"}]},{identifier:"-"},{identifier:"print",text:"Print...",shortcut:"Ctrl+P"},{identifier:"-"},{identifier:"exit",text:"Exit",shortcut:"Alt+F4",global:!0}]},{identifier:"edit",text:"Edit",options:[{identifier:"undo",text:"Undo",shortcut:"Ctrl+Z"},{identifier:"redo",text:"Redo",shortcut:"Ctrl+Y"},{identifier:"-"},{identifier:"cut",text:"Cut",shortcut:"Ctrl+X"},{identifier:"copy",text:"Copy",shortcut:"Ctrl+C"},{identifier:"paste",text:"Paste",shortcut:"Ctrl+V"},{identifier:"delete",text:"Delete",shortcut:["Del","Ctrl-Backspace"],minSelectionCount:1},{identifier:"-"},{identifier:"selectAll",text:"Select All",shortcut:"Ctrl+A"},{identifier:"selectPreviousEvent",text:"Select Previous Event",shortcut:"Ctrl+[",global:!0,minSelectionCount:1},{identifier:"selectNextEvent",text:"Select Next Event",shortcut:"Ctrl+]",global:!0,minSelectionCount:1},{identifier:"selectAllBefore",text:"Select All Before Current Selection",shortcut:"Shift+Ctrl+[",global:!0,minSelectionCount:1},{identifier:"selectAllAfter",text:"Select All After Current Selection",shortcut:"Shift+Ctrl+]",global:!0,minSelectionCount:1},{identifier:"-"},{identifier:"findParent",text:"Find",options:[{identifier:"find",text:"Find...",shortcut:"Ctrl+F",global:!0},{identifier:"findNext",text:"Find Next",shortcut:"F3",global:!0},{identifier:"findPrevious",text:"Find Previous",shortcut:"Shift+F3",global:!0},{identifier:"-"},{identifier:"findReplace",text:"Find and Replace...",shortcut:"Ctrl+H",global:!0}]}]},{identifier:"view",text:"View",options:[{identifier:"displaySettings",text:"Display Settings"},{identifier:"-"},{identifier:"timelineView",text:"Timeline View",shortcut:"Ctrl+Shift+1",global:!0},{identifier:"relationshipView",text:"Relationship View",shortcut:"Ctrl+Shift+2",global:!0},{identifier:"-"},{identifier:"expandAllLanes",text:"Expand All Groups",shortcut:"Ctrl+Shift+Down",global:!0},{identifier:"collapseAllLanes",text:"Collapse All Groups",shortcut:"Ctrl+Shift+Up",global:!0},{identifier:"-"},{identifier:"showDetails",text:"Show Event Details",shortcut:"Ctrl+Right",global:!0,minSelectionCount:1},{identifier:"hideDetails",text:"Hide Event Details",shortcut:"Ctrl+Left",global:!0,minSelectionCount:1},{identifier:"hideAllDetails",text:"Hide All Event Details",shortcut:"Shift+Ctrl+Left",global:!0},{identifier:"-"},{identifier:"expandParents",text:"Expand Parent Events",shortcut:"Ctrl+Down",global:!0,minSelectionCount:1},{identifier:"collapseParents",text:"Collapse Parent Events",shortcut:"Ctrl+Up",global:!0,minSelectionCount:1},{identifier:"-"},{identifier:"revealInTimeline",text:"Scroll to Selected Event",minSelectionCount:1},{identifier:"-"},{identifier:"toggleInspector",text:"Toggle Inspector",shortcut:"Ctrl+I",global:!0},{identifier:"toggleFilter",text:"Toggle Filter",shortcut:"Ctrl+R",global:!0},{identifier:"-"},{identifier:"zoom",text:"Zoom",options:[{identifier:"zoomIn",text:"Zoom In",shortcut:"Ctrl+=",global:!0},{identifier:"zoomOut",text:"Zoom Out",shortcut:"Ctrl+-",global:!0},{identifier:"zoomToFit",text:"Zoom To Fit",shortcut:"Alt+Ctrl+=",global:!0}]}]},{identifier:"timeline",text:"Timeline",options:[{identifier:"addEvent",text:"Add Event",shortcut:"Ctrl+N",global:!0},{identifier:"addEntityMenu",text:"Add Entity",options:[]},{identifier:"-"},{identifier:"makeConsecutive",text:"Make Events Consecutive",shortcut:"Ctrl+\\",global:!0,minSelectionCount:2},{identifier:"makeDependent",text:"Make Events Dependent",shortcut:"Shift+Ctrl+D",global:!0,minSelectionCount:2},{identifier:"removeAllDependencies",text:"Remove Event Dependencies",shortcut:"Alt+Shift+Ctrl+D",global:!0,minSelectionCount:1},{identifier:"moveEventsByDuration",text:"Shift Events By...",shortcut:"Ctrl+>",global:!0,minSelectionCount:1},{identifier:"embedInNewParent",text:"Embed in New Parent Event...",minSelectionCount:1},{identifier:"-"},{identifier:"bookmarks",text:"Bookmarks",shortcut:"Shift+Ctrl+B",global:!0,options:[{identifier:"addBookmark",text:"Add Bookmark"},{identifier:"sortBookmarksByName",text:"Sort by Name"},{identifier:"sortBookmarksByDate",text:"Sort by Date"}]},{identifier:"-"},{identifier:"manageEntities",text:"Manage Entities...",shortcut:"Ctrl+E",global:!0},{identifier:"entities",text:"Sort Entities",global:!0,options:[{identifier:"sortEntitiesByName",text:"By Name"},{identifier:"sortEntitiesByAge",text:"By Age"},{identifier:"sortEntitiesByFirstAppearance",text:"By First Appearance"},{identifier:"sortEntitiesByFrequency",text:"By Frequency"}]},{identifier:"-"},{identifier:"tagManager",text:"Tag Manager...",shortcut:"Shift+Ctrl+T",global:!0},{identifier:"editTemplate",text:"Timeline Settings...",shortcut:"Ctrl+T",global:!0},{identifier:"notifications",text:"Notifications...",shortcut:"Alt+Ctrl+T",global:!0}]},{identifier:"sync",text:"Sync",options:[{identifier:"syncLatest",text:"Last Selected Project",shortcut:"Ctrl+Shift+Y",global:!0},{identifier:"syncChooseProject",text:"Choose Project",global:!0,options:[{identifier:"syncChoose",text:"Scrivener...",shortcut:"Ctrl+Alt+Shift+Y",global:!0}]},{identifier:"-"},{identifier:"syncAll",text:"Sync Entire Project"},{identifier:"syncBinderSelection",text:"Binder Selection",global:!0,options:[{identifier:"syncShowStatus",text:"Show Sync Status...",global:!0},{identifier:"syncSelection",text:"Sync Selection",global:!0},{identifier:"-"},{identifier:"syncLinkEvent",text:"Link to Event...",global:!0},{identifier:"syncCreateEvent",text:"Create Events from Selection",global:!0},{identifier:"syncCreateItemInInbox",text:"Create Documents in Inbox from Selection",global:!0},{identifier:"syncRemoveLink",text:"Remove Links",global:!0},{identifier:"-"},{identifier:"syncIgnoreItem",text:"Ignore Item",global:!0},{identifier:"syncIgnoreSubtree",text:"Ignore Entire Subtree",global:!0},{identifier:"syncUnignoreSubtree",text:"Unignore Subtree",global:!0},{identifier:"-"},{identifier:"syncMoveToTrash",text:"Move to Trash",global:!0},{identifier:"-"},{identifier:"syncRevealEvents",text:"Reveal Event(s) in Timeline",global:!0}]},{identifier:"-"},{identifier:"syncSettings",text:"Settings..."},{identifier:"syncClose",text:"Close Project"},{identifier:"-"},{identifier:"syncManager",text:"Manage Projects..."}]},{identifier:"help",text:"Help",options:[{identifier:"userManual",text:"User Manual"},{identifier:"support",text:"Online Support"},{identifier:"-"},{identifier:"showGettingStartedTips",text:"Getting Started Tutorial"},{identifier:"showRelationshipViewTips",text:"Relationship View Tutorial"},{identifier:"showNavigatingTips",text:"Navigating Tips"},{identifier:"showTimelineSettingsTips",text:"Timeline Settings Tutorial"},{identifier:"showSyncingTips",text:"Scrivener Syncing Tips"},{identifier:"-"},{identifier:"checkUpdates",text:"Check for updates..."},{identifier:"-"},{identifier:"registration",text:"Registration..."},{identifier:"deactivate",text:"Deactivate License..."},{identifier:"about",text:"About Aeon Timeline"}]}];

},{}],219:[function(require,module,exports){
module.exports=[{identifier:"addEvent",type:"button",text:"Add Event",image:"AddEvent.png",disabledImage:"AddEvent_disabled.png",shortcut:"Ctrl+N"},{identifier:"addEntity",type:"buttonSelect",text:"Add Entity",image:"AddEntity.png",disabledImage:"AddEntity_disabled.png",selectable:!1,options:[]},{identifier:"delete",type:"button",text:"Delete",image:"Delete.png",disabledImage:"Delete_disabled.png",minSelectionCount:1},{identifier:"-"},{identifier:"editTemplate",type:"button",text:"Timeline Settings",image:"Cog.png",disabledImage:"Cog_disabled.png"},{identifier:"manageEntities",type:"button",text:"Manage Entities",image:"Entities.png",disabledImage:"Entities_disabled.png"},{identifier:"displaySettings",type:"button",text:"Display Settings",image:"Paintbrush.png",disabledImage:"Paintbrush_disabled.png"},{identifier:"-"},{identifier:"search",type:"input",text:"Search",minWidth:150,maxWidth:300,placeholder:"Enter date or search term..."},{identifier:"findPrevious",type:"button",text:"Find Previous",image:"FindPrevious.png",disabledImage:"FindPrevious_disabled.png",noSep:!0},{identifier:"findNext",type:"button",text:"Find Next",image:"FindNext.png",disabledImage:"FindNext_disabled.png",center:!0,noSep:!0},{identifier:"zoomOut",type:"button",text:"Zoom Out",image:"ZoomOut.png",disabledImage:"ZoomOut_disabled.png",noSep:!0},{identifier:"zoom",type:"slider",text:"Zoom",minWidth:50,maxWidth:150,minValue:1,maxValue:100,noSep:!0},{identifier:"zoomIn",type:"button",text:"Zoom In",image:"ZoomIn.png",disabledImage:"ZoomIn_disabled.png",noSep:!0},{identifier:"-"},{identifier:"timelineView",type:"buttonTwoState",text:"Timeline View",image:"TimelineView.png",disabledImage:"TimelineView_disabled.png",noSep:!0},{identifier:"relationshipView",type:"buttonTwoState",text:"Relationship View",image:"RelationshipView.png",disabledImage:"RelationshipView_disabled.png"},{identifier:"lane",type:"buttonSelect",text:"Group by",image:"Lane.png",disabledImage:"Lane_disabled.png",selectable:!0,options:[{identifier:"laneNone",text:"None",shortcut:"Ctrl+0"},{identifier:"-"}]},{identifier:"filter",type:"buttonTwoState",text:"Filter",image:"Filter.png",disabledImage:"Filter_disabled.png",shortcut:"Ctrl+Shift+F"},{identifier:"notifications",type:"button",text:"Notifications",image:"Bell.png",disabledImage:"Bell_disabled.png"},{identifier:"inspector",type:"buttonTwoState",text:"Inspector",image:"Inspector.png",disabledImage:"Inspector_disabled.png",shortcut:"Ctrl+Shift+I"}];

},{}],220:[function(require,module,exports){
(function (global){
!function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(i,n,s){e.Backbone=t(e,s,i,n)});else if("undefined"!=typeof exports){var i,n=require("underscore");try{i=require("jquery")}catch(t){}t(e,exports,n,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(function(t,e,i,n){var s=t.Backbone,r=Array.prototype.slice;e.VERSION="1.3.3",e.$=n,e.noConflict=function(){return t.Backbone=s,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=function(t,e,n){i.each(e,function(e,s){i[s]&&(t.prototype[s]=function(t,e,n){switch(t){case 1:return function(){return i[e](this[n])};case 2:return function(t){return i[e](this[n],t)};case 3:return function(t,s){return i[e](this[n],o(t,this),s)};case 4:return function(t,s,r){return i[e](this[n],o(t,this),s,r)};default:return function(){var t=r.call(arguments);return t.unshift(this[n]),i[e].apply(i,t)}}}(e,s,n))})},o=function(t,e){return i.isFunction(t)?t:i.isObject(t)&&!e._isModel(t)?h(t):i.isString(t)?function(e){return e.get(t)}:t},h=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}},u=e.Events={},c=/\s+/,l=function(t,e,n,s,r){var a,o=0;if(n&&"object"==typeof n){void 0!==s&&"context"in r&&void 0===r.context&&(r.context=s);for(a=i.keys(n);o<a.length;o++)e=l(t,e,a[o],n[a[o]],r)}else if(n&&c.test(n))for(a=n.split(c);o<a.length;o++)e=t(e,a[o],s,r);else e=t(e,n,s,r);return e};u.on=function(t,e,i){return d(this,t,e,i)};var d=function(t,e,i,n,s){if(t._events=l(f,t._events||{},e,i,{context:n,ctx:t,listening:s}),s){(t._listeners||(t._listeners={}))[s.id]=s}return t};u.listenTo=function(t,e,n){if(!t)return this;var s=t._listenId||(t._listenId=i.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),a=r[s];if(!a){var o=this._listenId||(this._listenId=i.uniqueId("l"));a=r[s]={obj:t,objId:s,id:o,listeningTo:r,count:0}}return d(t,e,n,this,a),this};var f=function(t,e,i,n){if(i){var s=t[e]||(t[e]=[]),r=n.context,a=n.ctx,o=n.listening;o&&o.count++,s.push({callback:i,context:r,ctx:r||a,listening:o})}return t};u.off=function(t,e,i){return this._events?(this._events=l(g,this._events,t,e,{context:i,listeners:this._listeners}),this):this},u.stopListening=function(t,e,n){var s=this._listeningTo;if(!s)return this;for(var r=t?[t._listenId]:i.keys(s),a=0;a<r.length;a++){var o=s[r[a]];if(!o)break;o.obj.off(e,n,this)}return this};var g=function(t,e,n,s){if(t){var r,a=0,o=s.context,h=s.listeners;if(e||n||o){for(var u=e?[e]:i.keys(t);a<u.length;a++){var c=t[e=u[a]];if(!c)break;for(var l=[],d=0;d<c.length;d++){var f=c[d];n&&n!==f.callback&&n!==f.callback._callback||o&&o!==f.context?l.push(f):(r=f.listening)&&0==--r.count&&(delete h[r.id],delete r.listeningTo[r.objId])}l.length?t[e]=l:delete t[e]}return t}for(var g=i.keys(h);a<g.length;a++)delete h[(r=h[g[a]]).id],delete r.listeningTo[r.objId]}};u.once=function(t,e,n){var s=l(p,{},t,e,i.bind(this.off,this));return"string"==typeof t&&null==n&&(e=void 0),this.on(s,e,n)},u.listenToOnce=function(t,e,n){var s=l(p,{},e,n,i.bind(this.stopListening,this,t));return this.listenTo(t,s)};var p=function(t,e,n,s){if(n){var r=t[e]=i.once(function(){s(e,r),n.apply(this,arguments)});r._callback=n}return t};u.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return l(v,this._events,t,void 0,i),this};var v=function(t,e,i,n){if(t){var s=t[e],r=t.all;s&&r&&(r=r.slice()),s&&m(s,n),r&&m(r,[e].concat(n))}return t},m=function(t,e){var i,n=-1,s=t.length,r=e[0],a=e[1],o=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,a);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,a,o);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e);return}};u.bind=u.on,u.unbind=u.off,i.extend(e,u);var _=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var s=i.result(this,"defaults");n=i.defaults(i.extend({},s,n),s),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(_.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var s;if("object"==typeof t?(s=t,n=e):(s={})[t]=e,n||(n={}),!this._validate(s,n))return!1;var r=n.unset,a=n.silent,o=[],h=this._changing;this._changing=!0,h||(this._previousAttributes=i.clone(this.attributes),this.changed={});var u=this.attributes,c=this.changed,l=this._previousAttributes;for(var d in s)e=s[d],i.isEqual(u[d],e)||o.push(d),i.isEqual(l[d],e)?delete c[d]:c[d]=e,r?delete u[d]:u[d]=e;if(this.idAttribute in s&&(this.id=this.get(this.idAttribute)),!a){o.length&&(this._pending=n);for(var f=0;f<o.length;f++)this.trigger("change:"+o[f],this,u[o[f]],n)}if(h)return this;if(!a)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var s in t){var r=t[s];i.isEqual(e[s],r)||(n[s]=r)}return!!i.size(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){var e=this,n=(t=i.extend({parse:!0},t)).success;return t.success=function(i){var s=t.parse?e.parse(i,t):i;if(!e.set(s,t))return!1;n&&n.call(t.context,e,i,t),e.trigger("sync",e,i,t)},O(this,t),this.sync("read",this,t)},save:function(t,e,n){var s;null==t||"object"==typeof t?(s=t,n=e):(s={})[t]=e;var r=(n=i.extend({validate:!0,parse:!0},n)).wait;if(s&&!r){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;var a=this,o=n.success,h=this.attributes;n.success=function(t){a.attributes=h;var e=n.parse?a.parse(t,n):t;if(r&&(e=i.extend({},s,e)),e&&!a.set(e,n))return!1;o&&o.call(n.context,a,t,n),a.trigger("sync",a,t,n)},O(this,n),s&&r&&(this.attributes=i.extend({},h,s));var u=this.isNew()?"create":n.patch?"patch":"update";"patch"!==u||n.attrs||(n.attrs=s);var c=this.sync(u,this,n);return this.attributes=h,c},destroy:function(t){var e=this,n=(t=t?i.clone(t):{}).success,s=t.wait,r=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(i){s&&r(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var a=!1;return this.isNew()?i.defer(t.success):(O(this,t),a=this.sync("delete",this,t)),s||r(),a},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||M();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}});a(_,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var y=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},x={add:!0,remove:!1},w=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,s=Array(t.length-i),r=e.length;for(n=0;n<s.length;n++)s[n]=t[n+i];for(n=0;n<r;n++)t[n+i]=e[n];for(n=0;n<s.length;n++)t[n+r+i]=s[n]};i.extend(y.prototype,u,{model:_,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,x))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:t.slice();var s=this._removeModels(t,e);return!e.silent&&s.length&&(e.changes={added:[],merged:[],removed:s},this.trigger("update",this,e)),n?s[0]:s},set:function(t,e){if(null!=t){(e=i.extend({},b,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var n=!i.isArray(t);t=n?[t]:t.slice();var s=e.at;null!=s&&(s=+s),s>this.length&&(s=this.length),s<0&&(s+=this.length+1);var r,a,o=[],h=[],u=[],c=[],l={},d=e.add,f=e.merge,g=e.remove,p=!1,v=this.comparator&&null==s&&!1!==e.sort,m=i.isString(this.comparator)?this.comparator:null;for(a=0;a<t.length;a++){r=t[a];var _=this.get(r);if(_){if(f&&r!==_){var y=this._isModel(r)?r.attributes:r;e.parse&&(y=_.parse(y,e)),_.set(y,e),u.push(_),v&&!p&&(p=_.hasChanged(m))}l[_.cid]||(l[_.cid]=!0,o.push(_)),t[a]=_}else d&&(r=t[a]=this._prepareModel(r,e))&&(h.push(r),this._addReference(r,e),l[r.cid]=!0,o.push(r))}if(g){for(a=0;a<this.length;a++)l[(r=this.models[a]).cid]||c.push(r);c.length&&this._removeModels(c,e)}var x=!1,E=!v&&d&&g;if(o.length&&E?(x=this.length!==o.length||i.some(this.models,function(t,e){return t!==o[e]}),this.models.length=0,w(this.models,o,0),this.length=this.models.length):h.length&&(v&&(p=!0),w(this.models,h,null==s?this.length:s),this.length=this.models.length),p&&this.sort({silent:!0}),!e.silent){for(a=0;a<h.length;a++)null!=s&&(e.index=s+a),(r=h[a]).trigger("add",r,this,e);(p||x)&&this.trigger("sort",this,e),(h.length||c.length||u.length)&&(e.changes={added:h,removed:c,merged:u},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(t.attributes||t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return i.isFunction(e)&&(e=i.bind(e,this)),1===n||i.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){var e=(t=i.extend({parse:!0},t)).success,n=this;return t.success=function(i){var s=t.reset?"reset":"set";n[s](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},O(this,t),this.sync("read",this,t)},create:function(t,e){var n=(e=e?i.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;n||this.add(t,e);var s=this,r=e.success;return e.success=function(t,e,i){n&&s.add(t,i),r&&r.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;(e=e?i.clone(e):{}).collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var s=this.get(t[n]);if(s){var r=this.indexOf(s);this.models.splice(r,1),this.length--,delete this._byId[s.cid];var a=this.modelId(s.attributes);null!=a&&delete this._byId[a],e.silent||(e.index=r,s.trigger("remove",s,this,e)),i.push(s),this._removeReference(s,e)}}return i},_isModel:function(t){return t instanceof _},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"change"===t){var s=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);s!==r&&(null!=s&&delete this._byId[s],null!=r&&(this._byId[r]=e))}}this.trigger.apply(this,arguments)}});a(y,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models");var E=e.View=function(t){this.cid=i.uniqueId("view"),i.extend(this,i.pick(t,S)),this._ensureElement(),this.initialize.apply(this,arguments)},I=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName","events"];i.extend(E.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var s=e.match(I);this.delegate(s[1],s[2],i.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,n,s){var r=k[t];i.defaults(s||(s={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:r,dataType:"json"};if(s.url||(a.url=i.result(n,"url")||M()),null!=s.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",s.emulateJSON&&(a.data._method=r);var o=s.beforeSend;s.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",r),o)return o.apply(this,arguments)}}"GET"===a.type||s.emulateJSON||(a.processData=!1);var h=s.error;s.error=function(t,e,i){s.textStatus=e,s.errorThrown=i,h&&h.call(s.context,t,e,i)};var u=s.xhr=e.ajax(i.extend(a,s));return n.trigger("request",n,u,s),u};var k={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var T=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},P=/\((.*?)\)/g,H=/(\(\?)?:\w+/g,$=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(T.prototype,u,{initialize:function(){},route:function(t,n,s){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(s=n,n=""),s||(s=this[n]);var r=this;return e.history.route(t,function(i){var a=r._extractParameters(t,i);!1!==r.execute(s,a,n)&&(r.trigger.apply(r,["route:"+n].concat(a)),r.trigger("route",n,a),e.history.trigger("route",r,n,a))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(A,"\\$&").replace(P,"(?:$1)?").replace(H,function(t,e){return e?t:"([^/?]+)"}).replace($,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var C=e.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},R=/^[#\/]|\s+$/g,j=/^\/+|\/+$/g,N=/#.*$/;C.started=!1,i.extend(C.prototype,u,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(R,"")},start:function(t){if(C.started)throw new Error("Backbone.history has already been started");if(C.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(j,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,s=n.insertBefore(this.iframe,n.firstChild).contentWindow;s.document.open(),s.document.close(),s.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),C.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),i.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!C.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;if(t=this.decodeFragment(t.replace(N,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;e.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new C;_.extend=y.extend=T.extend=E.extend=C.extend=function(t,e){var n,s=this;return n=t&&i.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,e),n.prototype=i.create(s.prototype,t),n.prototype.constructor=n,n.__super__=s.prototype,n};var M=function(){throw new Error('A "url" property or function must be specified')},O=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"jquery":331,"underscore":361}],221:[function(require,module,exports){
"use strict";function getLens(o){var r=o.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=o.indexOf("=");-1===e&&(e=r);return[e,e===r?0:4-e%4]}function byteLength(o){var r=getLens(o),e=r[0],t=r[1];return 3*(e+t)/4-t}function _byteLength(o,r,e){return 3*(r+e)/4-e}function toByteArray(o){for(var r,e=getLens(o),t=e[0],n=e[1],u=new Arr(_byteLength(o,t,n)),p=0,a=n>0?t-4:t,h=0;h<a;h+=4)r=revLookup[o.charCodeAt(h)]<<18|revLookup[o.charCodeAt(h+1)]<<12|revLookup[o.charCodeAt(h+2)]<<6|revLookup[o.charCodeAt(h+3)],u[p++]=r>>16&255,u[p++]=r>>8&255,u[p++]=255&r;return 2===n&&(r=revLookup[o.charCodeAt(h)]<<2|revLookup[o.charCodeAt(h+1)]>>4,u[p++]=255&r),1===n&&(r=revLookup[o.charCodeAt(h)]<<10|revLookup[o.charCodeAt(h+1)]<<4|revLookup[o.charCodeAt(h+2)]>>2,u[p++]=r>>8&255,u[p++]=255&r),u}function tripletToBase64(o){return lookup[o>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]}function encodeChunk(o,r,e){for(var t,n=[],u=r;u<e;u+=3)t=(o[u]<<16&16711680)+(o[u+1]<<8&65280)+(255&o[u+2]),n.push(tripletToBase64(t));return n.join("")}function fromByteArray(o){for(var r,e=o.length,t=e%3,n=[],u=0,p=e-t;u<p;u+=16383)n.push(encodeChunk(o,u,u+16383>p?p:u+16383));return 1===t?(r=o[e-1],n.push(lookup[r>>2]+lookup[r<<4&63]+"==")):2===t&&(r=(o[e-2]<<8)+o[e-1],n.push(lookup[r>>10]+lookup[r>>4&63]+lookup[r<<2&63]+"=")),n.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;

},{}],222:[function(require,module,exports){
require("../../js/transition.js"),require("../../js/alert.js"),require("../../js/button.js"),require("../../js/carousel.js"),require("../../js/collapse.js"),require("../../js/dropdown.js"),require("../../js/modal.js"),require("../../js/tooltip.js"),require("../../js/popover.js"),require("../../js/scrollspy.js"),require("../../js/tab.js"),require("../../js/affix.js");

},{"../../js/affix.js":223,"../../js/alert.js":224,"../../js/button.js":225,"../../js/carousel.js":226,"../../js/collapse.js":227,"../../js/dropdown.js":228,"../../js/modal.js":229,"../../js/popover.js":230,"../../js/scrollspy.js":231,"../../js/tab.js":232,"../../js/tooltip.js":233,"../../js/transition.js":234}],223:[function(require,module,exports){
+function(t){"use strict";function i(i){return this.each(function(){var o=t(this),f=o.data("bs.affix"),n="object"==typeof i&&i;f||o.data("bs.affix",f=new e(this,n)),"string"==typeof i&&f[i]()})}var e=function(i,o){this.options=t.extend({},e.DEFAULTS,o),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(i),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};e.VERSION="3.3.6",e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0,target:window},e.prototype.getState=function(t,i,e,o){var f=this.$target.scrollTop(),n=this.$element.offset(),s=this.$target.height();if(null!=e&&"top"==this.affixed)return f<e&&"top";if("bottom"==this.affixed)return null!=e?!(f+this.unpin<=n.top)&&"bottom":!(f+s<=t-o)&&"bottom";var a=null==this.affixed,h=a?f:n.top;return null!=e&&f<=e?"top":null!=o&&h+(a?s:i)>=t-o&&"bottom"},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=this.$element.height(),o=this.options.offset,f=o.top,n=o.bottom,s=Math.max(t(document).height(),t(document.body).height());"object"!=typeof o&&(n=f=o),"function"==typeof f&&(f=o.top(this.$element)),"function"==typeof n&&(n=o.bottom(this.$element));var a=this.getState(s,i,f,n);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var h="affix"+(a?"-"+a:""),r=t.Event(h+".bs.affix");if(this.$element.trigger(r),r.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:s-i-n})}};var o=t.fn.affix;t.fn.affix=i,t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),o=e.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),i.call(e,o)})})}(jQuery);

},{}],224:[function(require,module,exports){
+function(t){"use strict";var e='[data-dismiss="alert"]',a=function(a){t(a).on("click",e,this.close)};a.VERSION="3.3.6",a.TRANSITION_DURATION=150,a.prototype.close=function(e){function r(){o.detach().trigger("closed.bs.alert").remove()}var n=t(this),s=n.attr("data-target");s||(s=(s=n.attr("href"))&&s.replace(/.*(?=#[^\s]*$)/,""));var o=t(s);e&&e.preventDefault(),o.length||(o=n.closest(".alert")),o.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",r).emulateTransitionEnd(a.TRANSITION_DURATION):r())};var r=t.fn.alert;t.fn.alert=function(e){return this.each(function(){var r=t(this),n=r.data("bs.alert");n||r.data("bs.alert",n=new a(this)),"string"==typeof e&&n[e].call(r)})},t.fn.alert.Constructor=a,t.fn.alert.noConflict=function(){return t.fn.alert=r,this},t(document).on("click.bs.alert.data-api",e,a.prototype.close)}(jQuery);

},{}],225:[function(require,module,exports){
+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),a=n.data("bs.button"),o="object"==typeof e&&e;a||n.data("bs.button",a=new s(this,o)),"toggle"==e?a.toggle():e&&a.setState(e)})}var s=function(e,n){this.$element=t(e),this.options=t.extend({},s.DEFAULTS,n),this.isLoading=!1};s.VERSION="3.3.6",s.DEFAULTS={loadingText:"loading..."},s.prototype.setState=function(e){var s="disabled",n=this.$element,a=n.is("input")?"val":"html",o=n.data();e+="Text",null==o.resetText&&n.data("resetText",n[a]()),setTimeout(t.proxy(function(){n[a](null==o[e]?this.options[e]:o[e]),"loadingText"==e?(this.isLoading=!0,n.addClass(s).attr(s,s)):this.isLoading&&(this.isLoading=!1,n.removeClass(s).removeAttr(s))},this),0)},s.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var s=this.$element.find("input");"radio"==s.prop("type")?(s.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==s.prop("type")&&(s.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),s.prop("checked",this.$element.hasClass("active")),t&&s.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=e,t.fn.button.Constructor=s,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(s){var n=t(s.target);n.hasClass("btn")||(n=n.closest(".btn")),e.call(n,"toggle"),t(s.target).is('input[type="radio"]')||t(s.target).is('input[type="checkbox"]')||s.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery);

},{}],226:[function(require,module,exports){
+function(t){"use strict";function e(e){return this.each(function(){var s=t(this),n=s.data("bs.carousel"),a=t.extend({},i.DEFAULTS,s.data(),"object"==typeof e&&e),r="string"==typeof e?e:a.slide;n||s.data("bs.carousel",n=new i(this,a)),"number"==typeof e?n.to(e):r?n[r]():a.interval&&n.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.3.6",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);if(("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap)return e;var s=(i+("prev"==t?-1:1))%this.$items.length;return this.$items.eq(s)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){if(!this.sliding)return this.slide("next")},i.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},i.prototype.slide=function(e,s){var n=this.$element.find(".item.active"),a=s||this.getItemForDirection(e,n),r=this.interval,o="next"==e?"left":"right",l=this;if(a.hasClass("active"))return this.sliding=!1;var h=a[0],c=t.Event("slide.bs.carousel",{relatedTarget:h,direction:o});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,r&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var d=t(this.$indicators.children()[this.getItemIndex(a)]);d&&d.addClass("active")}var u=t.Event("slid.bs.carousel",{relatedTarget:h,direction:o});return t.support.transition&&this.$element.hasClass("slide")?(a.addClass(e),a[0].offsetWidth,n.addClass(o),a.addClass(o),n.one("bsTransitionEnd",function(){a.removeClass([e,o].join(" ")).addClass("active"),n.removeClass(["active",o].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(u)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(n.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(u)),r&&this.cycle(),this}};var s=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=s,this};var n=function(i){var s,n=t(this),a=t(n.attr("data-target")||(s=n.attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,""));if(a.hasClass("carousel")){var r=t.extend({},a.data(),n.data()),o=n.attr("data-slide-to");o&&(r.interval=!1),e.call(a,r),o&&a.data("bs.carousel").to(o),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",n).on("click.bs.carousel.data-api","[data-slide-to]",n),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery);

},{}],227:[function(require,module,exports){
+function(t){"use strict";function e(e){var a,s=e.attr("data-target")||(a=e.attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,"");return t(s)}function a(e){return this.each(function(){var a=t(this),i=a.data("bs.collapse"),n=t.extend({},s.DEFAULTS,a.data(),"object"==typeof e&&e);!i&&n.toggle&&/show|hide/.test(e)&&(n.toggle=!1),i||a.data("bs.collapse",i=new s(this,n)),"string"==typeof e&&i[e]()})}var s=function(e,a){this.$element=t(e),this.options=t.extend({},s.DEFAULTS,a),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};s.VERSION="3.3.6",s.TRANSITION_DURATION=350,s.DEFAULTS={toggle:!0},s.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},s.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,i=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(i&&i.length&&(e=i.data("bs.collapse"))&&e.transitioning)){var n=t.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){i&&i.length&&(a.call(i,"hide"),e||i.data("bs.collapse",null));var l=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[l](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var o=function(){this.$element.removeClass("collapsing").addClass("collapse in")[l](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return o.call(this);var r=t.camelCase(["scroll",l].join("-"));this.$element.one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(s.TRANSITION_DURATION)[l](this.$element[0][r])}}}},s.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var a=this.dimension();this.$element[a](this.$element[a]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!t.support.transition)return i.call(this);this.$element[a](0).one("bsTransitionEnd",t.proxy(i,this)).emulateTransitionEnd(s.TRANSITION_DURATION)}}},s.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},s.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(a,s){var i=t(s);this.addAriaAndCollapsedClass(e(i),i)},this)).end()},s.prototype.addAriaAndCollapsedClass=function(t,e){var a=t.hasClass("in");t.attr("aria-expanded",a),e.toggleClass("collapsed",!a).attr("aria-expanded",a)};var i=t.fn.collapse;t.fn.collapse=a,t.fn.collapse.Constructor=s,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(s){var i=t(this);i.attr("data-target")||s.preventDefault();var n=e(i),l=n.data("bs.collapse")?"toggle":i.data();a.call(n,l)})}(jQuery);

},{}],228:[function(require,module,exports){
+function(t){"use strict";function e(e){var o=e.attr("data-target");o||(o=(o=e.attr("href"))&&/#[A-Za-z]/.test(o)&&o.replace(/.*(?=#[^\s]*$)/,""));var n=o&&t(o);return n&&n.length?n:e.parent()}function o(o){o&&3===o.which||(t(n).remove(),t(r).each(function(){var n=t(this),r=e(n),a={relatedTarget:this};r.hasClass("open")&&(o&&"click"==o.type&&/input|textarea/i.test(o.target.tagName)&&t.contains(r[0],o.target)||(r.trigger(o=t.Event("hide.bs.dropdown",a)),o.isDefaultPrevented()||(n.attr("aria-expanded","false"),r.removeClass("open").trigger(t.Event("hidden.bs.dropdown",a)))))}))}var n=".dropdown-backdrop",r='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.6",a.prototype.toggle=function(n){var r=t(this);if(!r.is(".disabled, :disabled")){var a=e(r),d=a.hasClass("open");if(o(),!d){"ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",o);var i={relatedTarget:this};if(a.trigger(n=t.Event("show.bs.dropdown",i)),n.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),a.toggleClass("open").trigger(t.Event("shown.bs.dropdown",i))}return!1}},a.prototype.keydown=function(o){if(/(38|40|27|32)/.test(o.which)&&!/input|textarea/i.test(o.target.tagName)){var n=t(this);if(o.preventDefault(),o.stopPropagation(),!n.is(".disabled, :disabled")){var a=e(n),d=a.hasClass("open");if(!d&&27!=o.which||d&&27==o.which)return 27==o.which&&a.find(r).trigger("focus"),n.trigger("click");var i=a.find(".dropdown-menu li:not(.disabled):visible a");if(i.length){var s=i.index(o.target);38==o.which&&s>0&&s--,40==o.which&&s<i.length-1&&s++,~s||(s=0),i.eq(s).trigger("focus")}}}};var d=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var o=t(this),n=o.data("bs.dropdown");n||o.data("bs.dropdown",n=new a(this)),"string"==typeof e&&n[e].call(o)})},t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=d,this},t(document).on("click.bs.dropdown.data-api",o).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",r,a.prototype.toggle).on("keydown.bs.dropdown.data-api",r,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery);

},{}],229:[function(require,module,exports){
+function(t){"use strict";function e(e,i){return this.each(function(){var s=t(this),n=s.data("bs.modal"),a=t.extend({},o.DEFAULTS,s.data(),"object"==typeof e&&e);n||s.data("bs.modal",n=new o(this,a)),"string"==typeof e?n[e](i):a.show&&n.show(i)})}var o=function(e,o){this.options=o,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};o.VERSION="3.3.6",o.TRANSITION_DURATION=300,o.BACKDROP_TRANSITION_DURATION=150,o.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},o.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},o.prototype.show=function(e){var i=this,s=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(s),this.isShown||s.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var s=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),s&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var n=t.Event("shown.bs.modal",{relatedTarget:e});s?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(n)}).emulateTransitionEnd(o.TRANSITION_DURATION):i.$element.trigger("focus").trigger(n)}))},o.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(o.TRANSITION_DURATION):this.hideModal())},o.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},o.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},o.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},o.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},o.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},o.prototype.backdrop=function(e){var i=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&s;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+s).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):a()}else e&&e()},o.prototype.handleUpdate=function(){this.adjustDialog()},o.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},o.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},o.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},o.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},o.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},o.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=o,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(o){var i=t(this),s=i.attr("href"),n=t(i.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),a=n.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(s)&&s},n.data(),i.data());i.is("a")&&o.preventDefault(),n.one("show.bs.modal",function(t){t.isDefaultPrevented()||n.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),e.call(n,a,this)})}(jQuery);

},{}],230:[function(require,module,exports){
Number(function(t){"use strict";var o=function(t,o){this.init("popover",t,o)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");o.VERSION="3.3.6",o.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),o.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),o.prototype.constructor=o,o.prototype.getDefaults=function(){return o.DEFAULTS},o.prototype.setContent=function(){var t=this.tip(),o=this.getTitle(),e=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](o),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof e?"html":"append":"text"](e),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},o.prototype.hasContent=function(){return this.getTitle()||this.getContent()},o.prototype.getContent=function(){var t=this.$element,o=this.options;return t.attr("data-content")||("function"==typeof o.content?o.content.call(t[0]):o.content)},o.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var e=t.fn.popover;t.fn.popover=function(e){return this.each(function(){var n=t(this),r=n.data("bs.popover"),i="object"==typeof e&&e;!r&&/destroy|hide/.test(e)||(r||n.data("bs.popover",r=new o(this,i)),"string"==typeof e&&r[e]())})},t.fn.popover.Constructor=o,t.fn.popover.noConflict=function(){return t.fn.popover=e,this}}(jQuery));

},{}],231:[function(require,module,exports){
+function(t){"use strict";function s(e,i){this.$body=t(document.body),this.$scrollElement=t(t(e).is(document.body)?window:e),this.options=t.extend({},s.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function e(e){return this.each(function(){var i=t(this),o=i.data("bs.scrollspy"),r="object"==typeof e&&e;o||i.data("bs.scrollspy",o=new s(this,r)),"string"==typeof e&&o[e]()})}s.VERSION="3.3.6",s.DEFAULTS={offset:10},s.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},s.prototype.refresh=function(){var s=this,e="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(e="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var s=t(this),o=s.data("target")||s.attr("href"),r=/^#./.test(o)&&t(o);return r&&r.length&&r.is(":visible")&&[[r[e]().top+i,o]]||null}).sort(function(t,s){return t[0]-s[0]}).each(function(){s.offsets.push(this[0]),s.targets.push(this[1])})},s.prototype.process=function(){var t,s=this.$scrollElement.scrollTop()+this.options.offset,e=this.getScrollHeight(),i=this.options.offset+e-this.$scrollElement.height(),o=this.offsets,r=this.targets,l=this.activeTarget;if(this.scrollHeight!=e&&this.refresh(),s>=i)return l!=(t=r[r.length-1])&&this.activate(t);if(l&&s<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)l!=r[t]&&s>=o[t]&&(void 0===o[t+1]||s<o[t+1])&&this.activate(r[t])},s.prototype.activate=function(s){this.activeTarget=s,this.clear();var e=this.selector+'[data-target="'+s+'"],'+this.selector+'[href="'+s+'"]',i=t(e).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},s.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=e,t.fn.scrollspy.Constructor=s,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var s=t(this);e.call(s,s.data())})})}(jQuery);

},{}],232:[function(require,module,exports){
+function(t){"use strict";function a(a){return this.each(function(){var n=t(this),i=n.data("bs.tab");i||n.data("bs.tab",i=new e(this)),"string"==typeof a&&i[a]()})}var e=function(a){this.element=t(a)};e.VERSION="3.3.6",e.TRANSITION_DURATION=150,e.prototype.show=function(){var a=this.element,e=a.closest("ul:not(.dropdown-menu)"),n=a.data("target");if(n||(n=(n=a.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!a.parent("li").hasClass("active")){var i=e.find(".active:last a"),r=t.Event("hide.bs.tab",{relatedTarget:a[0]}),s=t.Event("show.bs.tab",{relatedTarget:i[0]});if(i.trigger(r),a.trigger(s),!s.isDefaultPrevented()&&!r.isDefaultPrevented()){var d=t(n);this.activate(a.closest("li"),e),this.activate(d,d.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:a[0]}),a.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})}}},e.prototype.activate=function(a,n,i){function r(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),a.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),d?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade"),a.parent(".dropdown-menu").length&&a.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=n.find("> .active"),d=i&&t.support.transition&&(s.length&&s.hasClass("fade")||!!n.find("> .fade").length);s.length&&d?s.one("bsTransitionEnd",r).emulateTransitionEnd(e.TRANSITION_DURATION):r(),s.removeClass("in")};var n=t.fn.tab;t.fn.tab=a,t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=n,this};var i=function(e){e.preventDefault(),a.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery);

},{}],233:[function(require,module,exports){
+function(t){"use strict";var e=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};e.VERSION="3.3.6",e.TRANSITION_DURATION=150,e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},e.prototype.init=function(e,i,o){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),s=n.length;s--;){var r=n[s];if("click"==r)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=r){var l="hover"==r?"mouseenter":"focusin",a="hover"==r?"mouseleave":"focusout";this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(e){return(e=t.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},e.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,o){i[t]!=o&&(e[t]=o)}),e},e.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState)i.hoverState="in";else{if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)}},e.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},e.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)}},e.prototype.show=function(){var i=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(i);var o=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(i.isDefaultPrevented()||!o)return;var n=this,s=this.tip(),r=this.getUID(this.type);this.setContent(),s.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&s.addClass("fade");var l="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,p=a.test(l);p&&(l=l.replace(a,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(l).data("bs."+this.type,this),console.log("************************ Tooltip.show() ************************"),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var h=this.getPosition(),f=s[0].offsetWidth,c=s[0].offsetHeight;if(p){var u=l,d=this.getPosition(this.$viewport);l="bottom"==l&&h.bottom+c>d.bottom?"top":"top"==l&&h.top-c<d.top?"bottom":"right"==l&&h.right+f>d.width?"left":"left"==l&&h.left-f<d.left?"right":l,s.removeClass(u).addClass(l)}var g=this.getCalculatedOffset(l,h,f,c);this.applyPlacement(g,l);var v=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",v).emulateTransitionEnd(e.TRANSITION_DURATION):v()}},e.prototype.applyPlacement=function(e,i){var o=this.tip(),n=o[0].offsetWidth,s=o[0].offsetHeight,r=parseInt(o.css("margin-top"),10),l=parseInt(o.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(l)&&(l=0),e.top+=r,e.left+=l,t.offset.setOffset(o[0],t.extend({using:function(t){o.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),o.addClass("in");var a=o[0].offsetWidth,p=o[0].offsetHeight;"top"==i&&p!=s&&(e.top=e.top+s-p);var h=this.getViewportAdjustedDelta(i,e,a,p);h.left?e.left+=h.left:e.top+=h.top;var f=/top|bottom/.test(i),c=f?2*h.left-n+a:2*h.top-s+p,u=f?"offsetWidth":"offsetHeight";o.offset(e),this.replaceArrow(c,o[0][u],f)},e.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},e.prototype.hide=function(i){function o(){"in"!=n.hoverState&&s.detach(),n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),i&&i()}var n=this,s=t(this.$tip),r=t.Event("hide.bs."+this.type);if(this.$element.trigger(r),!r.isDefaultPrevented())return s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(e.TRANSITION_DURATION):o(),this.hoverState=null,this},e.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(e){var i=(e=e||this.$element)[0],o="BODY"==i.tagName,n=i.getBoundingClientRect();null==n.width&&(n=t.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var s=o?{top:0,left:0}:e.offset(),r={scroll:o?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},l=o?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},n,r,l,s)},e.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},e.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var s=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(t)){var l=e.top-s-r.scroll,a=e.top+s-r.scroll+o;l<r.top?n.top=r.top-l:a>r.top+r.height&&(n.top=r.top+r.height-a)}else{var p=e.left-s,h=e.left+s+i;p<r.left?n.left=r.left-p:h>r.right&&(n.left=r.left+r.width-h)}return n},e.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},e.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},e.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(e){var i=this;e&&((i=t(e.currentTarget).data("bs."+this.type))||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},e.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each(function(){var o=t(this),n=o.data("bs.tooltip"),s="object"==typeof i&&i;!n&&/destroy|hide/.test(i)||(n||o.data("bs.tooltip",n=new e(this,s)),"string"==typeof i&&n[i]())})},t.fn.tooltip.Constructor=e,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery);

},{}],234:[function(require,module,exports){
+function(n){"use strict";n.fn.emulateTransitionEnd=function(t){var i=!1,r=this;n(this).one("bsTransitionEnd",function(){i=!0});return setTimeout(function(){i||n(r).trigger(n.support.transition.end)},t),this},n(function(){n.support.transition=function(){var n=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==n.style[i])return{end:t[i]};return!1}(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery);

},{}],235:[function(require,module,exports){
"use strict";function requireDependencies(e,r,i,n){return e?Object.keys(e).map(function(u){var o,t=i&&i[u],s=n&&n[u];try{o=t?path.resolve(r,t):s?resolve.sync(u,{basedir:r}):u}catch(e){o=u}return{alias:o,exports:e[u]||null}}).reduce(function(e,r){var i=r.alias.replace(/\\/g,"\\\\");return r.exports?e+r.exports+" = global."+r.exports+' = require("'+i+'");\n':e+'require("'+i+'");\n'},"\n; "):""}function bindWindowWithExports(e,r){return r+"; var "+shimRequire+"=require;(function browserifyShim(module, exports, require, define, browserify_shim__define__module__export__) {\n"+e+"\n}).call(global, undefined, undefined, undefined, undefined, function defineExport(ex) { module.exports = ex; });\n"}function bindWindowWithoutExports(e,r){return r+"; var "+shimRequire+"=require;(function browserifyShim(module, define, require) {\n"+e+"\n}).call(global, module, undefined, undefined);\n"}function moduleExport(e){return format('\n; browserify_shim__define__module__export__(typeof %s != "undefined" ? %s : window.%s);\n',e,e,e)}function wrap(e,r,i,n){var u=r.exports?e+moduleExport(r.exports):e,o=requireDependencies(r.depends,i,n);return r.exports?bindWindowWithExports(u,o):bindWindowWithoutExports(u,o)}var util=require("util"),resolve=require("resolve"),exposify=require("exposify"),format=require("util").format,path=require("path"),through=require("through"),resolveShims=require("./lib/resolve-shims"),rename=require("rename-function-calls"),debug=require("./lib/debug"),shimRequire="__browserify_shim_require__";module.exports=function(e){var r="",i=through(function(e){r+=e},function(){var n=[];resolveShims(e,n,function(u,o){if(u)return i.emit("error",u),i.queue(null);debug(""),debug.inspect({file:e,info:o,messages:n});var t=o.exposeGlobals;if(t&&Object.keys(t)&&(r=exposify.expose(t,r)),o.shim){var s=wrap(r=rename("require",shimRequire,r),o.shim,o.packageDir,o.browser);i.queue(s)}else i.queue(r);i.queue(null)})});return i};

},{"./lib/debug":236,"./lib/resolve-shims":238,"exposify":240,"path":312,"rename-function-calls":287,"resolve":301,"through":308,"util":316}],236:[function(require,module,exports){
(function (process){
"use strict";function inspect(s,e){return require("util").inspect(s,!1,e||5,!0)}var diagnostics=process.env.BROWSERIFYSHIM_DIAGNOSTICS;exports=module.exports=function(){diagnostics&&console.error.apply(console,arguments)},exports.inspect=function(s,e){diagnostics&&console.error(inspect(s,e))};

}).call(this,require('_process'))

},{"_process":313,"util":316}],237:[function(require,module,exports){
"use strict";function parseDepends(e){if(e)return(e=Array.isArray(e)?e:[e]).reduce(function(e,r){var t=r.split(":");if(!t||t.length>2||t.length<1||!t[0])throw new Error('Invalid depends specification: "'+r+'". Needs to have format: "nameORpath:export"');return t=t.map(function(e){return"string"==typeof e?e.trim():e}),e[t[0]]=t[1]||null,e},{})}var go=module.exports=function(e){return Object.keys(e).reduce(function(r,t){var n=e[t];"string"==typeof n&&(n={exports:n});var s=n.exports&&n.exports.length?n.exports.trim():null;return r[t.trim()]={exports:s,depends:parseDepends(n.depends)},r},{})};

},{}],238:[function(require,module,exports){
"use strict";function inspect(e,s){return util.inspect(e,!1,s||5,!0)}function isPath(e){return/^[.]{0,2}[/\\]/.test(e)}function validate(e,s,r){var o,i='When evaluating shim "'+e+'": '+inspect(s)+"\ninside "+r+"\n";if(!s.hasOwnProperty("exports"))throw o="browserify-shim needs at least a path and exports to do its job, you are missing the exports. \nIf this module has no exports, specify exports as null.",new Error(i+o)}function updateCache(e,s,r,o){shimsCache[e]={pack:s,shims:r,exposeGlobals:o},Object.keys(r).forEach(function(s){var o=r[s];validate(s,o,e),shimsByPath[s]=o})}function resolveDependsRelativeTo(e,s,r,o,i){var n;if(r)return Object.keys(r).reduce(function(t,a){return s[a]?(t[a]=r[a],i.push(format('Found depends "%s" exposed in browser field',a))):isPath(a)?(t[n=path.resolve(e,a)]=r[a],i.push(format('Depends "%s" was resolved to be at [%s]',a,n))):(t[a]=r[a],o[a]?i.push(format('Found depends "%s" as an installed dependency of the package',a)):i.push(format('WARNING, depends "%s" is not a path, nor is it exposed in the browser field, nor was it found in package dependencies.',a))),t},{})}function resolvePaths(e,s,r,o,i,n){return Object.keys(o).reduce(function(t,a){var l,p=o[a],h=r[a];h?(l=path.resolve(e,h),n.push(format('Found "%s" in browser field referencing "%s" and resolved it to "%s"',a,h,l))):s?(l=path.resolve(s,a),n.push(format('Resolved "%s" found in shim file to "%s"',a,l))):(l=path.resolve(e,a),n.push(format('Resolved "%s" found in package.json to "%s"',a,l)));var u=resolveDependsRelativeTo(s||e,r,p.depends,i,n);return t[l]={exports:p.exports,depends:u},t},{})}function mapifyExposeGlobals(e){return Object.keys(e).reduce(function(s,r){var o=e[r],i=o.split(":");if(i.length<2||!i[1].length)throw new Error('Expose Globals need to have the format "global:expression.\n"'+inspect({key:r,value:o})+"does not.");return i.shift(),s[r]=i.join(":"),s},{})}function separateExposeGlobals(e){var s={},r={};return Object.keys(e).forEach(function(o){var i=e[o],n=i&&i.exports;n&&/^global\:/.test(n)?r[o]=n:s[o]=i}),{shims:s,exposeGlobals:mapifyExposeGlobals(r)}}function resolveFromShimFile(e,s,r,o){var i=path.join(e,r),n=path.dirname(i),t=separateExposeGlobals(require(i));return{shims:resolvePaths(e,n,s.browser||{},t.shims,s.dependencies||{},o),exposeGlobals:t.exposeGlobals}}function resolveInlineShims(e,s,r,o){var i=separateExposeGlobals(parseInlineShims(r));return{shims:resolvePaths(e,null,s.browser||{},i.shims,s.dependencies||{},o),exposeGlobals:i.exposeGlobals}}var path=require("path"),fs=require("fs"),util=require("util"),parseInlineShims=require("./parse-inline-shims"),mothership=require("mothership"),format=require("util").format,shimsCache={},shimsByPath={},resolve=module.exports=function(e,s,r){mothership(e,function(e){return!!e["browserify-shim"]},function(o,i){if(o)return r(o);if(!i||!i.pack)return r(new Error("Unable to find a browserify-shim config section in the package.json for "+e));var n=i.pack,t=i.path,a=path.dirname(t),l=shimsCache[a];if(l)return r(null,{package_json:t,packageDir:a,resolvedPreviously:!0,shim:shimsByPath[e],exposeGlobals:l.exposeGlobals,browser:n.browser,"browserify-shim":n["browserify-shim"],dependencies:n.dependencies});try{var p=(n=require(t))["browserify-shim"];if(!p)return r(null,{package_json:t,shim:void 0});var h="string"==typeof p?resolveFromShimFile(a,n,p,s):resolveInlineShims(a,n,p,s);s.push({resolved:h.shims}),updateCache(a,n,h.shims,h.exposeGlobals),r(null,{package_json:t,packageDir:a,shim:shimsByPath[e],exposeGlobals:h.exposeGlobals,browser:n.browser,"browserify-shim":n["browserify-shim"],dependencies:n.dependencies})}catch(o){return console.trace(),r(o)}})};

},{"./parse-inline-shims":237,"fs":309,"mothership":285,"path":312,"util":316}],239:[function(require,module,exports){
"use strict";var mapObject=require("map-obj"),replaceRequires=require("replace-requires"),globalize=require("globo");module.exports=function(e,r){return e=mapObject(e,function(e,r){return[e,globalize(r)]}),replaceRequires(r,e)};

},{"globo":241,"map-obj":248,"replace-requires":249}],240:[function(require,module,exports){
(function (process){
"use strict";var transformify=require("transformify"),through=require("through2"),expose=require("./expose");exports=module.exports=function(e,r){if(r=r||{},r.filePattern=r.filePattern||exports.filePattern,r.expose=r.expose||exports.config,r.filePattern&&!r.filePattern.test(e))return through();if("object"!=typeof r.expose)throw new Error("Please pass { expose: { ... } } to transform, set exposify.config or $EXPOSIFY_CONFIG so exposify knows what to expose");Array.isArray(r.expose._)&&delete r.expose._;return transformify(expose.bind(null,r.expose))(e)},exports.config=function(){if(process.env.EXPOSIFY_CONFIG)try{return JSON.parse(process.env.EXPOSIFY_CONFIG)}catch(e){console.error("Invalid exposify config!"),console.error(e.stack)}}(),exports.filePattern=/\.js$/,exports.expose=expose;

}).call(this,require('_process'))

},{"./expose":239,"_process":313,"through2":273,"transformify":274}],241:[function(require,module,exports){
"use strict";function parenthesize(e){return"("+e+")"}var ternary=require("ternary"),isDefined=require("is-defined"),access=require("accessory");module.exports=function(e){return parenthesize(ternary(isDefined("window"),access("window",e),ternary(isDefined("global"),access("global",e),null)))};

},{"accessory":242,"is-defined":246,"ternary":247}],242:[function(require,module,exports){
"use strict";function accumulate(a,r){function e(a){t+="("+a+")"}var t="",l=findCall(r);if(l){r=l.pre,e(l.body);var u=l.post}for(;u;)e((l=findCall(u)).body),u=l.post;return a+"['"+r+"']"+t}var split=require("dot-parts"),balanced=require("balanced-match"),ap=require("ap"),findCall=ap.partial(balanced,"(",")");module.exports=function(a,r){return split(r).reduce(accumulate,a)};

},{"ap":243,"balanced-match":244,"dot-parts":245}],243:[function(require,module,exports){
function ap(r,t){return function(){var a=[].slice.call(arguments),p=r.slice();return p.push.apply(p,a),t.apply(this,p)}}function pa(r,t){return function(){var a=[].slice.call(arguments);return a.push.apply(a,r),t.apply(this,a)}}function apa(r,t,a){return function(){return a.apply(this,r.concat.apply(r,arguments).concat(t))}}function partial(r){return ap([].slice.call(arguments,1),r)}function partialRight(r){return pa([].slice.call(arguments,1),r)}function curry(r){return partial(partial,r)}exports=module.exports=ap,exports.pa=pa,exports.apa=apa,exports.partial=partial,exports.partialRight=partialRight,exports.curry=curry,exports.curryRight=function(r){return partial(partialRight,r)};

},{}],244:[function(require,module,exports){
function balanced(t,e,r){for(var s=0,n={},a=!1,l=0;l<r.length;l++)if(t==r.substr(l,t.length))"start"in n||(n.start=l),s++;else if(e==r.substr(l,e.length)&&"start"in n&&(a=!0,!--s))return n.end=l,n.pre=r.substr(0,n.start),n.body=n.end-n.start>1?r.substring(n.start+t.length,n.end):"",n.post=r.slice(n.end+e.length),n;if(s&&a){var d=n.start+t.length;return(n=balanced(t,e,r.substr(d)))&&(n.start+=d,n.end+=d,n.pre=r.slice(0,d)+n.pre),n}}module.exports=balanced;

},{}],245:[function(require,module,exports){
"use strict";module.exports=function(r){for(var t=[],e=r.split("."),s=0;s<e.length;s++){for(var l=e[s];"\\"===l[l.length-1];)l=l.slice(0,-1)+".",l+=e[++s];t.push(l)}return t};

},{}],246:[function(require,module,exports){
"use strict";module.exports=function(e){return"typeof "+e+' !== "undefined"'};

},{}],247:[function(require,module,exports){
"use strict";module.exports=function(t,e,r){return t+" ? "+e+" : "+r};

},{}],248:[function(require,module,exports){
"use strict";module.exports=function(e,r){for(var t={},n=Object.keys(e),o=0;o<n.length;o++){var s=n[o],u=r(s,e[s],e);t[u[0]]=u[1]}return t};

},{}],249:[function(require,module,exports){
"use strict";function requireLiteral(e){var r=e.arguments[0];return r&&"Literal"===r.type}var detective=require("detective"),patch=require("patch-text"),hasRequire=require("has-require"),extend=require("xtend");module.exports=function(e,r){var t=new hasRequire.Checker(e);return Object.keys(r).some(t.has,t)?patch(e,detective.find(e,{nodes:!0}).nodes.filter(requireLiteral).map(function(e){return extend(e,{replacement:r[e.arguments[0].value]})}).filter(function(e){return null!=e.replacement})):e};

},{"detective":250,"has-require":254,"patch-text":256,"xtend":257}],250:[function(require,module,exports){
function parse(e,r){return r||(r={}),acorn.parse(e,{ecmaVersion:defined(r.ecmaVersion,8),sourceType:r.sourceType,ranges:defined(r.ranges,r.range),locations:defined(r.locations,r.loc),allowReserved:defined(r.allowReserved,!0),allowReturnOutsideFunction:defined(r.allowReturnOutsideFunction,!0),allowHashBang:defined(r.allowHashBang,!0)})}var acorn=require("acorn"),walk=require("acorn/dist/walk"),defined=require("defined"),requireRe=/\brequire\b/,exports=module.exports=function(e,r){return exports.find(e,r).strings};exports.find=function(e,r){function n(n,s,o){if(a.test(e.slice(n.start,n.end))&&(walk.base[n.type](n,s,o),"CallExpression"===n.type&&i(n))){if(n.arguments.length){var u=n.arguments[0];"Literal"===u.type?t.strings.push(u.value):t.expressions.push(e.slice(u.start,u.end))}r.nodes&&t.nodes.push(n)}}r||(r={});var s=void 0===r.word?"require":r.word;"string"!=typeof e&&(e=String(e));var i=r.isRequire||function(e){return"Identifier"===e.callee.type&&e.callee.name===s},t={strings:[],expressions:[]};r.nodes&&(t.nodes=[]);var a="require"===s?requireRe:RegExp("\\b"+s+"\\b");if(!a.test(e))return t;var o=parse(e,r.parse);return walk.recursive(o,null,{Statement:n,Expression:n}),t};

},{"acorn":251,"acorn/dist/walk":252,"defined":253}],251:[function(require,module,exports){
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.acorn=t.acorn||{})}(this,function(t){"use strict";function e(t,e){for(var s=65536,i=0;i<e.length;i+=2){if((s+=e[i])>t)return!1;if((s+=e[i+1])>=t)return!0}}function s(t,s){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&k.test(String.fromCharCode(t)):!1!==s&&e(t,w)))}function i(t,s){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&g.test(String.fromCharCode(t)):!1!==s&&(e(t,w)||e(t,E)))))}function r(t,e){return new A(t,{beforeExpr:!0,binop:e})}function n(t,e){return void 0===e&&(e={}),e.keyword=t,_[t]=new A(t,e)}function a(t){return 10===t||13===t||8232===t||8233===t}function o(t){return"[object Array]"===Object.prototype.toString.call(t)}function h(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t,e){for(var s=1,i=0;;){N.lastIndex=i;var r=N.exec(t);if(!(r&&r.index<e))return new R(s,e-i);++s,i=r.index+r[0].length}}function c(t){var e={};for(var s in F)e[s]=t&&h(t,s)?t[s]:F[s];if(e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),o(e.onToken)){var i=e.onToken;e.onToken=function(t){return i.push(t)}}return o(e.onComment)&&(e.onComment=function(t,e){return function(s,i,r,n,a,o){var h={type:s?"Block":"Line",value:i,start:r,end:n};t.locations&&(h.loc=new V(this,a,o)),t.ranges&&(h.range=[r,n]),e.push(h)}}(e,e.onComment)),e}function l(t){return new RegExp("^("+t.replace(/ /g,"|")+")$")}function u(t,e,s,i){return t.type=e,t.end=s,this.options.locations&&(t.loc.end=i),this.options.ranges&&(t.range[1]=s),t}function d(t,e,s,i){try{return new RegExp(t,e)}catch(t){if(void 0!==s)throw t instanceof SyntaxError&&i.raise(s,"Error parsing regular expression: "+t.message),t}}function f(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}var m={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},x="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",y={5:x,6:x+" const class extends export import super"},v="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",b="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣔ-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఃా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഁ-ഃാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ංඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ູົຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭ᳲ-᳴᳸᳹᷀-᷵᷻-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱꤀-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿",k=new RegExp("["+v+"]"),g=new RegExp("["+v+b+"]");v=b=null;var w=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,17,26,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,26,45,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,785,52,76,44,33,24,27,35,42,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,54,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,86,25,391,63,32,0,449,56,264,8,2,36,18,0,50,29,881,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,881,68,12,0,67,12,65,0,32,6124,20,754,9486,1,3071,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,4149,196,60,67,1213,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,10591,541],E=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,1306,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,52,0,13,2,49,13,10,2,4,9,83,11,7,0,161,11,6,9,7,3,57,0,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,87,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,423,9,838,7,2,7,17,9,57,21,2,13,19882,9,135,4,60,6,26,9,1016,45,17,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,2214,6,110,6,6,9,792487,239],A=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null},C={beforeExpr:!0},S={startsExpr:!0},_={},P={num:new A("num",S),regexp:new A("regexp",S),string:new A("string",S),name:new A("name",S),eof:new A("eof"),bracketL:new A("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new A("]"),braceL:new A("{",{beforeExpr:!0,startsExpr:!0}),braceR:new A("}"),parenL:new A("(",{beforeExpr:!0,startsExpr:!0}),parenR:new A(")"),comma:new A(",",C),semi:new A(";",C),colon:new A(":",C),dot:new A("."),question:new A("?",C),arrow:new A("=>",C),template:new A("template"),ellipsis:new A("...",C),backQuote:new A("`",S),dollarBraceL:new A("${",{beforeExpr:!0,startsExpr:!0}),eq:new A("=",{beforeExpr:!0,isAssign:!0}),assign:new A("_=",{beforeExpr:!0,isAssign:!0}),incDec:new A("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new A("prefix",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:r("||",1),logicalAND:r("&&",2),bitwiseOR:r("|",3),bitwiseXOR:r("^",4),bitwiseAND:r("&",5),equality:r("==/!=",6),relational:r("</>",7),bitShift:r("<</>>",8),plusMin:new A("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:r("%",10),star:r("*",10),slash:r("/",10),starstar:new A("**",{beforeExpr:!0}),_break:n("break"),_case:n("case",C),_catch:n("catch"),_continue:n("continue"),_debugger:n("debugger"),_default:n("default",C),_do:n("do",{isLoop:!0,beforeExpr:!0}),_else:n("else",C),_finally:n("finally"),_for:n("for",{isLoop:!0}),_function:n("function",S),_if:n("if"),_return:n("return",C),_switch:n("switch"),_throw:n("throw",C),_try:n("try"),_var:n("var"),_const:n("const"),_while:n("while",{isLoop:!0}),_with:n("with"),_new:n("new",{beforeExpr:!0,startsExpr:!0}),_this:n("this",S),_super:n("super",S),_class:n("class"),_extends:n("extends",C),_export:n("export"),_import:n("import"),_null:n("null",S),_true:n("true",S),_false:n("false",S),_in:n("in",{beforeExpr:!0,binop:7}),_instanceof:n("instanceof",{beforeExpr:!0,binop:7}),_typeof:n("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:n("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:n("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},L=/\r\n?|\n|\u2028|\u2029/,N=new RegExp(L.source,"g"),T=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,I=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,R=function(t,e){this.line=t,this.column=e};R.prototype.offset=function(t){return new R(this.line,this.column+t)};var V=function(t,e,s){this.start=e,this.end=s,null!==t.sourceFile&&(this.source=t.sourceFile)},F={ecmaVersion:7,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1,plugins:{}},O={},B=function(t,e,s){this.options=t=c(t),this.sourceFile=t.sourceFile,this.keywords=l(y[t.ecmaVersion>=6?6:5]);var i="";if(!t.allowReserved){for(var r=t.ecmaVersion;!(i=m[r]);r--);"module"==t.sourceType&&(i+=" await")}this.reservedWords=l(i);var n=(i?i+" ":"")+m.strict;this.reservedWordsStrict=l(n),this.reservedWordsStrictBind=l(n+" "+m.strictBind),this.input=String(e),this.containsEsc=!1,this.loadPlugins(t.plugins),s?(this.pos=s,this.lineStart=this.input.lastIndexOf("\n",s-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(L).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=P.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.inFunction=this.inGenerator=this.inAsync=!1,this.yieldPos=this.awaitPos=0,this.labels=[],0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2)};B.prototype.isKeyword=function(t){return this.keywords.test(t)},B.prototype.isReservedWord=function(t){return this.reservedWords.test(t)},B.prototype.extend=function(t,e){this[t]=e(this[t])},B.prototype.loadPlugins=function(t){for(var e in t){var s=O[e];if(!s)throw new Error("Plugin '"+e+"' not found");s(this,t[e])}},B.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};var D=B.prototype,M=/^(?:'((?:[^\']|\.)*)'|"((?:[^\"]|\.)*)"|;)/;D.strictDirective=function(t){for(;;){I.lastIndex=t,t+=I.exec(this.input)[0].length;var e=M.exec(this.input.slice(t));if(!e)return!1;if("use strict"==(e[1]||e[2]))return!0;t+=e[0].length}},D.eat=function(t){return this.type===t&&(this.next(),!0)},D.isContextual=function(t){return this.type===P.name&&this.value===t},D.eatContextual=function(t){return this.value===t&&this.eat(P.name)},D.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},D.canInsertSemicolon=function(){return this.type===P.eof||this.type===P.braceR||L.test(this.input.slice(this.lastTokEnd,this.start))},D.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},D.semicolon=function(){this.eat(P.semi)||this.insertSemicolon()||this.unexpected()},D.afterTrailingComma=function(t,e){if(this.type==t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},D.expect=function(t){this.eat(t)||this.unexpected()},D.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")};var q=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=-1};D.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var s=e?t.parenthesizedAssign:t.parenthesizedBind;s>-1&&this.raiseRecoverable(s,"Parenthesized pattern")}},D.checkExpressionErrors=function(t,e){var s=t?t.shorthandAssign:-1;if(!e)return s>=0;s>-1&&this.raise(s,"Shorthand property assignments are valid only in destructuring patterns")},D.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},D.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var z=B.prototype;z.parseTopLevel=function(t){var e={};for(t.body||(t.body=[]);this.type!==P.eof;){var s=this.parseStatement(!0,!0,e);t.body.push(s)}return this.next(),this.options.ecmaVersion>=6&&(t.sourceType=this.options.sourceType),this.finishNode(t,"Program")};var W={kind:"loop"},j={kind:"switch"};z.isLet=function(){if(this.type!==P.name||this.options.ecmaVersion<6||"let"!=this.value)return!1;I.lastIndex=this.pos;var t=I.exec(this.input),e=this.pos+t[0].length,r=this.input.charCodeAt(e);if(91===r||123==r)return!0;if(s(r,!0)){for(var n=e+1;i(this.input.charCodeAt(n),!0);++n);var a=this.input.slice(e,n);if(!this.isKeyword(a))return!0}return!1},z.isAsyncFunction=function(){if(this.type!==P.name||this.options.ecmaVersion<8||"async"!=this.value)return!1;I.lastIndex=this.pos;var t=I.exec(this.input),e=this.pos+t[0].length;return!(L.test(this.input.slice(this.pos,e))||"function"!==this.input.slice(e,e+8)||e+8!=this.input.length&&i(this.input.charAt(e+8)))},z.parseStatement=function(t,e,s){var i,r=this.type,n=this.startNode();switch(this.isLet()&&(r=P._var,i="let"),r){case P._break:case P._continue:return this.parseBreakContinueStatement(n,r.keyword);case P._debugger:return this.parseDebuggerStatement(n);case P._do:return this.parseDoStatement(n);case P._for:return this.parseForStatement(n);case P._function:return!t&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(n,!1);case P._class:return t||this.unexpected(),this.parseClass(n,!0);case P._if:return this.parseIfStatement(n);case P._return:return this.parseReturnStatement(n);case P._switch:return this.parseSwitchStatement(n);case P._throw:return this.parseThrowStatement(n);case P._try:return this.parseTryStatement(n);case P._const:case P._var:return i=i||this.value,t||"var"==i||this.unexpected(),this.parseVarStatement(n,i);case P._while:return this.parseWhileStatement(n);case P._with:return this.parseWithStatement(n);case P.braceL:return this.parseBlock();case P.semi:return this.parseEmptyStatement(n);case P._export:case P._import:return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===P._import?this.parseImport(n):this.parseExport(n,s);default:if(this.isAsyncFunction()&&t)return this.next(),this.parseFunctionStatement(n,!0);var a=this.value,o=this.parseExpression();return r===P.name&&"Identifier"===o.type&&this.eat(P.colon)?this.parseLabeledStatement(n,a,o):this.parseExpressionStatement(n,o)}},z.parseBreakContinueStatement=function(t,e){var s="break"==e;this.next(),this.eat(P.semi)||this.insertSemicolon()?t.label=null:this.type!==P.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if(null==t.label||r.name===t.label.name){if(null!=r.kind&&(s||"loop"===r.kind))break;if(t.label&&s)break}}return i===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,s?"BreakStatement":"ContinueStatement")},z.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},z.parseDoStatement=function(t){return this.next(),this.labels.push(W),t.body=this.parseStatement(!1),this.labels.pop(),this.expect(P._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(P.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},z.parseForStatement=function(t){if(this.next(),this.labels.push(W),this.expect(P.parenL),this.type===P.semi)return this.parseFor(t,null);var e=this.isLet();if(this.type===P._var||this.type===P._const||e){var s=this.startNode(),i=e?"let":this.value;return this.next(),this.parseVar(s,!0,i),this.finishNode(s,"VariableDeclaration"),!(this.type===P._in||this.options.ecmaVersion>=6&&this.isContextual("of"))||1!==s.declarations.length||"var"!==i&&s.declarations[0].init?this.parseFor(t,s):this.parseForIn(t,s)}var r=new q,n=this.parseExpression(!0,r);return this.type===P._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.toAssignable(n),this.checkLVal(n),this.checkPatternErrors(r,!0),this.parseForIn(t,n)):(this.checkExpressionErrors(r,!0),this.parseFor(t,n))},z.parseFunctionStatement=function(t,e){return this.next(),this.parseFunction(t,!0,!1,e)},z.isFunction=function(){return this.type===P._function||this.isAsyncFunction()},z.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement(!this.strict&&this.isFunction()),t.alternate=this.eat(P._else)?this.parseStatement(!this.strict&&this.isFunction()):null,this.finishNode(t,"IfStatement")},z.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(P.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},z.parseSwitchStatement=function(t){this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(P.braceL),this.labels.push(j);for(var e,s=!1;this.type!=P.braceR;)if(this.type===P._case||this.type===P._default){var i=this.type===P._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),i?e.test=this.parseExpression():(s&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),s=!0,e.test=null),this.expect(P.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(!0));return e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},z.parseThrowStatement=function(t){return this.next(),L.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var U=[];z.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===P._catch){var e=this.startNode();this.next(),this.expect(P.parenL),e.param=this.parseBindingAtom(),this.checkLVal(e.param,!0),this.expect(P.parenR),e.body=this.parseBlock(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(P._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},z.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},z.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(W),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"WhileStatement")},z.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement(!1),this.finishNode(t,"WithStatement")},z.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},z.parseLabeledStatement=function(t,e,s){for(var i=0;i<this.labels.length;++i)this.labels[i].name===e&&this.raise(s.start,"Label '"+e+"' is already declared");for(var r=this.type.isLoop?"loop":this.type===P._switch?"switch":null,n=this.labels.length-1;n>=0;n--){var a=this.labels[n];if(a.statementStart!=t.start)break;a.statementStart=this.start,a.kind=r}return this.labels.push({name:e,kind:r,statementStart:this.start}),t.body=this.parseStatement(!0),("ClassDeclaration"==t.body.type||"VariableDeclaration"==t.body.type&&(this.strict||"var"!=t.body.kind)||"FunctionDeclaration"==t.body.type&&(this.strict||t.body.generator))&&this.raiseRecoverable(t.body.start,"Invalid labeled declaration"),this.labels.pop(),t.label=s,this.finishNode(t,"LabeledStatement")},z.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},z.parseBlock=function(){var t=this.startNode();for(t.body=[],this.expect(P.braceL);!this.eat(P.braceR);){var e=this.parseStatement(!0);t.body.push(e)}return this.finishNode(t,"BlockStatement")},z.parseFor=function(t,e){return t.init=e,this.expect(P.semi),t.test=this.type===P.semi?null:this.parseExpression(),this.expect(P.semi),t.update=this.type===P.parenR?null:this.parseExpression(),this.expect(P.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"ForStatement")},z.parseForIn=function(t,e){var s=this.type===P._in?"ForInStatement":"ForOfStatement";return this.next(),t.left=e,t.right=this.parseExpression(),this.expect(P.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,s)},z.parseVar=function(t,e,s){for(t.declarations=[],t.kind=s;;){var i=this.startNode();if(this.parseVarId(i),this.eat(P.eq)?i.init=this.parseMaybeAssign(e):"const"!==s||this.type===P._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"==i.id.type||e&&(this.type===P._in||this.isContextual("of"))?i.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(P.comma))break}return t},z.parseVarId=function(t){t.id=this.parseBindingAtom(),this.checkLVal(t.id,!0)},z.parseFunction=function(t,e,s,i){this.initFunction(t),this.options.ecmaVersion>=6&&!i&&(t.generator=this.eat(P.star)),this.options.ecmaVersion>=8&&(t.async=!!i),null==e&&(e=this.type==P.name),e&&(t.id=this.parseIdent());var r=this.inGenerator,n=this.inAsync,a=this.yieldPos,o=this.awaitPos,h=this.inFunction;return this.inGenerator=t.generator,this.inAsync=t.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,e||this.type!==P.name||(t.id=this.parseIdent()),this.parseFunctionParams(t),this.parseFunctionBody(t,s),this.inGenerator=r,this.inAsync=n,this.yieldPos=a,this.awaitPos=o,this.inFunction=h,this.finishNode(t,e?"FunctionDeclaration":"FunctionExpression")},z.parseFunctionParams=function(t){this.expect(P.parenL),t.params=this.parseBindingList(P.parenR,!1,this.options.ecmaVersion>=8,!0),this.checkYieldAwaitInDefaultParams()},z.parseClass=function(t,e){this.next(),null==e&&(e=this.type===P.name),this.parseClassId(t,e),this.parseClassSuper(t);var s=this.startNode(),i=!1;for(s.body=[],this.expect(P.braceL);!this.eat(P.braceR);)if(!this.eat(P.semi)){var r=this.startNode(),n=this.eat(P.star),a=!1,o=this.type===P.name&&"static"===this.value;this.parsePropertyName(r),r.static=o&&this.type!==P.parenL,r.static&&(n&&this.unexpected(),n=this.eat(P.star),this.parsePropertyName(r)),this.options.ecmaVersion>=8&&!n&&!r.computed&&"Identifier"===r.key.type&&"async"===r.key.name&&this.type!==P.parenL&&!this.canInsertSemicolon()&&(a=!0,this.parsePropertyName(r)),r.kind="method";var h=!1;if(!r.computed){var p=r.key;n||a||"Identifier"!==p.type||this.type===P.parenL||"get"!==p.name&&"set"!==p.name||(h=!0,r.kind=p.name,p=this.parsePropertyName(r)),!r.static&&("Identifier"===p.type&&"constructor"===p.name||"Literal"===p.type&&"constructor"===p.value)&&(i&&this.raise(p.start,"Duplicate constructor in the same class"),h&&this.raise(p.start,"Constructor can't have get/set modifier"),n&&this.raise(p.start,"Constructor can't be a generator"),a&&this.raise(p.start,"Constructor can't be an async method"),r.kind="constructor",i=!0)}if(this.parseClassMethod(s,r,n,a),h){var c="get"===r.kind?0:1;if(r.value.params.length!==c){var l=r.value.start;"get"===r.kind?this.raiseRecoverable(l,"getter should have no params"):this.raiseRecoverable(l,"setter should have exactly one param")}else"set"===r.kind&&"RestElement"===r.value.params[0].type&&this.raiseRecoverable(r.value.params[0].start,"Setter cannot use rest params")}}return t.body=this.finishNode(s,"ClassBody"),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},z.parseClassMethod=function(t,e,s,i){e.value=this.parseMethod(s,i),t.body.push(this.finishNode(e,"MethodDefinition"))},z.parseClassId=function(t,e){t.id=this.type===P.name?this.parseIdent():e?this.unexpected():null},z.parseClassSuper=function(t){t.superClass=this.eat(P._extends)?this.parseExprSubscripts():null},z.parseExport=function(t,e){if(this.next(),this.eat(P.star))return this.expectContextual("from"),t.source=this.type===P.string?this.parseExprAtom():this.unexpected(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(P._default)){this.checkExport(e,"default",this.lastTokStart);var s;if(this.type===P._function||(s=this.isAsyncFunction())){var i=this.startNode();this.next(),s&&this.next(),t.declaration=this.parseFunction(i,null,!1,s)}else if(this.type===P._class){var r=this.startNode();t.declaration=this.parseClass(r,null)}else t.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(!0),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id.name,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))t.source=this.type===P.string?this.parseExprAtom():this.unexpected();else{for(var n=0;n<t.specifiers.length;n++)(this.keywords.test(t.specifiers[n].local.name)||this.reservedWords.test(t.specifiers[n].local.name))&&this.unexpected(t.specifiers[n].local.start);t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},z.checkExport=function(t,e,s){t&&(Object.prototype.hasOwnProperty.call(t,e)&&this.raiseRecoverable(s,"Duplicate export '"+e+"'"),t[e]=!0)},z.checkPatternExport=function(t,e){var s=e.type;if("Identifier"==s)this.checkExport(t,e.name,e.start);else if("ObjectPattern"==s)for(var i=0;i<e.properties.length;++i)this.checkPatternExport(t,e.properties[i].value);else if("ArrayPattern"==s)for(var r=0;r<e.elements.length;++r){var n=e.elements[r];n&&this.checkPatternExport(t,n)}else"AssignmentPattern"==s?this.checkPatternExport(t,e.left):"ParenthesizedExpression"==s&&this.checkPatternExport(t,e.expression)},z.checkVariableExport=function(t,e){if(t)for(var s=0;s<e.length;s++)this.checkPatternExport(t,e[s].id)},z.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},z.parseExportSpecifiers=function(t){var e=[],s=!0;for(this.expect(P.braceL);!this.eat(P.braceR);){if(s)s=!1;else if(this.expect(P.comma),this.afterTrailingComma(P.braceR))break;var i=this.startNode();i.local=this.parseIdent(!0),i.exported=this.eatContextual("as")?this.parseIdent(!0):i.local,this.checkExport(t,i.exported.name,i.exported.start),e.push(this.finishNode(i,"ExportSpecifier"))}return e},z.parseImport=function(t){return this.next(),this.type===P.string?(t.specifiers=U,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===P.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},z.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===P.name){var s=this.startNode();if(s.local=this.parseIdent(),this.checkLVal(s.local,!0),t.push(this.finishNode(s,"ImportDefaultSpecifier")),!this.eat(P.comma))return t}if(this.type===P.star){var i=this.startNode();return this.next(),this.expectContextual("as"),i.local=this.parseIdent(),this.checkLVal(i.local,!0),t.push(this.finishNode(i,"ImportNamespaceSpecifier")),t}for(this.expect(P.braceL);!this.eat(P.braceR);){if(e)e=!1;else if(this.expect(P.comma),this.afterTrailingComma(P.braceR))break;var r=this.startNode();r.imported=this.parseIdent(!0),this.eatContextual("as")?r.local=this.parseIdent():(r.local=r.imported,this.isKeyword(r.local.name)&&this.unexpected(r.local.start),this.reservedWordsStrict.test(r.local.name)&&this.raiseRecoverable(r.local.start,"The keyword '"+r.local.name+"' is reserved")),this.checkLVal(r.local,!0),t.push(this.finishNode(r,"ImportSpecifier"))}return t};var G=B.prototype;G.toAssignable=function(t,e){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Can not use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":break;case"ObjectExpression":t.type="ObjectPattern";for(var s=0;s<t.properties.length;s++){var i=t.properties[s];"init"!==i.kind&&this.raise(i.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(i.value,e)}break;case"ArrayExpression":t.type="ArrayPattern",this.toAssignableList(t.elements,e);break;case"AssignmentExpression":if("="!==t.operator){this.raise(t.left.end,"Only '=' operator can be used for specifying default value.");break}t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);case"AssignmentPattern":break;case"ParenthesizedExpression":t.expression=this.toAssignable(t.expression,e);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}return t},G.toAssignableList=function(t,e){var s=t.length;if(s){var i=t[s-1];if(i&&"RestElement"==i.type)--s;else if(i&&"SpreadElement"==i.type){i.type="RestElement";var r=i.argument;this.toAssignable(r,e),"Identifier"!==r.type&&"MemberExpression"!==r.type&&"ArrayPattern"!==r.type&&this.unexpected(r.start),--s}e&&i&&"RestElement"===i.type&&"Identifier"!==i.argument.type&&this.unexpected(i.argument.start)}for(var n=0;n<s;n++){var a=t[n];a&&this.toAssignable(a,e)}return t},G.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},G.parseRest=function(t){var e=this.startNode();return this.next(),e.argument=t?this.type===P.name?this.parseIdent():this.unexpected():this.type===P.name||this.type===P.bracketL?this.parseBindingAtom():this.unexpected(),this.finishNode(e,"RestElement")},G.parseBindingAtom=function(){if(this.options.ecmaVersion<6)return this.parseIdent();switch(this.type){case P.name:return this.parseIdent();case P.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(P.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case P.braceL:return this.parseObj(!0);default:this.unexpected()}},G.parseBindingList=function(t,e,s,i){for(var r=[],n=!0;!this.eat(t);)if(n?n=!1:this.expect(P.comma),e&&this.type===P.comma)r.push(null);else{if(s&&this.afterTrailingComma(t))break;if(this.type===P.ellipsis){var a=this.parseRest(i);this.parseBindingListItem(a),r.push(a),this.type===P.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),r.push(o)}return r},G.parseBindingListItem=function(t){return t},G.parseMaybeDefault=function(t,e,s){if(s=s||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(P.eq))return s;var i=this.startNodeAt(t,e);return i.left=s,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")},G.checkLVal=function(t,e,s){switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),s&&(h(s,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),s[t.name]=!0);break;case"MemberExpression":e&&this.raiseRecoverable(t.start,(e?"Binding":"Assigning to")+" member expression");break;case"ObjectPattern":for(var i=0;i<t.properties.length;i++)this.checkLVal(t.properties[i].value,e,s);break;case"ArrayPattern":for(var r=0;r<t.elements.length;r++){var n=t.elements[r];n&&this.checkLVal(n,e,s)}break;case"AssignmentPattern":this.checkLVal(t.left,e,s);break;case"RestElement":this.checkLVal(t.argument,e,s);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,s);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var Y=B.prototype;Y.checkPropClash=function(t,e){if(!(this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var s,i=t.key;switch(i.type){case"Identifier":s=i.name;break;case"Literal":s=String(i.value);break;default:return}var r=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===s&&"init"===r&&(e.proto&&this.raiseRecoverable(i.start,"Redefinition of __proto__ property"),e.proto=!0);else{var n=e[s="$"+s];if(n){var a="init"!==r;(!this.strict&&!a||!n[r])&&a^n.init||this.raiseRecoverable(i.start,"Redefinition of property")}else n=e[s]={init:!1,get:!1,set:!1};n[r]=!0}}},Y.parseExpression=function(t,e){var s=this.start,i=this.startLoc,r=this.parseMaybeAssign(t,e);if(this.type===P.comma){var n=this.startNodeAt(s,i);for(n.expressions=[r];this.eat(P.comma);)n.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(n,"SequenceExpression")}return r},Y.parseMaybeAssign=function(t,e,s){if(this.inGenerator&&this.isContextual("yield"))return this.parseYield();var i=!1,r=-1;e?(r=e.parenthesizedAssign,e.parenthesizedAssign=-1):(e=new q,i=!0);var n=this.start,a=this.startLoc;this.type!=P.parenL&&this.type!=P.name||(this.potentialArrowAt=this.start);var o=this.parseMaybeConditional(t,e);if(s&&(o=s.call(this,o,n,a)),this.type.isAssign){this.checkPatternErrors(e,!0),i||q.call(e);var h=this.startNodeAt(n,a);return h.operator=this.value,h.left=this.type===P.eq?this.toAssignable(o):o,e.shorthandAssign=-1,this.checkLVal(o),this.next(),h.right=this.parseMaybeAssign(t),this.finishNode(h,"AssignmentExpression")}return i&&this.checkExpressionErrors(e,!0),r>-1&&(e.parenthesizedAssign=r),o},Y.parseMaybeConditional=function(t,e){var s=this.start,i=this.startLoc,r=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return r;if(this.eat(P.question)){var n=this.startNodeAt(s,i);return n.test=r,n.consequent=this.parseMaybeAssign(),this.expect(P.colon),n.alternate=this.parseMaybeAssign(t),this.finishNode(n,"ConditionalExpression")}return r},Y.parseExprOps=function(t,e){var s=this.start,i=this.startLoc,r=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)?r:this.parseExprOp(r,s,i,-1,t)},Y.parseExprOp=function(t,e,s,i,r){var n=this.type.binop;if(null!=n&&(!r||this.type!==P._in)&&n>i){var a=this.type===P.logicalOR||this.type===P.logicalAND,o=this.value;this.next();var h=this.start,p=this.startLoc,c=this.parseExprOp(this.parseMaybeUnary(null,!1),h,p,n,r),l=this.buildBinary(e,s,t,c,o,a);return this.parseExprOp(l,e,s,i,r)}return t},Y.buildBinary=function(t,e,s,i,r,n){var a=this.startNodeAt(t,e);return a.left=s,a.operator=r,a.right=i,this.finishNode(a,n?"LogicalExpression":"BinaryExpression")},Y.parseMaybeUnary=function(t,e){var s,i=this.start,r=this.startLoc;if(this.inAsync&&this.isContextual("await"))s=this.parseAwait(t),e=!0;else if(this.type.prefix){var n=this.startNode(),a=this.type===P.incDec;n.operator=this.value,n.prefix=!0,this.next(),n.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),a?this.checkLVal(n.argument):this.strict&&"delete"===n.operator&&"Identifier"===n.argument.type?this.raiseRecoverable(n.start,"Deleting local variable in strict mode"):e=!0,s=this.finishNode(n,a?"UpdateExpression":"UnaryExpression")}else{if(s=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return s;for(;this.type.postfix&&!this.canInsertSemicolon();){var o=this.startNodeAt(i,r);o.operator=this.value,o.prefix=!1,o.argument=s,this.checkLVal(s),this.next(),s=this.finishNode(o,"UpdateExpression")}}return!e&&this.eat(P.starstar)?this.buildBinary(i,r,s,this.parseMaybeUnary(null,!1),"**",!1):s},Y.parseExprSubscripts=function(t){var e=this.start,s=this.startLoc,i=this.parseExprAtom(t),r="ArrowFunctionExpression"===i.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);if(this.checkExpressionErrors(t)||r)return i;var n=this.parseSubscripts(i,e,s);return t&&"MemberExpression"===n.type&&(t.parenthesizedAssign>=n.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=n.start&&(t.parenthesizedBind=-1)),n},Y.parseSubscripts=function(t,e,s,i){for(var r,n=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd==t.end&&!this.canInsertSemicolon();;)if((r=this.eat(P.bracketL))||this.eat(P.dot)){var a=this.startNodeAt(e,s);a.object=t,a.property=r?this.parseExpression():this.parseIdent(!0),a.computed=!!r,r&&this.expect(P.bracketR),t=this.finishNode(a,"MemberExpression")}else if(!i&&this.eat(P.parenL)){var o=new q,h=this.yieldPos,p=this.awaitPos;this.yieldPos=0,this.awaitPos=0;var c=this.parseExprList(P.parenR,this.options.ecmaVersion>=8,!1,o);if(n&&!this.canInsertSemicolon()&&this.eat(P.arrow))return this.checkPatternErrors(o,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=h,this.awaitPos=p,this.parseArrowExpression(this.startNodeAt(e,s),c,!0);this.checkExpressionErrors(o,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=p||this.awaitPos;var l=this.startNodeAt(e,s);l.callee=t,l.arguments=c,t=this.finishNode(l,"CallExpression")}else{if(this.type!==P.backQuote)return t;var u=this.startNodeAt(e,s);u.tag=t,u.quasi=this.parseTemplate(),t=this.finishNode(u,"TaggedTemplateExpression")}},Y.parseExprAtom=function(t){var e,s=this.potentialArrowAt==this.start;switch(this.type){case P._super:this.inFunction||this.raise(this.start,"'super' outside of function or class");case P._this:var i=this.type===P._this?"ThisExpression":"Super";return e=this.startNode(),this.next(),this.finishNode(e,i);case P.name:var r=this.start,n=this.startLoc,a=this.parseIdent(this.type!==P.name);if(this.options.ecmaVersion>=8&&"async"===a.name&&!this.canInsertSemicolon()&&this.eat(P._function))return this.parseFunction(this.startNodeAt(r,n),!1,!1,!0);if(s&&!this.canInsertSemicolon()){if(this.eat(P.arrow))return this.parseArrowExpression(this.startNodeAt(r,n),[a],!1);if(this.options.ecmaVersion>=8&&"async"===a.name&&this.type===P.name)return a=this.parseIdent(),!this.canInsertSemicolon()&&this.eat(P.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,n),[a],!0)}return a;case P.regexp:var o=this.value;return e=this.parseLiteral(o.value),e.regex={pattern:o.pattern,flags:o.flags},e;case P.num:case P.string:return this.parseLiteral(this.value);case P._null:case P._true:case P._false:return e=this.startNode(),e.value=this.type===P._null?null:this.type===P._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case P.parenL:var h=this.start,p=this.parseParenAndDistinguishExpression(s);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(p)&&(t.parenthesizedAssign=h),t.parenthesizedBind<0&&(t.parenthesizedBind=h)),p;case P.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(P.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case P.braceL:return this.parseObj(!1,t);case P._function:return e=this.startNode(),this.next(),this.parseFunction(e,!1);case P._class:return this.parseClass(this.startNode(),!1);case P._new:return this.parseNew();case P.backQuote:return this.parseTemplate();default:this.unexpected()}},Y.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),this.next(),this.finishNode(e,"Literal")},Y.parseParenExpression=function(){this.expect(P.parenL);var t=this.parseExpression();return this.expect(P.parenR),t},Y.parseParenAndDistinguishExpression=function(t){var e,s=this.start,i=this.startLoc,r=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var n,a,o=this.start,h=this.startLoc,p=[],c=!0,l=!1,u=new q,d=this.yieldPos,f=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==P.parenR;){if(c?c=!1:this.expect(P.comma),r&&this.afterTrailingComma(P.parenR,!0)){l=!0;break}if(this.type===P.ellipsis){n=this.start,p.push(this.parseParenItem(this.parseRest())),this.type===P.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}this.type!==P.parenL||a||(a=this.start),p.push(this.parseMaybeAssign(!1,u,this.parseParenItem))}var m=this.start,x=this.startLoc;if(this.expect(P.parenR),t&&!this.canInsertSemicolon()&&this.eat(P.arrow))return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),a&&this.unexpected(a),this.yieldPos=d,this.awaitPos=f,this.parseParenArrowList(s,i,p);p.length&&!l||this.unexpected(this.lastTokStart),n&&this.unexpected(n),this.checkExpressionErrors(u,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=f||this.awaitPos,p.length>1?((e=this.startNodeAt(o,h)).expressions=p,this.finishNodeAt(e,"SequenceExpression",m,x)):e=p[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var y=this.startNodeAt(s,i);return y.expression=e,this.finishNode(y,"ParenthesizedExpression")}return e},Y.parseParenItem=function(t){return t},Y.parseParenArrowList=function(t,e,s){return this.parseArrowExpression(this.startNodeAt(t,e),s)};var Q=[];Y.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(P.dot))return t.meta=e,t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is new.target"),this.inFunction||this.raiseRecoverable(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty");var s=this.start,i=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),s,i,!0),this.eat(P.parenL)?t.arguments=this.parseExprList(P.parenR,this.options.ecmaVersion>=8,!1):t.arguments=Q,this.finishNode(t,"NewExpression")},Y.parseTemplateElement=function(){var t=this.startNode();return t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),t.tail=this.type===P.backQuote,this.finishNode(t,"TemplateElement")},Y.parseTemplate=function(){var t=this.startNode();this.next(),t.expressions=[];var e=this.parseTemplateElement();for(t.quasis=[e];!e.tail;)this.expect(P.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(P.braceR),t.quasis.push(e=this.parseTemplateElement());return this.next(),this.finishNode(t,"TemplateLiteral")},Y.parseObj=function(t,e){var s=this.startNode(),i=!0,r={};for(s.properties=[],this.next();!this.eat(P.braceR);){if(i)i=!1;else if(this.expect(P.comma),this.afterTrailingComma(P.braceR))break;var n,a,o,h,p=this.startNode();this.options.ecmaVersion>=6&&(p.method=!1,p.shorthand=!1,(t||e)&&(o=this.start,h=this.startLoc),t||(n=this.eat(P.star))),this.parsePropertyName(p),t||!(this.options.ecmaVersion>=8)||n||p.computed||"Identifier"!==p.key.type||"async"!==p.key.name||this.type===P.parenL||this.type===P.colon||this.canInsertSemicolon()?a=!1:(a=!0,this.parsePropertyName(p,e)),this.parsePropertyValue(p,t,n,a,o,h,e),this.checkPropClash(p,r),s.properties.push(this.finishNode(p,"Property"))}return this.finishNode(s,t?"ObjectPattern":"ObjectExpression")},Y.parsePropertyValue=function(t,e,s,i,r,n,a){if((s||i)&&this.type===P.colon&&this.unexpected(),this.eat(P.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),t.kind="init";else if(this.options.ecmaVersion>=6&&this.type===P.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(s,i);else if(this.options.ecmaVersion>=5&&!t.computed&&"Identifier"===t.key.type&&("get"===t.key.name||"set"===t.key.name)&&this.type!=P.comma&&this.type!=P.braceR){(s||i||e)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var o="get"===t.kind?0:1;if(t.value.params.length!==o){var h=t.value.start;"get"===t.kind?this.raiseRecoverable(h,"getter should have no params"):this.raiseRecoverable(h,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((this.keywords.test(t.key.name)||(this.strict?this.reservedWordsStrict:this.reservedWords).test(t.key.name)||this.inGenerator&&"yield"==t.key.name||this.inAsync&&"await"==t.key.name)&&this.raiseRecoverable(t.key.start,"'"+t.key.name+"' can not be used as shorthand property"),t.kind="init",e?t.value=this.parseMaybeDefault(r,n,t.key):this.type===P.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),t.value=this.parseMaybeDefault(r,n,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected()},Y.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(P.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(P.bracketR),t.key;t.computed=!1}return t.key=this.type===P.num||this.type===P.string?this.parseExprAtom():this.parseIdent(!0)},Y.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},Y.parseMethod=function(t,e){var s=this.startNode(),i=this.inGenerator,r=this.inAsync,n=this.yieldPos,a=this.awaitPos,o=this.inFunction;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=t),this.options.ecmaVersion>=8&&(s.async=!!e),this.inGenerator=s.generator,this.inAsync=s.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,this.expect(P.parenL),s.params=this.parseBindingList(P.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1),this.inGenerator=i,this.inAsync=r,this.yieldPos=n,this.awaitPos=a,this.inFunction=o,this.finishNode(s,"FunctionExpression")},Y.parseArrowExpression=function(t,e,s){var i=this.inGenerator,r=this.inAsync,n=this.yieldPos,a=this.awaitPos,o=this.inFunction;return this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!s),this.inGenerator=!1,this.inAsync=t.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0),this.inGenerator=i,this.inAsync=r,this.yieldPos=n,this.awaitPos=a,this.inFunction=o,this.finishNode(t,"ArrowFunctionExpression")},Y.parseFunctionBody=function(t,e){var s=e&&this.type!==P.braceL,i=this.strict,r=!1;if(s)t.body=this.parseMaybeAssign(),t.expression=!0;else{var n=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);i&&!n||(r=this.strictDirective(this.end))&&n&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var a=this.labels;this.labels=[],r&&(this.strict=!0),t.body=this.parseBlock(!0),t.expression=!1,this.labels=a}i||r?(this.strict=!0,t.id&&this.checkLVal(t.id,!0),this.checkParams(t),this.strict=i):!e&&this.isSimpleParamList(t.params)||this.checkParams(t)},Y.isSimpleParamList=function(t){for(var e=0;e<t.length;e++)if("Identifier"!==t[e].type)return!1;return!0},Y.checkParams=function(t){for(var e={},s=0;s<t.params.length;s++)this.checkLVal(t.params[s],!0,e)},Y.parseExprList=function(t,e,s,i){for(var r=[],n=!0;!this.eat(t);){if(n)n=!1;else if(this.expect(P.comma),e&&this.afterTrailingComma(t))break;var a;s&&this.type===P.comma?a=null:this.type===P.ellipsis?(a=this.parseSpread(i),i&&this.type===P.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):a=this.parseMaybeAssign(!1,i),r.push(a)}return r},Y.parseIdent=function(t){var e=this.startNode();return t&&"never"==this.options.allowReserved&&(t=!1),this.type===P.name?(!t&&(this.strict?this.reservedWordsStrict:this.reservedWords).test(this.value)&&(this.options.ecmaVersion>=6||-1==this.input.slice(this.start,this.end).indexOf("\\"))&&this.raiseRecoverable(this.start,"The keyword '"+this.value+"' is reserved"),this.inGenerator&&"yield"===this.value&&this.raiseRecoverable(this.start,"Can not use 'yield' as identifier inside a generator"),this.inAsync&&"await"===this.value&&this.raiseRecoverable(this.start,"Can not use 'await' as identifier inside an async function"),e.name=this.value):t&&this.type.keyword?e.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(e,"Identifier")},Y.parseYield=function(){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type==P.semi||this.canInsertSemicolon()||this.type!=P.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(P.star),t.argument=this.parseMaybeAssign()),this.finishNode(t,"YieldExpression")},Y.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0),this.finishNode(t,"AwaitExpression")};var H=B.prototype;H.raise=function(t,e){var s=p(this.input,t);e+=" ("+s.line+":"+s.column+")";var i=new SyntaxError(e);throw i.pos=t,i.loc=s,i.raisedAt=this.pos,i},H.raiseRecoverable=H.raise,H.curPosition=function(){if(this.options.locations)return new R(this.curLine,this.pos-this.lineStart)};var X=function(t,e,s){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new V(t,s)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},$=B.prototype;$.startNode=function(){return new X(this,this.start,this.startLoc)},$.startNodeAt=function(t,e){return new X(this,t,e)},$.finishNode=function(t,e){return u.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},$.finishNodeAt=function(t,e,s,i){return u.call(this,t,e,s,i)};var K=function(t,e,s,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!s,this.override=i},J={b_stat:new K("{",!1),b_expr:new K("{",!0),b_tmpl:new K("${",!0),p_stat:new K("(",!1),p_expr:new K("(",!0),q_tmpl:new K("`",!0,!0,function(t){return t.readTmplToken()}),f_expr:new K("function",!0)},Z=B.prototype;Z.initialContext=function(){return[J.b_stat]},Z.braceIsBlock=function(t){if(t===P.colon){var e=this.curContext();if(e===J.b_stat||e===J.b_expr)return!e.isExpr}return t===P._return?L.test(this.input.slice(this.lastTokEnd,this.start)):t===P._else||t===P.semi||t===P.eof||t===P.parenR||(t==P.braceL?this.curContext()===J.b_stat:!this.exprAllowed)},Z.updateContext=function(t){var e,s=this.type;s.keyword&&t==P.dot?this.exprAllowed=!1:(e=s.updateContext)?e.call(this,t):this.exprAllowed=s.beforeExpr},P.parenR.updateContext=P.braceR.updateContext=function(){if(1!=this.context.length){var t=this.context.pop();t===J.b_stat&&this.curContext()===J.f_expr?(this.context.pop(),this.exprAllowed=!1):this.exprAllowed=t===J.b_tmpl||!t.isExpr}else this.exprAllowed=!0},P.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?J.b_stat:J.b_expr),this.exprAllowed=!0},P.dollarBraceL.updateContext=function(){this.context.push(J.b_tmpl),this.exprAllowed=!0},P.parenL.updateContext=function(t){var e=t===P._if||t===P._for||t===P._with||t===P._while;this.context.push(e?J.p_stat:J.p_expr),this.exprAllowed=!0},P.incDec.updateContext=function(){},P._function.updateContext=function(t){t.beforeExpr&&t!==P.semi&&t!==P._else&&(t!==P.colon&&t!==P.braceL||this.curContext()!==J.b_stat)&&this.context.push(J.f_expr),this.exprAllowed=!1},P.backQuote.updateContext=function(){this.curContext()===J.q_tmpl?this.context.pop():this.context.push(J.q_tmpl),this.exprAllowed=!1};var tt=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new V(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},et=B.prototype,st="object"==typeof Packages&&"[object JavaPackage]"==Object.prototype.toString.call(Packages);et.next=function(){this.options.onToken&&this.options.onToken(new tt(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},et.getToken=function(){return this.next(),new tt(this)},"undefined"!=typeof Symbol&&(et[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===P.eof,value:e}}}}),et.curContext=function(){return this.context[this.context.length-1]},et.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(P.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},et.readToken=function(t){return s(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},et.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=57344)return t;return(t<<10)+this.input.charCodeAt(this.pos+1)-56613888},et.skipBlockComment=function(){var t=this.options.onComment&&this.curPosition(),e=this.pos,s=this.input.indexOf("*/",this.pos+=2);if(-1===s&&this.raise(this.pos-2,"Unterminated comment"),this.pos=s+2,this.options.locations){N.lastIndex=e;for(var i;(i=N.exec(this.input))&&i.index<this.pos;)++this.curLine,this.lineStart=i.index+i[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,s),e,this.pos,t,this.curPosition())},et.skipLineComment=function(t){for(var e=this.pos,s=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&10!==i&&13!==i&&8232!==i&&8233!==i;)++this.pos,i=this.input.charCodeAt(this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,s,this.curPosition())},et.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&T.test(String.fromCharCode(t))))break t;++this.pos}}},et.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var s=this.type;this.type=t,this.value=e,this.updateContext(s)},et.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(P.ellipsis)):(++this.pos,this.finishToken(P.dot))},et.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(P.assign,2):this.finishOp(P.slash,1)},et.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),s=1,i=42===t?P.star:P.modulo;return this.options.ecmaVersion>=7&&42===e&&(++s,i=P.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(P.assign,s+1):this.finishOp(i,s)},et.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?P.logicalOR:P.logicalAND,2):61===e?this.finishOp(P.assign,2):this.finishOp(124===t?P.bitwiseOR:P.bitwiseAND,1)},et.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(P.assign,2):this.finishOp(P.bitwiseXOR,1)},et.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45==e&&62==this.input.charCodeAt(this.pos+2)&&L.test(this.input.slice(this.lastTokEnd,this.pos))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(P.incDec,2):61===e?this.finishOp(P.assign,2):this.finishOp(P.plusMin,1)},et.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),s=1;return e===t?(s=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+s)?this.finishOp(P.assign,s+1):this.finishOp(P.bitShift,s)):33==e&&60==t&&45==this.input.charCodeAt(this.pos+2)&&45==this.input.charCodeAt(this.pos+3)?(this.inModule&&this.unexpected(),this.skipLineComment(4),this.skipSpace(),this.nextToken()):(61===e&&(s=2),this.finishOp(P.relational,s))},et.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(P.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(P.arrow)):this.finishOp(61===t?P.eq:P.prefix,1)},et.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(P.parenL);case 41:return++this.pos,this.finishToken(P.parenR);case 59:return++this.pos,this.finishToken(P.semi);case 44:return++this.pos,this.finishToken(P.comma);case 91:return++this.pos,this.finishToken(P.bracketL);case 93:return++this.pos,this.finishToken(P.bracketR);case 123:return++this.pos,this.finishToken(P.braceL);case 125:return++this.pos,this.finishToken(P.braceR);case 58:return++this.pos,this.finishToken(P.colon);case 63:return++this.pos,this.finishToken(P.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(P.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(P.prefix,1)}this.raise(this.pos,"Unexpected character '"+f(t)+"'")},et.finishOp=function(t,e){var s=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,s)};var it=!!d("￿","u");et.readRegexp=function(){for(var t,e,s=this,i=this.pos;;){s.pos>=s.input.length&&s.raise(i,"Unterminated regular expression");var r=s.input.charAt(s.pos);if(L.test(r)&&s.raise(i,"Unterminated regular expression"),t)t=!1;else{if("["===r)e=!0;else if("]"===r&&e)e=!1;else if("/"===r&&!e)break;t="\\"===r}++s.pos}var n=this.input.slice(i,this.pos);++this.pos;var a=this.readWord1(),o=n,h="";if(a){var p=/^[gim]*$/;this.options.ecmaVersion>=6&&(p=/^[gimuy]*$/),p.test(a)||this.raise(i,"Invalid regular expression flag"),a.indexOf("u")>=0&&(it?h="u":(o=(o=o.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,e,r){return(e=Number("0x"+e))>1114111&&s.raise(i+r+3,"Code point out of bounds"),"x"})).replace(/\\u([a-fA-F0-9]{4})|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"),h=h.replace("u","")))}var c=null;return st||(d(o,h,i,this),c=d(n,a)),this.finishToken(P.regexp,{pattern:n,flags:a,value:c})},et.readInt=function(t,e){for(var s=this.pos,i=0,r=0,n=null==e?1/0:e;r<n;++r){var a,o=this.input.charCodeAt(this.pos);if((a=o>=97?o-97+10:o>=65?o-65+10:o>=48&&o<=57?o-48:1/0)>=t)break;++this.pos,i=i*t+a}return this.pos===s||null!=e&&this.pos-s!==e?null:i},et.readRadixNumber=function(t){this.pos+=2;var e=this.readInt(t);return null==e&&this.raise(this.start+2,"Expected number in radix "+t),s(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(P.num,e)},et.readNumber=function(t){var e=this.pos,i=!1,r=48===this.input.charCodeAt(this.pos);t||null!==this.readInt(10)||this.raise(e,"Invalid number"),r&&this.pos==e+1&&(r=!1);var n=this.input.charCodeAt(this.pos);46!==n||r||(++this.pos,this.readInt(10),i=!0,n=this.input.charCodeAt(this.pos)),69!==n&&101!==n||r||(43!==(n=this.input.charCodeAt(++this.pos))&&45!==n||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number"),i=!0),s(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a,o=this.input.slice(e,this.pos);return i?a=parseFloat(o):r&&1!==o.length?/[89]/.test(o)||this.strict?this.raise(e,"Invalid number"):a=parseInt(o,8):a=parseInt(o,10),this.finishToken(P.num,a)},et.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.raise(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},et.readString=function(t){for(var e="",s=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===t)break;92===i?(e+=this.input.slice(s,this.pos),e+=this.readEscapedChar(!1),s=this.pos):(a(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(s,this.pos++),this.finishToken(P.string,e)},et.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var s=this.input.charCodeAt(this.pos);if(96===s||36===s&&123===this.input.charCodeAt(this.pos+1))return this.pos===this.start&&this.type===P.template?36===s?(this.pos+=2,this.finishToken(P.dollarBraceL)):(++this.pos,this.finishToken(P.backQuote)):(t+=this.input.slice(e,this.pos),this.finishToken(P.template,t));if(92===s)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(a(s)){switch(t+=this.input.slice(e,this.pos),++this.pos,s){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(s)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},et.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return f(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(e>=48&&e<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(s,8);return i>255&&(s=s.slice(0,-1),i=parseInt(s,8)),"0"!==s&&(this.strict||t)&&this.raise(this.pos-2,"Octal literal in strict mode"),this.pos+=s.length-1,String.fromCharCode(i)}return String.fromCharCode(e)}},et.readHexChar=function(t){var e=this.pos,s=this.readInt(16,t);return null===s&&this.raise(e,"Bad character escape sequence"),s},et.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,r=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var a=this.fullCharCodeAtPos();if(i(a,n))this.pos+=a<=65535?1:2;else{if(92!==a)break;this.containsEsc=!0,t+=this.input.slice(r,this.pos);var o=this.pos;117!=this.input.charCodeAt(++this.pos)&&this.raise(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var h=this.readCodePoint();(e?s:i)(h,n)||this.raise(o,"Invalid Unicode escape"),t+=f(h),r=this.pos}e=!1}return t+this.input.slice(r,this.pos)},et.readWord=function(){var t=this.readWord1(),e=P.name;return this.keywords.test(t)&&(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+t),e=_[t]),this.finishToken(e,t)};t.version="4.0.11",t.parse=function(t,e){return new B(e,t).parse()},t.parseExpressionAt=function(t,e,s){var i=new B(s,t,e);return i.nextToken(),i.parseExpression()},t.tokenizer=function(t,e){return new B(e,t)},t.addLooseExports=function(e,s,i){t.parse_dammit=e,t.LooseParser=s,t.pluginsLoose=i},t.Parser=B,t.plugins=O,t.defaultOptions=F,t.Position=R,t.SourceLocation=V,t.getLineInfo=p,t.Node=X,t.TokenType=A,t.tokTypes=P,t.keywordTypes=_,t.TokContext=K,t.tokContexts=J,t.isIdentifierChar=i,t.isIdentifierStart=s,t.Token=tt,t.isNewLine=a,t.lineBreak=L,t.lineBreakG=N,Object.defineProperty(t,"__esModule",{value:!0})});

},{}],252:[function(require,module,exports){
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e.acorn=e.acorn||{},e.acorn.walk=e.acorn.walk||{}))}(this,function(e){"use strict";function t(e){return"string"==typeof e?function(t){return t==e}:e||function(){return!0}}function n(e,t,n){n(e,t)}function r(e,t,n){}var o=function(e,t){this.node=e,this.state=t},i=Object.create||function(e){function t(){}return t.prototype=e,new t},s={};s.Program=s.BlockStatement=function(e,t,n){for(var r=0;r<e.body.length;++r)n(e.body[r],t,"Statement")},s.Statement=n,s.EmptyStatement=r,s.ExpressionStatement=s.ParenthesizedExpression=function(e,t,n){return n(e.expression,t,"Expression")},s.IfStatement=function(e,t,n){n(e.test,t,"Expression"),n(e.consequent,t,"Statement"),e.alternate&&n(e.alternate,t,"Statement")},s.LabeledStatement=function(e,t,n){return n(e.body,t,"Statement")},s.BreakStatement=s.ContinueStatement=r,s.WithStatement=function(e,t,n){n(e.object,t,"Expression"),n(e.body,t,"Statement")},s.SwitchStatement=function(e,t,n){n(e.discriminant,t,"Expression");for(var r=0;r<e.cases.length;++r){var o=e.cases[r];o.test&&n(o.test,t,"Expression");for(var i=0;i<o.consequent.length;++i)n(o.consequent[i],t,"Statement")}},s.ReturnStatement=s.YieldExpression=s.AwaitExpression=function(e,t,n){e.argument&&n(e.argument,t,"Expression")},s.ThrowStatement=s.SpreadElement=function(e,t,n){return n(e.argument,t,"Expression")},s.TryStatement=function(e,t,n){n(e.block,t,"Statement"),e.handler&&n(e.handler,t),e.finalizer&&n(e.finalizer,t,"Statement")},s.CatchClause=function(e,t,n){n(e.param,t,"Pattern"),n(e.body,t,"ScopeBody")},s.WhileStatement=s.DoWhileStatement=function(e,t,n){n(e.test,t,"Expression"),n(e.body,t,"Statement")},s.ForStatement=function(e,t,n){e.init&&n(e.init,t,"ForInit"),e.test&&n(e.test,t,"Expression"),e.update&&n(e.update,t,"Expression"),n(e.body,t,"Statement")},s.ForInStatement=s.ForOfStatement=function(e,t,n){n(e.left,t,"ForInit"),n(e.right,t,"Expression"),n(e.body,t,"Statement")},s.ForInit=function(e,t,n){"VariableDeclaration"==e.type?n(e,t):n(e,t,"Expression")},s.DebuggerStatement=r,s.FunctionDeclaration=function(e,t,n){return n(e,t,"Function")},s.VariableDeclaration=function(e,t,n){for(var r=0;r<e.declarations.length;++r)n(e.declarations[r],t)},s.VariableDeclarator=function(e,t,n){n(e.id,t,"Pattern"),e.init&&n(e.init,t,"Expression")},s.Function=function(e,t,n){e.id&&n(e.id,t,"Pattern");for(var r=0;r<e.params.length;r++)n(e.params[r],t,"Pattern");n(e.body,t,e.expression?"ScopeExpression":"ScopeBody")},s.ScopeBody=function(e,t,n){return n(e,t,"Statement")},s.ScopeExpression=function(e,t,n){return n(e,t,"Expression")},s.Pattern=function(e,t,n){"Identifier"==e.type?n(e,t,"VariablePattern"):"MemberExpression"==e.type?n(e,t,"MemberPattern"):n(e,t)},s.VariablePattern=r,s.MemberPattern=n,s.RestElement=function(e,t,n){return n(e.argument,t,"Pattern")},s.ArrayPattern=function(e,t,n){for(var r=0;r<e.elements.length;++r){var o=e.elements[r];o&&n(o,t,"Pattern")}},s.ObjectPattern=function(e,t,n){for(var r=0;r<e.properties.length;++r)n(e.properties[r].value,t,"Pattern")},s.Expression=n,s.ThisExpression=s.Super=s.MetaProperty=r,s.ArrayExpression=function(e,t,n){for(var r=0;r<e.elements.length;++r){var o=e.elements[r];o&&n(o,t,"Expression")}},s.ObjectExpression=function(e,t,n){for(var r=0;r<e.properties.length;++r)n(e.properties[r],t)},s.FunctionExpression=s.ArrowFunctionExpression=s.FunctionDeclaration,s.SequenceExpression=s.TemplateLiteral=function(e,t,n){for(var r=0;r<e.expressions.length;++r)n(e.expressions[r],t,"Expression")},s.UnaryExpression=s.UpdateExpression=function(e,t,n){n(e.argument,t,"Expression")},s.BinaryExpression=s.LogicalExpression=function(e,t,n){n(e.left,t,"Expression"),n(e.right,t,"Expression")},s.AssignmentExpression=s.AssignmentPattern=function(e,t,n){n(e.left,t,"Pattern"),n(e.right,t,"Expression")},s.ConditionalExpression=function(e,t,n){n(e.test,t,"Expression"),n(e.consequent,t,"Expression"),n(e.alternate,t,"Expression")},s.NewExpression=s.CallExpression=function(e,t,n){if(n(e.callee,t,"Expression"),e.arguments)for(var r=0;r<e.arguments.length;++r)n(e.arguments[r],t,"Expression")},s.MemberExpression=function(e,t,n){n(e.object,t,"Expression"),e.computed&&n(e.property,t,"Expression")},s.ExportNamedDeclaration=s.ExportDefaultDeclaration=function(e,t,n){e.declaration&&n(e.declaration,t,"ExportNamedDeclaration"==e.type||e.declaration.id?"Statement":"Expression"),e.source&&n(e.source,t,"Expression")},s.ExportAllDeclaration=function(e,t,n){n(e.source,t,"Expression")},s.ImportDeclaration=function(e,t,n){for(var r=0;r<e.specifiers.length;r++)n(e.specifiers[r],t);n(e.source,t,"Expression")},s.ImportSpecifier=s.ImportDefaultSpecifier=s.ImportNamespaceSpecifier=s.Identifier=s.Literal=r,s.TaggedTemplateExpression=function(e,t,n){n(e.tag,t,"Expression"),n(e.quasi,t)},s.ClassDeclaration=s.ClassExpression=function(e,t,n){return n(e,t,"Class")},s.Class=function(e,t,n){e.id&&n(e.id,t,"Pattern"),e.superClass&&n(e.superClass,t,"Expression");for(var r=0;r<e.body.body.length;r++)n(e.body.body[r],t)},s.MethodDefinition=s.Property=function(e,t,n){e.computed&&n(e.key,t,"Expression"),n(e.value,t,"Expression")},e.simple=function(t,n,r,o,i){r||(r=e.base),function e(t,o,i){var s=i||t.type,a=n[s];r[s](t,o,e),a&&a(t,o)}(t,o,i)},e.ancestor=function(t,n,r,o){r||(r=e.base);var i=[];!function e(t,o,s){var a=s||t.type,c=n[a],p=t!=i[i.length-1];p&&i.push(t),r[a](t,o,e),c&&c(t,o||i,i),p&&i.pop()}(t,o)},e.recursive=function(t,n,r,o,i){var s=r?e.make(r,o):o;!function e(t,n,r){s[r||t.type](t,n,e)}(t,n,i)},e.findNodeAt=function(n,r,i,s,a,c){s=t(s),a||(a=e.base);try{!function e(t,n,c){var p=c||t.type;if((null==r||t.start<=r)&&(null==i||t.end>=i)&&a[p](t,n,e),(null==r||t.start==r)&&(null==i||t.end==i)&&s(p,t))throw new o(t,n)}(n,c)}catch(e){if(e instanceof o)return e;throw e}},e.findNodeAround=function(n,r,i,s,a){i=t(i),s||(s=e.base);try{!function e(t,n,a){var c=a||t.type;if(!(t.start>r||t.end<r)&&(s[c](t,n,e),i(c,t)))throw new o(t,n)}(n,a)}catch(e){if(e instanceof o)return e;throw e}},e.findNodeAfter=function(n,r,i,s,a){i=t(i),s||(s=e.base);try{!function e(t,n,a){if(!(t.end<r)){var c=a||t.type;if(t.start>=r&&i(c,t))throw new o(t,n);s[c](t,n,e)}}(n,a)}catch(e){if(e instanceof o)return e;throw e}},e.findNodeBefore=function(n,r,i,s,a){i=t(i),s||(s=e.base);var c;return function e(t,n,a){if(!(t.start>r)){var p=a||t.type;t.end<=r&&(!c||c.node.end<t.end)&&i(p,t)&&(c=new o(t,n)),s[p](t,n,e)}}(n,a),c},e.make=function(t,n){n||(n=e.base);var r=i(n);for(var o in t)r[o]=t[o];return r},e.base=s,Object.defineProperty(e,"__esModule",{value:!0})});

},{}],253:[function(require,module,exports){
module.exports=function(){for(var o=0;o<arguments.length;o++)if(void 0!==arguments[o])return arguments[o]};

},{}],254:[function(require,module,exports){
"use strict";function hasRequire(e,r){return new RequireChecker(e).has(r)}function RequireChecker(e){this.code=e}function createRegExp(e){return new RegExp([escape("require("),"\\s*['\"]",e,"['\"]\\s*",escape(")")].join(""))}var escape=require("escape-string-regexp");module.exports=hasRequire,hasRequire.any=function(e){return new RequireChecker(e).any()},hasRequire.Checker=RequireChecker;var anyRegExp=createRegExp("@?[A-Za-z0-9/_.-]+");RequireChecker.prototype.any=function(){return null!=this._any?this._any:(this._any=anyRegExp.test(this.code),this._any)},RequireChecker.prototype.has=function(e){if(!e)throw new Error("module id is required");return this.any()&&createRegExp(escape(e)).test(this.code)};

},{"escape-string-regexp":255}],255:[function(require,module,exports){
"use strict";var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g;module.exports=function(r){if("string"!=typeof r)throw new TypeError("Expected a string");return r.replace(matchOperatorsRe,"\\$&")};

},{}],256:[function(require,module,exports){
"use strict";module.exports=function(e,r){var t=0;return r.reduce(function(e,r){var n=r.start+t,c=r.end+t,u=r.replacement;return t+=u.length-(c-n),e.slice(0,n)+u+e.slice(c)},e)};

},{}],257:[function(require,module,exports){
function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;

},{}],258:[function(require,module,exports){
(function (process){
function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;i<r;i++)t(e[i],i)}module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});

}).call(this,require('_process'))

},{"./_stream_readable":259,"./_stream_writable":261,"_process":313,"core-util-is":262,"inherits":263}],259:[function(require,module,exports){
(function (process){
function ReadableState(e,t){var n=(e=e||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,Stream.call(this)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(null===n||void 0===n)t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&emitReadable(e),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?emitReadable(e):endReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){e.emit("readable")}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&flow(e)}}function flow(e){function t(e,t,i){!1===e.write(n)&&r.awaitDrain++}var n,r=e._readableState;for(r.awaitDrain=0;r.pipesCount&&null!==(n=e.read());)if(1===r.pipesCount?t(r.pipes):forEach(r.pipes,t),e.emit("data",n),r.awaitDrain>0)return;if(0===r.pipesCount)return r.flowing=!1,void(EE.listenerCount(e,"data")>0&&emitDataEvents(e));r.ranOut=!0}function pipeOnReadable(){this._readableState.ranOut&&(this._readableState.ranOut=!1,flow(this))}function emitDataEvents(e,t){if(e._readableState.flowing)throw new Error("Cannot switch to old mode now.");var n=t||!1,r=!1;e.readable=!0,e.pipe=Stream.prototype.pipe,e.on=e.addListener=Stream.prototype.on,e.on("readable",function(){r=!0;for(var t;!n&&null!==(t=e.read());)e.emit("data",t);null===t&&(r=!1,e._readableState.needReadable=!0)}),e.pause=function(){n=!0,this.emit("pause")},e.resume=function(){n=!1,r?process.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else if(e<r[0].length){n=(u=r[0]).slice(0,e),r[0]=u.slice(e)}else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var o=0,l=0,s=r.length;l<s&&o<e;l++){var u=r[0],h=Math.min(e-o,u.length);a?n+=u.slice(0,h):u.copy(n,o,0,h),h<u.length?r[0]=u.slice(h):r.shift(),o+=h}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var StringDecoder;util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding)!==n.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.setEncoding=function(e){StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e};var MAX_HWM=8388608;Readable.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return n=null,t.length>0&&t.decoder&&(n=fromList(e,t),t.length-=n.length),0===t.length&&endReadable(this),n;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(r,t)),null===(n=e>0?fromList(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&endReadable(this),n},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){function n(e){e===s&&i()}function r(){e.end()}function i(){e.removeListener("close",d),e.removeListener("finish",o),e.removeListener("drain",f),e.removeListener("error",a),e.removeListener("unpipe",n),s.removeListener("end",r),s.removeListener("end",i),e._writableState&&!e._writableState.needDrain||f()}function a(t){l(),e.removeListener("error",a),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function d(){e.removeListener("finish",o),l()}function o(){e.removeListener("close",d),l()}function l(){s.unpipe(e)}var s=this,u=this._readableState;switch(u.pipesCount){case 0:u.pipes=e;break;case 1:u.pipes=[u.pipes,e];break;default:u.pipes.push(e)}u.pipesCount+=1;var h=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?r:i;u.endEmitted?process.nextTick(h):s.once("end",h),e.on("unpipe",n);var f=pipeOnDrain(s);return e.on("drain",f),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(a):e._events.error=[a,e._events.error]:e.on("error",a),e.once("close",d),e.once("finish",o),e.emit("pipe",s),u.flowing||(this.on("readable",pipeOnReadable),u.flowing=!0,process.nextTick(function(){flow(s)})),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}return-1===(i=indexOf(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||emitDataEvents(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&emitReadable(this,r):this.read(0))}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){emitDataEvents(this),this.read(0),this.emit("resume")},Readable.prototype.pause=function(){emitDataEvents(this,!0),this.emit("pause")},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){r.push(i)||(n=!0,e.pause())}});for(var i in e)"function"==typeof e[i]&&void 0===this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){n&&(n=!1,e.resume())},r},Readable._fromList=fromList;

}).call(this,require('_process'))

},{"_process":313,"buffer":318,"core-util-is":262,"events":321,"inherits":263,"isarray":264,"stream":360,"string_decoder/":265}],260:[function(require,module,exports){
function TransformState(r,t){this.afterTransform=function(r,e){return afterTransform(t,r,e)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,e){var n=r._transformState;n.transforming=!1;var a=n.writecb;if(!a)return r.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==e&&void 0!==e&&r.push(e),a&&a(t);var i=r._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&r._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r);this._transformState=new TransformState(r,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var e=r._writableState,n=(r._readableState,r._transformState);if(e.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,e){throw new Error("not implemented")},Transform.prototype._write=function(r,t,e){var n=this._transformState;if(n.writecb=e,n.writechunk=r,n.writeencoding=t,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};

},{"./_stream_duplex":258,"core-util-is":262,"inherits":263}],261:[function(require,module,exports){
(function (process){
function WriteReq(e,t,i){this.chunk=e,this.encoding=t,this.callback=i}function WritableState(e,t){var i=(e=e||{}).highWaterMark;this.highWaterMark=i||0===i?i:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=!1===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function Writable(e){var t=require("./_stream_duplex");if(!(this instanceof Writable||this instanceof t))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,Stream.call(this)}function writeAfterEnd(e,t,i){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){i(r)})}function validChunk(e,t,i,r){var n=!0;if(!Buffer.isBuffer(i)&&"string"!=typeof i&&null!==i&&void 0!==i&&!t.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");e.emit("error",f),process.nextTick(function(){r(f)}),n=!1}return n}function decodeChunk(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new Buffer(t,i)),t}function writeOrBuffer(e,t,i,r,n){i=decodeChunk(t,i,r),Buffer.isBuffer(i)&&(r="buffer");var f=t.objectMode?1:i.length;t.length+=f;var o=t.length<t.highWaterMark;return o||(t.needDrain=!0),t.writing?t.buffer.push(new WriteReq(i,r,n)):doWrite(e,t,f,i,r,n),o}function doWrite(e,t,i,r,n,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1}function onwriteError(e,t,i,r,n){i?process.nextTick(function(){n(r)}):n(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if(onwriteStateUpdate(i),t)onwriteError(e,i,r,t,n);else{var f=needFinish(e,i);f||i.bufferProcessing||!i.buffer.length||clearBuffer(e,i),r?process.nextTick(function(){afterWrite(e,i,f,n)}):afterWrite(e,i,f,n)}}function afterWrite(e,t,i,r){i||onwriteDrain(e,t),r(),i&&finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;for(var i=0;i<t.buffer.length;i++){var r=t.buffer[i],n=r.chunk,f=r.encoding,o=r.callback;if(doWrite(e,t,t.objectMode?1:n.length,n,f,o),t.writing){i++;break}}t.bufferProcessing=!1,i<t.buffer.length?t.buffer=t.buffer.slice(i):t.buffer.length=0}function needFinish(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function finishMaybe(e,t){var i=needFinish(e,t);return i&&(t.finished=!0,e.emit("finish")),i}function endWritable(e,t,i){t.ending=!0,finishMaybe(e,t),i&&(t.finished?process.nextTick(i):e.once("finish",i)),t.ended=!0}module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,t,i){var r=this._writableState,n=!1;return"function"==typeof t&&(i=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof i&&(i=function(){}),r.ended?writeAfterEnd(this,r,i):validChunk(this,r,e,i)&&(n=writeOrBuffer(this,r,e,t,i)),n},Writable.prototype._write=function(e,t,i){i(new Error("not implemented"))},Writable.prototype.end=function(e,t,i){var r=this._writableState;"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),void 0!==e&&null!==e&&this.write(e,t),r.ending||r.finished||endWritable(this,r,i)};

}).call(this,require('_process'))

},{"./_stream_duplex":258,"_process":313,"buffer":318,"core-util-is":262,"inherits":263,"stream":360}],262:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;

}).call(this,{"isBuffer":require("../../../../../../../../../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js")})

},{"../../../../../../../../../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js":311}],263:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],264:[function(require,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};

},{}],265:[function(require,module,exports){
function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";e=e.slice(r,e.length);if(!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var h=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,h),h-=this.charReceived);var i;h=(t+=e.toString(this.encoding,0,h)).length-1;if((i=t.charCodeAt(h))>=55296&&i<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,h)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};

},{"buffer":318}],266:[function(require,module,exports){
module.exports=require("./lib/_stream_transform.js");

},{"./lib/_stream_transform.js":260}],267:[function(require,module,exports){
function hasKeys(e){return null!==e&&("object"==typeof e||"function"==typeof e)}module.exports=hasKeys;

},{}],268:[function(require,module,exports){
function extend(){for(var e={},r=0;r<arguments.length;r++){var s=arguments[r];if(hasKeys(s))for(var a=Keys(s),t=0;t<a.length;t++){var n=a[t];e[n]=s[n]}}return e}var Keys=require("object-keys"),hasKeys=require("./has-keys");module.exports=extend;

},{"./has-keys":267,"object-keys":270}],269:[function(require,module,exports){
var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString,isFunction=function(t){var n="function"==typeof t&&!(t instanceof RegExp)||"[object Function]"===toString.call(t);return n||"undefined"==typeof window||(n=t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt),n};module.exports=function(t,n){if(!isFunction(n))throw new TypeError("iterator must be a function");var o,e,r="string"==typeof t,i=t.length,l=arguments.length>2?arguments[2]:null;if(i===+i)for(o=0;o<i;o++)null===l?n(r?t.charAt(o):t[o],o,t):n.call(l,r?t.charAt(o):t[o],o,t);else for(e in t)hasOwn.call(t,e)&&(null===l?n(t[e],e,t):n.call(l,t[e],e,t))};

},{}],270:[function(require,module,exports){
module.exports=Object.keys||require("./shim");

},{"./shim":272}],271:[function(require,module,exports){
var toString=Object.prototype.toString;module.exports=function(t){var e=toString.call(t),o="[object Arguments]"===e;return o||(o="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===toString.call(t.callee)),o};

},{}],272:[function(require,module,exports){
!function(){"use strict";var t,r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,e=require("./foreach"),n=require("./isArguments"),c=!{toString:null}.propertyIsEnumerable("toString"),p=function(){}.propertyIsEnumerable("prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];t=function(t){var i=null!==t&&"object"==typeof t,l="[object Function]"===o.call(t),s=n(t),a=[];if(!i&&!l&&!s)throw new TypeError("Object.keys called on a non-object");if(s)e(t,function(t){a.push(t)});else{var y,f=p&&l;for(y in t)f&&"prototype"===y||!r.call(t,y)||a.push(y)}if(c){var b=t.constructor,h=b&&b.prototype===t;e(u,function(o){h&&"constructor"===o||!r.call(t,o)||a.push(o)})}return a},module.exports=t}();

},{"./foreach":269,"./isArguments":271}],273:[function(require,module,exports){
function noop(r,n,t){t(null,r)}function through2(r){return function(n,t,o){return"function"==typeof n&&(o=t,t=n,n={}),"function"!=typeof t&&(t=noop),"function"!=typeof o&&(o=null),r(n,t,o)}}var Transform=require("readable-stream/transform"),inherits=require("util").inherits,xtend=require("xtend");module.exports=through2(function(r,n,t){var o=new Transform(r);return o._transform=n,t&&(o._flush=t),o}),module.exports.ctor=through2(function(r,n,t){function o(n){if(!(this instanceof o))return new o(n);this.options=xtend(r,n),Transform.call(this,this.options)}return inherits(o,Transform),o.prototype._transform=n,t&&(o.prototype._flush=t),o}),module.exports.obj=through2(function(r,n,t){var o=new Transform(xtend({objectMode:!0},r));return o._transform=n,t&&(o._flush=t),o});

},{"readable-stream/transform":266,"util":316,"xtend":268}],274:[function(require,module,exports){
"use strict";function StringTransform(r,t){if(!(this instanceof StringTransform))return new StringTransform(r,t);t=t||{},Transform.call(this,t),this.transformFn=r,this.string=""}var stream=require("stream"),util=require("util"),Transform=stream.Transform||require("readable-stream").Transform;util.inherits(StringTransform,Transform),StringTransform.prototype._transform=function(r,t,n){this.string+=r.toString(),n()},StringTransform.prototype._flush=function(r){try{var t=this.transformFn(this.string);this.push(t),r()}catch(t){r(t)}};var go=module.exports=function(r){return function(t){return new StringTransform(r)}};

},{"readable-stream":284,"stream":360,"util":316}],275:[function(require,module,exports){
(function (process){
function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;i<r;i++)t(e[i],i)}module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});

}).call(this,require('_process'))

},{"./_stream_readable":277,"./_stream_writable":279,"_process":313,"core-util-is":280,"inherits":281}],276:[function(require,module,exports){
function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":278,"core-util-is":280,"inherits":281}],277:[function(require,module,exports){
(function (process){
function ReadableState(e,t){var n=require("./_stream_duplex"),r=(e=e||{}).highWaterMark,i=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){require("./_stream_duplex");if(!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,Stream.call(this)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(util.isNullOrUndefined(n))t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&emitReadable(e)),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||util.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,emitReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EE.listenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(function(){resume_(e,t)}))}function resume_(e,t){t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;if(debug("flow",t.flowing),t.flowing)do{var n=e.read()}while(null!==n&&t.flowing)}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else if(e<r[0].length){n=(s=r[0]).slice(0,e),r[0]=s.slice(e)}else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var o=0,l=0,u=r.length;l<u&&o<e;l++){var s=r[0],h=Math.min(e-o,s.length);a?n+=s.slice(0,h):s.copy(n,o,0,h),h<s.length?r[0]=s.slice(h):r.shift(),o+=h}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var StringDecoder,debug=require("util");debug=debug&&debug.debuglog?debug.debuglog("stream"):function(){},util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return util.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding)!==n.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;Readable.prototype.read=function(e){debug("read",e);var t=this._readableState,n=e;if((!util.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var r=t.needReadable;debug("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",r=!0),(t.ended||t.reading)&&debug("reading or ended",r=!1),r&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=howMuchToRead(n,t));var i;return i=e>0?fromList(e,t):null,util.isNull(i)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&endReadable(this),util.isNull(i)||this.emit("data",i),i},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){function n(e){debug("onunpipe"),e===s&&i()}function r(){debug("onend"),e.end()}function i(){debug("cleanup"),e.removeListener("close",o),e.removeListener("finish",l),e.removeListener("drain",b),e.removeListener("error",d),e.removeListener("unpipe",n),s.removeListener("end",r),s.removeListener("end",i),s.removeListener("data",a),!h.awaitDrain||e._writableState&&!e._writableState.needDrain||b()}function a(t){debug("ondata");!1===e.write(t)&&(debug("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,s.pause())}function d(t){debug("onerror",t),u(),e.removeListener("error",d),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function o(){e.removeListener("finish",l),u()}function l(){debug("onfinish"),e.removeListener("close",o),u()}function u(){debug("unpipe"),s.unpipe(e)}var s=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,debug("pipe count=%d opts=%j",h.pipesCount,t);var f=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?r:i;h.endEmitted?process.nextTick(f):s.once("end",f),e.on("unpipe",n);var b=pipeOnDrain(s);return e.on("drain",b),s.on("data",a),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(d):e._events.error=[d,e._events.error]:e.on("error",d),e.once("close",o),e.once("finish",l),e.emit("pipe",s),h.flowing||(debug("pipe resume"),s.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}return-1===(i=indexOf(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&emitReadable(this,r);else{var i=this;process.nextTick(function(){debug("readable nexttick read 0"),i.read(0)})}}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,e.reading||(debug("resume read 0"),this.read(0)),resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(debug("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){r.push(i)||(n=!0,e.pause())}});for(var i in e)util.isFunction(e[i])&&util.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},r},Readable._fromList=fromList;

}).call(this,require('_process'))

},{"./_stream_duplex":275,"_process":313,"buffer":318,"core-util-is":280,"events":321,"inherits":281,"isarray":282,"stream":360,"string_decoder/":283,"util":310}],278:[function(require,module,exports){
function TransformState(r,t){this.afterTransform=function(r,n){return afterTransform(t,r,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,util.isNullOrUndefined(n)||r.push(n),i&&i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(r,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){util.isFunction(this._flush)?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var n=r._writableState,e=r._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(e.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;util.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))};

},{"./_stream_duplex":275,"core-util-is":280,"inherits":281}],279:[function(require,module,exports){
(function (process){
function WriteReq(e,i,t){this.chunk=e,this.encoding=i,this.callback=t}function WritableState(e,i){var t=require("./_stream_duplex"),r=(e=e||{}).highWaterMark,n=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.objectMode=!!e.objectMode,i instanceof t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=!1===e.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(i,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function Writable(e){var i=require("./_stream_duplex");if(!(this instanceof Writable||this instanceof i))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,Stream.call(this)}function writeAfterEnd(e,i,t){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){t(r)})}function validChunk(e,i,t,r){var n=!0;if(!(util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||i.objectMode)){var f=new TypeError("Invalid non-string/buffer chunk");e.emit("error",f),process.nextTick(function(){r(f)}),n=!1}return n}function decodeChunk(e,i,t){return!e.objectMode&&!1!==e.decodeStrings&&util.isString(i)&&(i=new Buffer(i,t)),i}function writeOrBuffer(e,i,t,r,n){t=decodeChunk(i,t,r),util.isBuffer(t)&&(r="buffer");var f=i.objectMode?1:t.length;i.length+=f;var o=i.length<i.highWaterMark;return o||(i.needDrain=!0),i.writing||i.corked?i.buffer.push(new WriteReq(t,r,n)):doWrite(e,i,!1,f,t,r,n),o}function doWrite(e,i,t,r,n,f,o){i.writelen=r,i.writecb=o,i.writing=!0,i.sync=!0,t?e._writev(n,i.onwrite):e._write(n,f,i.onwrite),i.sync=!1}function onwriteError(e,i,t,r,n){t?process.nextTick(function(){i.pendingcb--,n(r)}):(i.pendingcb--,n(r)),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,i){var t=e._writableState,r=t.sync,n=t.writecb;if(onwriteStateUpdate(t),i)onwriteError(e,t,r,i,n);else{var f=needFinish(e,t);f||t.corked||t.bufferProcessing||!t.buffer.length||clearBuffer(e,t),r?process.nextTick(function(){afterWrite(e,t,f,n)}):afterWrite(e,t,f,n)}}function afterWrite(e,i,t,r){t||onwriteDrain(e,i),i.pendingcb--,r(),finishMaybe(e,i)}function onwriteDrain(e,i){0===i.length&&i.needDrain&&(i.needDrain=!1,e.emit("drain"))}function clearBuffer(e,i){if(i.bufferProcessing=!0,e._writev&&i.buffer.length>1){for(var t=[],r=0;r<i.buffer.length;r++)t.push(i.buffer[r].callback);i.pendingcb++,doWrite(e,i,!0,i.length,i.buffer,"",function(e){for(var r=0;r<t.length;r++)i.pendingcb--,t[r](e)}),i.buffer=[]}else{for(r=0;r<i.buffer.length;r++){var n=i.buffer[r],f=n.chunk,o=n.encoding,u=n.callback,s=i.objectMode?1:f.length;if(doWrite(e,i,!1,s,f,o,u),i.writing){r++;break}}r<i.buffer.length?i.buffer=i.buffer.slice(r):i.buffer.length=0}i.bufferProcessing=!1}function needFinish(e,i){return i.ending&&0===i.length&&!i.finished&&!i.writing}function prefinish(e,i){i.prefinished||(i.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,i){var t=needFinish(e,i);return t&&(0===i.pendingcb?(prefinish(e,i),i.finished=!0,e.emit("finish")):prefinish(e,i)),t}function endWritable(e,i,t){i.ending=!0,finishMaybe(e,i),t&&(i.finished?process.nextTick(t):e.once("finish",t)),i.ended=!0}module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,i,t){var r=this._writableState,n=!1;return util.isFunction(i)&&(t=i,i=null),util.isBuffer(e)?i="buffer":i||(i=r.defaultEncoding),util.isFunction(t)||(t=function(){}),r.ended?writeAfterEnd(this,r,t):validChunk(this,r,e,t)&&(r.pendingcb++,n=writeOrBuffer(this,r,e,i,t)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||clearBuffer(this,e))},Writable.prototype._write=function(e,i,t){t(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,i,t){var r=this._writableState;util.isFunction(e)?(t=e,e=null,i=null):util.isFunction(i)&&(t=i,i=null),util.isNullOrUndefined(e)||this.write(e,i),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||endWritable(this,r,t)};

}).call(this,require('_process'))

},{"./_stream_duplex":275,"_process":313,"buffer":318,"core-util-is":280,"inherits":281,"stream":360}],280:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;

}).call(this,{"isBuffer":require("../../../../../../../../../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js")})

},{"../../../../../../../../../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js":311}],281:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],282:[function(require,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};

},{}],283:[function(require,module,exports){
function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";e=e.slice(r,e.length);if(!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var h=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,h),h-=this.charReceived);var i;h=(t+=e.toString(this.encoding,0,h)).length-1;if((i=t.charCodeAt(h))>=55296&&i<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,h)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};

},{"buffer":318}],284:[function(require,module,exports){
(function (process){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=require("stream"),exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"),process.browser||"disable"!==process.env.READABLE_STREAM||(module.exports=require("stream"));

}).call(this,require('_process'))

},{"./lib/_stream_duplex.js":275,"./lib/_stream_passthrough.js":276,"./lib/_stream_readable.js":277,"./lib/_stream_transform.js":278,"./lib/_stream_writable.js":279,"_process":313,"stream":360}],285:[function(require,module,exports){
"use strict";var findParentDir=require("find-parent-dir"),path=require("path"),go=module.exports=function(r,n,e){!function r(t){findParentDir(t,"package.json",function(a,i){if(a)return e(a);if(!i)return e();var o;try{if(o=require(path.join(i,"package.json")),n(o))return e(null,{path:path.join(i,"package.json"),pack:o});r(path.resolve(t,".."))}catch(r){e(r)}})}(r)};

},{"find-parent-dir":286,"path":312}],286:[function(require,module,exports){
"use strict";function splitPath(t){var n=t.split(/(\/|\\)/);return n.length?n[0].length?n:n.slice(1):n}var path=require("path"),fs=require("fs"),exists=fs.exists||path.exists,existsSync=fs.existsSync||path.existsSync;exports=module.exports=function(t,n,s){function i(t){if(0===t.length)return s(null,null);var e=t.join("");exists(path.join(e,n),function(n){if(n)return s(null,e);i(t.slice(0,-1))})}i(splitPath(t))},exports.sync=function(t,n){function s(t){if(0===t.length)return null;var i=t.join("");return existsSync(path.join(i,n))?i:s(t.slice(0,-1))}return s(splitPath(t))};

},{"fs":309,"path":312}],287:[function(require,module,exports){
"use strict";function rangeComparator(e,r){return e.from>r.from?1:-1}function getReplacements(e,r,t){var n=new RegExp("^"+e);return detective.find(t,{word:e,nodes:!0,parse:esprimaOpts}).nodes.map(function(e){var a=e.callee,o=t.slice(a.range[0],a.range[1]).replace(n,r);return{from:a.range[0],to:a.range[1],code:o}})}var detective=require("detective"),esprimaOpts={tolerant:!0,range:!0},go=module.exports=function(e,r,t){var n=t;if(!new RegExp(e+" *\\(.*\\)").test(n))return n;var a=n.match(/^#![^\n]*\n/),o=a?a[0]:"";a&&(n=n.slice(o.length));var c=0;return o+getReplacements(e,r,n).sort(rangeComparator).reduce(function(e,r){var t=r.from+c,n=r.to+c,a=r.code,o=a.length-(n-t);return c+=o,e.slice(0,t)+a+e.slice(n)},n)};

},{"detective":288}],288:[function(require,module,exports){
var esprima=require("esprima-fb"),escodegen=require("escodegen"),traverse=function(e,r){Array.isArray(e)?e.forEach(function(n){null!=n&&(n.parent=e,traverse(n,r))}):e&&"object"==typeof e&&(r(e),Object.keys(e).forEach(function(n){"parent"!==n&&e[n]&&(e[n].parent=e,traverse(e[n],r))}))},walk=function(e,r,n){var s=esprima.parse(e,r);traverse(s,n)},exports=module.exports=function(e,r){return exports.find(e,r).strings};exports.find=function(e,r){r||(r={}),r.parse=r.parse||{},r.parse.tolerant=!0;var n=void 0===r.word?"require":r.word;"string"!=typeof e&&(e=String(e)),e=e.replace(/^#![^\n]*\n/,"");var s=r.isRequire||function(e){var r=e.callee;return r&&"CallExpression"===e.type&&"Identifier"===r.type&&r.name===n},t={strings:[],expressions:[]};return r.nodes&&(t.nodes=[]),-1==e.indexOf(n)?t:(walk(e,r.parse,function(e){s(e)&&(e.arguments.length&&("Literal"===e.arguments[0].type?t.strings.push(e.arguments[0].value):t.expressions.push(escodegen.generate(e.arguments[0]))),r.nodes&&t.nodes.push(e))}),t)};

},{"escodegen":289,"esprima-fb":300}],289:[function(require,module,exports){
(function (global){
!function(){"use strict";function e(e,n){var t="";for(n|=0;n>0;n>>>=1,e+=e)1&n&&(t+=e);return t}function n(e){var n=e.length;return n&&v.code.isLineTerminator(e.charCodeAt(n-1))}function t(e,n){function a(e){return"object"==typeof e&&e instanceof Object&&!(e instanceof RegExp)}var r,o;for(r in n)n.hasOwnProperty(r)&&(a(o=n[r])?a(e[r])?t(e[r],o):e[r]=t({},o):e[r]=o);return e}function a(e,n){return 8232==(-2&e)?(n?"u":"\\u")+(8232===e?"2028":"2029"):10===e||13===e?(n?"":"\\")+(10===e?"n":"r"):String.fromCharCode(e)}function r(e,n){var t,a="\\";switch(e){case 8:a+="b";break;case 12:a+="f";break;case 9:a+="t";break;default:t=e.toString(16).toUpperCase(),O||e>255?a+="u"+"0000".slice(t.length)+t:0!==e||v.code.isDecimalDigit(n)?a+=11===e?"x0B":"x"+"00".slice(t.length)+t:a+="0"}return a}function o(e){var n="\\";switch(e){case 92:n+="\\";break;case 10:n+="n";break;case 13:n+="r";break;case 8232:n+="u2028";break;case 8233:n+="u2029";break;default:throw new Error("Incorrectly classified character")}return n}function l(e){var n,t,a,r="";for(n=0,t=e.length;n<t;++n)a=e[n],r+=q(a)?l(a):a;return r}function s(e,n){if(!H)return q(e)?l(e):e;if(null==n){if(e instanceof I)return e;n={}}return null==n.loc?new I(null,null,H,e,n.name||null):new I(n.loc.start.line,n.loc.start.column,!0===H?n.loc.source||null:H,e,n.name||null)}function i(){return R||" "}function c(e,n){var t=s(e).toString(),a=s(n).toString(),r=t.charCodeAt(t.length-1),o=a.charCodeAt(0);return(43===r||45===r)&&r===o||v.code.isIdentifierPart(r)&&v.code.isIdentifierPart(o)||47===r&&105===o?[e,i(),n]:v.code.isWhiteSpace(r)||v.code.isLineTerminator(r)||v.code.isWhiteSpace(o)||v.code.isLineTerminator(o)?[e,n]:[e,R,n]}function p(e){return[D,e]}function u(e){var n,t;return n=D,D+=B,t=e.call(this,D),D=n,t}function h(e,t){return"Line"===e.type?n(e.value)?"//"+e.value:"//"+e.value+"\n":W.format.indent.adjustMultilineComment&&/[\n\r]/.test(e.value)?function(e,n){var t,a,r,o,l,i,c,u;for(t=e.split(/\r\n|[\r\n]/),i=Number.MAX_VALUE,a=1,r=t.length;a<r;++a){for(o=t[a],l=0;l<o.length&&v.code.isWhiteSpace(o.charCodeAt(l));)++l;i>l&&(i=l)}for(void 0!==n?(c=D,"*"===t[1][i]&&(n+=" "),D=n):(1&i&&--i,c=D),a=1,r=t.length;a<r;++a)u=s(p(t[a].slice(i))),t[a]=H?u.join(""):u;return D=c,t.join("\n")}("/*"+e.value+"*/",t):"/*"+e.value+"*/"}function m(t,a){var r,o,l,i,c,u,m;if(t.leadingComments&&t.leadingComments.length>0){for(i=a,l=t.leadingComments[0],a=[],U&&t.type===x.Program&&0===t.body.length&&a.push("\n"),a.push(h(l)),n(s(a).toString())||a.push("\n"),r=1,o=t.leadingComments.length;r<o;++r)n(s(m=[h(l=t.leadingComments[r])]).toString())||m.push("\n"),a.push(p(m));a.push(p(i))}if(t.trailingComments)for(c=!n(s(a).toString()),u=e(" ",function(e){var n;for(n=e.length-1;n>=0&&!v.code.isLineTerminator(e.charCodeAt(n));--n);return e.length-1-n}(s([D,a,B]).toString())),r=0,o=t.trailingComments.length;r<o;++r)l=t.trailingComments[r],c?(a=0===r?[a,B]:[a,u]).push(h(l,u)):a=[a,p(h(l))],r===o-1||n(s(a).toString())||(a=[a,"\n"]);return a}function d(e,n,t){return n<t?["(",e,")"]:e}function f(e,n,t){var a,r;return r=!W.comment||!e.leadingComments,e.type===x.BlockStatement&&r?[R,y(e,{functionBody:t})]:e.type===x.EmptyStatement&&r?";":(u(function(){a=[j,p(y(e,{semicolonOptional:n,functionBody:t}))]}),a)}function w(e,t){var a=n(s(t).toString());return e.type!==x.BlockStatement||W.comment&&e.leadingComments||a?a?[t,D]:[t,j,D]:[t,R]}function g(e){return s(e.name,e)}function b(e,n){return e.type===x.Identifier?g(e):C(e,{precedence:n.precedence,allowIn:n.allowIn,allowCall:!0})}function S(e){var n,t,a,r,o;if((o=e.type===x.ArrowFunctionExpression)&&1===e.params.length&&e.params[0].type===x.Identifier)n=[g(e.params[0])];else{for(n=["("],t=0,a=e.params.length;t<a;++t)n.push(b(e.params[t],{precedence:k.Assignment,allowIn:!0})),t+1<a&&n.push(","+R);n.push(")")}return o&&n.push(R,"=>"),e.expression?(n.push(R),"{"===(r=C(e.body,{precedence:k.Assignment,allowIn:!0,allowCall:!0})).toString().charAt(0)&&(r=["(",r,")"]),n.push(r)):n.push(f(e.body,!1,!0)),n}function C(e,t){var l,p,h,m,f,w,b,I,A,q,B,T,U,z,H,G;if(p=t.precedence,U=t.allowIn,z=t.allowCall,h=e.type||t.type,W.verbatim&&e.hasOwnProperty(W.verbatim))return function(e,n){var t,a;for(a=e[W.verbatim].split(/\r\n|\n/),t=1;t<a.length;t++)a[t]=j+D+a[t];return a=d(a,k.Sequence,n.precedence),s(a,e)}(e,t);switch(h){case x.SequenceExpression:for(l=[],U|=k.Sequence<p,f=0,w=e.expressions.length;f<w;++f)l.push(C(e.expressions[f],{precedence:k.Assignment,allowIn:U,allowCall:!0})),f+1<w&&l.push(","+R);l=d(l,k.Sequence,p);break;case x.AssignmentExpression:U|=k.Assignment<p,l=d([C(e.left,{precedence:k.Call,allowIn:U,allowCall:!0}),R+e.operator+R,C(e.right,{precedence:k.Assignment,allowIn:U,allowCall:!0})],k.Assignment,p);break;case x.ArrowFunctionExpression:U|=k.ArrowFunction<p,l=d(S(e),k.ArrowFunction,p);break;case x.ConditionalExpression:U|=k.Conditional<p,l=d([C(e.test,{precedence:k.LogicalOR,allowIn:U,allowCall:!0}),R+"?"+R,C(e.consequent,{precedence:k.Assignment,allowIn:U,allowCall:!0}),R+":"+R,C(e.alternate,{precedence:k.Assignment,allowIn:U,allowCall:!0})],k.Conditional,p);break;case x.LogicalExpression:case x.BinaryExpression:U|=(m=E[e.operator])<p,B=(I=C(e.left,{precedence:m,allowIn:U,allowCall:!0})).toString(),l=47===B.charCodeAt(B.length-1)&&v.code.isIdentifierPart(e.operator.charCodeAt(0))?[I,i(),e.operator]:c(I,e.operator),I=C(e.right,{precedence:m+1,allowIn:U,allowCall:!0}),"/"===e.operator&&"/"===I.toString().charAt(0)||"<"===e.operator.slice(-1)&&"!--"===I.toString().slice(0,3)?l.push(i(),I):l=c(l,I),l="in"!==e.operator||U?d(l,m,p):["(",l,")"];break;case x.CallExpression:for((l=[C(e.callee,{precedence:k.Call,allowIn:!0,allowCall:!0,allowUnparenthesizedNew:!1})]).push("("),f=0,w=e.arguments.length;f<w;++f)l.push(C(e.arguments[f],{precedence:k.Assignment,allowIn:!0,allowCall:!0})),f+1<w&&l.push(","+R);l.push(")"),l=z?d(l,k.Call,p):["(",l,")"];break;case x.NewExpression:if(w=e.arguments.length,H=void 0===t.allowUnparenthesizedNew||t.allowUnparenthesizedNew,l=c("new",C(e.callee,{precedence:k.New,allowIn:!0,allowCall:!1,allowUnparenthesizedNew:H&&!N&&0===w})),!H||N||w>0){for(l.push("("),f=0;f<w;++f)l.push(C(e.arguments[f],{precedence:k.Assignment,allowIn:!0,allowCall:!0})),f+1<w&&l.push(","+R);l.push(")")}l=d(l,k.New,p);break;case x.MemberExpression:l=[C(e.object,{precedence:k.Call,allowIn:!0,allowCall:z,allowUnparenthesizedNew:!1})],e.computed?l.push("[",C(e.property,{precedence:k.Sequence,allowIn:!0,allowCall:z}),"]"):(e.object.type===x.Literal&&"number"==typeof e.object.value&&(I=s(l).toString()).indexOf(".")<0&&!/[eExX]/.test(I)&&v.code.isDecimalDigit(I.charCodeAt(I.length-1))&&!(I.length>=2&&48===I.charCodeAt(0))&&l.push("."),l.push(".",g(e.property))),l=d(l,k.Member,p);break;case x.UnaryExpression:I=C(e.argument,{precedence:k.Unary,allowIn:!0,allowCall:!0}),""===R?l=c(e.operator,I):(l=[e.operator],e.operator.length>2?l=c(l,I):(q=(B=s(l).toString()).charCodeAt(B.length-1),T=I.toString().charCodeAt(0),(43===q||45===q)&&q===T||v.code.isIdentifierPart(q)&&v.code.isIdentifierPart(T)?l.push(i(),I):l.push(I))),l=d(l,k.Unary,p);break;case x.YieldExpression:l=e.delegate?"yield*":"yield",e.argument&&(l=c(l,C(e.argument,{precedence:k.Yield,allowIn:!0,allowCall:!0}))),l=d(l,k.Yield,p);break;case x.UpdateExpression:l=e.prefix?d([e.operator,C(e.argument,{precedence:k.Unary,allowIn:!0,allowCall:!0})],k.Unary,p):d([C(e.argument,{precedence:k.Postfix,allowIn:!0,allowCall:!0}),e.operator],k.Postfix,p);break;case x.FunctionExpression:G=e.generator&&!W.moz.starlessGenerator,l=G?"function*":"function",l=e.id?[l,G?R:i(),g(e.id),S(e)]:[l+R,S(e)];break;case x.ArrayPattern:case x.ArrayExpression:if(!e.elements.length){l="[]";break}A=e.elements.length>1,l=["[",A?j:""],u(function(n){for(f=0,w=e.elements.length;f<w;++f)e.elements[f]?l.push(A?n:"",C(e.elements[f],{precedence:k.Assignment,allowIn:!0,allowCall:!0})):(A&&l.push(n),f+1===w&&l.push(",")),f+1<w&&l.push(","+(A?j:R))}),A&&!n(s(l).toString())&&l.push(j),l.push(A?D:"","]");break;case x.Property:"get"===e.kind||"set"===e.kind?l=[e.kind,i(),C(e.key,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),S(e.value)]:e.shorthand?l=C(e.key,{precedence:k.Sequence,allowIn:!0,allowCall:!0}):e.method?(l=[],e.value.generator&&l.push("*"),l.push(C(e.key,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),S(e.value))):l=[C(e.key,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),":"+R,C(e.value,{precedence:k.Assignment,allowIn:!0,allowCall:!0})];break;case x.ObjectExpression:if(!e.properties.length){l="{}";break}if(A=e.properties.length>1,u(function(){I=C(e.properties[0],{precedence:k.Sequence,allowIn:!0,allowCall:!0,type:x.Property})}),!A&&!function(e){return/[\r\n]/g.test(e)}(s(I).toString())){l=["{",R,I,R,"}"];break}u(function(n){if(l=["{",j,n,I],A)for(l.push(","+j),f=1,w=e.properties.length;f<w;++f)l.push(n,C(e.properties[f],{precedence:k.Sequence,allowIn:!0,allowCall:!0,type:x.Property})),f+1<w&&l.push(","+j)}),n(s(l).toString())||l.push(j),l.push(D,"}");break;case x.ObjectPattern:if(!e.properties.length){l="{}";break}if(A=!1,1===e.properties.length)e.properties[0].value.type!==x.Identifier&&(A=!0);else for(f=0,w=e.properties.length;f<w;++f)if(!e.properties[f].shorthand){A=!0;break}l=["{",A?j:""],u(function(n){for(f=0,w=e.properties.length;f<w;++f)l.push(A?n:"",C(e.properties[f],{precedence:k.Sequence,allowIn:!0,allowCall:!0})),f+1<w&&l.push(","+(A?j:R))}),A&&!n(s(l).toString())&&l.push(j),l.push(A?D:"","}");break;case x.ThisExpression:l="this";break;case x.Identifier:l=g(e);break;case x.Literal:if(e.hasOwnProperty("raw")&&V)try{if((b=V(e.raw).body[0].expression).type===x.Literal&&b.value===e.value){l=e.raw;break}}catch(e){}if(null===e.value){l="null";break}if("string"==typeof e.value){l=function(e){var n,t,a,l,s,i="",c=0,p=0;for(n=0,t=e.length;n<t;++n){if(39===(a=e.charCodeAt(n)))++c;else if(34===a)++p;else if(47===a&&O)i+="\\";else{if(v.code.isLineTerminator(a)||92===a){i+=o(a);continue}if(O&&a<32||!(O||M||a>=32&&a<=126)){i+=r(a,e.charCodeAt(n+1));continue}}i+=String.fromCharCode(a)}if(l=!("double"===L||"auto"===L&&p<c),s=l?"'":'"',!(l?c:p))return s+i+s;for(e=i,i=s,n=0,t=e.length;n<t;++n)(39===(a=e.charCodeAt(n))&&l||34===a&&!l)&&(i+="\\"),i+=String.fromCharCode(a);return i+s}(e.value);break}if("number"==typeof e.value){l=function(e){var n,t,a,r,o;if(e!=e)throw new Error("Numeric literal whose value is NaN");if(e<0||0===e&&1/e<0)throw new Error("Numeric literal whose value is negative");if(e===1/0)return O?"null":F?"1e400":"1e+400";if(n=""+e,!F||n.length<3)return n;for(t=n.indexOf("."),O||48!==n.charCodeAt(0)||1!==t||(t=0,n=n.slice(1)),a=n,n=n.replace("e+","e"),r=0,(o=a.indexOf("e"))>0&&(r=+a.slice(o+1),a=a.slice(0,o)),t>=0&&(r-=a.length-t-1,a=+(a.slice(0,t)+a.slice(t+1))+""),o=0;48===a.charCodeAt(a.length+o-1);)--o;return 0!==o&&(r-=o,a=a.slice(0,o)),0!==r&&(a+="e"+r),(a.length<n.length||P&&e>1e12&&Math.floor(e)===e&&(a="0x"+e.toString(16)).length<n.length)&&+a===e&&(n=a),n}(e.value);break}if("boolean"==typeof e.value){l=e.value?"true":"false";break}l=function(e){var n,t,r,o,l,s,i,c;if(t=e.toString(),e.source){if(!(n=t.match(/\/([^/]*)$/)))return t;for(r=n[1],t="",i=!1,c=!1,o=0,l=e.source.length;o<l;++o)s=e.source.charCodeAt(o),c?(t+=a(s,c),c=!1):(i?93===s&&(i=!1):47===s?t+="\\":91===s&&(i=!0),t+=a(s,c),c=92===s);return"/"+t+"/"+r}return t}(e.value);break;case x.GeneratorExpression:case x.ComprehensionExpression:l=h===x.GeneratorExpression?["("]:["["],W.moz.comprehensionExpressionStartsWithAssignment&&(I=C(e.body,{precedence:k.Assignment,allowIn:!0,allowCall:!0}),l.push(I)),e.blocks&&u(function(){for(f=0,w=e.blocks.length;f<w;++f)I=C(e.blocks[f],{precedence:k.Sequence,allowIn:!0,allowCall:!0}),f>0||W.moz.comprehensionExpressionStartsWithAssignment?l=c(l,I):l.push(I)}),e.filter&&(l=c(l,"if"+R),I=C(e.filter,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),l=W.moz.parenthesizedComprehensionBlock?c(l,["(",I,")"]):c(l,I)),W.moz.comprehensionExpressionStartsWithAssignment||(I=C(e.body,{precedence:k.Assignment,allowIn:!0,allowCall:!0}),l=c(l,I)),l.push(h===x.GeneratorExpression?")":"]");break;case x.ComprehensionBlock:I=c(I=c(I=e.left.type===x.VariableDeclaration?[e.left.kind,i(),y(e.left.declarations[0],{allowIn:!1})]:C(e.left,{precedence:k.Call,allowIn:!0,allowCall:!0}),e.of?"of":"in"),C(e.right,{precedence:k.Sequence,allowIn:!0,allowCall:!0})),l=W.moz.parenthesizedComprehensionBlock?["for"+R+"(",I,")"]:c("for"+R,I);break;default:throw new Error("Unknown expression type: "+e.type)}return s(l,e)}function y(e,t){var a,r,o,l,h,d,E,I,A,v;switch(h=!0,A=";",d=!1,E=!1,t&&(h=void 0===t.allowIn||t.allowIn,T||!0!==t.semicolonOptional||(A=""),d=t.functionBody,E=t.directiveContext),e.type){case x.BlockStatement:o=["{",j],u(function(){for(a=0,r=e.body.length;a<r;++a)I=p(y(e.body[a],{semicolonOptional:a===r-1,directiveContext:d})),o.push(I),n(s(I).toString())||o.push(j)}),o.push(p("}"));break;case x.BreakStatement:o=e.label?"break "+e.label.name+A:"break"+A;break;case x.ContinueStatement:o=e.label?"continue "+e.label.name+A:"continue"+A;break;case x.DirectiveStatement:o=e.raw?e.raw+A:function(e){var n,t,a,r;for(r="double"===L?'"':"'",n=0,t=e.length;n<t;++n){if(39===(a=e.charCodeAt(n))){r='"';break}if(34===a){r="'";break}92===a&&++n}return r+e+r}(e.directive)+A;break;case x.DoWhileStatement:o=c("do",f(e.body)),o=c(o=w(e.body,o),["while"+R+"(",C(e.test,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),")"+A]);break;case x.CatchClause:u(function(){var n;o=["catch"+R+"(",C(e.param,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),")"],e.guard&&(n=C(e.guard,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),o.splice(2,0," if ",n))}),o.push(f(e.body));break;case x.DebuggerStatement:o="debugger"+A;break;case x.EmptyStatement:o=";";break;case x.ExportDeclaration:if(o="export ",e.declaration){o=[o,y(e.declaration,{semicolonOptional:""===A})];break}break;case x.ExpressionStatement:o=[C(e.expression,{precedence:k.Sequence,allowIn:!0,allowCall:!0})],"{"===(I=s(o).toString()).charAt(0)||"function"===I.slice(0,8)&&"* (".indexOf(I.charAt(8))>=0||z&&E&&e.expression.type===x.Literal&&"string"==typeof e.expression.value?o=["(",o,")"+A]:o.push(A);break;case x.VariableDeclarator:o=e.init?[C(e.id,{precedence:k.Assignment,allowIn:h,allowCall:!0}),R,"=",R,C(e.init,{precedence:k.Assignment,allowIn:h,allowCall:!0})]:b(e.id,{precedence:k.Assignment,allowIn:h});break;case x.VariableDeclaration:o=[e.kind],1===e.declarations.length&&e.declarations[0].init&&e.declarations[0].init.type===x.FunctionExpression?o.push(i(),y(e.declarations[0],{allowIn:h})):u(function(){for(l=e.declarations[0],W.comment&&l.leadingComments?o.push("\n",p(y(l,{allowIn:h}))):o.push(i(),y(l,{allowIn:h})),a=1,r=e.declarations.length;a<r;++a)l=e.declarations[a],W.comment&&l.leadingComments?o.push(","+j,p(y(l,{allowIn:h}))):o.push(","+R,y(l,{allowIn:h}))}),o.push(A);break;case x.ThrowStatement:o=[c("throw",C(e.argument,{precedence:k.Sequence,allowIn:!0,allowCall:!0})),A];break;case x.TryStatement:if(o=["try",f(e.block)],o=w(e.block,o),e.handlers)for(a=0,r=e.handlers.length;a<r;++a)o=c(o,y(e.handlers[a])),(e.finalizer||a+1!==r)&&(o=w(e.handlers[a].body,o));else{for(e.guardedHandlers=e.guardedHandlers||[],a=0,r=e.guardedHandlers.length;a<r;++a)o=c(o,y(e.guardedHandlers[a])),(e.finalizer||a+1!==r)&&(o=w(e.guardedHandlers[a].body,o));if(e.handler)if(q(e.handler))for(a=0,r=e.handler.length;a<r;++a)o=c(o,y(e.handler[a])),(e.finalizer||a+1!==r)&&(o=w(e.handler[a].body,o));else o=c(o,y(e.handler)),e.finalizer&&(o=w(e.handler.body,o))}e.finalizer&&(o=c(o,["finally",f(e.finalizer)]));break;case x.SwitchStatement:if(u(function(){o=["switch"+R+"(",C(e.discriminant,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),")"+R+"{"+j]}),e.cases)for(a=0,r=e.cases.length;a<r;++a)I=p(y(e.cases[a],{semicolonOptional:a===r-1})),o.push(I),n(s(I).toString())||o.push(j);o.push(p("}"));break;case x.SwitchCase:u(function(){for(o=e.test?[c("case",C(e.test,{precedence:k.Sequence,allowIn:!0,allowCall:!0})),":"]:["default:"],a=0,(r=e.consequent.length)&&e.consequent[0].type===x.BlockStatement&&(I=f(e.consequent[0]),o.push(I),a=1),a===r||n(s(o).toString())||o.push(j);a<r;++a)I=p(y(e.consequent[a],{semicolonOptional:a===r-1&&""===A})),o.push(I),a+1===r||n(s(I).toString())||o.push(j)});break;case x.IfStatement:u(function(){o=["if"+R+"(",C(e.test,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),")"]}),e.alternate?(o.push(f(e.consequent)),o=w(e.consequent,o),o=e.alternate.type===x.IfStatement?c(o,["else ",y(e.alternate,{semicolonOptional:""===A})]):c(o,c("else",f(e.alternate,""===A)))):o.push(f(e.consequent,""===A));break;case x.ForStatement:u(function(){o=["for"+R+"("],e.init?e.init.type===x.VariableDeclaration?o.push(y(e.init,{allowIn:!1})):o.push(C(e.init,{precedence:k.Sequence,allowIn:!1,allowCall:!0}),";"):o.push(";"),e.test?o.push(R,C(e.test,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),";"):o.push(";"),e.update?o.push(R,C(e.update,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),")"):o.push(")")}),o.push(f(e.body,""===A));break;case x.ForInStatement:o=["for"+R+"("],u(function(){e.left.type===x.VariableDeclaration?u(function(){o.push(e.left.kind+i(),y(e.left.declarations[0],{allowIn:!1}))}):o.push(C(e.left,{precedence:k.Call,allowIn:!0,allowCall:!0})),o=[c(o=c(o,"in"),C(e.right,{precedence:k.Sequence,allowIn:!0,allowCall:!0})),")"]}),o.push(f(e.body,""===A));break;case x.LabeledStatement:o=[e.label.name+":",f(e.body,""===A)];break;case x.Program:for(r=e.body.length,o=[U&&r>0?"\n":""],a=0;a<r;++a)I=p(y(e.body[a],{semicolonOptional:!U&&a===r-1,directiveContext:!0})),o.push(I),a+1<r&&!n(s(I).toString())&&o.push(j);break;case x.FunctionDeclaration:v=e.generator&&!W.moz.starlessGenerator,o=[v?"function*":"function",v?R:i(),g(e.id),S(e)];break;case x.ReturnStatement:o=e.argument?[c("return",C(e.argument,{precedence:k.Sequence,allowIn:!0,allowCall:!0})),A]:["return"+A];break;case x.WhileStatement:u(function(){o=["while"+R+"(",C(e.test,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),")"]}),o.push(f(e.body,""===A));break;case x.WithStatement:u(function(){o=["with"+R+"(",C(e.object,{precedence:k.Sequence,allowIn:!0,allowCall:!0}),")"]}),o.push(f(e.body,""===A));break;default:throw new Error("Unknown statement type: "+e.type)}return W.comment&&(o=m(e,o)),I=s(o).toString(),e.type!==x.Program||U||""!==j||"\n"!==I.charAt(I.length-1)||(o=H?s(o).replaceRight(/\s+$/,""):I.replace(/\s+$/,"")),s(o,e)}var x,k,E,I,A,v,q,D,B,O,F,P,L,M,j,R,N,T,U,z,W,V,H,G,Y;A=require("estraverse"),v=require("esutils"),x={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportDeclaration:"ExportDeclaration",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},E={"||":(k={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,LogicalOR:3,LogicalAND:4,BitwiseOR:5,BitwiseXOR:6,BitwiseAND:7,Equality:8,Relational:9,BitwiseSHIFT:10,Additive:11,Multiplicative:12,Unary:13,Postfix:14,Call:15,New:16,Member:17,Primary:18}).LogicalOR,"&&":k.LogicalAND,"|":k.BitwiseOR,"^":k.BitwiseXOR,"&":k.BitwiseAND,"==":k.Equality,"!=":k.Equality,"===":k.Equality,"!==":k.Equality,is:k.Equality,isnt:k.Equality,"<":k.Relational,">":k.Relational,"<=":k.Relational,">=":k.Relational,in:k.Relational,instanceof:k.Relational,"<<":k.BitwiseSHIFT,">>":k.BitwiseSHIFT,">>>":k.BitwiseSHIFT,"+":k.Additive,"-":k.Additive,"*":k.Multiplicative,"%":k.Multiplicative,"/":k.Multiplicative},(q=Array.isArray)||(q=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),G={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},Y={indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:"\n",space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1},exports.version=require("./package.json").version,exports.generate=function(n,a){var r,o,l={indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:"\n",space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1,parenthesizedComprehensionBlock:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,verbatim:null};switch(null!=a?("string"==typeof a.indent&&(l.format.indent.style=a.indent),"number"==typeof a.base&&(l.format.indent.base=a.base),a=t(l,a),B=a.format.indent.style,D="string"==typeof a.base?a.base:e(B,a.format.indent.base)):(B=(a=l).format.indent.style,D=e(B,a.format.indent.base)),O=a.format.json,F=a.format.renumber,P=!O&&a.format.hexadecimal,L=O?"double":a.format.quotes,M=a.format.escapeless,j=a.format.newline,R=a.format.space,a.format.compact&&(j=R=B=D=""),N=a.format.parentheses,T=a.format.semicolons,U=a.format.safeConcatenation,z=a.directive,V=O?null:a.parse,H=a.sourceMap,W=a,H&&(I=exports.browser?global.sourceMap.SourceNode:require("source-map").SourceNode),n.type){case x.BlockStatement:case x.BreakStatement:case x.CatchClause:case x.ContinueStatement:case x.DirectiveStatement:case x.DoWhileStatement:case x.DebuggerStatement:case x.EmptyStatement:case x.ExpressionStatement:case x.ForStatement:case x.ForInStatement:case x.FunctionDeclaration:case x.IfStatement:case x.LabeledStatement:case x.Program:case x.ReturnStatement:case x.SwitchStatement:case x.SwitchCase:case x.ThrowStatement:case x.TryStatement:case x.VariableDeclaration:case x.VariableDeclarator:case x.WhileStatement:case x.WithStatement:r=y(n);break;case x.AssignmentExpression:case x.ArrayExpression:case x.ArrayPattern:case x.BinaryExpression:case x.CallExpression:case x.ConditionalExpression:case x.FunctionExpression:case x.Identifier:case x.Literal:case x.LogicalExpression:case x.MemberExpression:case x.NewExpression:case x.ObjectExpression:case x.ObjectPattern:case x.Property:case x.SequenceExpression:case x.ThisExpression:case x.UnaryExpression:case x.UpdateExpression:case x.YieldExpression:r=C(n,{precedence:k.Sequence,allowIn:!0,allowCall:!0});break;default:throw new Error("Unknown node type: "+n.type)}return H?(o=r.toStringWithSourceMap({file:a.file,sourceRoot:a.sourceMapRoot}),a.sourceContent&&o.map.setSourceContent(a.sourceMap,a.sourceContent),a.sourceMapWithCode?o:o.map.toString()):r.toString()},exports.attachComments=A.attachComments,exports.browser=!1,exports.FORMAT_MINIFY=G,exports.FORMAT_DEFAULTS=Y}();

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./package.json":299,"estraverse":290,"esutils":293,"source-map":294}],290:[function(require,module,exports){
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["exports"],t):t("undefined"!=typeof exports?exports:e.estraverse={})}(this,function(e){"use strict";function t(){}function n(e){var t,r,i={};for(t in e)e.hasOwnProperty(t)&&(r=e[t],i[t]="object"==typeof r&&null!==r?n(r):r);return i}function r(e,t){this.parent=e,this.key=t}function i(e,t,n,r){this.node=e,this.path=t,this.wrap=n,this.ref=r}function s(){}function a(e,t){return(new s).traverse(e,t)}function o(e,t){var n;return n=function(e,t){var n,r,i,s;for(r=e.length,i=0;r;)t(e[s=i+(n=r>>>1)])?r=n:(i=s+1,r-=n+1);return i}(t,function(t){return t.range[0]>e.range[0]}),e.extendedRange=[e.range[0],e.range[1]],n!==t.length&&(e.extendedRange[1]=t[n].range[0]),(n-=1)>=0&&(e.extendedRange[0]=t[n].range[1]),e}var l,p,u,h,c,m;l={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},(p=Array.isArray)||(p=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t(),t(),h={AssignmentExpression:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","defaults","rest","body"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","body","superClass"],ClassExpression:["id","body","superClass"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","defaults","rest","body"],FunctionExpression:["id","params","defaults","rest","body"],Identifier:[],IfStatement:["test","consequent","alternate"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MethodDefinition:["key","value"],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],Program:["body"],Property:["key","value"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handlers","handler","guardedHandlers","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},u={Break:c={},Skip:m={}},r.prototype.replace=function(e){this.parent[this.key]=e},s.prototype.path=function(){function e(e,t){if(p(t))for(r=0,i=t.length;r<i;++r)e.push(t[r]);else e.push(t)}var t,n,r,i,s;if(!this.__current.path)return null;for(s=[],t=2,n=this.__leavelist.length;t<n;++t)e(s,this.__leavelist[t].path);return e(s,this.__current.path),s},s.prototype.parents=function(){var e,t,n;for(n=[],e=1,t=this.__leavelist.length;e<t;++e)n.push(this.__leavelist[e].node);return n},s.prototype.current=function(){return this.__current.node},s.prototype.__execute=function(e,t){var n,r;return r=void 0,n=this.__current,this.__current=t,this.__state=null,e&&(r=e.call(this,t.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=n,r},s.prototype.notify=function(e){this.__state=e},s.prototype.skip=function(){this.notify(m)},s.prototype.break=function(){this.notify(c)},s.prototype.__initialize=function(e,t){this.visitor=t,this.root=e,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null},s.prototype.traverse=function(e,t){var n,r,s,a,o,u,d,f,g,x,y,_;for(this.__initialize(e,t),_={},n=this.__worklist,r=this.__leavelist,n.push(new i(e,null,null,null)),r.push(new i(null,null,null,null));n.length;)if((s=n.pop())!==_){if(s.node){if(u=this.__execute(t.enter,s),this.__state===c||u===c)return;if(n.push(_),r.push(s),this.__state===m||u===m)continue;for(a=s.node,o=s.wrap||a.type,f=(x=h[o]).length;(f-=1)>=0;)if(d=x[f],y=a[d])if(p(y))for(g=y.length;(g-=1)>=0;)y[g]&&(s=o!==l.ObjectExpression&&o!==l.ObjectPattern||"properties"!==x[f]?new i(y[g],[d,g],null,null):new i(y[g],[d,g],"Property",null),n.push(s));else n.push(new i(y,d,null,null))}}else if(s=r.pop(),u=this.__execute(t.leave,s),this.__state===c||u===c)return},s.prototype.replace=function(e,t){var n,s,a,o,u,d,f,g,x,y,_,S,E;for(this.__initialize(e,t),_={},n=this.__worklist,s=this.__leavelist,d=new i(e,null,null,new r(S={root:e},"root")),n.push(d),s.push(d);n.length;)if((d=n.pop())!==_){if(void 0!==(u=this.__execute(t.enter,d))&&u!==c&&u!==m&&(d.ref.replace(u),d.node=u),this.__state===c||u===c)return S.root;if((a=d.node)&&(n.push(_),s.push(d),this.__state!==m&&u!==m))for(o=d.wrap||a.type,f=(x=h[o]).length;(f-=1)>=0;)if(E=x[f],y=a[E])if(p(y))for(g=y.length;(g-=1)>=0;)y[g]&&(d=o===l.ObjectExpression&&"properties"===x[f]?new i(y[g],[E,g],"Property",new r(y,g)):new i(y[g],[E,g],null,new r(y,g)),n.push(d));else n.push(new i(y,E,null,new r(a,E)))}else if(d=s.pop(),void 0!==(u=this.__execute(t.leave,d))&&u!==c&&u!==m&&d.ref.replace(u),this.__state===c||u===c)return S.root;return S.root},e.version="1.5.1-dev",e.Syntax=l,e.traverse=a,e.replace=function(e,t){return(new s).replace(e,t)},e.attachComments=function(e,t,r){var i,s,l,p,h=[];if(!e.range)throw new Error("attachComments needs range information");if(!r.length){if(t.length){for(l=0,s=t.length;l<s;l+=1)(i=n(t[l])).extendedRange=[0,e.range[0]],h.push(i);e.leadingComments=h}return e}for(l=0,s=t.length;l<s;l+=1)h.push(o(n(t[l]),r));return p=0,a(e,{enter:function(e){for(var t;p<h.length&&!((t=h[p]).extendedRange[1]>e.range[0]);)t.extendedRange[1]===e.range[0]?(e.leadingComments||(e.leadingComments=[]),e.leadingComments.push(t),h.splice(p,1)):p+=1;return p===h.length?u.Break:h[p].extendedRange[0]>e.range[1]?u.Skip:void 0}}),p=0,a(e,{leave:function(e){for(var t;p<h.length&&(t=h[p],!(e.range[1]<t.extendedRange[0]));)e.range[1]===t.extendedRange[0]?(e.trailingComments||(e.trailingComments=[]),e.trailingComments.push(t),h.splice(p,1)):p+=1;return p===h.length?u.Break:h[p].extendedRange[0]>e.range[1]?u.Skip:void 0}}),e},e.VisitorKeys=h,e.VisitorOption=u,e.Controller=s});

},{}],291:[function(require,module,exports){
!function(){"use strict";function i(i){return i>=48&&i<=57}var t;t={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},module.exports={isDecimalDigit:i,isHexDigit:function(t){return i(t)||97<=t&&t<=102||65<=t&&t<=70},isOctalDigit:function(i){return i>=48&&i<=55},isWhiteSpace:function(i){return 32===i||9===i||11===i||12===i||160===i||i>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(i)>=0},isLineTerminator:function(i){return 10===i||13===i||8232===i||8233===i},isIdentifierStart:function(i){return 36===i||95===i||i>=65&&i<=90||i>=97&&i<=122||92===i||i>=128&&t.NonAsciiIdentifierStart.test(String.fromCharCode(i))},isIdentifierPart:function(i){return 36===i||95===i||i>=65&&i<=90||i>=97&&i<=122||i>=48&&i<=57||92===i||i>=128&&t.NonAsciiIdentifierPart.test(String.fromCharCode(i))}}}();

},{}],292:[function(require,module,exports){
!function(){"use strict";function e(e,t){if(t&&function(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}var t=require("./code");module.exports={isKeywordES5:function(t,r){return!(!r&&"yield"===t)&&e(t,r)},isKeywordES6:e,isRestrictedWord:function(e){return"eval"===e||"arguments"===e},isIdentifierName:function(e){var r,n,i;if(0===e.length)return!1;if(i=e.charCodeAt(0),!t.isIdentifierStart(i)||92===i)return!1;for(r=1,n=e.length;r<n;++r)if(i=e.charCodeAt(r),!t.isIdentifierPart(i)||92===i)return!1;return!0}}}();

},{"./code":291}],293:[function(require,module,exports){
!function(){"use strict";exports.code=require("./code"),exports.keyword=require("./keyword")}();

},{"./code":291,"./keyword":292}],294:[function(require,module,exports){
exports.SourceMapGenerator=require("./source-map/source-map-generator").SourceMapGenerator,exports.SourceMapConsumer=require("./source-map/source-map-consumer").SourceMapConsumer,exports.SourceNode=require("./source-map/source-node").SourceNode;

},{"./source-map/source-map-consumer":295,"./source-map/source-map-generator":296,"./source-map/source-node":297}],295:[function(require,module,exports){
if("function"!=typeof define)var define=require("amdefine")(module,require);define(function(e,n,r){function t(e){var n=e;"string"==typeof e&&(n=JSON.parse(e.replace(/^\)\]\}'/,"")));var r=i.getArg(n,"version"),t=i.getArg(n,"sources"),o=i.getArg(n,"names",[]),s=i.getArg(n,"sourceRoot",null),l=i.getArg(n,"sourcesContent",null),u=i.getArg(n,"mappings"),g=i.getArg(n,"file",null);if(r!=this._version)throw new Error("Unsupported version: "+r);t=t.map(i.normalize),this._names=a.fromArray(o,!0),this._sources=a.fromArray(t,!0),this.sourceRoot=s,this.sourcesContent=l,this._mappings=u,this.file=g}var i=e("./util"),o=e("./binary-search"),a=e("./array-set").ArraySet,s=e("./base64-vlq");t.fromSourceMap=function(e){var n=Object.create(t.prototype);return n._names=a.fromArray(e._names.toArray(),!0),n._sources=a.fromArray(e._sources.toArray(),!0),n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n.__generatedMappings=e._mappings.toArray().slice(),n.__originalMappings=e._mappings.toArray().slice().sort(i.compareByOriginalPositions),n},t.prototype._version=3,Object.defineProperty(t.prototype,"sources",{get:function(){return this._sources.toArray().map(function(e){return null!=this.sourceRoot?i.join(this.sourceRoot,e):e},this)}}),t.prototype.__generatedMappings=null,Object.defineProperty(t.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__generatedMappings}}),t.prototype.__originalMappings=null,Object.defineProperty(t.prototype,"_originalMappings",{get:function(){return this.__originalMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__originalMappings}}),t.prototype._nextCharIsMappingSeparator=function(e){var n=e.charAt(0);return";"===n||","===n},t.prototype._parseMappings=function(e,n){for(var r,t=1,o=0,a=0,l=0,u=0,g=0,p=e,c={};p.length>0;)if(";"===p.charAt(0))t++,p=p.slice(1),o=0;else if(","===p.charAt(0))p=p.slice(1);else{if(r={},r.generatedLine=t,s.decode(p,c),r.generatedColumn=o+c.value,o=r.generatedColumn,(p=c.rest).length>0&&!this._nextCharIsMappingSeparator(p)){if(s.decode(p,c),r.source=this._sources.at(u+c.value),u+=c.value,0===(p=c.rest).length||this._nextCharIsMappingSeparator(p))throw new Error("Found a source, but no line and column");if(s.decode(p,c),r.originalLine=a+c.value,a=r.originalLine,r.originalLine+=1,0===(p=c.rest).length||this._nextCharIsMappingSeparator(p))throw new Error("Found a source and line, but no column");s.decode(p,c),r.originalColumn=l+c.value,l=r.originalColumn,(p=c.rest).length>0&&!this._nextCharIsMappingSeparator(p)&&(s.decode(p,c),r.name=this._names.at(g+c.value),g+=c.value,p=c.rest)}this.__generatedMappings.push(r),"number"==typeof r.originalLine&&this.__originalMappings.push(r)}this.__generatedMappings.sort(i.compareByGeneratedPositions),this.__originalMappings.sort(i.compareByOriginalPositions)},t.prototype._findMapping=function(e,n,r,t,i){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[t]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[t]);return o.search(e,n,i)},t.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var n=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(n.generatedLine===r.generatedLine){n.lastGeneratedColumn=r.generatedColumn-1;continue}}n.lastGeneratedColumn=1/0}},t.prototype.originalPositionFor=function(e){var n={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},r=this._findMapping(n,this._generatedMappings,"generatedLine","generatedColumn",i.compareByGeneratedPositions);if(r>=0){var t=this._generatedMappings[r];if(t.generatedLine===n.generatedLine){var o=i.getArg(t,"source",null);return null!=o&&null!=this.sourceRoot&&(o=i.join(this.sourceRoot,o)),{source:o,line:i.getArg(t,"originalLine",null),column:i.getArg(t,"originalColumn",null),name:i.getArg(t,"name",null)}}}return{source:null,line:null,column:null,name:null}},t.prototype.sourceContentFor=function(e){if(!this.sourcesContent)return null;if(null!=this.sourceRoot&&(e=i.relative(this.sourceRoot,e)),this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];var n;if(null!=this.sourceRoot&&(n=i.urlParse(this.sourceRoot))){var r=e.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(r))return this.sourcesContent[this._sources.indexOf(r)];if((!n.path||"/"==n.path)&&this._sources.has("/"+e))return this.sourcesContent[this._sources.indexOf("/"+e)]}throw new Error('"'+e+'" is not in the SourceMap.')},t.prototype.generatedPositionFor=function(e){var n={source:i.getArg(e,"source"),originalLine:i.getArg(e,"line"),originalColumn:i.getArg(e,"column")};null!=this.sourceRoot&&(n.source=i.relative(this.sourceRoot,n.source));var r=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions);if(r>=0){var t=this._originalMappings[r];return{line:i.getArg(t,"generatedLine",null),column:i.getArg(t,"generatedColumn",null),lastColumn:i.getArg(t,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},t.prototype.allGeneratedPositionsFor=function(e){var n={source:i.getArg(e,"source"),originalLine:i.getArg(e,"line"),originalColumn:1/0};null!=this.sourceRoot&&(n.source=i.relative(this.sourceRoot,n.source));var r=[],t=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions);if(t>=0)for(var o=this._originalMappings[t];o&&o.originalLine===n.originalLine;)r.push({line:i.getArg(o,"generatedLine",null),column:i.getArg(o,"generatedColumn",null),lastColumn:i.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[--t];return r.reverse()},t.GENERATED_ORDER=1,t.ORIGINAL_ORDER=2,t.prototype.eachMapping=function(e,n,r){var o,a=n||null;switch(r||t.GENERATED_ORDER){case t.GENERATED_ORDER:o=this._generatedMappings;break;case t.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var s=this.sourceRoot;o.map(function(e){var n=e.source;return null!=n&&null!=s&&(n=i.join(s,n)),{source:n,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:e.name}}).forEach(e,a)},n.SourceMapConsumer=t});

},{"amdefine":298}],296:[function(require,module,exports){
if("function"!=typeof define)var define=require("amdefine")(module,require);define(function(e,n,o){function t(e){e||(e={}),this._file=r.getArg(e,"file",null),this._sourceRoot=r.getArg(e,"sourceRoot",null),this._skipValidation=r.getArg(e,"skipValidation",!1),this._sources=new s,this._names=new s,this._mappings=new l,this._sourcesContents=null}var i=e("./base64-vlq"),r=e("./util"),s=e("./array-set").ArraySet,l=e("./mapping-list").MappingList;t.prototype._version=3,t.fromSourceMap=function(e){var n=e.sourceRoot,o=new t({file:e.file,sourceRoot:n});return e.eachMapping(function(e){var t={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(t.source=e.source,null!=n&&(t.source=r.relative(n,t.source)),t.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(t.name=e.name)),o.addMapping(t)}),e.sources.forEach(function(n){var t=e.sourceContentFor(n);null!=t&&o.setSourceContent(n,t)}),o},t.prototype.addMapping=function(e){var n=r.getArg(e,"generated"),o=r.getArg(e,"original",null),t=r.getArg(e,"source",null),i=r.getArg(e,"name",null);this._skipValidation||this._validateMapping(n,o,t,i),null==t||this._sources.has(t)||this._sources.add(t),null==i||this._names.has(i)||this._names.add(i),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:null!=o&&o.line,originalColumn:null!=o&&o.column,source:t,name:i})},t.prototype.setSourceContent=function(e,n){var o=e;null!=this._sourceRoot&&(o=r.relative(this._sourceRoot,o)),null!=n?(this._sourcesContents||(this._sourcesContents={}),this._sourcesContents[r.toSetString(o)]=n):this._sourcesContents&&(delete this._sourcesContents[r.toSetString(o)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},t.prototype.applySourceMap=function(e,n,o){var t=n;if(null==n){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');t=e.file}var i=this._sourceRoot;null!=i&&(t=r.relative(i,t));var l=new s,u=new s;this._mappings.unsortedForEach(function(n){if(n.source===t&&null!=n.originalLine){var s=e.originalPositionFor({line:n.originalLine,column:n.originalColumn});null!=s.source&&(n.source=s.source,null!=o&&(n.source=r.join(o,n.source)),null!=i&&(n.source=r.relative(i,n.source)),n.originalLine=s.line,n.originalColumn=s.column,null!=s.name&&(n.name=s.name))}var a=n.source;null==a||l.has(a)||l.add(a);var c=n.name;null==c||u.has(c)||u.add(c)},this),this._sources=l,this._names=u,e.sources.forEach(function(n){var t=e.sourceContentFor(n);null!=t&&(null!=o&&(n=r.join(o,n)),null!=i&&(n=r.relative(i,n)),this.setSourceContent(n,t))},this)},t.prototype._validateMapping=function(e,n,o,t){if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||n||o||t)&&!(e&&"line"in e&&"column"in e&&n&&"line"in n&&"column"in n&&e.line>0&&e.column>=0&&n.line>0&&n.column>=0&&o))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:o,original:n,name:t}))},t.prototype._serializeMappings=function(){for(var e,n=0,o=1,t=0,s=0,l=0,u=0,a="",c=this._mappings.toArray(),p=0,g=c.length;p<g;p++){if((e=c[p]).generatedLine!==o)for(n=0;e.generatedLine!==o;)a+=";",o++;else if(p>0){if(!r.compareByGeneratedPositions(e,c[p-1]))continue;a+=","}a+=i.encode(e.generatedColumn-n),n=e.generatedColumn,null!=e.source&&(a+=i.encode(this._sources.indexOf(e.source)-u),u=this._sources.indexOf(e.source),a+=i.encode(e.originalLine-1-s),s=e.originalLine-1,a+=i.encode(e.originalColumn-t),t=e.originalColumn,null!=e.name&&(a+=i.encode(this._names.indexOf(e.name)-l),l=this._names.indexOf(e.name)))}return a},t.prototype._generateSourcesContent=function(e,n){return e.map(function(e){if(!this._sourcesContents)return null;null!=n&&(e=r.relative(n,e));var o=r.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,o)?this._sourcesContents[o]:null},this)},t.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},t.prototype.toString=function(){return JSON.stringify(this)},n.SourceMapGenerator=t});

},{"amdefine":298}],297:[function(require,module,exports){
if("function"!=typeof define)var define=require("amdefine")(module,require);define(function(n,e,t){function r(n,e,t,r,o){this.children=[],this.sourceContents={},this.line=null==n?null:n,this.column=null==e?null:e,this.source=null==t?null:t,this.name=null==o?null:o,this[u]=!0,null!=r&&this.add(r)}var o=n("./source-map-generator").SourceMapGenerator,i=n("./util"),l=/(\r?\n)/,u="$$$isSourceNode$$$";r.fromStringWithSourceMap=function(n,e,t){function o(n,e){if(null===n||void 0===n.source)u.add(e);else{var o=t?i.join(t,n.source):n.source;u.add(new r(n.originalLine,n.originalColumn,o,e,n.name))}}var u=new r,s=n.split(l),c=function(){return s.shift()+(s.shift()||"")},a=1,h=0,d=null;return e.eachMapping(function(n){if(null!==d){if(!(a<n.generatedLine)){e=(t=s[0]).substr(0,n.generatedColumn-h);return s[0]=t.substr(n.generatedColumn-h),h=n.generatedColumn,o(d,e),void(d=n)}var e="";o(d,c()),a++,h=0}for(;a<n.generatedLine;)u.add(c()),a++;if(h<n.generatedColumn){var t=s[0];u.add(t.substr(0,n.generatedColumn)),s[0]=t.substr(n.generatedColumn),h=n.generatedColumn}d=n},this),s.length>0&&(d&&o(d,c()),u.add(s.join(""))),e.sources.forEach(function(n){var r=e.sourceContentFor(n);null!=r&&(null!=t&&(n=i.join(t,n)),u.setSourceContent(n,r))}),u},r.prototype.add=function(n){if(Array.isArray(n))n.forEach(function(n){this.add(n)},this);else{if(!n[u]&&"string"!=typeof n)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+n);n&&this.children.push(n)}return this},r.prototype.prepend=function(n){if(Array.isArray(n))for(var e=n.length-1;e>=0;e--)this.prepend(n[e]);else{if(!n[u]&&"string"!=typeof n)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+n);this.children.unshift(n)}return this},r.prototype.walk=function(n){for(var e,t=0,r=this.children.length;t<r;t++)(e=this.children[t])[u]?e.walk(n):""!==e&&n(e,{source:this.source,line:this.line,column:this.column,name:this.name})},r.prototype.join=function(n){var e,t,r=this.children.length;if(r>0){for(e=[],t=0;t<r-1;t++)e.push(this.children[t]),e.push(n);e.push(this.children[t]),this.children=e}return this},r.prototype.replaceRight=function(n,e){var t=this.children[this.children.length-1];return t[u]?t.replaceRight(n,e):"string"==typeof t?this.children[this.children.length-1]=t.replace(n,e):this.children.push("".replace(n,e)),this},r.prototype.setSourceContent=function(n,e){this.sourceContents[i.toSetString(n)]=e},r.prototype.walkSourceContents=function(n){for(var e=0,t=this.children.length;e<t;e++)this.children[e][u]&&this.children[e].walkSourceContents(n);var r=Object.keys(this.sourceContents);for(e=0,t=r.length;e<t;e++)n(i.fromSetString(r[e]),this.sourceContents[r[e]])},r.prototype.toString=function(){var n="";return this.walk(function(e){n+=e}),n},r.prototype.toStringWithSourceMap=function(n){var e={code:"",line:1,column:0},t=new o(n),r=!1,i=null,l=null,u=null,s=null;return this.walk(function(n,o){e.code+=n,null!==o.source&&null!==o.line&&null!==o.column?(i===o.source&&l===o.line&&u===o.column&&s===o.name||t.addMapping({source:o.source,original:{line:o.line,column:o.column},generated:{line:e.line,column:e.column},name:o.name}),i=o.source,l=o.line,u=o.column,s=o.name,r=!0):r&&(t.addMapping({generated:{line:e.line,column:e.column}}),i=null,r=!1);for(var c=0,a=n.length;c<a;c++)10===n.charCodeAt(c)?(e.line++,e.column=0,c+1===a?(i=null,r=!1):r&&t.addMapping({source:o.source,original:{line:o.line,column:o.column},generated:{line:e.line,column:e.column},name:o.name})):e.column++}),this.walkSourceContents(function(n,e){t.setSourceContent(n,e)}),{code:e.code,map:t}},e.SourceNode=r});

},{"amdefine":298}],298:[function(require,module,exports){
(function (process,__filename){
"use strict";function amdefine(r,n){function e(r,n){var e;return r&&"."===r.charAt(0)&&n&&(function(r){var n,e;for(n=0;r[n];n+=1)if("."===(e=r[n]))r.splice(n,1),n-=1;else if(".."===e){if(1===n&&(".."===r[2]||".."===r[0]))break;n>0&&(r.splice(n-1,2),n-=2)}}(e=(e=(e=n.split("/")).slice(0,e.length-1)).concat(r.split("/"))),r=e.join("/")),r}function t(e,t,i){var u,f,c,p;if(e)f=a[e]={},c={id:e,uri:__filename,exports:f},u=o(n,f,c,e);else{if(l)throw new Error("amdefine with no module ID cannot be called more than once per file.");l=!0,f=r.exports,u=o(n,f,c=r,r.id)}t&&(t=t.map(function(r){return u(r)})),void 0!==(p="function"==typeof i?i.apply(c.exports,t):i)&&(c.exports=p,e&&(a[e]=c.exports))}function i(r,n,e){Array.isArray(r)?(e=n,n=r,r=void 0):"string"!=typeof r&&(e=r,r=n=void 0),n&&!Array.isArray(n)&&(e=n,n=void 0),n||(n=["require","exports","module"]),r?f[r]=[r,n,e]:t(r,n,e)}var o,u,f={},a={},l=!1,c=require("path");return o=function(r,n,t,i){function o(e,o){if("string"==typeof e)return u(r,n,t,e,i);e=e.map(function(e){return u(r,n,t,e,i)}),o&&process.nextTick(function(){o.apply(null,e)})}return o.toUrl=function(r){return 0===r.indexOf(".")?e(r,c.dirname(t.filename)):r},o},n=n||function(){return r.require.apply(r,arguments)},u=function(r,n,i,l,c){var p,s,d=l.indexOf("!"),m=l;if(-1===d){if("require"===(l=e(l,c)))return o(r,n,i,c);if("exports"===l)return n;if("module"===l)return i;if(a.hasOwnProperty(l))return a[l];if(f[l])return t.apply(null,f[l]),a[l];if(r)return r(m);throw new Error("No module with ID: "+l)}return p=l.substring(0,d),l=l.substring(d+1,l.length),s=u(r,n,i,p,c),l=s.normalize?s.normalize(l,function(r){return function(n){return e(n,r)}}(c)):e(l,c),a[l]?a[l]:(s.load(l,o(r,n,i,c),function(r){function n(n){a[r]=n}return n.fromText=function(r,n){throw new Error("amdefine does not implement load.fromText")},n}(l),{}),a[l])},i.require=function(r){return a[r]?a[r]:f[r]?(t.apply(null,f[r]),a[r]):void 0},i.amd={},i}module.exports=amdefine;

}).call(this,require('_process'),"/node_modules/browserify-shim/node_modules/rename-function-calls/node_modules/detective/node_modules/escodegen/node_modules/source-map/node_modules/amdefine/amdefine.js")

},{"_process":313,"path":312}],299:[function(require,module,exports){
module.exports={
  "name": "escodegen",
  "description": "ECMAScript code generator",
  "homepage": "http://github.com/Constellation/escodegen",
  "main": "escodegen.js",
  "bin": {
    "esgenerate": "./bin/esgenerate.js",
    "escodegen": "./bin/escodegen.js"
  },
  "version": "1.1.0",
  "engines": {
    "node": ">=0.4.0"
  },
  "maintainers": [
    {
      "name": "constellation",
      "email": "utatane.tea@gmail.com"
    }
  ],
  "repository": {
    "type": "git",
    "url": "git+ssh://git@github.com/Constellation/escodegen.git"
  },
  "dependencies": {
    "esprima": "~1.0.4",
    "estraverse": "~1.5.0",
    "esutils": "~1.0.0",
    "source-map": "~0.1.30"
  },
  "optionalDependencies": {
    "source-map": "~0.1.30"
  },
  "devDependencies": {
    "esprima-moz": "*",
    "commonjs-everywhere": "~0.8.0",
    "q": "*",
    "bower": "*",
    "semver": "*",
    "chai": "~1.7.2",
    "grunt-contrib-jshint": "~0.5.0",
    "grunt-cli": "~0.1.9",
    "grunt": "~0.4.1",
    "grunt-mocha-test": "~0.6.2"
  },
  "licenses": [
    {
      "type": "BSD",
      "url": "http://github.com/Constellation/escodegen/raw/master/LICENSE.BSD"
    }
  ],
  "scripts": {
    "test": "grunt travis",
    "unit-test": "grunt test",
    "lint": "grunt lint",
    "release": "node tools/release.js",
    "build-min": "cjsify -ma path: tools/entry-point.js > escodegen.browser.min.js",
    "build": "cjsify -a path: tools/entry-point.js > escodegen.browser.js"
  },
  "bugs": {
    "url": "https://github.com/Constellation/escodegen/issues"
  },
  "_id": "escodegen@1.1.0",
  "dist": {
    "shasum": "c663923f6e20aad48d0c0fa49f31c6d4f49360cf",
    "tarball": "http://registry.npmjs.org/escodegen/-/escodegen-1.1.0.tgz"
  },
  "_from": "escodegen@>=1.1.0 <1.2.0",
  "_npmVersion": "1.3.21",
  "_npmUser": {
    "name": "constellation",
    "email": "utatane.tea@gmail.com"
  },
  "directories": {},
  "_shasum": "c663923f6e20aad48d0c0fa49f31c6d4f49360cf",
  "_resolved": "https://registry.npmjs.org/escodegen/-/escodegen-1.1.0.tgz",
  "readme": "ERROR: No README data found!"
}

},{}],300:[function(require,module,exports){
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["exports"],t):t("undefined"!=typeof exports?exports:e.esprima={})}(this,function(e){"use strict";function t(e,t){if(!e)throw new Error("ASSERT: "+t)}function r(e){return e>=48&&e<=57}function n(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function a(e){return"01234567".indexOf(e)>=0}function i(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&" ᠎             　\ufeff".indexOf(String.fromCharCode(e))>0}function o(e){return 10===e||13===e||8232===e||8233===e}function s(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&wt.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function l(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&wt.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function c(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function u(e){return"eval"===e||"arguments"===e}function p(){var e,t,r;for(t=!1,r=!1;Xt<Nt;)if(e=Pt.charCodeAt(Xt),r)++Xt,o(e)&&(r=!1,13===e&&10===Pt.charCodeAt(Xt)&&++Xt,++Jt,Dt=Xt);else if(t)o(e)?(13===e&&10===Pt.charCodeAt(Xt+1)&&++Xt,++Jt,Dt=++Xt,Xt>=Nt&&w({},At.UnexpectedToken,"ILLEGAL")):(e=Pt.charCodeAt(Xt++),Xt>=Nt&&w({},At.UnexpectedToken,"ILLEGAL"),42===e&&47===(e=Pt.charCodeAt(Xt))&&(++Xt,t=!1));else if(47===e)if(47===(e=Pt.charCodeAt(Xt+1)))Xt+=2,r=!0;else{if(42!==e)break;t=!0,(Xt+=2)>=Nt&&w({},At.UnexpectedToken,"ILLEGAL")}else if(i(e))++Xt;else{if(!o(e))break;++Xt,13===e&&10===Pt.charCodeAt(Xt)&&++Xt,++Jt,Dt=Xt}}function d(e){var t,r,a,i=0;for(r="u"===e?4:2,t=0;t<r;++t){if(!(Xt<Nt&&n(Pt[Xt])))return"";a=Pt[Xt++],i=16*i+"0123456789abcdef".indexOf(a.toLowerCase())}return String.fromCharCode(i)}function f(){var e,t,r,a;for(t=0,"}"===(e=Pt[Xt])&&w({},At.UnexpectedToken,"ILLEGAL");Xt<Nt&&(e=Pt[Xt++],n(e));)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&w({},At.UnexpectedToken,"ILLEGAL"),t<=65535?String.fromCharCode(t):(r=55296+(t-65536>>10),a=56320+(t-65536&1023),String.fromCharCode(r,a))}function m(){var e,t;for(e=Pt.charCodeAt(Xt++),t=String.fromCharCode(e),92===e&&(117!==Pt.charCodeAt(Xt)&&w({},At.UnexpectedToken,"ILLEGAL"),++Xt,(e=d("u"))&&"\\"!==e&&s(e.charCodeAt(0))||w({},At.UnexpectedToken,"ILLEGAL"),t=e);Xt<Nt&&(e=Pt.charCodeAt(Xt),l(e));)++Xt,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==Pt.charCodeAt(Xt)&&w({},At.UnexpectedToken,"ILLEGAL"),++Xt,(e=d("u"))&&"\\"!==e&&l(e.charCodeAt(0))||w({},At.UnexpectedToken,"ILLEGAL"),t+=e);return t}function y(){var e,t,r;return e=Xt,t=92===Pt.charCodeAt(Xt)?m():function(){var e,t;for(e=Xt++;Xt<Nt;){if(92===(t=Pt.charCodeAt(Xt)))return Xt=e,m();if(!l(t))break;++Xt}return Pt.slice(e,Xt)}(),r=1===t.length?Et.Identifier:function(e){if(Ot&&c(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}(t)?Et.Keyword:"null"===t?Et.NullLiteral:"true"===t||"false"===t?Et.BooleanLiteral:Et.Identifier,{type:r,value:t,lineNumber:Jt,lineStart:Dt,range:[e,Xt]}}function g(){var e,t,r,n,a=Xt,i=Pt.charCodeAt(Xt),o=Pt[Xt];switch(i){case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Xt,Rt.tokenize&&(40===i?Rt.openParenToken=Rt.tokens.length:123===i&&(Rt.openCurlyToken=Rt.tokens.length)),{type:Et.Punctuator,value:String.fromCharCode(i),lineNumber:Jt,lineStart:Dt,range:[a,Xt]};default:if(61===(e=Pt.charCodeAt(Xt+1)))switch(i){case 37:case 38:case 42:case 43:case 45:case 47:case 60:case 62:case 94:case 124:return Xt+=2,{type:Et.Punctuator,value:String.fromCharCode(i)+String.fromCharCode(e),lineNumber:Jt,lineStart:Dt,range:[a,Xt]};case 33:case 61:return Xt+=2,61===Pt.charCodeAt(Xt)&&++Xt,{type:Et.Punctuator,value:Pt.slice(a,Xt),lineNumber:Jt,lineStart:Dt,range:[a,Xt]}}}return t=Pt[Xt+1],r=Pt[Xt+2],n=Pt[Xt+3],">"===o&&">"===t&&">"===r&&"="===n?(Xt+=4,{type:Et.Punctuator,value:">>>=",lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):">"===o&&">"===t&&">"===r?(Xt+=3,{type:Et.Punctuator,value:">>>",lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):"<"===o&&"<"===t&&"="===r?(Xt+=3,{type:Et.Punctuator,value:"<<=",lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):">"===o&&">"===t&&"="===r?(Xt+=3,{type:Et.Punctuator,value:">>=",lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):"."===o&&"."===t&&"."===r?(Xt+=3,{type:Et.Punctuator,value:"...",lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):o===t&&"+-<>&|".indexOf(o)>=0?(Xt+=2,{type:Et.Punctuator,value:o+t,lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):"="===o&&">"===t?(Xt+=2,{type:Et.Punctuator,value:"=>",lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):"<>=!+-*%&|^/".indexOf(o)>=0?(++Xt,{type:Et.Punctuator,value:o,lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):"."===o?(++Xt,{type:Et.Punctuator,value:o,lineNumber:Jt,lineStart:Dt,range:[a,Xt]}):void w({},At.UnexpectedToken,"ILLEGAL")}function S(){var e,i,o;if(o=Pt[Xt],t(r(o.charCodeAt(0))||"."===o,"Numeric literal must start with a decimal digit or a decimal point"),i=Xt,e="","."!==o){if(e=Pt[Xt++],o=Pt[Xt],"0"===e){if("x"===o||"X"===o)return++Xt,function(e){for(var t="";Xt<Nt&&n(Pt[Xt]);)t+=Pt[Xt++];return 0===t.length&&w({},At.UnexpectedToken,"ILLEGAL"),s(Pt.charCodeAt(Xt))&&w({},At.UnexpectedToken,"ILLEGAL"),{type:Et.NumericLiteral,value:parseInt("0x"+t,16),lineNumber:Jt,lineStart:Dt,range:[e,Xt]}}(i);if("b"===o||"B"===o){for(++Xt,e="";Xt<Nt&&("0"===(o=Pt[Xt])||"1"===o);)e+=Pt[Xt++];return 0===e.length&&w({},At.UnexpectedToken,"ILLEGAL"),Xt<Nt&&(s(o=Pt.charCodeAt(Xt))||r(o))&&w({},At.UnexpectedToken,"ILLEGAL"),{type:Et.NumericLiteral,value:parseInt(e,2),lineNumber:Jt,lineStart:Dt,range:[i,Xt]}}if("o"===o||"O"===o||a(o))return function(e,t){var n,i;for(a(e)?(i=!0,n="0"+Pt[Xt++]):(i=!1,++Xt,n="");Xt<Nt&&a(Pt[Xt]);)n+=Pt[Xt++];return i||0!==n.length||w({},At.UnexpectedToken,"ILLEGAL"),(s(Pt.charCodeAt(Xt))||r(Pt.charCodeAt(Xt)))&&w({},At.UnexpectedToken,"ILLEGAL"),{type:Et.NumericLiteral,value:parseInt(n,8),octal:i,lineNumber:Jt,lineStart:Dt,range:[t,Xt]}}(o,i);o&&r(o.charCodeAt(0))&&w({},At.UnexpectedToken,"ILLEGAL")}for(;r(Pt.charCodeAt(Xt));)e+=Pt[Xt++];o=Pt[Xt]}if("."===o){for(e+=Pt[Xt++];r(Pt.charCodeAt(Xt));)e+=Pt[Xt++];o=Pt[Xt]}if("e"===o||"E"===o)if(e+=Pt[Xt++],"+"!==(o=Pt[Xt])&&"-"!==o||(e+=Pt[Xt++]),r(Pt.charCodeAt(Xt)))for(;r(Pt.charCodeAt(Xt));)e+=Pt[Xt++];else w({},At.UnexpectedToken,"ILLEGAL");return s(Pt.charCodeAt(Xt))&&w({},At.UnexpectedToken,"ILLEGAL"),{type:Et.NumericLiteral,value:parseFloat(e),lineNumber:Jt,lineStart:Dt,range:[i,Xt]}}function h(){var e,t,r,n,i,s,l,c,u="";for(r=!1,n=!1,t=Xt,++Xt;Xt<Nt;){if("`"===(e=Pt[Xt++])){n=!0,r=!0;break}if("$"===e){if("{"===Pt[Xt]){++Xt,r=!0;break}u+=e}else if("\\"===e)if(e=Pt[Xt++],o(e.charCodeAt(0)))++Jt,"\r"===e&&"\n"===Pt[Xt]&&++Xt;else switch(e){case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"u":case"x":"{"===Pt[Xt]?(++Xt,u+=f()):(i=Xt,(s=d(e))?u+=s:(Xt=i,u+=e));break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\v";break;default:a(e)?(0!==(l="01234567".indexOf(e))&&(c=!0),Xt<Nt&&a(Pt[Xt])&&(c=!0,l=8*l+"01234567".indexOf(Pt[Xt++]),"0123".indexOf(e)>=0&&Xt<Nt&&a(Pt[Xt])&&(l=8*l+"01234567".indexOf(Pt[Xt++]))),u+=String.fromCharCode(l)):u+=e}else o(e.charCodeAt(0))?(++Jt,"\r"===e&&"\n"===Pt[Xt]&&++Xt,u+="\n"):u+=e}return r||w({},At.UnexpectedToken,"ILLEGAL"),{type:Et.Template,value:{cooked:u,raw:Pt.slice(t+1,Xt-(n?1:2))},tail:n,octal:c,lineNumber:Jt,lineStart:Dt,range:[t,Xt]}}function v(){var e,r,n,a,i,s,c,u=!1,f=!1;for(Ut=null,p(),n=Xt,t("/"===(r=Pt[Xt]),"Regular expression literal must start with a slash"),e=Pt[Xt++];Xt<Nt;)if(r=Pt[Xt++],e+=r,u)"]"===r&&(u=!1);else if("\\"===r)o((r=Pt[Xt++]).charCodeAt(0))&&w({},At.UnterminatedRegExp),e+=r;else{if("/"===r){f=!0;break}"["===r?u=!0:o(r.charCodeAt(0))&&w({},At.UnterminatedRegExp)}for(f||w({},At.UnterminatedRegExp),a=e.substr(1,e.length-2),i="";Xt<Nt&&(r=Pt[Xt],l(r.charCodeAt(0)));)if(++Xt,"\\"===r&&Xt<Nt)if("u"===(r=Pt[Xt]))if(++Xt,c=Xt,r=d("u"))for(i+=r,e+="\\u";c<Xt;++c)e+=Pt[c];else Xt=c,i+="u",e+="\\u";else e+="\\";else i+=r,e+=r;try{s=new RegExp(a,i)}catch(e){w({},At.InvalidRegExp)}return C(),Rt.tokenize?{type:Et.RegularExpression,value:s,lineNumber:Jt,lineStart:Dt,range:[n,Xt]}:{literal:e,value:s,range:[n,Xt]}}function E(e){return e.type===Et.Identifier||e.type===Et.Keyword||e.type===Et.BooleanLiteral||e.type===Et.NullLiteral}function x(){var e;return Bt.inXJSChild||p(),Xt>=Nt?{type:Et.EOF,lineNumber:Jt,lineStart:Dt,range:[Xt,Xt]}:Bt.inXJSChild?function(){var e=Pt.charCodeAt(Xt);if(123!==e&&60!==e)return Qe(["<","{"]);return g()}():40===(e=Pt.charCodeAt(Xt))||41===e||58===e?g():39===e||34===e?Bt.inXJSTag?function(){var e,r,n;r=Pt[Xt],t("'"===r||'"'===r,"String literal must starts with a quote"),n=Xt,++Xt,e=Qe([r]),r!==Pt[Xt]&&w({},At.UnexpectedToken,"ILLEGAL");return++Xt,e.range=[n,Xt],e}():function(){var e,r,n,i,s,l,c="",u=!1;for(t("'"===(e=Pt[Xt])||'"'===e,"String literal must starts with a quote"),r=Xt,++Xt;Xt<Nt;){if((n=Pt[Xt++])===e){e="";break}if("\\"===n)if((n=Pt[Xt++])&&o(n.charCodeAt(0)))++Jt,"\r"===n&&"\n"===Pt[Xt]&&++Xt;else switch(n){case"n":c+="\n";break;case"r":c+="\r";break;case"t":c+="\t";break;case"u":case"x":"{"===Pt[Xt]?(++Xt,c+=f()):(l=Xt,(s=d(n))?c+=s:(Xt=l,c+=n));break;case"b":c+="\b";break;case"f":c+="\f";break;case"v":c+="\v";break;default:a(n)?(0!==(i="01234567".indexOf(n))&&(u=!0),Xt<Nt&&a(Pt[Xt])&&(u=!0,i=8*i+"01234567".indexOf(Pt[Xt++]),"0123".indexOf(n)>=0&&Xt<Nt&&a(Pt[Xt])&&(i=8*i+"01234567".indexOf(Pt[Xt++]))),c+=String.fromCharCode(i)):c+=n}else{if(o(n.charCodeAt(0)))break;c+=n}}return""!==e&&w({},At.UnexpectedToken,"ILLEGAL"),{type:Et.StringLiteral,value:c,octal:u,lineNumber:Jt,lineStart:Dt,range:[r,Xt]}}():Bt.inXJSTag&&function(e){return 92!==e&&s(e)}(e)?function(){var e,t,r,n="";t=Xt;for(;Xt<Nt&&(e=Pt.charCodeAt(Xt),$e(e));)n+=Pt[Xt++];if(58===e)for(++Xt,r=n,n="";Xt<Nt&&(e=Pt.charCodeAt(Xt),$e(e));)n+=Pt[Xt++];n||w({},At.InvalidXJSTagName);return{type:Et.XJSIdentifier,value:n,namespace:r,lineNumber:Jt,lineStart:Dt,range:[t,Xt]}}():96===e?h():s(e)?y():46===e?r(Pt.charCodeAt(Xt+1))?S():g():r(e)?S():Rt.tokenize&&47===e?function(){var e,t;if(!(e=Rt.tokens[Rt.tokens.length-1]))return v();if("Punctuator"===e.type){if(")"===e.value)return!(t=Rt.tokens[Rt.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?g():v();if("}"===e.value){if(Rt.tokens[Rt.openCurlyToken-3]&&"Keyword"===Rt.tokens[Rt.openCurlyToken-3].type){if(!(t=Rt.tokens[Rt.openCurlyToken-4]))return g()}else{if(!Rt.tokens[Rt.openCurlyToken-4]||"Keyword"!==Rt.tokens[Rt.openCurlyToken-4].type)return g();if(!(t=Rt.tokens[Rt.openCurlyToken-5]))return v()}return bt.indexOf(t.value)>=0?g():v()}return v()}return"Keyword"===e.type?v():g()}():g()}function b(){var e;return e=Ut,Xt=e.range[1],Jt=e.lineNumber,Dt=e.lineStart,Ut=x(),Xt=e.range[1],Jt=e.lineNumber,Dt=e.lineStart,e}function C(){var e,t,r;e=Xt,t=Jt,r=Dt,Ut=x(),Xt=e,Jt=t,Dt=r}function I(){var e,t,r,n,a;return e="function"==typeof Rt.advance?Rt.advance:x,t=Xt,r=Jt,n=Dt,null===Ut&&(Ut=e()),Xt=Ut.range[1],Jt=Ut.lineNumber,Dt=Ut.lineStart,a=e(),Xt=t,Jt=r,Dt=n,a}function A(){var e,t,r,n;return e=Xt,t=Jt,r=Dt,p(),n=Jt!==t,Xt=e,Jt=t,Dt=r,n}function w(e,r){var n,a=Array.prototype.slice.call(arguments,2),i=r.replace(/%(\d)/g,function(e,r){return t(r<a.length,"Message reference must be in range"),a[r]});throw"number"==typeof e.lineNumber?((n=new Error("Line "+e.lineNumber+": "+i)).index=e.range[0],n.lineNumber=e.lineNumber,n.column=e.range[0]-Dt+1):((n=new Error("Line "+Jt+": "+i)).index=Xt,n.lineNumber=Jt,n.column=Xt-Dt+1),n.description=i,n}function L(){try{w.apply(null,arguments)}catch(e){if(!Rt.errors)throw e;Rt.errors.push(e)}}function k(e){if(e.type===Et.EOF&&w(e,At.UnexpectedEOS),e.type===Et.NumericLiteral&&w(e,At.UnexpectedNumber),e.type!==Et.StringLiteral&&e.type!==Et.XJSText||w(e,At.UnexpectedString),e.type===Et.Identifier&&w(e,At.UnexpectedIdentifier),e.type===Et.Keyword){if(function(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}(e.value))w(e,At.UnexpectedReserved);else if(Ot&&c(e.value))return void L(e,At.StrictReservedWord);w(e,At.UnexpectedToken,e.value)}e.type===Et.Template&&w(e,At.UnexpectedTemplate,e.value.raw),w(e,At.UnexpectedToken,e.value)}function T(e){var t=b();t.type===Et.Punctuator&&t.value===e||k(t)}function P(e){var t=b();t.type===Et.Keyword&&t.value===e||k(t)}function O(e){return Ut.type===Et.Punctuator&&Ut.value===e}function X(e){return Ut.type===Et.Keyword&&Ut.value===e}function J(e){return Ut.type===Et.Identifier&&Ut.value===e}function D(){var e;59!==Pt.charCodeAt(Xt)?(e=Jt,p(),Jt===e&&(O(";")?b():Ut.type===Et.EOF||O("}")||k(Ut))):b()}function N(e){return e.type===Ct.Identifier||e.type===Ct.MemberExpression}function F(){var e,t=[],r=[],n=null,a=!0;for(T("[");!O("]");)"for"===Ut.value&&Ut.type===Et.Keyword?(a||w({},At.ComprehensionError),X("for"),(e=Ae({ignoreBody:!0})).of=e.type===Ct.ForOfStatement,e.type=Ct.ComprehensionBlock,e.left.kind&&w({},At.ComprehensionError),r.push(e)):"if"===Ut.value&&Ut.type===Et.Keyword?(a||w({},At.ComprehensionError),P("if"),T("("),n=ue(),T(")")):","===Ut.value&&Ut.type===Et.Punctuator?(a=!1,b(),t.push(null)):(e=H(),t.push(e),e&&e.type===Ct.SpreadElement?O("]")||w({},At.ElementAfterSpreadElement):O("]")||X("for")||X("if")||(T(","),a=!1));return T("]"),n&&!r.length&&w({},At.ComprehensionRequiresBlock),r.length?(1!==t.length&&w({},At.ComprehensionError),{type:Ct.ComprehensionExpression,filter:n,blocks:r,body:t[0]}):Ft.createArrayExpression(t)}function U(e){var t,r,n,a,i;return t=Ot,r=Bt.yieldAllowed,Bt.yieldAllowed=e.generator,n=e.params||[],a=e.defaults||[],i=Te(),e.name&&Ot&&u(n[0].name)&&L(e.name,At.StrictParamName),Bt.yieldAllowed&&!Bt.yieldFound&&L({},At.NoYieldInGenerator),Ot=t,Bt.yieldAllowed=r,Ft.createFunctionExpression(null,n,a,i,e.rest||null,e.generator,i.type!==Ct.BlockStatement,e.returnTypeAnnotation)}function B(e){var t,r,n;return t=Ot,Ot=!0,(r=Je()).stricted&&L(r.stricted,r.message),n=U({params:r.params,defaults:r.defaults,rest:r.rest,generator:e.generator,returnTypeAnnotation:r.returnTypeAnnotation}),Ot=t,n}function R(){var e=b();return e.type===Et.StringLiteral||e.type===Et.NumericLiteral?(Ot&&e.octal&&L(e,At.StrictOctalLiteral),Ft.createLiteral(e)):Ft.createIdentifier(e.value)}function M(){var e,t,r,n;return(e=Ut).type===Et.Identifier?(r=R(),"get"!==e.value||O(":")||O("(")?"set"!==e.value||O(":")||O("(")?O(":")?(b(),Ft.createProperty("init",r,ce(),!1,!1)):O("(")?Ft.createProperty("init",r,B({generator:!1}),!0,!1):Ft.createProperty("init",r,r,!1,!0):(t=R(),T("("),e=Ut,n=[me()],T(")"),Ft.createProperty("set",t,U({params:n,generator:!1,name:e}),!1,!1)):(t=R(),T("("),T(")"),Ft.createProperty("get",t,U({generator:!1}),!1,!1))):e.type===Et.EOF||e.type===Et.Punctuator?(O("*")||k(e),b(),r=R(),O("(")||k(b()),Ft.createProperty("init",r,B({generator:!0}),!0,!1)):(t=R(),O(":")?(b(),Ft.createProperty("init",t,ce(),!1,!1)):O("(")?Ft.createProperty("init",t,B({generator:!1}),!0,!1):void k(b()))}function j(){var e,t,r,n,a=[],i={},o=String;for(T("{");!O("}");)t=(e=M()).key.type===Ct.Identifier?e.key.name:o(e.key.value),n="init"===e.kind?It.Data:"get"===e.kind?It.Get:It.Set,r="$"+t,Object.prototype.hasOwnProperty.call(i,r)?(i[r]===It.Data?Ot&&n===It.Data?L({},At.StrictDuplicateProperty):n!==It.Data&&L({},At.AccessorDataProperty):n===It.Data?L({},At.AccessorDataProperty):i[r]&n&&L({},At.AccessorGetSet),i[r]|=n):i[r]=n,a.push(e),O("}")||T(",");return T("}"),Ft.createObjectExpression(a)}function G(e){var t=function(e){var t,r;return Ut=null,p(),t=e.head?"`":"}",Pt[Xt]!==t&&w({},At.UnexpectedToken,"ILLEGAL"),r=h(),C(),r}(e);return Ot&&t.octal&&w(t,At.StrictOctalLiteral),Ft.createTemplateElement({raw:t.value.raw,cooked:t.value.cooked},t.tail)}function q(){var e,t,r;for(t=[e=G({head:!0})],r=[];!e.tail;)r.push(ue()),e=G({head:!1}),t.push(e);return Ft.createTemplateLiteral(t,r)}function K(){var e;return T("("),++Bt.parenthesizedCount,e=ue(),T(")"),e}function V(){var e,t;if(t=Ut,(e=Ut.type)===Et.Identifier)return b(),Ft.createIdentifier(t.value);if(e===Et.StringLiteral||e===Et.NumericLiteral)return Ot&&Ut.octal&&L(Ut,At.StrictOctalLiteral),Ft.createLiteral(b());if(e===Et.Keyword){if(X("this"))return b(),Ft.createThisExpression();if(X("function"))return Ne();if(X("class"))return Re();if(X("super"))return b(),Ft.createIdentifier("super")}return e===Et.BooleanLiteral?(t=b(),t.value="true"===t.value,Ft.createLiteral(t)):e===Et.NullLiteral?(t=b(),t.value=null,Ft.createLiteral(t)):O("[")?F():O("{")?j():O("(")?K():O("/")||O("/=")?Ft.createLiteral(v()):e===Et.Template?q():O("<")?st():k(b())}function z(){var e,t=[];if(T("("),!O(")"))for(;Xt<Nt&&(e=H(),t.push(e),!O(")"));)e.type===Ct.SpreadElement&&w({},At.ElementAfterSpreadElement),T(",");return T(")"),t}function H(){return O("...")?(b(),Ft.createSpreadElement(ce())):ce()}function W(){var e=b();return E(e)||k(e),Ft.createIdentifier(e.value)}function Y(){return T("."),W()}function $(){var e;return T("["),e=ue(),T("]"),e}function Z(){var e,t;return P("new"),e=_(),t=O("(")?z():[],Ft.createNewExpression(e,t)}function Q(){var e,t;for(e=X("new")?Z():V();O(".")||O("[")||O("(")||Ut.type===Et.Template;)O("(")?(t=z(),e=Ft.createCallExpression(e,t)):e=O("[")?Ft.createMemberExpression("[",e,$()):O(".")?Ft.createMemberExpression(".",e,Y()):Ft.createTaggedTemplateExpression(e,q());return e}function _(){var e;for(e=X("new")?Z():V();O(".")||O("[")||Ut.type===Et.Template;)e=O("[")?Ft.createMemberExpression("[",e,$()):O(".")?Ft.createMemberExpression(".",e,Y()):Ft.createTaggedTemplateExpression(e,q());return e}function ee(){var e=Q(),t=Ut;return Ut.type!==Et.Punctuator?e:(!O("++")&&!O("--")||A()||(Ot&&e.type===Ct.Identifier&&u(e.name)&&L({},At.StrictLHSPostfix),N(e)||w({},At.InvalidLHSInAssignment),t=b(),e=Ft.createPostfixExpression(t.value,e)),e)}function te(){var e,t;return Ut.type!==Et.Punctuator&&Ut.type!==Et.Keyword?ee():O("++")||O("--")?(e=b(),t=te(),Ot&&t.type===Ct.Identifier&&u(t.name)&&L({},At.StrictLHSPrefix),N(t)||w({},At.InvalidLHSInAssignment),Ft.createUnaryExpression(e.value,t)):O("+")||O("-")||O("~")||O("!")?(e=b(),t=te(),Ft.createUnaryExpression(e.value,t)):X("delete")||X("void")||X("typeof")?(e=b(),t=te(),t=Ft.createUnaryExpression(e.value,t),Ot&&"delete"===t.operator&&t.argument.type===Ct.Identifier&&L({},At.StrictDelete),t):ee()}function re(e,t){var r=0;if(e.type!==Et.Punctuator&&e.type!==Et.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=t?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11}return r}function ne(){var e,t,r,n,a,i,o,s,l;if(n=Bt.allowIn,Bt.allowIn=!0,e=te(),t=Ut,0===(r=re(t,n)))return e;for(t.prec=r,b(),a=[e,t,te()];(r=re(Ut,n))>0;){for(;a.length>2&&r<=a[a.length-2].prec;)i=a.pop(),o=a.pop().value,s=a.pop(),a.push(Ft.createBinaryExpression(o,s,i));(t=b()).prec=r,a.push(t),a.push(te())}for(Bt.allowIn=n,e=a[l=a.length-1];l>1;)e=Ft.createBinaryExpression(a[l-1].value,a[l-2],e),l-=2;return e}function ae(){var e,t,r,n;return e=ne(),O("?")&&(b(),t=Bt.allowIn,Bt.allowIn=!0,r=ce(),Bt.allowIn=t,T(":"),n=ce(),e=Ft.createConditionalExpression(e,r,n)),e}function ie(e){var t,r,n,a;if(e.type===Ct.ObjectExpression)for(e.type=Ct.ObjectPattern,t=0,r=e.properties.length;t<r;t+=1)"init"!==(n=e.properties[t]).kind&&w({},At.InvalidLHSInAssignment),ie(n.value);else if(e.type===Ct.ArrayExpression)for(e.type=Ct.ArrayPattern,t=0,r=e.elements.length;t<r;t+=1)(a=e.elements[t])&&ie(a);else e.type===Ct.Identifier?u(e.name)&&w({},At.InvalidLHSInAssignment):e.type===Ct.SpreadElement?(ie(e.argument),e.argument.type===Ct.ObjectPattern&&w({},At.ObjectPatternAsSpread)):e.type!==Ct.MemberExpression&&e.type!==Ct.CallExpression&&e.type!==Ct.NewExpression&&w({},At.InvalidLHSInAssignment)}function oe(e,t){var r,n,a,i;if(t.type===Ct.ObjectExpression)for(t.type=Ct.ObjectPattern,r=0,n=t.properties.length;r<n;r+=1)"init"!==(a=t.properties[r]).kind&&w({},At.InvalidLHSInFormalsList),oe(e,a.value);else if(t.type===Ct.ArrayExpression)for(t.type=Ct.ArrayPattern,r=0,n=t.elements.length;r<n;r+=1)(i=t.elements[r])&&oe(e,i);else t.type===Ct.Identifier?Oe(e,t,t.name):t.type!==Ct.MemberExpression&&w({},At.InvalidLHSInFormalsList)}function se(e){var r,n,a,i,o,s,l,c;for(i=[],o=[],s=0,c=null,l={paramSet:{}},r=0,n=e.length;r<n;r+=1)if((a=e[r]).type===Ct.Identifier)i.push(a),o.push(null),Oe(l,a,a.name);else if(a.type===Ct.ObjectExpression||a.type===Ct.ArrayExpression)oe(l,a),i.push(a),o.push(null);else if(a.type===Ct.SpreadElement)t(r===n-1,"It is guaranteed that SpreadElement is last element by parseExpression"),oe(l,a.argument),c=a.argument;else{if(a.type!==Ct.AssignmentExpression)return null;i.push(a.left),o.push(a.right),++s,Oe(l,a.left,a.left.name)}return l.message===At.StrictParamDupe&&w(Ot?l.stricted:l.firstRestricted,l.message),0===s&&(o=[]),{params:i,defaults:o,rest:c,stricted:l.stricted,firstRestricted:l.firstRestricted,message:l.message}}function le(e){var t,r,n;return T("=>"),t=Ot,r=Bt.yieldAllowed,Bt.yieldAllowed=!1,n=Te(),Ot&&e.firstRestricted&&w(e.firstRestricted,e.message),Ot&&e.stricted&&L(e.stricted,e.message),Ot=t,Bt.yieldAllowed=r,Ft.createArrowFunctionExpression(e.params,e.defaults,n,e.rest,n.type!==Ct.BlockStatement)}function ce(){var e,t,r,n;return X("yield")?function(){var e,t;P("yield"),Bt.yieldAllowed||L({},At.IllegalYield);e=!1,O("*")&&(b(),e=!0);return t=ce(),Bt.yieldFound=!0,Ft.createYieldExpression(t,e)}():(n=Bt.parenthesizedCount,O("(")&&((t=I()).type===Et.Punctuator&&")"===t.value||"..."===t.value)?(r=Je(),O("=>")||k(b()),le(r)):(t=Ut,e=ae(),O("=>")&&(Bt.parenthesizedCount===n||Bt.parenthesizedCount===n+1)&&(e.type===Ct.Identifier?r=se([e]):e.type===Ct.SequenceExpression&&(r=se(e.expressions)),r)?le(r):(function(){var e;return Ut.type===Et.Punctuator&&("="===(e=Ut.value)||"*="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e)}()&&(Ot&&e.type===Ct.Identifier&&u(e.name)&&L(t,At.StrictLHSAssignment),!O("=")||e.type!==Ct.ObjectExpression&&e.type!==Ct.ArrayExpression?N(e)||w({},At.InvalidLHSInAssignment):ie(e),e=Ft.createAssignmentExpression(b().value,e,ce())),e)))}function ue(){var e,t,r,n,a,i;if(i=Bt.parenthesizedCount,e=ce(),t=[e],O(",")){for(;Xt<Nt&&O(",");)if(b(),e=H(),t.push(e),e.type===Ct.SpreadElement){a=!0,O(")")||w({},At.ElementAfterSpreadElement);break}r=Ft.createSequenceExpression(t)}if(O("=>")){if((Bt.parenthesizedCount===i||Bt.parenthesizedCount===i+1)&&(e=e.type===Ct.SequenceExpression?e.expressions:t,n=se(e)))return le(n);k(b())}return a&&"=>"!==I().value&&w({},At.IllegalSpread),r||e}function pe(){var e;return T("{"),e=function(){for(var e,t=[];Xt<Nt&&!O("}")&&void 0!==(e=Ge());)t.push(e);return t}(),T("}"),Ft.createBlockStatement(e)}function de(e){var t=null,r=null,n=null,a=!1;if(e||T(":"),O("?")&&(b(),a=!0),Ut.type===Et.Identifier&&(t=fe()),O("(")){for(b(),r=[];Ut.type===Et.Identifier||O("?");)r.push(de(!0)),O(")")||T(",");T(")"),T("=>"),X("void")?b():n=de(!0)}return Ft.createTypeAnnotation(t,r,n,a)}function fe(){var e=b();return e.type!==Et.Identifier&&k(e),Ft.createIdentifier(e.value)}function me(){var e=fe();return O(":")?Ft.createTypeAnnotatedIdentifier(e,de()):e}function ye(e){var t,r=null;return O("{")?ie(t=j()):O("[")?ie(t=F()):(t=Bt.allowKeyword?W():me(),Ot&&u(t.name)&&L({},At.StrictVarName)),"const"===e?(O("=")||w({},At.NoUnintializedConst),T("="),r=ce()):O("=")&&(b(),r=ce()),Ft.createVariableDeclarator(t,r)}function ge(e){var t=[];do{if(t.push(ye(e)),!O(","))break;b()}while(Xt<Nt);return t}function Se(e){var t;return P(e),t=ge(e),D(),Ft.createVariableDeclaration(t,e)}function he(){var e,t,r;switch(b(),A()&&w({},At.NewlineAfterModule),Ut.type){case Et.StringLiteral:e=V(),r=Ve(),t=null;break;case Et.Identifier:e=fe(),r=null,J("from")||k(b()),b(),(t=V()).type!==Ct.Literal&&w({},At.InvalidModuleSpecifier)}return D(),Ft.createModuleDeclaration(e,t,r)}function ve(){return T("*"),Ft.createExportBatchSpecifier()}function Ee(){var e,t=null;return e=fe(),J("as")&&(b(),t=W()),Ft.createExportSpecifier(e,t)}function xe(){var e,t,r,n;if(P("export"),Ut.type===Et.Keyword)switch(Ut.value){case"let":case"const":case"var":case"class":case"function":return Ft.createExportDeclaration(Ge(),null,null)}if(E(Ut))return e=Bt.allowKeyword,Bt.allowKeyword=!0,t=ge("let"),Bt.allowKeyword=e,Ft.createExportDeclaration(t,null,null);if(n=[],r=null,O("*"))n.push(ve());else{T("{");do{n.push(Ee())}while(O(",")&&b());T("}")}return J("from")&&(b(),(r=V()).type!==Ct.Literal&&w({},At.InvalidModuleSpecifier)),D(),Ft.createExportDeclaration(null,n,r)}function be(){var e,t,r;if(P("import"),e=[],E(Ut))t="default",e.push(Ce()),J("from")||w({},At.NoFromAfterImport),b();else if(O("{")){t="named",b();do{e.push(Ce())}while(O(",")&&b());T("}"),J("from")||w({},At.NoFromAfterImport),b()}return(r=V()).type!==Ct.Literal&&w({},At.InvalidModuleSpecifier),D(),Ft.createImportDeclaration(e,t,r)}function Ce(){var e,t=null;return e=W(),J("as")&&(b(),t=fe()),Ft.createImportSpecifier(e,t)}function Ie(){var e=b(),t=ge();return Ft.createVariableDeclaration(t,e.value)}function Ae(e){var t,r,n,a,i,o,s,l;return t=r=n=null,P("for"),J("each")&&w({},At.EachNotAllowed),T("("),O(";")?b():(X("var")||X("let")||X("const")?(Bt.allowIn=!1,t=Ie(),Bt.allowIn=!0,1===t.declarations.length&&(X("in")||J("of"))&&("in"!==(s=Ut).value&&"var"===t.kind||!t.declarations[0].init)&&(b(),a=t,i=ue(),t=null)):(Bt.allowIn=!1,t=ue(),Bt.allowIn=!0,J("of")?(s=b(),a=t,i=ue(),t=null):X("in")&&(function(e){return N(e)||e.type===Ct.ObjectPattern||e.type===Ct.ArrayPattern}(t)||w({},At.InvalidLHSInForIn),s=b(),a=t,i=ue(),t=null)),void 0===a&&T(";")),void 0===a&&(O(";")||(r=ue()),T(";"),O(")")||(n=ue())),T(")"),l=Bt.inIteration,Bt.inIteration=!0,void 0!==e&&e.ignoreBody||(o=ke()),Bt.inIteration=l,void 0===a?Ft.createForStatement(t,r,n,o):"in"===s.value?Ft.createForInStatement(a,i,o):Ft.createForOfStatement(a,i,o)}function we(){var e,t,r=[];for(X("default")?(b(),e=null):(P("case"),e=ue()),T(":");Xt<Nt&&!(O("}")||X("default")||X("case"))&&void 0!==(t=Ge());)r.push(t);return Ft.createSwitchCase(e,r)}function Le(){var e,t;return P("catch"),T("("),O(")")&&k(Ut),e=ue(),Ot&&e.type===Ct.Identifier&&u(e.name)&&L({},At.StrictCatchVariable),T(")"),t=pe(),Ft.createCatchClause(e,t)}function ke(){var e,t,r,n=Ut.type;if(n===Et.EOF&&k(Ut),n===Et.Punctuator)switch(Ut.value){case";":return T(";"),Ft.createEmptyStatement();case"{":return pe();case"(":return function(){var e=ue();return D(),Ft.createExpressionStatement(e)}()}if(n===Et.Keyword)switch(Ut.value){case"break":return function(){var e,t=null;return P("break"),59===Pt.charCodeAt(Xt)?(b(),Bt.inIteration||Bt.inSwitch||w({},At.IllegalBreak),Ft.createBreakStatement(null)):A()?(Bt.inIteration||Bt.inSwitch||w({},At.IllegalBreak),Ft.createBreakStatement(null)):(Ut.type===Et.Identifier&&(e="$"+(t=fe()).name,Object.prototype.hasOwnProperty.call(Bt.labelSet,e)||w({},At.UnknownLabel,t.name)),D(),null!==t||Bt.inIteration||Bt.inSwitch||w({},At.IllegalBreak),Ft.createBreakStatement(t))}();case"continue":return function(){var e,t=null;return P("continue"),59===Pt.charCodeAt(Xt)?(b(),Bt.inIteration||w({},At.IllegalContinue),Ft.createContinueStatement(null)):A()?(Bt.inIteration||w({},At.IllegalContinue),Ft.createContinueStatement(null)):(Ut.type===Et.Identifier&&(e="$"+(t=fe()).name,Object.prototype.hasOwnProperty.call(Bt.labelSet,e)||w({},At.UnknownLabel,t.name)),D(),null!==t||Bt.inIteration||w({},At.IllegalContinue),Ft.createContinueStatement(t))}();case"debugger":return P("debugger"),D(),Ft.createDebuggerStatement();case"do":return function(){var e,t,r;return P("do"),r=Bt.inIteration,Bt.inIteration=!0,e=ke(),Bt.inIteration=r,P("while"),T("("),t=ue(),T(")"),O(";")&&b(),Ft.createDoWhileStatement(e,t)}();case"for":return Ae();case"function":return De();case"class":return Me();case"if":return function(){var e,t,r;return P("if"),T("("),e=ue(),T(")"),t=ke(),X("else")?(b(),r=ke()):r=null,Ft.createIfStatement(e,t,r)}();case"return":return function(){var e=null;return P("return"),Bt.inFunctionBody||L({},At.IllegalReturn),32===Pt.charCodeAt(Xt)&&s(Pt.charCodeAt(Xt+1))?(e=ue(),D(),Ft.createReturnStatement(e)):A()?Ft.createReturnStatement(null):(O(";")||O("}")||Ut.type===Et.EOF||(e=ue()),D(),Ft.createReturnStatement(e))}();case"switch":return function(){var e,t,r,n,a;if(P("switch"),T("("),e=ue(),T(")"),T("{"),t=[],O("}"))return b(),Ft.createSwitchStatement(e,t);for(n=Bt.inSwitch,Bt.inSwitch=!0,a=!1;Xt<Nt&&!O("}");)null===(r=we()).test&&(a&&w({},At.MultipleDefaultsInSwitch),a=!0),t.push(r);return Bt.inSwitch=n,T("}"),Ft.createSwitchStatement(e,t)}();case"throw":return function(){var e;return P("throw"),A()&&w({},At.NewlineAfterThrow),e=ue(),D(),Ft.createThrowStatement(e)}();case"try":return function(){var e,t=[],r=null;return P("try"),e=pe(),X("catch")&&t.push(Le()),X("finally")&&(b(),r=pe()),0!==t.length||r||w({},At.NoCatchOrFinally),Ft.createTryStatement(e,[],t,r)}();case"var":return function(){var e;return P("var"),e=ge(),D(),Ft.createVariableDeclaration(e,"var")}();case"while":return function(){var e,t,r;return P("while"),T("("),e=ue(),T(")"),r=Bt.inIteration,Bt.inIteration=!0,t=ke(),Bt.inIteration=r,Ft.createWhileStatement(e,t)}();case"with":return function(){var e,t;return Ot&&L({},At.StrictModeWith),P("with"),T("("),e=ue(),T(")"),t=ke(),Ft.createWithStatement(e,t)}()}return(e=ue()).type===Ct.Identifier&&O(":")?(b(),r="$"+e.name,Object.prototype.hasOwnProperty.call(Bt.labelSet,r)&&w({},At.Redeclaration,"Label",e.name),Bt.labelSet[r]=!0,t=ke(),delete Bt.labelSet[r],Ft.createLabeledStatement(e,t)):(D(),Ft.createExpressionStatement(e))}function Te(){return O("{")?Pe():ce()}function Pe(){var e,t,r,n,a,i,o,s,l=[];for(T("{");Xt<Nt&&Ut.type===Et.StringLiteral&&(t=Ut,e=Ge(),l.push(e),e.expression.type===Ct.Literal);)"use strict"===Pt.slice(t.range[0]+1,t.range[1]-1)?(Ot=!0,r&&L(r,At.StrictOctalLiteral)):!r&&t.octal&&(r=t);for(n=Bt.labelSet,a=Bt.inIteration,i=Bt.inSwitch,o=Bt.inFunctionBody,s=Bt.parenthesizedCount,Bt.labelSet={},Bt.inIteration=!1,Bt.inSwitch=!1,Bt.inFunctionBody=!0,Bt.parenthesizedCount=0;Xt<Nt&&!O("}")&&void 0!==(e=Ge());)l.push(e);return T("}"),Bt.labelSet=n,Bt.inIteration=a,Bt.inSwitch=i,Bt.inFunctionBody=o,Bt.parenthesizedCount=s,Ft.createBlockStatement(l)}function Oe(e,t,r){var n="$"+r;Ot?(u(r)&&(e.stricted=t,e.message=At.StrictParamName),Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.stricted=t,e.message=At.StrictParamDupe)):e.firstRestricted||(u(r)?(e.firstRestricted=t,e.message=At.StrictParamName):c(r)?(e.firstRestricted=t,e.message=At.StrictReservedWord):Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.firstRestricted=t,e.message=At.StrictParamDupe)),e.paramSet[n]=!0}function Xe(e){var t,r,n,a;return"..."===(t=Ut).value&&(t=b(),r=!0),O("[")?oe(e,n=F()):O("{")?(r&&w({},At.ObjectPatternAsRestParameter),oe(e,n=j())):(n=r?fe():me(),Oe(e,t,t.value),O("=")&&(r&&L(Ut,At.DefaultRestParameter),b(),a=ce(),++e.defaultCount)),r?(O(")")||w({},At.ParameterAfterRestParameter),e.rest=n,!1):(e.params.push(n),e.defaults.push(a),!O(")"))}function Je(e){var t;if(t={params:[],defaultCount:0,defaults:[],rest:null,firstRestricted:e},T("("),!O(")"))for(t.paramSet={};Xt<Nt&&Xe(t);)T(",");return T(")"),0===t.defaultCount&&(t.defaults=[]),O(":")&&(t.returnTypeAnnotation=de()),t}function De(){var e,t,r,n,a,i,o,s,l;return P("function"),l=!1,O("*")&&(b(),l=!0),r=Ut,e=fe(),Ot?u(r.value)&&L(r,At.StrictFunctionName):u(r.value)?(a=r,i=At.StrictFunctionName):c(r.value)&&(a=r,i=At.StrictReservedWord),n=Je(a),a=n.firstRestricted,n.message&&(i=n.message),o=Ot,s=Bt.yieldAllowed,Bt.yieldAllowed=l,t=Pe(),Ot&&a&&w(a,i),Ot&&n.stricted&&L(n.stricted,i),Bt.yieldAllowed&&!Bt.yieldFound&&L({},At.NoYieldInGenerator),Ot=o,Bt.yieldAllowed=s,Ft.createFunctionDeclaration(e,n.params,n.defaults,t,n.rest,l,!1,n.returnTypeAnnotation)}function Ne(){var e,t,r,n,a,i,o,s,l=null;return P("function"),s=!1,O("*")&&(b(),s=!0),O("(")||(e=Ut,l=fe(),Ot?u(e.value)&&L(e,At.StrictFunctionName):u(e.value)?(t=e,r=At.StrictFunctionName):c(e.value)&&(t=e,r=At.StrictReservedWord)),n=Je(t),t=n.firstRestricted,n.message&&(r=n.message),i=Ot,o=Bt.yieldAllowed,Bt.yieldAllowed=s,a=Pe(),Ot&&t&&w(t,r),Ot&&n.stricted&&L(n.stricted,r),Bt.yieldAllowed&&!Bt.yieldFound&&L({},At.NoYieldInGenerator),Ot=i,Bt.yieldAllowed=o,Ft.createFunctionExpression(l,n.params,n.defaults,a,n.rest,s,!1,n.returnTypeAnnotation)}function Fe(e){var t,r,n,a;return"static"===Ut.value?(a=Tt.static,b()):a=Tt.prototype,O("*")?(b(),Ft.createMethodDefinition(a,"",R(),B({generator:!0}))):(t=Ut,r=R(),"get"!==t.value||O("(")?"set"!==t.value||O("(")?(e[a].hasOwnProperty(r.name)?w(r,At.IllegalDuplicateClassProperty):e[a][r.name]={},e[a][r.name].data=!0,Ft.createMethodDefinition(a,"",r,B({generator:!1}))):(r=R(),e[a].hasOwnProperty(r.name)?void 0===e[a][r.name].set&&void 0===e[a][r.name].data&&void 0!==e[a][r.name].get||w(r,At.IllegalDuplicateClassProperty):e[a][r.name]={},e[a][r.name].set=!0,T("("),t=Ut,n=[me()],T(")"),Ft.createMethodDefinition(a,"set",r,U({params:n,generator:!1,name:t}))):(r=R(),e[a].hasOwnProperty(r.name)?void 0===e[a][r.name].get&&void 0===e[a][r.name].data&&void 0!==e[a][r.name].set||w(r,At.IllegalDuplicateClassProperty):e[a][r.name]={},e[a][r.name].get=!0,T("("),T(")"),Ft.createMethodDefinition(a,"get",r,U({generator:!1}))))}function Ue(e){if(!O(";"))return Fe(e);b()}function Be(){var e,t=[],r={};for(r[Tt.static]={},r[Tt.prototype]={},T("{");Xt<Nt&&!O("}");)void 0!==(e=Ue(r))&&t.push(e);return T("}"),Ft.createClassBody(t)}function Re(){var e,t,r=null;return P("class"),X("extends")||O("{")||(e=fe()),X("extends")&&(P("extends"),t=Bt.yieldAllowed,Bt.yieldAllowed=!1,r=ce(),Bt.yieldAllowed=t),Ft.createClassExpression(e,r,Be())}function Me(){var e,t,r=null;return P("class"),e=fe(),X("extends")&&(P("extends"),t=Bt.yieldAllowed,Bt.yieldAllowed=!1,r=ce(),Bt.yieldAllowed=t),Ft.createClassDeclaration(e,r,Be())}function je(){var e;return!!J("module")&&((e=I()).type===Et.StringLiteral||e.type===Et.Identifier)}function Ge(){if(Ut.type===Et.Keyword)switch(Ut.value){case"const":case"let":return Se(Ut.value);case"function":return De();case"export":return xe();case"import":return be();default:return ke()}if(je()&&w({},At.NestedModule),Ut.type!==Et.EOF)return ke()}function qe(){if(Ut.type===Et.Keyword)switch(Ut.value){case"export":return xe();case"import":return be()}return je()?he():Ge()}function Ke(){return Ge()}function Ve(){var e;return T("{"),e=function(){for(var e,t=[];Xt<Nt&&!O("}")&&void 0!==(e=Ke());)t.push(e);return t}(),T("}"),Ft.createBlockStatement(e)}function ze(){var e;return Ot=!1,C(),e=function(){for(var e,t,r,n=[];Xt<Nt&&(t=Ut).type===Et.StringLiteral&&(e=qe(),n.push(e),e.expression.type===Ct.Literal);)"use strict"===Pt.slice(t.range[0]+1,t.range[1]-1)?(Ot=!0,r&&L(r,At.StrictOctalLiteral)):!r&&t.octal&&(r=t);for(;Xt<Nt&&void 0!==(e=qe());)n.push(e);return n}(),Ft.createProgram(e)}function He(e,r,n,a,i){t("number"==typeof n,"Comment must have valid position"),Rt.comments.length>0&&Rt.comments[Rt.comments.length-1].range[1]>n||Rt.comments.push({type:e,value:r,range:[n,a],loc:i})}function We(){var e,t,r,n,a,s;for(e="",a=!1,s=!1;Xt<Nt;)if(t=Pt[Xt],s)o((t=Pt[Xt++]).charCodeAt(0))?(r.end={line:Jt,column:Xt-Dt-1},s=!1,He("Line",e,n,Xt-1,r),"\r"===t&&"\n"===Pt[Xt]&&++Xt,++Jt,Dt=Xt,e=""):Xt>=Nt?(s=!1,e+=t,r.end={line:Jt,column:Nt-Dt},He("Line",e,n,Nt,r)):e+=t;else if(a)o(t.charCodeAt(0))?("\r"===t&&"\n"===Pt[Xt+1]?(++Xt,e+="\r\n"):e+=t,++Jt,Dt=++Xt,Xt>=Nt&&w({},At.UnexpectedToken,"ILLEGAL")):(t=Pt[Xt++],Xt>=Nt&&w({},At.UnexpectedToken,"ILLEGAL"),e+=t,"*"===t&&"/"===(t=Pt[Xt])&&(e=e.substr(0,e.length-1),a=!1,++Xt,r.end={line:Jt,column:Xt-Dt},He("Block",e,n,Xt,r),e=""));else if("/"===t)if("/"===(t=Pt[Xt+1]))r={start:{line:Jt,column:Xt-Dt}},n=Xt,s=!0,(Xt+=2)>=Nt&&(r.end={line:Jt,column:Xt-Dt},s=!1,He("Line",e,n,Xt,r));else{if("*"!==t)break;n=Xt,a=!0,r={start:{line:Jt,column:(Xt+=2)-Dt-2}},Xt>=Nt&&w({},At.UnexpectedToken,"ILLEGAL")}else if(i(t.charCodeAt(0)))++Xt;else{if(!o(t.charCodeAt(0)))break;++Xt,"\r"===t&&"\n"===Pt[Xt]&&++Xt,++Jt,Dt=Xt}}function Ye(){var e,t,r,n=[];for(e=0;e<Rt.comments.length;++e)r={type:(t=Rt.comments[e]).type,value:t.value},Rt.range&&(r.range=t.range),Rt.loc&&(r.loc=t.loc),n.push(r);Rt.comments=n}function $e(e){return 92!==e&&(45===e||l(e))}function Ze(){var e,r="",n=0;for(t("&"===(e=Pt[Xt]),"Entity must start with an ampersand"),Xt++;Xt<Nt&&n++<10&&";"!==(e=Pt[Xt++]);)r+=e;return"#"===r[0]&&"x"===r[1]?String.fromCharCode(parseInt(r.substr(2),16)):"#"===r[0]?String.fromCharCode(parseInt(r.substr(1),10)):kt[r]}function Qe(e){var t,r,n="";for(r=Xt;Xt<Nt&&(t=Pt[Xt],-1===e.indexOf(t));)"&"===t?n+=Ze():(o((t=Pt[Xt++]).charCodeAt(0))&&(++Jt,Dt=Xt),n+=t);return{type:Et.XJSText,value:n,lineNumber:Jt,lineStart:Dt,range:[r,Xt]}}function _e(){var e;return Ut.type!==Et.XJSIdentifier&&k(Ut),e=b(),Ft.createXJSIdentifier(e.value,e.namespace)}function et(){var e;return O("{")?(e=rt()).expression.type===Ct.XJSEmptyExpression&&w(e,"XJS attributes must only be assigned a non-empty expression"):O("<")?e=st():Ut.type===Et.XJSText?e=Ft.createLiteral(b()):w({},At.InvalidXJSAttributeValue),e}function tt(){for(;"}"!==Pt.charAt(Xt);)Xt++;return Ft.createXJSEmptyExpression()}function rt(){var e,t,r;return t=Bt.inXJSChild,r=Bt.inXJSTag,Bt.inXJSChild=!1,Bt.inXJSTag=!1,T("{"),e=O("}")?tt():ue(),Bt.inXJSChild=t,Bt.inXJSTag=r,T("}"),Ft.createXJSExpressionContainer(e)}function nt(){var e;return e=_e(),O("=")?(b(),Ft.createXJSAttribute(e,et())):Ft.createXJSAttribute(e)}function at(){return O("{")?rt():Ut.type===Et.XJSText?Ft.createLiteral(b()):st()}function it(){var e,t,r;return t=Bt.inXJSChild,r=Bt.inXJSTag,Bt.inXJSChild=!1,Bt.inXJSTag=!0,T("<"),T("/"),e=_e(),Bt.inXJSChild=t,Bt.inXJSTag=r,T(">"),Ft.createXJSClosingElement(e)}function ot(){var e,t,r,n=[],a=!1;for(t=Bt.inXJSChild,r=Bt.inXJSTag,Bt.inXJSChild=!1,Bt.inXJSTag=!0,T("<"),e=_e();Xt<Nt&&"/"!==Ut.value&&">"!==Ut.value;)n.push(nt());return Bt.inXJSTag=r,"/"===Ut.value?(T("/"),Bt.inXJSChild=t,T(">"),a=!0):(Bt.inXJSChild=!0,T(">")),Ft.createXJSOpeningElement(e,n,a)}function st(){var e,t,r,n,a=[];if(r=Bt.inXJSChild,n=Bt.inXJSTag,!(e=ot()).selfClosing){for(;Xt<Nt&&(Bt.inXJSChild=!1,"<"!==Ut.value||"/"!==I().value);)Bt.inXJSChild=!0,C(),a.push(at());Bt.inXJSChild=r,Bt.inXJSTag=n,(t=it()).name.namespace===e.name.namespace&&t.name.name===e.name.name||w({},At.ExpectedXJSClosingTag,e.name.namespace?e.name.namespace+":"+e.name.name:e.name.name)}return Ft.createXJSElement(e,t,a)}function lt(){var e,t,r,n;return p(),Xt,e={start:{line:Jt,column:Xt-Dt}},t=Rt.advance(),e.end={line:Jt,column:Xt-Dt},t.type!==Et.EOF&&(r=[t.range[0],t.range[1]],n=Pt.slice(t.range[0],t.range[1]),Rt.tokens.push({type:xt[t.type],value:n,range:r,loc:e})),t}function ct(){var e,t,r,n;return p(),e=Xt,t={start:{line:Jt,column:Xt-Dt}},r=Rt.scanRegExp(),t.end={line:Jt,column:Xt-Dt},Rt.tokenize||(Rt.tokens.length>0&&(n=Rt.tokens[Rt.tokens.length-1]).range[0]===e&&"Punctuator"===n.type&&("/"!==n.value&&"/="!==n.value||Rt.tokens.pop()),Rt.tokens.push({type:"RegularExpression",value:r.literal,range:[e,Xt],loc:t})),r}function ut(){var e,t,r,n=[];for(e=0;e<Rt.tokens.length;++e)r={type:(t=Rt.tokens[e]).type,value:t.value},Rt.range&&(r.range=t.range),Rt.loc&&(r.loc=t.loc),n.push(r);Rt.tokens=n}function pt(){this.range=[Xt,Xt],this.loc={start:{line:Jt,column:Xt-Dt},end:{line:Jt,column:Xt-Dt}}}function dt(){return new pt}function ft(){var e,t;return p(),e=dt(),T("("),++Bt.parenthesizedCount,t=ue(),T(")"),e.end(),e.applyGroup(t),t}function mt(){var e,t;for(p(),e=dt(),t=X("new")?Z():V();O(".")||O("[")||Ut.type===Et.Template;)O("[")?(t=Ft.createMemberExpression("[",t,$()),e.end(),e.apply(t)):O(".")?(t=Ft.createMemberExpression(".",t,Y()),e.end(),e.apply(t)):(t=Ft.createTaggedTemplateExpression(t,q()),e.end(),e.apply(t));return t}function yt(){var e,t,r;for(p(),e=dt(),t=X("new")?Z():V();O(".")||O("[")||O("(")||Ut.type===Et.Template;)O("(")?(r=z(),t=Ft.createCallExpression(t,r),e.end(),e.apply(t)):O("[")?(t=Ft.createMemberExpression("[",t,$()),e.end(),e.apply(t)):O(".")?(t=Ft.createMemberExpression(".",t,Y()),e.end(),e.apply(t)):(t=Ft.createTaggedTemplateExpression(t,q()),e.end(),e.apply(t));return t}function gt(e){var t,r,n;t="[object Array]"===Object.prototype.toString.apply(e)?[]:{};for(r in e)e.hasOwnProperty(r)&&"groupRange"!==r&&"groupLoc"!==r&&(null===(n=e[r])||"object"!=typeof n||n instanceof RegExp?t[r]=n:t[r]=gt(n));return t}function St(e,t,r){return function(n){function a(e){return e.type===Ct.LogicalExpression||e.type===Ct.BinaryExpression}function i(r){var n,o;a(r.left)&&i(r.left),a(r.right)&&i(r.right),e&&(r.left.groupRange||r.right.groupRange?(n=r.left.groupRange?r.left.groupRange[0]:r.left.range[0],o=r.right.groupRange?r.right.groupRange[1]:r.right.range[1],r.range=[n,o]):void 0===r.range&&(n=r.left.range[0],o=r.right.range[1],r.range=[n,o])),t&&(r.left.groupLoc||r.right.groupLoc?(n=r.left.groupLoc?r.left.groupLoc.start:r.left.loc.start,o=r.right.groupLoc?r.right.groupLoc.end:r.right.loc.end,r.loc={start:n,end:o},r=Ft.postProcess(r)):void 0===r.loc&&(r.loc={start:r.left.loc.start,end:r.right.loc.end},r=Ft.postProcess(r)))}return function(){var o,s;return r||p(),o=dt(),s=n.apply(null,arguments),o.end(),e&&void 0===s.range&&o.apply(s),t&&void 0===s.loc&&o.apply(s),a(s)&&i(s),s}}}function ht(){var e,t;Rt.comments&&(Rt.skipComment=p,p=We),(Rt.range||Rt.loc)&&(Rt.parseGroupExpression=K,Rt.parseLeftHandSideExpression=_,Rt.parseLeftHandSideExpressionAllowCall=Q,K=ft,_=mt,Q=yt,e=St(Rt.range,Rt.loc),t=St(Rt.range,Rt.loc,!0),Rt.parseArrayInitialiser=F,Rt.parseAssignmentExpression=ce,Rt.parseBinaryExpression=ne,Rt.parseBlock=pe,Rt.parseFunctionSourceElements=Pe,Rt.parseCatchClause=Le,Rt.parseComputedMember=$,Rt.parseConditionalExpression=ae,Rt.parseConstLetDeclaration=Se,Rt.parseExportBatchSpecifier=ve,Rt.parseExportDeclaration=xe,Rt.parseExportSpecifier=Ee,Rt.parseExpression=ue,Rt.parseForVariableDeclaration=Ie,Rt.parseFunctionDeclaration=De,Rt.parseFunctionExpression=Ne,Rt.parseParams=Je,Rt.parseImportDeclaration=be,Rt.parseImportSpecifier=Ce,Rt.parseModuleDeclaration=he,Rt.parseModuleBlock=Ve,Rt.parseNewExpression=Z,Rt.parseNonComputedProperty=W,Rt.parseObjectInitialiser=j,Rt.parseObjectProperty=M,Rt.parseObjectPropertyKey=R,Rt.parsePostfixExpression=ee,Rt.parsePrimaryExpression=V,Rt.parseProgram=ze,Rt.parsePropertyFunction=U,Rt.parseSpreadOrAssignmentExpression=H,Rt.parseTemplateElement=G,Rt.parseTemplateLiteral=q,Rt.parseTypeAnnotatableIdentifier=me,Rt.parseTypeAnnotation=de,Rt.parseStatement=ke,Rt.parseSwitchCase=we,Rt.parseUnaryExpression=te,Rt.parseVariableDeclaration=ye,Rt.parseVariableIdentifier=fe,Rt.parseMethodDefinition=Fe,Rt.parseClassDeclaration=Me,Rt.parseClassExpression=Re,Rt.parseClassBody=Be,Rt.parseXJSIdentifier=_e,Rt.parseXJSChild=at,Rt.parseXJSAttribute=nt,Rt.parseXJSAttributeValue=et,Rt.parseXJSExpressionContainer=rt,Rt.parseXJSEmptyExpression=tt,Rt.parseXJSElement=st,Rt.parseXJSClosingElement=it,Rt.parseXJSOpeningElement=ot,F=e(Rt.parseArrayInitialiser),ce=e(Rt.parseAssignmentExpression),ne=e(Rt.parseBinaryExpression),pe=e(Rt.parseBlock),Pe=e(Rt.parseFunctionSourceElements),Le=e(Rt.parseCatchClause),$=e(Rt.parseComputedMember),ae=e(Rt.parseConditionalExpression),Se=e(Rt.parseConstLetDeclaration),ve=e(ve),xe=e(xe),Ee=e(Ee),ue=e(Rt.parseExpression),Ie=e(Rt.parseForVariableDeclaration),De=e(Rt.parseFunctionDeclaration),Ne=e(Rt.parseFunctionExpression),Je=e(Rt.parseParams),be=e(Rt.parseImportDeclaration),Ce=e(Rt.parseImportSpecifier),he=e(Rt.parseModuleDeclaration),Ve=e(Rt.parseModuleBlock),_=e(_),Z=e(Rt.parseNewExpression),W=e(Rt.parseNonComputedProperty),j=e(Rt.parseObjectInitialiser),M=e(Rt.parseObjectProperty),R=e(Rt.parseObjectPropertyKey),ee=e(Rt.parsePostfixExpression),V=e(Rt.parsePrimaryExpression),ze=e(Rt.parseProgram),U=e(Rt.parsePropertyFunction),G=e(Rt.parseTemplateElement),q=e(Rt.parseTemplateLiteral),me=e(Rt.parseTypeAnnotatableIdentifier),de=e(Rt.parseTypeAnnotation),H=e(Rt.parseSpreadOrAssignmentExpression),ke=e(Rt.parseStatement),we=e(Rt.parseSwitchCase),te=e(Rt.parseUnaryExpression),ye=e(Rt.parseVariableDeclaration),fe=e(Rt.parseVariableIdentifier),Fe=e(Rt.parseMethodDefinition),Me=e(Rt.parseClassDeclaration),Re=e(Rt.parseClassExpression),Be=e(Rt.parseClassBody),_e=e(Rt.parseXJSIdentifier),at=t(Rt.parseXJSChild),nt=e(Rt.parseXJSAttribute),et=e(Rt.parseXJSAttributeValue),rt=e(Rt.parseXJSExpressionContainer),tt=t(Rt.parseXJSEmptyExpression),st=e(Rt.parseXJSElement),it=e(Rt.parseXJSClosingElement),ot=e(Rt.parseXJSOpeningElement)),void 0!==Rt.tokens&&(Rt.advance=x,Rt.scanRegExp=v,x=lt,v=ct)}function vt(){"function"==typeof Rt.skipComment&&(p=Rt.skipComment),(Rt.range||Rt.loc)&&(F=Rt.parseArrayInitialiser,ce=Rt.parseAssignmentExpression,ne=Rt.parseBinaryExpression,pe=Rt.parseBlock,Pe=Rt.parseFunctionSourceElements,Le=Rt.parseCatchClause,$=Rt.parseComputedMember,ae=Rt.parseConditionalExpression,Se=Rt.parseConstLetDeclaration,ve=Rt.parseExportBatchSpecifier,xe=Rt.parseExportDeclaration,Ee=Rt.parseExportSpecifier,ue=Rt.parseExpression,Ie=Rt.parseForVariableDeclaration,De=Rt.parseFunctionDeclaration,Ne=Rt.parseFunctionExpression,be=Rt.parseImportDeclaration,Ce=Rt.parseImportSpecifier,K=Rt.parseGroupExpression,_=Rt.parseLeftHandSideExpression,Q=Rt.parseLeftHandSideExpressionAllowCall,he=Rt.parseModuleDeclaration,Ve=Rt.parseModuleBlock,Z=Rt.parseNewExpression,W=Rt.parseNonComputedProperty,j=Rt.parseObjectInitialiser,M=Rt.parseObjectProperty,R=Rt.parseObjectPropertyKey,ee=Rt.parsePostfixExpression,V=Rt.parsePrimaryExpression,ze=Rt.parseProgram,U=Rt.parsePropertyFunction,G=Rt.parseTemplateElement,q=Rt.parseTemplateLiteral,me=Rt.parseTypeAnnotatableIdentifier,de=Rt.parseTypeAnnotation,H=Rt.parseSpreadOrAssignmentExpression,ke=Rt.parseStatement,we=Rt.parseSwitchCase,te=Rt.parseUnaryExpression,ye=Rt.parseVariableDeclaration,fe=Rt.parseVariableIdentifier,Fe=Rt.parseMethodDefinition,Me=Rt.parseClassDeclaration,Re=Rt.parseClassExpression,Be=Rt.parseClassBody,_e=Rt.parseXJSIdentifier,at=Rt.parseXJSChild,nt=Rt.parseXJSAttribute,et=Rt.parseXJSAttributeValue,rt=Rt.parseXJSExpressionContainer,tt=Rt.parseXJSEmptyExpression,st=Rt.parseXJSElement,it=Rt.parseXJSClosingElement,ot=Rt.parseXJSOpeningElement),"function"==typeof Rt.scanRegExp&&(x=Rt.advance,v=Rt.scanRegExp)}var Et,xt,bt,Ct,It,At,wt,Lt,kt,Tt,Pt,Ot,Xt,Jt,Dt,Nt,Ft,Ut,Bt,Rt;(xt={})[(Et={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9,Template:10,XJSIdentifier:11,XJSText:12}).BooleanLiteral]="Boolean",xt[Et.EOF]="<end>",xt[Et.Identifier]="Identifier",xt[Et.Keyword]="Keyword",xt[Et.NullLiteral]="Null",xt[Et.NumericLiteral]="Numeric",xt[Et.Punctuator]="Punctuator",xt[Et.StringLiteral]="String",xt[Et.XJSIdentifier]="XJSIdentifier",xt[Et.XJSText]="XJSText",xt[Et.RegularExpression]="RegularExpression",bt=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],Ct={ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AssignmentExpression:"AssignmentExpression",BinaryExpression:"BinaryExpression",BlockStatement:"BlockStatement",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ClassHeritage:"ClassHeritage",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportDeclaration:"ExportDeclaration",ExportBatchSpecifier:"ExportBatchSpecifier",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",ForStatement:"ForStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportSpecifier:"ImportSpecifier",LabeledStatement:"LabeledStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MethodDefinition:"MethodDefinition",ModuleDeclaration:"ModuleDeclaration",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",TypeAnnotatedIdentifier:"TypeAnnotatedIdentifier",TypeAnnotation:"TypeAnnotation",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",XJSIdentifier:"XJSIdentifier",XJSEmptyExpression:"XJSEmptyExpression",XJSExpressionContainer:"XJSExpressionContainer",XJSElement:"XJSElement",XJSClosingElement:"XJSClosingElement",XJSOpeningElement:"XJSOpeningElement",XJSAttribute:"XJSAttribute",XJSText:"XJSText",YieldExpression:"YieldExpression"},It={Data:1,Get:2,Set:4},Tt={static:"static",prototype:"prototype"},At={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInFormalsList:"Invalid left-hand side in formals list",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalDuplicateClassProperty:"Illegal duplicate property in class definition",IllegalReturn:"Illegal return statement",IllegalYield:"Illegal yield expression",IllegalSpread:"Illegal spread element",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",ParameterAfterRestParameter:"Rest parameter must be final parameter of an argument list",DefaultRestParameter:"Rest parameter can not have a default value",ElementAfterSpreadElement:"Spread must be the final element of an element list",ObjectPatternAsRestParameter:"Invalid rest parameter",ObjectPatternAsSpread:"Invalid spread argument",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",NewlineAfterModule:"Illegal newline after module",NoFromAfterImport:"Missing from after import",InvalidModuleSpecifier:"Invalid module specifier",NestedModule:"Module declaration can not be nested",NoYieldInGenerator:"Missing yield in generator",NoUnintializedConst:"Const must be initialized",ComprehensionRequiresBlock:"Comprehension must have at least one block",ComprehensionError:"Comprehension Error",EachNotAllowed:"Each is not supported",InvalidXJSTagName:"XJS tag name can not be empty",InvalidXJSAttributeValue:"XJS value should be either an expression or a quoted XJS text",ExpectedXJSClosingTag:"Expected corresponding XJS closing tag for %0"},wt={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},Lt={name:"SyntaxTree",postProcess:function(e){return e},createArrayExpression:function(e){return{type:Ct.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,r){return{type:Ct.AssignmentExpression,operator:e,left:t,right:r}},createBinaryExpression:function(e,t,r){return{type:"||"===e||"&&"===e?Ct.LogicalExpression:Ct.BinaryExpression,operator:e,left:t,right:r}},createBlockStatement:function(e){return{type:Ct.BlockStatement,body:e}},createBreakStatement:function(e){return{type:Ct.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:Ct.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:Ct.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,r){return{type:Ct.ConditionalExpression,test:e,consequent:t,alternate:r}},createContinueStatement:function(e){return{type:Ct.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:Ct.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:Ct.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:Ct.EmptyStatement}},createExpressionStatement:function(e){return{type:Ct.ExpressionStatement,expression:e}},createForStatement:function(e,t,r,n){return{type:Ct.ForStatement,init:e,test:t,update:r,body:n}},createForInStatement:function(e,t,r){return{type:Ct.ForInStatement,left:e,right:t,body:r,each:!1}},createForOfStatement:function(e,t,r){return{type:Ct.ForOfStatement,left:e,right:t,body:r}},createFunctionDeclaration:function(e,t,r,n,a,i,o,s){return{type:Ct.FunctionDeclaration,id:e,params:t,defaults:r,body:n,rest:a,generator:i,expression:o,returnType:s}},createFunctionExpression:function(e,t,r,n,a,i,o,s){return{type:Ct.FunctionExpression,id:e,params:t,defaults:r,body:n,rest:a,generator:i,expression:o,returnType:s}},createIdentifier:function(e){return{type:Ct.Identifier,name:e,typeAnnotation:void 0}},createTypeAnnotation:function(e,t,r,n){return{type:Ct.TypeAnnotation,id:e,paramTypes:t,returnType:r,nullable:n}},createTypeAnnotatedIdentifier:function(e,t){return{type:Ct.TypeAnnotatedIdentifier,id:e,annotation:t}},createXJSAttribute:function(e,t){return{type:Ct.XJSAttribute,name:e,value:t}},createXJSIdentifier:function(e,t){return{type:Ct.XJSIdentifier,name:e,namespace:t}},createXJSElement:function(e,t,r){return{type:Ct.XJSElement,openingElement:e,closingElement:t,children:r}},createXJSEmptyExpression:function(){return{type:Ct.XJSEmptyExpression}},createXJSExpressionContainer:function(e){return{type:Ct.XJSExpressionContainer,expression:e}},createXJSOpeningElement:function(e,t,r){return{type:Ct.XJSOpeningElement,name:e,selfClosing:r,attributes:t}},createXJSClosingElement:function(e){return{type:Ct.XJSClosingElement,name:e}},createIfStatement:function(e,t,r){return{type:Ct.IfStatement,test:e,consequent:t,alternate:r}},createLabeledStatement:function(e,t){return{type:Ct.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:Ct.Literal,value:e.value,raw:Pt.slice(e.range[0],e.range[1])}},createMemberExpression:function(e,t,r){return{type:Ct.MemberExpression,computed:"["===e,object:t,property:r}},createNewExpression:function(e,t){return{type:Ct.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:Ct.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:Ct.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:Ct.Program,body:e}},createProperty:function(e,t,r,n,a){return{type:Ct.Property,key:t,value:r,kind:e,method:n,shorthand:a}},createReturnStatement:function(e){return{type:Ct.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:Ct.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:Ct.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:Ct.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:Ct.ThisExpression}},createThrowStatement:function(e){return{type:Ct.ThrowStatement,argument:e}},createTryStatement:function(e,t,r,n){return{type:Ct.TryStatement,block:e,guardedHandlers:t,handlers:r,finalizer:n}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:Ct.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:Ct.UnaryExpression,operator:e,argument:t}},createVariableDeclaration:function(e,t){return{type:Ct.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:Ct.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:Ct.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:Ct.WithStatement,object:e,body:t}},createTemplateElement:function(e,t){return{type:Ct.TemplateElement,value:e,tail:t}},createTemplateLiteral:function(e,t){return{type:Ct.TemplateLiteral,quasis:e,expressions:t}},createSpreadElement:function(e){return{type:Ct.SpreadElement,argument:e}},createTaggedTemplateExpression:function(e,t){return{type:Ct.TaggedTemplateExpression,tag:e,quasi:t}},createArrowFunctionExpression:function(e,t,r,n,a){return{type:Ct.ArrowFunctionExpression,id:null,params:e,defaults:t,body:r,rest:n,generator:!1,expression:a}},createMethodDefinition:function(e,t,r,n){return{type:Ct.MethodDefinition,key:r,value:n,kind:t,static:e===Tt.static}},createClassBody:function(e){return{type:Ct.ClassBody,body:e}},createClassExpression:function(e,t,r){return{type:Ct.ClassExpression,id:e,superClass:t,body:r}},createClassDeclaration:function(e,t,r){return{type:Ct.ClassDeclaration,id:e,superClass:t,body:r}},createExportSpecifier:function(e,t){return{type:Ct.ExportSpecifier,id:e,name:t}},createExportBatchSpecifier:function(){return{type:Ct.ExportBatchSpecifier}},createExportDeclaration:function(e,t,r){return{type:Ct.ExportDeclaration,declaration:e,specifiers:t,source:r}},createImportSpecifier:function(e,t){return{type:Ct.ImportSpecifier,id:e,name:t}},createImportDeclaration:function(e,t,r){return{type:Ct.ImportDeclaration,specifiers:e,kind:t,source:r}},createYieldExpression:function(e,t){return{type:Ct.YieldExpression,argument:e,delegate:t}},createModuleDeclaration:function(e,t,r){return{type:Ct.ModuleDeclaration,id:e,source:t,body:r}}},kt={quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"},pt.prototype={constructor:pt,end:function(){this.range[1]=Xt,this.loc.end.line=Jt,this.loc.end.column=Xt-Dt},applyGroup:function(e){Rt.range&&(e.groupRange=[this.range[0],this.range[1]]),Rt.loc&&(e.groupLoc={start:{line:this.loc.start.line,column:this.loc.start.column},end:{line:this.loc.end.line,column:this.loc.end.column}},e=Ft.postProcess(e))},apply:function(e){var r=typeof e;t("object"===r,"Applying location marker to an unexpected node type: "+r),Rt.range&&(e.range=[this.range[0],this.range[1]]),Rt.loc&&(e.loc={start:{line:this.loc.start.line,column:this.loc.start.column},end:{line:this.loc.end.line,column:this.loc.end.column}},e=Ft.postProcess(e))}},e.version="1.1.0-dev-harmony",e.tokenize=function(e,t){var r,n;r=String,"string"==typeof e||e instanceof String||(e=r(e)),Ft=Lt,Xt=0,Jt=(Pt=e).length>0?1:0,Dt=0,Nt=Pt.length,Ut=null,Bt={allowKeyword:!0,allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1},Rt={},(t=t||{}).tokens=!0,Rt.tokens=[],Rt.tokenize=!0,Rt.openParenToken=-1,Rt.openCurlyToken=-1,Rt.range="boolean"==typeof t.range&&t.range,Rt.loc="boolean"==typeof t.loc&&t.loc,"boolean"==typeof t.comment&&t.comment&&(Rt.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(Rt.errors=[]),Nt>0&&void 0===Pt[0]&&e instanceof String&&(Pt=e.valueOf()),ht();try{if(C(),Ut.type===Et.EOF)return Rt.tokens;for(b();Ut.type!==Et.EOF;)try{b()}catch(e){if(Rt.errors){Rt.errors.push(e);break}throw e}ut(),n=Rt.tokens,void 0!==Rt.comments&&(Ye(),n.comments=Rt.comments),void 0!==Rt.errors&&(n.errors=Rt.errors)}catch(e){throw e}finally{vt(),Rt={}}return n},e.parse=function(e,t){var r,n;n=String,"string"==typeof e||e instanceof String||(e=n(e)),Ft=Lt,Xt=0,Jt=(Pt=e).length>0?1:0,Dt=0,Nt=Pt.length,Ut=null,Bt={allowKeyword:!1,allowIn:!0,labelSet:{},parenthesizedCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,inXJSChild:!1,inXJSTag:!1,yieldAllowed:!1,yieldFound:!1},Rt={},void 0!==t&&(Rt.range="boolean"==typeof t.range&&t.range,Rt.loc="boolean"==typeof t.loc&&t.loc,Rt.loc&&null!==t.source&&void 0!==t.source&&(Ft=function(e,t){var r,n={};for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}(Ft,{postProcess:function(e){return e.loc.source=n(t.source),e}})),"boolean"==typeof t.tokens&&t.tokens&&(Rt.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(Rt.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(Rt.errors=[])),Nt>0&&void 0===Pt[0]&&e instanceof String&&(Pt=e.valueOf()),ht();try{r=ze(),void 0!==Rt.comments&&(Ye(),r.comments=Rt.comments),void 0!==Rt.tokens&&(ut(),r.tokens=Rt.tokens),void 0!==Rt.errors&&(r.errors=Rt.errors),(Rt.range||Rt.loc)&&(r.body=gt(r.body))}catch(e){throw e}finally{vt(),Rt={}}return r},e.Syntax=function(){var e,t={};"function"==typeof Object.create&&(t=Object.create(null));for(e in Ct)Ct.hasOwnProperty(e)&&(t[e]=Ct[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()});

},{}],301:[function(require,module,exports){
var core=require("./lib/core");exports=module.exports=require("./lib/async"),exports.core=core,exports.isCore=function(r){return core[r]},exports.sync=require("./lib/sync");

},{"./lib/async":302,"./lib/core":305,"./lib/sync":307}],302:[function(require,module,exports){
var core=require("./core"),fs=require("fs"),path=require("path"),caller=require("./caller.js"),nodeModulesPaths=require("./node-modules-paths.js");module.exports=function(n,e,i){function t(n,i,t){"function"==typeof i&&(t=i,i=e.package),function e(o){if(0===o.length)return t(null,void 0,i);var u=n+o[0];r(u,function(n,r){n?t(n):r?t(null,u,i):e(o.slice(1))})}([""].concat(a))}function o(n,i,a){"function"==typeof i&&(a=i,i=e.package);var l=path.join(n,"/package.json");r(l,function(r,f){return r?a(r):f?void u(l,function(i,r){if(i)return a(i);try{var u=JSON.parse(r)}catch(i){}if(e.packageFilter&&(u=e.packageFilter(u,n)),u.main)return"."!==u.main&&"./"!==u.main||(u.main="index"),void t(path.resolve(n,u.main),u,function(e,i,r){if(e)return a(e);if(i)return a(null,i,r);if(!r)return t(path.join(n,"/index"),r,a);o(path.resolve(n,r.main),r,function(e,i,o){return e?a(e):i?a(null,i,o):void t(path.join(n,"/index"),o,a)})});t(path.join(n,"/index"),u,a)}):t(path.join(n,"/index"),i,a)})}"function"==typeof e&&(i=e,e={}),e||(e={});var r=e.isFile||function(n,e){fs.stat(n,function(n,i){n&&"ENOENT"===n.code?e(null,!1):n?e(n):e(null,i.isFile()||i.isFIFO())})},u=e.readFile||fs.readFile,a=e.extensions||[".js"],l=e.basedir||path.dirname(caller());e.moduleDirectory;e.paths=e.paths||[],n.match(/^(?:\.\.?\/|\/|([A-Za-z]:)?\\)/)?t(path.resolve(l,n),function(e,t,r){e?i(e):t?i(null,t,r):o(path.resolve(l,n),function(e,t,o){e?i(e):t?i(null,t,o):i(new Error("Cannot find module '"+n+"' from '"+l+"'"))})}):function(n,i,r){!function e(i){if(0===i.length)return r(null,void 0);var u=i[0];t(path.join(u,"/",n),void 0,function(t,a,l){return t?r(t):a?r(null,a,l):void o(path.join(u,"/",n),void 0,function(n,t,o){return n?r(n):t?r(null,t,o):void e(i.slice(1))})})}(nodeModulesPaths(i,e))}(n,l,function(e,t,o){if(e)i(e);else if(t)i(null,t,o);else{if(core[n])return i(null,n);i(new Error("Cannot find module '"+n+"' from '"+l+"'"))}})};

},{"./caller.js":303,"./core":305,"./node-modules-paths.js":306,"fs":309,"path":312}],303:[function(require,module,exports){
module.exports=function(){var r=Error.prepareStackTrace;Error.prepareStackTrace=function(r,e){return e};var e=(new Error).stack;return Error.prepareStackTrace=r,e[2].getFileName()};

},{}],304:[function(require,module,exports){
module.exports=[
    "assert",
    "buffer_ieee754",
    "buffer",
    "child_process",
    "cluster",
    "console",
    "constants",
    "crypto",
    "_debugger",
    "dgram",
    "dns",
    "domain",
    "events",
    "freelist",
    "fs",
    "http",
    "https",
    "_linklist",
    "module",
    "net",
    "os",
    "path",
    "punycode",
    "querystring",
    "readline",
    "repl",
    "stream",
    "string_decoder",
    "sys",
    "timers",
    "tls",
    "tty",
    "url",
    "util",
    "vm",
    "zlib"
]

},{}],305:[function(require,module,exports){
module.exports=require("./core.json").reduce(function(e,r){return e[r]=!0,e},{});

},{"./core.json":304}],306:[function(require,module,exports){
(function (process){
var path=require("path");module.exports=function(t,e){var r=e.moduleDirectory||"node_modules",a="/";/^([A-Za-z]:)/.test(t)?a="":/^\\\\/.test(t)&&(a="\\\\");for(var p="win32"===process.platform?/[\/\\]/:/\/+/,o=t.split(p),l=[],n=o.length-1;n>=0;n--)if(o[n]!==r){var s=path.join(path.join.apply(path,o.slice(0,n+1)),r);l.push(a+s)}return"win32"===process.platform&&(l[l.length-1]=l[l.length-1].replace(":",":\\")),l.concat(e.paths)};

}).call(this,require('_process'))

},{"_process":313,"path":312}],307:[function(require,module,exports){
var core=require("./core"),fs=require("fs"),path=require("path"),caller=require("./caller.js"),nodeModulesPaths=require("./node-modules-paths.js");module.exports=function(r,e){function a(r){if(n(r))return r;for(var e=0;e<o.length;e++){var a=r+o[e];if(n(a))return a}}function t(r){var o=path.join(r,"/package.json");if(n(o)){var s=i(o,"utf8");try{var u=JSON.parse(s);if(e.packageFilter&&(u=e.packageFilter(u,r)),u.main){var f=a(path.resolve(r,u.main));if(f)return f;var l=t(path.resolve(r,u.main));if(l)return l}}catch(r){}}return a(path.join(r,"/index"))}e||(e={});var n=e.isFile||function(r){try{var e=fs.statSync(r)}catch(r){if(r&&"ENOENT"===r.code)return!1}return e.isFile()||e.isFIFO()},i=e.readFileSync||fs.readFileSync,o=e.extensions||[".js"],s=e.basedir||path.dirname(caller());if(e.paths=e.paths||[],r.match(/^(?:\.\.?\/|\/|([A-Za-z]:)?\\)/)){var u=a(path.resolve(s,r))||t(path.resolve(s,r));if(u)return u}else{var f=function(r,n){for(var i=nodeModulesPaths(n,e),o=0;o<i.length;o++){var s=i[o],u=a(path.join(s,"/",r));if(u)return u;var f=t(path.join(s,"/",r));if(f)return f}}(r,s);if(f)return f}if(core[r])return r;throw new Error("Cannot find module '"+r+"' from '"+s+"'")};

},{"./caller.js":303,"./core":305,"./node-modules-paths.js":306,"fs":309,"path":312}],308:[function(require,module,exports){
(function (process){
function through(e,t,r){function u(){for(;o.length&&!s.paused;){var e=o.shift();if(null===e)return s.emit("end");s.emit("data",e)}}e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var n=!1,a=!1,o=[],i=!1,s=new Stream;return s.readable=s.writable=!0,s.paused=!1,s.autoDestroy=!(r&&!1===r.autoDestroy),s.write=function(t){return e.call(this,t),!s.paused},s.queue=s.push=function(e){return i?s:(null===e&&(i=!0),o.push(e),u(),s)},s.on("end",function(){s.readable=!1,!s.writable&&s.autoDestroy&&process.nextTick(function(){s.destroy()})}),s.end=function(e){if(!n)return n=!0,arguments.length&&s.write(e),s.writable=!1,t.call(s),!s.readable&&s.autoDestroy&&s.destroy(),s},s.destroy=function(){if(!a)return a=!0,n=!0,o.length=0,s.writable=s.readable=!1,s.emit("close"),s},s.pause=function(){if(!s.paused)return s.paused=!0,s},s.resume=function(){return s.paused&&(s.paused=!1,s.emit("resume")),u(),s.paused||s.emit("drain"),s},s}var Stream=require("stream");exports=module.exports=through,through.through=through;

}).call(this,require('_process'))

},{"_process":313,"stream":360}],309:[function(require,module,exports){

},{}],310:[function(require,module,exports){

},{}],311:[function(require,module,exports){
function isBuffer(f){return!!f.constructor&&"function"==typeof f.constructor.isBuffer&&f.constructor.isBuffer(f)}function isSlowBuffer(f){return"function"==typeof f.readFloatLE&&"function"==typeof f.slice&&isBuffer(f.slice(0,0))}module.exports=function(f){return null!=f&&(isBuffer(f)||isSlowBuffer(f)||!!f._isBuffer)};

},{}],312:[function(require,module,exports){
(function (process){
function normalizeArray(r,t){for(var e=0,n=r.length-1;n>=0;n--){var s=r[n];"."===s?r.splice(n,1):".."===s?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}function filter(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(r){return splitPathRe.exec(r).slice(1)};exports.resolve=function(){for(var r="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var n=e>=0?arguments[e]:process.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(r=n+"/"+r,t="/"===n.charAt(0))}return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),(t?"/":"")+r||"."},exports.normalize=function(r){var t=exports.isAbsolute(r),e="/"===substr(r,-1);return(r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"))||t||(r="."),r&&e&&(r+="/"),(t?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),s=e(t.split("/")),i=Math.min(n.length,s.length),o=i,u=0;u<i;u++)if(n[u]!==s[u]){o=u;break}var l=[];for(u=o;u<n.length;u++)l.push("..");return(l=l.concat(s.slice(o))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){var t=splitPath(r),e=t[0],n=t[1];return e||n?(n&&(n=n.substr(0,n.length-1)),e+n):"."},exports.basename=function(r,t){var e=splitPath(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},exports.extname=function(r){return splitPath(r)[3]};var substr="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return t<0&&(t=r.length+t),r.substr(t,e)};

}).call(this,require('_process'))

},{"_process":313}],313:[function(require,module,exports){
function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],314:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],315:[function(require,module,exports){
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};

},{}],316:[function(require,module,exports){
(function (process,global){
function inspect(e,r){var t={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),isBoolean(r)?t.showHidden=r:r&&exports._extend(t,r),isUndefined(t.showHidden)&&(t.showHidden=!1),isUndefined(t.depth)&&(t.depth=2),isUndefined(t.colors)&&(t.colors=!1),isUndefined(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=stylizeWithColor),formatValue(t,e,t.depth)}function stylizeWithColor(e,r){var t=inspect.styles[r];return t?"["+inspect.colors[t][0]+"m"+e+"["+inspect.colors[t][1]+"m":e}function stylizeNoColor(e,r){return e}function arrayToHash(e){var r={};return e.forEach(function(e,t){r[e]=!0}),r}function formatValue(e,r,t){if(e.customInspect&&r&&isFunction(r.inspect)&&r.inspect!==exports.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(t,e);return isString(n)||(n=formatValue(e,n,t)),n}var i=formatPrimitive(e,r);if(i)return i;var o=Object.keys(r),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),isError(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(r);if(0===o.length){if(isFunction(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(isDate(r))return e.stylize(Date.prototype.toString.call(r),"date");if(isError(r))return formatError(r)}var c="",a=!1,l=["{","}"];if(isArray(r)&&(a=!0,l=["[","]"]),isFunction(r)){c=" [Function"+(r.name?": "+r.name:"")+"]"}if(isRegExp(r)&&(c=" "+RegExp.prototype.toString.call(r)),isDate(r)&&(c=" "+Date.prototype.toUTCString.call(r)),isError(r)&&(c=" "+formatError(r)),0===o.length&&(!a||0==r.length))return l[0]+c+l[1];if(t<0)return isRegExp(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");e.seen.push(r);var p;return p=a?formatArray(e,r,t,s,o):o.map(function(n){return formatProperty(e,r,t,s,n,a)}),e.seen.pop(),reduceToSingleString(p,c,l)}function formatPrimitive(e,r){if(isUndefined(r))return e.stylize("undefined","undefined");if(isString(r)){var t="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return isNumber(r)?e.stylize(""+r,"number"):isBoolean(r)?e.stylize(""+r,"boolean"):isNull(r)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,r,t,n,i){for(var o=[],s=0,u=r.length;s<u;++s)hasOwnProperty(r,String(s))?o.push(formatProperty(e,r,t,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,r,t,n,i,!0))}),o}function formatProperty(e,r,t,n,i,o){var s,u,c;if((c=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]}).get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(c.value)<0?(u=isNull(t)?formatValue(e,c.value,null):formatValue(e,c.value,t-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,r,t){var n=0;return e.reduce(function(e,r){return n++,r.indexOf("\n")>=0&&n++,e+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?t[0]+(""===r?"":r+"\n ")+" "+e.join(",\n  ")+" "+t[1]:t[0]+r+" "+e.join(", ")+" "+t[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}function timestamp(){var e=new Date,r=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],r].join(" ")}function hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var formatRegExp=/%[sdj%]/g;exports.format=function(e){if(!isString(e)){for(var r=[],t=0;t<arguments.length;t++)r.push(inspect(arguments[t]));return r.join(" ")}t=1;for(var n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(t>=i)return e;switch(e){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(e){return"[Circular]"}default:return e}}),s=n[t];t<i;s=n[++t])isNull(s)||!isObject(s)?o+=" "+s:o+=" "+inspect(s);return o},exports.deprecate=function(e,r){if(isUndefined(global.process))return function(){return exports.deprecate(e,r).apply(this,arguments)};if(!0===process.noDeprecation)return e;var t=!1;return function(){if(!t){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),t=!0}return e.apply(this,arguments)}};var debugEnviron,debugs={};exports.debuglog=function(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){var r=process.pid;debugs[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else debugs[e]=function(){};return debugs[e]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,r){if(!r||!isObject(r))return e;for(var t=Object.keys(r),n=t.length;n--;)e[t[n]]=r[t[n]];return e};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./support/isBuffer":315,"_process":313,"inherits":314}],317:[function(require,module,exports){
!function(e,t){"use strict";function i(e,i){return p[i]!==t?p[i].apply(e,Array.prototype.slice.call(arguments,2)):e}function s(e){var t=e.find(".bselect-option-list"),i=t.find("li:visible").length;t.innerHeight(1.5*parseInt(t.css("line-height"),10)*(i<5?i:5))}function n(t,s,n){var a=i(t,"element");e.each(s,function(t,i){if(n[t]!==i&&"size"===t){var s=e.map(h.slice(0),function(e){return"bselect-"+e}).join(" ");a.removeClass(s),h.indexOf(n.size)>-1&&a.addClass("bselect-"+n.size)}})}function a(t){i(t,"element").find(".bselect-message").text(e.bselect.i18n.noOptionsAvailable).show()}function l(t){if(38===t.keyCode||40===t.keyCode||13===t.keyCode){var i=e(this),s=i.is(".bselect-search-input");switch(t.keyCode){case 38:s?e(t.delegateTarget).find(".bselect-option:visible:last").focus():i.prevAll(".bselect-option:visible").eq(0).focus();break;case 40:s?e(t.delegateTarget).find(".bselect-option:visible:first").focus():i.nextAll(".bselect-option:visible").eq(0).focus();break;case 13:s||i.trigger("click")}return!1}}function o(t,s){var a,o,h,u,b,f=e(t);if(u=++r,h=e("<div class='bselect' />",{id:"bselect-"+u}),b=e("<div class='bselect-dropdown' />"),!0===s.searchInput){var v=e("<div class='bselect-search' />");e("<input type='text' class='bselect-search-input' />").attr({role:"combobox",tabindex:1,"aria-expanded":"false","aria-owns":"bselect-option-list-"+u}).appendTo(v),e("<span class='bselect-search-icon'><i class='icon-search' /></span>").appendTo(v),v.appendTo(b)}e("<div class='bselect-message' role='status' />").appendTo(b),e("<ul class='bselect-option-list' />").attr({id:"bselect-option-list-"+u,role:"listbox"}).appendTo(b),h.append(b).insertAfter(f),f.data(c,{options:s,element:h,open:!1}),n(f,e.bselect.defaults,s),i(f,"refresh"),f.bind("bselectselect",s.select),f.bind("bselectselected",s.selected),f.bind("bselectsearch",s.search),o=e("<span />").addClass("bselect-label").text(function(t){return i(t,"option","placeholder")||t.data("placeholder")||e.bselect.i18n.selectAnOption}(f)),a=e("<button type='button' />").addClass("bselect-caret").html("<span class='caret'></span>"),h.prepend(a).prepend(o),o.outerWidth(f.outerWidth()-a.outerWidth()),f.addClass("bselect-inaccessible"),d.push(f),h.find(".bselect-search-input").keyup(e.proxy(p.search,f)),h.on("click",".bselect-option",e.proxy(p.select,f)),h.on("click",".bselect-caret, .bselect-label",e.proxy(p.toggle,f)),h.on("keydown",".bselect-option, .bselect-search-input",l),f.bind("change.bselect",function(){var e=f.data(c).itemsMap[this.value];i(f,"select",e)}).trigger("change.bselect"),t.id&&e(document).on("click","label[for='"+t.id+"']",function(){return i(f,"show"),!1})}var r=0,c="bselect",d=[],h=["mini","small","large"],p={option:function(i,s){var a=this.data(c).options||{},l=e.extend({},a);return"string"==typeof i&&"_"!==i[0]?s===t?a[i]:(a[i]=s,n(this,l,a),this):(e.isPlainObject(i)&&(e.extend(a,i),n(this,l,a),this.data(c).options=a),a)},element:function(){return this.data(c).element},toggle:function(t){if(this[0].disabled)return this;var s=i(this,"element");if(t instanceof e.Event){var n=i(this,"option","showOn");if(e(t.target).is(".bselect-label")&&"both"!==n)return this}return s.find(".bselect-dropdown").is(":hidden")?i(this,"show"):i(this,"hide"),this},show:function(){var t=this.data(c);if(this[0].disabled||t.open)return this;var n,a,l=t.element,o=l.find(".bselect-dropdown");if(o.css("left","-9999em").show(),s(l),(a=l.find(".bselect-option.active")).length){var r=l.find(".bselect-option-list"),d=a.position().top,h=r.position().top;d-h<r.height()?r.scrollTop(0):r.scrollTop(d-h)}return o.hide().css("left","auto"),o.slideDown(i(this,"option","animationDuration")),this.data(c,e.extend(t,{open:!0})),l.addClass("open"),(n=l.find(".bselect-search-input").focus()).innerWidth(n.parent().width()-n.next().outerWidth()),l.find(".bselect-search-input").attr("aria-expanded","true"),this},hide:function(s){var n=this.data(c);if(this[0].disabled||!n.open)return this;var a=n.options,l=n.element;return s=s===t||s,this.data(c,e.extend(n,{open:!1})),l.find(".bselect-dropdown").slideUp(a.animationDuration),l.removeClass("open"),s&&a.clearSearchOnExit&&i(this,"clearSearch"),l.find(".bselect-search-input").attr("aria-expanded","false"),this},select:function(t){var s,n,a=i(this,"element");if(t instanceof e.Event)s=e(t.currentTarget);else if(!(s=a.find("li").eq(t)).length)return this;var l=a.find("li").removeClass("active").attr("aria-selected","false").index(s),o=this.find("option[value!='']").get(l);return this.trigger("bselectselect",[o]),n=s.addClass("active").data("value"),s.attr("aria-selected","true"),a.find(".bselect-label").text(s.text()),i(this,"hide"),this.val(n),this.trigger("bselectselected",[n,o]),this},search:function(t){if(this[0].disabled)return this;var n,l,o=i(this,"option"),r=t instanceof e.Event?t.target.value:t,c=i(this,"element");if(""===r&&i(this,"clearSearch"),t instanceof e.Event||c.find(".bselect-search").val(r),!(r===o.lastSearch||r.length<o.minSearchInput)){var d=e();for(n=c.find("li").hide(),l=0;l<n.length;l++)n[l].textContent.toLowerCase().indexOf(r.toLowerCase())>-1&&(d=d.add(e(n[l]).show()));return 0===d.length?a(this):c.find(".bselect-message").hide(),this.trigger("bselectsearch",[r,d]),s(n.end()),this}},clearSearch:function(){var e=i(this,"element");return e.find(".bselect-search-input").val(""),e.find("li").show(),e.find(".bselect-message").hide(),s(e),this},disable:function(){return this[0].disabled||(i(this,"element").addClass("disabled"),this.prop("disabled",!0)),this},enable:function(){return this[0].disabled&&(i(this,"element").removeClass("disabled"),this.prop("disabled",!1)),this},refresh:function(){var t=i(this,"element"),s=t.find(".bselect-option-list").empty(),n={},l=0;return t.toggleClass("disabled",this.prop("disabled")),this.find("option, > optgroup").each(function(){var t,i,a=e(this).is("option");a&&!this.value||(t=a?"bselect-option"+(e(this).closest("optgroup").length?" grouped":""):"bselect-option-group",i=e("<li />").attr({class:t,role:"option",tabindex:a?2:-1,"aria-selected":"false"}),a?(i.data("value",this.value),n[this.value]=l,i.html("<a href='#'>"+this.text+"</a>")):i.text(this.label),i.appendTo(s),l++)}),0===l&&a(this),this.data(c).itemsMap=n,this},destroy:function(){var e=i(this,"element");return this.data(c,null),d.splice(d.indexOf(this),1),e.remove(),this.show(),this}};e.fn.bselect=function(i){return"string"==typeof i&&this[0]?e.isPlainObject(e(this[0]).data(c))&&p[i]!==t?p[i].apply(e(this[0]),Array.prototype.slice.call(arguments,1)):this:this.each(function(){e.isPlainObject(e(this).data(c))||(i=e.isPlainObject(i)?i:{},o(this,i=e.extend({},e.bselect.defaults,i)))})},e.bselect={defaults:{size:"normal",showOn:"both",clearSearchOnExit:!0,minSearchInput:0,animationDuration:300,searchInput:!0,search:null,select:null,selected:null},i18n:{selectAnOption:"Select an option",noOptionsAvailable:"No options available."}},e(document).click(function(e){var t,s,n;for(t=0,s=d.length;t<s;t++)(n=d[t].data(c)).open&&!n.element.has(e.target).length&&i(d[t],"hide")}),e(window).resize(function(){var e,t,i,s;for(e=0,t=d.length;e<t;e++)s=(i=d[e].data(c)).element.find(".bselect-caret"),i.element.find(".bselect-label").outerWidth(d[e].outerWidth()-s.outerWidth())})}(jQuery);

},{}],318:[function(require,module,exports){
"use strict";function typedArraySupport(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}function createBuffer(e){if(e>K_MAX_LENGTH)throw new RangeError("Invalid typed array length");var t=new Uint8Array(e);return t.__proto__=Buffer.prototype,t}function Buffer(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(e)}return from(e,t,r)}function from(e,t,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return isArrayBuffer(e)||e&&isArrayBuffer(e.buffer)?fromArrayBuffer(e,t,r):"string"==typeof e?fromString(e,t):fromObject(e)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('"size" argument must not be negative')}function alloc(e,t,r){return assertSize(e),e<=0?createBuffer(e):void 0!==t?"string"==typeof r?createBuffer(e).fill(t,r):createBuffer(e).fill(t):createBuffer(e)}function allocUnsafe(e){return assertSize(e),createBuffer(e<0?0:0|checked(e))}function fromString(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|byteLength(e,t),n=createBuffer(r),f=n.write(e,t);return f!==r&&(n=n.slice(0,f)),n}function fromArrayLike(e){for(var t=e.length<0?0:0|checked(e.length),r=createBuffer(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function fromArrayBuffer(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),n.__proto__=Buffer.prototype,n}function fromObject(e){if(Buffer.isBuffer(e)){var t=0|checked(e.length),r=createBuffer(t);return 0===r.length?r:(e.copy(r,0,0,t),r)}if(e){if(ArrayBuffer.isView(e)||"length"in e)return"number"!=typeof e.length||numberIsNaN(e.length)?createBuffer(0):fromArrayLike(e);if("Buffer"===e.type&&Array.isArray(e.data))return fromArrayLike(e.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}function checked(e){if(e>=K_MAX_LENGTH)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer.alloc(+e)}function byteLength(e,t){if(Buffer.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||isArrayBuffer(e))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(n)return utf8ToBytes(e).length;t=(""+t).toLowerCase(),n=!0}}function slowToString(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,f){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,numberIsNaN(r)&&(r=f?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(f)return-1;r=e.length-1}else if(r<0){if(!f)return-1;r=0}if("string"==typeof t&&(t=Buffer.from(t,n)),Buffer.isBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,f);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,f);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,f){function i(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,u=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,u/=2,s/=2,r/=2}var a;if(f){var h=-1;for(a=r;a<u;a++)if(i(e,a)===i(t,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===s)return h*o}else-1!==h&&(a-=a-h),h=-1}else for(r+s>u&&(r=u-s),a=r;a>=0;a--){for(var c=!0,l=0;l<s;l++)if(i(e,a+l)!==i(t,l)){c=!1;break}if(c)return a}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;var f=e.length-r;n?(n=Number(n))>f&&(n=f):n=f;var i=t.length;n>i/2&&(n=i/2);for(var o=0;o<n;++o){var u=parseInt(t.substr(2*o,2),16);if(numberIsNaN(u))return o;e[r+o]=u}return o}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(asciiToBytes(t),e,r,n)}function latin1Write(e,t,r,n){return asciiWrite(e,t,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(utf16leToBytes(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return 0===t&&r===e.length?base64.fromByteArray(e):base64.fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var n=[],f=t;f<r;){var i=e[f],o=null,u=i>239?4:i>223?3:i>191?2:1;if(f+u<=r){var s,a,h,c;switch(u){case 1:i<128&&(o=i);break;case 2:128==(192&(s=e[f+1]))&&(c=(31&i)<<6|63&s)>127&&(o=c);break;case 3:s=e[f+1],a=e[f+2],128==(192&s)&&128==(192&a)&&(c=(15&i)<<12|(63&s)<<6|63&a)>2047&&(c<55296||c>57343)&&(o=c);break;case 4:s=e[f+1],a=e[f+2],h=e[f+3],128==(192&s)&&128==(192&a)&&128==(192&h)&&(c=(15&i)<<18|(63&s)<<12|(63&a)<<6|63&h)>65535&&c<1114112&&(o=c)}}null===o?(o=65533,u=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),f+=u}return decodeCodePointsArray(n)}function decodeCodePointsArray(e){var t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(e,t,r){var n="";r=Math.min(e.length,r);for(var f=t;f<r;++f)n+=String.fromCharCode(127&e[f]);return n}function latin1Slice(e,t,r){var n="";r=Math.min(e.length,r);for(var f=t;f<r;++f)n+=String.fromCharCode(e[f]);return n}function hexSlice(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var f="",i=t;i<r;++i)f+=toHex(e[i]);return f}function utf16leSlice(e,t,r){for(var n=e.slice(t,r),f="",i=0;i<n.length;i+=2)f+=String.fromCharCode(n[i]+256*n[i+1]);return f}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,f,i){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>f||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function checkIEEE754(e,t,r,n,f,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,f){return t=+t,r>>>=0,f||checkIEEE754(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,f){return t=+t,r>>>=0,f||checkIEEE754(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(e,t,r,n,52,8),r+8}function base64clean(e){if(e=e.split("=")[0],(e=e.trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){t=t||1/0;for(var r,n=e.length,f=null,i=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!f){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}f=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),f=r;continue}r=65536+(f-55296<<10|r-56320)}else f&&(t-=3)>-1&&i.push(239,191,189);if(f=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function utf16leToBytes(e,t){for(var r,n,f,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,f=r%256,i.push(f),i.push(n);return i}function base64ToBytes(e){return base64.toByteArray(base64clean(e))}function blitBuffer(e,t,r,n){for(var f=0;f<n&&!(f+r>=t.length||f>=e.length);++f)t[f+r]=e[f];return f}function isArrayBuffer(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function numberIsNaN(e){return e!=e}var base64=require("base64-js"),ieee754=require("ieee754");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{get:function(){if(this instanceof Buffer)return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{get:function(){if(this instanceof Buffer)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(e,t,r){return from(e,t,r)},Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(e,t,r){return alloc(e,t,r)},Buffer.allocUnsafe=function(e){return allocUnsafe(e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)},Buffer.isBuffer=function(e){return null!=e&&!0===e._isBuffer},Buffer.compare=function(e,t){if(!Buffer.isBuffer(e)||!Buffer.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,f=0,i=Math.min(r,n);f<i;++f)if(e[f]!==t[f]){r=e[f],n=t[f];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Buffer.allocUnsafe(t),f=0;for(r=0;r<e.length;++r){var i=e[r];if(ArrayBuffer.isView(i)&&(i=Buffer.from(i)),!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,f),f+=i.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function(){var e="",t=exports.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},Buffer.prototype.compare=function(e,t,r,n,f){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===f&&(f=this.length),t<0||r>e.length||n<0||f>this.length)throw new RangeError("out of range index");if(n>=f&&t>=r)return 0;if(n>=f)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,f>>>=0,this===e)return 0;for(var i=f-n,o=r-t,u=Math.min(i,o),s=this.slice(n,f),a=e.slice(t,r),h=0;h<u;++h)if(s[h]!==a[h]){i=s[h],o=a[h];break}return i<o?-1:o<i?1:0},Buffer.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer.prototype.indexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer.prototype.lastIndexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var f=this.length-t;if((void 0===r||r>f)&&(r=f),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return latin1Write(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=Buffer.prototype,n},Buffer.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e],f=1,i=0;++i<t&&(f*=256);)n+=this[e+i]*f;return n},Buffer.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e+--t],f=1;t>0&&(f*=256);)n+=this[e+--t]*f;return n},Buffer.prototype.readUInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e],f=1,i=0;++i<t&&(f*=256);)n+=this[e+i]*f;return f*=128,n>=f&&(n-=Math.pow(2,8*t)),n},Buffer.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=t,f=1,i=this[e+--n];n>0&&(f*=256);)i+=this[e+--n]*f;return f*=128,i>=f&&(i-=Math.pow(2,8*t)),i},Buffer.prototype.readInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer.prototype.readInt16LE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),ieee754.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),ieee754.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),ieee754.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),ieee754.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){checkInt(this,e,t,r,Math.pow(2,8*r)-1,0)}var f=1,i=0;for(this[t]=255&e;++i<r&&(f*=256);)this[t+i]=e/f&255;return t+r},Buffer.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){checkInt(this,e,t,r,Math.pow(2,8*r)-1,0)}var f=r-1,i=1;for(this[t+f]=255&e;--f>=0&&(i*=256);)this[t+f]=e/i&255;return t+r},Buffer.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,255,0),this[t]=255&e,t+1},Buffer.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},Buffer.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,e,t,r,f-1,-f)}var i=0,o=1,u=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+r},Buffer.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,e,t,r,f-1,-f)}var i=r-1,o=1,u=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+r},Buffer.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},Buffer.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer.prototype.writeFloatLE=function(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer.prototype.writeFloatBE=function(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer.prototype.writeDoubleLE=function(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer.prototype.writeDoubleBE=function(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer.prototype.copy=function(e,t,r,n){if(!Buffer.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var f=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var i=f-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return f},Buffer.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var f=e.charCodeAt(0);("utf8"===n&&f<128||"latin1"===n)&&(e=f)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var i;if("number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var o=Buffer.isBuffer(e)?e:new Buffer(e,n),u=o.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%u]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;

},{"base64-js":221,"ieee754":323}],319:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;

}).call(this,{"isBuffer":require("../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js")})

},{"../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js":311}],320:[function(require,module,exports){
!function(){function n(n){return n&&(n.ownerDocument||n.document||n).documentElement}function t(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function e(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function r(n){return null===n?NaN:+n}function i(n){return!isNaN(n)}function u(n){return{left:function(t,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);r<i;){var u=r+i>>>1;n(t[u],e)<0?r=u+1:i=u}return r},right:function(t,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);r<i;){var u=r+i>>>1;n(t[u],e)>0?i=u:r=u+1}return r}}}function o(n){return n.length}function a(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function l(){this._=Object.create(null)}function c(n){return(n+="")===uu||n[0]===ou?ou+n:n}function f(n){return(n+="")[0]===ou?n.slice(1):n}function s(n){return c(n)in this._}function h(n){return(n=c(n))in this._&&delete this._[n]}function p(){var n=[];for(var t in this._)n.push(f(t));return n}function g(){var n=0;for(var t in this._)++n;return n}function v(){for(var n in this._)return!1;return!0}function d(){this._=Object.create(null)}function y(n){return n}function m(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=au.length;e<r;++e){var i=au[e]+t;if(i in n)return i}}function M(){}function x(){}function b(n){function t(){for(var t,r=e,i=-1,u=r.length;++i<u;)(t=r[i].on)&&t.apply(this,arguments);return n}var e=[],r=new l;return t.on=function(t,i){var u,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,u=e.indexOf(o)).concat(e.slice(u+1)),r.remove(t)),i&&e.push(r.set(t,{on:i})),n)},t}function _(){Bi.event.preventDefault()}function w(){for(var n,t=Bi.event;n=t.sourceEvent;)t=n;return t}function S(n){for(var t=new x,e=0,r=arguments.length;++e<r;)t[arguments[e]]=b(t);return t.of=function(e,r){return function(i){try{var u=i.sourceEvent=Bi.event;i.target=n,Bi.event=i,t[i.type].apply(e,r)}finally{Bi.event=u}}},t}function k(n){return cu(n,pu),n}function N(n){return"function"==typeof n?n:function(){return fu(n,this)}}function E(n){return"function"==typeof n?n:function(){return su(n,this)}}function A(n,t){return n=Bi.ns.qualify(n),null==t?n.local?function(){this.removeAttributeNS(n.space,n.local)}:function(){this.removeAttribute(n)}:"function"==typeof t?n.local?function(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}:function(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}:n.local?function(){this.setAttributeNS(n.space,n.local,t)}:function(){this.setAttribute(n,t)}}function C(n){return n.trim().replace(/\s+/g," ")}function z(n){return new RegExp("(?:^|\\s+)"+Bi.requote(n)+"(?:\\s+|$)","g")}function L(n){return(n+"").trim().split(/^|\s+/)}function q(n,t){var e=(n=L(n).map(T)).length;return"function"==typeof t?function(){for(var r=-1,i=t.apply(this,arguments);++r<e;)n[r](this,i)}:function(){for(var r=-1;++r<e;)n[r](this,t)}}function T(n){var t=z(n);return function(e,r){if(i=e.classList)return r?i.add(n):i.remove(n);var i=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(i)||e.setAttribute("class",C(i+" "+n))):e.setAttribute("class",C(i.replace(t," ")))}}function R(n,t,e){return null==t?function(){this.style.removeProperty(n)}:"function"==typeof t?function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}:function(){this.style.setProperty(n,t,e)}}function D(n,t){return null==t?function(){delete this[n]}:"function"==typeof t?function(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}:function(){this[n]=t}}function P(n){return"function"==typeof n?n:(n=Bi.ns.qualify(n)).local?function(){return this.ownerDocument.createElementNS(n.space,n.local)}:function(){var t=this.ownerDocument,e=this.namespaceURI;return e===gu&&t.documentElement.namespaceURI===gu?t.createElement(n):t.createElementNS(e,n)}}function U(){var n=this.parentNode;n&&n.removeChild(this)}function j(n){return{__data__:n}}function F(n){return function(){return hu(this,n)}}function H(n,t){for(var e=0,r=n.length;e<r;e++)for(var i,u=n[e],o=0,a=u.length;o<a;o++)(i=u[o])&&t(i,o,e);return n}function O(n){return cu(n,du),n}function I(n,t,e){function r(){var t=this[i];t&&(this.removeEventListener(n,t,t.$),delete this[i])}var i="__on"+n,u=n.indexOf("."),o=Y;u>0&&(n=n.slice(0,u));var a=yu.get(n);return a&&(n=a,o=Z),u?t?function(){var u=o(t,Ji(arguments));r.call(this),this.addEventListener(n,this[i]=u,u.$=e),u._=t}:r:t?M:function(){var t,e=new RegExp("^__on([^.]+)"+Bi.requote(n)+"$");for(var r in this)if(t=r.match(e)){var i=this[r];this.removeEventListener(t[1],i,i.$),delete this[r]}}}function Y(n,t){return function(e){var r=Bi.event;Bi.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{Bi.event=r}}}function Z(n,t){var e=Y(n,t);return function(n){var t=n.relatedTarget;t&&(t===this||8&t.compareDocumentPosition(this))||e.call(this,n)}}function V(e){var r=".dragsuppress-"+ ++Mu,i="click"+r,u=Bi.select(t(e)).on("touchmove"+r,_).on("dragstart"+r,_).on("selectstart"+r,_);if(null==mu&&(mu=!("onselectstart"in e)&&m(e.style,"userSelect")),mu){var o=n(e).style,a=o[mu];o[mu]="none"}return function(n){if(u.on(r,null),mu&&(o[mu]=a),n){var t=function(){u.on(i,null)};u.on(i,function(){_(),t()},!0),setTimeout(t,0)}}}function X(n,e){e.changedTouches&&(e=e.changedTouches[0]);var r=n.ownerSVGElement||n;if(r.createSVGPoint){var i=r.createSVGPoint();if(xu<0){var u=t(n);if(u.scrollX||u.scrollY){var o=(r=Bi.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();xu=!(o.f||o.e),r.remove()}}return xu?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}var a=n.getBoundingClientRect();return[e.clientX-a.left-n.clientLeft,e.clientY-a.top-n.clientTop]}function $(){return Bi.event.changedTouches[0].identifier}function B(n){return n>0?1:n<0?-1:0}function W(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function J(n){return n>1?0:n<-1?wu:Math.acos(n)}function G(n){return n>1?Nu:n<-1?-Nu:Math.asin(n)}function K(n){return((n=Math.exp(n))+1/n)/2}function Q(n){return(n=Math.sin(n/2))*n}function nn(){}function tn(n,t,e){return this instanceof tn?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof tn?new tn(n.h,n.s,n.l):dn(""+n,yn,tn):new tn(n,t,e)}function en(n,t,e){function r(n){return Math.round(255*function(n){return n>360?n-=360:n<0&&(n+=360),n<60?i+(u-i)*n/60:n<180?u:n<240?i+(u-i)*(240-n)/60:i}(n))}var i,u;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:t<0?0:t>1?1:t,e=e<0?0:e>1?1:e,u=e<=.5?e*(1+t):e+t-e*t,i=2*e-u,new hn(r(n+120),r(n),r(n-120))}function rn(n,t,e){return this instanceof rn?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof rn?new rn(n.h,n.c,n.l):n instanceof on?ln(n.l,n.a,n.b):ln((n=mn((n=Bi.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new rn(n,t,e)}function un(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new on(e,Math.cos(n*=Eu)*t,Math.sin(n)*t)}function on(n,t,e){return this instanceof on?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof on?new on(n.l,n.a,n.b):n instanceof rn?un(n.h,n.c,n.l):mn((n=hn(n)).r,n.g,n.b):new on(n,t,e)}function an(n,t,e){var r=(n+16)/116,i=r+t/500,u=r-e/200;return i=cn(i)*Pu,r=cn(r)*Uu,u=cn(u)*ju,new hn(sn(3.2404542*i-1.5371385*r-.4985314*u),sn(-.969266*i+1.8760108*r+.041556*u),sn(.0556434*i-.2040259*r+1.0572252*u))}function ln(n,t,e){return n>0?new rn(Math.atan2(e,t)*Au,Math.sqrt(t*t+e*e),n):new rn(NaN,NaN,n)}function cn(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function fn(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function sn(n){return Math.round(255*(n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function hn(n,t,e){return this instanceof hn?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof hn?new hn(n.r,n.g,n.b):dn(""+n,hn,en):new hn(n,t,e)}function pn(n){return new hn(n>>16,n>>8&255,255&n)}function gn(n){return pn(n)+""}function vn(n){return n<16?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function dn(n,t,e){var r,i,u,o=0,a=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(n=n.toLowerCase()))switch(i=r[2].split(","),r[1]){case"hsl":return e(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return t(xn(i[0]),xn(i[1]),xn(i[2]))}return(u=Ou.get(n))?t(u.r,u.g,u.b):(null==n||"#"!==n.charAt(0)||isNaN(u=parseInt(n.slice(1),16))||(4===n.length?(o=(3840&u)>>4,o|=o>>4,a=240&u,a|=a>>4,l=15&u,l|=l<<4):7===n.length&&(o=(16711680&u)>>16,a=(65280&u)>>8,l=255&u)),t(o,a,l))}function yn(n,t,e){var r,i,u=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-u,l=(o+u)/2;return a?(i=l<.5?a/(o+u):a/(2-o-u),r=n==o?(t-e)/a+(t<e?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=NaN,i=l>0&&l<1?0:r),new tn(r,i,l)}function mn(n,t,e){var r=fn((.4124564*(n=Mn(n))+.3575761*(t=Mn(t))+.1804375*(e=Mn(e)))/Pu),i=fn((.2126729*n+.7151522*t+.072175*e)/Uu);return on(116*i-16,500*(r-i),200*(i-fn((.0193339*n+.119192*t+.9503041*e)/ju)))}function Mn(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function xn(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function bn(n){return"function"==typeof n?n:function(){return n}}function _n(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),wn(t,e,n,r)}}function wn(n,t,e,r){function i(){var n,t=l.status;if(!t&&function(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}(l)||t>=200&&t<300||304===t){try{n=e.call(u,l)}catch(n){return void o.error.call(u,n)}o.load.call(u,n)}else o.error.call(u,l)}var u={},o=Bi.dispatch("beforesend","progress","load","error"),a={},l=new XMLHttpRequest,c=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(n)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=i:l.onreadystatechange=function(){l.readyState>3&&i()},l.onprogress=function(n){var t=Bi.event;Bi.event=n;try{o.progress.call(u,l)}finally{Bi.event=t}},u.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",u)},u.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",u):t},u.responseType=function(n){return arguments.length?(c=n,u):c},u.response=function(n){return e=n,u},["get","post"].forEach(function(n){u[n]=function(){return u.send.apply(u,[n].concat(Ji(arguments)))}}),u.send=function(e,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),l.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),l.setRequestHeader)for(var f in a)l.setRequestHeader(f,a[f]);return null!=t&&l.overrideMimeType&&l.overrideMimeType(t),null!=c&&(l.responseType=c),null!=i&&u.on("error",i).on("load",function(n){i(null,n)}),o.beforesend.call(u,l),l.send(null==r?null:r),u},u.abort=function(){return l.abort(),u},Bi.rebind(u,o,"on"),null==r?u:u.get(function(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}(r))}function Sn(n,t,e){var r=arguments.length;r<2&&(t=0),r<3&&(e=Date.now());var i={c:n,t:e+t,n:null};return Yu?Yu.n=i:Iu=i,Yu=i,Zu||(Vu=clearTimeout(Vu),Zu=1,Xu(kn)),i}function kn(){var n=Nn(),t=En()-n;t>24?(isFinite(t)&&(clearTimeout(Vu),Vu=setTimeout(kn,t)),Zu=0):(Zu=1,Xu(kn))}function Nn(){for(var n=Date.now(),t=Iu;t;)n>=t.t&&t.c(n-t.t)&&(t.c=null),t=t.n;return n}function En(){for(var n,t=Iu,e=1/0;t;)t.c?(t.t<e&&(e=t.t),t=(n=t).n):t=n?n.n=t.n:Iu=t.n;return Yu=n,e}function An(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Cn(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function zn(n,t,e){function r(t){var e=n(t),r=u(e,1);return t-e<r-t?e:r}function i(e){return t(e=n(new Gu(e-1)),1),e}function u(n,e){return t(n=new Gu(+n),e),n}function o(n,r,u){var o=i(n),a=[];if(u>1)for(;o<r;)e(o)%u||a.push(new Date(+o)),t(o,1);else for(;o<r;)a.push(new Date(+o)),t(o,1);return a}n.floor=n,n.round=r,n.ceil=i,n.offset=u,n.range=o;var a=n.utc=Ln(n);return a.floor=a,a.round=Ln(r),a.ceil=Ln(i),a.offset=Ln(u),a.range=function(n,t,e){try{Gu=Cn;var r=new Cn;return r._=n,o(r,t,e)}finally{Gu=Date}},n}function Ln(n){return function(t,e){try{Gu=Cn;var r=new Cn;return r._=t,n(r,e)._}finally{Gu=Date}}}function qn(n,t,e){var r=n<0?"-":"",i=(r?-n:n)+"",u=i.length;return r+(u<e?new Array(e-u+1).join(t)+i:i)}function Tn(n){return new RegExp("^(?:"+n.map(Bi.requote).join("|")+")","i")}function Rn(n){for(var t=new l,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function Dn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Pn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function Un(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function jn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Fn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+2));return r?(n.y=function(n){return n+(n>68?1900:2e3)}(+r[0]),e+r[0].length):-1}function Hn(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function On(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function In(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function Yn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function Zn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function Vn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function Xn(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function $n(n,t,e){no.lastIndex=0;var r=no.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function Bn(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=iu(t)/60|0,i=iu(t)%60;return e+qn(r,"0",2)+qn(i,"0",2)}function Wn(n,t,e){to.lastIndex=0;var r=to.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function Jn(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function Gn(){}function Kn(n,t,e){var r=e.s=n+t,i=r-n,u=r-i;e.t=n-u+(t-i)}function Qn(n,t){n&&uo.hasOwnProperty(n.type)&&uo[n.type](n,t)}function nt(n,t,e){var r,i=-1,u=n.length-e;for(t.lineStart();++i<u;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function tt(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)nt(n[e],t,1);t.polygonEnd()}function et(){function n(n,t){t=t*Eu/2+wu/4;var e=(n*=Eu)-r,o=e>=0?1:-1,a=o*e,l=Math.cos(t),c=Math.sin(t),f=u*c,s=i*l+f*Math.cos(a),h=f*o*Math.sin(a);ao.add(Math.atan2(h,s)),r=n,i=l,u=c}var t,e,r,i,u;lo.point=function(o,a){lo.point=n,r=(t=o)*Eu,i=Math.cos(a=(e=a)*Eu/2+wu/4),u=Math.sin(a)},lo.lineEnd=function(){n(t,e)}}function rt(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function it(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function ut(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function ot(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function at(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function lt(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function ct(n){return[Math.atan2(n[1],n[0]),G(n[2])]}function ft(n,t){return iu(n[0]-t[0])<bu&&iu(n[1]-t[1])<bu}function st(n,t){n*=Eu;var e=Math.cos(t*=Eu);ht(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function ht(n,t,e){so+=(n-so)/++co,ho+=(t-ho)/co,po+=(e-po)/co}function pt(){function n(n,i){n*=Eu;var u=Math.cos(i*=Eu),o=u*Math.cos(n),a=u*Math.sin(n),l=Math.sin(i),c=Math.atan2(Math.sqrt((c=e*l-r*a)*c+(c=r*o-t*l)*c+(c=t*a-e*o)*c),t*o+e*a+r*l);fo+=c,go+=c*(t+(t=o)),vo+=c*(e+(e=a)),yo+=c*(r+(r=l)),ht(t,e,r)}var t,e,r;bo.point=function(i,u){i*=Eu;var o=Math.cos(u*=Eu);t=o*Math.cos(i),e=o*Math.sin(i),r=Math.sin(u),bo.point=n,ht(t,e,r)}}function gt(){bo.point=st}function vt(){function n(n,t){n*=Eu;var e=Math.cos(t*=Eu),o=e*Math.cos(n),a=e*Math.sin(n),l=Math.sin(t),c=i*l-u*a,f=u*o-r*l,s=r*a-i*o,h=Math.sqrt(c*c+f*f+s*s),p=r*o+i*a+u*l,g=h&&-J(p)/h,v=Math.atan2(h,p);mo+=g*c,Mo+=g*f,xo+=g*s,fo+=v,go+=v*(r+(r=o)),vo+=v*(i+(i=a)),yo+=v*(u+(u=l)),ht(r,i,u)}var t,e,r,i,u;bo.point=function(o,a){t=o,e=a,bo.point=n,o*=Eu;var l=Math.cos(a*=Eu);r=l*Math.cos(o),i=l*Math.sin(o),u=Math.sin(a),ht(r,i,u)},bo.lineEnd=function(){n(t,e),bo.lineEnd=gt,bo.point=st}}function dt(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return(e=t.invert(e,r))&&n.invert(e[0],e[1])}),e}function yt(){return!0}function mt(n,t,e,r,i){var u=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(ft(e,r)){i.lineStart();for(var a=0;a<t;++a)i.point((e=n[a])[0],e[1]);i.lineEnd()}else{var l=new xt(e,n,null,!0),c=new xt(e,null,l,!1);l.o=c,u.push(l),o.push(c),c=new xt(r,null,l=new xt(r,n,null,!1),!0),l.o=c,u.push(l),o.push(c)}}}),o.sort(t),Mt(u),Mt(o),u.length){for(var a=0,l=e,c=o.length;a<c;++a)o[a].e=l=!l;for(var f,s,h=u[0];;){for(var p=h,g=!0;p.v;)if((p=p.n)===h)return;f=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(a=0,c=f.length;a<c;++a)i.point((s=f[a])[0],s[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(g)for(a=(f=p.p.z).length-1;a>=0;--a)i.point((s=f[a])[0],s[1]);else r(p.x,p.p.x,-1,i);p=p.p}f=(p=p.o).z,g=!g}while(!p.v);i.lineEnd()}}}function Mt(n){if(t=n.length){for(var t,e,r=0,i=n[0];++r<t;)i.n=e=n[r],e.p=i,i=e;i.n=e=n[0],e.p=i}}function xt(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function bt(n,t,e,r){return function(i,u){function o(t,e){var r=i(t,e);n(t=r[0],e=r[1])&&u.point(t,e)}function a(n,t){var e=i(n,t);d.point(e[0],e[1])}function l(){m.point=a,d.lineStart()}function c(){m.point=o,d.lineEnd()}function f(n,t){v.push([n,t]);var e=i(n,t);x.point(e[0],e[1])}function s(){x.lineStart(),v=[]}function h(){f(v[0][0],v[0][1]),x.lineEnd();var n,t=x.clean(),e=M.buffer(),r=e.length;if(v.pop(),g.push(v),v=null,r)if(1&t){var i,o=-1;if((r=(n=e[0]).length-1)>0){for(b||(u.polygonStart(),b=!0),u.lineStart();++o<r;)u.point((i=n[o])[0],i[1]);u.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),p.push(e.filter(_t))}var p,g,v,d=t(u),y=i.invert(r[0],r[1]),m={point:o,lineStart:l,lineEnd:c,polygonStart:function(){m.point=f,m.lineStart=s,m.lineEnd=h,p=[],g=[]},polygonEnd:function(){m.point=o,m.lineStart=l,m.lineEnd=c,p=Bi.merge(p);var n=function(n,t){var e=n[0],r=n[1],i=[Math.sin(e),-Math.cos(e),0],u=0,o=0;ao.reset();for(var a=0,l=t.length;a<l;++a){var c=t[a],f=c.length;if(f)for(var s=c[0],h=s[0],p=s[1]/2+wu/4,g=Math.sin(p),v=Math.cos(p),d=1;;){d===f&&(d=0);var y=(n=c[d])[0],m=n[1]/2+wu/4,M=Math.sin(m),x=Math.cos(m),b=y-h,_=b>=0?1:-1,w=_*b,S=w>wu,k=g*M;if(ao.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),u+=S?b+_*Su:b,S^h>=e^y>=e){var N=ut(rt(s),rt(n));lt(N);var E=ut(i,N);lt(E);var A=(S^b>=0?-1:1)*G(E[2]);(r>A||r===A&&(N[0]||N[1]))&&(o+=S^b>=0?1:-1)}if(!d++)break;h=y,g=M,v=x,s=n}}return(u<-bu||u<bu&&ao<-bu)^1&o}(y,g);p.length?(b||(u.polygonStart(),b=!0),mt(p,St,n,e,u)):n&&(b||(u.polygonStart(),b=!0),u.lineStart(),e(null,null,1,u),u.lineEnd()),b&&(u.polygonEnd(),b=!1),p=g=null},sphere:function(){u.polygonStart(),u.lineStart(),e(null,null,1,u),u.lineEnd(),u.polygonEnd()}},M=wt(),x=t(M),b=!1;return m}}function _t(n){return n.length>1}function wt(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:M,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function St(n,t){return((n=n.x)[0]<0?n[1]-Nu-bu:Nu-n[1])-((t=t.x)[0]<0?t[1]-Nu-bu:Nu-t[1])}function kt(n,t,e,r){return function(i){var u,o=i.a,a=i.b,l=o.x,c=o.y,f=0,s=1,h=a.x-l,p=a.y-c;if(u=n-l,h||!(u>0)){if(u/=h,h<0){if(u<f)return;u<s&&(s=u)}else if(h>0){if(u>s)return;u>f&&(f=u)}if(u=e-l,h||!(u<0)){if(u/=h,h<0){if(u>s)return;u>f&&(f=u)}else if(h>0){if(u<f)return;u<s&&(s=u)}if(u=t-c,p||!(u>0)){if(u/=p,p<0){if(u<f)return;u<s&&(s=u)}else if(p>0){if(u>s)return;u>f&&(f=u)}if(u=r-c,p||!(u<0)){if(u/=p,p<0){if(u>s)return;u>f&&(f=u)}else if(p>0){if(u<f)return;u<s&&(s=u)}return f>0&&(i.a={x:l+f*h,y:c+f*p}),s<1&&(i.b={x:l+s*h,y:c+s*p}),i}}}}}}function Nt(n,t,e,r){function i(r,i){return iu(r[0]-n)<bu?i>0?0:3:iu(r[0]-e)<bu?i>0?2:1:iu(r[1]-t)<bu?i>0?1:0:i>0?3:2}function u(n,t){return o(n.x,t.x)}function o(n,t){var e=i(n,1),r=i(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function l(u,a,l,c){var f=0,s=0;if(null==u||(f=i(u,l))!==(s=i(a,l))||o(u,a)<0^l>0)do{c.point(0===f||3===f?n:e,f>1?r:t)}while((f=(f+l+4)%4)!==s);else c.point(a[0],a[1])}function c(i,u){return n<=i&&i<=e&&t<=u&&u<=r}function f(n,t){c(n,t)&&a.point(n,t)}function s(n,t){var e=c(n=Math.max(-wo,Math.min(wo,n)),t=Math.max(-wo,Math.min(wo,t)));if(p&&g.push([n,t]),b)v=n,d=t,y=e,b=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&x)a.point(n,t);else{var r={a:{x:m,y:M},b:{x:n,y:t}};k(r)?(x||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),_=!1):e&&(a.lineStart(),a.point(n,t),_=!1)}m=n,M=t,x=e}var h,p,g,v,d,y,m,M,x,b,_,w=a,S=wt(),k=kt(n,t,e,r),N={point:f,lineStart:function(){N.point=s,p&&p.push(g=[]),b=!0,x=!1,m=M=NaN},lineEnd:function(){h&&(s(v,d),y&&x&&S.rejoin(),h.push(S.buffer())),N.point=f,x&&a.lineEnd()},polygonStart:function(){a=S,h=[],p=[],_=!0},polygonEnd:function(){a=w,h=Bi.merge(h);var t=function(n){for(var t=0,e=p.length,r=n[1],i=0;i<e;++i)for(var u,o=1,a=p[i],l=a.length,c=a[0];o<l;++o)u=a[o],c[1]<=r?u[1]>r&&W(c,u,n)>0&&++t:u[1]<=r&&W(c,u,n)<0&&--t,c=u;return 0!==t}([n,r]),e=_&&t,i=h.length;(e||i)&&(a.polygonStart(),e&&(a.lineStart(),l(null,null,1,a),a.lineEnd()),i&&mt(h,u,t,l,a),a.polygonEnd()),h=p=g=null}};return N}}function Et(n){var t=0,e=wu/3,r=Ft(n),i=r(t,e);return i.parallels=function(n){return arguments.length?r(t=n[0]*wu/180,e=n[1]*wu/180):[t/wu*180,e/wu*180]},i}function At(n,t){function e(n,t){var e=Math.sqrt(u-2*i*Math.sin(t))/i;return[e*Math.sin(n*=i),o-e*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),o=Math.sqrt(u)/i;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/i,G((u-(n*n+e*e)*i*i)/(2*i))]},e}function Ct(){function n(n,t){ko+=i*n-r*t,r=n,i=t}var t,e,r,i;zo.point=function(u,o){zo.point=n,t=r=u,e=i=o},zo.lineEnd=function(){n(t,e)}}function zt(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function Lt(n,t){so+=n,ho+=t,++po}function qt(){function n(n,r){var i=n-t,u=r-e,o=Math.sqrt(i*i+u*u);go+=o*(t+n)/2,vo+=o*(e+r)/2,yo+=o,Lt(t=n,e=r)}var t,e;qo.point=function(r,i){qo.point=n,Lt(t=r,e=i)}}function Tt(){qo.point=Lt}function Rt(){function n(n,t){var e=n-r,u=t-i,o=Math.sqrt(e*e+u*u);go+=o*(r+n)/2,vo+=o*(i+t)/2,yo+=o,mo+=(o=i*n-r*t)*(r+n),Mo+=o*(i+t),xo+=3*o,Lt(r=n,i=t)}var t,e,r,i;qo.point=function(u,o){qo.point=n,Lt(t=r=u,e=i=o)},qo.lineEnd=function(){n(t,e)}}function Dt(n){function t(t){return(u?function(t){function r(e,r){e=n(e,r),t.point(e[0],e[1])}function i(){M=NaN,S.point=o,t.lineStart()}function o(r,i){var o=rt([r,i]),a=n(r,i);e(M,x,m,b,_,w,M=a[0],x=a[1],m=r,b=o[0],_=o[1],w=o[2],u,t),t.point(M,x)}function a(){S.point=r,t.lineEnd()}function l(){i(),S.point=c,S.lineEnd=f}function c(n,t){o(s=n,h=t),p=M,g=x,v=b,d=_,y=w,S.point=o}function f(){e(M,x,m,b,_,w,p,g,s,v,d,y,u,t),S.lineEnd=a,a()}var s,h,p,g,v,d,y,m,M,x,b,_,w,S={point:r,lineStart:i,lineEnd:a,polygonStart:function(){t.polygonStart(),S.lineStart=l},polygonEnd:function(){t.polygonEnd(),S.lineStart=i}};return S}:function(t){return Ut(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})})(t)}function e(t,u,o,a,l,c,f,s,h,p,g,v,d,y){var m=f-t,M=s-u,x=m*m+M*M;if(x>4*r&&d--){var b=a+p,_=l+g,w=c+v,S=Math.sqrt(b*b+_*_+w*w),k=Math.asin(w/=S),N=iu(iu(w)-1)<bu||iu(o-h)<bu?(o+h)/2:Math.atan2(_,b),E=n(N,k),A=E[0],C=E[1],z=A-t,L=C-u,q=M*z-m*L;(q*q/x>r||iu((m*z+M*L)/x-.5)>.3||a*p+l*g+c*v<i)&&(e(t,u,o,a,l,c,A,C,N,b/=S,_/=S,w,d,y),y.point(A,C),e(A,C,N,b,_,w,f,s,h,p,g,v,d,y))}}var r=.5,i=Math.cos(30*Eu),u=16;return t.precision=function(n){return arguments.length?(u=(r=n*n)>0&&16,t):Math.sqrt(r)},t}function Pt(n){this.stream=n}function Ut(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function jt(n){return Ft(function(){return n})()}function Ft(n){function t(n){return n=o(n[0]*Eu,n[1]*Eu),[n[0]*s+a,l-n[1]*s]}function e(){o=dt(u=Yt(d,m,M),i);var n=i(g,v);return a=h-n[0]*s,l=p+n[1]*s,r()}function r(){return c&&(c.valid=!1,c=null),t}var i,u,o,a,l,c,f=Dt(function(n,t){return n=i(n,t),[n[0]*s+a,l-n[1]*s]}),s=150,h=480,p=250,g=0,v=0,d=0,m=0,M=0,x=_o,b=y,_=null,w=null;return t.stream=function(n){return c&&(c.valid=!1),c=Ht(x(u,f(b(n)))),c.valid=!0,c},t.clipAngle=function(n){return arguments.length?(x=null==n?(_=n,_o):function(n){function t(n,t){return Math.cos(n)*Math.cos(t)>i}function e(n,t,e){var r=[1,0,0],u=ut(rt(n),rt(t)),o=it(u,u),a=u[0],l=o-a*a;if(!l)return!e&&n;var c=i*o/l,f=-i*a/l,s=ut(r,u),h=at(r,c);ot(h,at(u,f));var p=s,g=it(h,p),v=it(p,p),d=g*g-v*(it(h,h)-1);if(!(d<0)){var y=Math.sqrt(d),m=at(p,(-g-y)/v);if(ot(m,h),m=ct(m),!e)return m;var M,x=n[0],b=t[0],_=n[1],w=t[1];b<x&&(M=x,x=b,b=M);var S=b-x,k=iu(S-wu)<bu;if(!k&&w<_&&(M=_,_=w,w=M),k||S<bu?k?_+w>0^m[1]<(iu(m[0]-x)<bu?_:w):_<=m[1]&&m[1]<=w:S>wu^(x<=m[0]&&m[0]<=b)){var N=at(p,(-g+y)/v);return ot(N,h),[m,ct(N)]}}}function r(t,e){var r=u?n:wu-n,i=0;return t<-r?i|=1:t>r&&(i|=2),e<-r?i|=4:e>r&&(i|=8),i}var i=Math.cos(n),u=i>0,o=iu(i)>bu;return bt(t,function(n){var i,a,l,c,f;return{lineStart:function(){c=l=!1,f=1},point:function(s,h){var p,g=[s,h],v=t(s,h),d=u?v?0:r(s,h):v?r(s+(s<0?wu:-wu),h):0;if(!i&&(c=l=v)&&n.lineStart(),v!==l&&(p=e(i,g),(ft(i,p)||ft(g,p))&&(g[0]+=bu,g[1]+=bu,v=t(g[0],g[1]))),v!==l)f=0,v?(n.lineStart(),p=e(g,i),n.point(p[0],p[1])):(p=e(i,g),n.point(p[0],p[1]),n.lineEnd()),i=p;else if(o&&i&&u^v){var y;d&a||!(y=e(g,i,!0))||(f=0,u?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1])))}!v||i&&ft(i,g)||n.point(g[0],g[1]),i=g,l=v,a=d},lineEnd:function(){l&&n.lineEnd(),i=null},clean:function(){return f|(c&&l)<<1}}},$t(n,6*Eu),u?[0,-n]:[-wu,n-wu])}((_=+n)*Eu),r()):_},t.clipExtent=function(n){return arguments.length?(w=n,b=n?Nt(n[0][0],n[0][1],n[1][0],n[1][1]):y,r()):w},t.scale=function(n){return arguments.length?(s=+n,e()):s},t.translate=function(n){return arguments.length?(h=+n[0],p=+n[1],e()):[h,p]},t.center=function(n){return arguments.length?(g=n[0]%360*Eu,v=n[1]%360*Eu,e()):[g*Au,v*Au]},t.rotate=function(n){return arguments.length?(d=n[0]%360*Eu,m=n[1]%360*Eu,M=n.length>2?n[2]%360*Eu:0,e()):[d*Au,m*Au,M*Au]},Bi.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&function(n){return(n=o.invert((n[0]-a)/s,(l-n[1])/s))&&[n[0]*Au,n[1]*Au]},e()}}function Ht(n){return Ut(n,function(t,e){n.point(t*Eu,e*Eu)})}function Ot(n,t){return[n,t]}function It(n,t){return[n>wu?n-Su:n<-wu?n+Su:n,t]}function Yt(n,t,e){return n?t||e?dt(Vt(n),Xt(t,e)):Vt(n):t||e?Xt(t,e):It}function Zt(n){return function(t,e){return t+=n,[t>wu?t-Su:t<-wu?t+Su:t,e]}}function Vt(n){var t=Zt(n);return t.invert=Zt(-n),t}function Xt(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),f=c*r+a*i;return[Math.atan2(l*u-f*o,a*r-c*i),G(f*u+l*o)]}var r=Math.cos(n),i=Math.sin(n),u=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),f=c*u-l*o;return[Math.atan2(l*u+c*o,a*r+f*i),G(f*r-a*i)]},e}function $t(n,t){var e=Math.cos(n),r=Math.sin(n);return function(i,u,o,a){var l=o*t;null!=i?(i=Bt(e,i),u=Bt(e,u),(o>0?i<u:i>u)&&(i+=o*Su)):(i=n+o*Su,u=n-.5*l);for(var c,f=i;o>0?f>u:f<u;f-=l)a.point((c=ct([e,-r*Math.cos(f),-r*Math.sin(f)]))[0],c[1])}}function Bt(n,t){var e=rt(t);e[0]-=n,lt(e);var r=J(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-bu)%(2*Math.PI)}function Wt(n,t,e){var r=Bi.range(n,t-bu,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function Jt(n,t,e){var r=Bi.range(n,t-bu,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function Gt(n){return n.source}function Kt(n){return n.target}function Qt(n,t){function e(t,e){var r=Math.cos(t),i=Math.cos(e),u=n(r*i);return[u*i*Math.sin(t),u*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),i=t(r),u=Math.sin(i),o=Math.cos(i);return[Math.atan2(n*u,r*o),Math.asin(r&&e*u/r)]},e}function ne(n,t){function e(n,t){o>0?t<-Nu+bu&&(t=-Nu+bu):t>Nu-bu&&(t=Nu-bu);var e=o/Math.pow(i(t),u);return[e*Math.sin(u*n),o-e*Math.cos(u*n)]}var r=Math.cos(n),i=function(n){return Math.tan(wu/4+n/2)},u=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(i(t)/i(n)),o=r*Math.pow(i(n),u)/u;return u?(e.invert=function(n,t){var e=o-t,r=B(u)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/u,2*Math.atan(Math.pow(o/r,1/u))-Nu]},e):ee}function te(n,t){function e(n,t){var e=u-t;return[e*Math.sin(i*n),u-e*Math.cos(i*n)]}var r=Math.cos(n),i=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),u=r/i+n;return iu(i)<bu?Ot:(e.invert=function(n,t){var e=u-t;return[Math.atan2(n,e)/i,u-B(i)*Math.sqrt(n*n+e*e)]},e)}function ee(n,t){return[n,Math.log(Math.tan(wu/4+t/2))]}function re(n){var t,e=jt(n),r=e.scale,i=e.translate,u=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=i.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=u.apply(e,arguments);if(o===e){if(t=null==n){var a=wu*r(),l=i();u([[l[0]-a,l[1]-a],[l[0]+a,l[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function ie(n,t){return[Math.log(Math.tan(wu/4+t/2)),-n]}function ue(n){return n[0]}function oe(n){return n[1]}function ae(n){for(var t=n.length,e=[0,1],r=2,i=2;i<t;i++){for(;r>1&&W(n[e[r-2]],n[e[r-1]],n[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function le(n,t){return n[0]-t[0]||n[1]-t[1]}function ce(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function fe(n,t,e,r){var i=n[0],u=e[0],o=t[0]-i,a=r[0]-u,l=n[1],c=e[1],f=t[1]-l,s=r[1]-c,h=(a*(l-c)-s*(i-u))/(s*o-a*f);return[i+h*o,l+h*f]}function se(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function he(n){var t=Xo.pop()||new function(){Ee(this),this.edge=this.site=this.circle=null};return t.site=n,t}function pe(n){be(n),Yo.remove(n),Xo.push(n),Ee(n)}function ge(n){var t=n.circle,e=t.x,r=t.cy,i={x:e,y:r},u=n.P,o=n.N,a=[n];pe(n);for(var l=u;l.circle&&iu(e-l.circle.x)<bu&&iu(r-l.circle.cy)<bu;)u=l.P,a.unshift(l),pe(l),l=u;a.unshift(l),be(l);for(var c=o;c.circle&&iu(e-c.circle.x)<bu&&iu(r-c.circle.cy)<bu;)o=c.N,a.push(c),pe(c),c=o;a.push(c),be(c);var f,s=a.length;for(f=1;f<s;++f)c=a[f],l=a[f-1],Se(c.edge,l.site,c.site,i);l=a[0],(c=a[s-1]).edge=we(l.site,c.site,null,i),xe(l),xe(c)}function ve(n){for(var t,e,r,i,u=n.x,o=n.y,a=Yo._;a;)if((r=de(a,o)-u)>bu)a=a.L;else{if(!((i=u-function(n,t){var e=n.N;if(e)return de(e,t);var r=n.site;return r.y===t?r.x:1/0}(a,o))>bu)){r>-bu?(t=a.P,e=a):i>-bu?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var l=he(n);if(Yo.insert(t,l),t||e){if(t===e)return be(t),e=he(t.site),Yo.insert(l,e),l.edge=e.edge=we(t.site,l.site),xe(t),void xe(e);if(e){be(t),be(e);var c=t.site,f=c.x,s=c.y,h=n.x-f,p=n.y-s,g=e.site,v=g.x-f,d=g.y-s,y=2*(h*d-p*v),m=h*h+p*p,M=v*v+d*d,x={x:(d*m-p*M)/y+f,y:(h*M-v*m)/y+s};Se(e.edge,c,g,x),l.edge=we(c,n,null,x),e.edge=we(n,g,null,x),xe(t),xe(e)}else l.edge=we(t.site,l.site)}}function de(n,t){var e=n.site,r=e.x,i=e.y,u=i-t;if(!u)return r;var o=n.P;if(!o)return-1/0;var a=(e=o.site).x,l=e.y,c=l-t;if(!c)return a;var f=a-r,s=1/u-1/c,h=f/c;return s?(-h+Math.sqrt(h*h-2*s*(f*f/(-2*c)-l+c/2+i-u/2)))/s+r:(r+a)/2}function ye(n){this.site=n,this.edges=[]}function me(n){for(var t,e,r,i,u,o,a,l,c,f,s=n[0][0],h=n[1][0],p=n[0][1],g=n[1][1],v=Io,d=v.length;d--;)if((u=v[d])&&u.prepare())for(l=(a=u.edges).length,o=0;o<l;)r=(f=a[o].end()).x,i=f.y,t=(c=a[++o%l].start()).x,e=c.y,(iu(r-t)>bu||iu(i-e)>bu)&&(a.splice(o,0,new ke(function(n,t,e){var r=new _e(n,null);return r.a=t,r.b=e,Oo.push(r),r}(u.site,f,iu(r-s)<bu&&g-i>bu?{x:s,y:iu(t-s)<bu?e:g}:iu(i-g)<bu&&h-r>bu?{x:iu(e-g)<bu?t:h,y:g}:iu(r-h)<bu&&i-p>bu?{x:h,y:iu(t-h)<bu?e:p}:iu(i-p)<bu&&r-s>bu?{x:iu(e-p)<bu?t:s,y:p}:null),u.site,null)),++l)}function Me(n,t){return t.angle-n.angle}function xe(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,i=n.site,u=e.site;if(r!==u){var o=i.x,a=i.y,l=r.x-o,c=r.y-a,f=u.x-o,s=2*(l*(d=u.y-a)-c*f);if(!(s>=-_u)){var h=l*l+c*c,p=f*f+d*d,g=(d*h-c*p)/s,v=(l*p-f*h)/s,d=v+a,y=$o.pop()||new function(){Ee(this),this.x=this.y=this.arc=this.site=this.cy=null};y.arc=n,y.site=i,y.x=g+o,y.y=d+Math.sqrt(g*g+v*v),y.cy=d,n.circle=y;for(var m=null,M=Vo._;M;)if(y.y<M.y||y.y===M.y&&y.x<=M.x){if(!M.L){m=M.P;break}M=M.L}else{if(!M.R){m=M;break}M=M.R}Vo.insert(m,y),m||(Zo=y)}}}}function be(n){var t=n.circle;t&&(t.P||(Zo=t.N),Vo.remove(t),$o.push(t),Ee(t),n.circle=null)}function _e(n,t){this.l=n,this.r=t,this.a=this.b=null}function we(n,t,e,r){var i=new _e(n,t);return Oo.push(i),e&&Se(i,n,t,e),r&&Se(i,t,n,r),Io[n.i].edges.push(new ke(i,n,t)),Io[t.i].edges.push(new ke(i,t,n)),i}function Se(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function ke(n,t,e){var r=n.a,i=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function Ne(){this._=null}function Ee(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function Ae(n,t){var e=t,r=t.R,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function Ce(n,t){var e=t,r=t.L,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function ze(n){for(;n.L;)n=n.L;return n}function Le(n,t){var e,r,i,u=n.sort(qe).pop();for(Oo=[],Io=new Array(n.length),Yo=new Ne,Vo=new Ne;;)if(i=Zo,u&&(!i||u.y<i.y||u.y===i.y&&u.x<i.x))u.x===e&&u.y===r||(Io[u.i]=new ye(u),ve(u),e=u.x,r=u.y),u=n.pop();else{if(!i)break;ge(i.arc)}t&&(function(n){for(var t,e=Oo,r=kt(n[0][0],n[0][1],n[1][0],n[1][1]),i=e.length;i--;)(!function(n,t){var e=n.b;if(e)return!0;var r,i,u=n.a,o=t[0][0],a=t[1][0],l=t[0][1],c=t[1][1],f=n.l,s=n.r,h=f.x,p=f.y,g=s.x,v=s.y,d=(h+g)/2,y=(p+v)/2;if(v===p){if(d<o||d>=a)return;if(h>g){if(u){if(u.y>=c)return}else u={x:d,y:l};e={x:d,y:c}}else{if(u){if(u.y<l)return}else u={x:d,y:c};e={x:d,y:l}}}else if(r=(h-g)/(v-p),i=y-r*d,r<-1||r>1)if(h>g){if(u){if(u.y>=c)return}else u={x:(l-i)/r,y:l};e={x:(c-i)/r,y:c}}else{if(u){if(u.y<l)return}else u={x:(c-i)/r,y:c};e={x:(l-i)/r,y:l}}else if(p<v){if(u){if(u.x>=a)return}else u={x:o,y:r*o+i};e={x:a,y:r*a+i}}else{if(u){if(u.x<o)return}else u={x:a,y:r*a+i};e={x:o,y:r*o+i}}return n.a=u,n.b=e,!0}(t=e[i],n)||!r(t)||iu(t.a.x-t.b.x)<bu&&iu(t.a.y-t.b.y)<bu)&&(t.a=t.b=null,e.splice(i,1))}(t),me(t));var o={cells:Io,edges:Oo};return Yo=Vo=Oo=Io=null,o}function qe(n,t){return t.y-n.y||t.x-n.x}function Te(n){return n.x}function Re(n){return n.y}function De(n,t,e,r,i,u){if(!n(t,e,r,i,u)){var o=.5*(e+i),a=.5*(r+u),l=t.nodes;l[0]&&De(n,l[0],e,r,o,a),l[1]&&De(n,l[1],o,r,i,a),l[2]&&De(n,l[2],e,a,o,u),l[3]&&De(n,l[3],o,a,i,u)}}function Pe(n,t){n=Bi.rgb(n),t=Bi.rgb(t);var e=n.r,r=n.g,i=n.b,u=t.r-e,o=t.g-r,a=t.b-i;return function(n){return"#"+vn(Math.round(e+u*n))+vn(Math.round(r+o*n))+vn(Math.round(i+a*n))}}function Ue(n,t){var e,r={},i={};for(e in n)e in t?r[e]=He(n[e],t[e]):i[e]=n[e];for(e in t)e in n||(i[e]=t[e]);return function(n){for(e in r)i[e]=r[e](n);return i}}function je(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function Fe(n,t){var e,r,i,u=Wo.lastIndex=Jo.lastIndex=0,o=-1,a=[],l=[];for(n+="",t+="";(e=Wo.exec(n))&&(r=Jo.exec(t));)(i=r.index)>u&&(i=t.slice(u,i),a[o]?a[o]+=i:a[++o]=i),(e=e[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:je(e,r)})),u=Jo.lastIndex;return u<t.length&&(i=t.slice(u),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?(t=l[0].x,function(n){return t(n)+""}):function(){return t}:(t=l.length,function(n){for(var e,r=0;r<t;++r)a[(e=l[r]).i]=e.x(n);return a.join("")})}function He(n,t){for(var e,r=Bi.interpolators.length;--r>=0&&!(e=Bi.interpolators[r](n,t)););return e}function Oe(n,t){var e,r=[],i=[],u=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;e<a;++e)r.push(He(n[e],t[e]));for(;e<u;++e)i[e]=n[e];for(;e<o;++e)i[e]=t[e];return function(n){for(e=0;e<a;++e)i[e]=r[e](n);return i}}function Ie(n){return function(t){return 1-n(1-t)}}function Ye(n){return function(t){return.5*(t<.5?n(2*t):2-n(2-2*t))}}function Ze(n){return n*n}function Ve(n){return n*n*n}function Xe(n){return 1-Math.cos(n*Nu)}function $e(n){return Math.pow(2,10*(n-1))}function Be(n){return 1-Math.sqrt(1-n*n)}function We(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Je(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function Ge(n){var t=[n.a,n.b],e=[n.c,n.d],r=Qe(t),i=Ke(t,e),u=Qe(function(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}(e,t,-i))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Au,this.translate=[n.e,n.f],this.scale=[r,u],this.skew=u?Math.atan2(i,u)*Au:0}function Ke(n,t){return n[0]*t[0]+n[1]*t[1]}function Qe(n){var t=Math.sqrt(Ke(n,n));return t&&(n[0]/=t,n[1]/=t),t}function nr(n){return n.length?n.pop()+",":""}function tr(n,t){var e=[],r=[];return n=Bi.transform(n),t=Bi.transform(t),function(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var i=e.push("translate(",null,",",null,")");r.push({i:i-4,x:je(n[0],t[0])},{i:i-2,x:je(n[1],t[1])})}else(t[0]||t[1])&&e.push("translate("+t+")")}(n.translate,t.translate,e,r),function(n,t,e,r){n!==t?(n-t>180?t+=360:t-n>180&&(n+=360),r.push({i:e.push(nr(e)+"rotate(",null,")")-2,x:je(n,t)})):t&&e.push(nr(e)+"rotate("+t+")")}(n.rotate,t.rotate,e,r),function(n,t,e,r){n!==t?r.push({i:e.push(nr(e)+"skewX(",null,")")-2,x:je(n,t)}):t&&e.push(nr(e)+"skewX("+t+")")}(n.skew,t.skew,e,r),function(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var i=e.push(nr(e)+"scale(",null,",",null,")");r.push({i:i-4,x:je(n[0],t[0])},{i:i-2,x:je(n[1],t[1])})}else 1===t[0]&&1===t[1]||e.push(nr(e)+"scale("+t+")")}(n.scale,t.scale,e,r),n=t=null,function(n){for(var t,i=-1,u=r.length;++i<u;)e[(t=r[i]).i]=t.x(n);return e.join("")}}function er(n){for(var t=n.source,e=n.target,r=function(n,t){if(n===t)return n;var e=rr(n),r=rr(t),i=e.pop(),u=r.pop(),o=null;for(;i===u;)o=i,i=e.pop(),u=r.pop();return o}(t,e),i=[t];t!==r;)t=t.parent,i.push(t);for(var u=i.length;e!==r;)i.splice(u,0,e),e=e.parent;return i}function rr(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function ir(n){n.fixed|=2}function ur(n){n.fixed&=-7}function or(n){n.fixed|=4,n.px=n.x,n.py=n.y}function ar(n){n.fixed&=-5}function lr(n,t,e){var r=0,i=0;if(n.charge=0,!n.leaf)for(var u,o=n.nodes,a=o.length,l=-1;++l<a;)null!=(u=o[l])&&(lr(u,t,e),n.charge+=u.charge,r+=u.charge*u.cx,i+=u.charge*u.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var c=t*e[n.point.index];n.charge+=n.pointCharge=c,r+=c*n.point.x,i+=c*n.point.y}n.cx=r/n.charge,n.cy=i/n.charge}function cr(n,t){return Bi.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=vr,n}function fr(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(i=n.children)&&(r=i.length))for(var r,i;--r>=0;)e.push(i[r])}function sr(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(u=n.children)&&(i=u.length))for(var i,u,o=-1;++o<i;)e.push(u[o]);for(;null!=(n=r.pop());)t(n)}function hr(n){return n.children}function pr(n){return n.value}function gr(n,t){return t.value-n.value}function vr(n){return Bi.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function dr(n){return n.x}function yr(n){return n.y}function mr(n,t,e){n.y0=t,n.y=e}function Mr(n){return Bi.range(n.length)}function xr(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function br(n){for(var t,e=1,r=0,i=n[0][1],u=n.length;e<u;++e)(t=n[e][1])>i&&(r=e,i=t);return r}function _r(n){return n.reduce(wr,0)}function wr(n,t){return n+t[1]}function Sr(n,t){return kr(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function kr(n,t){for(var e=-1,r=+n[0],i=(n[1]-r)/t,u=[];++e<=t;)u[e]=i*e+r;return u}function Nr(n){return[Bi.min(n),Bi.max(n)]}function Er(n,t){return n.value-t.value}function Ar(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function Cr(n,t){n._pack_next=t,t._pack_prev=n}function zr(n,t){var e=t.x-n.x,r=t.y-n.y,i=n.r+t.r;return.999*i*i>e*e+r*r}function Lr(n){function t(n){f=Math.min(n.x-n.r,f),s=Math.max(n.x+n.r,s),h=Math.min(n.y-n.r,h),p=Math.max(n.y+n.r,p)}if((e=n.children)&&(c=e.length)){var e,r,i,u,o,a,l,c,f=1/0,s=-1/0,h=1/0,p=-1/0;if(e.forEach(qr),r=e[0],r.x=-r.r,r.y=0,t(r),c>1&&(i=e[1],i.x=i.r,i.y=0,t(i),c>2))for(Dr(r,i,u=e[2]),t(u),Ar(r,u),r._pack_prev=u,Ar(u,i),i=r._pack_next,o=3;o<c;o++){Dr(r,i,u=e[o]);var g=0,v=1,d=1;for(a=i._pack_next;a!==i;a=a._pack_next,v++)if(zr(a,u)){g=1;break}if(1==g)for(l=r._pack_prev;l!==a._pack_prev&&!zr(l,u);l=l._pack_prev,d++);g?(v<d||v==d&&i.r<r.r?Cr(r,i=a):Cr(r=l,i),o--):(Ar(r,u),i=u,t(u))}var y=(f+s)/2,m=(h+p)/2,M=0;for(o=0;o<c;o++)(u=e[o]).x-=y,u.y-=m,M=Math.max(M,u.r+Math.sqrt(u.x*u.x+u.y*u.y));n.r=M,e.forEach(Tr)}}function qr(n){n._pack_next=n._pack_prev=n}function Tr(n){delete n._pack_next,delete n._pack_prev}function Rr(n,t,e,r){var i=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,i)for(var u=-1,o=i.length;++u<o;)Rr(i[u],t,e,r)}function Dr(n,t,e){var r=n.r+e.r,i=t.x-n.x,u=t.y-n.y;if(r&&(i||u)){var o=t.r+e.r,a=i*i+u*u,l=.5+((r*=r)-(o*=o))/(2*a),c=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+l*i+c*u,e.y=n.y+l*u-c*i}else e.x=n.x+r,e.y=n.y}function Pr(n,t){return n.parent==t.parent?1:2}function Ur(n){var t=n.children;return t.length?t[0]:n.t}function jr(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Fr(n){var t=n.children;return t&&t.length?Fr(t[0]):n}function Hr(n){var t,e=n.children;return e&&(t=e.length)?Hr(e[t-1]):n}function Or(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Ir(n,t){var e=n.x+t[3],r=n.y+t[0],i=n.dx-t[1]-t[3],u=n.dy-t[0]-t[2];return i<0&&(e+=i/2,i=0),u<0&&(r+=u/2,u=0),{x:e,y:r,dx:i,dy:u}}function Yr(n){var t=n[0],e=n[n.length-1];return t<e?[t,e]:[e,t]}function Zr(n){return n.rangeExtent?n.rangeExtent():Yr(n.range())}function Vr(n,t){var e,r=0,i=n.length-1,u=n[r],o=n[i];return o<u&&(e=r,r=i,i=e,e=u,u=o,o=e),n[r]=t.floor(u),n[i]=t.ceil(o),n}function Xr(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:aa}function $r(n,t,e,r){function i(){var i=Math.min(n.length,t.length)>2?function(n,t,e,r){var i=[],u=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)i.push(e(n[o-1],n[o])),u.push(r(t[o-1],t[o]));return function(t){var e=Bi.bisect(n,t,1,a)-1;return u[e](i[e](t))}}:function(n,t,e,r){var i=e(n[0],n[1]),u=r(t[0],t[1]);return function(n){return u(i(n))}},l=r?function(n,t){return t=(t-=n=+n)||1/t,function(e){return Math.max(0,Math.min(1,(e-n)/t))}}:function(n,t){return t=(t-=n=+n)||1/t,function(e){return(e-n)/t}};return o=i(n,t,l,e),a=i(t,n,l,He),u}function u(n){return o(n)}var o,a;return u.invert=function(n){return a(n)},u.domain=function(t){return arguments.length?(n=t.map(Number),i()):n},u.range=function(n){return arguments.length?(t=n,i()):t},u.rangeRound=function(n){return u.range(n).interpolate(Je)},u.clamp=function(n){return arguments.length?(r=n,i()):r},u.interpolate=function(n){return arguments.length?(e=n,i()):e},u.ticks=function(t){return Gr(n,t)},u.tickFormat=function(t,e){return Kr(n,t,e)},u.nice=function(t){return Wr(n,t),i()},u.copy=function(){return $r(n,t,e,r)},i()}function Br(n,t){return Bi.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Wr(n,t){return Vr(n,Xr(Jr(n,t)[2])),Vr(n,Xr(Jr(n,t)[2])),n}function Jr(n,t){null==t&&(t=10);var e=Yr(n),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),u=t/r*i;return u<=.15?i*=10:u<=.35?i*=5:u<=.75&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function Gr(n,t){return Bi.range.apply(Bi,Jr(n,t))}function Kr(n,t,e){var r=Jr(n,t);if(e){var i=Bu.exec(e);if(i.shift(),"s"===i[8]){var u=Bi.formatPrefix(Math.max(iu(r[0]),iu(r[1])));return i[7]||(i[7]="."+Qr(u.scale(r[2]))),i[8]="f",e=Bi.format(i.join("")),function(n){return e(u.scale(n))+u.symbol}}i[7]||(i[7]="."+function(n,t){var e=Qr(t[2]);return n in la?Math.abs(e-Qr(Math.max(iu(t[0]),iu(t[1]))))+ +("e"!==n):e-2*("%"===n)}(i[8],r)),e=i.join("")}else e=",."+Qr(r[2])+"f";return Bi.format(e)}function Qr(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function ni(n,t,e,r){function i(n){return(e?Math.log(n<0?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function u(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(i(t))}return o.invert=function(t){return u(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(i)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(i)),o):t},o.nice=function(){var t=Vr(r.map(i),e?Math:fa);return n.domain(t),r=t.map(u),o},o.ticks=function(){var n=Yr(r),o=[],a=n[0],l=n[1],c=Math.floor(i(a)),f=Math.ceil(i(l)),s=t%1?2:t;if(isFinite(f-c)){if(e){for(;c<f;c++)for(var h=1;h<s;h++)o.push(u(c)*h);o.push(u(c))}else for(o.push(u(c));c++<f;)for(h=s-1;h>0;h--)o.push(u(c)*h);for(c=0;o[c]<a;c++);for(f=o.length;o[f-1]>l;f--);o=o.slice(c,f)}return o},o.tickFormat=function(n,e){if(!arguments.length)return ca;arguments.length<2?e=ca:"function"!=typeof e&&(e=Bi.format(e));var r=Math.max(1,t*n/o.ticks().length);return function(n){var o=n/u(Math.round(i(n)));return o*t<t-.5&&(o*=t),o<=r?e(n):""}},o.copy=function(){return ni(n.copy(),t,e,r)},Br(o,n)}function ti(n,t,e){function r(t){return n(i(t))}var i=ei(t),u=ei(1/t);return r.invert=function(t){return u(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(i)),r):e},r.ticks=function(n){return Gr(e,n)},r.tickFormat=function(n,t){return Kr(e,n,t)},r.nice=function(n){return r.domain(Wr(e,n))},r.exponent=function(o){return arguments.length?(i=ei(t=o),u=ei(1/t),n.domain(e.map(i)),r):t},r.copy=function(){return ti(n.copy(),t,e)},Br(r,n)}function ei(n){return function(t){return t<0?-Math.pow(-t,n):Math.pow(t,n)}}function ri(n,t){function e(e){return u[((i.get(e)||("range"===t.t?i.set(e,n.push(e)):NaN))-1)%u.length]}function r(t,e){return Bi.range(n.length).map(function(n){return t+e*n})}var i,u,o;return e.domain=function(r){if(!arguments.length)return n;n=[],i=new l;for(var u,o=-1,a=r.length;++o<a;)i.has(u=r[o])||i.set(u,n.push(u));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(u=n,o=0,t={t:"range",a:arguments},e):u},e.rangePoints=function(i,a){arguments.length<2&&(a=0);var l=i[0],c=i[1],f=n.length<2?(l=(l+c)/2,0):(c-l)/(n.length-1+a);return u=r(l+f*a/2,f),o=0,t={t:"rangePoints",a:arguments},e},e.rangeRoundPoints=function(i,a){arguments.length<2&&(a=0);var l=i[0],c=i[1],f=n.length<2?(l=c=Math.round((l+c)/2),0):(c-l)/(n.length-1+a)|0;return u=r(l+Math.round(f*a/2+(c-l-(n.length-1+a)*f)/2),f),o=0,t={t:"rangeRoundPoints",a:arguments},e},e.rangeBands=function(i,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=i[1]<i[0],f=i[c-0],s=(i[1-c]-f)/(n.length-a+2*l);return u=r(f+s*l,s),c&&u.reverse(),o=s*(1-a),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(i,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=i[1]<i[0],f=i[c-0],s=i[1-c],h=Math.floor((s-f)/(n.length-a+2*l));return u=r(f+Math.round((s-f-(n.length-a)*h)/2),h),c&&u.reverse(),o=Math.round(h*(1-a)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return o},e.rangeExtent=function(){return Yr(t.a[0])},e.copy=function(){return ri(n,t)},e.domain(n)}function ii(n,t){function u(){var e=0,r=t.length;for(a=[];++e<r;)a[e-1]=Bi.quantile(n,e/r);return o}function o(n){if(!isNaN(n=+n))return t[Bi.bisect(a,n)]}var a;return o.domain=function(t){return arguments.length?(n=t.map(r).filter(i).sort(e),u()):n},o.range=function(n){return arguments.length?(t=n,u()):t},o.quantiles=function(){return a},o.invertExtent=function(e){return(e=t.indexOf(e))<0?[NaN,NaN]:[e>0?a[e-1]:n[0],e<a.length?a[e]:n[n.length-1]]},o.copy=function(){return ii(n,t)},u()}function ui(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(u*(t-n))))]}function i(){return u=e.length/(t-n),o=e.length-1,r}var u,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],i()):[n,t]},r.range=function(n){return arguments.length?(e=n,i()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=t<0?NaN:t/u+n,[t,t+1/u]},r.copy=function(){return ui(n,t,e)},i()}function oi(n,t){function e(e){if(e<=e)return t[Bi.bisect(n,e)]}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return oi(n,t)},e}function ai(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Gr(n,t)},t.tickFormat=function(t,e){return Kr(n,t,e)},t.copy=function(){return ai(n)},t}function li(){return 0}function ci(n){return n.innerRadius}function fi(n){return n.outerRadius}function si(n){return n.startAngle}function hi(n){return n.endAngle}function pi(n){return n&&n.padAngle}function gi(n,t,e,r){return(n-e)*t-(t-r)*n>0?0:1}function vi(n,t,e,r,i){var u=n[0]-t[0],o=n[1]-t[1],a=(i?r:-r)/Math.sqrt(u*u+o*o),l=a*o,c=-a*u,f=n[0]+l,s=n[1]+c,h=t[0]+l,p=t[1]+c,g=(f+h)/2,v=(s+p)/2,d=h-f,y=p-s,m=d*d+y*y,M=e-r,x=f*p-h*s,b=(y<0?-1:1)*Math.sqrt(Math.max(0,M*M*m-x*x)),_=(x*y-d*b)/m,w=(-x*d-y*b)/m,S=(x*y+d*b)/m,k=(-x*d+y*b)/m,N=_-g,E=w-v,A=S-g,C=k-v;return N*N+E*E>A*A+C*C&&(_=S,w=k),[[_-l,w-c],[_*e/M,w*e/M]]}function di(n){function t(t){function o(){c.push("M",u(n(f),a))}for(var l,c=[],f=[],s=-1,h=t.length,p=bn(e),g=bn(r);++s<h;)i.call(this,l=t[s],s)?f.push([+p.call(this,l,s),+g.call(this,l,s)]):f.length&&(o(),f=[]);return f.length&&o(),c.length?c.join(""):null}var e=ue,r=oe,i=yt,u=yi,o=u.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(i=n,t):i},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?u=n:(u=da.get(n)||yi).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function yi(n){return n.length>1?n.join("L"):n+"Z"}function mi(n){return n.join("L")+"Z"}function Mi(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("V",(r=n[t])[1],"H",r[0]);return i.join("")}function xi(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r=n[t])[0],"V",r[1]);return i.join("")}function bi(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return yi(n);var e=n.length!=t.length,r="",i=n[0],u=n[1],o=t[0],a=o,l=1;if(e&&(r+="Q"+(u[0]-2*o[0]/3)+","+(u[1]-2*o[1]/3)+","+u[0]+","+u[1],i=n[1],l=2),t.length>1){a=t[1],u=n[l],l++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1];for(var c=2;c<t.length;c++,l++)u=n[l],a=t[c],r+="S"+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1]}if(e){var f=n[l];r+="Q"+(u[0]+2*a[0]/3)+","+(u[1]+2*a[1]/3)+","+f[0]+","+f[1]}return r}function _i(n,t){for(var e,r=[],i=(1-t)/2,u=n[0],o=n[1],a=1,l=n.length;++a<l;)e=u,u=o,o=n[a],r.push([i*(o[0]-e[0]),i*(o[1]-e[1])]);return r}function wi(n){if(n.length<3)return yi(n);var t=1,e=n.length,r=n[0],i=r[0],u=r[1],o=[i,i,i,(r=n[1])[0]],a=[u,u,u,r[1]],l=[i,",",u,"L",Si(Ma,o),",",Si(Ma,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),ki(l,o,a);return n.pop(),l.push("L",r),l.join("")}function Si(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function ki(n,t,e){n.push("C",Si(ya,t),",",Si(ya,e),",",Si(ma,t),",",Si(ma,e),",",Si(Ma,t),",",Si(Ma,e))}function Ni(n,t){return(t[1]-n[1])/(t[0]-n[0])}function Ei(n){for(var t,e,r,i,u=[],o=function(n){for(var t=0,e=n.length-1,r=[],i=n[0],u=n[1],o=r[0]=Ni(i,u);++t<e;)r[t]=(o+(o=Ni(i=u,u=n[t+1])))/2;return r[t]=o,r}(n),a=-1,l=n.length-1;++a<l;)t=Ni(n[a],n[a+1]),iu(t)<bu?o[a]=o[a+1]=0:(i=(e=o[a]/t)*e+(r=o[a+1]/t)*r)>9&&(i=3*t/Math.sqrt(i),o[a]=i*e,o[a+1]=i*r);for(a=-1;++a<=l;)i=(n[Math.min(l,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),u.push([i||0,o[a]*i||0]);return u}function Ai(n){for(var t,e,r,i=-1,u=n.length;++i<u;)e=(t=n[i])[0],r=t[1]-Nu,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Ci(n){function t(t){function l(){v.push("M",a(n(y),s),f,c(n(d.reverse()),s),"Z")}for(var h,p,g,v=[],d=[],y=[],m=-1,M=t.length,x=bn(e),b=bn(i),_=e===r?function(){return p}:bn(r),w=i===u?function(){return g}:bn(u);++m<M;)o.call(this,h=t[m],m)?(d.push([p=+x.call(this,h,m),g=+b.call(this,h,m)]),y.push([+_.call(this,h,m),+w.call(this,h,m)])):d.length&&(l(),d=[],y=[]);return d.length&&l(),v.length?v.join(""):null}var e=ue,r=ue,i=0,u=oe,o=yt,a=yi,l=a.key,c=a,f="L",s=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(i=u=n,t):u},t.y0=function(n){return arguments.length?(i=n,t):i},t.y1=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(l="function"==typeof n?a=n:(a=da.get(n)||yi).key,c=a.reverse||a,f=a.closed?"M":"L",t):l},t.tension=function(n){return arguments.length?(s=n,t):s},t}function zi(n){return n.radius}function Li(n){return[n.x,n.y]}function qi(){return 64}function Ti(){return"circle"}function Ri(n){var t=Math.sqrt(n/wu);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Di(n){return function(){var t,e,r;(t=this[n])&&(r=t[e=t.active])&&(r.timer.c=null,r.timer.t=NaN,--t.count?delete t[e]:delete this[n],t.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Pi(n,t,e){return cu(n,Na),n.namespace=t,n.id=e,n}function Ui(n,t,e,r){var i=n.id,u=n.namespace;return H(n,"function"==typeof e?function(n,o,a){n[u][i].tween.set(t,r(e.call(n,n.__data__,o,a)))}:(e=r(e),function(n){n[u][i].tween.set(t,e)}))}function ji(n){return null==n&&(n=""),function(){this.textContent=n}}function Fi(n){return null==n?"__transition__":"__transition_"+n+"__"}function Hi(n,t,e,r,i){function u(n){var t=v.delay;if(f.t=t+c,t<=n)return o(n-t);f.c=o}function o(e){var i=g.active,u=g[i];u&&(u.timer.c=null,u.timer.t=NaN,--g.count,delete g[i],u.event&&u.event.interrupt.call(n,n.__data__,u.index));for(var o in g)if(+o<r){var l=g[o];l.timer.c=null,l.timer.t=NaN,--g.count,delete g[o]}f.c=a,Sn(function(){return f.c&&a(e||1)&&(f.c=null,f.t=NaN),1},0,c),g.active=r,v.event&&v.event.start.call(n,n.__data__,t),p=[],v.tween.forEach(function(e,r){(r=r.call(n,n.__data__,t))&&p.push(r)}),h=v.ease,s=v.duration}function a(i){for(var u=i/s,o=h(u),a=p.length;a>0;)p[--a].call(n,o);if(u>=1)return v.event&&v.event.end.call(n,n.__data__,t),--g.count?delete g[r]:delete n[e],1}var c,f,s,h,p,g=n[e]||(n[e]={active:0,count:0}),v=g[r];v||(c=i.time,f=Sn(u,0,c),v=g[r]={tween:new l,time:c,timer:f,delay:i.delay,duration:i.duration,ease:i.ease,index:t},i=null,++g.count)}function Oi(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"})}function Ii(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"})}function Yi(n){return n.toISOString()}function Zi(n,t,e){function r(t){return n(t)}function i(n,e){var r=(n[1]-n[0])/e,i=Bi.bisect(Da,r);return i==Da.length?[t.year,Jr(n.map(function(n){return n/31536e6}),e)[2]]:i?t[r/Da[i-1]<Da[i]/r?i-1:i]:[ja,Jr(n,e)[2]]}return r.invert=function(t){return Vi(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(Vi)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,Vi(+e+1),t).length}var u=r.domain(),o=Yr(u),a=null==n?i(o,10):"number"==typeof n&&i(o,n);return a&&(n=a[0],t=a[1]),r.domain(Vr(u,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=Vi(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=Vi(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Yr(r.domain()),u=null==n?i(e,10):"number"==typeof n?i(e,n):!n.range&&[{range:n},t];return u&&(n=u[0],t=u[1]),n.range(e[0],Vi(+e[1]+1),t<1?1:t)},r.tickFormat=function(){return e},r.copy=function(){return Zi(n.copy(),t,e)},Br(r,n)}function Vi(n){return new Date(n)}function Xi(n){return JSON.parse(n.responseText)}function $i(n){var t=Gi.createRange();return t.selectNode(Gi.body),t.createContextualFragment(n.responseText)}var Bi={version:"3.5.17"},Wi=[].slice,Ji=function(n){return Wi.call(n)},Gi=this.document;if(Gi)try{Ji(Gi.documentElement.childNodes)[0].nodeType}catch(n){Ji=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),Gi)try{Gi.createElement("DIV").style.setProperty("opacity",0,"")}catch(n){var Ki=this.Element.prototype,Qi=Ki.setAttribute,nu=Ki.setAttributeNS,tu=this.CSSStyleDeclaration.prototype,eu=tu.setProperty;Ki.setAttribute=function(n,t){Qi.call(this,n,t+"")},Ki.setAttributeNS=function(n,t,e){nu.call(this,n,t,e+"")},tu.setProperty=function(n,t,e){eu.call(this,n,t+"",e)}}Bi.ascending=e,Bi.descending=function(n,t){return t<n?-1:t>n?1:t>=n?0:NaN},Bi.min=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r>=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&e>r&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&e>r&&(e=r)}return e},Bi.max=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r>=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&r>e&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&r>e&&(e=r)}return e},Bi.extent=function(n,t){var e,r,i,u=-1,o=n.length;if(1===arguments.length){for(;++u<o;)if(null!=(r=n[u])&&r>=r){e=i=r;break}for(;++u<o;)null!=(r=n[u])&&(e>r&&(e=r),i<r&&(i=r))}else{for(;++u<o;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=i=r;break}for(;++u<o;)null!=(r=t.call(n,n[u],u))&&(e>r&&(e=r),i<r&&(i=r))}return[e,i]},Bi.sum=function(n,t){var e,r=0,u=n.length,o=-1;if(1===arguments.length)for(;++o<u;)i(e=+n[o])&&(r+=e);else for(;++o<u;)i(e=+t.call(n,n[o],o))&&(r+=e);return r},Bi.mean=function(n,t){var e,u=0,o=n.length,a=-1,l=o;if(1===arguments.length)for(;++a<o;)i(e=r(n[a]))?u+=e:--l;else for(;++a<o;)i(e=r(t.call(n,n[a],a)))?u+=e:--l;if(l)return u/l},Bi.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),i=+n[r-1],u=e-r;return u?i+u*(n[r]-i):i},Bi.median=function(n,t){var u,o=[],a=n.length,l=-1;if(1===arguments.length)for(;++l<a;)i(u=r(n[l]))&&o.push(u);else for(;++l<a;)i(u=r(t.call(n,n[l],l)))&&o.push(u);if(o.length)return Bi.quantile(o.sort(e),.5)},Bi.variance=function(n,t){var e,u,o=n.length,a=0,l=0,c=-1,f=0;if(1===arguments.length)for(;++c<o;)i(e=r(n[c]))&&(l+=(u=e-a)*(e-(a+=u/++f)));else for(;++c<o;)i(e=r(t.call(n,n[c],c)))&&(l+=(u=e-a)*(e-(a+=u/++f)));if(f>1)return l/(f-1)},Bi.deviation=function(){var n=Bi.variance.apply(this,arguments);return n?Math.sqrt(n):n};var ru=u(e);Bi.bisectLeft=ru.left,Bi.bisect=Bi.bisectRight=ru.right,Bi.bisector=function(n){return u(1===n.length?function(t,r){return e(n(t),r)}:n)},Bi.shuffle=function(n,t,e){(u=arguments.length)<3&&(e=n.length,u<2&&(t=0));for(var r,i,u=e-t;u;)i=Math.random()*u--|0,r=n[u+t],n[u+t]=n[i+t],n[i+t]=r;return n},Bi.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},Bi.pairs=function(n){for(var t=0,e=n.length-1,r=n[0],i=new Array(e<0?0:e);t<e;)i[t]=[r,r=n[++t]];return i},Bi.transpose=function(n){if(!(i=n.length))return[];for(var t=-1,e=Bi.min(n,o),r=new Array(e);++t<e;)for(var i,u=-1,a=r[t]=new Array(i);++u<i;)a[u]=n[u][t];return r},Bi.zip=function(){return Bi.transpose(arguments)},Bi.keys=function(n){var t=[];for(var e in n)t.push(e);return t},Bi.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},Bi.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},Bi.merge=function(n){for(var t,e,r,i=n.length,u=-1,o=0;++u<i;)o+=n[u].length;for(e=new Array(o);--i>=0;)for(t=(r=n[i]).length;--t>=0;)e[--o]=r[t];return e};var iu=Math.abs;Bi.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e==1/0)throw new Error("infinite range");var r,i=[],u=function(n){for(var t=1;n*t%1;)t*=10;return t}(iu(e)),o=-1;if(n*=u,t*=u,(e*=u)<0)for(;(r=n+e*++o)>t;)i.push(r/u);else for(;(r=n+e*++o)<t;)i.push(r/u);return i},Bi.map=function(n,t){var e=new l;if(n instanceof l)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,i=-1,u=n.length;if(1===arguments.length)for(;++i<u;)e.set(i,n[i]);else for(;++i<u;)e.set(t.call(n,r=n[i],i),r)}else for(var o in n)e.set(o,n[o]);return e};var uu="__proto__",ou="\0";a(l,{has:s,get:function(n){return this._[c(n)]},set:function(n,t){return this._[c(n)]=t},remove:h,keys:p,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:f(t),value:this._[t]});return n},size:g,empty:v,forEach:function(n){for(var t in this._)n.call(this,f(t),this._[t])}}),Bi.nest=function(){function n(t,o,a){if(a>=u.length)return r?r.call(i,o):e?o.sort(e):o;for(var c,f,s,h,p=-1,g=o.length,v=u[a++],d=new l;++p<g;)(h=d.get(c=v(f=o[p])))?h.push(f):d.set(c,[f]);return t?(f=t(),s=function(e,r){f.set(e,n(t,r,a))}):(f={},s=function(e,r){f[e]=n(t,r,a)}),d.forEach(s),f}function t(n,e){if(e>=u.length)return n;var r=[],i=o[e++];return n.forEach(function(n,i){r.push({key:n,values:t(i,e)})}),i?r.sort(function(n,t){return i(n.key,t.key)}):r}var e,r,i={},u=[],o=[];return i.map=function(t,e){return n(e,t,0)},i.entries=function(e){return t(n(Bi.map,e,0),0)},i.key=function(n){return u.push(n),i},i.sortKeys=function(n){return o[u.length-1]=n,i},i.sortValues=function(n){return e=n,i},i.rollup=function(n){return r=n,i},i},Bi.set=function(n){var t=new d;if(n)for(var e=0,r=n.length;e<r;++e)t.add(n[e]);return t},a(d,{has:s,add:function(n){return this._[c(n+="")]=!0,n},remove:h,values:p,size:g,empty:v,forEach:function(n){for(var t in this._)n.call(this,f(t))}}),Bi.behavior={},Bi.rebind=function(n,t){for(var e,r=1,i=arguments.length;++r<i;)n[e=arguments[r]]=function(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}(n,t,t[e]);return n};var au=["webkit","ms","moz","Moz","o","O"];Bi.dispatch=function(){for(var n=new x,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=b(n);return n},x.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},Bi.event=null,Bi.requote=function(n){return n.replace(lu,"\\$&")};var lu=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,cu={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},fu=function(n,t){return t.querySelector(n)},su=function(n,t){return t.querySelectorAll(n)},hu=function(n,t){var e=n.matches||n[m(n,"matchesSelector")];return(hu=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(fu=function(n,t){return Sizzle(n,t)[0]||null},su=Sizzle,hu=Sizzle.matchesSelector),Bi.selection=function(){return Bi.select(Gi.documentElement)};var pu=Bi.selection.prototype=[];pu.select=function(n){var t,e,r,i,u=[];n=N(n);for(var o=-1,a=this.length;++o<a;){u.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var l=-1,c=r.length;++l<c;)(i=r[l])?(t.push(e=n.call(i,i.__data__,l,o)),e&&"__data__"in i&&(e.__data__=i.__data__)):t.push(null)}return k(u)},pu.selectAll=function(n){var t,e,r=[];n=E(n);for(var i=-1,u=this.length;++i<u;)for(var o=this[i],a=-1,l=o.length;++a<l;)(e=o[a])&&(r.push(t=Ji(n.call(e,e.__data__,a,i))),t.parentNode=e);return k(r)};var gu="http://www.w3.org/1999/xhtml",vu={svg:"http://www.w3.org/2000/svg",xhtml:gu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Bi.ns={prefix:vu,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&"xmlns"!==(e=n.slice(0,t))&&(n=n.slice(t+1)),vu.hasOwnProperty(e)?{space:vu[e],local:n}:n}},pu.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return(n=Bi.ns.qualify(n)).local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(A(t,n[t]));return this}return this.each(A(n,t))},pu.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=L(n)).length,i=-1;if(t=e.classList){for(;++i<r;)if(!t.contains(n[i]))return!1}else for(t=e.getAttribute("class");++i<r;)if(!z(n[i]).test(t))return!1;return!0}for(t in n)this.each(q(t,n[t]));return this}return this.each(q(n,t))},pu.style=function(n,e,r){var i=arguments.length;if(i<3){if("string"!=typeof n){i<2&&(e="");for(r in n)this.each(R(r,n[r],e));return this}if(i<2){var u=this.node();return t(u).getComputedStyle(u,null).getPropertyValue(n)}r=""}return this.each(R(n,e,r))},pu.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(D(t,n[t]));return this}return this.each(D(n,t))},pu.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},pu.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},pu.append=function(n){return n=P(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},pu.insert=function(n,t){return n=P(n),t=N(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},pu.remove=function(){return this.each(U)},pu.data=function(n,t){function e(n,e){var r,i,u,o=n.length,s=e.length,h=Math.min(o,s),p=new Array(s),g=new Array(s),v=new Array(o);if(t){var d,y=new l,m=new Array(o);for(r=-1;++r<o;)(i=n[r])&&(y.has(d=t.call(i,i.__data__,r))?v[r]=i:y.set(d,i),m[r]=d);for(r=-1;++r<s;)(i=y.get(d=t.call(e,u=e[r],r)))?!0!==i&&(p[r]=i,i.__data__=u):g[r]=j(u),y.set(d,!0);for(r=-1;++r<o;)r in m&&!0!==y.get(m[r])&&(v[r]=n[r])}else{for(r=-1;++r<h;)i=n[r],u=e[r],i?(i.__data__=u,p[r]=i):g[r]=j(u);for(;r<s;++r)g[r]=j(e[r]);for(;r<o;++r)v[r]=n[r]}g.update=p,g.parentNode=p.parentNode=v.parentNode=n.parentNode,a.push(g),c.push(p),f.push(v)}var r,i,u=-1,o=this.length;if(!arguments.length){for(n=new Array(o=(r=this[0]).length);++u<o;)(i=r[u])&&(n[u]=i.__data__);return n}var a=O([]),c=k([]),f=k([]);if("function"==typeof n)for(;++u<o;)e(r=this[u],n.call(r,r.parentNode.__data__,u));else for(;++u<o;)e(r=this[u],n);return c.enter=function(){return a},c.exit=function(){return f},c},pu.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},pu.filter=function(n){var t,e,r,i=[];"function"!=typeof n&&(n=F(n));for(var u=0,o=this.length;u<o;u++){i.push(t=[]),t.parentNode=(e=this[u]).parentNode;for(var a=0,l=e.length;a<l;a++)(r=e[a])&&n.call(r,r.__data__,a,u)&&t.push(r)}return k(i)},pu.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],i=r.length-1,u=r[i];--i>=0;)(e=r[i])&&(u&&u!==e.nextSibling&&u.parentNode.insertBefore(e,u),u=e);return this},pu.sort=function(n){n=function(n){return arguments.length||(n=e),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}.apply(this,arguments);for(var t=-1,r=this.length;++t<r;)this[t].sort(n);return this.order()},pu.each=function(n){return H(this,function(t,e,r){n.call(t,t.__data__,e,r)})},pu.call=function(n){var t=Ji(arguments);return n.apply(t[0]=this,t),this},pu.empty=function(){return!this.node()},pu.node=function(){for(var n=0,t=this.length;n<t;n++)for(var e=this[n],r=0,i=e.length;r<i;r++){var u=e[r];if(u)return u}return null},pu.size=function(){var n=0;return H(this,function(){++n}),n};var du=[];Bi.selection.enter=O,Bi.selection.enter.prototype=du,du.append=pu.append,du.empty=pu.empty,du.node=pu.node,du.call=pu.call,du.size=pu.size,du.select=function(n){for(var t,e,r,i,u,o=[],a=-1,l=this.length;++a<l;){r=(i=this[a]).update,o.push(t=[]),t.parentNode=i.parentNode;for(var c=-1,f=i.length;++c<f;)(u=i[c])?(t.push(r[c]=e=n.call(i.parentNode,u.__data__,c,a)),e.__data__=u.__data__):t.push(null)}return k(o)},du.insert=function(n,t){return arguments.length<2&&(t=function(n){var t,e;return function(r,i,u){var o,a=n[u].update,l=a.length;for(u!=e&&(e=u,t=0),i>=t&&(t=i+1);!(o=a[t])&&++t<l;);return o}}(this)),pu.insert.call(this,n,t)},Bi.select=function(t){var e;return"string"==typeof t?(e=[fu(t,Gi)]).parentNode=Gi.documentElement:(e=[t]).parentNode=n(t),k([e])},Bi.selectAll=function(n){var t;return"string"==typeof n?(t=Ji(su(n,Gi))).parentNode=Gi.documentElement:(t=Ji(n)).parentNode=null,k([t])},pu.on=function(n,t,e){var r=arguments.length;if(r<3){if("string"!=typeof n){r<2&&(t=!1);for(e in n)this.each(I(e,n[e],t));return this}if(r<2)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(I(n,t,e))};var yu=Bi.map({mouseenter:"mouseover",mouseleave:"mouseout"});Gi&&yu.forEach(function(n){"on"+n in Gi&&yu.remove(n)});var mu,Mu=0;Bi.mouse=function(n){return X(n,w())};var xu=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;Bi.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=w().changedTouches),t)for(var r,i=0,u=t.length;i<u;++i)if((r=t[i]).identifier===e)return X(n,r)},Bi.behavior.drag=function(){function n(){this.on("mousedown.drag",u).on("touchstart.drag",o)}function e(n,t,e,u,o){return function(){var a,l=Bi.event.target.correspondingElement||Bi.event.target,c=this.parentNode,f=r.of(this,arguments),s=0,h=n(),p=".drag"+(null==h?"":"-"+h),g=Bi.select(e(l)).on(u+p,function(){var n,e,r=t(c,h);r&&(n=r[0]-d[0],e=r[1]-d[1],s|=n|e,d=r,f({type:"drag",x:r[0]+a[0],y:r[1]+a[1],dx:n,dy:e}))}).on(o+p,function(){t(c,h)&&(g.on(u+p,null).on(o+p,null),v(s),f({type:"dragend"}))}),v=V(l),d=t(c,h);a=i?[(a=i.apply(this,arguments)).x-d[0],a.y-d[1]]:[0,0],f({type:"dragstart"})}}var r=S(n,"drag","dragstart","dragend"),i=null,u=e(M,Bi.mouse,t,"mousemove","mouseup"),o=e($,Bi.touch,y,"touchmove","touchend");return n.origin=function(t){return arguments.length?(i=t,n):i},Bi.rebind(n,r,"on")},Bi.touches=function(n,t){return arguments.length<2&&(t=w().touches),t?Ji(t).map(function(t){var e=X(n,t);return e.identifier=t.identifier,e}):[]};var bu=1e-6,_u=bu*bu,wu=Math.PI,Su=2*wu,ku=Su-bu,Nu=wu/2,Eu=wu/180,Au=180/wu,Cu=Math.SQRT2;Bi.interpolateZoom=function(n,t){var e,r,i=n[0],u=n[1],o=n[2],a=t[0],l=t[1],c=t[2],f=a-i,s=l-u,h=f*f+s*s;if(h<_u)r=Math.log(c/o)/Cu,e=function(n){return[i+n*f,u+n*s,o*Math.exp(Cu*n*r)]};else{var p=Math.sqrt(h),g=(c*c-o*o+4*h)/(2*o*2*p),v=(c*c-o*o-4*h)/(2*c*2*p),d=Math.log(Math.sqrt(g*g+1)-g),y=Math.log(Math.sqrt(v*v+1)-v);r=(y-d)/Cu,e=function(n){var t=n*r,e=K(d),a=o/(2*p)*(e*function(n){return((n=Math.exp(2*n))-1)/(n+1)}(Cu*t+d)-function(n){return((n=Math.exp(n))-1/n)/2}(d));return[i+a*f,u+a*s,o*e/K(Cu*t+d)]}}return e.duration=1e3*r,e},Bi.behavior.zoom=function(){function n(n){n.on(z,f).on(Lu+".zoom",h).on("dblclick.zoom",p).on(T,s)}function e(n){return[(n[0]-k.x)/k.k,(n[1]-k.y)/k.k]}function r(n){k.k=Math.max(E[0],Math.min(E[1],n))}function i(n,t){t=function(n){return[n[0]*k.k+k.x,n[1]*k.k+k.y]}(t),k.x+=n[0]-t[0],k.y+=n[1]-t[1]}function u(t,e,u,o){t.__chart__={x:k.x,y:k.y,k:k.k},r(Math.pow(2,o)),i(v=e,u),t=Bi.select(t),A>0&&(t=t.transition().duration(A)),t.call(n.event)}function o(){x&&x.domain(M.range().map(function(n){return(n-k.x)/k.k}).map(M.invert)),w&&w.domain(b.range().map(function(n){return(n-k.y)/k.k}).map(b.invert))}function a(n){C++||n({type:"zoomstart"})}function l(n){o(),n({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function c(n){--C||(n({type:"zoomend"}),v=null)}function f(){var n=this,r=R.of(n,arguments),u=0,o=Bi.select(t(n)).on(L,function(){u=1,i(Bi.mouse(n),f),l(r)}).on(q,function(){o.on(L,null).on(q,null),s(u),c(r)}),f=e(Bi.mouse(n)),s=V(n);ka.call(n),a(r)}function s(){function n(){var n=Bi.touches(g);return p=k.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=e(n))}),n}function t(){var t=Bi.event.target;Bi.select(t).on(x,o).on(b,h),w.push(t);for(var e=Bi.event.changedTouches,r=0,i=e.length;r<i;++r)d[e[r].identifier]=null;var a=n(),l=Date.now();if(1===a.length){if(l-m<500){var c=a[0];u(g,c,d[c.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),_()}m=l}else if(a.length>1){c=a[0];var f=a[1],s=c[0]-f[0],p=c[1]-f[1];y=s*s+p*p}}function o(){var n,t,e,u,o=Bi.touches(g);ka.call(g);for(var a=0,c=o.length;a<c;++a,u=null)if(e=o[a],u=d[e.identifier]){if(t)break;n=e,t=u}if(u){var f=(f=e[0]-n[0])*f+(f=e[1]-n[1])*f,s=y&&Math.sqrt(f/y);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+u[0])/2,(t[1]+u[1])/2],r(s*p)}m=null,i(n,t),l(v)}function h(){if(Bi.event.touches.length){for(var t=Bi.event.changedTouches,e=0,r=t.length;e<r;++e)delete d[t[e].identifier];for(var i in d)return void n()}Bi.selectAll(w).on(M,null),S.on(z,f).on(T,s),N(),c(v)}var p,g=this,v=R.of(g,arguments),d={},y=0,M=".zoom-"+Bi.event.changedTouches[0].identifier,x="touchmove"+M,b="touchend"+M,w=[],S=Bi.select(g),N=V(g);t(),a(v),S.on(z,null).on(T,t)}function h(){var n=R.of(this,arguments);y?clearTimeout(y):(ka.call(this),g=e(v=d||Bi.mouse(this)),a(n)),y=setTimeout(function(){y=null,c(n)},50),_(),r(Math.pow(2,.002*zu())*k.k),i(v,g),l(n)}function p(){var n=Bi.mouse(this),t=Math.log(k.k)/Math.LN2;u(this,n,e(n),Bi.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}var g,v,d,y,m,M,x,b,w,k={x:0,y:0,k:1},N=[960,500],E=qu,A=250,C=0,z="mousedown.zoom",L="mousemove.zoom",q="mouseup.zoom",T="touchstart.zoom",R=S(n,"zoomstart","zoom","zoomend");return Lu||(Lu="onwheel"in Gi?(zu=function(){return-Bi.event.deltaY*(Bi.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Gi?(zu=function(){return Bi.event.wheelDelta},"mousewheel"):(zu=function(){return-Bi.event.detail},"MozMousePixelScroll")),n.event=function(n){n.each(function(){var n=R.of(this,arguments),t=k;wa?Bi.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},a(n)}).tween("zoom:zoom",function(){var e=N[0],r=N[1],i=v?v[0]:e/2,u=v?v[1]:r/2,o=Bi.interpolateZoom([(i-k.x)/k.k,(u-k.y)/k.k,e/k.k],[(i-t.x)/t.k,(u-t.y)/t.k,e/t.k]);return function(t){var r=o(t),a=e/r[2];this.__chart__=k={x:i-r[0]*a,y:u-r[1]*a,k:a},l(n)}}).each("interrupt.zoom",function(){c(n)}).each("end.zoom",function(){c(n)}):(this.__chart__=k,a(n),l(n),c(n))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},o(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:null},r(+t),o(),n):k.k},n.scaleExtent=function(t){return arguments.length?(E=null==t?qu:[+t[0],+t[1]],n):E},n.center=function(t){return arguments.length?(d=t&&[+t[0],+t[1]],n):d},n.size=function(t){return arguments.length?(N=t&&[+t[0],+t[1]],n):N},n.duration=function(t){return arguments.length?(A=+t,n):A},n.x=function(t){return arguments.length?(x=t,M=t.copy(),k={x:0,y:0,k:1},n):x},n.y=function(t){return arguments.length?(w=t,b=t.copy(),k={x:0,y:0,k:1},n):w},Bi.rebind(n,R,"on")};var zu,Lu,qu=[0,1/0];Bi.color=nn,nn.prototype.toString=function(){return this.rgb()+""},Bi.hsl=tn;var Tu=tn.prototype=new nn;Tu.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new tn(this.h,this.s,this.l/n)},Tu.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new tn(this.h,this.s,n*this.l)},Tu.rgb=function(){return en(this.h,this.s,this.l)},Bi.hcl=rn;var Ru=rn.prototype=new nn;Ru.brighter=function(n){return new rn(this.h,this.c,Math.min(100,this.l+Du*(arguments.length?n:1)))},Ru.darker=function(n){return new rn(this.h,this.c,Math.max(0,this.l-Du*(arguments.length?n:1)))},Ru.rgb=function(){return un(this.h,this.c,this.l).rgb()},Bi.lab=on;var Du=18,Pu=.95047,Uu=1,ju=1.08883,Fu=on.prototype=new nn;Fu.brighter=function(n){return new on(Math.min(100,this.l+Du*(arguments.length?n:1)),this.a,this.b)},Fu.darker=function(n){return new on(Math.max(0,this.l-Du*(arguments.length?n:1)),this.a,this.b)},Fu.rgb=function(){return an(this.l,this.a,this.b)},Bi.rgb=hn;var Hu=hn.prototype=new nn;Hu.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b;return t||e||r?(t&&t<30&&(t=30),e&&e<30&&(e=30),r&&r<30&&(r=30),new hn(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new hn(30,30,30)},Hu.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new hn(n*this.r,n*this.g,n*this.b)},Hu.hsl=function(){return yn(this.r,this.g,this.b)},Hu.toString=function(){return"#"+vn(this.r)+vn(this.g)+vn(this.b)};var Ou=Bi.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ou.forEach(function(n,t){Ou.set(n,pn(t))}),Bi.functor=bn,Bi.xhr=_n(y),Bi.dsv=function(n,t){function e(n,e,u){arguments.length<3&&(u=e,e=null);var o=wn(n,t,null==e?r:i(e),u);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:i(n)):e},o}function r(n){return e.parse(n.responseText)}function i(n){return function(t){return e.parse(t.responseText,n)}}function u(t){return t.map(o).join(n)}function o(n){return a.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var a=new RegExp('["'+n+"\n]"),l=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var i=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(i(n),e)}:i})},e.parseRows=function(n,t){function e(){if(f>=c)return o;if(i)return i=!1,u;var t=f;if(34===n.charCodeAt(t)){for(var e=t;e++<c;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}f=e+2;return 13===(r=n.charCodeAt(e+1))?(i=!0,10===n.charCodeAt(e+2)&&++f):10===r&&(i=!0),n.slice(t+1,e).replace(/""/g,'"')}for(;f<c;){var r,a=1;if(10===(r=n.charCodeAt(f++)))i=!0;else if(13===r)i=!0,10===n.charCodeAt(f)&&(++f,++a);else if(r!==l)continue;return n.slice(t,f-a)}return n.slice(t)}for(var r,i,u={},o={},a=[],c=n.length,f=0,s=0;(r=e())!==o;){for(var h=[];r!==u&&r!==o;)h.push(r),r=e();t&&null==(h=t(h,s++))||a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new d,i=[];return t.forEach(function(n){for(var t in n)r.has(t)||i.push(r.add(t))}),[i.map(o).join(n)].concat(t.map(function(t){return i.map(function(n){return o(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(u).join("\n")},e},Bi.csv=Bi.dsv(",","text/csv"),Bi.tsv=Bi.dsv("\t","text/tab-separated-values");var Iu,Yu,Zu,Vu,Xu=this[m(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};Bi.timer=function(){Sn.apply(this,arguments)},Bi.timer.flush=function(){Nn(),En()},Bi.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var $u=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function(n,t){var e=Math.pow(10,3*iu(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}});Bi.formatPrefix=function(n,t){var e=0;return(n=+n)&&(n<0&&(n*=-1),t&&(n=Bi.round(n,An(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),$u[8+e/3]};var Bu=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Wu=Bi.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=Bi.round(n,An(n,t))).toFixed(Math.max(0,Math.min(20,An(n*(1+1e-15),t))))}}),Ju=Bi.time={},Gu=Date;Cn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ku.setUTCDate.apply(this._,arguments)},setDay:function(){Ku.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ku.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ku.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ku.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ku.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ku.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ku.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ku.setTime.apply(this._,arguments)}};var Ku=Date.prototype;Ju.year=zn(function(n){return(n=Ju.day(n)).setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),Ju.years=Ju.year.range,Ju.years.utc=Ju.year.utc.range,Ju.day=zn(function(n){var t=new Gu(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),Ju.days=Ju.day.range,Ju.days.utc=Ju.day.utc.range,Ju.dayOfYear=function(n){var t=Ju.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=Ju[n]=zn(function(n){return(n=Ju.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=Ju.year(n).getDay();return Math.floor((Ju.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});Ju[n+"s"]=e.range,Ju[n+"s"].utc=e.utc.range,Ju[n+"OfYear"]=function(n){var e=Ju.year(n).getDay();return Math.floor((Ju.dayOfYear(n)+(e+t)%7)/7)}}),Ju.week=Ju.sunday,Ju.weeks=Ju.sunday.range,Ju.weeks.utc=Ju.sunday.utc.range,Ju.weekOfYear=Ju.sundayOfYear;var Qu={"-":"",_:" ",0:"0"},no=/^\s*\d+/,to=/^%/;Bi.locale=function(n){return{numberFormat:function(n){var t=n.decimal,e=n.thousands,r=n.grouping,i=n.currency,u=r&&e?function(n,t){for(var i=n.length,u=[],o=0,a=r[0],l=0;i>0&&a>0&&(l+a+1>t&&(a=Math.max(1,t-l)),u.push(n.substring(i-=a,i+a)),!((l+=a+1)>t));)a=r[o=(o+1)%r.length];return u.reverse().join(e)}:y;return function(n){var e=Bu.exec(n),r=e[1]||" ",o=e[2]||">",a=e[3]||"-",l=e[4]||"",c=e[5],f=+e[6],s=e[7],h=e[8],p=e[9],g=1,v="",d="",y=!1,m=!0;switch(h&&(h=+h.substring(1)),(c||"0"===r&&"="===o)&&(c=r="0",o="="),p){case"n":s=!0,p="g";break;case"%":g=100,d="%",p="f";break;case"p":g=100,d="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(v="0"+p.toLowerCase());case"c":m=!1;case"d":y=!0,h=0;break;case"s":g=-1,p="r"}"$"===l&&(v=i[0],d=i[1]),"r"!=p||h||(p="g"),null!=h&&("g"==p?h=Math.max(1,Math.min(21,h)):"e"!=p&&"f"!=p||(h=Math.max(0,Math.min(20,h)))),p=Wu.get(p)||function(n){return n+""};var M=c&&s;return function(n){var e=d;if(y&&n%1)return"";var i=n<0||0===n&&1/n<0?(n=-n,"-"):"-"===a?"":a;if(g<0){var l=Bi.formatPrefix(n,h);n=l.scale(n),e=l.symbol+d}else n*=g;var x,b,_=(n=p(n,h)).lastIndexOf(".");if(_<0){var w=m?n.lastIndexOf("e"):-1;w<0?(x=n,b=""):(x=n.substring(0,w),b=n.substring(w))}else x=n.substring(0,_),b=t+n.substring(_+1);!c&&s&&(x=u(x,1/0));var S=v.length+x.length+b.length+(M?0:i.length),k=S<f?new Array(S=f-S+1).join(r):"";return M&&(x=u(k+x,k.length?f-b.length:1/0)),i+=v,n=x+b,("<"===o?i+n+k:">"===o?k+i+n:"^"===o?k.substring(0,S>>=1)+i+n+k.substring(S):i+(M?n:k+n))+e}}}(n),timeFormat:function(n){function t(n){function t(t){for(var e,i,u,o=[],a=-1,l=0;++a<r;)37===n.charCodeAt(a)&&(o.push(n.slice(l,a)),null!=(i=Qu[e=n.charAt(++a)])&&(e=n.charAt(++a)),(u=x[e])&&(e=u(t,null==i?"e"===e?" ":"0":i)),o.push(e),l=a+1);return o.push(n.slice(l,a)),o.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(e(r,n,t,0)!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&Gu!==Cn,u=new(i?Cn:Gu);return"j"in r?u.setFullYear(r.y,0,r.j):"W"in r||"U"in r?("w"in r||(r.w="W"in r?1:0),u.setFullYear(r.y,0,1),u.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(u.getDay()+5)%7:r.w+7*r.U-(u.getDay()+6)%7)):u.setFullYear(r.y,r.m,r.d),u.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),i?u._:u},t.toString=function(){return n},t}function e(n,t,e,r){for(var i,u,o,a=0,l=t.length,c=e.length;a<l;){if(r>=c)return-1;if(37===(i=t.charCodeAt(a++))){if(o=t.charAt(a++),!(u=b[o in Qu?t.charAt(a++):o])||(r=u(n,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}var r=n.dateTime,i=n.date,u=n.time,o=n.periods,a=n.days,l=n.shortDays,c=n.months,f=n.shortMonths;t.multi=(t.utc=function(n){function e(n){try{var t=new(Gu=Cn);return t._=n,r(t)}finally{Gu=Date}}var r=t(n);return e.parse=function(n){try{Gu=Cn;var t=r.parse(n);return t&&t._}finally{Gu=Date}},e.toString=r.toString,e}).multi=Jn;var s=Bi.map(),h=Tn(a),p=Rn(a),g=Tn(l),v=Rn(l),d=Tn(c),y=Rn(c),m=Tn(f),M=Rn(f);o.forEach(function(n,t){s.set(n.toLowerCase(),t)});var x={a:function(n){return l[n.getDay()]},A:function(n){return a[n.getDay()]},b:function(n){return f[n.getMonth()]},B:function(n){return c[n.getMonth()]},c:t(r),d:function(n,t){return qn(n.getDate(),t,2)},e:function(n,t){return qn(n.getDate(),t,2)},H:function(n,t){return qn(n.getHours(),t,2)},I:function(n,t){return qn(n.getHours()%12||12,t,2)},j:function(n,t){return qn(1+Ju.dayOfYear(n),t,3)},L:function(n,t){return qn(n.getMilliseconds(),t,3)},m:function(n,t){return qn(n.getMonth()+1,t,2)},M:function(n,t){return qn(n.getMinutes(),t,2)},p:function(n){return o[+(n.getHours()>=12)]},S:function(n,t){return qn(n.getSeconds(),t,2)},U:function(n,t){return qn(Ju.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return qn(Ju.mondayOfYear(n),t,2)},x:t(i),X:t(u),y:function(n,t){return qn(n.getFullYear()%100,t,2)},Y:function(n,t){return qn(n.getFullYear()%1e4,t,4)},Z:Bn,"%":function(){return"%"}},b={a:function(n,t,e){g.lastIndex=0;var r=g.exec(t.slice(e));return r?(n.w=v.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(n,t,e){h.lastIndex=0;var r=h.exec(t.slice(e));return r?(n.w=p.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(n,t,e){m.lastIndex=0;var r=m.exec(t.slice(e));return r?(n.m=M.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(n,t,e){d.lastIndex=0;var r=d.exec(t.slice(e));return r?(n.m=y.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(n,t,r){return e(n,x.c.toString(),t,r)},d:In,e:In,H:Zn,I:Zn,j:Yn,L:$n,m:On,M:Vn,p:function(n,t,e){var r=s.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)},S:Xn,U:Pn,w:Dn,W:Un,x:function(n,t,r){return e(n,x.x.toString(),t,r)},X:function(n,t,r){return e(n,x.X.toString(),t,r)},y:Fn,Y:jn,Z:Hn,"%":Wn};return t}(n)}};var eo=Bi.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Bi.format=eo.numberFormat,Bi.geo={},Gn.prototype={s:0,t:0,add:function(n){Kn(n,this.t,ro),Kn(ro.s,this.s,this),this.s?this.t+=ro.t:this.s=ro.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ro=new Gn;Bi.geo.stream=function(n,t){n&&io.hasOwnProperty(n.type)?io[n.type](n,t):Qn(n,t)};var io={Feature:function(n,t){Qn(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,i=e.length;++r<i;)Qn(e[r].geometry,t)}},uo={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){nt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)nt(e[r],t,0)},Polygon:function(n,t){tt(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)tt(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,i=e.length;++r<i;)Qn(e[r],t)}};Bi.geo.area=function(n){return oo=0,Bi.geo.stream(n,lo),oo};var oo,ao=new Gn,lo={sphere:function(){oo+=4*wu},point:M,lineStart:M,lineEnd:M,polygonStart:function(){ao.reset(),lo.lineStart=et},polygonEnd:function(){var n=2*ao;oo+=n<0?4*wu+n:n,lo.lineStart=lo.lineEnd=lo.point=M}};Bi.geo.bounds=function(){function n(n,t){M.push(x=[f=n,h=n]),t<s&&(s=t),t>p&&(p=t)}function t(t,e){var r=rt([t*Eu,e*Eu]);if(y){var i=ut(y,r),u=ut([i[1],-i[0],0],i);lt(u),u=ct(u);var o=t-g,l=o>0?1:-1,c=u[0]*Au*l,v=iu(o)>180;if(v^(l*g<c&&c<l*t)){(d=u[1]*Au)>p&&(p=d)}else if(c=(c+360)%360-180,v^(l*g<c&&c<l*t)){var d;(d=-u[1]*Au)<s&&(s=d)}else e<s&&(s=e),e>p&&(p=e);v?t<g?a(f,t)>a(f,h)&&(h=t):a(t,h)>a(f,h)&&(f=t):h>=f?(t<f&&(f=t),t>h&&(h=t)):t>g?a(f,t)>a(f,h)&&(h=t):a(t,h)>a(f,h)&&(f=t)}else n(t,e);y=r,g=t}function e(){b.point=t}function r(){x[0]=f,x[1]=h,b.point=n,y=null}function i(n,e){if(y){var r=n-g;m+=iu(r)>180?r+(r>0?360:-360):r}else v=n,d=e;lo.point(n,e),t(n,e)}function u(){lo.lineStart()}function o(){i(v,d),lo.lineEnd(),iu(m)>bu&&(f=-(h=180)),x[0]=f,x[1]=h,y=null}function a(n,t){return(t-=n)<0?t+360:t}function l(n,t){return n[0]-t[0]}function c(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var f,s,h,p,g,v,d,y,m,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=i,b.lineStart=u,b.lineEnd=o,m=0,lo.polygonStart()},polygonEnd:function(){lo.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,ao<0?(f=-(h=180),s=-(p=90)):m>bu?p=90:m<-bu&&(s=-90),x[0]=f,x[1]=h}};return function(n){p=h=-(f=s=1/0),M=[],Bi.geo.stream(n,b);if(i=M.length){M.sort(l);for(var t=1,e=[g=M[0]];t<i;++t)c((u=M[t])[0],g)||c(u[1],g)?(a(g[0],u[1])>a(g[0],g[1])&&(g[1]=u[1]),a(u[0],g[1])>a(g[0],g[1])&&(g[0]=u[0])):e.push(g=u);for(var r,i,u,o=-1/0,g=(t=0,e[i=e.length-1]);t<=i;g=u,++t)u=e[t],(r=a(g[1],u[0]))>o&&(o=r,f=u[0],h=g[1])}return M=x=null,f===1/0||s===1/0?[[NaN,NaN],[NaN,NaN]]:[[f,s],[h,p]]}}(),Bi.geo.centroid=function(n){co=fo=so=ho=po=go=vo=yo=mo=Mo=xo=0,Bi.geo.stream(n,bo);var t=mo,e=Mo,r=xo,i=t*t+e*e+r*r;return i<_u&&(t=go,e=vo,r=yo,fo<bu&&(t=so,e=ho,r=po),(i=t*t+e*e+r*r)<_u)?[NaN,NaN]:[Math.atan2(e,t)*Au,G(r/Math.sqrt(i))*Au]};var co,fo,so,ho,po,go,vo,yo,mo,Mo,xo,bo={sphere:M,point:st,lineStart:pt,lineEnd:gt,polygonStart:function(){bo.lineStart=vt},polygonEnd:function(){bo.lineStart=pt}},_o=bt(yt,function(n){var t,e=NaN,r=NaN,i=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(u,o){var a=u>0?wu:-wu,l=iu(u-e);iu(l-wu)<bu?(n.point(e,r=(r+o)/2>0?Nu:-Nu),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(u,r),t=0):i!==a&&l>=wu&&(iu(e-i)<bu&&(e-=i*bu),iu(u-a)<bu&&(u-=a*bu),r=function(n,t,e,r){var i,u,o=Math.sin(n-e);return iu(o)>bu?Math.atan((Math.sin(t)*(u=Math.cos(r))*Math.sin(e)-Math.sin(r)*(i=Math.cos(t))*Math.sin(n))/(i*u*o)):(t+r)/2}(e,r,u,o),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=u,r=o),i=a},lineEnd:function(){n.lineEnd(),e=r=NaN},clean:function(){return 2-t}}},function(n,t,e,r){var i;if(null==n)i=e*Nu,r.point(-wu,i),r.point(0,i),r.point(wu,i),r.point(wu,0),r.point(wu,-i),r.point(0,-i),r.point(-wu,-i),r.point(-wu,0),r.point(-wu,i);else if(iu(n[0]-t[0])>bu){var u=n[0]<t[0]?wu:-wu;i=e*u/2,r.point(-u,i),r.point(0,i),r.point(u,i)}else r.point(t[0],t[1])},[-wu,-wu/2]),wo=1e9;Bi.geo.clipExtent=function(){var n,t,e,r,i,u,o={stream:function(n){return i&&(i.valid=!1),i=u(n),i.valid=!0,i},extent:function(a){return arguments.length?(u=Nt(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),i&&(i.valid=!1,i=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(Bi.geo.conicEqualArea=function(){return Et(At)}).raw=At,Bi.geo.albers=function(){return Bi.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Bi.geo.albersUsa=function(){function n(n){var u=n[0],o=n[1];return t=null,e(u,o),t||(r(u,o),t)||i(u,o),t}var t,e,r,i,u=Bi.geo.albers(),o=Bi.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=Bi.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=u.scale(),e=u.translate(),r=(n[0]-e[0])/t,i=(n[1]-e[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?o:i>=.166&&i<.234&&r>=-.214&&r<-.115?a:u).invert(n)},n.stream=function(n){var t=u.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,i){t.point(n,i),e.point(n,i),r.point(n,i)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(u.precision(t),o.precision(t),a.precision(t),n):u.precision()},n.scale=function(t){return arguments.length?(u.scale(t),o.scale(.35*t),a.scale(t),n.translate(u.translate())):u.scale()},n.translate=function(t){if(!arguments.length)return u.translate();var c=u.scale(),f=+t[0],s=+t[1];return e=u.translate(t).clipExtent([[f-.455*c,s-.238*c],[f+.455*c,s+.238*c]]).stream(l).point,r=o.translate([f-.307*c,s+.201*c]).clipExtent([[f-.425*c+bu,s+.12*c+bu],[f-.214*c-bu,s+.234*c-bu]]).stream(l).point,i=a.translate([f-.205*c,s+.212*c]).clipExtent([[f-.214*c+bu,s+.166*c+bu],[f-.115*c-bu,s+.234*c-bu]]).stream(l).point,n},n.scale(1070)};var So,ko,No,Eo,Ao,Co,zo={point:M,lineStart:M,lineEnd:M,polygonStart:function(){ko=0,zo.lineStart=Ct},polygonEnd:function(){zo.lineStart=zo.lineEnd=zo.point=M,So+=iu(ko/2)}},Lo={point:function(n,t){n<No&&(No=n),n>Ao&&(Ao=n),t<Eo&&(Eo=t),t>Co&&(Co=t)},lineStart:M,lineEnd:M,polygonStart:M,polygonEnd:M},qo={point:Lt,lineStart:qt,lineEnd:Tt,polygonStart:function(){qo.lineStart=Rt},polygonEnd:function(){qo.point=Lt,qo.lineStart=qt,qo.lineEnd=Tt}};Bi.geo.path=function(){function n(n){return n&&("function"==typeof a&&u.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=i(u)),Bi.geo.stream(n,o)),u.result()}function t(){return o=null,n}var e,r,i,u,o,a=4.5;return n.area=function(n){return So=0,Bi.geo.stream(n,i(zo)),So},n.centroid=function(n){return so=ho=po=go=vo=yo=mo=Mo=xo=0,Bi.geo.stream(n,i(qo)),xo?[mo/xo,Mo/xo]:yo?[go/yo,vo/yo]:po?[so/po,ho/po]:[NaN,NaN]},n.bounds=function(n){return Ao=Co=-(No=Eo=1/0),Bi.geo.stream(n,i(Lo)),[[No,Eo],[Ao,Co]]},n.projection=function(n){return arguments.length?(i=(e=n)?n.stream||function(n){var t=Dt(function(t,e){return n([t*Au,e*Au])});return function(n){return Ht(t(n))}}(n):y,t()):e},n.context=function(n){return arguments.length?(u=null==(r=n)?new function(){function n(n,t){o.push("M",n,",",t,u)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function i(){o.push("Z")}var u=zt(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return u=zt(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}:new function(n){function t(t,e){n.moveTo(t+o,e),n.arc(t,e,o,0,Su)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function i(){a.point=t}function u(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:i,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=i,a.point=t},pointRadius:function(n){return o=n,a},result:M};return a}(n),"function"!=typeof a&&u.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(u.pointRadius(+t),+t),n):a},n.projection(Bi.geo.albersUsa()).context(null)},Bi.geo.transform=function(n){return{stream:function(t){var e=new Pt(t);for(var r in n)e[r]=n[r];return e}}},Pt.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Bi.geo.projection=jt,Bi.geo.projectionMutator=Ft,(Bi.geo.equirectangular=function(){return jt(Ot)}).raw=Ot.invert=Ot,Bi.geo.rotation=function(n){function t(t){return t=n(t[0]*Eu,t[1]*Eu),t[0]*=Au,t[1]*=Au,t}return n=Yt(n[0]%360*Eu,n[1]*Eu,n.length>2?n[2]*Eu:0),t.invert=function(t){return t=n.invert(t[0]*Eu,t[1]*Eu),t[0]*=Au,t[1]*=Au,t},t},It.invert=Ot,Bi.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=Yt(-n[0]*Eu,-n[1]*Eu,0).invert,i=[];return e(null,null,1,{point:function(n,e){i.push(n=t(n,e)),n[0]*=Au,n[1]*=Au}}),{type:"Polygon",coordinates:[i]}}var t,e,r=[0,0],i=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=$t((t=+r)*Eu,i*Eu),n):t},n.precision=function(r){return arguments.length?(e=$t(t*Eu,(i=+r)*Eu),n):i},n.angle(90)},Bi.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Eu,i=n[1]*Eu,u=t[1]*Eu,o=Math.sin(r),a=Math.cos(r),l=Math.sin(i),c=Math.cos(i),f=Math.sin(u),s=Math.cos(u);return Math.atan2(Math.sqrt((e=s*o)*e+(e=c*f-l*s*a)*e),l*f+c*s*a)},Bi.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return Bi.range(Math.ceil(u/d)*d,i,d).map(h).concat(Bi.range(Math.ceil(c/y)*y,l,y).map(p)).concat(Bi.range(Math.ceil(r/g)*g,e,g).filter(function(n){return iu(n%d)>bu}).map(f)).concat(Bi.range(Math.ceil(a/v)*v,o,v).filter(function(n){return iu(n%y)>bu}).map(s))}var e,r,i,u,o,a,l,c,f,s,h,p,g=10,v=g,d=90,y=360,m=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(u).concat(p(l).slice(1),h(i).reverse().slice(1),p(c).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(u=+t[0][0],i=+t[1][0],c=+t[0][1],l=+t[1][1],u>i&&(t=u,u=i,i=t),c>l&&(t=c,c=l,l=t),n.precision(m)):[[u,c],[i,l]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(m)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],y=+t[1],n):[d,y]},n.minorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],n):[g,v]},n.precision=function(t){return arguments.length?(m=+t,f=Wt(a,o,90),s=Jt(r,e,m),h=Wt(c,l,90),p=Jt(u,i,m),n):m},n.majorExtent([[-180,-90+bu],[180,90-bu]]).minorExtent([[-180,-80-bu],[180,80+bu]])},Bi.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||i.apply(this,arguments)]}}var t,e,r=Gt,i=Kt;return n.distance=function(){return Bi.geo.distance(t||r.apply(this,arguments),e||i.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,n):i},n.precision=function(){return arguments.length?n:0},n},Bi.geo.interpolate=function(n,t){return function(n,t,e,r){var i=Math.cos(t),u=Math.sin(t),o=Math.cos(r),a=Math.sin(r),l=i*Math.cos(n),c=i*Math.sin(n),f=o*Math.cos(e),s=o*Math.sin(e),h=2*Math.asin(Math.sqrt(Q(r-t)+i*o*Q(e-n))),p=1/Math.sin(h),g=h?function(n){var t=Math.sin(n*=h)*p,e=Math.sin(h-n)*p,r=e*l+t*f,i=e*c+t*s,o=e*u+t*a;return[Math.atan2(i,r)*Au,Math.atan2(o,Math.sqrt(r*r+i*i))*Au]}:function(){return[n*Au,t*Au]};return g.distance=h,g}(n[0]*Eu,n[1]*Eu,t[0]*Eu,t[1]*Eu)},Bi.geo.length=function(n){return To=0,Bi.geo.stream(n,Ro),To};var To,Ro={sphere:M,point:M,lineStart:function(){function n(n,i){var u=Math.sin(i*=Eu),o=Math.cos(i),a=iu((n*=Eu)-t),l=Math.cos(a);To+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*u-e*o*l)*a),e*u+r*o*l),t=n,e=u,r=o}var t,e,r;Ro.point=function(i,u){t=i*Eu,e=Math.sin(u*=Eu),r=Math.cos(u),Ro.point=n},Ro.lineEnd=function(){Ro.point=Ro.lineEnd=M}},lineEnd:M,polygonStart:M,polygonEnd:M},Do=Qt(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(Bi.geo.azimuthalEqualArea=function(){return jt(Do)}).raw=Do;var Po=Qt(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},y);(Bi.geo.azimuthalEquidistant=function(){return jt(Po)}).raw=Po,(Bi.geo.conicConformal=function(){return Et(ne)}).raw=ne,(Bi.geo.conicEquidistant=function(){return Et(te)}).raw=te;var Uo=Qt(function(n){return 1/n},Math.atan);(Bi.geo.gnomonic=function(){return jt(Uo)}).raw=Uo,ee.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Nu]},(Bi.geo.mercator=function(){return re(ee)}).raw=ee;var jo=Qt(function(){return 1},Math.asin);(Bi.geo.orthographic=function(){return jt(jo)}).raw=jo;var Fo=Qt(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(Bi.geo.stereographic=function(){return jt(Fo)}).raw=Fo,ie.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-Nu]},(Bi.geo.transverseMercator=function(){var n=re(ie),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=ie,Bi.geom={},Bi.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,i=bn(e),u=bn(r),o=n.length,a=[],l=[];for(t=0;t<o;t++)a.push([+i.call(this,n[t],t),+u.call(this,n[t],t),t]);for(a.sort(le),t=0;t<o;t++)l.push([a[t][0],-a[t][1]]);var c=ae(a),f=ae(l),s=f[0]===c[0],h=f[f.length-1]===c[c.length-1],p=[];for(t=c.length-1;t>=0;--t)p.push(n[a[c[t]][2]]);for(t=+s;t<f.length-h;++t)p.push(n[a[f[t]][2]]);return p}var e=ue,r=oe;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},Bi.geom.polygon=function(n){return cu(n,Ho),n};var Ho=Bi.geom.polygon.prototype=[];Ho.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],i=0;++t<e;)n=r,r=this[t],i+=n[1]*r[0]-n[0]*r[1];return.5*i},Ho.centroid=function(n){var t,e,r=-1,i=this.length,u=0,o=0,a=this[i-1];for(arguments.length||(n=-1/(6*this.area()));++r<i;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],u+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[u*n,o*n]},Ho.clip=function(n){for(var t,e,r,i,u,o,a=se(n),l=-1,c=this.length-se(this),f=this[c-1];++l<c;){for(t=n.slice(),n.length=0,i=this[l],u=t[(r=t.length-a)-1],e=-1;++e<r;)ce(o=t[e],f,i)?(ce(u,f,i)||n.push(fe(u,o,f,i)),n.push(o)):ce(u,f,i)&&n.push(fe(u,o,f,i)),u=o;a&&n.push(n[0]),f=i}return n};var Oo,Io,Yo,Zo,Vo,Xo=[],$o=[];ye.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)(n=t[e].edge).b&&n.a||t.splice(e,1);return t.sort(Me),t.length},ke.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Ne.prototype={insert:function(n,t){var e,r,i;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=ze(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.R&&(Ae(this,e),e=(n=e).U),e.C=!1,r.C=!0,Ce(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.L&&(Ce(this,e),e=(n=e).U),e.C=!1,r.C=!0,Ae(this,r)),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,i=n.U,u=n.L,o=n.R;if(e=u?o?ze(o):u:o,i?i.L===n?i.L=e:i.R=e:this._=e,u&&o?(r=e.C,e.C=n.C,e.L=u,u.U=e,e!==o?(i=e.U,e.U=n.U,n=e.R,i.L=n,e.R=o,o.U=e):(e.U=i,i=e,n=e.R)):(r=n.C,n=e),n&&(n.U=i),!r)if(n&&n.C)n.C=!1;else{do{if(n===this._)break;if(n===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,Ae(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,Ce(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,Ae(this,i),n=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,Ce(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,Ae(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,Ce(this,i),n=this._;break}t.C=!0,n=i,i=i.U}while(!n.C);n&&(n.C=!1)}}},Bi.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],i=a[0][1],u=a[1][0],o=a[1][1];return Le(e(n),a).cells.forEach(function(e,a){var l=e.edges,c=e.site;(t[a]=l.length?l.map(function(n){var t=n.start();return[t.x,t.y]}):c.x>=r&&c.x<=u&&c.y>=i&&c.y<=o?[[r,o],[u,o],[u,i],[r,i]]:[]).point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(u(n,t)/bu)*bu,y:Math.round(o(n,t)/bu)*bu,i:t}})}var r=ue,i=oe,u=r,o=i,a=Bo;return n?t(n):(t.links=function(n){return Le(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return Le(e(n)).cells.forEach(function(e,r){for(var i,u=e.site,o=e.edges.sort(Me),a=-1,l=o.length,c=o[l-1].edge,f=c.l===u?c.r:c.l;++a<l;)c,i=f,f=(c=o[a].edge).l===u?c.r:c.l,r<i.i&&r<f.i&&function(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}(u,i,f)<0&&t.push([n[r],n[i.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(u=bn(r=n),t):r},t.y=function(n){return arguments.length?(o=bn(i=n),t):i},t.clipExtent=function(n){return arguments.length?(a=null==n?Bo:n,t):a===Bo?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===Bo?null:a&&a[1]},t)};var Bo=[[-1e6,-1e6],[1e6,1e6]];Bi.geom.delaunay=function(n){return Bi.geom.voronoi().triangles(n)},Bi.geom.quadtree=function(n,t,e,r,i){function u(n){function u(n,t,e,r,i,u,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var l=n.x,f=n.y;if(null!=l)if(iu(l-e)+iu(f-r)<.01)c(n,t,e,r,i,u,o,a);else{var s=n.point;n.x=n.y=n.point=null,c(n,s,l,f,i,u,o,a),c(n,t,e,r,i,u,o,a)}else n.x=e,n.y=r,n.point=t}else c(n,t,e,r,i,u,o,a)}function c(n,t,e,r,i,o,a,l){var c=.5*(i+a),f=.5*(o+l),s=e>=c,h=r>=f,p=h<<1|s;n.leaf=!1,n=n.nodes[p]||(n.nodes[p]={leaf:!0,nodes:[],point:null,x:null,y:null}),s?i=c:a=c,h?o=f:l=f,u(n,t,e,r,i,o,a,l)}var f,s,h,p,g,v,d,y,m,M=bn(a),x=bn(l);if(null!=t)v=t,d=e,y=r,m=i;else if(y=m=-(v=d=1/0),s=[],h=[],g=n.length,o)for(p=0;p<g;++p)(f=n[p]).x<v&&(v=f.x),f.y<d&&(d=f.y),f.x>y&&(y=f.x),f.y>m&&(m=f.y),s.push(f.x),h.push(f.y);else for(p=0;p<g;++p){var b=+M(f=n[p],p),_=+x(f,p);b<v&&(v=b),_<d&&(d=_),b>y&&(y=b),_>m&&(m=_),s.push(b),h.push(_)}var w=y-v,S=m-d;w>S?m=d+w:y=v+S;var k={leaf:!0,nodes:[],point:null,x:null,y:null};if(k.add=function(n){u(k,n,+M(n,++p),+x(n,p),v,d,y,m)},k.visit=function(n){De(n,k,v,d,y,m)},k.find=function(n){return function(n,t,e,r,i,u,o){var a,l=1/0;return function n(c,f,s,h,p){if(!(f>u||s>o||h<r||p<i)){if(g=c.point){var g,v=t-c.x,d=e-c.y,y=v*v+d*d;if(y<l){var m=Math.sqrt(l=y);r=t-m,i=e-m,u=t+m,o=e+m,a=g}}for(var M=c.nodes,x=.5*(f+h),b=.5*(s+p),_=(e>=b)<<1|t>=x,w=_+4;_<w;++_)if(c=M[3&_])switch(3&_){case 0:n(c,f,s,x,b);break;case 1:n(c,x,s,h,b);break;case 2:n(c,f,b,x,p);break;case 3:n(c,x,b,h,p)}}}(n,r,i,u,o),a}(k,n[0],n[1],v,d,y,m)},p=-1,null==t){for(;++p<g;)u(k,n[p],s[p],h[p],v,d,y,m);--p}else n.forEach(k.add);return s=h=n=f=null,k}var o,a=ue,l=oe;return(o=arguments.length)?(a=Te,l=Re,3===o&&(i=e,r=t,e=t=0),u(n)):(u.x=function(n){return arguments.length?(a=n,u):a},u.y=function(n){return arguments.length?(l=n,u):l},u.extent=function(n){return arguments.length?(null==n?t=e=r=i=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],i=+n[1][1]),u):null==t?null:[[t,e],[r,i]]},u.size=function(n){return arguments.length?(null==n?t=e=r=i=null:(t=e=0,r=+n[0],i=+n[1]),u):null==t?null:[r-t,i-e]},u)},Bi.interpolateRgb=Pe,Bi.interpolateObject=Ue,Bi.interpolateNumber=je,Bi.interpolateString=Fe;var Wo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jo=new RegExp(Wo.source,"g");Bi.interpolate=He,Bi.interpolators=[function(n,t){var e=typeof t;return("string"===e?Ou.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?Pe:Fe:t instanceof nn?Pe:Array.isArray(t)?Oe:"object"===e&&isNaN(t)?Ue:je)(n,t)}],Bi.interpolateArray=Oe;var Go=function(){return y},Ko=Bi.map({linear:Go,poly:function(n){return function(t){return Math.pow(t,n)}},quad:function(){return Ze},cubic:function(){return Ve},sin:function(){return Xe},exp:function(){return $e},circle:function(){return Be},elastic:function(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/Su*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*Su/t)}},back:function(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}},bounce:function(){return We}}),Qo=Bi.map({in:y,out:Ie,"in-out":Ye,"out-in":function(n){return Ye(Ie(n))}});Bi.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return e=Ko.get(e)||Go,r=Qo.get(r)||y,function(n){return function(t){return t<=0?0:t>=1?1:n(t)}}(r(e.apply(null,Wi.call(arguments,1))))},Bi.interpolateHcl=function(n,t){n=Bi.hcl(n),t=Bi.hcl(t);var e=n.h,r=n.c,i=n.l,u=t.h-e,o=t.c-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):u>180?u-=360:u<-180&&(u+=360),function(n){return un(e+u*n,r+o*n,i+a*n)+""}},Bi.interpolateHsl=function(n,t){n=Bi.hsl(n),t=Bi.hsl(t);var e=n.h,r=n.s,i=n.l,u=t.h-e,o=t.s-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):u>180?u-=360:u<-180&&(u+=360),function(n){return en(e+u*n,r+o*n,i+a*n)+""}},Bi.interpolateLab=function(n,t){n=Bi.lab(n),t=Bi.lab(t);var e=n.l,r=n.a,i=n.b,u=t.l-e,o=t.a-r,a=t.b-i;return function(n){return an(e+u*n,r+o*n,i+a*n)+""}},Bi.interpolateRound=Je,Bi.transform=function(n){var t=Gi.createElementNS(Bi.ns.prefix.svg,"g");return(Bi.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new Ge(e?e.matrix:na)})(n)},Ge.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var na={a:1,b:0,c:0,d:1,e:0,f:0};Bi.interpolateTransform=tr,Bi.layout={},Bi.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(er(n[e]));return t}},Bi.layout.chord=function(){function n(){var n,c,s,h,p,g={},v=[],d=Bi.range(u),y=[];for(e=[],r=[],n=0,h=-1;++h<u;){for(c=0,p=-1;++p<u;)c+=i[h][p];v.push(c),y.push(Bi.range(u)),n+=c}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&y.forEach(function(n,t){n.sort(function(n,e){return a(i[t][n],i[t][e])})}),n=(Su-f*u)/n,c=0,h=-1;++h<u;){for(s=c,p=-1;++p<u;){var m=d[h],M=y[m][p],x=i[m][M],b=c,_=c+=x*n;g[m+"-"+M]={index:m,subindex:M,startAngle:b,endAngle:_,value:x}}r[m]={index:m,startAngle:s,endAngle:c,value:v[m]},c+=f}for(h=-1;++h<u;)for(p=h-1;++p<u;){var w=g[h+"-"+p],S=g[p+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}l&&t()}function t(){e.sort(function(n,t){return l((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,i,u,o,a,l,c={},f=0;return c.matrix=function(n){return arguments.length?(u=(i=n)&&i.length,e=r=null,c):i},c.padding=function(n){return arguments.length?(f=n,e=r=null,c):f},c.sortGroups=function(n){return arguments.length?(o=n,e=r=null,c):o},c.sortSubgroups=function(n){return arguments.length?(a=n,e=null,c):a},c.sortChords=function(n){return arguments.length?(l=n,e&&t(),c):l},c.chords=function(){return e||n(),e},c.groups=function(){return r||n(),r},c},Bi.layout.force=function(){function n(n){return function(t,e,r,i){if(t.point!==n){var u=t.cx-n.x,o=t.cy-n.y,a=i-e,l=u*u+o*o;if(a*a/m<l){if(l<v){var c=t.charge/l;n.px-=u*c,n.py-=o*c}return!0}if(t.point&&l&&l<v){c=t.pointCharge/l;n.px-=u*c,n.py-=o*c}}return!t.charge}}function t(n){n.px=Bi.event.x,n.py=Bi.event.y,l.resume()}var e,r,i,u,o,a,l={},c=Bi.dispatch("start","tick","end"),f=[1,1],s=.9,h=ta,p=ea,g=-30,v=ra,d=.1,m=.64,M=[],x=[];return l.tick=function(){if((i*=.99)<.005)return e=null,c.end({type:"end",alpha:i=0}),!0;var t,r,l,h,p,v,y,m,b,_=M.length,w=x.length;for(r=0;r<w;++r)h=(l=x[r]).source,(v=(m=(p=l.target).x-h.x)*m+(b=p.y-h.y)*b)&&(m*=v=i*o[r]*((v=Math.sqrt(v))-u[r])/v,b*=v,p.x-=m*(y=h.weight+p.weight?h.weight/(h.weight+p.weight):.5),p.y-=b*y,h.x+=m*(y=1-y),h.y+=b*y);if((y=i*d)&&(m=f[0]/2,b=f[1]/2,r=-1,y))for(;++r<_;)(l=M[r]).x+=(m-l.x)*y,l.y+=(b-l.y)*y;if(g)for(lr(t=Bi.geom.quadtree(M),i,a),r=-1;++r<_;)(l=M[r]).fixed||t.visit(n(l));for(r=-1;++r<_;)(l=M[r]).fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*s,l.y-=(l.py-(l.py=l.y))*s);c.tick({type:"tick",alpha:i})},l.nodes=function(n){return arguments.length?(M=n,l):M},l.links=function(n){return arguments.length?(x=n,l):x},l.size=function(n){return arguments.length?(f=n,l):f},l.linkDistance=function(n){return arguments.length?(h="function"==typeof n?n:+n,l):h},l.distance=l.linkDistance,l.linkStrength=function(n){return arguments.length?(p="function"==typeof n?n:+n,l):p},l.friction=function(n){return arguments.length?(s=+n,l):s},l.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,l):g},l.chargeDistance=function(n){return arguments.length?(v=n*n,l):Math.sqrt(v)},l.gravity=function(n){return arguments.length?(d=+n,l):d},l.theta=function(n){return arguments.length?(m=n*n,l):Math.sqrt(m)},l.alpha=function(n){return arguments.length?(n=+n,i?n>0?i=n:(e.c=null,e.t=NaN,e=null,c.end({type:"end",alpha:i=0})):n>0&&(c.start({type:"start",alpha:i=n}),e=Sn(l.tick)),l):i},l.start=function(){function n(n,r){if(!e){for(e=new Array(i),l=0;l<i;++l)e[l]=[];for(l=0;l<c;++l){var u=x[l];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var o,a=e[t],l=-1,f=a.length;++l<f;)if(!isNaN(o=a[l][n]))return o;return Math.random()*r}var t,e,r,i=M.length,c=x.length,s=f[0],v=f[1];for(t=0;t<i;++t)(r=M[t]).index=t,r.weight=0;for(t=0;t<c;++t)"number"==typeof(r=x[t]).source&&(r.source=M[r.source]),"number"==typeof r.target&&(r.target=M[r.target]),++r.source.weight,++r.target.weight;for(t=0;t<i;++t)r=M[t],isNaN(r.x)&&(r.x=n("x",s)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof h)for(t=0;t<c;++t)u[t]=+h.call(this,x[t],t);else for(t=0;t<c;++t)u[t]=h;if(o=[],"function"==typeof p)for(t=0;t<c;++t)o[t]=+p.call(this,x[t],t);else for(t=0;t<c;++t)o[t]=p;if(a=[],"function"==typeof g)for(t=0;t<i;++t)a[t]=+g.call(this,M[t],t);else for(t=0;t<i;++t)a[t]=g;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){if(r||(r=Bi.behavior.drag().origin(y).on("dragstart.force",ir).on("drag.force",t).on("dragend.force",ur)),!arguments.length)return r;this.on("mouseover.force",or).on("mouseout.force",ar).call(r)},Bi.rebind(l,c,"on")};var ta=20,ea=1,ra=1/0;Bi.layout.hierarchy=function(){function n(i){var u,o=[i],a=[];for(i.depth=0;null!=(u=o.pop());)if(a.push(u),(c=e.call(n,u,u.depth))&&(l=c.length)){for(var l,c,f;--l>=0;)o.push(f=c[l]),f.parent=u,f.depth=u.depth+1;r&&(u.value=0),u.children=c}else r&&(u.value=+r.call(n,u,u.depth)||0),delete u.children;return sr(i,function(n){var e,i;t&&(e=n.children)&&e.sort(t),r&&(i=n.parent)&&(i.value+=n.value)}),a}var t=gr,e=hr,r=pr;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&(fr(t,function(n){n.children&&(n.value=0)}),sr(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},Bi.layout.partition=function(){function n(t,e,r,i){var u=t.children;if(t.x=e,t.y=t.depth*i,t.dx=r,t.dy=i,u&&(o=u.length)){var o,a,l,c=-1;for(r=t.value?r/t.value:0;++c<o;)n(a=u[c],e,l=a.value*r,i),e+=l}}function t(n){var e=n.children,r=0;if(e&&(i=e.length))for(var i,u=-1;++u<i;)r=Math.max(r,t(e[u]));return 1+r}function e(e,u){var o=r.call(this,e,u);return n(o[0],0,i[0],i[1]/t(o[0])),o}var r=Bi.layout.hierarchy(),i=[1,1];return e.size=function(n){return arguments.length?(i=n,e):i},cr(e,r)},Bi.layout.pie=function(){function n(o){var a,l=o.length,c=o.map(function(e,r){return+t.call(n,e,r)}),f=+("function"==typeof r?r.apply(this,arguments):r),s=("function"==typeof i?i.apply(this,arguments):i)-f,h=Math.min(Math.abs(s)/l,+("function"==typeof u?u.apply(this,arguments):u)),p=h*(s<0?-1:1),g=Bi.sum(c),v=g?(s-l*p)/g:0,d=Bi.range(l),y=[];return null!=e&&d.sort(e===ia?function(n,t){return c[t]-c[n]}:function(n,t){return e(o[n],o[t])}),d.forEach(function(n){y[n]={data:o[n],value:a=c[n],startAngle:f,endAngle:f+=a*v+p,padAngle:h}}),y}var t=Number,e=ia,r=0,i=Su,u=0;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(i=t,n):i},n.padAngle=function(t){return arguments.length?(u=t,n):u},n};var ia={};Bi.layout.stack=function(){function n(a,l){if(!(h=a.length))return a;var c=a.map(function(e,r){return t.call(n,e,r)}),f=c.map(function(t){return t.map(function(t,e){return[u.call(n,t,e),o.call(n,t,e)]})}),s=e.call(n,f,l);c=Bi.permute(c,s),f=Bi.permute(f,s);var h,p,g,v,d=r.call(n,f,l),y=c[0].length;for(g=0;g<y;++g)for(i.call(n,c[0][g],v=d[g],f[0][g][1]),p=1;p<h;++p)i.call(n,c[p][g],v+=f[p-1][g][1],f[p][g][1]);return a}var t=y,e=Mr,r=xr,i=mr,u=dr,o=yr;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:ua.get(t)||Mr,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:oa.get(t)||xr,n):r},n.x=function(t){return arguments.length?(u=t,n):u},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(i=t,n):i},n};var ua=Bi.map({"inside-out":function(n){var t,e,r=n.length,i=n.map(br),u=n.map(_r),o=Bi.range(r).sort(function(n,t){return i[n]-i[t]}),a=0,l=0,c=[],f=[];for(t=0;t<r;++t)e=o[t],a<l?(a+=u[e],c.push(e)):(l+=u[e],f.push(e));return f.reverse().concat(c)},reverse:function(n){return Bi.range(n.length).reverse()},default:Mr}),oa=Bi.map({silhouette:function(n){var t,e,r,i=n.length,u=n[0].length,o=[],a=0,l=[];for(e=0;e<u;++e){for(t=0,r=0;t<i;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;e<u;++e)l[e]=(a-o[e])/2;return l},wiggle:function(n){var t,e,r,i,u,o,a,l,c,f=n.length,s=n[0],h=s.length,p=[];for(p[0]=l=c=0,e=1;e<h;++e){for(t=0,i=0;t<f;++t)i+=n[t][e][1];for(t=0,u=0,a=s[e][0]-s[e-1][0];t<f;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);r<t;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;u+=o*n[t][e][1]}p[e]=l-=i?u/i*a:0,l<c&&(c=l)}for(e=0;e<h;++e)p[e]-=c;return p},expand:function(n){var t,e,r,i=n.length,u=n[0].length,o=1/i,a=[];for(e=0;e<u;++e){for(t=0,r=0;t<i;t++)r+=n[t][e][1];if(r)for(t=0;t<i;t++)n[t][e][1]/=r;else for(t=0;t<i;t++)n[t][e][1]=o}for(e=0;e<u;++e)a[e]=0;return a},zero:xr});Bi.layout.histogram=function(){function n(n,u){for(var o,a,l=[],c=n.map(e,this),f=r.call(this,c,u),s=i.call(this,f,c,u),h=(u=-1,c.length),p=s.length-1,g=t?1:1/h;++u<p;)(o=l[u]=[]).dx=s[u+1]-(o.x=s[u]),o.y=0;if(p>0)for(u=-1;++u<h;)(a=c[u])>=f[0]&&a<=f[1]&&((o=l[Bi.bisect(s,a,1,p)-1]).y+=g,o.push(n[u]));return l}var t=!0,e=Number,r=Nr,i=Sr;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=bn(t),n):r},n.bins=function(t){return arguments.length?(i="number"==typeof t?function(n){return kr(n,t)}:bn(t),n):i},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},Bi.layout.pack=function(){function n(n,u){var o=e.call(this,n,u),a=o[0],l=i[0],c=i[1],f=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,sr(a,function(n){n.r=+f(n.value)}),sr(a,Lr),r){var s=r*(t?1:Math.max(2*a.r/l,2*a.r/c))/2;sr(a,function(n){n.r+=s}),sr(a,Lr),sr(a,function(n){n.r-=s})}return Rr(a,l/2,c/2,t?1:1/Math.max(2*a.r/l,2*a.r/c)),o}var t,e=Bi.layout.hierarchy().sort(Er),r=0,i=[1,1];return n.size=function(t){return arguments.length?(i=t,n):i},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},cr(n,e)},Bi.layout.tree=function(){function n(n,l){var c=i.call(this,n,l),f=c[0],s=function(n){var t,e={A:null,children:[n]},r=[e];for(;null!=(t=r.pop());)for(var i,u=t.children,o=0,a=u.length;o<a;++o)r.push((u[o]=i={_:u[o],parent:t,children:(i=u[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i);return e.children[0]}(f);if(sr(s,t),s.parent.m=-s.z,fr(s,e),a)fr(f,r);else{var h=f,p=f,g=f;fr(f,function(n){n.x<h.x&&(h=n),n.x>p.x&&(p=n),n.depth>g.depth&&(g=n)});var v=u(h,p)/2-h.x,d=o[0]/(p.x+u(p,h)/2+v),y=o[1]/(g.depth||1);fr(f,function(n){n.x=(n.x+v)*d,n.y=n.depth*y})}return c}function t(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){!function(n){for(var t,e=0,r=0,i=n.children,u=i.length;--u>=0;)(t=i[u]).z+=e,t.m+=e,e+=t.s+(r+=t.c)}(n);var i=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+u(n._,r._),n.m=n.z-i):n.z=i}else r&&(n.z=r.z+u(n._,r._));n.parent.A=function(n,t,e){if(t){for(var r,i=n,o=n,a=t,l=i.parent.children[0],c=i.m,f=o.m,s=a.m,h=l.m;a=jr(a),i=Ur(i),a&&i;)l=Ur(l),(o=jr(o)).a=n,(r=a.z+s-i.z-c+u(a._,i._))>0&&(!function(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}(function(n,t,e){return n.a.parent===t.parent?n.a:e}(a,n,e),n,r),c+=r,f+=r),s+=a.m,c+=i.m,h+=l.m,f+=o.m;a&&!jr(o)&&(o.t=a,o.m+=s-f),i&&!Ur(l)&&(l.t=i,l.m+=c-h,e=n)}return e}(n,r,n.parent.A||e[0])}function e(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function r(n){n.x*=o[0],n.y=n.depth*o[1]}var i=Bi.layout.hierarchy().sort(null).value(null),u=Pr,o=[1,1],a=null;return n.separation=function(t){return arguments.length?(u=t,n):u},n.size=function(t){return arguments.length?(a=null==(o=t)?r:null,n):a?null:o},n.nodeSize=function(t){return arguments.length?(a=null==(o=t)?null:r,n):a?o:null},cr(n,i)},Bi.layout.cluster=function(){function n(n,u){var o,a=t.call(this,n,u),l=a[0],c=0;sr(l,function(n){var t=n.children;t&&t.length?(n.x=function(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}(t),n.y=function(n){return 1+Bi.max(n,function(n){return n.y})}(t)):(n.x=o?c+=e(n,o):0,n.y=0,o=n)});var f=Fr(l),s=Hr(l),h=f.x-e(f,s)/2,p=s.x+e(s,f)/2;return sr(l,i?function(n){n.x=(n.x-l.x)*r[0],n.y=(l.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(p-h)*r[0],n.y=(1-(l.y?n.y/l.y:1))*r[1]}),a}var t=Bi.layout.hierarchy().sort(null).value(null),e=Pr,r=[1,1],i=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(i=null==(r=t),n):i?null:r},n.nodeSize=function(t){return arguments.length?(i=null!=(r=t),n):i?r:null},cr(n,t)},Bi.layout.treemap=function(){function n(n,t){for(var e,r,i=-1,u=n.length;++i<u;)r=(e=n[i]).value*(t<0?0:t),e.area=isNaN(r)||r<=0?0:r}function t(e){var i=e.children;if(i&&i.length){var u,o,a,l=f(e),c=[],s=i.slice(),g=1/0,v="slice"===h?l.dx:"dice"===h?l.dy:"slice-dice"===h?1&e.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(n(s,l.dx*l.dy/e.value),c.area=0;(a=s.length)>0;)c.push(u=s[a-1]),c.area+=u.area,"squarify"!==h||(o=function(n,t){var e,r=n.area,i=0,u=1/0,o=-1,a=n.length;for(;++o<a;)(e=n[o].area)&&(e<u&&(u=e),e>i&&(i=e));return r*=r,t*=t,r?Math.max(t*i*p/r,r/(t*u*p)):1/0}(c,v))<=g?(s.pop(),g=o):(c.area-=c.pop().area,r(c,v,l,!1),v=Math.min(l.dx,l.dy),c.length=c.area=0,g=1/0);c.length&&(r(c,v,l,!0),c.length=c.area=0),i.forEach(t)}}function e(t){var i=t.children;if(i&&i.length){var u,o=f(t),a=i.slice(),l=[];for(n(a,o.dx*o.dy/t.value),l.area=0;u=a.pop();)l.push(u),l.area+=u.area,null!=u.z&&(r(l,u.z?o.dx:o.dy,o,!a.length),l.length=l.area=0);i.forEach(e)}}function r(n,t,e,r){var i,u=-1,o=n.length,l=e.x,c=e.y,f=t?a(n.area/t):0;if(t==e.dx){for((r||f>e.dy)&&(f=e.dy);++u<o;)(i=n[u]).x=l,i.y=c,i.dy=f,l+=i.dx=Math.min(e.x+e.dx-l,f?a(i.area/f):0);i.z=!0,i.dx+=e.x+e.dx-l,e.y+=f,e.dy-=f}else{for((r||f>e.dx)&&(f=e.dx);++u<o;)(i=n[u]).x=l,i.y=c,i.dx=f,c+=i.dy=Math.min(e.y+e.dy-c,f?a(i.area/f):0);i.z=!1,i.dy+=e.y+e.dy-c,e.x+=f,e.dx-=f}}function i(r){var i=u||o(r),a=i[0];return a.x=a.y=0,a.value?(a.dx=l[0],a.dy=l[1]):a.dx=a.dy=0,u&&o.revalue(a),n([a],a.dx*a.dy/a.value),(u?e:t)(a),s&&(u=i),i}var u,o=Bi.layout.hierarchy(),a=Math.round,l=[1,1],c=null,f=Or,s=!1,h="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(n){return arguments.length?(l=n,i):l},i.padding=function(n){function t(t){return Ir(t,n)}if(!arguments.length)return c;var e;return f=null==(c=n)?Or:"function"==(e=typeof n)?function(t){var e=n.call(i,t,t.depth);return null==e?Or(t):Ir(t,"number"==typeof e?[e,e,e,e]:e)}:"number"===e?(n=[n,n,n,n],t):t,i},i.round=function(n){return arguments.length?(a=n?Math.round:Number,i):a!=Number},i.sticky=function(n){return arguments.length?(s=n,u=null,i):s},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(h=n+"",i):h},cr(i,o)},Bi.random={normal:function(n,t){var e=arguments.length;return e<2&&(t=1),e<1&&(n=0),function(){var e,r,i;do{i=(e=2*Math.random()-1)*e+(r=2*Math.random()-1)*r}while(!i||i>1);return n+t*e*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var n=Bi.random.normal.apply(Bi,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=Bi.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;e<n;e++)t+=Math.random();return t}}},Bi.scale={};var aa={floor:y,ceil:y};Bi.scale.linear=function(){return $r([0,1],[0,1],He,!1)};var la={s:1,g:1,p:1,r:1,e:1};Bi.scale.log=function(){return ni(Bi.scale.linear().domain([0,1]),10,!0,[1,10])};var ca=Bi.format(".0e"),fa={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};Bi.scale.pow=function(){return ti(Bi.scale.linear(),1,[0,1])},Bi.scale.sqrt=function(){return Bi.scale.pow().exponent(.5)},Bi.scale.ordinal=function(){return ri([],{t:"range",a:[[]]})},Bi.scale.category10=function(){return Bi.scale.ordinal().range(sa)},Bi.scale.category20=function(){return Bi.scale.ordinal().range(ha)},Bi.scale.category20b=function(){return Bi.scale.ordinal().range(pa)},Bi.scale.category20c=function(){return Bi.scale.ordinal().range(ga)};var sa=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(gn),ha=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(gn),pa=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(gn),ga=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(gn);Bi.scale.quantile=function(){return ii([],[])},Bi.scale.quantize=function(){return ui(0,1,[0,1])},Bi.scale.threshold=function(){return oi([.5],[0,1])},Bi.scale.identity=function(){return ai([0,1])},Bi.svg={},Bi.svg.arc=function(){function n(){var n=Math.max(0,+e.apply(this,arguments)),c=Math.max(0,+r.apply(this,arguments)),f=o.apply(this,arguments)-Nu,s=a.apply(this,arguments)-Nu,h=Math.abs(s-f),p=f>s?0:1;if(c<n&&(g=c,c=n,n=g),h>=ku)return t(c,p)+(n?t(n,1-p):"")+"Z";var g,v,d,y,m,M,x,b,_,w,S,k,N=0,E=0,A=[];if((y=(+l.apply(this,arguments)||0)/2)&&(d=u===va?Math.sqrt(n*n+c*c):+u.apply(this,arguments),p||(E*=-1),c&&(E=G(d/c*Math.sin(y))),n&&(N=G(d/n*Math.sin(y)))),c){m=c*Math.cos(f+E),M=c*Math.sin(f+E),x=c*Math.cos(s-E),b=c*Math.sin(s-E);var C=Math.abs(s-f-2*E)<=wu?0:1;if(E&&gi(m,M,x,b)===p^C){var z=(f+s)/2;m=c*Math.cos(z),M=c*Math.sin(z),x=b=null}}else m=M=0;if(n){_=n*Math.cos(s-N),w=n*Math.sin(s-N),S=n*Math.cos(f+N),k=n*Math.sin(f+N);var L=Math.abs(f-s+2*N)<=wu?0:1;if(N&&gi(_,w,S,k)===1-p^L){var q=(f+s)/2;_=n*Math.cos(q),w=n*Math.sin(q),S=k=null}}else _=w=0;if(h>bu&&(g=Math.min(Math.abs(c-n)/2,+i.apply(this,arguments)))>.001){v=n<c^p?0:1;var T=g,R=g;if(h<wu){var D=null==S?[_,w]:null==x?[m,M]:fe([m,M],[S,k],[x,b],[_,w]),P=m-D[0],U=M-D[1],j=x-D[0],F=b-D[1],H=1/Math.sin(Math.acos((P*j+U*F)/(Math.sqrt(P*P+U*U)*Math.sqrt(j*j+F*F)))/2),O=Math.sqrt(D[0]*D[0]+D[1]*D[1]);R=Math.min(g,(n-O)/(H-1)),T=Math.min(g,(c-O)/(H+1))}if(null!=x){var I=vi(null==S?[_,w]:[S,k],[m,M],c,T,p),Y=vi([x,b],[_,w],c,T,p);g===T?A.push("M",I[0],"A",T,",",T," 0 0,",v," ",I[1],"A",c,",",c," 0 ",1-p^gi(I[1][0],I[1][1],Y[1][0],Y[1][1]),",",p," ",Y[1],"A",T,",",T," 0 0,",v," ",Y[0]):A.push("M",I[0],"A",T,",",T," 0 1,",v," ",Y[0])}else A.push("M",m,",",M);if(null!=S){var Z=vi([m,M],[S,k],n,-R,p),V=vi([_,w],null==x?[m,M]:[x,b],n,-R,p);g===R?A.push("L",V[0],"A",R,",",R," 0 0,",v," ",V[1],"A",n,",",n," 0 ",p^gi(V[1][0],V[1][1],Z[1][0],Z[1][1]),",",1-p," ",Z[1],"A",R,",",R," 0 0,",v," ",Z[0]):A.push("L",V[0],"A",R,",",R," 0 0,",v," ",Z[0])}else A.push("L",_,",",w)}else A.push("M",m,",",M),null!=x&&A.push("A",c,",",c," 0 ",C,",",p," ",x,",",b),A.push("L",_,",",w),null!=S&&A.push("A",n,",",n," 0 ",L,",",1-p," ",S,",",k);return A.push("Z"),A.join("")}function t(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var e=ci,r=fi,i=li,u=va,o=si,a=hi,l=pi;return n.innerRadius=function(t){return arguments.length?(e=bn(t),n):e},n.outerRadius=function(t){return arguments.length?(r=bn(t),n):r},n.cornerRadius=function(t){return arguments.length?(i=bn(t),n):i},n.padRadius=function(t){return arguments.length?(u=t==va?va:bn(t),n):u},n.startAngle=function(t){return arguments.length?(o=bn(t),n):o},n.endAngle=function(t){return arguments.length?(a=bn(t),n):a},n.padAngle=function(t){return arguments.length?(l=bn(t),n):l},n.centroid=function(){var n=(+e.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-Nu;return[Math.cos(t)*n,Math.sin(t)*n]},n};var va="auto";Bi.svg.line=function(){return di(y)};var da=Bi.map({linear:yi,"linear-closed":mi,step:function(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&i.push("H",r[0]),i.join("")},"step-before":Mi,"step-after":xi,basis:wi,"basis-open":function(n){if(n.length<4)return yi(n);for(var t,e=[],r=-1,i=n.length,u=[0],o=[0];++r<3;)t=n[r],u.push(t[0]),o.push(t[1]);for(e.push(Si(Ma,u)+","+Si(Ma,o)),--r;++r<i;)t=n[r],u.shift(),u.push(t[0]),o.shift(),o.push(t[1]),ki(e,u,o);return e.join("")},"basis-closed":function(n){for(var t,e,r=-1,i=n.length,u=i+4,o=[],a=[];++r<4;)e=n[r%i],o.push(e[0]),a.push(e[1]);for(t=[Si(Ma,o),",",Si(Ma,a)],--r;++r<u;)e=n[r%i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),ki(t,o,a);return t.join("")},bundle:function(n,t){var e=n.length-1;if(e)for(var r,i,u=n[0][0],o=n[0][1],a=n[e][0]-u,l=n[e][1]-o,c=-1;++c<=e;)i=c/e,(r=n[c])[0]=t*r[0]+(1-t)*(u+i*a),r[1]=t*r[1]+(1-t)*(o+i*l);return wi(n)},cardinal:function(n,t){return n.length<3?yi(n):n[0]+bi(n,_i(n,t))},"cardinal-open":function(n,t){return n.length<4?yi(n):n[1]+bi(n.slice(1,-1),_i(n,t))},"cardinal-closed":function(n,t){return n.length<3?mi(n):n[0]+bi((n.push(n[0]),n),_i([n[n.length-2]].concat(n,[n[1]]),t))},monotone:function(n){return n.length<3?yi(n):n[0]+bi(n,Ei(n))}});da.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var ya=[0,2/3,1/3,0],ma=[0,1/3,2/3,0],Ma=[0,1/6,2/3,1/6];Bi.svg.line.radial=function(){var n=di(Ai);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},Mi.reverse=xi,xi.reverse=Mi,Bi.svg.area=function(){return Ci(y)},Bi.svg.area.radial=function(){var n=Ci(Ai);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},Bi.svg.chord=function(){function n(n,o){var a=t(this,i,n,o),l=t(this,u,n,o);return"M"+a.p0+e(a.r,a.p1,a.a1-a.a0)+(function(n,t){return n.a0==t.a0&&n.a1==t.a1}(a,l)?r(a.r,a.p1,a.r,a.p0):r(a.r,a.p1,l.r,l.p0)+e(l.r,l.p1,l.a1-l.a0)+r(l.r,l.p1,a.r,a.p0))+"Z"}function t(n,t,e,r){var i=t.call(n,e,r),u=o.call(n,i,r),c=a.call(n,i,r)-Nu,f=l.call(n,i,r)-Nu;return{r:u,a0:c,a1:f,p0:[u*Math.cos(c),u*Math.sin(c)],p1:[u*Math.cos(f),u*Math.sin(f)]}}function e(n,t,e){return"A"+n+","+n+" 0 "+ +(e>wu)+",1 "+t}function r(n,t,e,r){return"Q 0,0 "+r}var i=Gt,u=Kt,o=zi,a=si,l=hi;return n.radius=function(t){return arguments.length?(o=bn(t),n):o},n.source=function(t){return arguments.length?(i=bn(t),n):i},n.target=function(t){return arguments.length?(u=bn(t),n):u},n.startAngle=function(t){return arguments.length?(a=bn(t),n):a},n.endAngle=function(t){return arguments.length?(l=bn(t),n):l},n},Bi.svg.diagonal=function(){function n(n,i){var u=t.call(this,n,i),o=e.call(this,n,i),a=(u.y+o.y)/2,l=[u,{x:u.x,y:a},{x:o.x,y:a},o];return"M"+(l=l.map(r))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var t=Gt,e=Kt,r=Li;return n.source=function(e){return arguments.length?(t=bn(e),n):t},n.target=function(t){return arguments.length?(e=bn(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},Bi.svg.diagonal.radial=function(){var n=Bi.svg.diagonal(),t=Li,e=n.projection;return n.projection=function(n){return arguments.length?e(function(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-Nu;return[e*Math.cos(r),e*Math.sin(r)]}}(t=n)):t},n},Bi.svg.symbol=function(){function n(n,r){return(xa.get(t.call(this,n,r))||Ri)(e.call(this,n,r))}var t=Ti,e=qi;return n.type=function(e){return arguments.length?(t=bn(e),n):t},n.size=function(t){return arguments.length?(e=bn(t),n):e},n};var xa=Bi.map({circle:Ri,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*_a)),e=t*_a;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/ba),e=t*ba/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/ba),e=t*ba/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});Bi.svg.symbolTypes=xa.keys();var ba=Math.sqrt(3),_a=Math.tan(30*Eu);pu.transition=function(n){for(var t,e,r=wa||++Ea,i=Fi(n),u=[],o=Sa||{time:Date.now(),ease:function(n){if(n<=0)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(n<.5?e:3*(n-t)+e-.75)},delay:0,duration:250},a=-1,l=this.length;++a<l;){u.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(e=c[f])&&Hi(e,f,i,r,o),t.push(e)}return Pi(u,i,r)},pu.interrupt=function(n){return this.each(null==n?ka:Di(Fi(n)))};var wa,Sa,ka=Di(Fi()),Na=[],Ea=0;Na.call=pu.call,Na.empty=pu.empty,Na.node=pu.node,Na.size=pu.size,Bi.transition=function(n,t){return n&&n.transition?wa?n.transition(t):n:Bi.selection().transition(n)},Bi.transition.prototype=Na,Na.select=function(n){var t,e,r,i=this.id,u=this.namespace,o=[];n=N(n);for(var a=-1,l=this.length;++a<l;){o.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(r=c[f])&&(e=n.call(r,r.__data__,f,a))?("__data__"in r&&(e.__data__=r.__data__),Hi(e,f,u,i,r[u][i]),t.push(e)):t.push(null)}return Pi(o,u,i)},Na.selectAll=function(n){var t,e,r,i,u,o=this.id,a=this.namespace,l=[];n=E(n);for(var c=-1,f=this.length;++c<f;)for(var s=this[c],h=-1,p=s.length;++h<p;)if(r=s[h]){u=r[a][o],e=n.call(r,r.__data__,h,c),l.push(t=[]);for(var g=-1,v=e.length;++g<v;)(i=e[g])&&Hi(i,g,a,o,u),t.push(i)}return Pi(l,a,o)},Na.filter=function(n){var t,e,r=[];"function"!=typeof n&&(n=F(n));for(var i=0,u=this.length;i<u;i++){r.push(t=[]);for(var o,a=0,l=(o=this[i]).length;a<l;a++)(e=o[a])&&n.call(e,e.__data__,a,i)&&t.push(e)}return Pi(r,this.namespace,this.id)},Na.tween=function(n,t){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(n):H(this,null==t?function(t){t[r][e].tween.remove(n)}:function(i){i[r][e].tween.set(n,t)})},Na.attr=function(n,t){if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var e="transform"==n?tr:He,r=Bi.ns.qualify(n);return Ui(this,"attr."+n,t,r.local?function(n){return null==n?function(){this.removeAttributeNS(r.space,r.local)}:(n+="",function(){var t,i=this.getAttributeNS(r.space,r.local);return i!==n&&(t=e(i,n),function(n){this.setAttributeNS(r.space,r.local,t(n))})})}:function(n){return null==n?function(){this.removeAttribute(r)}:(n+="",function(){var t,i=this.getAttribute(r);return i!==n&&(t=e(i,n),function(n){this.setAttribute(r,t(n))})})})},Na.attrTween=function(n,t){var e=Bi.ns.qualify(n);return this.tween("attr."+n,e.local?function(n,r){var i=t.call(this,n,r,this.getAttributeNS(e.space,e.local));return i&&function(n){this.setAttributeNS(e.space,e.local,i(n))}}:function(n,r){var i=t.call(this,n,r,this.getAttribute(e));return i&&function(n){this.setAttribute(e,i(n))}})},Na.style=function(n,e,r){var i=arguments.length;if(i<3){if("string"!=typeof n){i<2&&(e="");for(r in n)this.style(r,n[r],e);return this}r=""}return Ui(this,"style."+n,e,function(e){return null==e?function(){this.style.removeProperty(n)}:(e+="",function(){var i,u=t(this).getComputedStyle(this,null).getPropertyValue(n);return u!==e&&(i=He(u,e),function(t){this.style.setProperty(n,i(t),r)})})})},Na.styleTween=function(n,e,r){return arguments.length<3&&(r=""),this.tween("style."+n,function(i,u){var o=e.call(this,i,u,t(this).getComputedStyle(this,null).getPropertyValue(n));return o&&function(t){this.style.setProperty(n,o(t),r)}})},Na.text=function(n){return Ui(this,"text",n,ji)},Na.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Na.ease=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].ease:("function"!=typeof n&&(n=Bi.ease.apply(Bi,arguments)),H(this,function(r){r[e][t].ease=n}))},Na.delay=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].delay:H(this,"function"==typeof n?function(r,i,u){r[e][t].delay=+n.call(r,r.__data__,i,u)}:(n=+n,function(r){r[e][t].delay=n}))},Na.duration=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].duration:H(this,"function"==typeof n?function(r,i,u){r[e][t].duration=Math.max(1,n.call(r,r.__data__,i,u))}:(n=Math.max(1,n),function(r){r[e][t].duration=n}))},Na.each=function(n,t){var e=this.id,r=this.namespace;if(arguments.length<2){var i=Sa,u=wa;try{wa=e,H(this,function(t,i,u){Sa=t[r][e],n.call(t,t.__data__,i,u)})}finally{Sa=i,wa=u}}else H(this,function(i){var u=i[r][e];(u.event||(u.event=Bi.dispatch("start","end","interrupt"))).on(n,t)});return this},Na.transition=function(){for(var n,t,e,r=this.id,i=++Ea,u=this.namespace,o=[],a=0,l=this.length;a<l;a++){o.push(n=[]);for(var c,f=0,s=(c=this[a]).length;f<s;f++)(t=c[f])&&Hi(t,f,u,i,{time:(e=t[u][r]).time,ease:e.ease,delay:e.delay+e.duration,duration:e.duration}),n.push(t)}return Pi(o,u,i)},Bi.svg.axis=function(){function n(n){n.each(function(){var n,c=Bi.select(this),f=this.__chart__||e,s=this.__chart__=e.copy(),h=null==l?s.ticks?s.ticks.apply(s,a):s.domain():l,p=null==t?s.tickFormat?s.tickFormat.apply(s,a):y:t,g=c.selectAll(".tick").data(h,s),v=g.enter().insert("g",".domain").attr("class","tick").style("opacity",bu),d=Bi.transition(g.exit()).style("opacity",bu).remove(),m=Bi.transition(g.order()).style("opacity",1),M=Math.max(i,0)+o,x=Zr(s),b=c.selectAll(".domain").data([0]),_=(b.enter().append("path").attr("class","domain"),Bi.transition(b));v.append("line"),v.append("text");var w,S,k,N,E=v.select("line"),A=m.select("line"),C=g.select("text").text(p),z=v.select("text"),L=m.select("text"),q="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(n=Oi,w="x",k="y",S="x2",N="y2",C.attr("dy",q<0?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+x[0]+","+q*u+"V0H"+x[1]+"V"+q*u)):(n=Ii,w="y",k="x",S="y2",N="x2",C.attr("dy",".32em").style("text-anchor",q<0?"end":"start"),_.attr("d","M"+q*u+","+x[0]+"H0V"+x[1]+"H"+q*u)),E.attr(N,q*i),z.attr(k,q*M),A.attr(S,0).attr(N,q*i),L.attr(w,0).attr(k,q*M),s.rangeBand){var T=s,R=T.rangeBand()/2;f=s=function(n){return T(n)+R}}else f.rangeBand?f=s:d.call(n,s,f);v.call(n,f,s),m.call(n,s,s)})}var t,e=Bi.scale.linear(),r=Aa,i=6,u=6,o=3,a=[10],l=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Ca?t+"":Aa,n):r},n.ticks=function(){return arguments.length?(a=Ji(arguments),n):a},n.tickValues=function(t){return arguments.length?(l=t,n):l},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(i=+t,u=+arguments[e-1],n):i},n.innerTickSize=function(t){return arguments.length?(i=+t,n):i},n.outerTickSize=function(t){return arguments.length?(u=+t,n):u},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var Aa="bottom",Ca={top:1,right:1,bottom:1,left:1};Bi.svg.brush=function(){function n(t){t.each(function(){var t=Bi.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",u).on("touchstart.brush",u),o=t.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=t.selectAll(".resize").data(v,y);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return za[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var l,s=Bi.transition(t),h=Bi.transition(o);c&&(l=Zr(c),h.attr("x",l[0]).attr("width",l[1]-l[0]),r(s)),f&&(l=Zr(f),h.attr("y",l[0]).attr("height",l[1]-l[0]),i(s)),e(s)})}function e(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+s[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function r(n){n.select(".extent").attr("x",s[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function i(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function u(){function u(){var n=Bi.mouse(M),t=!1;m&&(n[0]+=m[0],n[1]+=m[1]),E||(Bi.event.altKey?(y||(y=[(s[0]+s[1])/2,(h[0]+h[1])/2]),C[0]=s[+(n[0]<y[0])],C[1]=h[+(n[1]<y[1])]):y=null),k&&v(n,c,0)&&(r(w),t=!0),N&&v(n,f,1)&&(i(w),t=!0),t&&(e(w),b({type:"brush",mode:E?"move":"resize"}))}function v(n,t,e){var r,i,u=Zr(t),l=u[0],c=u[1],f=C[e],v=e?h:s,d=v[1]-v[0];if(E&&(l-=f,c-=d+f),r=(e?g:p)?Math.max(l,Math.min(c,n[e])):n[e],E?i=(r+=f)+d:(y&&(f=Math.max(l,Math.min(c,2*y[e]-r))),f<r?(i=r,r=f):i=f),v[0]!=r||v[1]!=i)return e?a=null:o=null,v[0]=r,v[1]=i,!0}function d(){u(),w.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),Bi.select("body").style("cursor",null),z.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),A(),b({type:"brushend"})}var y,m,M=this,x=Bi.select(Bi.event.target),b=l.of(M,arguments),w=Bi.select(M),S=x.datum(),k=!/^(n|s)$/.test(S)&&c,N=!/^(e|w)$/.test(S)&&f,E=x.classed("extent"),A=V(M),C=Bi.mouse(M),z=Bi.select(t(M)).on("keydown.brush",function(){32==Bi.event.keyCode&&(E||(y=null,C[0]-=s[1],C[1]-=h[1],E=2),_())}).on("keyup.brush",function(){32==Bi.event.keyCode&&2==E&&(C[0]+=s[1],C[1]+=h[1],E=0,_())});if(Bi.event.changedTouches?z.on("touchmove.brush",u).on("touchend.brush",d):z.on("mousemove.brush",u).on("mouseup.brush",d),w.interrupt().selectAll("*").interrupt(),E)C[0]=s[0]-C[0],C[1]=h[0]-C[1];else if(S){var L=+/w$/.test(S),q=+/^n/.test(S);m=[s[1-L]-C[0],h[1-q]-C[1]],C[0]=s[L],C[1]=h[q]}else Bi.event.altKey&&(y=C.slice());w.style("pointer-events","none").selectAll(".resize").style("display",null),Bi.select("body").style("cursor",x.style("cursor")),b({type:"brushstart"}),u()}var o,a,l=S(n,"brushstart","brush","brushend"),c=null,f=null,s=[0,0],h=[0,0],p=!0,g=!0,v=La[0];return n.event=function(n){n.each(function(){var n=l.of(this,arguments),t={x:s,y:h,i:o,j:a},e=this.__chart__||t;this.__chart__=t,wa?Bi.select(this).transition().each("start.brush",function(){o=e.i,a=e.j,s=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=Oe(s,t.x),r=Oe(h,t.y);return o=a=null,function(i){s=t.x=e(i),h=t.y=r(i),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=t.i,a=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,v=La[!c<<1|!f],n):c},n.y=function(t){return arguments.length?(f=t,v=La[!c<<1|!f],n):f},n.clamp=function(t){return arguments.length?(c&&f?(p=!!t[0],g=!!t[1]):c?p=!!t:f&&(g=!!t),n):c&&f?[p,g]:c?p:f?g:null},n.extent=function(t){var e,r,i,u,l;return arguments.length?(c&&(e=t[0],r=t[1],f&&(e=e[0],r=r[0]),o=[e,r],c.invert&&(e=c(e),r=c(r)),r<e&&(l=e,e=r,r=l),e==s[0]&&r==s[1]||(s=[e,r])),f&&(i=t[0],u=t[1],c&&(i=i[1],u=u[1]),a=[i,u],f.invert&&(i=f(i),u=f(u)),u<i&&(l=i,i=u,u=l),i==h[0]&&u==h[1]||(h=[i,u])),n):(c&&(o?(e=o[0],r=o[1]):(e=s[0],r=s[1],c.invert&&(e=c.invert(e),r=c.invert(r)),r<e&&(l=e,e=r,r=l))),f&&(a?(i=a[0],u=a[1]):(i=h[0],u=h[1],f.invert&&(i=f.invert(i),u=f.invert(u)),u<i&&(l=i,i=u,u=l))),c&&f?[[e,i],[r,u]]:c?[e,r]:f&&[i,u])},n.clear=function(){return n.empty()||(s=[0,0],h=[0,0],o=a=null),n},n.empty=function(){return!!c&&s[0]==s[1]||!!f&&h[0]==h[1]},Bi.rebind(n,l,"on")};var za={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},La=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],qa=Ju.format=eo.timeFormat,Ta=qa.utc,Ra=Ta("%Y-%m-%dT%H:%M:%S.%LZ");qa.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Yi:Ra,Yi.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},Yi.toString=Ra.toString,Ju.second=zn(function(n){return new Gu(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),Ju.seconds=Ju.second.range,Ju.seconds.utc=Ju.second.utc.range,Ju.minute=zn(function(n){return new Gu(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),Ju.minutes=Ju.minute.range,Ju.minutes.utc=Ju.minute.utc.range,Ju.hour=zn(function(n){var t=n.getTimezoneOffset()/60;return new Gu(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),Ju.hours=Ju.hour.range,Ju.hours.utc=Ju.hour.utc.range,Ju.month=zn(function(n){return(n=Ju.day(n)).setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),Ju.months=Ju.month.range,Ju.months.utc=Ju.month.utc.range;var Da=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Pa=[[Ju.second,1],[Ju.second,5],[Ju.second,15],[Ju.second,30],[Ju.minute,1],[Ju.minute,5],[Ju.minute,15],[Ju.minute,30],[Ju.hour,1],[Ju.hour,3],[Ju.hour,6],[Ju.hour,12],[Ju.day,1],[Ju.day,2],[Ju.week,1],[Ju.month,1],[Ju.month,3],[Ju.year,1]],Ua=qa.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",yt]]),ja={range:function(n,t,e){return Bi.range(Math.ceil(n/e)*e,+t,e).map(Vi)},floor:y,ceil:y};Pa.year=Ju.year,Ju.scale=function(){return Zi(Bi.scale.linear(),Pa,Ua)};var Fa=Pa.map(function(n){return[n[0].utc,n[1]]}),Ha=Ta.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",yt]]);Fa.year=Ju.year.utc,Ju.scale.utc=function(){return Zi(Bi.scale.linear(),Fa,Ha)},Bi.text=_n(function(n){return n.responseText}),Bi.json=function(n,t){return wn(n,"application/json",Xi,t)},Bi.html=function(n,t){return wn(n,"text/html",$i,t)},Bi.xml=_n(function(n){return n.responseXML}),"function"==typeof define&&define.amd?(this.d3=Bi,define(Bi)):"object"==typeof module&&module.exports?module.exports=Bi:this.d3=Bi}();

},{}],321:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,i,n,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(i=this._events[e],isUndefined(i))return!1;if(isFunction(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(isObject(i))for(s=Array.prototype.slice.call(arguments,1),n=(o=i.slice()).length,r=0;r<n;r++)o[r].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var i;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(i=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},EventEmitter.prototype.removeListener=function(e,t){var i,n,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],s=i.length,n=-1,i===t||isFunction(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(i)){for(r=s;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){n=r;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],isFunction(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){return this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};

},{}],322:[function(require,module,exports){
!function(t,e,n,i){"use strict";function r(t,e,n){return setTimeout(u(t,n),e)}function s(t,e,n){return!!Array.isArray(t)&&(o(t,n[e],n),!0)}function o(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==i)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function a(e,n,i){var r="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=t.console&&(t.console.warn||t.console.log);return s&&s.call(t.console,r,i),e.apply(this,arguments)}}function h(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&$(i,n)}function u(t,e){return function(){return t.apply(e,arguments)}}function c(t,e){return typeof t==Q?t.apply(e?e[0]||i:i,e):t}function l(t,e){return t===i?e:t}function p(t,e,n){o(m(e),function(e){t.addEventListener(e,n,!1)})}function f(t,e,n){o(m(e),function(e){t.removeEventListener(e,n,!1)})}function d(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function v(t,e){return t.indexOf(e)>-1}function m(t){return t.trim().split(/\s+/g)}function g(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function T(t){return Array.prototype.slice.call(t,0)}function y(t,e,n){for(var i=[],r=[],s=0;s<t.length;){var o=e?t[s][e]:t[s];g(r,o)<0&&i.push(t[s]),r[s]=o,s++}return n&&(i=e?i.sort(function(t,n){return t[e]>n[e]}):i.sort()),i}function E(t,e){for(var n,r,s=e[0].toUpperCase()+e.slice(1),o=0;o<J.length;){if(n=J[o],(r=n?n+s:e)in t)return r;o++}return i}function I(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}function A(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){c(t.options.enable,[t])&&n.handler(e)},this.init()}function _(t,e,n){var r=n.pointers.length,s=n.changedPointers.length,o=e&ct&&r-s==0,a=e&(pt|ft)&&r-s==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,s=r.length;n.firstInput||(n.firstInput=w(e));s>1&&!n.firstMultiple?n.firstMultiple=w(e):1===s&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,h=a?a.center:o.center,u=e.center=D(r);e.timeStamp=nt(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=C(h,u),e.distance=P(h,u),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},s=t.prevInput||{};e.eventType!==ct&&s.eventType!==pt||(r=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=S(e.deltaX,e.deltaY);var c=b(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=et(c.x)>et(c.y)?c.x:c.y,e.scale=a?function(t,e){return P(e[0],e[1],_t)/P(t[0],t[1],_t)}(a.pointers,r):1,e.rotation=a?function(t,e){return C(e[1],e[0],_t)+C(t[1],t[0],_t)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,s,o,a=t.lastInterval||e,h=e.timeStamp-a.timeStamp;if(e.eventType!=ft&&(h>ut||a.velocity===i)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,l=b(h,u,c);r=l.x,s=l.y,n=et(l.x)>et(l.y)?l.x:l.y,o=S(u,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,s=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=s,e.direction=o}(n,e);var l=t.element;d(e.srcEvent.target,l)&&(l=e.srcEvent.target);e.target=l}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function w(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:tt(t.pointers[n].clientX),clientY:tt(t.pointers[n].clientY)},n++;return{timeStamp:nt(),pointers:e,center:D(e),deltaX:t.deltaX,deltaY:t.deltaY}}function D(t){var e=t.length;if(1===e)return{x:tt(t[0].clientX),y:tt(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:tt(n/e),y:tt(i/e)}}function b(t,e,n){return{x:e/t||0,y:n/t||0}}function S(t,e){return t===e?dt:et(t)>=et(e)?t<0?vt:mt:e<0?gt:Tt}function P(t,e,n){n||(n=At);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function C(t,e,n){n||(n=At);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}function x(){this.evEl=Dt,this.evWin=bt,this.allow=!0,this.pressed=!1,A.apply(this,arguments)}function R(){this.evEl=Ct,this.evWin=xt,A.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ot,this.evWin=zt,this.started=!1,A.apply(this,arguments)}function z(){this.evTarget=Nt,this.targetIds={},A.apply(this,arguments)}function M(){A.apply(this,arguments);var t=u(this.handler,this);this.touch=new z(this.manager,t),this.mouse=new x(this.manager,t)}function N(t,e){this.manager=t,this.set(e)}function X(t){this.options=$({},this.defaults,t||{}),this.id=st++,this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=Lt,this.simultaneous={},this.requireFail=[]}function Y(t){return t&Zt?"cancel":t&jt?"end":t&Vt?"move":t&Ut?"start":""}function F(t){return t==Tt?"down":t==gt?"up":t==vt?"left":t==mt?"right":""}function W(t,e){var n=e.manager;return n?n.get(t):t}function q(){X.apply(this,arguments)}function k(){q.apply(this,arguments),this.pX=null,this.pY=null}function H(){q.apply(this,arguments)}function L(){X.apply(this,arguments),this._timer=null,this._input=null}function U(){q.apply(this,arguments)}function V(){q.apply(this,arguments)}function j(){X.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function G(t,e){return e=e||{},e.recognizers=l(e.recognizers,G.defaults.preset),new Z(t,e)}function Z(t,e){this.options=$({},G.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=function(t){var e=t.options.inputClass;return new(e||(at?R:ht?z:ot?M:x))(t,_)}(this),this.touchAction=new N(this,this.options.touchAction),B(this,!0),o(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function B(t,e){var n=t.element;n.style&&o(t.options.cssProps,function(t,i){n.style[E(n.style,i)]=e?t:""})}var $,J=["","webkit","Moz","MS","ms","o"],K=e.createElement("div"),Q="function",tt=Math.round,et=Math.abs,nt=Date.now;$="function"!=typeof Object.assign?function(t){if(t===i||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==i&&null!==r)for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])}return e}:Object.assign;var it=a(function(t,e,n){for(var r=Object.keys(e),s=0;s<r.length;)(!n||n&&t[r[s]]===i)&&(t[r[s]]=e[r[s]]),s++;return t},"extend","Use `assign`."),rt=a(function(t,e){return it(t,e,!0)},"merge","Use `assign`."),st=1,ot="ontouchstart"in t,at=E(t,"PointerEvent")!==i,ht=ot&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),ut=25,ct=1,lt=2,pt=4,ft=8,dt=1,vt=2,mt=4,gt=8,Tt=16,yt=vt|mt,Et=gt|Tt,It=yt|Et,At=["x","y"],_t=["clientX","clientY"];A.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(I(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(I(this.element),this.evWin,this.domHandler)}};var wt={mousedown:ct,mousemove:lt,mouseup:pt},Dt="mousedown",bt="mousemove mouseup";h(x,A,{handler:function(t){var e=wt[t.type];e&ct&&0===t.button&&(this.pressed=!0),e&lt&&1!==t.which&&(e=pt),this.pressed&&this.allow&&(e&pt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var St={pointerdown:ct,pointermove:lt,pointerup:pt,pointercancel:ft,pointerout:ft},Pt={2:"touch",3:"pen",4:"mouse",5:"kinect"},Ct="pointerdown",xt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Ct="MSPointerDown",xt="MSPointerMove MSPointerUp MSPointerCancel"),h(R,A,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=St[i],s=Pt[t.pointerType]||t.pointerType,o="touch"==s,a=g(e,t.pointerId,"pointerId");r&ct&&(0===t.button||o)?a<0&&(e.push(t),a=e.length-1):r&(pt|ft)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),n&&e.splice(a,1))}});var Rt={touchstart:ct,touchmove:lt,touchend:pt,touchcancel:ft},Ot="touchstart",zt="touchstart touchmove touchend touchcancel";h(O,A,{handler:function(t){var e=Rt[t.type];if(e===ct&&(this.started=!0),this.started){var n=function(t,e){var n=T(t.touches),i=T(t.changedTouches);return e&(pt|ft)&&(n=y(n.concat(i),"identifier",!0)),[n,i]}.call(this,t,e);e&(pt|ft)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var Mt={touchstart:ct,touchmove:lt,touchend:pt,touchcancel:ft},Nt="touchstart touchmove touchend touchcancel";h(z,A,{handler:function(t){var e=Mt[t.type],n=function(t,e){var n=T(t.touches),i=this.targetIds;if(e&(ct|lt)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,s,o=T(t.changedTouches),a=[],h=this.target;if(s=n.filter(function(t){return d(t.target,h)}),e===ct)for(r=0;r<s.length;)i[s[r].identifier]=!0,r++;for(r=0;r<o.length;)i[o[r].identifier]&&a.push(o[r]),e&(pt|ft)&&delete i[o[r].identifier],r++;return a.length?[y(s.concat(a),"identifier",!0),a]:void 0}.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}),h(M,A,{handler:function(t,e,n){var i="touch"==n.pointerType,r="mouse"==n.pointerType;if(i)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;e&(pt|ft)&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Xt=E(K.style,"touchAction"),Yt=Xt!==i,Ft="auto",Wt="manipulation",qt="none",kt="pan-x",Ht="pan-y";N.prototype={set:function(t){"compute"==t&&(t=this.compute()),Yt&&this.manager.element.style&&(this.manager.element.style[Xt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return o(this.manager.recognizers,function(e){c(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(v(t,qt))return qt;var e=v(t,kt),n=v(t,Ht);return e&&n?qt:e||n?e?kt:Ht:v(t,Wt)?Wt:Ft}(t.join(" "))},preventDefaults:function(t){if(!Yt){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=v(i,qt),s=v(i,Ht),o=v(i,kt);if(r){var a=1===t.pointers.length,h=t.distance<2,u=t.deltaTime<250;if(a&&h&&u)return}if(!o||!s)return r||s&&n&yt||o&&n&Et?this.preventSrc(e):void 0}}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Lt=1,Ut=2,Vt=4,jt=8,Gt=jt,Zt=16;X.prototype={defaults:{},set:function(t){return $(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(s(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=W(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return s(t,"dropRecognizeWith",this)?this:(t=W(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(s(t,"requireFailure",this))return this;var e=this.requireFail;return t=W(t,this),-1===g(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(s(t,"dropRequireFailure",this))return this;t=W(t,this);var e=g(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,i=this.state;i<jt&&e(n.options.event+Y(i)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),i>=jt&&e(n.options.event+Y(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Lt)))return!1;t++}return!0},recognize:function(t){var e=$({},t);if(!c(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Gt|Zt|32)&&(this.state=Lt),this.state=this.process(e),this.state&(Ut|Vt|jt|Zt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},h(q,X,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(Ut|Vt),r=this.attrTest(t);return i&&(n&ft||!r)?e|Zt:i||r?n&pt?e|jt:e&Ut?e|Vt:Ut:32}}),h(k,q,{defaults:{event:"pan",threshold:10,pointers:1,direction:It},getTouchAction:function(){var t=this.options.direction,e=[];return t&yt&&e.push(Ht),t&Et&&e.push(kt),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,s=t.deltaX,o=t.deltaY;return r&e.direction||(e.direction&yt?(r=0===s?dt:s<0?vt:mt,n=s!=this.pX,i=Math.abs(t.deltaX)):(r=0===o?dt:o<0?gt:Tt,n=o!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return q.prototype.attrTest.call(this,t)&&(this.state&Ut||!(this.state&Ut)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=F(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),h(H,q,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[qt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Ut)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),h(L,X,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ft]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,s=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(pt|ft)&&!s)this.reset();else if(t.eventType&ct)this.reset(),this._timer=r(function(){this.state=Gt,this.tryEmit()},e.time,this);else if(t.eventType&pt)return Gt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Gt&&(t&&t.eventType&pt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=nt(),this.manager.emit(this.options.event,this._input)))}}),h(U,q,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[qt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Ut)}}),h(V,q,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:yt|Et,pointers:1},getTouchAction:function(){return k.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(yt|Et)?e=t.overallVelocity:n&yt?e=t.overallVelocityX:n&Et&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&et(e)>this.options.velocity&&t.eventType&pt},emit:function(t){var e=F(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),h(j,X,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,s=t.deltaTime<e.time;if(this.reset(),t.eventType&ct&&0===this.count)return this.failTimeout();if(i&&s&&n){if(t.eventType!=pt)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||P(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t;if(0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=r(function(){this.state=Gt,this.tryEmit()},e.interval,this),Ut):Gt}return 32},failTimeout:function(){return this._timer=r(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),G.VERSION="2.0.6",G.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[U,{enable:!1}],[H,{enable:!1},["rotate"]],[V,{direction:yt}],[k,{direction:yt},["swipe"]],[j],[j,{event:"doubletap",taps:2},["tap"]],[L]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};Z.prototype={set:function(t){return $(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,i=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&Gt)&&(r=e.curRecognizer=null);for(var s=0;s<i.length;)n=i[s],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&n.state&(Ut|Vt|jt)&&(r=e.curRecognizer=n),s++}},get:function(t){if(t instanceof X)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(s(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(s(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=g(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){var n=this.handlers;return o(m(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return o(m(t),function(t){e?n[t]&&n[t].splice(g(n[t],e),1):delete n[t]}),this},emit:function(t,n){this.options.domEvents&&function(t,n){var i=e.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=n,n.target.dispatchEvent(i)}(t,n);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){n.type=t,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var r=0;r<i.length;)i[r](n),r++}},destroy:function(){this.element&&B(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},$(G,{INPUT_START:ct,INPUT_MOVE:lt,INPUT_END:pt,INPUT_CANCEL:ft,STATE_POSSIBLE:Lt,STATE_BEGAN:Ut,STATE_CHANGED:Vt,STATE_ENDED:jt,STATE_RECOGNIZED:Gt,STATE_CANCELLED:Zt,STATE_FAILED:32,DIRECTION_NONE:dt,DIRECTION_LEFT:vt,DIRECTION_RIGHT:mt,DIRECTION_UP:gt,DIRECTION_DOWN:Tt,DIRECTION_HORIZONTAL:yt,DIRECTION_VERTICAL:Et,DIRECTION_ALL:It,Manager:Z,Input:A,TouchAction:N,TouchInput:z,MouseInput:x,PointerEventInput:R,TouchMouseInput:M,SingleTouchInput:O,Recognizer:X,AttrRecognizer:q,Tap:j,Pan:k,Swipe:V,Pinch:H,Rotate:U,Press:L,on:p,off:f,each:o,merge:rt,extend:it,assign:$,inherit:h,bindFn:u,prefixed:E});(void 0!==t?t:"undefined"!=typeof self?self:{}).Hammer=G,"function"==typeof define&&define.amd?define(function(){return G}):"undefined"!=typeof module&&module.exports?module.exports=G:t.Hammer=G}(window,document);

},{}],323:[function(require,module,exports){
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};

},{}],324:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],325:[function(require,module,exports){
var toString={}.toString;module.exports=Array.isArray||function(r){return"[object Array]"==toString.call(r)};

},{}],326:[function(require,module,exports){
var jQuery=require("jquery");require("./core"),require("./widget"),require("./position"),require("./menu"),function(e,t){e.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,u="input"===n;this.isMultiLine=!!o||!u&&this.element.prop("isContentEditable"),this.valueMethod=this.element[o||u?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,void(i=!0);t=!1,s=!1,i=!1;var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:t=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case o.UP:t=!0,this._keyEvent("previous",n);break;case o.DOWN:t=!0,this._keyEvent("next",n);break;case o.ENTER:case o.NUMPAD_ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||s.preventDefault());if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){if(s)return s=!1,void e.preventDefault();this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var s=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:s})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(s.value):this.liveRegion.text(s.value)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").append(e("<a>").text(i.label)).appendTo(t)},_move:function(e,t){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t);this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery);

},{"./core":327,"./menu":328,"./position":329,"./widget":330,"jquery":331}],327:[function(require,module,exports){
var jQuery=require("jquery");!function(t,e){function n(e,n){var r,s,o,a=e.nodeName.toLowerCase();return"area"===a?(r=e.parentNode,s=r.name,!(!e.href||!s||"map"!==r.nodeName.toLowerCase())&&(!!(o=t("img[usemap=#"+s+"]")[0])&&i(o))):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||n:n)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var r=0,s=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(n,i){return"number"==typeof n?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),i&&i.call(e)},n)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var n,i,r=t(this[0]);r.length&&r[0]!==document;){if(("absolute"===(n=r.css("position"))||"relative"===n||"fixed"===n)&&(i=parseInt(r.css("zIndex"),10),!isNaN(i)&&0!==i))return i;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(n){return!!t.data(n,e)}}):function(e,n,i){return!!t.data(e,i[3])},focusable:function(e){return n(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var i=t.attr(e,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(e,!r)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,n){function i(e,n,i,s){return t.each(r,function(){n-=parseFloat(t.css(e,"padding"+this))||0,i&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(n-=parseFloat(t.css(e,"margin"+this))||0)}),n}var r="Width"===n?["Left","Right"]:["Top","Bottom"],s=n.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(e){return void 0===e?o["inner"+n].call(this):this.each(function(){t(this).css(s,i(this,e)+"px")})},t.fn["outer"+n]=function(e,r){return"number"!=typeof e?o["outer"+n].call(this,e):this.each(function(){t(this).css(s,i(this,e,!0,r)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(n){return arguments.length?e.call(this,t.camelCase(n)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,n,i){var r,s=t.ui[e].prototype;for(r in i)s.plugins[r]=s.plugins[r]||[],s.plugins[r].push([n,i[r]])},call:function(t,e,n){var i,r=t.plugins[e];if(r&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)t.options[r[i][0]]&&r[i][1].apply(t.element,n)}},hasScroll:function(e,n){if("hidden"===t(e).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return e[i]>0||(e[i]=1,r=e[i]>0,e[i]=0,r)}})}(jQuery);

},{"jquery":331}],328:[function(require,module,exports){
var jQuery=require("jquery");require("./core"),require("./widget"),require("./position"),function(e,t){e.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var s,n,a,u,r,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,n=this.previousFilter||"",a=String.fromCharCode(t.keyCode),u=!1,clearTimeout(this.filterTimer),a===n?u=!0:a=n+a,r=new RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(e(this).children("a").text())}),(s=u&&-1!==s.index(this.active.next())?this.active.nextAll(".ui-menu-item"):s).length||(a=String.fromCharCode(t.keyCode),r=new RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(e(this).children("a").text())})),s.length?(this.focus(t,s),s.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,i=this.options.icons.submenu,s=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),s=t.prev("a"),n=e("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);s.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",s.attr("id"))}),(t=s.add(this.element)).children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(i=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,u,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),u=this.activeMenu.height(),r=t.height(),n<0?this.activeMenu.scrollTop(a+n):n+r>u&&this.activeMenu.scrollTop(a+n-u+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;this.active?this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(i=e(this)).offset().top-s-n<0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var i,s,n;this.active?this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return(i=e(this)).offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}})}(jQuery);

},{"./core":327,"./position":329,"./widget":330,"jquery":331}],329:[function(require,module,exports){
var jQuery=require("jquery");!function(t,i){function e(t,i,e){return[parseFloat(t[0])*(a.test(t[0])?i/100:1),parseFloat(t[1])*(a.test(t[1])?e/100:1)]}function o(i,e){return parseInt(t.css(i,e),10)||0}t.ui=t.ui||{};var l,n=Math.max,s=Math.abs,f=Math.round,h=/left|center|right/,r=/top|center|bottom/,p=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,a=/%$/,d=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==l)return l;var i,e,o=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=o.children()[0];return t("body").append(o),i=n.offsetWidth,o.css("overflow","scroll"),e=n.offsetWidth,i===e&&(e=o[0].clientWidth),o.remove(),l=i-e},getScrollInfo:function(i){var e=i.isWindow||i.isDocument?"":i.element.css("overflow-x"),o=i.isWindow||i.isDocument?"":i.element.css("overflow-y"),l="scroll"===e||"auto"===e&&i.width<i.element[0].scrollWidth;return{width:"scroll"===o||"auto"===o&&i.height<i.element[0].scrollHeight?t.position.scrollbarWidth():0,height:l?t.position.scrollbarWidth():0}},getWithinInfo:function(i){var e=t(i||window),o=t.isWindow(e[0]);return{element:e,isWindow:o,isDocument:!!e[0]&&9===e[0].nodeType,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:o?e.width():e.outerWidth(),height:o?e.height():e.outerHeight()}}},t.fn.position=function(i){if(!i||!i.of)return d.apply(this,arguments);i=t.extend({},i);var l,a,g,u,m,w,W=t(i.of),v=t.position.getWithinInfo(i.within),y=t.position.getScrollInfo(v),b=(i.collision||"flip").split(" "),H={};return w=function(i){var e=i[0];return 9===e.nodeType?{width:i.width(),height:i.height(),offset:{top:0,left:0}}:t.isWindow(e)?{width:i.width(),height:i.height(),offset:{top:i.scrollTop(),left:i.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:i.outerWidth(),height:i.outerHeight(),offset:i.offset()}}(W),W[0].preventDefault&&(i.at="left top"),a=w.width,g=w.height,u=w.offset,m=t.extend({},u),t.each(["my","at"],function(){var t,e,o=(i[this]||"").split(" ");1===o.length&&(o=h.test(o[0])?o.concat(["center"]):r.test(o[0])?["center"].concat(o):["center","center"]),o[0]=h.test(o[0])?o[0]:"center",o[1]=r.test(o[1])?o[1]:"center",t=p.exec(o[0]),e=p.exec(o[1]),H[this]=[t?t[0]:0,e?e[0]:0],i[this]=[c.exec(o[0])[0],c.exec(o[1])[0]]}),1===b.length&&(b[1]=b[0]),"right"===i.at[0]?m.left+=a:"center"===i.at[0]&&(m.left+=a/2),"bottom"===i.at[1]?m.top+=g:"center"===i.at[1]&&(m.top+=g/2),l=e(H.at,a,g),m.left+=l[0],m.top+=l[1],this.each(function(){var h,r,p=t(this),c=p.outerWidth(),d=p.outerHeight(),w=o(this,"marginLeft"),x=o(this,"marginTop"),T=c+w+o(this,"marginRight")+y.width,L=d+x+o(this,"marginBottom")+y.height,P=t.extend({},m),D=e(H.my,p.outerWidth(),p.outerHeight());"right"===i.my[0]?P.left-=c:"center"===i.my[0]&&(P.left-=c/2),"bottom"===i.my[1]?P.top-=d:"center"===i.my[1]&&(P.top-=d/2),P.left+=D[0],P.top+=D[1],t.support.offsetFractions||(P.left=f(P.left),P.top=f(P.top)),h={marginLeft:w,marginTop:x},t.each(["left","top"],function(e,o){t.ui.position[b[e]]&&t.ui.position[b[e]][o](P,{targetWidth:a,targetHeight:g,elemWidth:c,elemHeight:d,collisionPosition:h,collisionWidth:T,collisionHeight:L,offset:[l[0]+D[0],l[1]+D[1]],my:i.my,at:i.at,within:v,elem:p})}),i.using&&(r=function(t){var e=u.left-P.left,o=e+a-c,l=u.top-P.top,f=l+g-d,h={target:{element:W,left:u.left,top:u.top,width:a,height:g},element:{element:p,left:P.left,top:P.top,width:c,height:d},horizontal:o<0?"left":e>0?"right":"center",vertical:f<0?"top":l>0?"bottom":"middle"};a<c&&s(e+o)<a&&(h.horizontal="center"),g<d&&s(l+f)<g&&(h.vertical="middle"),n(s(e),s(o))>n(s(l),s(f))?h.important="horizontal":h.important="vertical",i.using.call(this,t,h)}),p.offset(t.extend(P,{using:r}))})},t.ui.position={fit:{left:function(t,i){var e,o=i.within,l=o.isWindow?o.scrollLeft:o.offset.left,s=o.width,f=t.left-i.collisionPosition.marginLeft,h=l-f,r=f+i.collisionWidth-s-l;i.collisionWidth>s?h>0&&r<=0?(e=t.left+h+i.collisionWidth-s-l,t.left+=h-e):t.left=r>0&&h<=0?l:h>r?l+s-i.collisionWidth:l:h>0?t.left+=h:r>0?t.left-=r:t.left=n(t.left-f,t.left)},top:function(t,i){var e,o=i.within,l=o.isWindow?o.scrollTop:o.offset.top,s=i.within.height,f=t.top-i.collisionPosition.marginTop,h=l-f,r=f+i.collisionHeight-s-l;i.collisionHeight>s?h>0&&r<=0?(e=t.top+h+i.collisionHeight-s-l,t.top+=h-e):t.top=r>0&&h<=0?l:h>r?l+s-i.collisionHeight:l:h>0?t.top+=h:r>0?t.top-=r:t.top=n(t.top-f,t.top)}},flip:{left:function(t,i){var e,o,l=i.within,n=l.offset.left+l.scrollLeft,f=l.width,h=l.isWindow?l.scrollLeft:l.offset.left,r=t.left-i.collisionPosition.marginLeft,p=r-h,c=r+i.collisionWidth-f-h,a="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,d="left"===i.at[0]?i.targetWidth:"right"===i.at[0]?-i.targetWidth:0,g=-2*i.offset[0];p<0?((e=t.left+a+d+g+i.collisionWidth-f-n)<0||e<s(p))&&(t.left+=a+d+g):c>0&&((o=t.left-i.collisionPosition.marginLeft+a+d+g-h)>0||s(o)<c)&&(t.left+=a+d+g)},top:function(t,i){var e,o,l=i.within,n=l.offset.top+l.scrollTop,f=l.height,h=l.isWindow?l.scrollTop:l.offset.top,r=t.top-i.collisionPosition.marginTop,p=r-h,c=r+i.collisionHeight-f-h,a="top"===i.my[1]?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,d="top"===i.at[1]?i.targetHeight:"bottom"===i.at[1]?-i.targetHeight:0,g=-2*i.offset[1];p<0?(o=t.top+a+d+g+i.collisionHeight-f-n,t.top+a+d+g>p&&(o<0||o<s(p))&&(t.top+=a+d+g)):c>0&&(e=t.top-i.collisionPosition.marginTop+a+d+g-h,t.top+a+d+g>c&&(e>0||s(e)<c)&&(t.top+=a+d+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var i,e,o,l,n,s=document.getElementsByTagName("body")[0],f=document.createElement("div");i=document.createElement(s?"div":"body"),o={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&t.extend(o,{position:"absolute",left:"-1000px",top:"-1000px"});for(n in o)i.style[n]=o[n];i.appendChild(f),(e=s||document.documentElement).insertBefore(i,e.firstChild),f.style.cssText="position: absolute; left: 10.7432222px;",l=t(f).offset().left,t.support.offsetFractions=l>10&&l<11,i.innerHTML="",e.removeChild(i)}()}(jQuery);

},{"jquery":331}],330:[function(require,module,exports){
var jQuery=require("jquery");!function(t,e){var i=0,n=Array.prototype.slice,s=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(t){}s(e)},t.widget=function(e,i,n){var s,o,r,a,u={},d=e.split(".")[0];e=e.split(".")[1],s=d+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][s.toLowerCase()]=function(e){return!!t.data(e,s)},t[d]=t[d]||{},o=t[d][e],r=t[d][e]=function(t,e){if(!this._createWidget)return new r(t,e);arguments.length&&this._createWidget(t,e)},t.extend(r,o,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),(a=new i).options=t.widget.extend({},a.options),t.each(n,function(e,n){t.isFunction(n)?u[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},s=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=s,e=n.apply(this,arguments),this._super=i,this._superApply=o,e}}():u[e]=n}),r.prototype=t.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||e:e},u,{constructor:r,namespace:d,widgetName:e,widgetFullName:s}),o?(t.each(o._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete o._childConstructors):i._childConstructors.push(r),t.widget.bridge(e,r)},t.widget.extend=function(e){for(var i,s,o=n.call(arguments,1),r=0,a=o.length;r<a;r++)for(i in o[r])s=o[r][i],o[r].hasOwnProperty(i)&&void 0!==s&&(t.isPlainObject(s)?e[i]=t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):e[i]=s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(o){var r="string"==typeof o,a=n.call(arguments,1),u=this;return o=!r&&a.length?t.widget.extend.apply(null,[o].concat(a)):o,r?this.each(function(){var i,n=t.data(this,s);return n?t.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,a))!==n&&void 0!==i?(u=i&&i.jquery?u.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var e=t.data(this,s);e?e.option(o||{})._init():t.data(this,s,new i(o,this))}),u}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,s,o,r=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(r={},n=e.split("."),e=n.shift(),n.length){for(s=r[e]=t.widget.extend({},this.options[e]),o=0;o<n.length-1;o++)s[n[o]]=s[n[o]]||{},s=s[n[o]];if(e=n.pop(),1===arguments.length)return void 0===s[e]?null:s[e];s[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];r[e]=i}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var s,o=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=s=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),t.each(n,function(n,r){function a(){if(e||!0!==o.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof r?o[r]:r).apply(o,arguments)}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||t.guid++);var u=n.match(/^(\w+)\s*(.*)$/),d=u[1]+o.eventNamespace,h=u[2];h?s.delegate(h,d,a):i.bind(d,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){var i=this;return setTimeout(function(){return("string"==typeof t?i[t]:t).apply(i,arguments)},e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var s,o,r=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(s in o)s in i||(i[s]=o[s]);return this.element.trigger(i,n),!(t.isFunction(r)&&!1===r.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,s,o){"string"==typeof s&&(s={effect:s});var r,a=s?!0===s||"number"==typeof s?i:s.effect||i:e;"number"==typeof(s=s||{})&&(s={duration:s}),r=!t.isEmptyObject(s),s.complete=o,s.delay&&n.delay(s.delay),r&&t.effects&&t.effects.effect[a]?n[e](s):a!==e&&n[a]?n[a](s.duration,s.easing,o):n.queue(function(i){t(this)[e](),o&&o.call(n[0]),i()})}})}(jQuery);

},{"jquery":331}],331:[function(require,module,exports){
!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=!!e&&"length"in e&&e.length,n=Z.type(e);return"function"!==n&&!Z.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function r(e,t,n){if(Z.isFunction(t))return Z.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return Z.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(le.test(t))return Z.filter(t,e,n);t=Z.filter(t,e)}return Z.grep(e,function(e){return Y.call(t,e)>-1!==n})}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(){X.removeEventListener("DOMContentLoaded",o),e.removeEventListener("load",o),Z.ready()}function s(){this.expando=Z.expando+s.uid++}function a(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(we,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:be.test(n)?Z.parseJSON(n):n)}catch(e){}xe.set(e,t,n)}else n=void 0;return n}function u(e,t,n,r){var i,o=1,s=20,a=r?function(){return r.cur()}:function(){return Z.css(e,t,"")},u=a(),l=n&&n[3]||(Z.cssNumber[t]?"":"px"),c=(Z.cssNumber[t]||"px"!==l&&+u)&&Ce.exec(Z.css(e,t));if(c&&c[3]!==l){l=l||c[3],n=n||[],c=+u||1;do{c/=o=o||".5",Z.style(e,t,c+l)}while(o!==(o=a()/u)&&1!==o&&--s)}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}function l(e,t){var n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],n):n}function c(e,t){for(var n=0,r=e.length;n<r;n++)ye.set(e[n],"globalEval",!t||ye.get(t[n],"globalEval"))}function f(e,t,n,r,i){for(var o,s,a,u,f,p,d=t.createDocumentFragment(),h=[],g=0,m=e.length;g<m;g++)if((o=e[g])||0===o)if("object"===Z.type(o))Z.merge(h,o.nodeType?[o]:o);else if(Ae.test(o)){for(s=s||d.appendChild(t.createElement("div")),a=(Se.exec(o)||["",""])[1].toLowerCase(),u=je[a]||je._default,s.innerHTML=u[1]+Z.htmlPrefilter(o)+u[2],p=u[0];p--;)s=s.lastChild;Z.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(t.createTextNode(o));for(d.textContent="",g=0;o=h[g++];)if(r&&Z.inArray(o,r)>-1)i&&i.push(o);else if(f=Z.contains(o.ownerDocument,o),s=l(d.appendChild(o),"script"),f&&c(s),n)for(p=0;o=s[p++];)De.test(o.type||"")&&n.push(o);return d}function p(){return!0}function d(){return!1}function h(){try{return X.activeElement}catch(e){}}function g(e,t,n,r,i,o){var s,a;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(a in t)g(e,a,n,r,t[a],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=d;else if(!i)return this;return 1===o&&(s=i,(i=function(e){return Z().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=Z.guid++)),e.each(function(){Z.event.add(this,t,i,r,n)})}function m(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e:e}function v(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function y(e){var t=Re.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function x(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(ye.hasData(e)&&(o=ye.access(e),s=ye.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;n<r;n++)Z.event.add(t,i,l[i][n])}xe.hasData(e)&&(a=xe.access(e),u=Z.extend({},a),xe.set(t,u))}}function b(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ne.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function w(e,t,n,r){t=U.apply([],t);var i,o,s,a,u,c,p=0,d=e.length,h=d-1,g=t[0],m=Z.isFunction(g);if(m||d>1&&"string"==typeof g&&!K.checkClone&&Pe.test(g))return e.each(function(i){var o=e.eq(i);m&&(t[0]=g.call(this,i,o.html())),w(o,t,n,r)});if(d&&(i=f(t,e[0].ownerDocument,!1,e,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(a=(s=Z.map(l(i,"script"),v)).length;p<d;p++)u=i,p!==h&&(u=Z.clone(u,!0,!0),a&&Z.merge(s,l(u,"script"))),n.call(e[p],u,p);if(a)for(c=s[s.length-1].ownerDocument,Z.map(s,y),p=0;p<a;p++)u=s[p],De.test(u.type||"")&&!ye.access(u,"globalEval")&&Z.contains(c,u)&&(u.src?Z._evalUrl&&Z._evalUrl(u.src):Z.globalEval(u.textContent.replace(Me,"")))}return e}function T(e,t,n){for(var r,i=t?Z.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||Z.cleanData(l(r)),r.parentNode&&(n&&Z.contains(r.ownerDocument,r)&&c(l(r,"script")),r.parentNode.removeChild(r));return e}function C(e,t){var n=Z(t.createElement(e)).appendTo(t.body),r=Z.css(n[0],"display");return n.detach(),r}function k(e){var t=X,n=Ie[e];return n||("none"!==(n=C(e,t))&&n||((t=(We=(We||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=C(e,t),We.detach()),Ie[e]=n),n}function E(e,t,n){var r,i,o,s,a=e.style;return(n=n||_e(e))&&(""!==(s=n.getPropertyValue(t)||n[t])||Z.contains(e.ownerDocument,e)||(s=Z.style(e,t)),!K.pixelMarginRight()&&Be.test(s)&&$e.test(t)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function N(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}function S(e){if(e in Qe)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=Ge.length;n--;)if((e=Ge[n]+t)in Qe)return e}function D(e,t,n){var r=Ce.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function j(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;o<4;o+=2)"margin"===n&&(s+=Z.css(e,n+ke[o],!0,i)),r?("content"===n&&(s-=Z.css(e,"padding"+ke[o],!0,i)),"margin"!==n&&(s-=Z.css(e,"border"+ke[o]+"Width",!0,i))):(s+=Z.css(e,"padding"+ke[o],!0,i),"padding"!==n&&(s+=Z.css(e,"border"+ke[o]+"Width",!0,i)));return s}function A(t,n,r){var i=!0,o="width"===n?t.offsetWidth:t.offsetHeight,s=_e(t),a="border-box"===Z.css(t,"boxSizing",!1,s);if(X.msFullscreenElement&&e.top!==e&&t.getClientRects().length&&(o=Math.round(100*t.getBoundingClientRect()[n])),o<=0||null==o){if(((o=E(t,n,s))<0||null==o)&&(o=t.style[n]),Be.test(o))return o;i=a&&(K.boxSizingReliable()||o===t.style[n]),o=parseFloat(o)||0}return o+j(t,n,r||(a?"border":"content"),i,s)+"px"}function L(e,t){for(var n,r,i,o=[],s=0,a=e.length;s<a;s++)(r=e[s]).style&&(o[s]=ye.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Ee(r)&&(o[s]=ye.access(r,"olddisplay",k(r.nodeName)))):(i=Ee(r),"none"===n&&i||ye.set(r,"olddisplay",i?n:Z.css(r,"display"))));for(s=0;s<a;s++)(r=e[s]).style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}function q(e,t,n,r,i){return new q.prototype.init(e,t,n,r,i)}function H(){return e.setTimeout(function(){Je=void 0}),Je=Z.now()}function O(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ke[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function F(e,t,n){for(var r,i=(P.tweeners[t]||[]).concat(P.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,t,e))return r}function P(e,t,n){var r,i,o=0,s=P.prefilters.length,a=Z.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=Je||H(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,s=l.tweens.length;o<s;o++)l.tweens[o].run(r);return a.notifyWith(e,[l,r,n]),r<1&&s?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:Z.extend({},t),opts:Z.extend(!0,{specialEasing:{},easing:Z.easing._default},n),originalProperties:t,originalOptions:n,startTime:Je||H(),duration:n.duration,tweens:[],createTween:function(t,n){var r=Z.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,s;for(n in e)if(r=Z.camelCase(n),i=t[r],o=e[n],Z.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(s=Z.cssHooks[r])&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}(c,l.opts.specialEasing);o<s;o++)if(r=P.prefilters[o].call(l,e,c,l.opts))return Z.isFunction(r.stop)&&(Z._queueHooks(l.elem,l.opts.queue).stop=Z.proxy(r.stop,r)),r;return Z.map(c,F,l),Z.isFunction(l.opts.start)&&l.opts.start.call(e,l),Z.fx.timer(Z.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function R(e){return e.getAttribute&&e.getAttribute("class")||""}function M(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(he)||[];if(Z.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function W(e,t,n,r){function i(a){var u;return o[a]=!0,Z.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(t.dataTypes.unshift(l),i(l),!1)}),u}var o={},s=e===vt;return i(t.dataTypes[0])||!o["*"]&&i("*")}function I(e,t){var n,r,i=Z.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&Z.extend(!0,e,r),e}function $(e,t,n,r){var i;if(Z.isArray(t))Z.each(t,function(t,i){n||wt.test(e)?r(e,i):$(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==Z.type(t))r(e,t);else for(i in t)$(e+"["+i+"]",t[i],n,r)}function B(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var _=[],X=e.document,z=_.slice,U=_.concat,V=_.push,Y=_.indexOf,G={},Q=G.toString,J=G.hasOwnProperty,K={},Z=function(e,t){return new Z.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ne=/-([\da-z])/gi,re=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:"2.2.0",constructor:Z,selector:"",length:0,toArray:function(){return z.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:z.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return Z.each(this,e)},map:function(e){return this.pushStack(Z.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(z.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:V,sort:_.sort,splice:_.splice},Z.extend=Z.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||Z.isFunction(s)||(s={}),a===u&&(s=this,a--);a<u;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],s!==(r=e[t])&&(l&&r&&(Z.isPlainObject(r)||(i=Z.isArray(r)))?(i?(i=!1,o=n&&Z.isArray(n)?n:[]):o=n&&Z.isPlainObject(n)?n:{},s[t]=Z.extend(l,o,r)):void 0!==r&&(s[t]=r));return s},Z.extend({expando:"jQuery"+("2.2.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!Z.isArray(e)&&t-parseFloat(t)+1>=0},isPlainObject:function(e){return"object"===Z.type(e)&&!e.nodeType&&!Z.isWindow(e)&&!(e.constructor&&!J.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?G[Q.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=Z.trim(e))&&(1===e.indexOf("use strict")?((t=X.createElement("script")).text=e,X.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ne,re)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var r,i=0;if(n(e))for(r=e.length;i<r&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?Z.merge(r,"string"==typeof e?[e]:e):V.call(r,e)),r},inArray:function(e,t,n){return null==t?-1:Y.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,s=!n;i<o;i++)!t(e[i],i)!==s&&r.push(e[i]);return r},map:function(e,t,r){var i,o,s=0,a=[];if(n(e))for(i=e.length;s<i;s++)null!=(o=t(e[s],s,r))&&a.push(o);else for(s in e)null!=(o=t(e[s],s,r))&&a.push(o);return U.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),Z.isFunction(e))return r=z.call(arguments,2),i=function(){return e.apply(t||this,r.concat(z.call(arguments)))},i.guid=e.guid=e.guid||Z.guid++,i},now:Date.now,support:K}),"function"==typeof Symbol&&(Z.fn[Symbol.iterator]=_[Symbol.iterator]),Z.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()});var ie=function(e){function t(e,t,n,r){var i,o,s,a,u,l,f,d,h=t&&t.ownerDocument,g=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==g&&9!==g&&11!==g)return n;if(!r&&((t?t.ownerDocument||t:M)!==A&&j(t),t=t||A,q)){if(11!==g&&(l=ge.exec(e)))if(i=l[1]){if(9===g){if(!(s=t.getElementById(i)))return n;if(s.id===i)return n.push(s),n}else if(h&&(s=h.getElementById(i))&&P(t,s)&&s.id===i)return n.push(s),n}else{if(l[2])return Q.apply(n,t.getElementsByTagName(e)),n;if((i=l[3])&&x.getElementsByClassName&&t.getElementsByClassName)return Q.apply(n,t.getElementsByClassName(i)),n}if(x.qsa&&!_[e+" "]&&(!H||!H.test(e))){if(1!==g)h=t,d=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(ve,"\\$&"):t.setAttribute("id",a=R),o=(f=C(e)).length,u=ce.test(a)?"#"+a:"[id='"+a+"']";o--;)f[o]=u+" "+p(f[o]);d=f.join(","),h=me.test(e)&&c(t.parentNode)||t}if(d)try{return Q.apply(n,h.querySelectorAll(d)),n}catch(e){}finally{a===R&&t.removeAttribute("id")}}}return E(e.replace(oe,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>b.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[R]=!0,e}function i(e){var t=A.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),r=n.length;r--;)b.attrHandle[n[r]]=t}function s(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||z)-(~e.sourceIndex||z);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function u(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return r(function(t){return t=+t,r(function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}function c(e){return e&&void 0!==e.getElementsByTagName&&e}function f(){}function p(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,i=n&&"parentNode"===r,o=I++;return t.first?function(t,n,o){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,o)}:function(t,n,s){var a,u,l,c=[W,o];if(s){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,s))return!0}else for(;t=t[r];)if(1===t.nodeType||i){if(l=t[R]||(t[R]={}),u=l[t.uniqueID]||(l[t.uniqueID]={}),(a=u[r])&&a[0]===W&&a[1]===o)return c[2]=a[2];if(u[r]=c,c[2]=e(t,n,s))return!0}}}function h(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function g(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,l=null!=t;a<u;a++)(o=e[a])&&(n&&!n(o,r,i)||(s.push(o),l&&t.push(a)));return s}function m(e,n,i,o,s,a){return o&&!o[R]&&(o=m(o)),s&&!s[R]&&(s=m(s,a)),r(function(r,a,u,l){var c,f,p,d=[],h=[],m=a.length,v=r||function(e,n,r){for(var i=0,o=n.length;i<o;i++)t(e,n[i],r);return r}(n||"*",u.nodeType?[u]:u,[]),y=!e||!r&&n?v:g(v,d,e,u,l),x=i?s||(r?e:m||o)?[]:a:y;if(i&&i(y,x,u,l),o)for(c=g(x,h),o(c,[],u,l),f=c.length;f--;)(p=c[f])&&(x[h[f]]=!(y[h[f]]=p));if(r){if(s||e){if(s){for(c=[],f=x.length;f--;)(p=x[f])&&c.push(y[f]=p);s(null,x=[],c,l)}for(f=x.length;f--;)(p=x[f])&&(c=s?K(r,p):d[f])>-1&&(r[c]=!(a[c]=p))}}else x=g(x===a?x.splice(m,x.length):x),s?s(null,a,x,l):Q.apply(a,x)})}function v(e){for(var t,n,r,i=e.length,o=b.relative[e[0].type],s=o||b.relative[" "],a=o?1:0,u=d(function(e){return e===t},s,!0),l=d(function(e){return K(t,e)>-1},s,!0),c=[function(e,n,r){var i=!o&&(r||n!==N)||((t=n).nodeType?u(e,n,r):l(e,n,r));return t=null,i}];a<i;a++)if(n=b.relative[e[a].type])c=[d(h(c),n)];else{if((n=b.filter[e[a].type].apply(null,e[a].matches))[R]){for(r=++a;r<i&&!b.relative[e[r].type];r++);return m(a>1&&h(c),a>1&&p(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(oe,"$1"),n,a<r&&v(e.slice(a,r)),r<i&&v(e=e.slice(r)),r<i&&p(e))}c.push(n)}return h(c)}var y,x,b,w,T,C,k,E,N,S,D,j,A,L,q,H,O,F,P,R="sizzle"+1*new Date,M=e.document,W=0,I=0,$=n(),B=n(),_=n(),X=function(e,t){return e===t&&(D=!0),0},z=1<<31,U={}.hasOwnProperty,V=[],Y=V.pop,G=V.push,Q=V.push,J=V.slice,K=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ne="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+te+"))|)"+ee+"*\\]",re=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ne+")*)|.*)\\)|)",ie=new RegExp(ee+"+","g"),oe=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),se=new RegExp("^"+ee+"*,"+ee+"*"),ae=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),ue=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),le=new RegExp(re),ce=new RegExp("^"+te+"$"),fe={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te+"|[*])"),ATTR:new RegExp("^"+ne),PSEUDO:new RegExp("^"+re),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+Z+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},pe=/^(?:input|select|textarea|button)$/i,de=/^h\d$/i,he=/^[^{]+\{\s*\[native \w/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,me=/[+~]/,ve=/'|\\/g,ye=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),xe=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},be=function(){j()};try{Q.apply(V=J.call(M.childNodes),M.childNodes),V[M.childNodes.length].nodeType}catch(e){Q={apply:V.length?function(e,t){G.apply(e,J.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}x=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},j=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:M;return r!==A&&9===r.nodeType&&r.documentElement?(A=r,L=A.documentElement,q=!T(A),(n=A.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",be,!1):n.attachEvent&&n.attachEvent("onunload",be)),x.attributes=i(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=i(function(e){return e.appendChild(A.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=he.test(A.getElementsByClassName),x.getById=i(function(e){return L.appendChild(e).id=R,!A.getElementsByName||!A.getElementsByName(R).length}),x.getById?(b.find.ID=function(e,t){if(void 0!==t.getElementById&&q){var n=t.getElementById(e);return n?[n]:[]}},b.filter.ID=function(e){var t=e.replace(ye,xe);return function(e){return e.getAttribute("id")===t}}):(delete b.find.ID,b.filter.ID=function(e){var t=e.replace(ye,xe);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),b.find.TAG=x.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):x.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=x.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&q)return t.getElementsByClassName(e)},O=[],H=[],(x.qsa=he.test(A.querySelectorAll))&&(i(function(e){L.appendChild(e).innerHTML="<a id='"+R+"'></a><select id='"+R+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&H.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||H.push("\\["+ee+"*(?:value|"+Z+")"),e.querySelectorAll("[id~="+R+"-]").length||H.push("~="),e.querySelectorAll(":checked").length||H.push(":checked"),e.querySelectorAll("a#"+R+"+*").length||H.push(".#.+[+~]")}),i(function(e){var t=A.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&H.push("name"+ee+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),H.push(",.*:")})),(x.matchesSelector=he.test(F=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&i(function(e){x.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),O.push("!=",re)}),H=H.length&&new RegExp(H.join("|")),O=O.length&&new RegExp(O.join("|")),t=he.test(L.compareDocumentPosition),P=t||he.test(L.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},X=t?function(e,t){if(e===t)return D=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!x.sortDetached&&t.compareDocumentPosition(e)===n?e===A||e.ownerDocument===M&&P(M,e)?-1:t===A||t.ownerDocument===M&&P(M,t)?1:S?K(S,e)-K(S,t):0:4&n?-1:1)}:function(e,t){if(e===t)return D=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],u=[t];if(!i||!o)return e===A?-1:t===A?1:i?-1:o?1:S?K(S,e)-K(S,t):0;if(i===o)return s(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;a[r]===u[r];)r++;return r?s(a[r],u[r]):a[r]===M?-1:u[r]===M?1:0},A):A},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==A&&j(e),n=n.replace(ue,"='$1']"),x.matchesSelector&&q&&!_[n+" "]&&(!O||!O.test(n))&&(!H||!H.test(n)))try{var r=F.call(e,n);if(r||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return t(n,A,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==A&&j(e),P(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==A&&j(e);var n=b.attrHandle[t.toLowerCase()],r=n&&U.call(b.attrHandle,t.toLowerCase())?n(e,t,!q):void 0;return void 0!==r?r:x.attributes||!q?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,i=0;if(D=!x.detectDuplicates,S=!x.sortStable&&e.slice(0),e.sort(X),D){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return S=null,e},w=t.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=w(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=w(t);return n},(b=t.selectors={cacheLength:50,createPseudo:r,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ye,xe),e[3]=(e[3]||e[4]||e[5]||"").replace(ye,xe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&le.test(n)&&(t=C(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ye,xe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=$[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&$(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(i){var o=t.attr(i,e);return null==o?"!="===n:!n||(o+="","="===n?o===r:"!="===n?o!==r:"^="===n?r&&0===o.indexOf(r):"*="===n?r&&o.indexOf(r)>-1:"$="===n?r&&o.slice(-r.length)===r:"~="===n?(" "+o.replace(ie," ")+" ").indexOf(r)>-1:"|="===n&&(o===r||o.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!u&&!a,x=!1;if(m){if(o){for(;g;){for(p=t;p=p[g];)if(a?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[s?m.firstChild:m.lastChild],s&&y){for(x=(d=(l=(c=(f=(p=m)[R]||(p[R]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===W&&l[1])&&l[2],p=d&&m.childNodes[d];p=++d&&p&&p[g]||(x=d=0)||h.pop();)if(1===p.nodeType&&++x&&p===t){c[e]=[W,d,x];break}}else if(y&&(x=d=(l=(c=(f=(p=t)[R]||(p[R]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===W&&l[1]),!1===x)for(;(p=++d&&p&&p[g]||(x=d=0)||h.pop())&&((a?p.nodeName.toLowerCase()!==v:1!==p.nodeType)||!++x||(y&&((c=(f=p[R]||(p[R]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]=[W,x]),p!==t)););return(x-=i)===r||x%r==0&&x/r>=0}}},PSEUDO:function(e,n){var i,o=b.pseudos[e]||b.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[R]?o(n):o.length>1?(i=[e,e,"",n],b.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,i=o(e,n),s=i.length;s--;)e[r=K(e,i[s])]=!(t[r]=i[s])}):function(e){return o(e,0,i)}):o}},pseudos:{not:r(function(e){var t=[],n=[],i=k(e.replace(oe,"$1"));return i[R]?r(function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(ye,xe),function(t){return(t.textContent||t.innerText||w(t)).indexOf(e)>-1}}),lang:r(function(e){return ce.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(ye,xe).toLowerCase(),function(t){var n;do{if(n=q?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===L},focus:function(e){return e===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return de.test(e.nodeName)},input:function(e){return pe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[n<0?n+t:n]}),even:l(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[y]=a(y);for(y in{submit:!0,reset:!0})b.pseudos[y]=u(y);return f.prototype=b.filters=b.pseudos,b.setFilters=new f,C=t.tokenize=function(e,n){var r,i,o,s,a,u,l,c=B[e+" "];if(c)return n?0:c.slice(0);for(a=e,u=[],l=b.preFilter;a;){r&&!(i=se.exec(a))||(i&&(a=a.slice(i[0].length)||a),u.push(o=[])),r=!1,(i=ae.exec(a))&&(r=i.shift(),o.push({value:r,type:i[0].replace(oe," ")}),a=a.slice(r.length));for(s in b.filter)!(i=fe[s].exec(a))||l[s]&&!(i=l[s](i))||(r=i.shift(),o.push({value:r,type:s,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?t.error(e):B(e,u).slice(0)},k=t.compile=function(e,n){var i,o=[],s=[],a=_[e+" "];if(!a){for(n||(n=C(e)),i=n.length;i--;)(a=v(n[i]))[R]?o.push(a):s.push(a);(a=_(e,function(e,n){var i=n.length>0,o=e.length>0,s=function(r,s,a,u,l){var c,f,p,d=0,h="0",m=r&&[],v=[],y=N,x=r||o&&b.find.TAG("*",l),w=W+=null==y?1:Math.random()||.1,T=x.length;for(l&&(N=s===A||s||l);h!==T&&null!=(c=x[h]);h++){if(o&&c){for(f=0,s||c.ownerDocument===A||(j(c),a=!q);p=e[f++];)if(p(c,s||A,a)){u.push(c);break}l&&(W=w)}i&&((c=!p&&c)&&d--,r&&m.push(c))}if(d+=h,i&&h!==d){for(f=0;p=n[f++];)p(m,v,s,a);if(r){if(d>0)for(;h--;)m[h]||v[h]||(v[h]=Y.call(u));v=g(v)}Q.apply(u,v),l&&!r&&v.length>0&&d+n.length>1&&t.uniqueSort(u)}return l&&(W=w,N=y),m};return i?r(s):s}(s,o))).selector=e}return a},E=t.select=function(e,t,n,r){var i,o,s,a,u,l="function"==typeof e&&e,f=!r&&C(e=l.selector||e);if(n=n||[],1===f.length){if((o=f[0]=f[0].slice(0)).length>2&&"ID"===(s=o[0]).type&&x.getById&&9===t.nodeType&&q&&b.relative[o[1].type]){if(!(t=(b.find.ID(s.matches[0].replace(ye,xe),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=fe.needsContext.test(e)?0:o.length;i--&&(s=o[i],!b.relative[a=s.type]);)if((u=b.find[a])&&(r=u(s.matches[0].replace(ye,xe),me.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&p(o)))return Q.apply(n,r),n;break}}return(l||k(e,f))(r,t,!q,n,!t||me.test(e)&&c(t.parentNode)||t),n},x.sortStable=R.split("").sort(X).join("")===R,x.detectDuplicates=!!D,j(),x.sortDetached=i(function(e){return 1&e.compareDocumentPosition(A.createElement("div"))}),i(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&i(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),i(function(e){return null==e.getAttribute("disabled")})||o(Z,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e);Z.find=ie,Z.expr=ie.selectors,Z.expr[":"]=Z.expr.pseudos,Z.uniqueSort=Z.unique=ie.uniqueSort,Z.text=ie.getText,Z.isXMLDoc=ie.isXML,Z.contains=ie.contains;var oe=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&Z(e).is(n))break;r.push(e)}return r},se=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},ae=Z.expr.match.needsContext,ue=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,le=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?Z.find.matchesSelector(r,e)?[r]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;t<n;t++)if(Z.contains(i[t],this))return!0}));for(t=0;t<n;t++)Z.find(e,i[t],r);return r=this.pushStack(n>1?Z.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(r(this,e||[],!1))},not:function(e){return this.pushStack(r(this,e||[],!0))},is:function(e){return!!r(this,"string"==typeof e&&ae.test(e)?Z(e):e||[],!1).length}});var ce,fe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(Z.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||ce,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:fe.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:X,!0)),ue.test(r[1])&&Z.isPlainObject(t))for(r in t)Z.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=X.getElementById(r[2]))&&i.parentNode&&(this.length=1,this[0]=i),this.context=X,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?void 0!==n.ready?n.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this))}).prototype=Z.fn,ce=Z(X);var pe=/^(?:parents|prev(?:Until|All))/,de={children:!0,contents:!0,next:!0,prev:!0};Z.fn.extend({has:function(e){var t=Z(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,o=[],s=ae.test(e)||"string"!=typeof e?Z(e,t||this.context):0;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&Z.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?Z.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?Y.call(Z(e),this[0]):Y.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.uniqueSort(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return oe(e,"parentNode")},parentsUntil:function(e,t,n){return oe(e,"parentNode",n)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return oe(e,"nextSibling")},prevAll:function(e){return oe(e,"previousSibling")},nextUntil:function(e,t,n){return oe(e,"nextSibling",n)},prevUntil:function(e,t,n){return oe(e,"previousSibling",n)},siblings:function(e){return se((e.parentNode||{}).firstChild,e)},children:function(e){return se(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(e,t){Z.fn[e]=function(n,r){var i=Z.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=Z.filter(r,i)),this.length>1&&(de[e]||Z.uniqueSort(i),pe.test(e)&&i.reverse()),this.pushStack(i)}});var he=/\S+/g;Z.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return Z.each(e.match(he)||[],function(e,n){t[n]=!0}),t}(e):Z.extend({},e);var t,n,r,i,o=[],s=[],a=-1,u=function(){for(i=e.once,r=t=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(a=o.length-1,s.push(n)),function t(n){Z.each(n,function(n,r){Z.isFunction(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==Z.type(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return Z.each(arguments,function(e,t){for(var n;(n=Z.inArray(t,o,n))>-1;)o.splice(n,1),n<=a&&a--}),this},has:function(e){return e?Z.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=s=[],n||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},Z.extend({Deferred:function(e){var t=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Z.Deferred(function(n){Z.each(t,function(t,o){var s=Z.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Z.extend(e,r):r}},i={};return r.pipe=r.then,Z.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,o=z.call(arguments),s=o.length,a=1!==s||e&&Z.isFunction(e.promise)?s:0,u=1===a?e:Z.Deferred(),l=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?z.call(arguments):i,r===t?u.notifyWith(n,r):--a||u.resolveWith(n,r)}};if(s>1)for(t=new Array(s),n=new Array(s),r=new Array(s);i<s;i++)o[i]&&Z.isFunction(o[i].promise)?o[i].promise().progress(l(i,n,t)).done(l(i,r,o)).fail(u.reject):--a;return a||u.resolveWith(r,o),u.promise()}});var ge;Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(!0===e?--Z.readyWait:Z.isReady)||(Z.isReady=!0,!0!==e&&--Z.readyWait>0||(ge.resolveWith(X,[Z]),Z.fn.triggerHandler&&(Z(X).triggerHandler("ready"),Z(X).off("ready"))))}}),Z.ready.promise=function(t){return ge||(ge=Z.Deferred(),"complete"===X.readyState||"loading"!==X.readyState&&!X.documentElement.doScroll?e.setTimeout(Z.ready):(X.addEventListener("DOMContentLoaded",o),e.addEventListener("load",o))),ge.promise(t)},Z.ready.promise();var me=function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===Z.type(n)){i=!0;for(a in n)me(e,t,a,n[a],!0,o,s)}else if(void 0!==r&&(i=!0,Z.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(Z(e),n)})),t))for(;a<u;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o},ve=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};s.uid=1,s.prototype={register:function(e,t){var n=t||{};return e.nodeType?e[this.expando]=n:Object.defineProperty(e,this.expando,{value:n,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!ve(e))return{};var t=e[this.expando];return t||(t={},ve(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[t]=n;else for(r in t)i[r]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,n){var r;return void 0===t||t&&"string"==typeof t&&void 0===n?void 0!==(r=this.get(e,t))?r:this.get(e,Z.camelCase(t)):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r,i,o=e[this.expando];if(void 0!==o){if(void 0===t)this.register(e);else{Z.isArray(t)?r=t.concat(t.map(Z.camelCase)):(i=Z.camelCase(t),r=t in o?[t,i]:(r=i)in o?[r]:r.match(he)||[]),n=r.length;for(;n--;)delete o[r[n]]}(void 0===t||Z.isEmptyObject(o))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!Z.isEmptyObject(t)}};var ye=new s,xe=new s,be=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,we=/[A-Z]/g;Z.extend({hasData:function(e){return xe.hasData(e)||ye.hasData(e)},data:function(e,t,n){return xe.access(e,t,n)},removeData:function(e,t){xe.remove(e,t)},_data:function(e,t,n){return ye.access(e,t,n)},_removeData:function(e,t){ye.remove(e,t)}}),Z.fn.extend({data:function(e,t){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(i=xe.get(o),1===o.nodeType&&!ye.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(r=s[n].name).indexOf("data-")&&(r=Z.camelCase(r.slice(5)),a(o,r,i[r]));ye.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){xe.set(this,e)}):me(this,function(t){var n,r;if(o&&void 0===t){if(void 0!==(n=xe.get(o,e)||xe.get(o,e.replace(we,"-$&").toLowerCase())))return n;if(r=Z.camelCase(e),void 0!==(n=xe.get(o,r)))return n;if(void 0!==(n=a(o,r,void 0)))return n}else r=Z.camelCase(e),this.each(function(){var n=xe.get(this,r);xe.set(this,r,t),e.indexOf("-")>-1&&void 0!==n&&xe.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){xe.remove(this,e)})}}),Z.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ye.get(e,t),n&&(!r||Z.isArray(n)?r=ye.access(e,t,Z.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=Z.queue(e,t),r=n.length,i=n.shift(),o=Z._queueHooks(e,t),s=function(){Z.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ye.get(e,n)||ye.access(e,n,{empty:Z.Callbacks("once memory").add(function(){ye.remove(e,[t+"queue",n])})})}}),Z.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?Z.queue(this[0],e):void 0===t?this:this.each(function(){var n=Z.queue(this,e,t);Z._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&Z.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=Z.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=ye.get(o[s],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var Te=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ce=new RegExp("^(?:([+-])=|)("+Te+")([a-z%]*)$","i"),ke=["Top","Right","Bottom","Left"],Ee=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},Ne=/^(?:checkbox|radio)$/i,Se=/<([\w:-]+)/,De=/^$|\/(?:java|ecma)script/i,je={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};je.optgroup=je.option,je.tbody=je.tfoot=je.colgroup=je.caption=je.thead,je.th=je.td;var Ae=/<|&#?\w+;/;!function(){var e=X.createDocumentFragment().appendChild(X.createElement("div")),t=X.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),K.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",K.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Le=/^key/,qe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,He=/^([^.]*)(?:\.(.+)|)/;Z.event={global:{},add:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,m=ye.get(e);if(m)for(n.handler&&(n=(o=n).handler,i=o.selector),n.guid||(n.guid=Z.guid++),(u=m.events)||(u=m.events={}),(s=m.handle)||(s=m.handle=function(t){return void 0!==Z&&Z.event.triggered!==t.type?Z.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(he)||[""]).length;l--;)d=g=(a=He.exec(t[l])||[])[1],h=(a[2]||"").split(".").sort(),d&&(f=Z.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=Z.event.special[d]||{},c=Z.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&Z.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,h,s)||e.addEventListener&&e.addEventListener(d,s)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),Z.event.global[d]=!0)},remove:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,m=ye.hasData(e)&&ye.get(e);if(m&&(u=m.events)){for(l=(t=(t||"").match(he)||[""]).length;l--;)if(a=He.exec(t[l])||[],d=g=a[1],h=(a[2]||"").split(".").sort(),d){for(f=Z.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));s&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,m.handle)||Z.removeEvent(e,d,m.handle),delete u[d])}else for(d in u)Z.event.remove(e,d+t[l],n,r,!0);Z.isEmptyObject(u)&&ye.remove(e,"handle events")}},dispatch:function(e){e=Z.event.fix(e);var t,n,r,i,o,s=[],a=z.call(arguments),u=(ye.get(this,"events")||{})[e.type]||[],l=Z.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,e)){for(s=Z.event.handlers.call(this,e,u),t=0;(i=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(o.namespace)||(e.handleObj=o,e.data=o.data,void 0!==(r=((Z.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a))&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&(!0!==u.disabled||"click"!==e.type)){for(r=[],n=0;n<a;n++)void 0===r[i=(o=t[n]).selector+" "]&&(r[i]=o.needsContext?Z(i,this).index(u)>-1:Z.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,o=t.button;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||X).documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=qe.test(i)?this.mouseHooks:Le.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new Z.Event(o),t=r.length;t--;)e[n=r[t]]=o[n];return e.target||(e.target=X),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==h()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===h()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&Z.nodeName(this,"input"))return this.click(),!1},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},Z.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},Z.Event=function(e,t){if(!(this instanceof Z.Event))return new Z.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?p:d):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),this[Z.expando]=!0},Z.Event.prototype={constructor:Z.Event,isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=p,e&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=p,e&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=p,e&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Z.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||Z.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}}),Z.fn.extend({on:function(e,t,n,r){return g(this,e,t,n,r)},one:function(e,t,n,r){return g(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,Z(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=d),this.each(function(){Z.event.remove(this,e,n,t)})}});var Oe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Fe=/<script|<style|<link/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Re=/^true\/(.*)/,Me=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;Z.extend({htmlPrefilter:function(e){return e.replace(Oe,"<$1></$2>")},clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=Z.contains(e.ownerDocument,e);if(!(K.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(s=l(a),r=0,i=(o=l(e)).length;r<i;r++)b(o[r],s[r]);if(t)if(n)for(o=o||l(e),s=s||l(a),r=0,i=o.length;r<i;r++)x(o[r],s[r]);else x(e,a);return(s=l(a,"script")).length>0&&c(s,!u&&l(e,"script")),a},cleanData:function(e){for(var t,n,r,i=Z.event.special,o=0;void 0!==(n=e[o]);o++)if(ve(n)){if(t=n[ye.expando]){if(t.events)for(r in t.events)i[r]?Z.event.remove(n,r):Z.removeEvent(n,r,t.handle);n[ye.expando]=void 0}n[xe.expando]&&(n[xe.expando]=void 0)}}}),Z.fn.extend({domManip:w,detach:function(e){return T(this,e,!0)},remove:function(e){return T(this,e)},text:function(e){return me(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return w(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){m(this,e).appendChild(e)}})},prepend:function(){return w(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=m(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return w(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return w(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(l(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return me(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Fe.test(e)&&!je[(Se.exec(e)||["",""])[1].toLowerCase()]){e=Z.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(Z.cleanData(l(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return w(this,arguments,function(t){var n=this.parentNode;Z.inArray(this,e)<0&&(Z.cleanData(l(this)),n&&n.replaceChild(t,this))},e)}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Z.fn[e]=function(e){for(var n,r=[],i=Z(e),o=i.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),Z(i[s])[t](n),V.apply(r,n.get());return this.pushStack(r)}});var We,Ie={HTML:"block",BODY:"block"},$e=/^margin/,Be=new RegExp("^("+Te+")(?!px)[a-z%]+$","i"),_e=function(t){var n=t.ownerDocument.defaultView;return n.opener||(n=e),n.getComputedStyle(t)},Xe=function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i},ze=X.documentElement;!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",ze.appendChild(s);var t=e.getComputedStyle(a);n="1%"!==t.top,o="2px"===t.marginLeft,r="4px"===t.width,a.style.marginRight="50%",i="4px"===t.marginRight,ze.removeChild(s)}var n,r,i,o,s=X.createElement("div"),a=X.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",K.clearCloneStyle="content-box"===a.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(a),Z.extend(K,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==r&&t(),r},pixelMarginRight:function(){return null==r&&t(),i},reliableMarginLeft:function(){return null==r&&t(),o},reliableMarginRight:function(){var t,n=a.appendChild(X.createElement("div"));return n.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",a.style.width="1px",ze.appendChild(s),t=!parseFloat(e.getComputedStyle(n).marginRight),ze.removeChild(s),a.removeChild(n),t}}))}();var Ue=/^(none|table(?!-c[ea]).+)/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ye={letterSpacing:"0",fontWeight:"400"},Ge=["Webkit","O","Moz","ms"],Qe=X.createElement("div").style;Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=E(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=Z.camelCase(t),l=e.style;if(t=Z.cssProps[a]||(Z.cssProps[a]=S(a)||a),s=Z.cssHooks[t]||Z.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:l[t];"string"==(o=typeof n)&&(i=Ce.exec(n))&&i[1]&&(n=u(e,t,i),o="number"),null!=n&&n==n&&("number"===o&&(n+=i&&i[3]||(Z.cssNumber[a]?"":"px")),K.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(l[t]=n))}},css:function(e,t,n,r){var i,o,s,a=Z.camelCase(t);return t=Z.cssProps[a]||(Z.cssProps[a]=S(a)||a),(s=Z.cssHooks[t]||Z.cssHooks[a])&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=E(e,t,r)),"normal"===i&&t in Ye&&(i=Ye[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),Z.each(["height","width"],function(e,t){Z.cssHooks[t]={get:function(e,n,r){if(n)return Ue.test(Z.css(e,"display"))&&0===e.offsetWidth?Xe(e,Ve,function(){return A(e,t,r)}):A(e,t,r)},set:function(e,n,r){var i,o=r&&_e(e),s=r&&j(e,t,r,"border-box"===Z.css(e,"boxSizing",!1,o),o);return s&&(i=Ce.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=Z.css(e,t)),D(0,n,s)}}}),Z.cssHooks.marginLeft=N(K.reliableMarginLeft,function(e,t){if(t)return(parseFloat(E(e,"marginLeft"))||e.getBoundingClientRect().left-Xe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),Z.cssHooks.marginRight=N(K.reliableMarginRight,function(e,t){if(t)return Xe(e,{display:"inline-block"},E,[e,"marginRight"])}),Z.each({margin:"",padding:"",border:"Width"},function(e,t){Z.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+ke[r]+t]=o[r]||o[r-2]||o[0];return i}},$e.test(e)||(Z.cssHooks[e+t].set=D)}),Z.fn.extend({css:function(e,t){return me(this,function(e,t,n){var r,i,o={},s=0;if(Z.isArray(t)){for(r=_e(e),i=t.length;s<i;s++)o[t[s]]=Z.css(e,t[s],!1,r);return o}return void 0!==n?Z.style(e,t,n):Z.css(e,t)},e,t,arguments.length>1)},show:function(){return L(this,!0)},hide:function(){return L(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ee(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=q,(q.prototype={constructor:q,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||Z.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(Z.cssNumber[n]?"":"px")},cur:function(){var e=q.propHooks[this.prop];return e&&e.get?e.get(this):q.propHooks._default.get(this)},run:function(e){var t,n=q.propHooks[this.prop];return this.options.duration?this.pos=t=Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):q.propHooks._default.set(this),this}}).init.prototype=q.prototype,(q.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=Z.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[Z.cssProps[e.prop]]&&!Z.cssHooks[e.prop]?e.elem[e.prop]=e.now:Z.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=q.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},Z.fx=q.prototype.init,Z.fx.step={};var Je,Ke,Ze=/^(?:toggle|show|hide)$/,et=/queueHooks$/;Z.Animation=Z.extend(P,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return u(n.elem,e,Ce.exec(t),n),n}]},tweener:function(e,t){Z.isFunction(e)?(t=e,e=["*"]):e=e.match(he);for(var n,r=0,i=e.length;r<i;r++)n=e[r],P.tweeners[n]=P.tweeners[n]||[],P.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,s,a,u,l,c=this,f={},p=e.style,d=e.nodeType&&Ee(e),h=ye.get(e,"fxshow");n.queue||(null==(a=Z._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,c.always(function(){c.always(function(){a.unqueued--,Z.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===("none"===(l=Z.css(e,"display"))?ye.get(e,"olddisplay")||k(e.nodeName):l)&&"none"===Z.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],Ze.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(d?"hide":"show")){if("show"!==i||!h||void 0===h[r])continue;d=!0}f[r]=h&&h[r]||Z.style(e,r)}else l=void 0;if(Z.isEmptyObject(f))"inline"===("none"===l?k(e.nodeName):l)&&(p.display=l);else{h?"hidden"in h&&(d=h.hidden):h=ye.access(e,"fxshow",{}),o&&(h.hidden=!d),d?Z(e).show():c.done(function(){Z(e).hide()}),c.done(function(){var t;ye.remove(e,"fxshow");for(t in f)Z.style(e,t,f[t])});for(r in f)s=F(d?h[r]:0,r,c),r in h||(h[r]=s.start,d&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}],prefilter:function(e,t){t?P.prefilters.unshift(e):P.prefilters.push(e)}}),Z.speed=function(e,t,n){var r=e&&"object"==typeof e?Z.extend({},e):{complete:n||!n&&t||Z.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Z.isFunction(t)&&t};return r.duration=Z.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in Z.fx.speeds?Z.fx.speeds[r.duration]:Z.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){Z.isFunction(r.old)&&r.old.call(this),r.queue&&Z.dequeue(this,r.queue)},r},Z.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Ee).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=Z.isEmptyObject(e),o=Z.speed(t,n,r),s=function(){var t=P(this,Z.extend({},e),o);(i||ye.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=Z.timers,s=ye.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&et.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||Z.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=ye.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=Z.timers,s=r?r.length:0;for(n.finish=!0,Z.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),Z.each(["toggle","show","hide"],function(e,t){var n=Z.fn[t];Z.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(O(t,!0),e,r,i)}}),Z.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Z.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,n=Z.timers;for(Je=Z.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||Z.fx.stop(),Je=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Ke||(Ke=e.setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){e.clearInterval(Ke),Ke=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(t,n){return t=Z.fx?Z.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=X.createElement("input"),t=X.createElement("select"),n=t.appendChild(X.createElement("option"));e.type="checkbox",K.checkOn=""!==e.value,K.optSelected=n.selected,t.disabled=!0,K.optDisabled=!n.disabled,(e=X.createElement("input")).value="t",e.type="radio",K.radioValue="t"===e.value}();var tt,nt=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return me(this,Z.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?Z.prop(e,t,n):(1===o&&Z.isXMLDoc(e)||(t=t.toLowerCase(),i=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?tt:void 0)),void 0!==n?null===n?void Z.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=Z.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!K.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(he);if(o&&1===e.nodeType)for(;n=o[i++];)r=Z.propFix[n]||n,Z.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)}}),tt={set:function(e,t,n){return!1===t?Z.removeAttr(e,n):e.setAttribute(n,n),n}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var n=nt[t]||Z.find.attr;nt[t]=function(e,t,r){var i,o;return r||(o=nt[t],nt[t]=i,i=null!=n(e,t,r)?t.toLowerCase():null,nt[t]=o),i}});var rt=/^(?:input|select|textarea|button)$/i,it=/^(?:a|area)$/i;Z.fn.extend({prop:function(e,t){return me(this,Z.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&Z.isXMLDoc(e)||(t=Z.propFix[t]||t,i=Z.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=Z.find.attr(e,"tabindex");return t?parseInt(t,10):rt.test(e.nodeName)||it.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),K.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var ot=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(e){var t,n,r,i,o,s,a,u=0;if(Z.isFunction(e))return this.each(function(t){Z(this).addClass(e.call(this,t,R(this)))});if("string"==typeof e&&e)for(t=e.match(he)||[];n=this[u++];)if(i=R(n),r=1===n.nodeType&&(" "+i+" ").replace(ot," ")){for(s=0;o=t[s++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(a=Z.trim(r))&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,r,i,o,s,a,u=0;if(Z.isFunction(e))return this.each(function(t){Z(this).removeClass(e.call(this,t,R(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(he)||[];n=this[u++];)if(i=R(n),r=1===n.nodeType&&(" "+i+" ").replace(ot," ")){for(s=0;o=t[s++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(a=Z.trim(r))&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):Z.isFunction(e)?this.each(function(n){Z(this).toggleClass(e.call(this,n,R(this),t),t)}):this.each(function(){var t,r,i,o;if("string"===n)for(r=0,i=Z(this),o=e.match(he)||[];t=o[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==e&&"boolean"!==n||((t=R(this))&&ye.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":ye.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+R(n)+" ").replace(ot," ").indexOf(t)>-1)return!0;return!1}});var st=/\r/g;Z.fn.extend({val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=Z.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,Z(this).val()):e)?i="":"number"==typeof i?i+="":Z.isArray(i)&&(i=Z.map(i,function(e){return null==e?"":e+""})),(t=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return(t=Z.valHooks[i.type]||Z.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(st,""):null==n?"":n}}),Z.extend({valHooks:{option:{get:function(e){return Z.trim(e.value)}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||i<0,s=o?null:[],a=o?i+1:r.length,u=i<0?a:o?i:0;u<a;u++)if(((n=r[u]).selected||u===i)&&(K.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!Z.nodeName(n.parentNode,"optgroup"))){if(t=Z(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=Z.makeArray(t),s=i.length;s--;)((r=i[s]).selected=Z.inArray(Z.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){if(Z.isArray(t))return e.checked=Z.inArray(Z(e).val(),t)>-1}},K.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var at=/^(?:focusinfocus|focusoutblur)$/;Z.extend(Z.event,{trigger:function(t,n,r,i){var o,s,a,u,l,c,f,p=[r||X],d=J.call(t,"type")?t.type:t,h=J.call(t,"namespace")?t.namespace.split("."):[];if(s=a=r=r||X,3!==r.nodeType&&8!==r.nodeType&&!at.test(d+Z.event.triggered)&&(d.indexOf(".")>-1&&(d=(h=d.split(".")).shift(),h.sort()),l=d.indexOf(":")<0&&"on"+d,t=t[Z.expando]?t:new Z.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=h.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:Z.makeArray(n,[t]),f=Z.event.special[d]||{},i||!f.trigger||!1!==f.trigger.apply(r,n))){if(!i&&!f.noBubble&&!Z.isWindow(r)){for(u=f.delegateType||d,at.test(u+d)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(r.ownerDocument||X)&&p.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=p[o++])&&!t.isPropagationStopped();)t.type=o>1?u:f.bindType||d,(c=(ye.get(s,"events")||{})[t.type]&&ye.get(s,"handle"))&&c.apply(s,n),(c=l&&s[l])&&c.apply&&ve(s)&&(t.result=c.apply(s,n),!1===t.result&&t.preventDefault());return t.type=d,i||t.isDefaultPrevented()||f._default&&!1!==f._default.apply(p.pop(),n)||!ve(r)||l&&Z.isFunction(r[d])&&!Z.isWindow(r)&&((a=r[l])&&(r[l]=null),Z.event.triggered=d,r[d](),Z.event.triggered=void 0,a&&(r[l]=a)),t.result}},simulate:function(e,t,n){var r=Z.extend(new Z.Event,n,{type:e,isSimulated:!0});Z.event.trigger(r,null,t),r.isDefaultPrevented()&&n.preventDefault()}}),Z.fn.extend({trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return Z.event.trigger(e,t,n,!0)}}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Z.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),K.focusin="onfocusin"in e,K.focusin||Z.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){Z.event.simulate(t,e.target,Z.event.fix(e))};Z.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=ye.access(r,t);i||r.addEventListener(e,n,!0),ye.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=ye.access(r,t)-1;i?ye.access(r,t,i):(r.removeEventListener(e,n,!0),ye.remove(r,t))}}});var ut=e.location,lt=Z.now(),ct=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||Z.error("Invalid XML: "+t),n};var ft=/#.*$/,pt=/([?&])_=[^&]*/,dt=/^(.*?):[ \t]*([^\r\n]*)$/gm,ht=/^(?:GET|HEAD)$/,gt=/^\/\//,mt={},vt={},yt="*/".concat("*"),xt=X.createElement("a");xt.href=ut.href,Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ut.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ut.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":yt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?I(I(e,Z.ajaxSettings),t):I(Z.ajaxSettings,e)},ajaxPrefilter:M(mt),ajaxTransport:M(vt),ajax:function(t,n){function r(t,n,r,a){var l,f,y,x,w,C=n;2!==b&&(b=2,u&&e.clearTimeout(u),i=void 0,s=a||"",T.readyState=t>0?4:0,l=t>=200&&t<300||304===t,r&&(x=function(e,t,n){for(var r,i,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}if(o)return o!==u[0]&&u.unshift(o),n[o]}(p,T,r)),x=function(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=l[u+" "+o]||l["* "+o]))for(i in l)if((a=i.split(" "))[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[i]:!0!==l[i]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(p,x,T,l),l?(p.ifModified&&((w=T.getResponseHeader("Last-Modified"))&&(Z.lastModified[o]=w),(w=T.getResponseHeader("etag"))&&(Z.etag[o]=w)),204===t||"HEAD"===p.type?C="nocontent":304===t?C="notmodified":(C=x.state,f=x.data,l=!(y=x.error))):(y=C,!t&&C||(C="error",t<0&&(t=0))),T.status=t,T.statusText=(n||C)+"",l?g.resolveWith(d,[f,C,T]):g.rejectWith(d,[T,C,y]),T.statusCode(v),v=void 0,c&&h.trigger(l?"ajaxSuccess":"ajaxError",[T,p,l?f:y]),m.fireWith(d,[T,C]),c&&(h.trigger("ajaxComplete",[T,p]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,s,a,u,l,c,f,p=Z.ajaxSetup({},n),d=p.context||p,h=p.context&&(d.nodeType||d.jquery)?Z(d):Z.event,g=Z.Deferred(),m=Z.Callbacks("once memory"),v=p.statusCode||{},y={},x={},b=0,w="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!a)for(a={};t=dt.exec(s);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=x[n]=x[n]||e,y[e]=t),this},overrideMimeType:function(e){return b||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)v[t]=[v[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||w;return i&&i.abort(t),r(0,t),this}};if(g.promise(T).complete=m.add,T.success=T.done,T.error=T.fail,p.url=((t||p.url||ut.href)+"").replace(ft,"").replace(gt,ut.protocol+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=Z.trim(p.dataType||"*").toLowerCase().match(he)||[""],null==p.crossDomain){l=X.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=xt.protocol+"//"+xt.host!=l.protocol+"//"+l.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=Z.param(p.data,p.traditional)),W(mt,p,n,T),2===b)return T;(c=Z.event&&p.global)&&0==Z.active++&&Z.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!ht.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(ct.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=pt.test(o)?o.replace(pt,"$1_="+lt++):o+(ct.test(o)?"&":"?")+"_="+lt++)),p.ifModified&&(Z.lastModified[o]&&T.setRequestHeader("If-Modified-Since",Z.lastModified[o]),Z.etag[o]&&T.setRequestHeader("If-None-Match",Z.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||n.contentType)&&T.setRequestHeader("Content-Type",p.contentType),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+yt+"; q=0.01":""):p.accepts["*"]);for(f in p.headers)T.setRequestHeader(f,p.headers[f]);if(p.beforeSend&&(!1===p.beforeSend.call(d,T,p)||2===b))return T.abort();w="abort";for(f in{success:1,error:1,complete:1})T[f](p[f]);if(i=W(vt,p,n,T)){if(T.readyState=1,c&&h.trigger("ajaxSend",[T,p]),2===b)return T;p.async&&p.timeout>0&&(u=e.setTimeout(function(){T.abort("timeout")},p.timeout));try{b=1,i.send(y,r)}catch(e){if(!(b<2))throw e;r(-1,e)}}else r(-1,"No Transport");return T},getJSON:function(e,t,n){return Z.get(e,t,n,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,t){Z[t]=function(e,n,r,i){return Z.isFunction(n)&&(i=i||r,r=n,n=void 0),Z.ajax(Z.extend({url:e,type:t,dataType:i,data:n,success:r},Z.isPlainObject(e)&&e))}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},Z.fn.extend({wrapAll:function(e){var t;return Z.isFunction(e)?this.each(function(t){Z(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Z(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return Z.isFunction(e)?this.each(function(t){Z(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Z(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Z.isFunction(e);return this.each(function(n){Z(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return!Z.expr.filters.visible(e)},Z.expr.filters.visible=function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0};var bt=/%20/g,wt=/\[\]$/,Tt=/\r?\n/g,Ct=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var n,r=[],i=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){i(this.name,this.value)});else for(n in e)$(n,e[n],t,i);return r.join("&").replace(bt,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&kt.test(this.nodeName)&&!Ct.test(e)&&(this.checked||!Ne.test(e))}).map(function(e,t){var n=Z(this).val();return null==n?null:Z.isArray(n)?Z.map(n,function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}}):{name:t.name,value:n.replace(Tt,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Et={0:200,1223:204},Nt=Z.ajaxSettings.xhr();K.cors=!!Nt&&"withCredentials"in Nt,K.ajax=Nt=!!Nt,Z.ajaxTransport(function(t){var n,r;if(K.cors||Nt&&!t.crossDomain)return{send:function(i,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)a.setRequestHeader(s,i[s]);n=function(e){return function(){n&&(n=r=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Et[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),r=a.onerror=n("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=Z("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),X.head.appendChild(t[0])},abort:function(){n&&n()}}}});var St=[],Dt=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=St.pop()||Z.expando+"_"+lt++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=!1!==t.jsonp&&(Dt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=Z.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Dt,"$1"+i):!1!==t.jsonp&&(t.url+=(ct.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||Z.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){void 0===o?Z(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,St.push(i)),s&&Z.isFunction(o)&&o(s[0]),s=o=void 0}),"script"}),K.createHTMLDocument=function(){var e=X.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),Z.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||(K.createHTMLDocument?X.implementation.createHTMLDocument(""):X);var r=ue.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=f([e],t,i),i&&i.length&&Z(i).remove(),Z.merge([],r.childNodes))};var jt=Z.fn.load;Z.fn.load=function(e,t,n){if("string"!=typeof e&&jt)return jt.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>-1&&(r=Z.trim(e.slice(a)),e=e.slice(0,a)),Z.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&Z.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?Z("<div>").append(Z.parseHTML(e)).find(r):e)}).always(n&&function(e,t){s.each(function(){n.apply(s,o||[e.responseText,t,e])})}),this},Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z.expr.filters.animated=function(e){return Z.grep(Z.timers,function(t){return e===t.elem}).length},Z.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l=Z.css(e,"position"),c=Z(e),f={};"static"===l&&(e.style.position="relative"),a=c.offset(),o=Z.css(e,"top"),u=Z.css(e,"left"),("absolute"===l||"fixed"===l)&&(o+u).indexOf("auto")>-1?(s=(r=c.position()).top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),Z.isFunction(t)&&(t=t.call(e,n,Z.extend({},a))),null!=t.top&&(f.top=t.top-a.top+s),null!=t.left&&(f.left=t.left-a.left+i),"using"in t?t.using.call(e,f):c.css(f)}},Z.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Z.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},o=r&&r.ownerDocument;if(o)return t=o.documentElement,Z.contains(t,r)?(i=r.getBoundingClientRect(),n=B(o),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===Z.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(r=e.offset()),r.top+=Z.css(e[0],"borderTopWidth",!0)-e.scrollTop(),r.left+=Z.css(e[0],"borderLeftWidth",!0)-e.scrollLeft()),{top:t.top-r.top-Z.css(n,"marginTop",!0),left:t.left-r.left-Z.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||ze})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;Z.fn[e]=function(r){return me(this,function(e,r,i){var o=B(e);if(void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),Z.each(["top","left"],function(e,t){Z.cssHooks[t]=N(K.pixelPosition,function(e,n){if(n)return n=E(e,t),Be.test(n)?Z(e).position()[t]+"px":n})}),Z.each({Height:"height",Width:"width"},function(e,t){Z.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){Z.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===i?"margin":"border");return me(this,function(t,n,r){var i;return Z.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===r?Z.css(t,n,s):Z.style(t,n,r,s)},t,o?r:void 0,o,null)}})}),Z.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},size:function(){return this.length}}),Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var At=e.jQuery,Lt=e.$;return Z.noConflict=function(t){return e.$===Z&&(e.$=Lt),t&&e.jQuery===Z&&(e.jQuery=At),Z},t||(e.jQuery=e.$=Z),Z});

},{}],332:[function(require,module,exports){
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var r,i,s=0,a=!1,n=!1,o=!1,d=[],c=e("script:last").attr("src"),l=window.document,h=l.createElement("LI");h.setAttribute("role","treeitem"),(r=l.createElement("I")).className="jstree-icon jstree-ocl",r.setAttribute("role","presentation"),h.appendChild(r),(r=l.createElement("A")).className="jstree-anchor",r.setAttribute("href","#"),r.setAttribute("tabindex","-1"),(i=l.createElement("I")).className="jstree-icon jstree-themeicon",i.setAttribute("role","presentation"),r.appendChild(i),h.appendChild(r),r=i=null,e.jstree={version:"3.3.2",defaults:{plugins:[]},plugins:{},path:c&&-1!==c.indexOf("/")?c.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,r){var i=new e.jstree.core(++s),a=r;return r=e.extend(!0,{},e.jstree.defaults,r),a&&a.plugins&&(r.plugins=a.plugins),e.each(r.plugins,function(e,t){"core"!==e&&(i=i.plugin(t,r[t]))}),e(t).data("jstree",i),i.init(t,r),i},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(l).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var r=null,i=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!i||!i.length)try{i=e(t)}catch(e){}if(!i||!i.length)try{i=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(e){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?r=i:e(".jstree").each(function(){var i=e(this).data("jstree");if(i&&i._model.data[t])return r=i,!1}),r},e.fn.jstree=function(r){var i="string"==typeof r,s=Array.prototype.slice.call(arguments,1),a=null;return!(!0===r&&!this.length)&&(this.each(function(){var n=e.jstree.reference(this),o=i&&n?n[r]:null;if(a=i&&o?o.apply(n,s):null,n||i||r!==t&&!e.isPlainObject(r)||e.jstree.create(this,r),(n&&!i||!0===r)&&(a=n||!1),null!==a&&a!==t)return!1}),null!==a&&a!==t?a:this)},e.expr.pseudos.jstree=e.expr.createPseudo(function(r){return function(r){return e(r).hasClass("jstree")&&e(r).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,r){var i=e.jstree.plugins[t];return i?(this._data[t]={},i.prototype=this,new i(r,this)):this},init:function(t,r){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=r,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",r=null,i=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(l.selection&&l.selection.empty)l.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),i=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==l.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var r=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(r=this.get_parent(t.currentTarget))&&r.id!==e.jstree.root&&this.get_node(r,!0).children(".jstree-anchor").focus();break;case 38:t.preventDefault(),(r=this.get_prev_dom(t.currentTarget))&&r.length&&r.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(r=this.get_node(t.currentTarget,!0).children(".jstree-children")[0])&&e(this._firstChild(r)).children(".jstree-anchor").focus();break;case 40:t.preventDefault(),(r=this.get_next_dom(t.currentTarget))&&r.length&&r.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),(r=this._firstChild(this.get_container_ul()[0]))&&e(r).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus();break;case 113:t.preventDefault(),this.edit(t.currentTarget)}},this)).on("load_node.jstree",e.proxy(function(t,r){r.status&&(r.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,r,i=[];for(t=0,r=this._data.core.selected.length;t<r;t++)i=i.concat(this._model.data[this._data.core.selected[t]].parents);for(t=0,r=(i=e.vakata.array_unique(i)).length;t<r;t++)this.open_node(i[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(i){if(i.target.tagName&&"input"===i.target.tagName.toLowerCase())return!0;r&&clearTimeout(r),r=setTimeout(function(){t=""},500);var s=String.fromCharCode(i.which).toLowerCase(),a=this.element.find(".jstree-anchor").filter(":visible"),n=a.index(l.activeElement)||0,o=!1;if((t+=s).length>1){if(a.slice(n).each(e.proxy(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),o=!0,!1},this)),o)return;if(a.slice(0,n).each(e.proxy(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),o=!0,!1},this)),o)return}if(new RegExp("^"+s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(a.slice(n+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===s)return e(r).focus(),o=!0,!1},this)),o)return;if(a.slice(0,n+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===s)return e(r).focus(),o=!0,!1},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var r=this.get_node(t.currentTarget);r&&r.id&&(this._data.core.focused=r.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-i>500&&!this._data.core.focused){i=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(l).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var r=this.settings.core.strings;return e.isFunction(r)?r.call(this,t):r&&r[t]?r[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,r){t&&t.id&&(t=t.id);var i;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(i=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=e(t,this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=e(t,this.element)).length||!i.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return r&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(e){return!1}},get_path:function(t,r,i){if(!(t=t.parents?t:this.get_node(t))||t.id===e.jstree.root||!t.parents)return!1;var s,a,n=[];for(n.push(i?t.id:t.text),s=0,a=t.parents.length;s<a;s++)n.push(i?t.parents[s]:this.get_text(t.parents[s]));return n=n.reverse().slice(1),r?n.join(r):n},get_next_dom:function(t,r){var i;if((t=this.get_node(t,!0))[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}if(t.hasClass("jstree-open")){for(i=this._firstChild(t.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return e(i)}i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return null!==i?e(i):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,r){var i;if((t=this.get_node(t,!0))[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);if(null!==i){for(t=e(i);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return!(!(i=t[0].parentNode.parentNode)||!i.className||-1===i.className.indexOf("jstree-node"))&&e(i)},get_parent:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||e.children.length>0)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,r){var i,s,a,n,o;if(e.isArray(t))return this._load_nodes(t.slice(),r),!0;if(!(t=this.get_node(t)))return r&&r.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,a=0,n=t.parents.length;a<n;a++)this._model.data[t.parents[a]].children_d=e.vakata.array_filter(this._model.data[t.parents[a]].children_d,function(r){return-1===e.inArray(r,t.children_d)});for(i=0,s=t.children_d.length;i<s;i++)this._model.data[t.children_d[i]].state.selected&&(o=!0),delete this._model.data[t.children_d[i]];o&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(r){return-1===e.inArray(r,t.children_d)})),t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){(t=this._model.data[t.id]).state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var i=this.get_node(t,!0),s=0,a=0,n=this._model.data,o=!1;for(s=0,a=t.children.length;s<a;s++)if(n[t.children[s]]&&!n[t.children[s]].state.hidden){o=!0;break}t.state.loaded&&i&&i.length&&(i.removeClass("jstree-closed jstree-open jstree-leaf"),o?"#"!==t.id&&i.addClass(t.state.opened?"jstree-open":"jstree-closed"):i.addClass("jstree-leaf")),i.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),r&&r.call(this,t,e)},this)),!0},_load_nodes:function(e,t,r,i){var s,a,n=!0,o=function(){this._load_nodes(e,t,!0)},d=this._model.data,c=[];for(s=0,a=e.length;s<a;s++)d[e[s]]&&(!d[e[s]].state.loaded&&!d[e[s]].state.failed||!r&&i)&&(this.is_loading(e[s])||this.load_node(e[s],o),n=!1);if(n){for(s=0,a=e.length;s<a;s++)d[e[s]]&&d[e[s]].state.loaded&&c.push(e[s]);t&&!t.done&&(t.call(this,c),t.done=!0)}},load_all:function(t,r){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var i,s,a=[],n=this._model.data,o=n[t.id].children_d;for(t.state&&!t.state.loaded&&a.push(t.id),i=0,s=o.length;i<s;i++)n[o[i]]&&n[o[i]].state&&!n[o[i]].state.loaded&&a.push(o[i]);a.length?this._load_nodes(a,function(){this.load_all(t,r)}):(r&&r.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,r){var i,s=this.settings.core.data,a=function(){return 3!==this.nodeType&&8!==this.nodeType};return s?e.isFunction(s)?s.call(this,t,e.proxy(function(i){!1===i?r.call(this,!1):this["string"==typeof i?"_append_html_data":"_append_json_data"](t,"string"==typeof i?e(e.parseHTML(i)).filter(a):i,function(e){r.call(this,e)})},this)):"object"==typeof s?s.url?(s=e.extend(!0,{},s),e.isFunction(s.url)&&(s.url=s.url.call(this,t)),e.isFunction(s.data)&&(s.data=s.data.call(this,t)),e.ajax(s).done(e.proxy(function(i,s,n){var o=n.getResponseHeader("Content-Type");return o&&-1!==o.indexOf("json")||"object"==typeof i?this._append_json_data(t,i,function(e){r.call(this,e)}):o&&-1!==o.indexOf("html")||"string"==typeof i?this._append_html_data(t,e(e.parseHTML(i)).filter(a),function(e){r.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:n})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))},this)).fail(e.proxy(function(e){r.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(i=e.isArray(s)||e.isPlainObject(s)?JSON.parse(JSON.stringify(s)):s,t.id===e.jstree.root?this._append_json_data(t,i,function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))):"string"==typeof s?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(s)).filter(a),function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1)):r.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){r.call(this,e)}):r.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&this._model.changed.push(e.id)},_append_html_data:function(t,r,i){(t=this.get_node(t)).children=[],t.children_d=[];var s,a,n,o=r.is("ul")?r.children():r,d=t.id,c=[],l=[],h=this._model.data,_=h[d],u=this._data.core.selected.length;for(o.each(e.proxy(function(t,r){(s=this._parse_model_from_html(e(r),d,_.parents.concat()))&&(c.push(s),l.push(s),h[s].children_d.length&&(l=l.concat(h[s].children_d)))},this)),_.children=c,_.children_d=l,a=0,n=_.parents.length;a<n;a++)h[_.parents[a]].children_d=h[_.parents[a]].children_d.concat(l);this.trigger("model",{nodes:l,parent:d}),d!==e.jstree.root?(this._node_changed(d),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==u&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(t,r,i,s){if(null!==this.element){(t=this.get_node(t)).children=[],t.children_d=[],r.d&&"string"==typeof(r=r.d)&&(r=JSON.parse(r)),e.isArray(r)||(r=[r]);var a=null,n={df:this._model.default_state,dat:r,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(e,t){e.data&&(e=e.data);var r,i,s,a,n=e.dat,o=e.par,d=[],c=[],l=[],h=e.df,_=e.t_id,u=e.t_cnt,g=e.m,f=g[o],p=e.sel,m=function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var s,a,n,o,d=e.id.toString(),c={id:d,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(c.state[s]=h[s]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),c.icon!==t&&null!==c.icon&&""!==c.icon||(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(c.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(c.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(c.li_attr[s]=e.li_attr[s]);if(c.li_attr.id||(c.li_attr.id=d),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(c.a_attr[s]=e.a_attr[s]);for(e&&e.children&&!0===e.children&&(c.state.loaded=!1,c.children=[],c.children_d=[]),g[c.id]=c,s=0,a=c.children.length;s<a;s++)n=m(g[c.children[s]],c.id,i),o=g[n],c.children_d.push(n),o.children_d.length&&(c.children_d=c.children_d.concat(o.children_d));return delete e.data,delete e.children,g[c.id].original=e,c.state.selected&&l.push(c.id),c.id},v=function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var s,a,n,o,d,c=!1;do{c="j"+_+"_"+ ++u}while(g[c]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(d.state[s]=h[s]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(d.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(d.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(d.li_attr[s]=e.li_attr[s]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=c),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(d.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,a=e.children.length;s<a;s++)n=v(e.children[s],d.id,i),o=g[n],d.children.push(n),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,g[d.id]=d,d.state.selected&&l.push(d.id),d.id};if(n.length&&n[0].id!==t&&n[0].parent!==t){for(i=0,s=n.length;i<s;i++)n[i].children||(n[i].children=[]),g[n[i].id.toString()]=n[i];for(i=0,s=n.length;i<s;i++)g[n[i].parent.toString()].children.push(n[i].id.toString()),f.children_d.push(n[i].id.toString());for(i=0,s=f.children.length;i<s;i++)r=m(g[f.children[i]],o,f.parents.concat()),c.push(r),g[r].children_d.length&&(c=c.concat(g[r].children_d));for(i=0,s=f.parents.length;i<s;i++)g[f.parents[i]].children_d=g[f.parents[i]].children_d.concat(c);a={cnt:u,mod:g,sel:p,par:o,dpc:c,add:l}}else{for(i=0,s=n.length;i<s;i++)(r=v(n[i],o,f.parents.concat()))&&(d.push(r),c.push(r),g[r].children_d.length&&(c=c.concat(g[r].children_d)));for(f.children=d,f.children_d=c,i=0,s=f.parents.length;i<s;i++)g[f.parents[i]].children_d=g[f.parents[i]].children_d.concat(c);a={cnt:u,mod:g,sel:p,par:o,dpc:c,add:l}}if("undefined"!=typeof window&&void 0!==window.document)return a;postMessage(a)},d=function(t,r){if(null!==this.element){this._cnt=t.cnt;var s,a=this._model.data;for(s in a)a.hasOwnProperty(s)&&a[s].state&&a[s].state.loading&&t.mod[s]&&(t.mod[s].state.loading=!0);if(this._model.data=t.mod,r){var n,o=t.add,d=t.sel,c=this._data.core.selected.slice();if(a=this._model.data,d.length!==c.length||e.vakata.array_unique(d.concat(c)).length!==d.length){for(s=0,n=d.length;s<n;s++)-1===e.inArray(d[s],o)&&-1===e.inArray(d[s],c)&&(a[d[s]].state.selected=!1);for(s=0,n=c.length;s<n;s++)-1===e.inArray(c[s],d)&&(a[c[s]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"}))),!this._data.core.working||s?(this._data.core.working=!0,(a=new window.Worker(this._wrk)).onmessage=e.proxy(function(e){d.call(this,e.data,!0);try{a.terminate(),a=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),n.par?a.postMessage(n):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,r,i,!0])}catch(e){d.call(this,o(n),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else d.call(this,o(n),!1)}},_parse_model_from_html:function(r,i,s){s=s?[].concat(s):[],i&&s.unshift(i);var a,n,o,d,c,l=this._model.data,h={id:!1,text:!1,icon:!0,parent:i,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(h.state[o]=this._model.default_state[o]);if(d=e.vakata.attributes(r,!0),e.each(d,function(t,r){if(!(r=e.trim(r)).length)return!0;h.li_attr[t]=r,"id"===t&&(h.id=r.toString())}),(d=r.children("a").first()).length&&(d=e.vakata.attributes(d,!0),e.each(d,function(t,r){(r=e.trim(r)).length&&(h.a_attr[t]=r)})),(d=r.children("a").first().length?r.children("a").first().clone():r.clone()).children("ins, i, ul").remove(),d=d.html(),d=e("<div />").html(d),h.text=this.settings.core.force_text?d.text():d.html(),d=r.data(),h.data=d?e.extend(!0,{},d):null,h.state.opened=r.hasClass("jstree-open"),h.state.selected=r.children("a").hasClass("jstree-clicked"),h.state.disabled=r.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(o in h.data.jstree)h.data.jstree.hasOwnProperty(o)&&(h.state[o]=h.data.jstree[o]);(d=r.children("a").children(".jstree-themeicon")).length&&(h.icon=!d.hasClass("jstree-themeicon-hidden")&&d.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),d=r.children("ul").children("li");do{c="j"+this._id+"_"+ ++this._cnt}while(l[c]);return h.id=h.li_attr.id?h.li_attr.id.toString():c,d.length?(d.each(e.proxy(function(t,r){a=this._parse_model_from_html(e(r),h.id,s),n=this._model.data[a],h.children.push(a),n.children_d.length&&(h.children_d=h.children_d.concat(n.children_d))},this)),h.children_d=h.children_d.concat(h.children)):r.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr.class&&(h.li_attr.class=h.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),h.a_attr.class&&(h.a_attr.class=h.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),l[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var s,a,n,o,d=e.id.toString(),c=this._model.data,l=this._model.default_state,h={id:d,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in l)l.hasOwnProperty(s)&&(h.state[s]=l[s]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(h.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(h.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(h.li_attr[s]=e.li_attr[s]);if(h.li_attr.id||(h.li_attr.id=d),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(h.a_attr[s]=e.a_attr[s]);for(e&&e.children&&!0===e.children&&(h.state.loaded=!1,h.children=[],h.children_d=[]),c[h.id]=h,s=0,a=h.children.length;s<a;s++)o=c[n=this._parse_model_from_flat_json(c[h.children[s]],h.id,i)],h.children_d.push(n),o.children_d.length&&(h.children_d=h.children_d.concat(o.children_d));return delete e.data,delete e.children,c[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var s,a,n,o,d,c=!1,l=this._model.data,h=this._model.default_state;do{c="j"+this._id+"_"+ ++this._cnt}while(l[c]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(d.state[s]=h[s]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(d.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(d.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(d.li_attr[s]=e.li_attr[s]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=c),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(d.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,a=e.children.length;s<a;s++)o=l[n=this._parse_model_from_json(e.children[s],d.id,i)],d.children.push(n),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,l[d.id]=d,d.state.selected&&this._data.core.selected.push(d.id),d.id},_redraw:function(){var t,r,i,s=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),a=l.createElement("UL"),n=this._data.core.focused;for(r=0,i=s.length;r<i;r++)(t=this.redraw_node(s[r],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&a.appendChild(t);this._model.force_full_redraw&&(a.className=this.get_container_ul()[0].className,a.setAttribute("role","group"),this.element.empty().append(a)),null!==n&&((t=this.get_node(n,!0))&&t.length&&t.children(".jstree-anchor")[0]!==l.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:s})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var r=this.get_node(t),i=!1,s=!1,a=!1,n=l;if(!r)return!1;if(r.id===e.jstree.root)return this.redraw(!0);if(!(t=this.get_node(t,!0))||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],r.children.length&&r.state.loaded){for((a=n.createElement("UL")).setAttribute("role","group"),a.className="jstree-children",i=0,s=r.children.length;i<s;i++)a.appendChild(this.redraw_node(r.children[i],!0,!0));t.appendChild(a)}},redraw_node:function(t,r,i,s){var a=this.get_node(t),n=!1,o=!1,d=!1,c=!1,_=!1,u=!1,g="",f=l,p=this._model.data,m=!1,v=null,j=0,y=0,k=!1,x=!1;if(!a)return!1;if(a.id===e.jstree.root)return this.redraw(!0);if(r=r||0===a.children.length,t=l.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(a.id[0])?"\\3"+a.id[0]+" "+a.id.substr(1).replace(e.jstree.idregex,"\\$&"):a.id.replace(e.jstree.idregex,"\\$&"))):l.getElementById(a.id))t=e(t),i||((n=t.parent().parent()[0])===this.element[0]&&(n=null),o=t.index()),r||!a.children.length||t.children(".jstree-children").length||(r=!0),r||(d=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===l.activeElement,t.remove();else if(r=!0,!i){if(!(null===(n=a.parent!==e.jstree.root?e("#"+a.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null)||n&&p[a.parent].state.opened))return!1;o=e.inArray(a.id,null===n?p[e.jstree.root].children:p[a.parent].children)}t=h.cloneNode(!0),g="jstree-node ";for(c in a.li_attr)if(a.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,a.li_attr[c]):g+=a.li_attr[c]}for(a.a_attr.id||(a.a_attr.id=a.id+"_anchor"),t.setAttribute("aria-selected",!!a.state.selected),t.setAttribute("aria-level",a.parents.length),t.setAttribute("aria-labelledby",a.a_attr.id),a.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,_=a.children.length;c<_;c++)if(!p[a.children[c]].state.hidden){k=!0;break}if(null!==a.parent&&p[a.parent]&&!a.state.hidden&&(c=e.inArray(a.id,p[a.parent].children),x=a.id,-1!==c))for(c++,_=p[a.parent].children.length;c<_&&(p[p[a.parent].children[c]].state.hidden||(x=p[a.parent].children[c]),x===a.id);c++);a.state.hidden&&(g+=" jstree-hidden"),a.state.loaded&&!k?g+=" jstree-leaf":(g+=a.state.opened&&a.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",a.state.opened&&a.state.loaded)),x===a.id&&(g+=" jstree-last"),t.id=a.id,t.className=g,g=(a.state.selected?" jstree-clicked":"")+(a.state.disabled?" jstree-disabled":"");for(_ in a.a_attr)if(a.a_attr.hasOwnProperty(_)){if("href"===_&&"#"===a.a_attr[_])continue;"class"!==_?t.childNodes[1].setAttribute(_,a.a_attr[_]):g+=" "+a.a_attr[_]}if(g.length&&(t.childNodes[1].className="jstree-anchor "+g),(a.icon&&!0!==a.icon||!1===a.icon)&&(!1===a.icon?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===a.icon.indexOf("/")&&-1===a.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+a.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+a.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(f.createTextNode(a.text)):t.childNodes[1].innerHTML+=a.text,r&&a.children.length&&(a.state.opened||s)&&a.state.loaded){for((u=f.createElement("UL")).setAttribute("role","group"),u.className="jstree-children",c=0,_=a.children.length;c<_;c++)u.appendChild(this.redraw_node(a.children[c],r,!0));t.appendChild(u)}if(d&&t.appendChild(d),!i){for(n||(n=this.element[0]),c=0,_=n.childNodes.length;c<_;c++)if(n.childNodes[c]&&n.childNodes[c].className&&-1!==n.childNodes[c].className.indexOf("jstree-children")){v=n.childNodes[c];break}v||((v=f.createElement("UL")).setAttribute("role","group"),v.className="jstree-children",n.appendChild(v)),o<(n=v).childNodes.length?n.insertBefore(t,n.childNodes[o]):n.appendChild(t),m&&(j=this.element[0].scrollTop,y=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=j,this.element[0].scrollLeft=y)}return a.state.opened&&!a.state.loaded&&(a.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(a.id,!1,0)},this),0)),t},open_node:function(r,i,s){var a,n,o,d;if(e.isArray(r)){for(a=0,n=(r=r.slice()).length;a<n;a++)this.open_node(r[a],i,s);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(s=s===t?this.settings.core.animation:s,this.is_closed(r)?this.is_loaded(r)?(o=this.get_node(r,!0),d=this,o.length&&(s&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),r.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(r),s?(this.trigger("before_open",{node:r}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(s,function(){this.style.display="",d.element&&d.trigger("after_open",{node:r})})):(this.trigger("before_open",{node:r}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),r.state.opened=!0,i&&i.call(this,r,!0),o.length||this.trigger("before_open",{node:r}),this.trigger("open_node",{node:r}),s&&o.length||this.trigger("after_open",{node:r}),!0):this.is_loading(r)?setTimeout(e.proxy(function(){this.open_node(r,i,s)},this),500):void this.load_node(r,function(e,t){return t?this.open_node(e,i,s):!!i&&i.call(this,e,!1)}):(i&&i.call(this,r,!1),!1))},_open_to:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var r,i,s=t.parents;for(r=0,i=s.length;r<i;r+=1)r!==e.jstree.root&&this.open_node(s[r],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(r,i){var s,a,n,o;if(e.isArray(r)){for(s=0,a=(r=r.slice()).length;s<a;s++)this.close_node(r[s],i);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(!this.is_closed(r)&&(i=i===t?this.settings.core.animation:i,n=this,o=this.get_node(r,!0),r.state.opened=!1,this.trigger("close_node",{node:r}),void(o.length?i?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",o.children(".jstree-children").remove(),n.element&&n.trigger("after_close",{node:r})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:r})):this.trigger("after_close",{node:r}))))},toggle_node:function(t){var r,i;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.toggle_node(t[r]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,r,i){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var s,a,n,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(s=0,a=t.children_d.length;s<a;s++)this.is_closed(this._model.data[t.children_d[s]])&&(this._model.data[t.children_d[s]].state.opened=!0);return this.trigger("open_all",{node:t})}i=i||o,n=this,(o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed")).each(function(){n.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,r,i)},r||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(t,r){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var i,s,a=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),n=this;for(a.length&&(a=this.is_open(t)?a.find(".jstree-open").addBack():a.find(".jstree-open"),e(a.get().reverse()).each(function(){n.close_node(this,r||0)})),i=0,s=t.children_d.length;i<s;i++)this._model.data[t.children_d[i]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(t){var r,i;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.enable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:t})},disable_node:function(t){var r,i;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.disable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:t})},is_hidden:function(e){return!0===(e=this.get_node(e)).state.hidden},hide_node:function(t,r){var i,s;if(e.isArray(t)){for(i=0,s=(t=t.slice()).length;i<s;i++)this.hide_node(t[i],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),r||this.redraw(),this.trigger("hide_node",{node:t}))},show_node:function(t,r){var i,s;if(e.isArray(t)){for(i=0,s=(t=t.slice()).length;i<s;i++)this.show_node(t[i],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),r||this.redraw(),this.trigger("show_node",{node:t}))},hide_all:function(t){var r,i=this._model.data,s=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&!i[r].state.hidden&&(i[r].state.hidden=!0,s.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:s}),s},show_all:function(t){var r,i=this._model.data,s=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&i[r].state.hidden&&(i[r].state.hidden=!1,s.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:s}),s},activate_node:function(e,r){if(this.is_disabled(e))return!1;if(r&&"object"==typeof r||(r={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&(!r.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(r.shiftKey){var i,s,a=this.get_node(e).id,n=this._data.core.last_clicked.id,o=this.get_node(this._data.core.last_clicked.parent).children,d=!1;for(i=0,s=o.length;i<s;i+=1)o[i]===a&&(d=!d),o[i]===n&&(d=!d),this.is_disabled(o[i])||!d&&o[i]!==a&&o[i]!==n?this.deselect_node(o[i],!0,r):this.is_hidden(o[i])||this.select_node(o[i],!0,!1,r);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:r})}else this.is_selected(e)?this.deselect_node(e,!1,r):this.select_node(e,!1,!1,r);else!this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,r):(this.deselect_all(!0),this.select_node(e,!1,!1,r),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:r})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),r=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){r.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(t,r,i,s){var a,n,o;if(e.isArray(t)){for(n=0,o=(t=t.slice()).length;n<o;n++)this.select_node(t[n],r,i,s);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),i||(a=this._open_to(t)),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:s}),r||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:s}))},deselect_node:function(t,r,i){var s,a,n;if(e.isArray(t)){for(s=0,a=(t=t.slice()).length;s<a;s++)this.deselect_node(t[s],r,i);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;n=this.get_node(t,!0),t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:i}),r||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:i}))},select_all:function(t){var r,i,s=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),r=0,i=this._data.core.selected.length;r<i;r++)this._model.data[this._data.core.selected[r]]&&(this._model.data[this._data.core.selected[r]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:s})},deselect_all:function(e){var t,r,i=this._data.core.selected.concat([]);for(t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:i}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var r,i,s,a,n=this.get_selected(!0),o={};for(r=0,i=n.length;r<i;r++)o[n[r].id]=n[r];for(r=0,i=n.length;r<i;r++)for(s=0,a=n[r].children_d.length;s<a;s++)o[n[r].children_d[s]]&&delete o[n[r].children_d[s]];n=[];for(r in o)o.hasOwnProperty(r)&&n.push(r);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},get_bottom_selected:function(t){var r,i,s=this.get_selected(!0),a=[];for(r=0,i=s.length;r<i;r++)s[r].children.length||a.push(s[r].id);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_state:function(){var t,r={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&r.core.open.push(t),this._model.data[t].state.selected&&r.core.selected.push(t));return r},set_state:function(r,i){if(r){if(r.core){var s,a;if(r.core.open)return e.isArray(r.core.open)&&r.core.open.length?this._load_nodes(r.core.open,function(e){this.open_node(e,!1,0),delete r.core.open,this.set_state(r,i)}):(delete r.core.open,this.set_state(r,i)),!1;if(r.core.scroll)return r.core.scroll&&r.core.scroll.left!==t&&this.element.scrollLeft(r.core.scroll.left),r.core.scroll&&r.core.scroll.top!==t&&this.element.scrollTop(r.core.scroll.top),delete r.core.scroll,this.set_state(r,i),!1;if(r.core.selected)return s=this,this.deselect_all(),e.each(r.core.selected,function(e,t){s.select_node(t,!1,!0)}),delete r.core.selected,this.set_state(r,i),!1;for(a in r)r.hasOwnProperty(a)&&"core"!==a&&-1===e.inArray(a,this.settings.plugins)&&delete r[a];if(e.isEmptyObject(r.core))return delete r.core,this.set_state(r,i),!1}return!e.isEmptyObject(r)||(r=null,i&&i.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,r){this._data.core.state=!0===r?{}:this.get_state(),r&&e.isFunction(r)&&(this._data.core.state=r.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,r){r&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var r=[],i=[],s=this._data.core.selected.concat([]);i.push(t.id),!0===t.state.opened&&r.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id),r.push(this.id)}),this._load_nodes(i,e.proxy(function(e){this.open_node(r,!1,0),this.select_node(s),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(t,r){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var i,s,a=this._model.data,n=t.id;for(r=r.toString(),a[t.parent].children[e.inArray(t.id,a[t.parent].children)]=r,i=0,s=t.parents.length;i<s;i++)a[t.parents[i]].children_d[e.inArray(t.id,a[t.parents[i]].children_d)]=r;for(i=0,s=t.children.length;i<s;i++)a[t.children[i]].parent=r;for(i=0,s=t.children_d.length;i<s;i++)a[t.children_d[i]].parents[e.inArray(t.id,a[t.children_d[i]].parents)]=r;return-1!==(i=e.inArray(t.id,this._data.core.selected))&&(this._data.core.selected[i]=r),(i=this.get_node(t.id,!0))&&(i.attr("id",r),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",r)),delete a[t.id],t.id=r,t.li_attr.id=r,a[r]=t,this.trigger("set_id",{node:t,new:t.id,old:n}),!0},get_text:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.text},set_text:function(t,r){var i,s;if(e.isArray(t)){for(i=0,s=(t=t.slice()).length;i<s;i++)this.set_text(t[i],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(t.text=r,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:r}),!0)},get_json:function(t,r,i){if(!(t=this.get_node(t||e.jstree.root)))return!1;r&&r.flat&&!i&&(i=[]);var s,a,n={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!r||!r.no_data)&&e.extend(!0,{},t.data)};if(r&&r.flat?n.parent=t.parent:n.children=[],r&&r.no_state)delete n.state;else for(s in t.state)t.state.hasOwnProperty(s)&&(n.state[s]=t.state[s]);if(r&&r.no_li_attr&&delete n.li_attr,r&&r.no_a_attr&&delete n.a_attr,r&&r.no_id&&(delete n.id,n.li_attr&&n.li_attr.id&&delete n.li_attr.id,n.a_attr&&n.a_attr.id&&delete n.a_attr.id),r&&r.flat&&t.id!==e.jstree.root&&i.push(n),!r||!r.no_children)for(s=0,a=t.children.length;s<a;s++)r&&r.flat?this.get_json(t.children[s],r,i):n.children.push(this.get_json(t.children[s],r));return r&&r.flat?i:t.id===e.jstree.root?n.children:n},create_node:function(r,i,s,a,n){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return!1;if(!(s=s===t?"last":s).toString().match(/^(before|after)$/)&&!n&&!this.is_loaded(r))return this.load_node(r,function(){this.create_node(r,i,s,a,!0)});i||(i={text:this.get_string("New node")}),"string"==typeof i&&(i={text:i}),i.text===t&&(i.text=this.get_string("New node"));var o,d,c,l;switch(r.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":o=this.get_node(r.parent),s=e.inArray(r.id,o.children),r=o;break;case"after":o=this.get_node(r.parent),s=e.inArray(r.id,o.children)+1,r=o;break;case"inside":case"first":s=0;break;case"last":s=r.children.length;break;default:s||(s=0)}if(s>r.children.length&&(s=r.children.length),i.id||(i.id=!0),!this.check("create_node",i,r,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===i.id&&delete i.id,!(i=this._parse_model_from_json(i,r.id,r.parents.concat())))return!1;for(o=this.get_node(i),(d=[]).push(i),d=d.concat(o.children_d),this.trigger("model",{nodes:d,parent:r.id}),r.children_d=r.children_d.concat(d),c=0,l=r.parents.length;c<l;c++)this._model.data[r.parents[c]].children_d=this._model.data[r.parents[c]].children_d.concat(d);for(i=o,o=[],c=0,l=r.children.length;c<l;c++)o[c>=s?c+1:c]=r.children[c];return o[s]=i.id,r.children=o,this.redraw_node(r,!0),a&&a.call(this,this.get_node(i)),this.trigger("create_node",{node:this.get_node(i),parent:r.id,position:s}),i.id},rename_node:function(t,r){var i,s,a;if(e.isArray(t)){for(i=0,s=(t=t.slice()).length;i<s;i++)this.rename_node(t[i],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(a=t.text,this.check("rename_node",t,this.get_parent(t),r)?(this.set_text(t,r),this.trigger("rename_node",{node:t,text:r,old:a}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var r,i,s,a,n,o,d,c,l,h,_,u;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.delete_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;if(s=this.get_node(t.parent),a=e.inArray(t.id,s.children),h=!1,!this.check("delete_node",t,s,a))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==a&&(s.children=e.vakata.array_remove(s.children,a)),(n=t.children_d.concat([])).push(t.id),o=0,d=t.parents.length;o<d;o++)this._model.data[t.parents[o]].children_d=e.vakata.array_filter(this._model.data[t.parents[o]].children_d,function(t){return-1===e.inArray(t,n)});for(c=0,l=n.length;c<l;c++)if(this._model.data[n[c]].state.selected){h=!0;break}for(h&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return-1===e.inArray(t,n)})),this.trigger("delete_node",{node:t,parent:s.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:s.id}),c=0,l=n.length;c<l;c++)delete this._model.data[n[c]];return-1!==e.inArray(this._data.core.focused,n)&&(this._data.core.focused=null,_=this.element[0].scrollTop,u=this.element[0].scrollLeft,s.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(s,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=_,this.element[0].scrollLeft=u),this.redraw_node(s,!0),!0},check:function(t,r,i,s,a){r=r&&r.id?r:this.get_node(r),i=i&&i.id?i:this.get_node(i);var n=t.match(/^move_node|copy_node|create_node$/i)?i:r,o=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||a&&a.is_multi||r.id!==i.id&&("move_node"!==t||e.inArray(r.id,i.children)!==s)&&-1===e.inArray(i.id,r.children_d)?(n&&n.data&&(n=n.data),n&&n.functions&&(!1===n.functions[t]||!0===n.functions[t])?(!1===n.functions[t]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),n.functions[t]):!(!1===o||e.isFunction(o)&&!1===o.call(this,t,r,i,s,a)||o&&!1===o[t])||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(r,i,s,a,n,o,d){var c,l,h,_,u,g,f,p,m,v,j,y,k,x;if(i=this.get_node(i),s=s===t?0:s,!i)return!1;if(!s.toString().match(/^(before|after)$/)&&!n&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(r,i,s,a,!0,!1,d)});if(e.isArray(r)){if(1!==r.length){for(c=0,l=r.length;c<l;c++)(m=this.move_node(r[c],i,s,a,n,!1,d))&&(i=m,s="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id?r:this.get_node(r))||r.id===e.jstree.root)return!1;if(h=(r.parent||e.jstree.root).toString(),u=s.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,g=d||(this._model.data[r.id]?this:e.jstree.reference(r.id)),f=!g||!g._id||this._id!==g._id,_=g&&g._id&&h&&g._model.data[h]&&g._model.data[h].children?e.inArray(r.id,g._model.data[h].children):-1,g&&g._id&&(r=g._model.data[r.id]),f)return!!(m=this.copy_node(r,i,s,a,n,!1,d))&&(g&&g.delete_node(r),m);switch(i.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":s=e.inArray(i.id,u.children);break;case"after":s=e.inArray(i.id,u.children)+1;break;case"inside":case"first":s=0;break;case"last":s=u.children.length;break;default:s||(s=0)}if(s>u.children.length&&(s=u.children.length),!this.check("move_node",r,u,s,{core:!0,origin:d,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.parent===u.id){for(p=u.children.concat(),-1!==(m=e.inArray(r.id,p))&&(p=e.vakata.array_remove(p,m),s>m&&s--),m=[],v=0,j=p.length;v<j;v++)m[v>=s?v+1:v]=p[v];m[s]=r.id,u.children=m,this._node_changed(u.id),this.redraw(u.id===e.jstree.root)}else{for((m=r.children_d.concat()).push(r.id),v=0,j=r.parents.length;v<j;v++){for(p=[],y=0,k=(x=g._model.data[r.parents[v]].children_d).length;y<k;y++)-1===e.inArray(x[y],m)&&p.push(x[y]);g._model.data[r.parents[v]].children_d=p}for(g._model.data[h].children=e.vakata.array_remove_item(g._model.data[h].children,r.id),v=0,j=u.parents.length;v<j;v++)this._model.data[u.parents[v]].children_d=this._model.data[u.parents[v]].children_d.concat(m);for(p=[],v=0,j=u.children.length;v<j;v++)p[v>=s?v+1:v]=u.children[v];for(p[s]=r.id,u.children=p,u.children_d.push(r.id),u.children_d=u.children_d.concat(r.children_d),r.parent=u.id,(m=u.parents.concat()).unshift(u.id),x=r.parents.length,r.parents=m,m=m.concat(),v=0,j=r.children_d.length;v<j;v++)this._model.data[r.children_d[v]].parents=this._model.data[r.children_d[v]].parents.slice(0,-1*x),Array.prototype.push.apply(this._model.data[r.children_d[v]].parents,m);h!==e.jstree.root&&u.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(u.id)),o||this.redraw()}return a&&a.call(this,r,u,s),this.trigger("move_node",{node:r,parent:u.id,position:s,old_parent:h,old_position:_,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id,old_instance:g,new_instance:this}),r.id},copy_node:function(r,i,s,a,n,o,d){var c,l,h,_,u,g,f,p,m,v;if(i=this.get_node(i),s=s===t?0:s,!i)return!1;if(!s.toString().match(/^(before|after)$/)&&!n&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(r,i,s,a,!0,!1,d)});if(e.isArray(r)){if(1!==r.length){for(c=0,l=r.length;c<l;c++)(_=this.copy_node(r[c],i,s,a,n,!0,d))&&(i=_,s="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id?r:this.get_node(r))||r.id===e.jstree.root)return!1;switch(p=(r.parent||e.jstree.root).toString(),m=s.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,v=d||(this._model.data[r.id]?this:e.jstree.reference(r.id)),!v||!v._id||this._id!==v._id,v&&v._id&&(r=v._model.data[r.id]),i.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":s=e.inArray(i.id,m.children);break;case"after":s=e.inArray(i.id,m.children)+1;break;case"inside":case"first":s=0;break;case"last":s=m.children.length;break;default:s||(s=0)}if(s>m.children.length&&(s=m.children.length),!this.check("copy_node",r,m,s,{core:!0,origin:d,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(f=v?v.get_json(r,{no_id:!0,no_data:!0,no_state:!0}):r))return!1;if(!0===f.id&&delete f.id,!(f=this._parse_model_from_json(f,m.id,m.parents.concat())))return!1;for(_=this.get_node(f),r&&r.state&&!1===r.state.loaded&&(_.state.loaded=!1),(h=[]).push(f),h=h.concat(_.children_d),this.trigger("model",{nodes:h,parent:m.id}),u=0,g=m.parents.length;u<g;u++)this._model.data[m.parents[u]].children_d=this._model.data[m.parents[u]].children_d.concat(h);for(h=[],u=0,g=m.children.length;u<g;u++)h[u>=s?u+1:u]=m.children[u];return h[s]=_.id,m.children=h,m.children_d.push(_.id),m.children_d=m.children_d.concat(_.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),o||this.redraw(m.id===e.jstree.root),a&&a.call(this,_,m,s),this.trigger("copy_node",{node:_,original:r,parent:m.id,position:s,old_parent:p,old_position:v&&v._id&&p&&v._model.data[p]&&v._model.data[p].children?e.inArray(r.id,v._model.data[p].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),_.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,i,s,d=[];for(i=0,s=t.length;i<s;i++)(r=this.get_node(t[i]))&&r.id&&r.id!==e.jstree.root&&d.push(r);if(!d.length)return!1;a=d,o=this,n="move_node",this.trigger("cut",{node:t})},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,i,s,d=[];for(i=0,s=t.length;i<s;i++)(r=this.get_node(t[i]))&&r.id&&r.id!==e.jstree.root&&d.push(r);if(!d.length)return!1;a=d,o=this,n="copy_node",this.trigger("copy",{node:t})},get_buffer:function(){return{mode:n,node:a,inst:o}},can_paste:function(){return!1!==n&&!1!==a},paste:function(e,t){if(!((e=this.get_node(e))&&n&&n.match(/^(copy_node|move_node)$/)&&a))return!1;this[n](a,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:a,mode:n}),a=!1,n=!1,o=!1},clear_buffer:function(){a=!1,n=!1,o=!1,this.trigger("clear_buffer")},edit:function(t,r,i){var s,a,n,o,d,c,h,_,u,g=!1;return!!(t=this.get_node(t))&&(!1===this.settings.core.check_callback?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(u=t,r="string"==typeof r?r:t.text,this.set_text(t,""),t=this._open_to(t),u.text=r,s=this._data.core.rtl,a=this.element.width(),this._data.core.focused=u.id,n=t.children(".jstree-anchor").focus(),o=e("<span>"),d=r,c=e("<div />",{css:{position:"absolute",top:"-200px",left:s?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),h=e("<input />",{value:d,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(r){r.stopImmediatePropagation(),r.preventDefault();var s,a=o.children(".jstree-rename-input").val(),l=this.settings.core.force_text;""===a&&(a=d),c.remove(),o.replaceWith(n),o.remove(),d=l?d:e("<div></div>").append(e.parseHTML(d)).html(),this.set_text(t,d),(s=!!this.rename_node(t,l?e("<div></div>").text(a).text():e("<div></div>").append(e.parseHTML(a)).html()))||this.set_text(t,d),this._data.core.focused=u.id,setTimeout(e.proxy(function(){var e=this.get_node(u.id,!0);e.length&&(this._data.core.focused=u.id,e.children(".jstree-anchor").focus())},this),0),i&&i.call(this,u,s,g),h=null},this),keydown:function(e){var t=e.which;27===t&&(g=!0,this.value=d),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){h.width(Math.min(c.text("pW"+this.value).width(),a))},keypress:function(e){if(13===e.which)return!1}}),_={fontFamily:n.css("fontFamily")||"",fontSize:n.css("fontSize")||"",fontWeight:n.css("fontWeight")||"",fontStyle:n.css("fontStyle")||"",fontStretch:n.css("fontStretch")||"",fontVariant:n.css("fontVariant")||"",letterSpacing:n.css("letterSpacing")||"",wordSpacing:n.css("wordSpacing")||""},o.attr("class",n.attr("class")).append(n.contents().clone()).append(h),n.replaceWith(o),c.css(_),h.css(_).width(Math.min(c.text("pW"+h[0].value).width(),a))[0].select(),void e(l).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){h&&t.target!==h&&e(h).blur()})))},set_theme:function(t,r){if(!t)return!1;if(!0===r){var i=this.settings.core.themes.dir;i||(i=e.jstree.path+"/themes"),r=i+"/"+t+"/style.css"}r&&-1===e.inArray(r,d)&&(e("head").append('<link rel="stylesheet" href="'+r+'" type="text/css" />'),d.push(r)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(r,i){var s,a,n,o;if(e.isArray(r)){for(s=0,a=(r=r.slice()).length;s<a;s++)this.set_icon(r[s],i);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(o=r.icon,r.icon=!0===i||null===i||i===t||""===i||i,n=this.get_node(r,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===i?this.hide_icon(r):!0===i||null===i||i===t||""===i?(n.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),!1===o&&this.show_icon(r)):-1===i.indexOf("/")&&-1===i.indexOf(".")?(n.removeClass(o).css("background",""),n.addClass(i+" jstree-themeicon-custom").attr("rel",i),!1===o&&this.show_icon(r)):(n.removeClass(o).css("background",""),n.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i),!1===o&&this.show_icon(r)),!0)},get_icon:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var r,i;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.hide_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var r,i,s;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.show_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(s=this.get_node(t,!0),t.icon=!s.length||s.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),s.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,r){t=e(t)[0];var i=r?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,s){-1===e.inArray(s.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==s.value&&""!==e.trim(s.value)&&(r?i[s.name]=s.value:i.push(s.name))}),i},e.vakata.array_unique=function(e){var r,i,s=[],a={};for(r=0,i=e.length;r<i;r++)a[e[r]]===t&&(s.push(e[r]),a[e[r]]=!0);return s},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},e.vakata.array_remove_item=function(t,r){var i=e.inArray(r,t);return-1!==i?e.vakata.array_remove(t,i):t},e.vakata.array_filter=function(e,t,r,i,s){if(e.filter)return e.filter(t,r);i=[];for(s in e)~~s+""==s+""&&s>=0&&t.call(r,e[s],+s,e)&&i.push(e[s]);return i},e.jstree.plugins.changed=function(e,t){var r=[];this.trigger=function(e,i){var s,a;if(i||(i={}),"changed"===e.replace(".jstree","")){i.changed={selected:[],deselected:[]};var n={};for(s=0,a=r.length;s<a;s++)n[r[s]]=1;for(s=0,a=i.selected.length;s<a;s++)n[i.selected[s]]?n[i.selected[s]]=2:i.changed.selected.push(i.selected[s]);for(s=0,a=r.length;s<a;s++)1===n[r[s]]&&i.changed.deselected.push(r[s]);r=i.selected.slice()}t.trigger.call(this,e,i)},this.refresh=function(e,i){return r=[],t.refresh.apply(this,arguments)}};var _=l.createElement("I");_.className="jstree-icon jstree-checkbox",_.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(r,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var r,i,s=this._model.data,a=(s[t.parent],t.nodes);for(r=0,i=a.length;r<i;r++)s[a[r]].state.checked=s[a[r]].state.checked||s[a[r]].original&&s[a[r]].original.state&&s[a[r]].original.state.checked,s[a[r]].state.checked&&this._data.checkbox.selected.push(a[r])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",e.proxy(function(t,r){var i,s,a,n,o,d,c=this._model.data,l=c[r.parent],h=r.nodes,_=[],u=this.settings.checkbox.cascade,g=this.settings.checkbox.tie_selection;if(-1!==u.indexOf("down"))if(l.state[g?"selected":"checked"]){for(s=0,a=h.length;s<a;s++)c[h[s]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(h)}else for(s=0,a=h.length;s<a;s++)if(c[h[s]].state[g?"selected":"checked"]){for(n=0,o=c[h[s]].children_d.length;n<o;n++)c[c[h[s]].children_d[n]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(c[h[s]].children_d)}if(-1!==u.indexOf("up")){for(s=0,a=l.children_d.length;s<a;s++)c[l.children_d[s]].children.length||_.push(c[l.children_d[s]].parent);for(n=0,o=(_=e.vakata.array_unique(_)).length;n<o;n++)for(l=c[_[n]];l&&l.id!==e.jstree.root;){for(i=0,s=0,a=l.children.length;s<a;s++)i+=c[l.children[s]].state[g?"selected":"checked"];if(i!==a)break;l.state[g?"selected":"checked"]=!0,this._data[g?"core":"checkbox"].selected.push(l.id),(d=this.get_node(l,!0))&&d.length&&d.attr("aria-selected",!0).children(".jstree-anchor").addClass(g?"jstree-clicked":"jstree-checked"),l=this.get_node(l.parent)}}this._data[g?"core":"checkbox"].selected=e.vakata.array_unique(this._data[g?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,r){var i,s,a,n,o=r.node,d=this._model.data,c=this.get_node(o.parent),l=this.get_node(o,!0),h=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection,u={},g=this._data[_?"core":"checkbox"].selected;for(i=0,s=g.length;i<s;i++)u[g[i]]=!0;if(-1!==h.indexOf("down"))for(i=0,s=o.children_d.length;i<s;i++)u[o.children_d[i]]=!0,(n=d[o.children_d[i]]).state[_?"selected":"checked"]=!0,n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1);if(-1!==h.indexOf("up"))for(;c&&c.id!==e.jstree.root;){for(a=0,i=0,s=c.children.length;i<s;i++)a+=d[c.children[i]].state[_?"selected":"checked"];if(a!==s)break;c.state[_?"selected":"checked"]=!0,u[c.id]=!0,(n=this.get_node(c,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}g=[];for(i in u)u.hasOwnProperty(i)&&g.push(i);this._data[_?"core":"checkbox"].selected=g,-1!==h.indexOf("down")&&l.length&&l.find(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,r){var i,s,a,n=this.get_node(e.jstree.root),o=this._model.data;for(i=0,s=n.children_d.length;i<s;i++)(a=o[n.children_d[i]])&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,r){var i,s,a,n=r.node,o=this.get_node(n,!0),d=this.settings.checkbox.cascade,c=this.settings.checkbox.tie_selection,l=this._data[c?"core":"checkbox"].selected,h={};if(n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1),-1!==d.indexOf("down"))for(i=0,s=n.children_d.length;i<s;i++)(a=this._model.data[n.children_d[i]]).state[c?"selected":"checked"]=!1,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1);if(-1!==d.indexOf("up"))for(i=0,s=n.parents.length;i<s;i++)(a=this._model.data[n.parents[i]]).state[c?"selected":"checked"]=!1,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),(a=this.get_node(n.parents[i],!0))&&a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked");for(h={},i=0,s=l.length;i<s;i++)-1!==d.indexOf("down")&&-1!==e.inArray(l[i],n.children_d)||-1!==d.indexOf("up")&&-1!==e.inArray(l[i],n.parents)||(h[l[i]]=!0);l=[];for(i in h)h.hasOwnProperty(i)&&l.push(i);this._data[c?"core":"checkbox"].selected=l,-1!==d.indexOf("down")&&o.length&&o.find(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,r){for(var i,s,a,n,o=this.get_node(r.parent),d=this._model.data,c=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[c?"selected":"checked"];){for(a=0,i=0,s=o.children.length;i<s;i++)a+=d[o.children[i]].state[c?"selected":"checked"];if(!(s>0&&a===s))break;o.state[c?"selected":"checked"]=!0,this._data[c?"core":"checkbox"].selected.push(o.id),(n=this.get_node(o,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(c?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,r){var i,s,a,n,o,d=r.is_multi,c=r.old_parent,l=this.get_node(r.parent),h=this._model.data,_=this.settings.checkbox.tie_selection;if(!d)for(i=this.get_node(c);i&&i.id!==e.jstree.root&&!i.state[_?"selected":"checked"];){for(s=0,a=0,n=i.children.length;a<n;a++)s+=h[i.children[a]].state[_?"selected":"checked"];if(!(n>0&&s===n))break;i.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(i.id),(o=this.get_node(i,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=l;i&&i.id!==e.jstree.root;){for(s=0,a=0,n=i.children.length;a<n;a++)s+=h[i.children[a]].state[_?"selected":"checked"];if(s===n)i.state[_?"selected":"checked"]||(i.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(i.id),(o=this.get_node(i,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"));else{if(!i.state[_?"selected":"checked"])break;i.state[_?"selected":"checked"]=!1,this._data[_?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[_?"core":"checkbox"].selected,i.id),(o=this.get_node(i,!0))&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(_?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}},this))},this._undetermined=function(){if(null!==this.element){var r,i,s,a,n={},o=this._model.data,d=this.settings.checkbox.tie_selection,c=this._data[d?"core":"checkbox"].selected,l=[],h=this;for(r=0,i=c.length;r<i;r++)if(o[c[r]]&&o[c[r]].parents)for(s=0,a=o[c[r]].parents.length;s<a&&n[o[c[r]].parents[s]]===t;s++)o[c[r]].parents[s]!==e.jstree.root&&(n[o[c[r]].parents[s]]=!0,l.push(o[c[r]].parents[s]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var d,c=h.get_node(this);if(c.state.loaded){for(r=0,i=c.children_d.length;r<i;r++)if(!(d=o[c.children_d[r]]).state.loaded&&d.original&&d.original.state&&d.original.state.undetermined&&!0===d.original.state.undetermined)for(n[d.id]===t&&d.id!==e.jstree.root&&(n[d.id]=!0,l.push(d.id)),s=0,a=d.parents.length;s<a;s++)n[d.parents[s]]===t&&d.parents[s]!==e.jstree.root&&(n[d.parents[s]]=!0,l.push(d.parents[s]))}else if(c.original&&c.original.state&&c.original.state.undetermined&&!0===c.original.state.undetermined)for(n[c.id]===t&&c.id!==e.jstree.root&&(n[c.id]=!0,l.push(c.id)),s=0,a=c.parents.length;s<a;s++)n[c.parents[s]]===t&&c.parents[s]!==e.jstree.root&&(n[c.parents[s]]=!0,l.push(c.parents[s]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),r=0,i=l.length;r<i;r++)o[l[r]].state[d?"selected":"checked"]||(c=this.get_node(l[r],!0))&&c.length&&c.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(t,r,s,a){if(t=i.redraw_node.apply(this,arguments)){var n,o,d=null,c=null;for(n=0,o=t.childNodes.length;n<o;n++)if(t.childNodes[n]&&t.childNodes[n].className&&-1!==t.childNodes[n].className.indexOf("jstree-anchor")){d=t.childNodes[n];break}d&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(d.className+=" jstree-checked"),c=_.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(c.className+=" jstree-checkbox-disabled"),d.insertBefore(c,d.childNodes[0]))}return s||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var r,i,s=this.settings.checkbox.cascade,a=this.settings.checkbox.tie_selection,n=this._data[a?"core":"checkbox"].selected,o=this._model.data;if(!t||!0===t.state[a?"selected":"checked"]||-1===s.indexOf("undetermined")||-1===s.indexOf("down")&&-1===s.indexOf("up"))return!1;if(!t.state.loaded&&!0===t.original.state.undetermined)return!0;for(r=0,i=t.children_d.length;r<i;r++)if(-1!==e.inArray(t.children_d[r],n)||!o[t.children_d[r]].state.loaded&&o[t.children_d[r]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var r,i,s;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.disable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;s=this.get_node(t,!0),t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,s&&s.length&&s.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))},this.enable_checkbox=function(t){var r,i,s;if(e.isArray(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.enable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;s=this.get_node(t,!0),t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,s&&s.length&&s.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))},this.activate_node=function(t,r){return!e(r.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(r.target).hasClass("jstree-checkbox"))&&(r.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(r.target).hasClass("jstree-checkbox")?i.activate_node.call(this,t,r):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,r):this.check_node(t,r),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,r);var i,s,a;if(e.isArray(t)){for(s=0,a=(t=t.slice()).length;s<a;s++)this.check_node(t[s],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;i=this.get_node(t,!0),t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.uncheck_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,r);var i,s,a;if(e.isArray(t)){for(i=0,s=(t=t.slice()).length;i<s;i++)this.uncheck_node(t[i],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,r;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,r=this._data.checkbox.selected.length;t<r;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,r=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:r})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.checked},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var r,i,s,a,n=this.get_checked(!0),o={};for(r=0,i=n.length;r<i;r++)o[n[r].id]=n[r];for(r=0,i=n.length;r<i;r++)for(s=0,a=n[r].children_d.length;s<a;s++)o[n[r].children_d[s]]&&delete o[n[r].children_d[s]];n=[];for(r in o)o.hasOwnProperty(r)&&n.push(r);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var r,i,s=this.get_checked(!0),a=[];for(r=0,i=s.length;r<i;r++)s[r].children.length||a.push(s[r].id);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.load_node=function(t,r){var s,a,n;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(n=this.get_node(t))&&n.state.loaded)for(s=0,a=n.children_d.length;s<a;s++)this._model.data[n.children_d[s]].state.checked&&(!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,n.children_d[s]));return i.load_node.apply(this,arguments)},this.get_state=function(){var e=i.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,r){var s=i.set_state.apply(this,arguments);if(s&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var a=this;e.each(t.checkbox,function(e,t){a.check_node(t)})}return delete t.checkbox,this.set_state(t,r),!1}return s},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),i.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,r){this.settings.conditionalselect.call(this,this.get_node(e),r)&&t.activate_node.call(this,e,r)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,r){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.create_node(i,{},"last",function(e){setTimeout(function(){r.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.edit(i)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.delete_node(r.get_selected()):r.delete_node(i)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.cut(r.get_top_selected()):r.cut(i)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.copy(r.get_top_selected()):r.copy(i)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.paste(i)}}}}}}},e.jstree.plugins.contextmenu=function(r,i){this.bind=function(){i.bind.call(this);var t,r,s=0,a=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),s=e.ctrlKey?+new Date:0,(t||a)&&(s=+new Date+1e4),a&&clearTimeout(a),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!s||+new Date-s>250)&&e.vakata.context.hide(),s=0},this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(t=i.originalEvent.changedTouches[0].clientX,r=i.originalEvent.changedTouches[0].clientY,a=setTimeout(function(){e(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){a&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.originalEvent.changedTouches[0].clientX)>50||Math.abs(r-e.originalEvent.changedTouches[0].clientY)>50)&&clearTimeout(a)}).on("touchend.vakata.jstree",function(e){a&&clearTimeout(a)}),e(l).on("context_hide.vakata.jstree",e.proxy(function(t,r){this._data.contextmenu.visible=!1,e(r.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),i.teardown.call(this)},this.show_contextmenu=function(r,i,s,a){if(!(r=this.get_node(r))||r.id===e.jstree.root)return!1;var n=this.settings.contextmenu,o=this.get_node(r,!0).children(".jstree-anchor"),d=!1,c=!1;(n.show_at_node||i===t||s===t)&&(d=o.offset(),i=d.left,s=d.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(r)&&this.activate_node(r,a),c=n.items,e.isFunction(c)&&(c=c.call(this,r,e.proxy(function(e){this._show_contextmenu(r,i,s,e)},this))),e.isPlainObject(c)&&this._show_contextmenu(r,i,s,c)},this._show_contextmenu=function(t,r,i,s){var a=this.get_node(t,!0).children(".jstree-anchor");e(l).one("context_show.vakata.jstree",e.proxy(function(t,r){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(r.element).addClass(i),a.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:r,y:i},s),this.trigger("show_contextmenu",{node:t,x:r,y:i})}},function(e){var t=!1,r={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(l).triggerHandler("context_"+t+".vakata",{reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_execute:function(t){return!(!(t=r.items[t])||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:r.reference,element:r.element}))||!t.action)&&t.action.call(null,{item:t,reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_parse:function(t,i){if(!t)return!1;i||(r.html="",r.items=[]);var s,a="",n=!1;return i&&(a+="<ul>"),e.each(t,function(t,i){if(!i)return!0;r.items.push(i),!n&&i.separator_before&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),n=!1,a+="<li class='"+(i._class||"")+(!0===i._disabled||e.isFunction(i._disabled)&&i._disabled({item:i,reference:r.reference,element:r.element})?" vakata-contextmenu-disabled ":"")+"' "+(i.shortcut?" data-shortcut='"+i.shortcut+"' ":"")+">",a+="<a href='#' rel='"+(r.items.length-1)+"' "+(i.title?"title='"+i.title+"'":"")+">",e.vakata.context.settings.icons&&(a+="<i ",i.icon&&(-1!==i.icon.indexOf("/")||-1!==i.icon.indexOf(".")?a+=" style='background:url(\""+i.icon+"\") center center no-repeat' ":a+=" class='"+i.icon+"' "),a+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),a+=(e.isFunction(i.label)?i.label({item:t,reference:r.reference,element:r.element}):i.label)+(i.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+i.shortcut+'">'+(i.shortcut_label||"")+"</span>":"")+"</a>",i.submenu&&(s=e.vakata.context._parse(i.submenu,!0))&&(a+=s),a+="</li>",i.separator_after&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",n=!0)}),a=a.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),i&&(a+="</ul>"),i||(r.html=a,e.vakata.context._trigger("parse")),a.length>10&&a},_show_submenu:function(r){if((r=e(r)).length&&r.children("ul").length){var i=r.children("ul"),s=r.offset().left,a=s+r.outerWidth(),n=r.offset().top,o=i.width(),d=i.height(),c=e(window).width()+e(window).scrollLeft(),l=e(window).height()+e(window).scrollTop();t?r[a-(o+10+r.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):r[a+o>c&&s>c-a?"addClass":"removeClass"]("vakata-context-right"),n+d+10>l&&i.css("bottom","-1px"),r.hasClass("vakata-context-right")?s<o&&i.css("margin-right",s-o):c-a<o&&i.css("margin-left",c-a-o),i.show()}},show:function(i,s,a){var n,o,d,c,l,h,_,u;switch(r.element&&r.element.length&&r.element.width(""),!0){case!s&&!i:return!1;case!!s&&!!i:r.reference=i,r.position_x=s.x,r.position_y=s.y;break;case!s&&!!i:r.reference=i,n=i.offset(),r.position_x=n.left+i.outerHeight(),r.position_y=n.top;break;case!!s&&!i:r.position_x=s.x,r.position_y=s.y}i&&!a&&e(i).data("vakata_contextmenu")&&(a=e(i).data("vakata_contextmenu")),e.vakata.context._parse(a)&&r.element.html(r.html),r.items.length&&(r.element.appendTo("body"),o=r.element,d=r.position_x,c=r.position_y,l=o.width(),h=o.height(),_=e(window).width()+e(window).scrollLeft(),u=e(window).height()+e(window).scrollTop(),t&&(d-=o.outerWidth()-e(i).outerWidth())<e(window).scrollLeft()+20&&(d=e(window).scrollLeft()+20),d+l+20>_&&(d=_-(l+20)),c+h+20>u&&(c=u-(h+20)),r.element.css({left:d,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),r.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){r.is_visible&&(r.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),r.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var i=!1;r.element=e("<ul class='vakata-context'></ul>"),r.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(i&&clearTimeout(i),r.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(i=setTimeout(function(){e.vakata.context.hide()},e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||!1===e.vakata.context._execute(e(this).attr("rel"))||e.vakata.context.hide()}).on("keydown","a",function(t){var i=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:r.is_visible&&(r.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:r.is_visible&&((i=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length||(i=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:r.is_visible&&(r.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:r.is_visible&&((i=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length||(i=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=r.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(l).on("mousedown.vakata.jstree",function(t){r.is_visible&&!e.contains(r.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,i){r.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&r.element.addClass("vakata-context-rtl").css("direction","rtl"),r.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var u,g;e.jstree.plugins.dnd=function(t,r){this.init=function(e,t){r.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in l.createElement("span")},this.bind=function(){r.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var r=this.get_node(t.target),i=this.is_selected(r)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,s=i>1?i+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(s=e.vakata.html.escape(s)),r&&r.id&&r.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_top_selected(!0):[r],t))){if(u={jstree:!0,origin:this,obj:this.get_node(r,!0),nodes:i>1?this.get_top_selected():[r.id]},g=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,u,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+s+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:g,data:u})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:g,data:u}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:g,data:u}),!1},this))},this.redraw_node=function(e,t,i,s){if((e=r.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var a,n,o=null;for(a=0,n=e.childNodes.length;a<n;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){o=e.childNodes[a];break}o&&o.setAttribute("draggable",!0)}return e}},e(function(){var r=!1,i=!1,s=!1,a=!1,n=e('<div id="jstree-marker">&#160;</div>').hide();e(l).on("dnd_start.vakata.jstree",function(e,t){r=!1,s=!1,t&&t.data&&t.data.jstree&&n.appendTo("body")}).on("dnd_move.vakata.jstree",function(o,d){if(a&&(d.event&&"dragover"===d.event.type&&d.event.target===s.target||clearTimeout(a)),d&&d.data&&d.data.jstree&&(!d.event.target.id||"jstree-marker"!==d.event.target.id)){s=d.event;var c,l,h,_,u,g,f,p,m,v,j,y,k,x,b,w,C=e.jstree.reference(d.event.target),T=!1,O=!1,A=!1;if(C&&C._data&&C._data.dnd)if(n.attr("class","jstree-"+C.get_theme()+(C.settings.core.themes.responsive?" jstree-dnd-responsive":"")),b=d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey)),d.helper.children().attr("class","jstree-"+C.get_theme()+" jstree-"+C.get_theme()+"-"+C.get_theme_variant()+" "+(C.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[b?"show":"hide"](),d.event.target!==C.element[0]&&d.event.target!==C.get_container_ul()[0]||0!==C.get_container_ul().children().length){if((T=C.settings.dnd.large_drop_target?e(d.event.target).closest(".jstree-node").children(".jstree-anchor"):e(d.event.target).closest(".jstree-anchor"))&&T.length&&T.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(O=T.offset(),A=(d.event.pageY!==t?d.event.pageY:d.event.originalEvent.pageY)-O.top,h=T.outerHeight(),g=A<h/3?["b","i","a"]:A>h-h/3?["a","i","b"]:A>h/2?["i","a","b"]:["i","b","a"],e.each(g,function(t,s){switch(s){case"b":c=O.left-6,l=O.top,_=C.get_parent(T),u=T.parent().index();break;case"i":k=C.settings.dnd.inside_pos,x=C.get_node(T.parent()),c=O.left-2,l=O.top+h/2+1,_=x.id,u="first"===k?0:"last"===k?x.children.length:Math.min(k,x.children.length);break;case"a":c=O.left-6,l=O.top+h,_=C.get_parent(T),u=T.parent().index()+1}for(f=!0,p=0,m=d.data.nodes.length;p<m;p++)if(v=d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey))?"copy_node":"move_node",j=u,"move_node"===v&&"a"===s&&d.data.origin&&d.data.origin===C&&_===C.get_parent(d.data.nodes[p])&&(y=C.get_node(_),j>e.inArray(d.data.nodes[p],y.children)&&(j-=1)),!(f=f&&(C&&C.settings&&C.settings.dnd&&!1===C.settings.dnd.check_while_dragging||C.check(v,d.data.origin&&d.data.origin!==C?d.data.origin.get_node(d.data.nodes[p]):d.data.nodes[p],_,j,{dnd:!0,ref:C.get_node(T.parent()),pos:s,origin:d.data.origin,is_multi:d.data.origin&&d.data.origin!==C,is_foreign:!d.data.origin})))){C&&C.last_error&&(i=C.last_error());break}if("i"===s&&T.parent().is(".jstree-closed")&&C.settings.dnd.open_timeout&&(a=setTimeout(function(e,t){return function(){e.open_node(t)}}(C,T),C.settings.dnd.open_timeout)),f)return(w=C.get_node(_,!0)).hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),w.addClass("jstree-dnd-parent")),r={ins:C,par:_,pos:"i"!==s||"last"!==k||0!==u||C.is_loaded(x)?u:"last"},n.css({left:c+"px",top:l+"px"}).show(),d.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),d.event.originalEvent&&d.event.originalEvent.dataTransfer&&(d.event.originalEvent.dataTransfer.dropEffect=b?"copy":"move"),i={},g=!0,!1}),!0===g))return}else{for(f=!0,p=0,m=d.data.nodes.length;p<m&&(f=f&&C.check(d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey))?"copy_node":"move_node",d.data.origin&&d.data.origin!==C?d.data.origin.get_node(d.data.nodes[p]):d.data.nodes[p],e.jstree.root,"last",{dnd:!0,ref:C.get_node(e.jstree.root),pos:"i",origin:d.data.origin,is_multi:d.data.origin&&d.data.origin!==C,is_foreign:!d.data.origin}));p++);if(f)return r={ins:C,par:e.jstree.root,pos:"last"},n.hide(),d.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(d.event.originalEvent&&d.event.originalEvent.dataTransfer&&(d.event.originalEvent.dataTransfer.dropEffect=b?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),r=!1,d.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),d.event.originalEvent&&d.event.originalEvent.dataTransfer&&(d.event.originalEvent.dataTransfer.dropEffect="none"),n.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(n.hide(),r=!1,s=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,o){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),a&&clearTimeout(a),o&&o.data&&o.data.jstree){n.hide().detach();var d,c,l=[];if(r){for(d=0,c=o.data.nodes.length;d<c;d++)l[d]=o.data.origin?o.data.origin.get_node(o.data.nodes[d]):o.data.nodes[d];r.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](l,r.par,r.pos,!1,!1,!1,o.data.origin)}else(d=e(o.event.target).closest(".jstree")).length&&i&&i.error&&"check"===i.error&&(d=d.jstree(!0))&&d.settings.core.error.call(this,i);s=!1,r=!1}}).on("keyup.jstree keydown.jstree",function(t,o){(o=e.vakata.dnd._get())&&o.data&&o.data.jstree&&("keyup"===t.type&&27===t.which?(a&&clearTimeout(a),r=!1,i=!1,s=!1,a=!1,n.hide().detach(),e.vakata.dnd._clean()):(o.helper.find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),s&&(s.metaKey=t.metaKey,s.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",s))))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(r,i,s){s===t&&(s=e.vakata.dnd._get()),s.event=i,e(l).triggerHandler("dnd_"+r+".vakata",s)},_get:function(){return{data:r.data,element:r.element,helper:r.helper}},_clean:function(){r.helper&&r.helper.remove(),r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(l).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!r.scroll_e||!r.scroll_l&&!r.scroll_t)return r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),!1;if(!r.scroll_i)return r.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(!0===t)return!1;var i=r.scroll_e.scrollTop(),s=r.scroll_e.scrollLeft();r.scroll_e.scrollTop(i+r.scroll_t*e.vakata.dnd.settings.scroll_speed),r.scroll_e.scrollLeft(s+r.scroll_l*e.vakata.dnd.settings.scroll_speed),i===r.scroll_e.scrollTop()&&s===r.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",r.scroll_e)},start:function(t,i,s){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(e){}return r.init_x=t.pageX,r.init_y=t.pageY,r.data=i,r.is_down=!0,r.element=t.currentTarget,r.target=t.target,r.is_touch="touchstart"===t.type,!1!==s&&(r.helper=e("<div id='vakata-dnd'></div>").html(s).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(l).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_down){if(!r.is_drag){if(!(Math.abs(t.pageX-r.init_x)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-r.init_y)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;r.helper&&(r.helper.appendTo("body"),r.helper_w=r.helper.outerWidth()),r.is_drag=!0,e(r.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",t)}var i=!1,s=!1,a=!1,n=!1,o=!1,d=!1,c=!1,h=!1,_=!1,u=!1;return r.scroll_t=0,r.scroll_l=0,r.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var i=e(this),s=i.offset();if(this.scrollHeight>this.offsetHeight&&(s.top+i.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),t.pageY-s.top<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(s.left+i.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),t.pageX-s.left<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1)),r.scroll_t||r.scroll_l)return r.scroll_e=e(this),!1}),r.scroll_e||(i=e(l),s=e(window),a=i.height(),n=s.height(),o=i.width(),d=s.width(),c=i.scrollTop(),h=i.scrollLeft(),a>n&&t.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1),a>n&&n-(t.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),o>d&&t.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1),o>d&&d-(t.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),(r.scroll_t||r.scroll_l)&&(r.scroll_e=i)),r.scroll_e&&e.vakata.dnd._scroll(!0),r.helper&&(_=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),u=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),a&&_+25>a&&(_=a-50),o&&u+r.helper_w>o&&(u=o-(r.helper_w+2)),r.helper.css({left:u+"px",top:_+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag)t.target!==r.target&&e(r.target).off("click.vakata"),e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===r.target){var i=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){i&&clearTimeout(i)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,r){this.init=function(e,t){this._data.massload={},r.init.call(this,e,t)},this._load_nodes=function(t,i,s,a){var n,o,d,c=this.settings.massload,l=(JSON.stringify(t),[]),h=this._model.data;if(!s){for(n=0,o=t.length;n<o;n++)h[t[n]]&&(h[t[n]].state.loaded||h[t[n]].state.failed)&&!a||(l.push(t[n]),(d=this.get_node(t[n],!0))&&d.length&&d.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},l.length){if(e.isFunction(c))return c.call(this,l,e.proxy(function(e){var n,o;if(e)for(n in e)e.hasOwnProperty(n)&&(this._data.massload[n]=e[n]);for(n=0,o=t.length;n<o;n++)(d=this.get_node(t[n],!0))&&d.length&&d.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,s,a)},this));if("object"==typeof c&&c&&c.url)return c=e.extend(!0,{},c),e.isFunction(c.url)&&(c.url=c.url.call(this,l)),e.isFunction(c.data)&&(c.data=c.data.call(this,l)),e.ajax(c).done(e.proxy(function(e,n,o){var c,l;if(e)for(c in e)e.hasOwnProperty(c)&&(this._data.massload[c]=e[c]);for(c=0,l=t.length;c<l;c++)(d=this.get_node(t[c],!0))&&d.length&&d.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,s,a)},this)).fail(e.proxy(function(e){r._load_nodes.call(this,t,i,s,a)},this))}}return r._load_nodes.call(this,t,i,s,a)},this._load_node=function(t,i){var s,a=this._data.massload[t.id],n=null;return a?(n=this["string"==typeof a?"_append_html_data":"_append_json_data"](t,"string"==typeof a?e(e.parseHTML(a)).filter(function(){return 3!==this.nodeType}):a,function(e){i.call(this,e)}),(s=this.get_node(t.id,!0))&&s.length&&s.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],n):r._load_node.call(this,t,i)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(r,i){this.bind=function(){i.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,r){if(this._data.search.som&&r.res.length){var i,s,a,n,o=this._model.data,d=[];for(i=0,s=r.res.length;i<s;i++)if(o[r.res[i]]&&!o[r.res[i]].state.hidden&&(d.push(r.res[i]),d=d.concat(o[r.res[i]].parents),this._data.search.smc))for(a=0,n=o[r.res[i]].children_d.length;a<n;a++)o[o[r.res[i]].children_d[a]]&&!o[o[r.res[i]].children_d[a]].state.hidden&&d.push(o[r.res[i]].children_d[a]);d=e.vakata.array_remove_item(e.vakata.array_unique(d),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(d,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(r,i,s,a,n,o){if(!1===r||""===e.trim(r.toString()))return this.clear_search();a=(a=this.get_node(a))&&a.id?a.id:null,r=r.toString();var d,c,l=this.settings.search,h=!!l.ajax&&l.ajax,_=this._model.data,u=null,g=[],f=[];if(this._data.search.res.length&&!n&&this.clear_search(),s===t&&(s=l.show_only_matches),o===t&&(o=l.show_only_matches_children),!i&&!1!==h)return e.isFunction(h)?h.call(this,r,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,s,a,n)})},this),a):((h=e.extend({},h)).data||(h.data={}),h.data.str=r,a&&(h.data.inside=a),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,s,a,n)})},this)));if(n||(this._data.search.str=r,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=s,this._data.search.smc=o),u=new e.vakata.search(r,!0,{caseSensitive:l.case_sensitive,fuzzy:l.fuzzy}),e.each(_[a||e.jstree.root].children_d,function(e,t){var i=_[t];i.text&&!i.state.hidden&&(!l.search_leaves_only||i.state.loaded&&0===i.children.length)&&(l.search_callback&&l.search_callback.call(this,r,i)||!l.search_callback&&u.search(i.text).isMatch)&&(g.push(t),f=f.concat(i.parents))}),g.length){for(d=0,c=(f=e.vakata.array_unique(f)).length;d<c;d++)f[d]!==e.jstree.root&&_[f[d]]&&!0===this.open_node(f[d],null,0)&&this._data.search.opn.push(f[d]);n?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(g))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=g),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:r,res:this._data.search.res,show_only_matches:s})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,r,s,a){if((t=i.redraw_node.apply(this,arguments))&&-1!==e.inArray(t.id,this._data.search.res)){var n,o,d=null;for(n=0,o=t.childNodes.length;n<o;n++)if(t.childNodes[n]&&t.childNodes[n].className&&-1!==t.childNodes[n].className.indexOf("jstree-anchor")){d=t.childNodes[n];break}d&&(d.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,r,i){i=i||{},!1!==(i=e.extend({},e.vakata.search.defaults,i)).fuzzy&&(i.fuzzy=!0),t=i.caseSensitive?t:t.toLowerCase();var s,a,n,o,d=i.location,c=i.distance,l=i.threshold,h=t.length;return h>32&&(i.fuzzy=!1),i.fuzzy&&(s=1<<h-1,a=function(){var e={},r=0;for(r=0;r<h;r++)e[t.charAt(r)]=0;for(r=0;r<h;r++)e[t.charAt(r)]|=1<<h-r-1;return e}(),n=function(e,t){var r=e/h,i=Math.abs(d-t);return c?r+i/c:i?1:r}),o=function(e){if(e=i.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!i.fuzzy)return{isMatch:!1,score:1};var r,o,c,_,u,g,f,p,m,v=e.length,j=l,y=e.indexOf(t,d),k=h+v,x=1,b=[];for(-1!==y&&(j=Math.min(n(0,y),j),-1!==(y=e.lastIndexOf(t,d+h))&&(j=Math.min(n(0,y),j))),y=-1,r=0;r<h;r++){for(c=0,_=k;c<_;)n(r,d+_)<=j?c=_:k=_,_=Math.floor((k-c)/2+c);for(k=_,g=Math.max(1,d-_+1),f=Math.min(d+_,v)+h,(p=new Array(f+2))[f+1]=(1<<r)-1,o=f;o>=g;o--)if(m=a[e.charAt(o-1)],p[o]=0===r?(p[o+1]<<1|1)&m:(p[o+1]<<1|1)&m|(u[o+1]|u[o])<<1|1|u[o+1],p[o]&s&&(x=n(r,o-1))<=j){if(j=x,y=o-1,b.push(y),!(y>d))break;g=Math.max(1,2*d-y)}if(n(r+1,d)>j)break;u=p}return{isMatch:y>=0,score:x}},!0===r?{search:o}:o(r)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,r){var i,s;if((t=this.get_node(t))&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),r))for(i=0,s=t.children_d.length;i<s;i++)this.sort(t.children_d[i],!1)}};var f=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,r){this.bind=function(){r.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){f&&clearTimeout(f),f=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,r){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(e){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.element.one("set_state.jstree",function(r,i){i.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}},e.jstree.defaults.types={default:{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(r,i){this.init=function(r,s){var a,n;if(s&&s.types&&s.types.default)for(a in s.types)if("default"!==a&&a!==e.jstree.root&&s.types.hasOwnProperty(a))for(n in s.types.default)s.types.default.hasOwnProperty(n)&&s.types[a][n]===t&&(s.types[a][n]=s.types.default[n]);i.init.call(this,r,s),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,r){i.refresh.call(this,t,r),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(r,i){var s,a,n,o=this._model.data,d=i.nodes,c=this.settings.types,l="default";for(s=0,a=d.length;s<a;s++){if(l="default",o[d[s]].original&&o[d[s]].original.type&&c[o[d[s]].original.type]&&(l=o[d[s]].original.type),o[d[s]].data&&o[d[s]].data.jstree&&o[d[s]].data.jstree.type&&c[o[d[s]].data.jstree.type]&&(l=o[d[s]].data.jstree.type),o[d[s]].type=l,!0===o[d[s]].icon&&c[l].icon!==t&&(o[d[s]].icon=c[l].icon),c[l].li_attr!==t&&"object"==typeof c[l].li_attr)for(n in c[l].li_attr)if(c[l].li_attr.hasOwnProperty(n)){if("id"===n)continue;o[d[s]].li_attr[n]===t?o[d[s]].li_attr[n]=c[l].li_attr[n]:"class"===n&&(o[d[s]].li_attr.class=c[l].li_attr.class+" "+o[d[s]].li_attr.class)}if(c[l].a_attr!==t&&"object"==typeof c[l].a_attr)for(n in c[l].a_attr)if(c[l].a_attr.hasOwnProperty(n)){if("id"===n)continue;o[d[s]].a_attr[n]===t?o[d[s]].a_attr[n]=c[l].a_attr[n]:"href"===n&&"#"===o[d[s]].a_attr[n]?o[d[s]].a_attr.href=c[l].a_attr.href:"class"===n&&(o[d[s]].a_attr.class=c[l].a_attr.class+" "+o[d[s]].a_attr.class)}}o[e.jstree.root].type=e.jstree.root},this)),i.bind.call(this)},this.get_json=function(t,r,s){var a,n,o=this._model.data,d=r?e.extend(!0,{},r,{no_id:!1}):{},c=i.get_json.call(this,t,d,s);if(!1===c)return!1;if(e.isArray(c))for(a=0,n=c.length;a<n;a++)c[a].type=c[a].id&&o[c[a].id]&&o[c[a].id].type?o[c[a].id].type:"default",r&&r.no_id&&(delete c[a].id,c[a].li_attr&&c[a].li_attr.id&&delete c[a].li_attr.id,c[a].a_attr&&c[a].a_attr.id&&delete c[a].a_attr.id);else c.type=c.id&&o[c.id]&&o[c.id].type?o[c.id].type:"default",r&&r.no_id&&(c=this._delete_ids(c));return c},this._delete_ids=function(t){if(e.isArray(t)){for(var r=0,i=t.length;r<i;r++)t[r]=this._delete_ids(t[r]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(r,s,a,n,o){if(!1===i.check.call(this,r,s,a,n,o))return!1;s=s&&s.id?s:this.get_node(s),a=a&&a.id?a:this.get_node(a);var d,c,l,h,_=s&&s.id?o&&o.origin?o.origin:e.jstree.reference(s.id):null;switch(_=_&&_._model&&_._model.data?_._model.data:null,r){case"create_node":case"move_node":case"copy_node":if("move_node"!==r||-1===e.inArray(s.id,a.children)){if((d=this.get_rules(a)).max_children!==t&&-1!==d.max_children&&d.max_children===a.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+r,data:JSON.stringify({chk:r,pos:n,obj:!(!s||!s.id)&&s.id,par:!(!a||!a.id)&&a.id})},!1;if(d.valid_children!==t&&-1!==d.valid_children&&-1===e.inArray(s.type||"default",d.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+r,data:JSON.stringify({chk:r,pos:n,obj:!(!s||!s.id)&&s.id,par:!(!a||!a.id)&&a.id})},!1;if(_&&s.children_d&&s.parents){for(c=0,l=0,h=s.children_d.length;l<h;l++)c=Math.max(c,_[s.children_d[l]].parents.length);c=c-s.parents.length+1}(c<=0||c===t)&&(c=1);do{if(d.max_depth!==t&&-1!==d.max_depth&&d.max_depth<c)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+r,data:JSON.stringify({chk:r,pos:n,obj:!(!s||!s.id)&&s.id,par:!(!a||!a.id)&&a.id})},!1;a=this.get_node(a.parent),d=this.get_rules(a),c++}while(a)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;var r=this.get_type(e,!0);return r.max_depth===t&&(r.max_depth=-1),r.max_children===t&&(r.max_children=-1),r.valid_children===t&&(r.valid_children=-1),r},this.get_type=function(t,r){return!!(t=this.get_node(t))&&(r?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(r,i){var s,a,n,o,d,c,l,h,_=this._model.data;if(e.isArray(r)){for(a=0,n=(r=r.slice()).length;a<n;a++)this.set_type(r[a],i);return!0}if(s=this.settings.types,r=this.get_node(r),!s[i]||!r)return!1;if((l=this.get_node(r,!0))&&l.length&&(h=l.children(".jstree-anchor")),o=r.type,d=this.get_icon(r),r.type=i,(!0===d||s[o]&&s[o].icon!==t&&d===s[o].icon)&&this.set_icon(r,s[i].icon===t||s[i].icon),s[o].li_attr!==t&&"object"==typeof s[o].li_attr)for(c in s[o].li_attr)if(s[o].li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(_[r.id].li_attr.class=(_[r.id].li_attr.class||"").replace(s[o].li_attr[c],""),l&&l.removeClass(s[o].li_attr[c])):_[r.id].li_attr[c]===s[o].li_attr[c]&&(_[r.id].li_attr[c]=null,l&&l.removeAttr(c))}if(s[o].a_attr!==t&&"object"==typeof s[o].a_attr)for(c in s[o].a_attr)if(s[o].a_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(_[r.id].a_attr.class=(_[r.id].a_attr.class||"").replace(s[o].a_attr[c],""),h&&h.removeClass(s[o].a_attr[c])):_[r.id].a_attr[c]===s[o].a_attr[c]&&("href"===c?(_[r.id].a_attr[c]="#",h&&h.attr("href","#")):(delete _[r.id].a_attr[c],h&&h.removeAttr(c)))}if(s[i].li_attr!==t&&"object"==typeof s[i].li_attr)for(c in s[i].li_attr)if(s[i].li_attr.hasOwnProperty(c)){if("id"===c)continue;_[r.id].li_attr[c]===t?(_[r.id].li_attr[c]=s[i].li_attr[c],l&&("class"===c?l.addClass(s[i].li_attr[c]):l.attr(c,s[i].li_attr[c]))):"class"===c&&(_[r.id].li_attr.class=s[i].li_attr[c]+" "+_[r.id].li_attr.class,l&&l.addClass(s[i].li_attr[c]))}if(s[i].a_attr!==t&&"object"==typeof s[i].a_attr)for(c in s[i].a_attr)if(s[i].a_attr.hasOwnProperty(c)){if("id"===c)continue;_[r.id].a_attr[c]===t?(_[r.id].a_attr[c]=s[i].a_attr[c],h&&("class"===c?h.addClass(s[i].a_attr[c]):h.attr(c,s[i].a_attr[c]))):"href"===c&&"#"===_[r.id].a_attr[c]?(_[r.id].a_attr.href=s[i].a_attr.href,h&&h.attr("href",s[i].a_attr.href)):"class"===c&&(_[r.id].a_attr.class=s[i].a_attr.class+" "+_[r.id].a_attr.class,h&&h.addClass(s[i].a_attr[c]))}return!0}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(r,i){this.check=function(t,r,s,a,n){if(!1===i.check.call(this,t,r,s,a,n))return!1;if(r=r&&r.id?r:this.get_node(r),!(s=s&&s.id?s:this.get_node(s))||!s.children)return!0;var o,d,c="rename_node"===t?a:r.text,l=[],h=this.settings.unique.case_sensitive,_=this._model.data;for(o=0,d=s.children.length;o<d;o++)l.push(h?_[s.children[o]].text:_[s.children[o]].text.toLowerCase());switch(h||(c=c.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return(o=-1===e.inArray(c,l)||r.text&&r.text[h?"toString":"toLowerCase"]()===c)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!s||!s.id)&&s.id})}),o;case"create_node":return(o=-1===e.inArray(c,l))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!s||!s.id)&&s.id})}),o;case"copy_node":return(o=-1===e.inArray(c,l))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!s||!s.id)&&s.id})}),o;case"move_node":return(o=r.parent===s.id&&(!n||!n.is_multi)||-1===e.inArray(c,l))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!s||!s.id)&&s.id})}),o}return!0},this.create_node=function(r,s,a,n,o){if(!s||s.text===t){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return i.create_node.call(this,r,s,a,n,o);if(!(a=a===t?"last":a).toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(r))return i.create_node.call(this,r,s,a,n,o);s||(s={});var d,c,l,h,_,u=this._model.data,g=this.settings.unique.case_sensitive,f=this.settings.unique.duplicate;for(c=d=this.get_string("New node"),l=[],h=0,_=r.children.length;h<_;h++)l.push(g?u[r.children[h]].text:u[r.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(g?c:c.toLowerCase(),l);)c=f.call(this,d,++h).toString();s.text=c}return i.create_node.call(this,r,s,a,n,o)}};var p=l.createElement("DIV");if(p.setAttribute("unselectable","on"),p.setAttribute("role","presentation"),p.className="jstree-wholerow",p.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var r,i,s=!1;for(r=0,i=t.selected.length;r<i;r++)(s=this.get_node(t.selected[r],!0))&&s.length&&s.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var r=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r)}},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),r.teardown.call(this)},this.redraw_node=function(t,i,s,a){if(t=r.redraw_node.apply(this,arguments)){var n=p.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(n.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(n.className+=" jstree-wholerow-hovered"),t.insertBefore(n,t.childNodes[0])}return t}},l.registerElement&&Object&&Object.create){var m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var t,r={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(r.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(r[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(r.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(r)};try{l.registerElement("vakata-jstree",{prototype:m})}catch(e){}}}});

},{"jquery":331}],333:[function(require,module,exports){
(function (global){
(function(){function n(n,t){return n.set(t[0],t[1]),n}function t(n,t){return n.add(t),n}function r(n,t,r){switch(r.length){case 0:return n.call(t);case 1:return n.call(t,r[0]);case 2:return n.call(t,r[0],r[1]);case 3:return n.call(t,r[0],r[1],r[2])}return n.apply(t,r)}function e(n,t){for(var r=-1,e=null==n?0:n.length;++r<e&&!1!==t(n[r],r,n););return n}function u(n,t){for(var r=-1,e=null==n?0:n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function i(n,t){for(var r=-1,e=null==n?0:n.length,u=0,i=[];++r<e;){var o=n[r];t(o,r,n)&&(i[u++]=o)}return i}function o(n,t){return!!(null==n?0:n.length)&&_(n,t,0)>-1}function f(n,t,r){for(var e=-1,u=null==n?0:n.length;++e<u;)if(r(t,n[e]))return!0;return!1}function c(n,t){for(var r=-1,e=null==n?0:n.length,u=Array(e);++r<e;)u[r]=t(n[r],r,n);return u}function a(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function l(n,t,r,e){var u=-1,i=null==n?0:n.length;for(e&&i&&(r=n[++u]);++u<i;)r=t(r,n[u],u,n);return r}function s(n,t){for(var r=-1,e=null==n?0:n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}function h(n,t,r){var e;return r(n,function(n,r,u){if(t(n,r,u))return e=r,!1}),e}function p(n,t,r,e){for(var u=n.length,i=r+(e?1:-1);e?i--:++i<u;)if(t(n[i],i,n))return i;return-1}function _(n,t,r){return t==t?function(n,t,r){var e=r-1,u=n.length;for(;++e<u;)if(n[e]===t)return e;return-1}(n,t,r):p(n,v,r)}function v(n){return n!=n}function g(n,t){var r=null==n?0:n.length;return r?w(n,t)/r:pn}function y(n){return function(t){return null==t?U:t[n]}}function d(n){return function(t){return null==n?U:n[t]}}function b(n,t,r,e,u){return u(n,function(n,u,i){r=e?(e=!1,n):t(r,n,u,i)}),r}function w(n,t){for(var r,e=-1,u=n.length;++e<u;){var i=t(n[e]);i!==U&&(r=r===U?i:r+i)}return r}function m(n,t){for(var r=-1,e=Array(n);++r<n;)e[r]=t(r);return e}function x(n){return function(t){return n(t)}}function j(n,t){return c(t,function(t){return n[t]})}function A(n,t){return n.has(t)}function k(n,t){for(var r=-1,e=n.length;++r<e&&_(t,n[r],0)>-1;);return r}function O(n,t){for(var r=n.length;r--&&_(t,n[r],0)>-1;);return r}function I(n){return"\\"+sr[n]}function R(n){return ir.test(n)}function z(n){var t=-1,r=Array(n.size);return n.forEach(function(n,e){r[++t]=[e,n]}),r}function E(n,t){return function(r){return n(t(r))}}function S(n,t){for(var r=-1,e=n.length,u=0,i=[];++r<e;){var o=n[r];o!==t&&o!==F||(n[r]=F,i[u++]=r)}return i}function W(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=n}),r}function L(n){return R(n)?function(n){var t=er.lastIndex=0;for(;er.test(n);)++t;return t}(n):Rr(n)}function C(n){return R(n)?function(n){return n.match(er)||[]}(n):function(n){return n.split("")}(n)}var U,B=200,T="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",$="Expected a function",D="__lodash_hash_undefined__",M=500,F="__lodash_placeholder__",N=1,P=2,q=4,Z=1,K=2,V=1,G=2,H=4,J=8,Y=16,Q=32,X=64,nn=128,tn=256,rn=512,en=30,un="...",on=800,fn=16,cn=1,an=2,ln=1/0,sn=9007199254740991,hn=1.7976931348623157e308,pn=NaN,_n=4294967295,vn=_n-1,gn=_n>>>1,yn=[["ary",nn],["bind",V],["bindKey",G],["curry",J],["curryRight",Y],["flip",rn],["partial",Q],["partialRight",X],["rearg",tn]],dn="[object Arguments]",bn="[object Array]",wn="[object AsyncFunction]",mn="[object Boolean]",xn="[object Date]",jn="[object DOMException]",An="[object Error]",kn="[object Function]",On="[object GeneratorFunction]",In="[object Map]",Rn="[object Number]",zn="[object Null]",En="[object Object]",Sn="[object Proxy]",Wn="[object RegExp]",Ln="[object Set]",Cn="[object String]",Un="[object Symbol]",Bn="[object Undefined]",Tn="[object WeakMap]",$n="[object WeakSet]",Dn="[object ArrayBuffer]",Mn="[object DataView]",Fn="[object Float32Array]",Nn="[object Float64Array]",Pn="[object Int8Array]",qn="[object Int16Array]",Zn="[object Int32Array]",Kn="[object Uint8Array]",Vn="[object Uint8ClampedArray]",Gn="[object Uint16Array]",Hn="[object Uint32Array]",Jn=/\b__p \+= '';/g,Yn=/\b(__p \+=) '' \+/g,Qn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Xn=/&(?:amp|lt|gt|quot|#39);/g,nt=/[&<>"']/g,tt=RegExp(Xn.source),rt=RegExp(nt.source),et=/<%-([\s\S]+?)%>/g,ut=/<%([\s\S]+?)%>/g,it=/<%=([\s\S]+?)%>/g,ot=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ft=/^\w*$/,ct=/^\./,at=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lt=/[\\^$.*+?()[\]{}|]/g,st=RegExp(lt.source),ht=/^\s+|\s+$/g,pt=/^\s+/,_t=/\s+$/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,gt=/\{\n\/\* \[wrapped with (.+)\] \*/,yt=/,? & /,dt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,bt=/\\(\\)?/g,wt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,mt=/\w*$/,xt=/^[-+]0x[0-9a-f]+$/i,jt=/^0b[01]+$/i,At=/^\[object .+?Constructor\]$/,kt=/^0o[0-7]+$/i,Ot=/^(?:0|[1-9]\d*)$/,It=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Rt=/($^)/,zt=/['\n\r\u2028\u2029\\]/g,Et="\\ud800-\\udfff",St="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Wt="a-z\\xdf-\\xf6\\xf8-\\xff",Lt="A-Z\\xc0-\\xd6\\xd8-\\xde",Ct="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ut="["+Et+"]",Bt="["+Ct+"]",Tt="["+St+"]",$t="\\d+",Dt="[\\u2700-\\u27bf]",Mt="["+Wt+"]",Ft="[^"+Et+Ct+$t+"\\u2700-\\u27bf"+Wt+Lt+"]",Nt="\\ud83c[\\udffb-\\udfff]",Pt="[^"+Et+"]",qt="(?:\\ud83c[\\udde6-\\uddff]){2}",Zt="[\\ud800-\\udbff][\\udc00-\\udfff]",Kt="["+Lt+"]",Vt="(?:"+Mt+"|"+Ft+")",Gt="(?:"+Kt+"|"+Ft+")",Ht="(?:['’](?:d|ll|m|re|s|t|ve))?",Jt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Yt="(?:"+Tt+"|"+Nt+")"+"?",Qt="[\\ufe0e\\ufe0f]?"+Yt+("(?:\\u200d(?:"+[Pt,qt,Zt].join("|")+")[\\ufe0e\\ufe0f]?"+Yt+")*"),Xt="(?:"+[Dt,qt,Zt].join("|")+")"+Qt,nr="(?:"+[Pt+Tt+"?",Tt,qt,Zt,Ut].join("|")+")",tr=RegExp("['’]","g"),rr=RegExp(Tt,"g"),er=RegExp(Nt+"(?="+Nt+")|"+nr+Qt,"g"),ur=RegExp([Kt+"?"+Mt+"+"+Ht+"(?="+[Bt,Kt,"$"].join("|")+")",Gt+"+"+Jt+"(?="+[Bt,Kt+Vt,"$"].join("|")+")",Kt+"?"+Vt+"+"+Ht,Kt+"+"+Jt,"\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",$t,Xt].join("|"),"g"),ir=RegExp("[\\u200d"+Et+St+"\\ufe0e\\ufe0f]"),or=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],cr=-1,ar={};ar[Fn]=ar[Nn]=ar[Pn]=ar[qn]=ar[Zn]=ar[Kn]=ar[Vn]=ar[Gn]=ar[Hn]=!0,ar[dn]=ar[bn]=ar[Dn]=ar[mn]=ar[Mn]=ar[xn]=ar[An]=ar[kn]=ar[In]=ar[Rn]=ar[En]=ar[Wn]=ar[Ln]=ar[Cn]=ar[Tn]=!1;var lr={};lr[dn]=lr[bn]=lr[Dn]=lr[Mn]=lr[mn]=lr[xn]=lr[Fn]=lr[Nn]=lr[Pn]=lr[qn]=lr[Zn]=lr[In]=lr[Rn]=lr[En]=lr[Wn]=lr[Ln]=lr[Cn]=lr[Un]=lr[Kn]=lr[Vn]=lr[Gn]=lr[Hn]=!0,lr[An]=lr[kn]=lr[Tn]=!1;var sr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},hr=parseFloat,pr=parseInt,_r="object"==typeof global&&global&&global.Object===Object&&global,vr="object"==typeof self&&self&&self.Object===Object&&self,gr=_r||vr||Function("return this")(),yr="object"==typeof exports&&exports&&!exports.nodeType&&exports,dr=yr&&"object"==typeof module&&module&&!module.nodeType&&module,br=dr&&dr.exports===yr,wr=br&&_r.process,mr=function(){try{return wr&&wr.binding&&wr.binding("util")}catch(n){}}(),xr=mr&&mr.isArrayBuffer,jr=mr&&mr.isDate,Ar=mr&&mr.isMap,kr=mr&&mr.isRegExp,Or=mr&&mr.isSet,Ir=mr&&mr.isTypedArray,Rr=y("length"),zr=d({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Er=d({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Sr=d({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Wr=function d(Et){function St(n){if(ni(n)&&!Zf(n)&&!(n instanceof Ct)){if(n instanceof Lt)return n;if(Pi.call(n,"__wrapped__"))return ju(n)}return new Lt(n)}function Wt(){}function Lt(n,t){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=U}function Ct(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_n,this.__views__=[]}function Ut(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function Bt(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function Tt(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function $t(n){var t=-1,r=null==n?0:n.length;for(this.__data__=new Tt;++t<r;)this.add(n[t])}function Dt(n){var t=this.__data__=new Bt(n);this.size=t.size}function Mt(n,t){var r=Zf(n),e=!r&&qf(n),u=!r&&!e&&Vf(n),i=!r&&!e&&!u&&Qf(n),o=r||e||u||i,f=o?m(n.length,Bi):[],c=f.length;for(var a in n)!t&&!Pi.call(n,a)||o&&("length"==a||u&&("offset"==a||"parent"==a)||i&&("buffer"==a||"byteLength"==a||"byteOffset"==a)||au(a,c))||f.push(a);return f}function Ft(n){var t=n.length;return t?n[Qr(0,t-1)]:U}function Nt(n,t,r){(r===U||Ku(n[t],r))&&(r!==U||t in n)||Kt(n,t,r)}function Pt(n,t,r){var e=n[t];Pi.call(n,t)&&Ku(e,r)&&(r!==U||t in n)||Kt(n,t,r)}function qt(n,t){for(var r=n.length;r--;)if(Ku(n[r][0],t))return r;return-1}function Zt(n,t){return n&&Oe(t,_i(t),n)}function Kt(n,t,r){"__proto__"==t&&fo?fo(n,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):n[t]=r}function Vt(n,t){for(var r=-1,e=t.length,u=zi(e),i=null==n;++r<e;)u[r]=i?U:hi(n,t[r]);return u}function Gt(n,t,r){return n==n&&(r!==U&&(n=n<=r?n:r),t!==U&&(n=n>=t?n:t)),n}function Ht(r,u,i,o,f,c){var a,s=u&N,h=u&P,p=u&q;if(i&&(a=f?i(r,o,f,c):i(r)),a!==U)return a;if(!Xu(r))return r;var _=Zf(r);if(_){if(a=function(n){var t=n.length,r=n.constructor(t);return t&&"string"==typeof n[0]&&Pi.call(n,"index")&&(r.index=n.index,r.input=n.input),r}(r),!s)return ke(r,a)}else{var v=nf(r),g=v==kn||v==On;if(Vf(r))return be(r,s);if(v==En||v==dn||g&&!f){if(a=h||g?{}:fu(r),!s)return h?function(n,t){return Oe(n,Xo(n),t)}(r,function(n,t){return n&&Oe(t,vi(t),n)}(a,r)):function(n,t){return Oe(n,Qo(n),t)}(r,Zt(a,r))}else{if(!lr[v])return f?r:{};a=function(r,e,u,i){var o=r.constructor;switch(e){case Dn:return we(r);case mn:case xn:return new o(+r);case Mn:return function(n,t){var r=t?we(n.buffer):n.buffer;return new n.constructor(r,n.byteOffset,n.byteLength)}(r,i);case Fn:case Nn:case Pn:case qn:case Zn:case Kn:case Vn:case Gn:case Hn:return me(r,i);case In:return function(t,r,e){return l(r?e(z(t),N):z(t),n,new t.constructor)}(r,i,u);case Rn:case Cn:return new o(r);case Wn:return function(n){var t=new n.constructor(n.source,mt.exec(n));return t.lastIndex=n.lastIndex,t}(r);case Ln:return function(n,r,e){return l(r?e(W(n),N):W(n),t,new n.constructor)}(r,i,u);case Un:return function(n){return Do?Ci(Do.call(n)):{}}(r)}}(r,v,Ht,s)}}c||(c=new Dt);var y=c.get(r);if(y)return y;c.set(r,a);var d=_?U:(p?h?Xe:Qe:h?vi:_i)(r);return e(d||r,function(n,t){d&&(n=r[t=n]),Pt(a,t,Ht(n,u,i,t,r,c))}),a}function Jt(n,t,r){var e=r.length;if(null==n)return!e;for(n=Ci(n);e--;){var u=r[e],i=t[u],o=n[u];if(o===U&&!(u in n)||!i(o))return!1}return!0}function Yt(n,t,r){if("function"!=typeof n)throw new Ti($);return ef(function(){n.apply(U,r)},t)}function Qt(n,t,r,e){var u=-1,i=o,a=!0,l=n.length,s=[],h=t.length;if(!l)return s;r&&(t=c(t,x(r))),e?(i=f,a=!1):t.length>=B&&(i=A,a=!1,t=new $t(t));n:for(;++u<l;){var p=n[u],_=null==r?p:r(p);if(p=e||0!==p?p:0,a&&_==_){for(var v=h;v--;)if(t[v]===_)continue n;s.push(p)}else i(t,_,e)||s.push(p)}return s}function Xt(n,t,r){for(var e=-1,u=n.length;++e<u;){var i=n[e],o=t(i);if(null!=o&&(f===U?o==o&&!ui(o):r(o,f)))var f=o,c=i}return c}function nr(n,t){var r=[];return No(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function er(n,t,r,e,u){var i=-1,o=n.length;for(r||(r=cu),u||(u=[]);++i<o;){var f=n[i];t>0&&r(f)?t>1?er(f,t-1,r,e,u):a(u,f):e||(u[u.length]=f)}return u}function ir(n,t){return n&&qo(n,t,_i)}function sr(n,t){return n&&Zo(n,t,_i)}function _r(n,t){return i(t,function(t){return Ju(n[t])})}function vr(n,t){for(var r=0,e=(t=ye(t,n)).length;null!=n&&r<e;)n=n[mu(t[r++])];return r&&r==e?n:U}function yr(n,t,r){var e=t(n);return Zf(n)?e:a(e,r(n))}function dr(n){return null==n?n===U?Bn:zn:oo&&oo in Ci(n)?function(n){var t=Pi.call(n,oo),r=n[oo];try{n[oo]=U;var e=!0}catch(n){}var u=Ki.call(n);return e&&(t?n[oo]=r:delete n[oo]),u}(n):function(n){return Ki.call(n)}(n)}function wr(n,t){return n>t}function mr(n,t){return null!=n&&Pi.call(n,t)}function Rr(n,t){return null!=n&&t in Ci(n)}function Lr(n,t,r){for(var e=r?f:o,u=n[0].length,i=n.length,a=i,l=zi(i),s=1/0,h=[];a--;){var p=n[a];a&&t&&(p=c(p,x(t))),s=wo(p.length,s),l[a]=!r&&(t||u>=120&&p.length>=120)?new $t(a&&p):U}p=n[0];var _=-1,v=l[0];n:for(;++_<u&&h.length<s;){var g=p[_],y=t?t(g):g;if(g=r||0!==g?g:0,!(v?A(v,y):e(h,y,r))){for(a=i;--a;){var d=l[a];if(!(d?A(d,y):e(n[a],y,r)))continue n}v&&v.push(y),h.push(g)}}return h}function Cr(n,t,e){var u=null==(n=yu(n,t=ye(t,n)))?n:n[mu(Ru(t))];return null==u?U:r(u,n,e)}function Ur(n){return ni(n)&&dr(n)==dn}function Br(n,t,r,e,u){return n===t||(null==n||null==t||!ni(n)&&!ni(t)?n!=n&&t!=t:function(n,t,r,e,u,i){var o=Zf(n),f=Zf(t),c=o?bn:nf(n),a=f?bn:nf(t),l=(c=c==dn?En:c)==En,s=(a=a==dn?En:a)==En,h=c==a;if(h&&Vf(n)){if(!Vf(t))return!1;o=!0,l=!1}if(h&&!l)return i||(i=new Dt),o||Qf(n)?Je(n,t,r,e,u,i):function(n,t,r,e,u,i,o){switch(r){case Mn:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case Dn:return!(n.byteLength!=t.byteLength||!i(new Qi(n),new Qi(t)));case mn:case xn:case Rn:return Ku(+n,+t);case An:return n.name==t.name&&n.message==t.message;case Wn:case Cn:return n==t+"";case In:var f=z;case Ln:var c=e&Z;if(f||(f=W),n.size!=t.size&&!c)return!1;var a=o.get(n);if(a)return a==t;e|=K,o.set(n,t);var l=Je(f(n),f(t),e,u,i,o);return o.delete(n),l;case Un:if(Do)return Do.call(n)==Do.call(t)}return!1}(n,t,c,r,e,u,i);if(!(r&Z)){var p=l&&Pi.call(n,"__wrapped__"),_=s&&Pi.call(t,"__wrapped__");if(p||_){var v=p?n.value():n,g=_?t.value():t;return i||(i=new Dt),u(v,g,r,e,i)}}return!!h&&(i||(i=new Dt),function(n,t,r,e,u,i){var o=r&Z,f=Qe(n),c=f.length,a=Qe(t).length;if(c!=a&&!o)return!1;for(var l=c;l--;){var s=f[l];if(!(o?s in t:Pi.call(t,s)))return!1}var h=i.get(n);if(h&&i.get(t))return h==t;var p=!0;i.set(n,t),i.set(t,n);for(var _=o;++l<c;){s=f[l];var v=n[s],g=t[s];if(e)var y=o?e(g,v,s,t,n,i):e(v,g,s,n,t,i);if(!(y===U?v===g||u(v,g,r,e,i):y)){p=!1;break}_||(_="constructor"==s)}if(p&&!_){var d=n.constructor,b=t.constructor;d!=b&&"constructor"in n&&"constructor"in t&&!("function"==typeof d&&d instanceof d&&"function"==typeof b&&b instanceof b)&&(p=!1)}return i.delete(n),i.delete(t),p}(n,t,r,e,u,i))}(n,t,r,e,Br,u))}function Tr(n,t,r,e){var u=r.length,i=u,o=!e;if(null==n)return!i;for(n=Ci(n);u--;){var f=r[u];if(o&&f[2]?f[1]!==n[f[0]]:!(f[0]in n))return!1}for(;++u<i;){var c=(f=r[u])[0],a=n[c],l=f[1];if(o&&f[2]){if(a===U&&!(c in n))return!1}else{var s=new Dt;if(e)var h=e(a,l,c,n,t,s);if(!(h===U?Br(l,a,Z|K,e,s):h))return!1}}return!0}function $r(n){return!(!Xu(n)||function(n){return!!Zi&&Zi in n}(n))&&(Ju(n)?Hi:At).test(xu(n))}function Dr(n){return"function"==typeof n?n:null==n?xi:"object"==typeof n?Zf(n)?Zr(n[0],n[1]):qr(n):Oi(n)}function Mr(n){if(!pu(n))return yo(n);var t=[];for(var r in Ci(n))Pi.call(n,r)&&"constructor"!=r&&t.push(r);return t}function Fr(n){if(!Xu(n))return function(n){var t=[];if(null!=n)for(var r in Ci(n))t.push(r);return t}(n);var t=pu(n),r=[];for(var e in n)("constructor"!=e||!t&&Pi.call(n,e))&&r.push(e);return r}function Nr(n,t){return n<t}function Pr(n,t){var r=-1,e=Vu(n)?zi(n.length):[];return No(n,function(n,u,i){e[++r]=t(n,u,i)}),e}function qr(n){var t=uu(n);return 1==t.length&&t[0][2]?vu(t[0][0],t[0][1]):function(r){return r===n||Tr(r,n,t)}}function Zr(n,t){return su(n)&&_u(t)?vu(mu(n),t):function(r){var e=hi(r,n);return e===U&&e===t?pi(r,n):Br(t,e,Z|K)}}function Kr(n,t,r,e,u){n!==t&&qo(t,function(i,o){if(Xu(i))u||(u=new Dt),function(n,t,r,e,u,i,o){var f=n[r],c=t[r],a=o.get(c);if(a)Nt(n,r,a);else{var l=i?i(f,c,r+"",n,t,o):U,s=l===U;if(s){var h=Zf(c),p=!h&&Vf(c),_=!h&&!p&&Qf(c);l=c,h||p||_?Zf(f)?l=f:Gu(f)?l=ke(f):p?(s=!1,l=be(c,!0)):_?(s=!1,l=me(c,!0)):l=[]:ri(c)||qf(c)?(l=f,qf(f)?l=li(f):(!Xu(f)||e&&Ju(f))&&(l=fu(c))):s=!1}s&&(o.set(c,l),u(l,c,e,i,o),o.delete(c)),Nt(n,r,l)}}(n,t,o,r,Kr,e,u);else{var f=e?e(n[o],i,o+"",n,t,u):U;f===U&&(f=i),Nt(n,o,f)}},vi)}function Vr(n,t){var r=n.length;if(r)return t+=t<0?r:0,au(t,r)?n[t]:U}function Gr(n,t,r){var e=-1;return t=c(t.length?t:[xi],x(ru())),function(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].value;return n}(Pr(n,function(n,r,u){return{criteria:c(t,function(t){return t(n)}),index:++e,value:n}}),function(n,t){return function(n,t,r){for(var e=-1,u=n.criteria,i=t.criteria,o=u.length,f=r.length;++e<o;){var c=xe(u[e],i[e]);if(c){if(e>=f)return c;var a=r[e];return c*("desc"==a?-1:1)}}return n.index-t.index}(n,t,r)})}function Hr(n,t,r){for(var e=-1,u=t.length,i={};++e<u;){var o=t[e],f=vr(n,o);r(f,o)&&te(i,ye(o,n),f)}return i}function Jr(n,t,r,e){var u=e?function(n,t,r,e){for(var u=r-1,i=n.length;++u<i;)if(e(n[u],t))return u;return-1}:_,i=-1,o=t.length,f=n;for(n===t&&(t=ke(t)),r&&(f=c(n,x(r)));++i<o;)for(var a=0,l=t[i],s=r?r(l):l;(a=u(f,s,a,e))>-1;)f!==n&&eo.call(f,a,1),eo.call(n,a,1);return n}function Yr(n,t){for(var r=n?t.length:0,e=r-1;r--;){var u=t[r];if(r==e||u!==i){var i=u;au(u)?eo.call(n,u,1):ae(n,u)}}return n}function Qr(n,t){return n+ho(jo()*(t-n+1))}function Xr(n,t){var r="";if(!n||t<1||t>sn)return r;do{t%2&&(r+=n),(t=ho(t/2))&&(n+=n)}while(t);return r}function ne(n,t){return uf(gu(n,t,xi),n+"")}function te(n,t,r,e){if(!Xu(n))return n;for(var u=-1,i=(t=ye(t,n)).length,o=i-1,f=n;null!=f&&++u<i;){var c=mu(t[u]),a=r;if(u!=o){var l=f[c];(a=e?e(l,c,f):U)===U&&(a=Xu(l)?l:au(t[u+1])?[]:{})}Pt(f,c,a),f=f[c]}return n}function re(n,t,r){var e=-1,u=n.length;t<0&&(t=-t>u?0:u+t),(r=r>u?u:r)<0&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var i=zi(u);++e<u;)i[e]=n[e+t];return i}function ee(n,t,r){var e=0,u=null==n?e:n.length;if("number"==typeof t&&t==t&&u<=gn){for(;e<u;){var i=e+u>>>1,o=n[i];null!==o&&!ui(o)&&(r?o<=t:o<t)?e=i+1:u=i}return u}return ue(n,t,xi,r)}function ue(n,t,r,e){t=r(t);for(var u=0,i=null==n?0:n.length,o=t!=t,f=null===t,c=ui(t),a=t===U;u<i;){var l=ho((u+i)/2),s=r(n[l]),h=s!==U,p=null===s,_=s==s,v=ui(s);if(o)var g=e||_;else g=a?_&&(e||h):f?_&&h&&(e||!p):c?_&&h&&!p&&(e||!v):!p&&!v&&(e?s<=t:s<t);g?u=l+1:i=l}return wo(i,vn)}function ie(n,t){for(var r=-1,e=n.length,u=0,i=[];++r<e;){var o=n[r],f=t?t(o):o;if(!r||!Ku(f,c)){var c=f;i[u++]=0===o?0:o}}return i}function oe(n){return"number"==typeof n?n:ui(n)?pn:+n}function fe(n){if("string"==typeof n)return n;if(Zf(n))return c(n,fe)+"";if(ui(n))return Mo?Mo.call(n):"";var t=n+"";return"0"==t&&1/n==-ln?"-0":t}function ce(n,t,r){var e=-1,u=o,i=n.length,c=!0,a=[],l=a;if(r)c=!1,u=f;else if(i>=B){var s=t?null:Jo(n);if(s)return W(s);c=!1,u=A,l=new $t}else l=t?[]:a;n:for(;++e<i;){var h=n[e],p=t?t(h):h;if(h=r||0!==h?h:0,c&&p==p){for(var _=l.length;_--;)if(l[_]===p)continue n;t&&l.push(p),a.push(h)}else u(l,p,r)||(l!==a&&l.push(p),a.push(h))}return a}function ae(n,t){return t=ye(t,n),null==(n=yu(n,t))||delete n[mu(Ru(t))]}function le(n,t,r,e){return te(n,t,r(vr(n,t)),e)}function se(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?re(n,e?0:i,e?i+1:u):re(n,e?i+1:0,e?u:i)}function he(n,t){var r=n;return r instanceof Ct&&(r=r.value()),l(t,function(n,t){return t.func.apply(t.thisArg,a([n],t.args))},r)}function pe(n,t,r){var e=n.length;if(e<2)return e?ce(n[0]):[];for(var u=-1,i=zi(e);++u<e;)for(var o=n[u],f=-1;++f<e;)f!=u&&(i[u]=Qt(i[u]||o,n[f],t,r));return ce(er(i,1),t,r)}function _e(n,t,r){for(var e=-1,u=n.length,i=t.length,o={};++e<u;){var f=e<i?t[e]:U;r(o,n[e],f)}return o}function ve(n){return Gu(n)?n:[]}function ge(n){return"function"==typeof n?n:xi}function ye(n,t){return Zf(n)?n:su(n,t)?[n]:of(si(n))}function de(n,t,r){var e=n.length;return r=r===U?e:r,!t&&r>=e?n:re(n,t,r)}function be(n,t){if(t)return n.slice();var r=n.length,e=Xi?Xi(r):new n.constructor(r);return n.copy(e),e}function we(n){var t=new n.constructor(n.byteLength);return new Qi(t).set(new Qi(n)),t}function me(n,t){var r=t?we(n.buffer):n.buffer;return new n.constructor(r,n.byteOffset,n.length)}function xe(n,t){if(n!==t){var r=n!==U,e=null===n,u=n==n,i=ui(n),o=t!==U,f=null===t,c=t==t,a=ui(t);if(!f&&!a&&!i&&n>t||i&&o&&c&&!f&&!a||e&&o&&c||!r&&c||!u)return 1;if(!e&&!i&&!a&&n<t||a&&r&&u&&!e&&!i||f&&r&&u||!o&&u||!c)return-1}return 0}function je(n,t,r,e){for(var u=-1,i=n.length,o=r.length,f=-1,c=t.length,a=bo(i-o,0),l=zi(c+a),s=!e;++f<c;)l[f]=t[f];for(;++u<o;)(s||u<i)&&(l[r[u]]=n[u]);for(;a--;)l[f++]=n[u++];return l}function Ae(n,t,r,e){for(var u=-1,i=n.length,o=-1,f=r.length,c=-1,a=t.length,l=bo(i-f,0),s=zi(l+a),h=!e;++u<l;)s[u]=n[u];for(var p=u;++c<a;)s[p+c]=t[c];for(;++o<f;)(h||u<i)&&(s[p+r[o]]=n[u++]);return s}function ke(n,t){var r=-1,e=n.length;for(t||(t=zi(e));++r<e;)t[r]=n[r];return t}function Oe(n,t,r,e){var u=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var f=t[i],c=e?e(r[f],n[f],f,r,n):U;c===U&&(c=n[f]),u?Kt(r,f,c):Pt(r,f,c)}return r}function Ie(n,t){return function(r,e){var u=Zf(r)?function(n,t,r,e){for(var u=-1,i=null==n?0:n.length;++u<i;){var o=n[u];t(e,o,r(o),n)}return e}:function(n,t,r,e){return No(n,function(n,u,i){t(e,n,r(n),i)}),e},i=t?t():{};return u(r,n,ru(e,2),i)}}function Re(n){return ne(function(t,r){var e=-1,u=r.length,i=u>1?r[u-1]:U,o=u>2?r[2]:U;for(i=n.length>3&&"function"==typeof i?(u--,i):U,o&&lu(r[0],r[1],o)&&(i=u<3?U:i,u=1),t=Ci(t);++e<u;){var f=r[e];f&&n(t,f,e,i)}return t})}function ze(n,t){return function(r,e){if(null==r)return r;if(!Vu(r))return n(r,e);for(var u=r.length,i=t?u:-1,o=Ci(r);(t?i--:++i<u)&&!1!==e(o[i],i,o););return r}}function Ee(n){return function(t,r,e){for(var u=-1,i=Ci(t),o=e(t),f=o.length;f--;){var c=o[n?f:++u];if(!1===r(i[c],c,i))break}return t}}function Se(n){return function(t){var r=R(t=si(t))?C(t):U,e=r?r[0]:t.charAt(0),u=r?de(r,1).join(""):t.slice(1);return e[n]()+u}}function We(n){return function(t){return l(wi(bi(t).replace(tr,"")),n,"")}}function Le(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Fo(n.prototype),e=n.apply(r,t);return Xu(e)?e:r}}function Ce(n){return function(t,r,e){var u=Ci(t);if(!Vu(t)){var i=ru(r,3);t=_i(t),r=function(n){return i(u[n],n,u)}}var o=n(t,r,e);return o>-1?u[i?t[o]:o]:U}}function Ue(n){return Ye(function(t){var r=t.length,e=r,u=Lt.prototype.thru;for(n&&t.reverse();e--;){var i=t[e];if("function"!=typeof i)throw new Ti($);if(u&&!o&&"wrapper"==nu(i))var o=new Lt([],!0)}for(e=o?e:r;++e<r;){var f=nu(i=t[e]),c="wrapper"==f?Yo(i):U;o=c&&hu(c[0])&&c[1]==(nn|J|Q|tn)&&!c[4].length&&1==c[9]?o[nu(c[0])].apply(o,c[3]):1==i.length&&hu(i)?o[f]():o.thru(i)}return function(){var n=arguments,e=n[0];if(o&&1==n.length&&Zf(e))return o.plant(e).value();for(var u=0,i=r?t[u].apply(this,n):e;++u<r;)i=t[u].call(this,i);return i}})}function Be(n,t,r,e,u,i,o,f,c,a){function l(){for(var y=arguments.length,d=zi(y),b=y;b--;)d[b]=arguments[b];if(_)var w=tu(l),m=function(n,t){for(var r=n.length,e=0;r--;)n[r]===t&&++e;return e}(d,w);if(e&&(d=je(d,e,u,_)),i&&(d=Ae(d,i,o,_)),y-=m,_&&y<a){var x=S(d,w);return Pe(n,t,Be,l.placeholder,r,d,x,f,c,a-y)}var j=h?r:this,A=p?j[n]:n;return y=d.length,f?d=function(n,t){for(var r=n.length,e=wo(t.length,r),u=ke(n);e--;){var i=t[e];n[e]=au(i,r)?u[i]:U}return n}(d,f):v&&y>1&&d.reverse(),s&&c<y&&(d.length=c),this&&this!==gr&&this instanceof l&&(A=g||Le(A)),A.apply(j,d)}var s=t&nn,h=t&V,p=t&G,_=t&(J|Y),v=t&rn,g=p?U:Le(n);return l}function Te(n,t){return function(r,e){return function(n,t,r,e){return ir(n,function(n,u,i){t(e,r(n),u,i)}),e}(r,n,t(e),{})}}function $e(n,t){return function(r,e){var u;if(r===U&&e===U)return t;if(r!==U&&(u=r),e!==U){if(u===U)return e;"string"==typeof r||"string"==typeof e?(r=fe(r),e=fe(e)):(r=oe(r),e=oe(e)),u=n(r,e)}return u}}function De(n){return Ye(function(t){return t=c(t,x(ru())),ne(function(e){var u=this;return n(t,function(n){return r(n,u,e)})})})}function Me(n,t){var r=(t=t===U?" ":fe(t)).length;if(r<2)return r?Xr(t,n):t;var e=Xr(t,so(n/L(t)));return R(t)?de(C(e),0,n).join(""):e.slice(0,n)}function Fe(n){return function(t,r,e){return e&&"number"!=typeof e&&lu(t,r,e)&&(r=e=U),t=oi(t),r===U?(r=t,t=0):r=oi(r),e=e===U?t<r?1:-1:oi(e),function(n,t,r,e){for(var u=-1,i=bo(so((t-n)/(r||1)),0),o=zi(i);i--;)o[e?i:++u]=n,n+=r;return o}(t,r,e,n)}}function Ne(n){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=ai(t),r=ai(r)),n(t,r)}}function Pe(n,t,r,e,u,i,o,f,c,a){var l=t&J;t|=l?Q:X,(t&=~(l?X:Q))&H||(t&=~(V|G));var s=[n,t,u,l?i:U,l?o:U,l?U:i,l?U:o,f,c,a],h=r.apply(U,s);return hu(n)&&rf(h,s),h.placeholder=e,du(h,n,t)}function qe(n){var t=Li[n];return function(n,r){if(n=ai(n),r=null==r?0:wo(fi(r),292)){var e=(si(n)+"e").split("e");return+((e=(si(t(e[0]+"e"+(+e[1]+r)))+"e").split("e"))[0]+"e"+(+e[1]-r))}return t(n)}}function Ze(n){return function(t){var r=nf(t);return r==In?z(t):r==Ln?function(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=[n,n]}),r}(t):function(n,t){return c(t,function(t){return[t,n[t]]})}(t,n(t))}}function Ke(n,t,e,u,i,o,f,c){var a=t&G;if(!a&&"function"!=typeof n)throw new Ti($);var l=u?u.length:0;if(l||(t&=~(Q|X),u=i=U),f=f===U?f:bo(fi(f),0),c=c===U?c:fi(c),l-=i?i.length:0,t&X){var s=u,h=i;u=i=U}var p=a?U:Yo(n),_=[n,t,e,u,i,s,h,o,f,c];if(p&&function(n,t){var r=n[1],e=t[1],u=r|e,i=u<(V|G|nn),o=e==nn&&r==J||e==nn&&r==tn&&n[7].length<=t[8]||e==(nn|tn)&&t[7].length<=t[8]&&r==J;if(!i&&!o)return n;e&V&&(n[2]=t[2],u|=r&V?0:H);var f=t[3];if(f){var c=n[3];n[3]=c?je(c,f,t[4]):f,n[4]=c?S(n[3],F):t[4]}(f=t[5])&&(c=n[5],n[5]=c?Ae(c,f,t[6]):f,n[6]=c?S(n[5],F):t[6]),(f=t[7])&&(n[7]=f),e&nn&&(n[8]=null==n[8]?t[8]:wo(n[8],t[8])),null==n[9]&&(n[9]=t[9]),n[0]=t[0],n[1]=u}(_,p),n=_[0],t=_[1],e=_[2],u=_[3],i=_[4],!(c=_[9]=_[9]===U?a?0:n.length:bo(_[9]-l,0))&&t&(J|Y)&&(t&=~(J|Y)),t&&t!=V)v=t==J||t==Y?function(n,t,e){function u(){for(var o=arguments.length,f=zi(o),c=o,a=tu(u);c--;)f[c]=arguments[c];var l=o<3&&f[0]!==a&&f[o-1]!==a?[]:S(f,a);return(o-=l.length)<e?Pe(n,t,Be,u.placeholder,U,f,l,U,U,e-o):r(this&&this!==gr&&this instanceof u?i:n,this,f)}var i=Le(n);return u}(n,t,c):t!=Q&&t!=(V|Q)||i.length?Be.apply(U,_):function(n,t,e,u){function i(){for(var t=-1,c=arguments.length,a=-1,l=u.length,s=zi(l+c),h=this&&this!==gr&&this instanceof i?f:n;++a<l;)s[a]=u[a];for(;c--;)s[a++]=arguments[++t];return r(h,o?e:this,s)}var o=t&V,f=Le(n);return i}(n,t,e,u);else var v=function(n,t,r){function e(){return(this&&this!==gr&&this instanceof e?i:n).apply(u?r:this,arguments)}var u=t&V,i=Le(n);return e}(n,t,e);return du((p?Ko:rf)(v,_),n,t)}function Ve(n,t,r,e){return n===U||Ku(n,Mi[r])&&!Pi.call(e,r)?t:n}function Ge(n,t,r,e,u,i){return Xu(n)&&Xu(t)&&(i.set(t,n),Kr(n,t,U,Ge,i),i.delete(t)),n}function He(n){return ri(n)?U:n}function Je(n,t,r,e,u,i){var o=r&Z,f=n.length,c=t.length;if(f!=c&&!(o&&c>f))return!1;var a=i.get(n);if(a&&i.get(t))return a==t;var l=-1,h=!0,p=r&K?new $t:U;for(i.set(n,t),i.set(t,n);++l<f;){var _=n[l],v=t[l];if(e)var g=o?e(v,_,l,t,n,i):e(_,v,l,n,t,i);if(g!==U){if(g)continue;h=!1;break}if(p){if(!s(t,function(n,t){if(!A(p,t)&&(_===n||u(_,n,r,e,i)))return p.push(t)})){h=!1;break}}else if(_!==v&&!u(_,v,r,e,i)){h=!1;break}}return i.delete(n),i.delete(t),h}function Ye(n){return uf(gu(n,U,Ou),n+"")}function Qe(n){return yr(n,_i,Qo)}function Xe(n){return yr(n,vi,Xo)}function nu(n){for(var t=n.name+"",r=Wo[t],e=Pi.call(Wo,t)?r.length:0;e--;){var u=r[e],i=u.func;if(null==i||i==n)return u.name}return t}function tu(n){return(Pi.call(St,"placeholder")?St:n).placeholder}function ru(){var n=St.iteratee||ji;return n=n===ji?Dr:n,arguments.length?n(arguments[0],arguments[1]):n}function eu(n,t){var r=n.__data__;return function(n){var t=typeof n;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n}(t)?r["string"==typeof t?"string":"hash"]:r.map}function uu(n){for(var t=_i(n),r=t.length;r--;){var e=t[r],u=n[e];t[r]=[e,u,_u(u)]}return t}function iu(n,t){var r=function(n,t){return null==n?U:n[t]}(n,t);return $r(r)?r:U}function ou(n,t,r){for(var e=-1,u=(t=ye(t,n)).length,i=!1;++e<u;){var o=mu(t[e]);if(!(i=null!=n&&r(n,o)))break;n=n[o]}return i||++e!=u?i:!!(u=null==n?0:n.length)&&Qu(u)&&au(o,u)&&(Zf(n)||qf(n))}function fu(n){return"function"!=typeof n.constructor||pu(n)?{}:Fo(no(n))}function cu(n){return Zf(n)||qf(n)||!!(uo&&n&&n[uo])}function au(n,t){return!!(t=null==t?sn:t)&&("number"==typeof n||Ot.test(n))&&n>-1&&n%1==0&&n<t}function lu(n,t,r){if(!Xu(r))return!1;var e=typeof t;return!!("number"==e?Vu(r)&&au(t,r.length):"string"==e&&t in r)&&Ku(r[t],n)}function su(n,t){if(Zf(n))return!1;var r=typeof n;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=n&&!ui(n))||ft.test(n)||!ot.test(n)||null!=t&&n in Ci(t)}function hu(n){var t=nu(n),r=St[t];if("function"!=typeof r||!(t in Ct.prototype))return!1;if(n===r)return!0;var e=Yo(r);return!!e&&n===e[0]}function pu(n){var t=n&&n.constructor;return n===("function"==typeof t&&t.prototype||Mi)}function _u(n){return n==n&&!Xu(n)}function vu(n,t){return function(r){return null!=r&&r[n]===t&&(t!==U||n in Ci(r))}}function gu(n,t,e){return t=bo(t===U?n.length-1:t,0),function(){for(var u=arguments,i=-1,o=bo(u.length-t,0),f=zi(o);++i<o;)f[i]=u[t+i];i=-1;for(var c=zi(t+1);++i<t;)c[i]=u[i];return c[t]=e(f),r(n,this,c)}}function yu(n,t){return t.length<2?n:vr(n,re(t,0,-1))}function du(n,t,r){var u=t+"";return uf(n,function(n,t){var r=t.length;if(!r)return n;var e=r-1;return t[e]=(r>1?"& ":"")+t[e],t=t.join(r>2?", ":" "),n.replace(vt,"{\n/* [wrapped with "+t+"] */\n")}(u,function(n,t){return e(yn,function(r){var e="_."+r[0];t&r[1]&&!o(n,e)&&n.push(e)}),n.sort()}(function(n){var t=n.match(gt);return t?t[1].split(yt):[]}(u),r)))}function bu(n){var t=0,r=0;return function(){var e=mo(),u=fn-(e-r);if(r=e,u>0){if(++t>=on)return arguments[0]}else t=0;return n.apply(U,arguments)}}function wu(n,t){var r=-1,e=n.length,u=e-1;for(t=t===U?e:t;++r<t;){var i=Qr(r,u),o=n[i];n[i]=n[r],n[r]=o}return n.length=t,n}function mu(n){if("string"==typeof n||ui(n))return n;var t=n+"";return"0"==t&&1/n==-ln?"-0":t}function xu(n){if(null!=n){try{return Ni.call(n)}catch(n){}try{return n+""}catch(n){}}return""}function ju(n){if(n instanceof Ct)return n.clone();var t=new Lt(n.__wrapped__,n.__chain__);return t.__actions__=ke(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}function Au(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=null==r?0:fi(r);return u<0&&(u=bo(e+u,0)),p(n,ru(t,3),u)}function ku(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=e-1;return r!==U&&(u=fi(r),u=r<0?bo(e+u,0):wo(u,e-1)),p(n,ru(t,3),u,!0)}function Ou(n){return null!=n&&n.length?er(n,1):[]}function Iu(n){return n&&n.length?n[0]:U}function Ru(n){var t=null==n?0:n.length;return t?n[t-1]:U}function zu(n,t){return n&&n.length&&t&&t.length?Jr(n,t):n}function Eu(n){return null==n?n:Ao.call(n)}function Su(n){if(!n||!n.length)return[];var t=0;return n=i(n,function(n){if(Gu(n))return t=bo(n.length,t),!0}),m(t,function(t){return c(n,y(t))})}function Wu(n,t){if(!n||!n.length)return[];var e=Su(n);return null==t?e:c(e,function(n){return r(t,U,n)})}function Lu(n){var t=St(n);return t.__chain__=!0,t}function Cu(n,t){return t(n)}function Uu(){return this}function Bu(n,t){return(Zf(n)?e:No)(n,ru(t,3))}function Tu(n,t){return(Zf(n)?function(n,t){for(var r=null==n?0:n.length;r--&&!1!==t(n[r],r,n););return n}:Po)(n,ru(t,3))}function $u(n,t){return(Zf(n)?c:Pr)(n,ru(t,3))}function Du(n,t,r){return t=r?U:t,t=n&&null==t?n.length:t,Ke(n,nn,U,U,U,U,t)}function Mu(n,t){var r;if("function"!=typeof t)throw new Ti($);return n=fi(n),function(){return--n>0&&(r=t.apply(this,arguments)),n<=1&&(t=U),r}}function Fu(n,t,r){var e=Ke(n,J,U,U,U,U,U,t=r?U:t);return e.placeholder=Fu.placeholder,e}function Nu(n,t,r){var e=Ke(n,Y,U,U,U,U,U,t=r?U:t);return e.placeholder=Nu.placeholder,e}function Pu(n,t,r){function e(t){var r=c,e=a;return c=a=U,_=t,s=n.apply(e,r)}function u(n){var r=n-p;return p===U||r>=t||r<0||g&&n-_>=l}function i(){var n=Lf();if(u(n))return o(n);h=ef(i,function(n){var r=t-(n-p);return g?wo(r,l-(n-_)):r}(n))}function o(n){return h=U,y&&c?e(n):(c=a=U,s)}function f(){var n=Lf(),r=u(n);if(c=arguments,a=this,p=n,r){if(h===U)return function(n){return _=n,h=ef(i,t),v?e(n):s}(p);if(g)return h=ef(i,t),e(p)}return h===U&&(h=ef(i,t)),s}var c,a,l,s,h,p,_=0,v=!1,g=!1,y=!0;if("function"!=typeof n)throw new Ti($);return t=ai(t)||0,Xu(r)&&(v=!!r.leading,l=(g="maxWait"in r)?bo(ai(r.maxWait)||0,t):l,y="trailing"in r?!!r.trailing:y),f.cancel=function(){h!==U&&Ho(h),_=0,c=p=a=h=U},f.flush=function(){return h===U?s:o(Lf())},f}function qu(n,t){if("function"!=typeof n||null!=t&&"function"!=typeof t)throw new Ti($);var r=function(){var e=arguments,u=t?t.apply(this,e):e[0],i=r.cache;if(i.has(u))return i.get(u);var o=n.apply(this,e);return r.cache=i.set(u,o)||i,o};return r.cache=new(qu.Cache||Tt),r}function Zu(n){if("function"!=typeof n)throw new Ti($);return function(){var t=arguments;switch(t.length){case 0:return!n.call(this);case 1:return!n.call(this,t[0]);case 2:return!n.call(this,t[0],t[1]);case 3:return!n.call(this,t[0],t[1],t[2])}return!n.apply(this,t)}}function Ku(n,t){return n===t||n!=n&&t!=t}function Vu(n){return null!=n&&Qu(n.length)&&!Ju(n)}function Gu(n){return ni(n)&&Vu(n)}function Hu(n){if(!ni(n))return!1;var t=dr(n);return t==An||t==jn||"string"==typeof n.message&&"string"==typeof n.name&&!ri(n)}function Ju(n){if(!Xu(n))return!1;var t=dr(n);return t==kn||t==On||t==wn||t==Sn}function Yu(n){return"number"==typeof n&&n==fi(n)}function Qu(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=sn}function Xu(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}function ni(n){return null!=n&&"object"==typeof n}function ti(n){return"number"==typeof n||ni(n)&&dr(n)==Rn}function ri(n){if(!ni(n)||dr(n)!=En)return!1;var t=no(n);if(null===t)return!0;var r=Pi.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Ni.call(r)==Vi}function ei(n){return"string"==typeof n||!Zf(n)&&ni(n)&&dr(n)==Cn}function ui(n){return"symbol"==typeof n||ni(n)&&dr(n)==Un}function ii(n){if(!n)return[];if(Vu(n))return ei(n)?C(n):ke(n);if(io&&n[io])return function(n){for(var t,r=[];!(t=n.next()).done;)r.push(t.value);return r}(n[io]());var t=nf(n);return(t==In?z:t==Ln?W:yi)(n)}function oi(n){return n?(n=ai(n))===ln||n===-ln?(n<0?-1:1)*hn:n==n?n:0:0===n?n:0}function fi(n){var t=oi(n),r=t%1;return t==t?r?t-r:t:0}function ci(n){return n?Gt(fi(n),0,_n):0}function ai(n){if("number"==typeof n)return n;if(ui(n))return pn;if(Xu(n)){var t="function"==typeof n.valueOf?n.valueOf():n;n=Xu(t)?t+"":t}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(ht,"");var r=jt.test(n);return r||kt.test(n)?pr(n.slice(2),r?2:8):xt.test(n)?pn:+n}function li(n){return Oe(n,vi(n))}function si(n){return null==n?"":fe(n)}function hi(n,t,r){var e=null==n?U:vr(n,t);return e===U?r:e}function pi(n,t){return null!=n&&ou(n,t,Rr)}function _i(n){return Vu(n)?Mt(n):Mr(n)}function vi(n){return Vu(n)?Mt(n,!0):Fr(n)}function gi(n,t){if(null==n)return{};var r=c(Xe(n),function(n){return[n]});return t=ru(t),Hr(n,r,function(n,r){return t(n,r[0])})}function yi(n){return null==n?[]:j(n,_i(n))}function di(n){return Ac(si(n).toLowerCase())}function bi(n){return(n=si(n))&&n.replace(It,zr).replace(rr,"")}function wi(n,t,r){return n=si(n),(t=r?U:t)===U?function(n){return or.test(n)}(n)?function(n){return n.match(ur)||[]}(n):function(n){return n.match(dt)||[]}(n):n.match(t)||[]}function mi(n){return function(){return n}}function xi(n){return n}function ji(n){return Dr("function"==typeof n?n:Ht(n,N))}function Ai(n,t,r){var u=_i(t),i=_r(t,u);null!=r||Xu(t)&&(i.length||!u.length)||(r=t,t=n,n=this,i=_r(t,_i(t)));var o=!(Xu(r)&&"chain"in r&&!r.chain),f=Ju(n);return e(i,function(r){var e=t[r];n[r]=e,f&&(n.prototype[r]=function(){var t=this.__chain__;if(o||t){var r=n(this.__wrapped__);return(r.__actions__=ke(this.__actions__)).push({func:e,args:arguments,thisArg:n}),r.__chain__=t,r}return e.apply(n,a([this.value()],arguments))})}),n}function ki(){}function Oi(n){return su(n)?y(mu(n)):function(n){return function(t){return vr(t,n)}}(n)}function Ii(){return[]}function Ri(){return!1}var zi=(Et=null==Et?gr:Wr.defaults(gr.Object(),Et,Wr.pick(gr,fr))).Array,Ei=Et.Date,Si=Et.Error,Wi=Et.Function,Li=Et.Math,Ci=Et.Object,Ui=Et.RegExp,Bi=Et.String,Ti=Et.TypeError,$i=zi.prototype,Di=Wi.prototype,Mi=Ci.prototype,Fi=Et["__core-js_shared__"],Ni=Di.toString,Pi=Mi.hasOwnProperty,qi=0,Zi=function(){var n=/[^.]+$/.exec(Fi&&Fi.keys&&Fi.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),Ki=Mi.toString,Vi=Ni.call(Ci),Gi=gr._,Hi=Ui("^"+Ni.call(Pi).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ji=br?Et.Buffer:U,Yi=Et.Symbol,Qi=Et.Uint8Array,Xi=Ji?Ji.allocUnsafe:U,no=E(Ci.getPrototypeOf,Ci),to=Ci.create,ro=Mi.propertyIsEnumerable,eo=$i.splice,uo=Yi?Yi.isConcatSpreadable:U,io=Yi?Yi.iterator:U,oo=Yi?Yi.toStringTag:U,fo=function(){try{var n=iu(Ci,"defineProperty");return n({},"",{}),n}catch(n){}}(),co=Et.clearTimeout!==gr.clearTimeout&&Et.clearTimeout,ao=Ei&&Ei.now!==gr.Date.now&&Ei.now,lo=Et.setTimeout!==gr.setTimeout&&Et.setTimeout,so=Li.ceil,ho=Li.floor,po=Ci.getOwnPropertySymbols,_o=Ji?Ji.isBuffer:U,vo=Et.isFinite,go=$i.join,yo=E(Ci.keys,Ci),bo=Li.max,wo=Li.min,mo=Ei.now,xo=Et.parseInt,jo=Li.random,Ao=$i.reverse,ko=iu(Et,"DataView"),Oo=iu(Et,"Map"),Io=iu(Et,"Promise"),Ro=iu(Et,"Set"),zo=iu(Et,"WeakMap"),Eo=iu(Ci,"create"),So=zo&&new zo,Wo={},Lo=xu(ko),Co=xu(Oo),Uo=xu(Io),Bo=xu(Ro),To=xu(zo),$o=Yi?Yi.prototype:U,Do=$o?$o.valueOf:U,Mo=$o?$o.toString:U,Fo=function(){function n(){}return function(t){if(!Xu(t))return{};if(to)return to(t);n.prototype=t;var r=new n;return n.prototype=U,r}}();St.templateSettings={escape:et,evaluate:ut,interpolate:it,variable:"",imports:{_:St}},(St.prototype=Wt.prototype).constructor=St,(Lt.prototype=Fo(Wt.prototype)).constructor=Lt,(Ct.prototype=Fo(Wt.prototype)).constructor=Ct,Ut.prototype.clear=function(){this.__data__=Eo?Eo(null):{},this.size=0},Ut.prototype.delete=function(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t},Ut.prototype.get=function(n){var t=this.__data__;if(Eo){var r=t[n];return r===D?U:r}return Pi.call(t,n)?t[n]:U},Ut.prototype.has=function(n){var t=this.__data__;return Eo?t[n]!==U:Pi.call(t,n)},Ut.prototype.set=function(n,t){var r=this.__data__;return this.size+=this.has(n)?0:1,r[n]=Eo&&t===U?D:t,this},Bt.prototype.clear=function(){this.__data__=[],this.size=0},Bt.prototype.delete=function(n){var t=this.__data__,r=qt(t,n);return!(r<0||(r==t.length-1?t.pop():eo.call(t,r,1),--this.size,0))},Bt.prototype.get=function(n){var t=this.__data__,r=qt(t,n);return r<0?U:t[r][1]},Bt.prototype.has=function(n){return qt(this.__data__,n)>-1},Bt.prototype.set=function(n,t){var r=this.__data__,e=qt(r,n);return e<0?(++this.size,r.push([n,t])):r[e][1]=t,this},Tt.prototype.clear=function(){this.size=0,this.__data__={hash:new Ut,map:new(Oo||Bt),string:new Ut}},Tt.prototype.delete=function(n){var t=eu(this,n).delete(n);return this.size-=t?1:0,t},Tt.prototype.get=function(n){return eu(this,n).get(n)},Tt.prototype.has=function(n){return eu(this,n).has(n)},Tt.prototype.set=function(n,t){var r=eu(this,n),e=r.size;return r.set(n,t),this.size+=r.size==e?0:1,this},$t.prototype.add=$t.prototype.push=function(n){return this.__data__.set(n,D),this},$t.prototype.has=function(n){return this.__data__.has(n)},Dt.prototype.clear=function(){this.__data__=new Bt,this.size=0},Dt.prototype.delete=function(n){var t=this.__data__,r=t.delete(n);return this.size=t.size,r},Dt.prototype.get=function(n){return this.__data__.get(n)},Dt.prototype.has=function(n){return this.__data__.has(n)},Dt.prototype.set=function(n,t){var r=this.__data__;if(r instanceof Bt){var e=r.__data__;if(!Oo||e.length<B-1)return e.push([n,t]),this.size=++r.size,this;r=this.__data__=new Tt(e)}return r.set(n,t),this.size=r.size,this};var No=ze(ir),Po=ze(sr,!0),qo=Ee(),Zo=Ee(!0),Ko=So?function(n,t){return So.set(n,t),n}:xi,Vo=fo?function(n,t){return fo(n,"toString",{configurable:!0,enumerable:!1,value:mi(t),writable:!0})}:xi,Go=ne,Ho=co||function(n){return gr.clearTimeout(n)},Jo=Ro&&1/W(new Ro([,-0]))[1]==ln?function(n){return new Ro(n)}:ki,Yo=So?function(n){return So.get(n)}:ki,Qo=po?function(n){return null==n?[]:(n=Ci(n),i(po(n),function(t){return ro.call(n,t)}))}:Ii,Xo=po?function(n){for(var t=[];n;)a(t,Qo(n)),n=no(n);return t}:Ii,nf=dr;(ko&&nf(new ko(new ArrayBuffer(1)))!=Mn||Oo&&nf(new Oo)!=In||Io&&"[object Promise]"!=nf(Io.resolve())||Ro&&nf(new Ro)!=Ln||zo&&nf(new zo)!=Tn)&&(nf=function(n){var t=dr(n),r=t==En?n.constructor:U,e=r?xu(r):"";if(e)switch(e){case Lo:return Mn;case Co:return In;case Uo:return"[object Promise]";case Bo:return Ln;case To:return Tn}return t});var tf=Fi?Ju:Ri,rf=bu(Ko),ef=lo||function(n,t){return gr.setTimeout(n,t)},uf=bu(Vo),of=function(n){var t=qu(n,function(n){return r.size===M&&r.clear(),n}),r=t.cache;return t}(function(n){var t=[];return ct.test(n)&&t.push(""),n.replace(at,function(n,r,e,u){t.push(e?u.replace(bt,"$1"):r||n)}),t}),ff=ne(function(n,t){return Gu(n)?Qt(n,er(t,1,Gu,!0)):[]}),cf=ne(function(n,t){var r=Ru(t);return Gu(r)&&(r=U),Gu(n)?Qt(n,er(t,1,Gu,!0),ru(r,2)):[]}),af=ne(function(n,t){var r=Ru(t);return Gu(r)&&(r=U),Gu(n)?Qt(n,er(t,1,Gu,!0),U,r):[]}),lf=ne(function(n){var t=c(n,ve);return t.length&&t[0]===n[0]?Lr(t):[]}),sf=ne(function(n){var t=Ru(n),r=c(n,ve);return t===Ru(r)?t=U:r.pop(),r.length&&r[0]===n[0]?Lr(r,ru(t,2)):[]}),hf=ne(function(n){var t=Ru(n),r=c(n,ve);return(t="function"==typeof t?t:U)&&r.pop(),r.length&&r[0]===n[0]?Lr(r,U,t):[]}),pf=ne(zu),_f=Ye(function(n,t){var r=null==n?0:n.length,e=Vt(n,t);return Yr(n,c(t,function(n){return au(n,r)?+n:n}).sort(xe)),e}),vf=ne(function(n){return ce(er(n,1,Gu,!0))}),gf=ne(function(n){var t=Ru(n);return Gu(t)&&(t=U),ce(er(n,1,Gu,!0),ru(t,2))}),yf=ne(function(n){var t=Ru(n);return t="function"==typeof t?t:U,ce(er(n,1,Gu,!0),U,t)}),df=ne(function(n,t){return Gu(n)?Qt(n,t):[]}),bf=ne(function(n){return pe(i(n,Gu))}),wf=ne(function(n){var t=Ru(n);return Gu(t)&&(t=U),pe(i(n,Gu),ru(t,2))}),mf=ne(function(n){var t=Ru(n);return t="function"==typeof t?t:U,pe(i(n,Gu),U,t)}),xf=ne(Su),jf=ne(function(n){var t=n.length,r=t>1?n[t-1]:U;return r="function"==typeof r?(n.pop(),r):U,Wu(n,r)}),Af=Ye(function(n){var t=n.length,r=t?n[0]:0,e=this.__wrapped__,u=function(t){return Vt(t,n)};return!(t>1||this.__actions__.length)&&e instanceof Ct&&au(r)?((e=e.slice(r,+r+(t?1:0))).__actions__.push({func:Cu,args:[u],thisArg:U}),new Lt(e,this.__chain__).thru(function(n){return t&&!n.length&&n.push(U),n})):this.thru(u)}),kf=Ie(function(n,t,r){Pi.call(n,r)?++n[r]:Kt(n,r,1)}),Of=Ce(Au),If=Ce(ku),Rf=Ie(function(n,t,r){Pi.call(n,r)?n[r].push(t):Kt(n,r,[t])}),zf=ne(function(n,t,e){var u=-1,i="function"==typeof t,o=Vu(n)?zi(n.length):[];return No(n,function(n){o[++u]=i?r(t,n,e):Cr(n,t,e)}),o}),Ef=Ie(function(n,t,r){Kt(n,r,t)}),Sf=Ie(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),Wf=ne(function(n,t){if(null==n)return[];var r=t.length;return r>1&&lu(n,t[0],t[1])?t=[]:r>2&&lu(t[0],t[1],t[2])&&(t=[t[0]]),Gr(n,er(t,1),[])}),Lf=ao||function(){return gr.Date.now()},Cf=ne(function(n,t,r){var e=V;if(r.length){var u=S(r,tu(Cf));e|=Q}return Ke(n,e,t,r,u)}),Uf=ne(function(n,t,r){var e=V|G;if(r.length){var u=S(r,tu(Uf));e|=Q}return Ke(t,e,n,r,u)}),Bf=ne(function(n,t){return Yt(n,1,t)}),Tf=ne(function(n,t,r){return Yt(n,ai(t)||0,r)});qu.Cache=Tt;var $f=Go(function(n,t){var e=(t=1==t.length&&Zf(t[0])?c(t[0],x(ru())):c(er(t,1),x(ru()))).length;return ne(function(u){for(var i=-1,o=wo(u.length,e);++i<o;)u[i]=t[i].call(this,u[i]);return r(n,this,u)})}),Df=ne(function(n,t){var r=S(t,tu(Df));return Ke(n,Q,U,t,r)}),Mf=ne(function(n,t){var r=S(t,tu(Mf));return Ke(n,X,U,t,r)}),Ff=Ye(function(n,t){return Ke(n,tn,U,U,U,t)}),Nf=Ne(wr),Pf=Ne(function(n,t){return n>=t}),qf=Ur(function(){return arguments}())?Ur:function(n){return ni(n)&&Pi.call(n,"callee")&&!ro.call(n,"callee")},Zf=zi.isArray,Kf=xr?x(xr):function(n){return ni(n)&&dr(n)==Dn},Vf=_o||Ri,Gf=jr?x(jr):function(n){return ni(n)&&dr(n)==xn},Hf=Ar?x(Ar):function(n){return ni(n)&&nf(n)==In},Jf=kr?x(kr):function(n){return ni(n)&&dr(n)==Wn},Yf=Or?x(Or):function(n){return ni(n)&&nf(n)==Ln},Qf=Ir?x(Ir):function(n){return ni(n)&&Qu(n.length)&&!!ar[dr(n)]},Xf=Ne(Nr),nc=Ne(function(n,t){return n<=t}),tc=Re(function(n,t){if(pu(t)||Vu(t))Oe(t,_i(t),n);else for(var r in t)Pi.call(t,r)&&Pt(n,r,t[r])}),rc=Re(function(n,t){Oe(t,vi(t),n)}),ec=Re(function(n,t,r,e){Oe(t,vi(t),n,e)}),uc=Re(function(n,t,r,e){Oe(t,_i(t),n,e)}),ic=Ye(Vt),oc=ne(function(n){return n.push(U,Ve),r(ec,U,n)}),fc=ne(function(n){return n.push(U,Ge),r(hc,U,n)}),cc=Te(function(n,t,r){n[t]=r},mi(xi)),ac=Te(function(n,t,r){Pi.call(n,t)?n[t].push(r):n[t]=[r]},ru),lc=ne(Cr),sc=Re(function(n,t,r){Kr(n,t,r)}),hc=Re(function(n,t,r,e){Kr(n,t,r,e)}),pc=Ye(function(n,t){var r={};if(null==n)return r;var e=!1;t=c(t,function(t){return t=ye(t,n),e||(e=t.length>1),t}),Oe(n,Xe(n),r),e&&(r=Ht(r,N|P|q,He));for(var u=t.length;u--;)ae(r,t[u]);return r}),_c=Ye(function(n,t){return null==n?{}:function(n,t){return Hr(n,t,function(t,r){return pi(n,r)})}(n,t)}),vc=Ze(_i),gc=Ze(vi),yc=We(function(n,t,r){return t=t.toLowerCase(),n+(r?di(t):t)}),dc=We(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),bc=We(function(n,t,r){return n+(r?" ":"")+t.toLowerCase()}),wc=Se("toLowerCase"),mc=We(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),xc=We(function(n,t,r){return n+(r?" ":"")+Ac(t)}),jc=We(function(n,t,r){return n+(r?" ":"")+t.toUpperCase()}),Ac=Se("toUpperCase"),kc=ne(function(n,t){try{return r(n,U,t)}catch(n){return Hu(n)?n:new Si(n)}}),Oc=Ye(function(n,t){return e(t,function(t){t=mu(t),Kt(n,t,Cf(n[t],n))}),n}),Ic=Ue(),Rc=Ue(!0),zc=ne(function(n,t){return function(r){return Cr(r,n,t)}}),Ec=ne(function(n,t){return function(r){return Cr(n,r,t)}}),Sc=De(c),Wc=De(u),Lc=De(s),Cc=Fe(),Uc=Fe(!0),Bc=$e(function(n,t){return n+t},0),Tc=qe("ceil"),$c=$e(function(n,t){return n/t},1),Dc=qe("floor"),Mc=$e(function(n,t){return n*t},1),Fc=qe("round"),Nc=$e(function(n,t){return n-t},0);return St.after=function(n,t){if("function"!=typeof t)throw new Ti($);return n=fi(n),function(){if(--n<1)return t.apply(this,arguments)}},St.ary=Du,St.assign=tc,St.assignIn=rc,St.assignInWith=ec,St.assignWith=uc,St.at=ic,St.before=Mu,St.bind=Cf,St.bindAll=Oc,St.bindKey=Uf,St.castArray=function(){if(!arguments.length)return[];var n=arguments[0];return Zf(n)?n:[n]},St.chain=Lu,St.chunk=function(n,t,r){t=(r?lu(n,t,r):t===U)?1:bo(fi(t),0);var e=null==n?0:n.length;if(!e||t<1)return[];for(var u=0,i=0,o=zi(so(e/t));u<e;)o[i++]=re(n,u,u+=t);return o},St.compact=function(n){for(var t=-1,r=null==n?0:n.length,e=0,u=[];++t<r;){var i=n[t];i&&(u[e++]=i)}return u},St.concat=function(){var n=arguments.length;if(!n)return[];for(var t=zi(n-1),r=arguments[0],e=n;e--;)t[e-1]=arguments[e];return a(Zf(r)?ke(r):[r],er(t,1))},St.cond=function(n){var t=null==n?0:n.length,e=ru();return n=t?c(n,function(n){if("function"!=typeof n[1])throw new Ti($);return[e(n[0]),n[1]]}):[],ne(function(e){for(var u=-1;++u<t;){var i=n[u];if(r(i[0],this,e))return r(i[1],this,e)}})},St.conforms=function(n){return function(n){var t=_i(n);return function(r){return Jt(r,n,t)}}(Ht(n,N))},St.constant=mi,St.countBy=kf,St.create=function(n,t){var r=Fo(n);return null==t?r:Zt(r,t)},St.curry=Fu,St.curryRight=Nu,St.debounce=Pu,St.defaults=oc,St.defaultsDeep=fc,St.defer=Bf,St.delay=Tf,St.difference=ff,St.differenceBy=cf,St.differenceWith=af,St.drop=function(n,t,r){var e=null==n?0:n.length;return e?(t=r||t===U?1:fi(t),re(n,t<0?0:t,e)):[]},St.dropRight=function(n,t,r){var e=null==n?0:n.length;return e?(t=r||t===U?1:fi(t),t=e-t,re(n,0,t<0?0:t)):[]},St.dropRightWhile=function(n,t){return n&&n.length?se(n,ru(t,3),!0,!0):[]},St.dropWhile=function(n,t){return n&&n.length?se(n,ru(t,3),!0):[]},St.fill=function(n,t,r,e){var u=null==n?0:n.length;return u?(r&&"number"!=typeof r&&lu(n,t,r)&&(r=0,e=u),function(n,t,r,e){var u=n.length;for((r=fi(r))<0&&(r=-r>u?0:u+r),(e=e===U||e>u?u:fi(e))<0&&(e+=u),e=r>e?0:ci(e);r<e;)n[r++]=t;return n}(n,t,r,e)):[]},St.filter=function(n,t){return(Zf(n)?i:nr)(n,ru(t,3))},St.flatMap=function(n,t){return er($u(n,t),1)},St.flatMapDeep=function(n,t){return er($u(n,t),ln)},St.flatMapDepth=function(n,t,r){return r=r===U?1:fi(r),er($u(n,t),r)},St.flatten=Ou,St.flattenDeep=function(n){return null!=n&&n.length?er(n,ln):[]},St.flattenDepth=function(n,t){return null!=n&&n.length?(t=t===U?1:fi(t),er(n,t)):[]},St.flip=function(n){return Ke(n,rn)},St.flow=Ic,St.flowRight=Rc,St.fromPairs=function(n){for(var t=-1,r=null==n?0:n.length,e={};++t<r;){var u=n[t];e[u[0]]=u[1]}return e},St.functions=function(n){return null==n?[]:_r(n,_i(n))},St.functionsIn=function(n){return null==n?[]:_r(n,vi(n))},St.groupBy=Rf,St.initial=function(n){return null!=n&&n.length?re(n,0,-1):[]},St.intersection=lf,St.intersectionBy=sf,St.intersectionWith=hf,St.invert=cc,St.invertBy=ac,St.invokeMap=zf,St.iteratee=ji,St.keyBy=Ef,St.keys=_i,St.keysIn=vi,St.map=$u,St.mapKeys=function(n,t){var r={};return t=ru(t,3),ir(n,function(n,e,u){Kt(r,t(n,e,u),n)}),r},St.mapValues=function(n,t){var r={};return t=ru(t,3),ir(n,function(n,e,u){Kt(r,e,t(n,e,u))}),r},St.matches=function(n){return qr(Ht(n,N))},St.matchesProperty=function(n,t){return Zr(n,Ht(t,N))},St.memoize=qu,St.merge=sc,St.mergeWith=hc,St.method=zc,St.methodOf=Ec,St.mixin=Ai,St.negate=Zu,St.nthArg=function(n){return n=fi(n),ne(function(t){return Vr(t,n)})},St.omit=pc,St.omitBy=function(n,t){return gi(n,Zu(ru(t)))},St.once=function(n){return Mu(2,n)},St.orderBy=function(n,t,r,e){return null==n?[]:(Zf(t)||(t=null==t?[]:[t]),r=e?U:r,Zf(r)||(r=null==r?[]:[r]),Gr(n,t,r))},St.over=Sc,St.overArgs=$f,St.overEvery=Wc,St.overSome=Lc,St.partial=Df,St.partialRight=Mf,St.partition=Sf,St.pick=_c,St.pickBy=gi,St.property=Oi,St.propertyOf=function(n){return function(t){return null==n?U:vr(n,t)}},St.pull=pf,St.pullAll=zu,St.pullAllBy=function(n,t,r){return n&&n.length&&t&&t.length?Jr(n,t,ru(r,2)):n},St.pullAllWith=function(n,t,r){return n&&n.length&&t&&t.length?Jr(n,t,U,r):n},St.pullAt=_f,St.range=Cc,St.rangeRight=Uc,St.rearg=Ff,St.reject=function(n,t){return(Zf(n)?i:nr)(n,Zu(ru(t,3)))},St.remove=function(n,t){var r=[];if(!n||!n.length)return r;var e=-1,u=[],i=n.length;for(t=ru(t,3);++e<i;){var o=n[e];t(o,e,n)&&(r.push(o),u.push(e))}return Yr(n,u),r},St.rest=function(n,t){if("function"!=typeof n)throw new Ti($);return t=t===U?t:fi(t),ne(n,t)},St.reverse=Eu,St.sampleSize=function(n,t,r){return t=(r?lu(n,t,r):t===U)?1:fi(t),(Zf(n)?function(n,t){return wu(ke(n),Gt(t,0,n.length))}:function(n,t){var r=yi(n);return wu(r,Gt(t,0,r.length))})(n,t)},St.set=function(n,t,r){return null==n?n:te(n,t,r)},St.setWith=function(n,t,r,e){return e="function"==typeof e?e:U,null==n?n:te(n,t,r,e)},St.shuffle=function(n){return(Zf(n)?function(n){return wu(ke(n))}:function(n){return wu(yi(n))})(n)},St.slice=function(n,t,r){var e=null==n?0:n.length;return e?(r&&"number"!=typeof r&&lu(n,t,r)?(t=0,r=e):(t=null==t?0:fi(t),r=r===U?e:fi(r)),re(n,t,r)):[]},St.sortBy=Wf,St.sortedUniq=function(n){return n&&n.length?ie(n):[]},St.sortedUniqBy=function(n,t){return n&&n.length?ie(n,ru(t,2)):[]},St.split=function(n,t,r){return r&&"number"!=typeof r&&lu(n,t,r)&&(t=r=U),(r=r===U?_n:r>>>0)?(n=si(n))&&("string"==typeof t||null!=t&&!Jf(t))&&!(t=fe(t))&&R(n)?de(C(n),0,r):n.split(t,r):[]},St.spread=function(n,t){if("function"!=typeof n)throw new Ti($);return t=null==t?0:bo(fi(t),0),ne(function(e){var u=e[t],i=de(e,0,t);return u&&a(i,u),r(n,this,i)})},St.tail=function(n){var t=null==n?0:n.length;return t?re(n,1,t):[]},St.take=function(n,t,r){return n&&n.length?(t=r||t===U?1:fi(t),re(n,0,t<0?0:t)):[]},St.takeRight=function(n,t,r){var e=null==n?0:n.length;return e?(t=r||t===U?1:fi(t),t=e-t,re(n,t<0?0:t,e)):[]},St.takeRightWhile=function(n,t){return n&&n.length?se(n,ru(t,3),!1,!0):[]},St.takeWhile=function(n,t){return n&&n.length?se(n,ru(t,3)):[]},St.tap=function(n,t){return t(n),n},St.throttle=function(n,t,r){var e=!0,u=!0;if("function"!=typeof n)throw new Ti($);return Xu(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),Pu(n,t,{leading:e,maxWait:t,trailing:u})},St.thru=Cu,St.toArray=ii,St.toPairs=vc,St.toPairsIn=gc,St.toPath=function(n){return Zf(n)?c(n,mu):ui(n)?[n]:ke(of(si(n)))},St.toPlainObject=li,St.transform=function(n,t,r){var u=Zf(n),i=u||Vf(n)||Qf(n);if(t=ru(t,4),null==r){var o=n&&n.constructor;r=i?u?new o:[]:Xu(n)&&Ju(o)?Fo(no(n)):{}}return(i?e:ir)(n,function(n,e,u){return t(r,n,e,u)}),r},St.unary=function(n){return Du(n,1)},St.union=vf,St.unionBy=gf,St.unionWith=yf,St.uniq=function(n){return n&&n.length?ce(n):[]},St.uniqBy=function(n,t){return n&&n.length?ce(n,ru(t,2)):[]},St.uniqWith=function(n,t){return t="function"==typeof t?t:U,n&&n.length?ce(n,U,t):[]},St.unset=function(n,t){return null==n||ae(n,t)},St.unzip=Su,St.unzipWith=Wu,St.update=function(n,t,r){return null==n?n:le(n,t,ge(r))},St.updateWith=function(n,t,r,e){return e="function"==typeof e?e:U,null==n?n:le(n,t,ge(r),e)},St.values=yi,St.valuesIn=function(n){return null==n?[]:j(n,vi(n))},St.without=df,St.words=wi,St.wrap=function(n,t){return Df(ge(t),n)},St.xor=bf,St.xorBy=wf,St.xorWith=mf,St.zip=xf,St.zipObject=function(n,t){return _e(n||[],t||[],Pt)},St.zipObjectDeep=function(n,t){return _e(n||[],t||[],te)},St.zipWith=jf,St.entries=vc,St.entriesIn=gc,St.extend=rc,St.extendWith=ec,Ai(St,St),St.add=Bc,St.attempt=kc,St.camelCase=yc,St.capitalize=di,St.ceil=Tc,St.clamp=function(n,t,r){return r===U&&(r=t,t=U),r!==U&&(r=(r=ai(r))==r?r:0),t!==U&&(t=(t=ai(t))==t?t:0),Gt(ai(n),t,r)},St.clone=function(n){return Ht(n,q)},St.cloneDeep=function(n){return Ht(n,N|q)},St.cloneDeepWith=function(n,t){return t="function"==typeof t?t:U,Ht(n,N|q,t)},St.cloneWith=function(n,t){return t="function"==typeof t?t:U,Ht(n,q,t)},St.conformsTo=function(n,t){return null==t||Jt(n,t,_i(t))},St.deburr=bi,St.defaultTo=function(n,t){return null==n||n!=n?t:n},St.divide=$c,St.endsWith=function(n,t,r){n=si(n),t=fe(t);var e=n.length,u=r=r===U?e:Gt(fi(r),0,e);return(r-=t.length)>=0&&n.slice(r,u)==t},St.eq=Ku,St.escape=function(n){return(n=si(n))&&rt.test(n)?n.replace(nt,Er):n},St.escapeRegExp=function(n){return(n=si(n))&&st.test(n)?n.replace(lt,"\\$&"):n},St.every=function(n,t,r){var e=Zf(n)?u:function(n,t){var r=!0;return No(n,function(n,e,u){return r=!!t(n,e,u)}),r};return r&&lu(n,t,r)&&(t=U),e(n,ru(t,3))},St.find=Of,St.findIndex=Au,St.findKey=function(n,t){return h(n,ru(t,3),ir)},St.findLast=If,St.findLastIndex=ku,St.findLastKey=function(n,t){return h(n,ru(t,3),sr)},St.floor=Dc,St.forEach=Bu,St.forEachRight=Tu,St.forIn=function(n,t){return null==n?n:qo(n,ru(t,3),vi)},St.forInRight=function(n,t){return null==n?n:Zo(n,ru(t,3),vi)},St.forOwn=function(n,t){return n&&ir(n,ru(t,3))},St.forOwnRight=function(n,t){return n&&sr(n,ru(t,3))},St.get=hi,St.gt=Nf,St.gte=Pf,St.has=function(n,t){return null!=n&&ou(n,t,mr)},St.hasIn=pi,St.head=Iu,St.identity=xi,St.includes=function(n,t,r,e){n=Vu(n)?n:yi(n),r=r&&!e?fi(r):0;var u=n.length;return r<0&&(r=bo(u+r,0)),ei(n)?r<=u&&n.indexOf(t,r)>-1:!!u&&_(n,t,r)>-1},St.indexOf=function(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=null==r?0:fi(r);return u<0&&(u=bo(e+u,0)),_(n,t,u)},St.inRange=function(n,t,r){return t=oi(t),r===U?(r=t,t=0):r=oi(r),n=ai(n),function(n,t,r){return n>=wo(t,r)&&n<bo(t,r)}(n,t,r)},St.invoke=lc,St.isArguments=qf,St.isArray=Zf,St.isArrayBuffer=Kf,St.isArrayLike=Vu,St.isArrayLikeObject=Gu,St.isBoolean=function(n){return!0===n||!1===n||ni(n)&&dr(n)==mn},St.isBuffer=Vf,St.isDate=Gf,St.isElement=function(n){return ni(n)&&1===n.nodeType&&!ri(n)},St.isEmpty=function(n){if(null==n)return!0;if(Vu(n)&&(Zf(n)||"string"==typeof n||"function"==typeof n.splice||Vf(n)||Qf(n)||qf(n)))return!n.length;var t=nf(n);if(t==In||t==Ln)return!n.size;if(pu(n))return!Mr(n).length;for(var r in n)if(Pi.call(n,r))return!1;return!0},St.isEqual=function(n,t){return Br(n,t)},St.isEqualWith=function(n,t,r){var e=(r="function"==typeof r?r:U)?r(n,t):U;return e===U?Br(n,t,U,r):!!e},St.isError=Hu,St.isFinite=function(n){return"number"==typeof n&&vo(n)},St.isFunction=Ju,St.isInteger=Yu,St.isLength=Qu,St.isMap=Hf,St.isMatch=function(n,t){return n===t||Tr(n,t,uu(t))},St.isMatchWith=function(n,t,r){return r="function"==typeof r?r:U,Tr(n,t,uu(t),r)},St.isNaN=function(n){return ti(n)&&n!=+n},St.isNative=function(n){if(tf(n))throw new Si(T);return $r(n)},St.isNil=function(n){return null==n},St.isNull=function(n){return null===n},St.isNumber=ti,St.isObject=Xu,St.isObjectLike=ni,St.isPlainObject=ri,St.isRegExp=Jf,St.isSafeInteger=function(n){return Yu(n)&&n>=-sn&&n<=sn},St.isSet=Yf,St.isString=ei,St.isSymbol=ui,St.isTypedArray=Qf,St.isUndefined=function(n){return n===U},St.isWeakMap=function(n){return ni(n)&&nf(n)==Tn},St.isWeakSet=function(n){return ni(n)&&dr(n)==$n},St.join=function(n,t){return null==n?"":go.call(n,t)},St.kebabCase=dc,St.last=Ru,St.lastIndexOf=function(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=e;return r!==U&&(u=(u=fi(r))<0?bo(e+u,0):wo(u,e-1)),t==t?function(n,t,r){for(var e=r+1;e--;)if(n[e]===t)return e;return e}(n,t,u):p(n,v,u,!0)},St.lowerCase=bc,St.lowerFirst=wc,St.lt=Xf,St.lte=nc,St.max=function(n){return n&&n.length?Xt(n,xi,wr):U},St.maxBy=function(n,t){return n&&n.length?Xt(n,ru(t,2),wr):U},St.mean=function(n){return g(n,xi)},St.meanBy=function(n,t){return g(n,ru(t,2))},St.min=function(n){return n&&n.length?Xt(n,xi,Nr):U},St.minBy=function(n,t){return n&&n.length?Xt(n,ru(t,2),Nr):U},St.stubArray=Ii,St.stubFalse=Ri,St.stubObject=function(){return{}},St.stubString=function(){return""},St.stubTrue=function(){return!0},St.multiply=Mc,St.nth=function(n,t){return n&&n.length?Vr(n,fi(t)):U},St.noConflict=function(){return gr._===this&&(gr._=Gi),this},St.noop=ki,St.now=Lf,St.pad=function(n,t,r){n=si(n);var e=(t=fi(t))?L(n):0;if(!t||e>=t)return n;var u=(t-e)/2;return Me(ho(u),r)+n+Me(so(u),r)},St.padEnd=function(n,t,r){n=si(n);var e=(t=fi(t))?L(n):0;return t&&e<t?n+Me(t-e,r):n},St.padStart=function(n,t,r){n=si(n);var e=(t=fi(t))?L(n):0;return t&&e<t?Me(t-e,r)+n:n},St.parseInt=function(n,t,r){return r||null==t?t=0:t&&(t=+t),xo(si(n).replace(pt,""),t||0)},St.random=function(n,t,r){if(r&&"boolean"!=typeof r&&lu(n,t,r)&&(t=r=U),r===U&&("boolean"==typeof t?(r=t,t=U):"boolean"==typeof n&&(r=n,n=U)),n===U&&t===U?(n=0,t=1):(n=oi(n),t===U?(t=n,n=0):t=oi(t)),n>t){var e=n;n=t,t=e}if(r||n%1||t%1){var u=jo();return wo(n+u*(t-n+hr("1e-"+((u+"").length-1))),t)}return Qr(n,t)},St.reduce=function(n,t,r){var e=Zf(n)?l:b,u=arguments.length<3;return e(n,ru(t,4),r,u,No)},St.reduceRight=function(n,t,r){var e=Zf(n)?function(n,t,r,e){var u=null==n?0:n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r}:b,u=arguments.length<3;return e(n,ru(t,4),r,u,Po)},St.repeat=function(n,t,r){return t=(r?lu(n,t,r):t===U)?1:fi(t),Xr(si(n),t)},St.replace=function(){var n=arguments,t=si(n[0]);return n.length<3?t:t.replace(n[1],n[2])},St.result=function(n,t,r){var e=-1,u=(t=ye(t,n)).length;for(u||(u=1,n=U);++e<u;){var i=null==n?U:n[mu(t[e])];i===U&&(e=u,i=r),n=Ju(i)?i.call(n):i}return n},St.round=Fc,St.runInContext=d,St.sample=function(n){return(Zf(n)?Ft:function(n){return Ft(yi(n))})(n)},St.size=function(n){if(null==n)return 0;if(Vu(n))return ei(n)?L(n):n.length;var t=nf(n);return t==In||t==Ln?n.size:Mr(n).length},St.snakeCase=mc,St.some=function(n,t,r){var e=Zf(n)?s:function(n,t){var r;return No(n,function(n,e,u){return!(r=t(n,e,u))}),!!r};return r&&lu(n,t,r)&&(t=U),e(n,ru(t,3))},St.sortedIndex=function(n,t){return ee(n,t)},St.sortedIndexBy=function(n,t,r){return ue(n,t,ru(r,2))},St.sortedIndexOf=function(n,t){var r=null==n?0:n.length;if(r){var e=ee(n,t);if(e<r&&Ku(n[e],t))return e}return-1},St.sortedLastIndex=function(n,t){return ee(n,t,!0)},St.sortedLastIndexBy=function(n,t,r){return ue(n,t,ru(r,2),!0)},St.sortedLastIndexOf=function(n,t){if(null!=n&&n.length){var r=ee(n,t,!0)-1;if(Ku(n[r],t))return r}return-1},St.startCase=xc,St.startsWith=function(n,t,r){return n=si(n),r=null==r?0:Gt(fi(r),0,n.length),t=fe(t),n.slice(r,r+t.length)==t},St.subtract=Nc,St.sum=function(n){return n&&n.length?w(n,xi):0},St.sumBy=function(n,t){return n&&n.length?w(n,ru(t,2)):0},St.template=function(n,t,r){var e=St.templateSettings;r&&lu(n,t,r)&&(t=U),n=si(n),t=ec({},t,e,Ve);var u,i,o=ec({},t.imports,e.imports,Ve),f=_i(o),c=j(o,f),a=0,l=t.interpolate||Rt,s="__p += '",h=Ui((t.escape||Rt).source+"|"+l.source+"|"+(l===it?wt:Rt).source+"|"+(t.evaluate||Rt).source+"|$","g"),p="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++cr+"]")+"\n";n.replace(h,function(t,r,e,o,f,c){return e||(e=o),s+=n.slice(a,c).replace(zt,I),r&&(u=!0,s+="' +\n__e("+r+") +\n'"),f&&(i=!0,s+="';\n"+f+";\n__p += '"),e&&(s+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),a=c+t.length,t}),s+="';\n";var _=t.variable;_||(s="with (obj) {\n"+s+"\n}\n"),s=(i?s.replace(Jn,""):s).replace(Yn,"$1").replace(Qn,"$1;"),s="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(u?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+s+"return __p\n}";var v=kc(function(){return Wi(f,p+"return "+s).apply(U,c)});if(v.source=s,Hu(v))throw v;return v},St.times=function(n,t){if((n=fi(n))<1||n>sn)return[];var r=_n,e=wo(n,_n);t=ru(t),n-=_n;for(var u=m(e,t);++r<n;)t(r);return u},St.toFinite=oi,St.toInteger=fi,St.toLength=ci,St.toLower=function(n){return si(n).toLowerCase()},St.toNumber=ai,St.toSafeInteger=function(n){return n?Gt(fi(n),-sn,sn):0===n?n:0},St.toString=si,St.toUpper=function(n){return si(n).toUpperCase()},St.trim=function(n,t,r){if((n=si(n))&&(r||t===U))return n.replace(ht,"");if(!n||!(t=fe(t)))return n;var e=C(n),u=C(t);return de(e,k(e,u),O(e,u)+1).join("")},St.trimEnd=function(n,t,r){if((n=si(n))&&(r||t===U))return n.replace(_t,"");if(!n||!(t=fe(t)))return n;var e=C(n);return de(e,0,O(e,C(t))+1).join("")},St.trimStart=function(n,t,r){if((n=si(n))&&(r||t===U))return n.replace(pt,"");if(!n||!(t=fe(t)))return n;var e=C(n);return de(e,k(e,C(t))).join("")},St.truncate=function(n,t){var r=en,e=un;if(Xu(t)){var u="separator"in t?t.separator:u;r="length"in t?fi(t.length):r,e="omission"in t?fe(t.omission):e}var i=(n=si(n)).length;if(R(n)){var o=C(n);i=o.length}if(r>=i)return n;var f=r-L(e);if(f<1)return e;var c=o?de(o,0,f).join(""):n.slice(0,f);if(u===U)return c+e;if(o&&(f+=c.length-f),Jf(u)){if(n.slice(f).search(u)){var a,l=c;for(u.global||(u=Ui(u.source,si(mt.exec(u))+"g")),u.lastIndex=0;a=u.exec(l);)var s=a.index;c=c.slice(0,s===U?f:s)}}else if(n.indexOf(fe(u),f)!=f){var h=c.lastIndexOf(u);h>-1&&(c=c.slice(0,h))}return c+e},St.unescape=function(n){return(n=si(n))&&tt.test(n)?n.replace(Xn,Sr):n},St.uniqueId=function(n){var t=++qi;return si(n)+t},St.upperCase=jc,St.upperFirst=Ac,St.each=Bu,St.eachRight=Tu,St.first=Iu,Ai(St,function(){var n={};return ir(St,function(t,r){Pi.call(St.prototype,r)||(n[r]=t)}),n}(),{chain:!1}),St.VERSION="4.17.4",e(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){St[n].placeholder=St}),e(["drop","take"],function(n,t){Ct.prototype[n]=function(r){r=r===U?1:bo(fi(r),0);var e=this.__filtered__&&!t?new Ct(this):this.clone();return e.__filtered__?e.__takeCount__=wo(r,e.__takeCount__):e.__views__.push({size:wo(r,_n),type:n+(e.__dir__<0?"Right":"")}),e},Ct.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),e(["filter","map","takeWhile"],function(n,t){var r=t+1,e=r==cn||3==r;Ct.prototype[n]=function(n){var t=this.clone();return t.__iteratees__.push({iteratee:ru(n,3),type:r}),t.__filtered__=t.__filtered__||e,t}}),e(["head","last"],function(n,t){var r="take"+(t?"Right":"");Ct.prototype[n]=function(){return this[r](1).value()[0]}}),e(["initial","tail"],function(n,t){var r="drop"+(t?"":"Right");Ct.prototype[n]=function(){return this.__filtered__?new Ct(this):this[r](1)}}),Ct.prototype.compact=function(){return this.filter(xi)},Ct.prototype.find=function(n){return this.filter(n).head()},Ct.prototype.findLast=function(n){return this.reverse().find(n)},Ct.prototype.invokeMap=ne(function(n,t){return"function"==typeof n?new Ct(this):this.map(function(r){return Cr(r,n,t)})}),Ct.prototype.reject=function(n){return this.filter(Zu(ru(n)))},Ct.prototype.slice=function(n,t){n=fi(n);var r=this;return r.__filtered__&&(n>0||t<0)?new Ct(r):(n<0?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==U&&(r=(t=fi(t))<0?r.dropRight(-t):r.take(t-n)),r)},Ct.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},Ct.prototype.toArray=function(){return this.take(_n)},ir(Ct.prototype,function(n,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),e=/^(?:head|last)$/.test(t),u=St[e?"take"+("last"==t?"Right":""):t],i=e||/^find/.test(t);u&&(St.prototype[t]=function(){var t=this.__wrapped__,o=e?[1]:arguments,f=t instanceof Ct,c=o[0],l=f||Zf(t),s=function(n){var t=u.apply(St,a([n],o));return e&&h?t[0]:t};l&&r&&"function"==typeof c&&1!=c.length&&(f=l=!1);var h=this.__chain__,p=!!this.__actions__.length,_=i&&!h,v=f&&!p;if(!i&&l){t=v?t:new Ct(this);var g=n.apply(t,o);return g.__actions__.push({func:Cu,args:[s],thisArg:U}),new Lt(g,h)}return _&&v?n.apply(this,o):(g=this.thru(s),_?e?g.value()[0]:g.value():g)})}),e(["pop","push","shift","sort","splice","unshift"],function(n){var t=$i[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:pop|shift)$/.test(n);St.prototype[n]=function(){var n=arguments;if(e&&!this.__chain__){var u=this.value();return t.apply(Zf(u)?u:[],n)}return this[r](function(r){return t.apply(Zf(r)?r:[],n)})}}),ir(Ct.prototype,function(n,t){var r=St[t];if(r){var e=r.name+"";(Wo[e]||(Wo[e]=[])).push({name:t,func:r})}}),Wo[Be(U,G).name]=[{name:"wrapper",func:U}],Ct.prototype.clone=function(){var n=new Ct(this.__wrapped__);return n.__actions__=ke(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=ke(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=ke(this.__views__),n},Ct.prototype.reverse=function(){if(this.__filtered__){var n=new Ct(this);n.__dir__=-1,n.__filtered__=!0}else(n=this.clone()).__dir__*=-1;return n},Ct.prototype.value=function(){var n=this.__wrapped__.value(),t=this.__dir__,r=Zf(n),e=t<0,u=r?n.length:0,i=function(n,t,r){for(var e=-1,u=r.length;++e<u;){var i=r[e],o=i.size;switch(i.type){case"drop":n+=o;break;case"dropRight":t-=o;break;case"take":t=wo(t,n+o);break;case"takeRight":n=bo(n,t-o)}}return{start:n,end:t}}(0,u,this.__views__),o=i.start,f=i.end,c=f-o,a=e?f:o-1,l=this.__iteratees__,s=l.length,h=0,p=wo(c,this.__takeCount__);if(!r||!e&&u==c&&p==c)return he(n,this.__actions__);var _=[];n:for(;c--&&h<p;){for(var v=-1,g=n[a+=t];++v<s;){var y=l[v],d=y.iteratee,b=y.type,w=d(g);if(b==an)g=w;else if(!w){if(b==cn)continue n;break n}}_[h++]=g}return _},St.prototype.at=Af,St.prototype.chain=function(){return Lu(this)},St.prototype.commit=function(){return new Lt(this.value(),this.__chain__)},St.prototype.next=function(){this.__values__===U&&(this.__values__=ii(this.value()));var n=this.__index__>=this.__values__.length;return{done:n,value:n?U:this.__values__[this.__index__++]}},St.prototype.plant=function(n){for(var t,r=this;r instanceof Wt;){var e=ju(r);e.__index__=0,e.__values__=U,t?u.__wrapped__=e:t=e;var u=e;r=r.__wrapped__}return u.__wrapped__=n,t},St.prototype.reverse=function(){var n=this.__wrapped__;if(n instanceof Ct){var t=n;return this.__actions__.length&&(t=new Ct(this)),(t=t.reverse()).__actions__.push({func:Cu,args:[Eu],thisArg:U}),new Lt(t,this.__chain__)}return this.thru(Eu)},St.prototype.toJSON=St.prototype.valueOf=St.prototype.value=function(){return he(this.__wrapped__,this.__actions__)},St.prototype.first=St.prototype.head,io&&(St.prototype[io]=Uu),St}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(gr._=Wr,define(function(){return Wr})):dr?((dr.exports=Wr)._=Wr,yr._=Wr):gr._=Wr}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],334:[function(require,module,exports){
!function(e,t,n){function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return p[e.which]?p[e.which]:h[e.which]?h[e.which]:String.fromCharCode(e.which).toLowerCase()}function o(e,t){return e.sort().join(",")===t.sort().join(",")}function a(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function c(e,t,n){return n||(n=function(){if(!f){f={};for(var e in p)e>95&&e<112||p.hasOwnProperty(e)&&(f[p[e]]=e)}return f}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function s(e,t){var n,r,i,o=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),i=0;i<n.length;++i)r=n[i],y[r]&&(r=y[r]),t&&"keypress"!=t&&d[r]&&(r=d[r],o.push("shift")),a(r)&&o.push(r);return t=c(r,o,t),{key:r,modifiers:o,action:t}}function u(e,n){return null!==e&&e!==t&&(e===n||u(e.parentNode,n))}function l(e){function n(e){e=e||{};var t,n=!1;for(t in m)e[t]?n=!0:m[t]=0;n||(b=!1)}function c(e,t,n,r,i,c){var s,u,l=[],f=n.type;if(!d._callbacks[e])return[];for("keyup"==f&&a(e)&&(t=[e]),s=0;s<d._callbacks[e].length;++s)if(u=d._callbacks[e][s],(r||!u.seq||m[u.seq]==u.level)&&f==u.action&&("keypress"==f&&!n.metaKey&&!n.ctrlKey||o(t,u.modifiers))){var p=!r&&u.combo==i,h=r&&u.seq==r&&u.level==c;(p||h)&&d._callbacks[e].splice(s,1),l.push(u)}return l}function u(e,t,n,r){d.stopCallback(t,t.target||t.srcElement,n,r)||!1===e(t,n)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(t),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(t))}function f(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);t&&("keyup"!=e.type||k!==t?d.handleKey(t,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):k=!1)}function p(e,t,r,o){function a(t){return function(){b=t,++m[e],clearTimeout(y),y=setTimeout(n,1e3)}}function c(t){u(r,t,e),"keyup"!==o&&(k=i(t)),setTimeout(n,10)}m[e]=0;for(var l=0;l<t.length;++l){var f=l+1===t.length?c:a(o||s(t[l+1]).action);h(t[l],f,o,e,l)}}function h(e,t,n,r,i){d._directMap[e+":"+n]=t;var o,a=(e=e.replace(/\s+/g," ")).split(" ");a.length>1?p(e,a,t,n):(o=s(e,n),d._callbacks[o.key]=d._callbacks[o.key]||[],c(o.key,o.modifiers,{type:o.action},r,e,i),d._callbacks[o.key][r?"unshift":"push"]({callback:t,modifiers:o.modifiers,action:o.action,seq:r,level:i,combo:e}))}var d=this;if(e=e||t,!(d instanceof l))return new l(e);d.target=e,d._callbacks={},d._directMap={};var y,m={},k=!1,v=!1,b=!1;d._handleKey=function(e,t,r){var i,o=c(e,t,r),s={},l=0,f=!1;for(i=0;i<o.length;++i)o[i].seq&&(l=Math.max(l,o[i].level));for(i=0;i<o.length;++i)if(o[i].seq){if(o[i].level!=l)continue;f=!0,s[o[i].seq]=1,u(o[i].callback,r,o[i].combo,o[i].seq)}else f||u(o[i].callback,r,o[i].combo);var p="keypress"==r.type&&v;r.type!=b||a(e)||p||n(s),v=f&&"keydown"==r.type},d._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)h(e[r],t,n)},r(e,"keypress",f),r(e,"keydown",f),r(e,"keyup",f)}for(var f,p={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},h={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},d={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},y={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},m=1;m<20;++m)p[111+m]="f"+m;for(m=0;m<=9;++m)p[m+96]=m;l.prototype.bind=function(e,t,n){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,n),this},l.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},l.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},l.prototype.reset=function(){return this._callbacks={},this._directMap={},this},l.prototype.stopCallback=function(e,t){return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&(!u(t,this.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},l.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},l.init=function(){var e=l(t);for(var n in e)"_"!==n.charAt(0)&&(l[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n))},l.init(),e.Mousetrap=l,"undefined"!=typeof module&&module.exports&&(module.exports=l),"function"==typeof define&&define.amd&&define(function(){return l})}(window,document);

},{}],335:[function(require,module,exports){
(function (process){
"use strict";function nextTick(e,n,c,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,t,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,n)});case 3:return process.nextTick(function(){e.call(null,n,c)});case 4:return process.nextTick(function(){e.call(null,n,c,r)});default:for(s=new Array(o-1),t=0;t<s.length;)s[t++]=arguments[t];return process.nextTick(function(){e.apply(null,s)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports={nextTick:nextTick}:module.exports=process;

}).call(this,require('_process'))

},{"_process":313}],336:[function(require,module,exports){
(function(){var t=this||Function("return this")(),n=function(){"use strict";function n(){}function e(t,n){var e;for(e in t)Object.hasOwnProperty.call(t,e)&&n(e)}function i(t,n){return e(n,function(e){t[e]=n[e]}),t}function r(t,n){e(n,function(e){void 0===t[e]&&(t[e]=n[e])})}function o(t,n,e,i,r,o,u){var s,c,h,p=t<o?0:(t-o)/r;for(s in n)n.hasOwnProperty(s)&&(h="function"==typeof(c=u[s])?c:f[c],n[s]=a(e[s],i[s],h,p));return n}function a(t,n,e,i){return t+(n-t)*e(i)}function u(t,n){var i=h.prototype.filter,r=t._filterArgs;e(i,function(e){void 0!==i[e][n]&&i[e][n].apply(t,r)})}function s(t,n,e,i,r,a,s,c,h,f,p){d=n+e+i,g=Math.min(p||w(),d),y=g>=d,v=i-(d-g),t.isPlaying()&&(y?(h(s,t._attachment,v),t.stop(!0)):(t._scheduleId=f(t._timeoutHandler,_),u(t,"beforeTween"),g<n+e?o(1,r,a,s,1,1,c):o(g,r,a,s,i,n+e,c),u(t,"afterTween"),h(r,t._attachment,v)))}function c(t,n){var i={},r=typeof n;return"string"===r||"function"===r?e(t,function(t){i[t]=n}):e(t,function(t){i[t]||(i[t]=n[t]||l)}),i}function h(t,n){this._currentState=t||{},this._configured=!1,this._scheduleFunction=p,void 0!==n&&this.setConfig(n)}var f,p,l="linear",_=1e3/60,m=Date.now?Date.now:function(){return+new Date},w="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:m;p="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame||setTimeout:setTimeout;var d,g,y,v;return h.prototype.tween=function(t){return this._isTweening?this:(void 0===t&&this._configured||this.setConfig(t),this._timestamp=w(),this._start(this.get(),this._attachment),this.resume())},h.prototype.setConfig=function(t){t=t||{},this._configured=!0,this._attachment=t.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=t.delay||0,this._start=t.start||n,this._step=t.step||n,this._finish=t.finish||n,this._duration=t.duration||500,this._currentState=i({},t.from||this.get()),this._originalState=this.get(),this._targetState=i({},t.to||this.get());var e=this;this._timeoutHandler=function(){s(e,e._timestamp,e._delay,e._duration,e._currentState,e._originalState,e._targetState,e._easing,e._step,e._scheduleFunction)};var o=this._currentState,a=this._targetState;return r(a,o),this._easing=c(o,t.easing||l),this._filterArgs=[o,this._originalState,a,this._easing],u(this,"tweenCreated"),this},h.prototype.get=function(){return i({},this._currentState)},h.prototype.set=function(t){this._currentState=t},h.prototype.pause=function(){return this._pausedAtTime=w(),this._isPaused=!0,this},h.prototype.resume=function(){return this._isPaused&&(this._timestamp+=w()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},h.prototype.seek=function(t){t=Math.max(t,0);var n=w();return this._timestamp+t===0?this:(this._timestamp=n-t,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,s(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,n),this.pause()),this)},h.prototype.stop=function(e){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=n,(t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.oCancelAnimationFrame||t.msCancelAnimationFrame||t.mozCancelRequestAnimationFrame||t.clearTimeout)(this._scheduleId),e&&(u(this,"beforeTween"),o(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),u(this,"afterTween"),u(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},h.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},h.prototype.setScheduleFunction=function(t){this._scheduleFunction=t},h.prototype.dispose=function(){var t;for(t in this)this.hasOwnProperty(t)&&delete this[t]},h.prototype.filter={},h.prototype.formula={linear:function(t){return t}},f=h.prototype.formula,i(h,{now:w,each:e,tweenProps:o,tweenProp:a,applyFilter:u,shallowCopy:i,defaults:r,composeEasingObject:c}),"function"==typeof SHIFTY_DEBUG_NOW&&(t.timeoutHandler=s),"object"==typeof exports?module.exports=h:"function"==typeof define&&define.amd?define(function(){return h}):void 0===t.Tweenable&&(t.Tweenable=h),h}();n.shallowCopy(n.prototype.formula,{easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return Math.pow(t-1,5)+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var n=1.70158;return(t/=.5)<1?t*t*((1+(n*=1.525))*t-n)*.5:.5*((t-=2)*t*((1+(n*=1.525))*t+n)+2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swingFromTo:function(t){var n=1.70158;return(t/=.5)<1?t*t*((1+(n*=1.525))*t-n)*.5:.5*((t-=2)*t*((1+(n*=1.525))*t+n)+2)},swingFrom:function(t){return t*t*(2.70158*t-1.70158)},swingTo:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},bounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?2-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},easeFromTo:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeFrom:function(t){return Math.pow(t,4)},easeTo:function(t){return Math.pow(t,.25)}}),function(){function t(t,n,e,i,r,o){function a(t){return((c*t+h)*t+f)*t}function u(t){return(3*c*t+2*h)*t+f}function s(t){return t>=0?t:0-t}var c=0,h=0,f=0,p=0,l=0,_=0;return f=3*n,h=3*(i-n)-f,c=1-f-h,_=3*e,l=3*(r-e)-_,p=1-_-l,function(t,n){return function(t){return((p*t+l)*t+_)*t}(function(t,n){var e,i,r,o,c,h;for(r=t,h=0;h<8;h++){if(o=a(r)-t,s(o)<n)return r;if(c=u(r),s(c)<1e-6)break;r-=o/c}if(e=0,i=1,(r=t)<e)return e;if(r>i)return i;for(;e<i;){if(o=a(r),s(o-t)<n)return r;t>o?e=r:i=r,r=.5*(i-e)+e}return r}(t,n))}(t,function(t){return 1/(200*t)}(o))}n.setBezierFunction=function(e,i,r,o,a){var u=function(n,e,i,r){return function(o){return t(o,n,e,i,r,1)}}(i,r,o,a);return u.displayName=e,u.x1=i,u.y1=r,u.x2=o,u.y2=a,n.prototype.formula[e]=u},n.unsetBezierFunction=function(t){delete n.prototype.formula[t]}}(),function(){var t=new n;t._filterArgs=[],n.interpolate=function(e,i,r,o,a){var u=n.shallowCopy({},e),s=a||0,c=n.composeEasingObject(e,o||"linear");t.set({});var h=t._filterArgs;h.length=0,h[0]=u,h[1]=e,h[2]=i,h[3]=c,n.applyFilter(t,"tweenCreated"),n.applyFilter(t,"beforeTween");var f=function(t,e,i,r,o,a){return n.tweenProps(r,e,t,i,1,a,o)}(e,u,i,r,c,s);return n.applyFilter(t,"afterTween"),f}}(),function(t){function n(n){t.each(n,function(t){var i=n[t];"string"==typeof i&&i.match(m)&&(n[t]=function(t){return r(m,t,e)}(i))})}function e(t){var n=function(t){3===(t=t.replace(/#/,"")).length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);return d[0]=i(t.substr(0,2)),d[1]=i(t.substr(2,2)),d[2]=i(t.substr(4,2)),d}(t);return"rgb("+n[0]+","+n[1]+","+n[2]+")"}function i(t){return parseInt(t,16)}function r(t,n,e){var i=n.match(t),r=n.replace(t,w);if(i)for(var o,a=i.length,u=0;u<a;u++)o=i.shift(),r=r.replace(w,e(o));return r}function o(t){for(var n=t.match(p),e=n.length,i=t.match(_)[0],r=0;r<e;r++)i+=parseInt(n[r],10)+",";return i=i.slice(0,-1)+")"}function a(n){var e={};return t.each(n,function(t){var i=n[t];if("string"==typeof i){var r=c(i);e[t]={formatString:function(t){var n=t.match(f);return n?(1===n.length||t.charAt(0).match(h))&&n.unshift(""):n=["",""],n.join(w)}(i),chunkNames:function(t,n){var e,i=[],r=t.length;for(e=0;e<r;e++)i.push("_"+n+"_"+e);return i}(r,t)}}}),e}function u(n,e){t.each(e,function(t){for(var i=c(n[t]),r=i.length,o=0;o<r;o++)n[e[t].chunkNames[o]]=+i[o];delete n[t]})}function s(n,e){t.each(e,function(t){var i=n[t],a=function(t,n){g.length=0;for(var e=n.length,i=0;i<e;i++)g.push(t[n[i]]);return g}(function(t,n){for(var e,i={},r=n.length,o=0;o<r;o++)e=n[o],i[e]=t[e],delete t[e];return i}(n,e[t].chunkNames),e[t].chunkNames);i=function(t,n){for(var e=t,i=n.length,r=0;r<i;r++)e=e.replace(w,+n[r].toFixed(4));return e}(e[t].formatString,a),n[t]=function(t){return r(l,t,o)}(i)})}function c(t){return t.match(p)}var h=/(\d|\-|\.)/,f=/([^\-0-9\.]+)/g,p=/[0-9.\-]+/g,l=new RegExp("rgb\\("+p.source+/,\s*/.source+p.source+/,\s*/.source+p.source+"\\)","g"),_=/^.*\(/,m=/#([0-9]|[a-f]){3,6}/gi,w="VAL",d=[],g=[];t.prototype.filter.token={tweenCreated:function(t,e,i,r){n(t),n(e),n(i),this._tokenData=a(t)},beforeTween:function(n,e,i,r){!function(n,e){t.each(e,function(t){var i,r=e[t].chunkNames,o=r.length,a=n[t];if("string"==typeof a){var u=a.split(" "),s=u[u.length-1];for(i=0;i<o;i++)n[r[i]]=u[i]||s}else for(i=0;i<o;i++)n[r[i]]=a;delete n[t]})}(r,this._tokenData),u(n,this._tokenData),u(e,this._tokenData),u(i,this._tokenData)},afterTween:function(n,e,i,r){s(n,this._tokenData),s(e,this._tokenData),s(i,this._tokenData),function(n,e){t.each(e,function(t){var i=e[t].chunkNames,r=i.length,o=n[i[0]];if("string"==typeof o){for(var a="",u=0;u<r;u++)a+=" "+n[i[u]],delete n[i[u]];n[t]=a.substr(1)}else n[t]=o})}(r,this._tokenData)}}}(n)}).call(null);

},{}],337:[function(require,module,exports){
var Shape=require("./shape"),utils=require("./utils"),Circle=function(t,r){this._pathTemplate="M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",this.containerAspectRatio=1,Shape.apply(this,arguments)};Circle.prototype=new Shape,Circle.prototype.constructor=Circle,Circle.prototype._pathString=function(t){var r=t.strokeWidth;t.trailWidth&&t.trailWidth>t.strokeWidth&&(r=t.trailWidth);var i=50-r/2;return utils.render(this._pathTemplate,{radius:i,"2radius":2*i})},Circle.prototype._trailString=function(t){return this._pathString(t)},module.exports=Circle;

},{"./shape":342,"./utils":343}],338:[function(require,module,exports){
var Shape=require("./shape"),utils=require("./utils"),Line=function(t,e){this._pathTemplate="M 0,{center} L 100,{center}",Shape.apply(this,arguments)};Line.prototype=new Shape,Line.prototype.constructor=Line,Line.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 "+e.strokeWidth),t.setAttribute("preserveAspectRatio","none")},Line.prototype._pathString=function(t){return utils.render(this._pathTemplate,{center:t.strokeWidth/2})},Line.prototype._trailString=function(t){return this._pathString(t)},module.exports=Line;

},{"./shape":342,"./utils":343}],339:[function(require,module,exports){
module.exports={Line:require("./line"),Circle:require("./circle"),SemiCircle:require("./semicircle"),Path:require("./path"),Shape:require("./shape"),utils:require("./utils")};

},{"./circle":337,"./line":338,"./path":340,"./semicircle":341,"./shape":342,"./utils":343}],340:[function(require,module,exports){
var Tweenable=require("shifty"),utils=require("./utils"),EASING_ALIASES={easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"},Path=function t(e,s){if(!(this instanceof t))throw new Error("Constructor was called without new keyword");s=utils.extend({duration:800,easing:"linear",from:{},to:{},step:function(){}},s);var o;o=utils.isString(e)?document.querySelector(e):e,this.path=o,this._opts=s,this._tweenable=null;var i=this.path.getTotalLength();this.path.style.strokeDasharray=i+" "+i,this.set(0)};Path.prototype.value=function(){var t=1-this._getComputedDashOffset()/this.path.getTotalLength();return parseFloat(t.toFixed(6),10)},Path.prototype.set=function(t){this.stop(),this.path.style.strokeDashoffset=this._progressToOffset(t);var e=this._opts.step;if(utils.isFunction(e)){var s=this._easing(this._opts.easing);e(this._calculateTo(t,s),this._opts.shape||this,this._opts.attachment)}},Path.prototype.stop=function(){this._stopTween(),this.path.style.strokeDashoffset=this._getComputedDashOffset()},Path.prototype.animate=function(t,e,s){e=e||{},utils.isFunction(e)&&(s=e,e={});var o=utils.extend({},e),i=utils.extend({},this._opts);e=utils.extend(i,e);var a=this._easing(e.easing),n=this._resolveFromAndTo(t,a,o);this.stop(),this.path.getBoundingClientRect();var r=this._getComputedDashOffset(),h=this._progressToOffset(t),u=this;this._tweenable=new Tweenable,this._tweenable.tween({from:utils.extend({offset:r},n.from),to:utils.extend({offset:h},n.to),duration:e.duration,easing:a,step:function(t){u.path.style.strokeDashoffset=t.offset;var s=e.shape||u;e.step(t,s,e.attachment)},finish:function(t){utils.isFunction(s)&&s()}})},Path.prototype._getComputedDashOffset=function(){var t=window.getComputedStyle(this.path,null);return parseFloat(t.getPropertyValue("stroke-dashoffset"),10)},Path.prototype._progressToOffset=function(t){var e=this.path.getTotalLength();return e-t*e},Path.prototype._resolveFromAndTo=function(t,e,s){return s.from&&s.to?{from:s.from,to:s.to}:{from:this._calculateFrom(e),to:this._calculateTo(t,e)}},Path.prototype._calculateFrom=function(t){return Tweenable.interpolate(this._opts.from,this._opts.to,this.value(),t)},Path.prototype._calculateTo=function(t,e){return Tweenable.interpolate(this._opts.from,this._opts.to,t,e)},Path.prototype._stopTween=function(){null!==this._tweenable&&(this._tweenable.stop(),this._tweenable=null)},Path.prototype._easing=function(t){return EASING_ALIASES.hasOwnProperty(t)?EASING_ALIASES[t]:t},module.exports=Path;

},{"./utils":343,"shifty":336}],341:[function(require,module,exports){
var Shape=require("./shape"),Circle=require("./circle"),utils=require("./utils"),SemiCircle=function(t,e){this._pathTemplate="M 50,50 m -{radius},0 a {radius},{radius} 0 1 1 {2radius},0",this.containerAspectRatio=2,Shape.apply(this,arguments)};SemiCircle.prototype=new Shape,SemiCircle.prototype.constructor=SemiCircle,SemiCircle.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 50")},SemiCircle.prototype._initializeTextContainer=function(t,e,i){t.text.style&&(i.style.top="auto",i.style.bottom="0",t.text.alignToBottom?utils.setStyle(i,"transform","translate(-50%, 0)"):utils.setStyle(i,"transform","translate(-50%, 50%)"))},SemiCircle.prototype._pathString=Circle.prototype._pathString,SemiCircle.prototype._trailString=Circle.prototype._trailString,module.exports=SemiCircle;

},{"./circle":337,"./shape":342,"./utils":343}],342:[function(require,module,exports){
var Path=require("./path"),utils=require("./utils"),DESTROYED_ERROR="Object is destroyed",Shape=function t(e,i){if(!(this instanceof t))throw new Error("Constructor was called without new keyword");if(0!==arguments.length){this._opts=utils.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{style:{color:null,position:"absolute",left:"50%",top:"50%",padding:0,margin:0,transform:{prefix:!0,value:"translate(-50%, -50%)"}},autoStyleContainer:!0,alignToBottom:!0,value:null,className:"progressbar-text"},svgStyle:{display:"block",width:"100%"},warnings:!1},i,!0),utils.isObject(i)&&void 0!==i.svgStyle&&(this._opts.svgStyle=i.svgStyle),utils.isObject(i)&&utils.isObject(i.text)&&void 0!==i.text.style&&(this._opts.text.style=i.text.style);var r,s=this._createSvgView(this._opts);if(!(r=utils.isString(e)?document.querySelector(e):e))throw new Error("Container does not exist: "+e);this._container=r,this._container.appendChild(s.svg),this._opts.warnings&&this._warnContainerAspectRatio(this._container),this._opts.svgStyle&&utils.setStyles(s.svg,this._opts.svgStyle),this.svg=s.svg,this.path=s.path,this.trail=s.trail,this.text=null;var o=utils.extend({attachment:void 0,shape:this},this._opts);this._progressPath=new Path(s.path,o),utils.isObject(this._opts.text)&&null!==this._opts.text.value&&this.setText(this._opts.text.value)}};Shape.prototype.animate=function(t,e,i){if(null===this._progressPath)throw new Error(DESTROYED_ERROR);this._progressPath.animate(t,e,i)},Shape.prototype.stop=function(){if(null===this._progressPath)throw new Error(DESTROYED_ERROR);void 0!==this._progressPath&&this._progressPath.stop()},Shape.prototype.destroy=function(){if(null===this._progressPath)throw new Error(DESTROYED_ERROR);this.stop(),this.svg.parentNode.removeChild(this.svg),this.svg=null,this.path=null,this.trail=null,this._progressPath=null,null!==this.text&&(this.text.parentNode.removeChild(this.text),this.text=null)},Shape.prototype.set=function(t){if(null===this._progressPath)throw new Error(DESTROYED_ERROR);this._progressPath.set(t)},Shape.prototype.value=function(){if(null===this._progressPath)throw new Error(DESTROYED_ERROR);return void 0===this._progressPath?0:this._progressPath.value()},Shape.prototype.setText=function(t){if(null===this._progressPath)throw new Error(DESTROYED_ERROR);null===this.text&&(this.text=this._createTextContainer(this._opts,this._container),this._container.appendChild(this.text)),utils.isObject(t)?(utils.removeChildren(this.text),this.text.appendChild(t)):this.text.innerHTML=t},Shape.prototype._createSvgView=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(e,t);var i=null;(t.trailColor||t.trailWidth)&&(i=this._createTrail(t),e.appendChild(i));var r=this._createPath(t);return e.appendChild(r),{svg:e,path:r,trail:i}},Shape.prototype._initializeSvg=function(t,e){t.setAttribute("viewBox","0 0 100 100")},Shape.prototype._createPath=function(t){var e=this._pathString(t);return this._createPathElement(e,t)},Shape.prototype._createTrail=function(t){var e=this._trailString(t),i=utils.extend({},t);return i.trailColor||(i.trailColor="#eee"),i.trailWidth||(i.trailWidth=i.strokeWidth),i.color=i.trailColor,i.strokeWidth=i.trailWidth,i.fill=null,this._createPathElement(e,i)},Shape.prototype._createPathElement=function(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",t),i.setAttribute("stroke",e.color),i.setAttribute("stroke-width",e.strokeWidth),e.fill?i.setAttribute("fill",e.fill):i.setAttribute("fill-opacity","0"),i},Shape.prototype._createTextContainer=function(t,e){var i=document.createElement("div");i.className=t.text.className;var r=t.text.style;return r&&(t.text.autoStyleContainer&&(e.style.position="relative"),utils.setStyles(i,r),r.color||(i.style.color=t.color)),this._initializeTextContainer(t,e,i),i},Shape.prototype._initializeTextContainer=function(t,e,i){},Shape.prototype._pathString=function(t){throw new Error("Override this function for each progress bar")},Shape.prototype._trailString=function(t){throw new Error("Override this function for each progress bar")},Shape.prototype._warnContainerAspectRatio=function(t){if(this.containerAspectRatio){var e=window.getComputedStyle(t,null),i=parseFloat(e.getPropertyValue("width"),10),r=parseFloat(e.getPropertyValue("height"),10);utils.floatEquals(this.containerAspectRatio,i/r)||(console.warn("Incorrect aspect ratio of container","#"+t.id,"detected:",e.getPropertyValue("width")+"(width)","/",e.getPropertyValue("height")+"(height)","=",i/r),console.warn("Aspect ratio of should be",this.containerAspectRatio))}},module.exports=Shape;

},{"./path":340,"./utils":343}],343:[function(require,module,exports){
function extend(t,e,r){t=t||{},e=e||{},r=r||!1;for(var n in e)if(e.hasOwnProperty(n)){var i=t[n],o=e[n];r&&isObject(i)&&isObject(o)?t[n]=extend(i,o,r):t[n]=o}return t}function render(t,e){var r=t;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],o="\\{"+n+"\\}",c=new RegExp(o,"g");r=r.replace(c,i)}return r}function setStyle(t,e,r){for(var n=t.style,i=0;i<PREFIXES.length;++i){n[PREFIXES[i]+capitalize(e)]=r}n[e]=r}function setStyles(t,e){forEachObject(e,function(e,r){null!==e&&void 0!==e&&(isObject(e)&&!0===e.prefix?setStyle(t,r,e.value):t.style[r]=e)})}function capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}function isString(t){return"string"==typeof t||t instanceof String}function isFunction(t){return"function"==typeof t}function isArray(t){return"[object Array]"===Object.prototype.toString.call(t)}function isObject(t){if(isArray(t))return!1;return"object"===typeof t&&!!t}function forEachObject(t,e){for(var r in t)if(t.hasOwnProperty(r)){e(t[r],r)}}function floatEquals(t,e){return Math.abs(t-e)<FLOAT_COMPARISON_EPSILON}function removeChildren(t){for(;t.firstChild;)t.removeChild(t.firstChild)}var PREFIXES="Webkit Moz O ms".split(" "),FLOAT_COMPARISON_EPSILON=.001;module.exports={extend:extend,render:render,setStyle:setStyle,setStyles:setStyles,capitalize:capitalize,isString:isString,isFunction:isFunction,isObject:isObject,forEachObject:forEachObject,floatEquals:floatEquals,removeChildren:removeChildren};

},{}],344:[function(require,module,exports){
module.exports=require("./lib/_stream_duplex.js");

},{"./lib/_stream_duplex.js":345}],345:[function(require,module,exports){
"use strict";function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||pna.nextTick(onEndNT,this)}function onEndNT(e){e.end()}var pna=require("process-nextick-args"),objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),Duplex.prototype._destroy=function(e,t){this.push(null),this.end(),pna.nextTick(t,e)};

},{"./_stream_readable":347,"./_stream_writable":349,"core-util-is":319,"inherits":353,"process-nextick-args":335}],346:[function(require,module,exports){
"use strict";function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":348,"core-util-is":319,"inherits":353}],347:[function(require,module,exports){
(function (process,global){
"use strict";function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function ReadableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{};var r=t instanceof Duplex;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,a=e.readableHighWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(a||0===a)?a:i,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),Stream.call(this)}function readableAddChunk(e,t,r,n,a){var i=e._readableState;if(null===t)i.reading=!1,onEofChunk(e,i);else{var d;a||(d=chunkInvalid(i,t)),d?e.emit("error",d):i.objectMode||t&&t.length>0?("string"==typeof t||i.objectMode||Object.getPrototypeOf(t)===Buffer.prototype||(t=_uint8ArrayToBuffer(t)),n?i.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):addChunk(e,i,t,!0):i.ended?e.emit("error",new Error("stream.push() after EOF")):(i.reading=!1,i.decoder&&!r?(t=i.decoder.write(t),i.objectMode||0!==t.length?addChunk(e,i,t,!1):maybeReadMore(e,i)):addChunk(e,i,t,!1))):n||(i.reading=!1)}return needMoreData(i)}function addChunk(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e)),maybeReadMore(e,t)}function chunkInvalid(e,t){var r;return _isUint8Array(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?pna.nextTick(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,pna.nextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,pna.nextTick(resume_,e,t))}function resume_(e,t){t.reading||(debug("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){if(0===t.length)return null;var r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial(e,t.buffer,t.decoder),r}function fromListPartial(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString(e,t):copyFromBuffer(e,t),n}function copyFromBufferString(e,t){var r=t.head,n=1,a=r.data;for(e-=a.length;r=r.next;){var i=r.data,d=e>i.length?i.length:e;if(d===i.length?a+=i:a+=i.slice(0,e),0===(e-=d)){d===i.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(d));break}++n}return t.length-=n,a}function copyFromBuffer(e,t){var r=Buffer.allocUnsafe(e),n=t.head,a=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var i=n.data,d=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,d),0===(e-=d)){d===i.length?(++a,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(d));break}++a}return t.length-=a,r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,pna.nextTick(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}var pna=require("process-nextick-args");module.exports=Readable;var Duplex,isArray=require("isarray");Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter,EElistenerCount=function(e,t){return e.listeners(t).length},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){},util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=require("./internal/streams/BufferList"),destroyImpl=require("./internal/streams/destroy");util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(e,t){this.push(null),t(e)},Readable.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=Buffer.from(e,t),t=""),r=!0),readableAddChunk(this,e,t,!1,r)},Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;Readable.prototype.read=function(e){debug("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n=t.needReadable;debug("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",n=!0),t.ended||t.reading?debug("reading or ended",n=!1):n&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t)));var a;return null===(a=e>0?fromList(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==a&&this.emit("data",a),a},Readable.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(e,t){function r(t,h){debug("onunpipe"),t===l&&h&&!1===h.hasUnpiped&&(h.hasUnpiped=!0,debug("cleanup"),e.removeListener("close",d),e.removeListener("finish",o),e.removeListener("drain",f),e.removeListener("error",i),e.removeListener("unpipe",r),l.removeListener("end",n),l.removeListener("end",u),l.removeListener("data",a),p=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||f())}function n(){debug("onend"),e.end()}function a(t){debug("ondata"),b=!1;!1!==e.write(t)||b||((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==indexOf(s.pipes,e))&&!p&&(debug("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,b=!0),l.pause())}function i(t){debug("onerror",t),u(),e.removeListener("error",i),0===EElistenerCount(e,"error")&&e.emit("error",t)}function d(){e.removeListener("finish",o),u()}function o(){debug("onfinish"),e.removeListener("close",d),u()}function u(){debug("unpipe"),l.unpipe(e)}var l=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,debug("pipe count=%d opts=%j",s.pipesCount,t);var h=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?n:u;s.endEmitted?pna.nextTick(h):l.once("end",h),e.on("unpipe",r);var f=pipeOnDrain(l);e.on("drain",f);var p=!1,b=!1;return l.on("data",a),prependListener(e,"error",i),e.once("close",d),e.once("finish",o),e.emit("pipe",l),s.flowing||(debug("pipe resume"),l.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,a=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<a;i++)n[i].emit("unpipe",this,r);return this}var d=indexOf(t.pipes,e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable(this):pna.nextTick(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;e.on("end",function(){if(debug("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(a){if(debug("wrapped data"),r.decoder&&(a=r.decoder.write(a)),(!r.objectMode||null!==a&&void 0!==a)&&(r.objectMode||a&&a.length)){t.push(a)||(n=!0,e.pause())}});for(var a in e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var i=0;i<kProxyEvents.length;i++)e.on(kProxyEvents[i],this.emit.bind(this,kProxyEvents[i]));return this._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Readable._fromList=fromList;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./_stream_duplex":345,"./internal/streams/BufferList":350,"./internal/streams/destroy":351,"./internal/streams/stream":352,"_process":313,"core-util-is":319,"events":321,"inherits":353,"isarray":325,"process-nextick-args":335,"safe-buffer":359,"string_decoder/":354,"util":310}],348:[function(require,module,exports){
"use strict";function afterTransform(r,t){var n=this._transformState;n.transforming=!1;var e=n.writecb;if(!e)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),e(r);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",prefinish)}function prefinish(){var r=this;"function"==typeof this._flush?this._flush(function(t,n){done(r,t,n)}):done(this,null,null)}function done(r,t,n){if(t)return r.emit("error",t);if(null!=n&&r.push(n),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Transform.prototype._destroy=function(r,t){var n=this;Duplex.prototype._destroy.call(this,r,function(r){t(r),n.emit("close")})};

},{"./_stream_duplex":345,"core-util-is":319,"inherits":353}],349:[function(require,module,exports){
(function (process,global){
"use strict";function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(t,e)}}function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}function nop(){}function WritableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{};var r=t instanceof Duplex;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,n=e.writableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(n||0===n)?n:o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),Stream.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),pna.nextTick(t,r)}function validChunk(e,t,r,i){var n=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),pna.nextTick(i,o),n=!1),n}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer.from(t,r)),t}function writeOrBuffer(e,t,r,i,n,o){if(!r){var a=decodeChunk(t,i,n);i!==a&&(r=!0,n="buffer",i=a)}var s=t.objectMode?1:i.length;t.length+=s;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,s,i,n,o);return f}function doWrite(e,t,r,i,n,o,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?(pna.nextTick(n,i),pna.nextTick(finishMaybe,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),finishMaybe(e,t))}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var o=needFinish(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?asyncWrite(afterWrite,e,r,o,n):afterWrite(e,r,o,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var a=0,s=!0;r;)n[a]=r,r.isBuf||(s=!1),r=r.next,a+=1;n.allBuffers=s,doWrite(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest(t),t.bufferedRequestCount=0}else{for(;r;){var f=r.chunk,u=r.encoding,l=r.callback;if(doWrite(e,t,!1,t.objectMode?1:f.length,f,u,l),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function callFinal(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),finishMaybe(e,t)})}function prefinish(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,pna.nextTick(callFinal,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function finishMaybe(e,t){var r=needFinish(t);return r&&(prefinish(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?pna.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function onCorkedFinish(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var pna=require("process-nextick-args");module.exports=Writable;var Duplex,asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:pna.nextTick;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){},destroyImpl=require("./internal/streams/destroy");util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var realHasInstance;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||this===Writable&&(e&&e._writableState instanceof WritableState)}})):realHasInstance=function(e){return e instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1,o=!i.objectMode&&_isUint8Array(e);return o&&!Buffer.isBuffer(e)&&(e=_uint8ArrayToBuffer(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ended?writeAfterEnd(this,r):(o||validChunk(this,i,e,r))&&(i.pendingcb++,n=writeOrBuffer(this,i,o,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||endWritable(this,i,r)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(e,t){this.end(),t(e)};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./_stream_duplex":345,"./internal/streams/destroy":351,"./internal/streams/stream":352,"_process":313,"core-util-is":319,"inherits":353,"process-nextick-args":335,"safe-buffer":359,"util-deprecate":363}],350:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function copyBuffer(t,e,i){t.copy(e,i)}var Buffer=require("safe-buffer").Buffer,util=require("util");module.exports=function(){function t(){_classCallCheck(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var e=Buffer.allocUnsafe(t>>>0),i=this.head,n=0;i;)copyBuffer(i.data,e,n),n+=i.data.length,i=i.next;return e},t}(),util&&util.inspect&&util.inspect.custom&&(module.exports.prototype[util.inspect.custom]=function(){var t=util.inspect({length:this.length});return this.constructor.name+" "+t});

},{"safe-buffer":359,"util":310}],351:[function(require,module,exports){
"use strict";function destroy(t,e){var r=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||pna.nextTick(emitErrorNT,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(pna.nextTick(emitErrorNT,r,t),r._writableState&&(r._writableState.errorEmitted=!0)):e&&e(t)}),this)}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(t,e){t.emit("error",e)}var pna=require("process-nextick-args");module.exports={destroy:destroy,undestroy:undestroy};

},{"process-nextick-args":335}],352:[function(require,module,exports){
module.exports=require("events").EventEmitter;

},{"events":321}],353:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],354:[function(require,module,exports){
"use strict";function _normalizeEncoding(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function normalizeEncoding(t){var e=_normalizeEncoding(t);if("string"!=typeof e&&(Buffer.isEncoding===isEncoding||!isEncoding(t)))throw new Error("Unknown encoding: "+t);return e||t}function StringDecoder(t){this.encoding=normalizeEncoding(t);var e;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,e=4;break;case"utf8":this.fillLast=utf8FillLast,e=4;break;case"base64":this.text=base64Text,this.end=base64End,e=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(e)}function utf8CheckByte(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function utf8CheckIncomplete(t,e,s){var i=e.length-1;if(i<s)return 0;var n=utf8CheckByte(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(t.lastNeed=n-2),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0}function utf8CheckExtraBytes(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}function utf8FillLast(t){var e=this.lastTotal-this.lastNeed,s=utf8CheckExtraBytes(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function utf8Text(t,e){var s=utf8CheckIncomplete(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function utf8End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function utf16Text(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function utf16End(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function base64Text(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function base64End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function simpleWrite(t){return t.toString(this.encoding)}function simpleEnd(t){return t&&t.length?this.write(t):""}var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};

},{"safe-buffer":359}],355:[function(require,module,exports){
module.exports=require("./readable").PassThrough;

},{"./readable":356}],356:[function(require,module,exports){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");

},{"./lib/_stream_duplex.js":345,"./lib/_stream_passthrough.js":346,"./lib/_stream_readable.js":347,"./lib/_stream_transform.js":348,"./lib/_stream_writable.js":349}],357:[function(require,module,exports){
module.exports=require("./readable").Transform;

},{"./readable":356}],358:[function(require,module,exports){
module.exports=require("./lib/_stream_writable.js");

},{"./lib/_stream_writable.js":349}],359:[function(require,module,exports){
function copyProps(f,r){for(var e in f)r[e]=f[e]}function SafeBuffer(f,r,e){return Buffer(f,r,e)}var buffer=require("buffer"),Buffer=buffer.Buffer;Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(f,r,e){if("number"==typeof f)throw new TypeError("Argument must not be a number");return Buffer(f,r,e)},SafeBuffer.alloc=function(f,r,e){if("number"!=typeof f)throw new TypeError("Argument must be a number");var u=Buffer(f);return void 0!==r?"string"==typeof e?u.fill(r,e):u.fill(r):u.fill(0),u},SafeBuffer.allocUnsafe=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return Buffer(f)},SafeBuffer.allocUnsafeSlow=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(f)};

},{"buffer":318}],360:[function(require,module,exports){
function Stream(){EE.call(this)}module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(e,r){function t(r){e.writable&&!1===e.write(r)&&m.pause&&m.pause()}function n(){m.readable&&m.resume&&m.resume()}function a(){u||(u=!0,e.end())}function o(){u||(u=!0,"function"==typeof e.destroy&&e.destroy())}function i(e){if(s(),0===EE.listenerCount(this,"error"))throw e}function s(){m.removeListener("data",t),e.removeListener("drain",n),m.removeListener("end",a),m.removeListener("close",o),m.removeListener("error",i),e.removeListener("error",i),m.removeListener("end",s),m.removeListener("close",s),e.removeListener("close",s)}var m=this;m.on("data",t),e.on("drain",n),e._isStdio||r&&!1===r.end||(m.on("end",a),m.on("close",o));var u=!1;return m.on("error",i),e.on("error",i),m.on("end",s),m.on("close",s),e.on("close",s),e.emit("pipe",m),e};

},{"events":321,"inherits":324,"readable-stream/duplex.js":344,"readable-stream/passthrough.js":355,"readable-stream/readable.js":356,"readable-stream/transform.js":357,"readable-stream/writable.js":358}],361:[function(require,module,exports){
(function(){function n(n){return function(r,t,e,u){t=b(t,u,4);var i=!k(r)&&m.keys(r),o=(i||r).length,a=n>0?0:o-1;return arguments.length<3&&(e=r[i?i[a]:a],a+=n),function(r,t,e,u,i,o){for(;i>=0&&i<o;i+=n){var a=u?u[i]:i;e=t(e,r[a],a,r)}return e}(r,t,e,i,a,o)}}function r(n){return function(r,t,e){t=x(t,e);for(var u=O(r),i=n>0?0:u-1;i>=0&&i<u;i+=n)if(t(r[i],i,r))return i;return-1}}function t(n,r,t){return function(e,u,i){var o=0,a=O(e);if("number"==typeof i)n>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(t&&i&&a)return i=t(e,u),e[i]===u?i:-1;if(u!=u)return(i=r(l.call(e,o,a),m.isNaN))>=0?i+o:-1;for(i=n>0?o:a-1;i>=0&&i<a;i+=n)if(e[i]===u)return i;return-1}}function e(n,r){var t=I.length,e=n.constructor,u=m.isFunction(e)&&e.prototype||a,i="constructor";for(m.has(n,i)&&!m.contains(r,i)&&r.push(i);t--;)(i=I[t])in n&&n[i]!==u[i]&&!m.contains(r,i)&&r.push(i)}var u=this,i=u._,o=Array.prototype,a=Object.prototype,c=Function.prototype,f=o.push,l=o.slice,s=a.toString,p=a.hasOwnProperty,h=Array.isArray,v=Object.keys,y=c.bind,d=Object.create,g=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):u._=m,m.VERSION="1.8.3";var b=function(n,r,t){if(void 0===r)return n;switch(null==t?3:t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,e){return n.call(r,t,e)};case 3:return function(t,e,u){return n.call(r,t,e,u)};case 4:return function(t,e,u,i){return n.call(r,t,e,u,i)}}return function(){return n.apply(r,arguments)}},x=function(n,r,t){return null==n?m.identity:m.isFunction(n)?b(n,r,t):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,r){return x(n,r,1/0)};var _=function(n,r){return function(t){var e=arguments.length;if(e<2||null==t)return t;for(var u=1;u<e;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;c<a;c++){var f=o[c];r&&void 0!==t[f]||(t[f]=i[f])}return t}},j=function(n){if(!m.isObject(n))return{};if(d)return d(n);g.prototype=n;var r=new g;return g.prototype=null,r},w=function(n){return function(r){return null==r?void 0:r[n]}},A=Math.pow(2,53)-1,O=w("length"),k=function(n){var r=O(n);return"number"==typeof r&&r>=0&&r<=A};m.each=m.forEach=function(n,r,t){r=b(r,t);var e,u;if(k(n))for(e=0,u=n.length;e<u;e++)r(n[e],e,n);else{var i=m.keys(n);for(e=0,u=i.length;e<u;e++)r(n[i[e]],i[e],n)}return n},m.map=m.collect=function(n,r,t){r=x(r,t);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=Array(u),o=0;o<u;o++){var a=e?e[o]:o;i[o]=r(n[a],a,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,r,t){var e;if(void 0!==(e=k(n)?m.findIndex(n,r,t):m.findKey(n,r,t))&&-1!==e)return n[e]},m.filter=m.select=function(n,r,t){var e=[];return r=x(r,t),m.each(n,function(n,t,u){r(n,t,u)&&e.push(n)}),e},m.reject=function(n,r,t){return m.filter(n,m.negate(x(r)),t)},m.every=m.all=function(n,r,t){r=x(r,t);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;i<u;i++){var o=e?e[i]:i;if(!r(n[o],o,n))return!1}return!0},m.some=m.any=function(n,r,t){r=x(r,t);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;i<u;i++){var o=e?e[i]:i;if(r(n[o],o,n))return!0}return!1},m.contains=m.includes=m.include=function(n,r,t,e){return k(n)||(n=m.values(n)),("number"!=typeof t||e)&&(t=0),m.indexOf(n,r,t)>=0},m.invoke=function(n,r){var t=l.call(arguments,2),e=m.isFunction(r);return m.map(n,function(n){var u=e?r:n[r];return null==u?u:u.apply(n,t)})},m.pluck=function(n,r){return m.map(n,m.property(r))},m.where=function(n,r){return m.filter(n,m.matcher(r))},m.findWhere=function(n,r){return m.find(n,m.matcher(r))},m.max=function(n,r,t){var e,u,i=-1/0,o=-1/0;if(null==r&&null!=n)for(var a=0,c=(n=k(n)?n:m.values(n)).length;a<c;a++)(e=n[a])>i&&(i=e);else r=x(r,t),m.each(n,function(n,t,e){((u=r(n,t,e))>o||u===-1/0&&i===-1/0)&&(i=n,o=u)});return i},m.min=function(n,r,t){var e,u,i=1/0,o=1/0;if(null==r&&null!=n)for(var a=0,c=(n=k(n)?n:m.values(n)).length;a<c;a++)(e=n[a])<i&&(i=e);else r=x(r,t),m.each(n,function(n,t,e){((u=r(n,t,e))<o||u===1/0&&i===1/0)&&(i=n,o=u)});return i},m.shuffle=function(n){for(var r,t=k(n)?n:m.values(n),e=t.length,u=Array(e),i=0;i<e;i++)(r=m.random(0,i))!==i&&(u[i]=u[r]),u[r]=t[i];return u},m.sample=function(n,r,t){return null==r||t?(k(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,r))},m.sortBy=function(n,r,t){return r=x(r,t),m.pluck(m.map(n,function(n,t,e){return{value:n,index:t,criteria:r(n,t,e)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")};var F=function(n){return function(r,t,e){var u={};return t=x(t,e),m.each(r,function(e,i){var o=t(e,i,r);n(u,e,o)}),u}};m.groupBy=F(function(n,r,t){m.has(n,t)?n[t].push(r):n[t]=[r]}),m.indexBy=F(function(n,r,t){n[t]=r}),m.countBy=F(function(n,r,t){m.has(n,t)?n[t]++:n[t]=1}),m.toArray=function(n){return n?m.isArray(n)?l.call(n):k(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:k(n)?n.length:m.keys(n).length},m.partition=function(n,r,t){r=x(r,t);var e=[],u=[];return m.each(n,function(n,t,i){(r(n,t,i)?e:u).push(n)}),[e,u]},m.first=m.head=m.take=function(n,r,t){if(null!=n)return null==r||t?n[0]:m.initial(n,n.length-r)},m.initial=function(n,r,t){return l.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))},m.last=function(n,r,t){if(null!=n)return null==r||t?n[n.length-1]:m.rest(n,Math.max(0,n.length-r))},m.rest=m.tail=m.drop=function(n,r,t){return l.call(n,null==r||t?1:r)},m.compact=function(n){return m.filter(n,m.identity)};var S=function(n,r,t,e){for(var u=[],i=0,o=e||0,a=O(n);o<a;o++){var c=n[o];if(k(c)&&(m.isArray(c)||m.isArguments(c))){r||(c=S(c,r,t));var f=0,l=c.length;for(u.length+=l;f<l;)u[i++]=c[f++]}else t||(u[i++]=c)}return u};m.flatten=function(n,r){return S(n,r,!1)},m.without=function(n){return m.difference(n,l.call(arguments,1))},m.uniq=m.unique=function(n,r,t,e){m.isBoolean(r)||(e=t,t=r,r=!1),null!=t&&(t=x(t,e));for(var u=[],i=[],o=0,a=O(n);o<a;o++){var c=n[o],f=t?t(c,o,n):c;r?(o&&i===f||u.push(c),i=f):t?m.contains(i,f)||(i.push(f),u.push(c)):m.contains(u,c)||u.push(c)}return u},m.union=function(){return m.uniq(S(arguments,!0,!0))},m.intersection=function(n){for(var r=[],t=arguments.length,e=0,u=O(n);e<u;e++){var i=n[e];if(!m.contains(r,i)){for(var o=1;o<t&&m.contains(arguments[o],i);o++);o===t&&r.push(i)}}return r},m.difference=function(n){var r=S(arguments,!0,!0,1);return m.filter(n,function(n){return!m.contains(r,n)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var r=n&&m.max(n,O).length||0,t=Array(r),e=0;e<r;e++)t[e]=m.pluck(n,e);return t},m.object=function(n,r){for(var t={},e=0,u=O(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t},m.findIndex=r(1),m.findLastIndex=r(-1),m.sortedIndex=function(n,r,t,e){for(var u=(t=x(t,e,1))(r),i=0,o=O(n);i<o;){var a=Math.floor((i+o)/2);t(n[a])<u?i=a+1:o=a}return i},m.indexOf=t(1,m.findIndex,m.sortedIndex),m.lastIndexOf=t(-1,m.findLastIndex),m.range=function(n,r,t){null==r&&(r=n||0,n=0),t=t||1;for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),i=0;i<e;i++,n+=t)u[i]=n;return u};var E=function(n,r,t,e,u){if(!(e instanceof r))return n.apply(t,u);var i=j(n.prototype),o=n.apply(i,u);return m.isObject(o)?o:i};m.bind=function(n,r){if(y&&n.bind===y)return y.apply(n,l.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var t=l.call(arguments,2),e=function(){return E(n,e,r,this,t.concat(l.call(arguments)))};return e},m.partial=function(n){var r=l.call(arguments,1),t=function(){for(var e=0,u=r.length,i=Array(u),o=0;o<u;o++)i[o]=r[o]===m?arguments[e++]:r[o];for(;e<arguments.length;)i.push(arguments[e++]);return E(n,t,this,this,i)};return t},m.bindAll=function(n){var r,t,e=arguments.length;if(e<=1)throw new Error("bindAll must be passed function names");for(r=1;r<e;r++)n[t=arguments[r]]=m.bind(n[t],n);return n},m.memoize=function(n,r){var t=function(e){var u=t.cache,i=""+(r?r.apply(this,arguments):e);return m.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return t.cache={},t},m.delay=function(n,r){var t=l.call(arguments,2);return setTimeout(function(){return n.apply(null,t)},r)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,r,t){var e,u,i,o=null,a=0;t||(t={});var c=function(){a=!1===t.leading?0:m.now(),o=null,i=n.apply(e,u),o||(e=u=null)};return function(){var f=m.now();a||!1!==t.leading||(a=f);var l=r-(f-a);return e=this,u=arguments,l<=0||l>r?(o&&(clearTimeout(o),o=null),a=f,i=n.apply(e,u),o||(e=u=null)):o||!1===t.trailing||(o=setTimeout(c,l)),i}},m.debounce=function(n,r,t){var e,u,i,o,a,c=function(){var f=m.now()-o;f<r&&f>=0?e=setTimeout(c,r-f):(e=null,t||(a=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,o=m.now();var f=t&&!e;return e||(e=setTimeout(c,r)),f&&(a=n.apply(i,u),i=u=null),a}},m.wrap=function(n,r){return m.partial(r,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},m.after=function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},m.before=function(n,r){var t;return function(){return--n>0&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}},m.once=m.partial(m.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(v)return v(n);var r=[];for(var t in n)m.has(n,t)&&r.push(t);return M&&e(n,r),r},m.allKeys=function(n){if(!m.isObject(n))return[];var r=[];for(var t in n)r.push(t);return M&&e(n,r),r},m.values=function(n){for(var r=m.keys(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e},m.mapObject=function(n,r,t){r=x(r,t);for(var e,u=m.keys(n),i=u.length,o={},a=0;a<i;a++)o[e=u[a]]=r(n[e],e,n);return o},m.pairs=function(n){for(var r=m.keys(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e},m.invert=function(n){for(var r={},t=m.keys(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r},m.functions=m.methods=function(n){var r=[];for(var t in n)m.isFunction(n[t])&&r.push(t);return r.sort()},m.extend=_(m.allKeys),m.extendOwn=m.assign=_(m.keys),m.findKey=function(n,r,t){r=x(r,t);for(var e,u=m.keys(n),i=0,o=u.length;i<o;i++)if(e=u[i],r(n[e],e,n))return e},m.pick=function(n,r,t){var e,u,i={},o=n;if(null==o)return i;m.isFunction(r)?(u=m.allKeys(o),e=b(r,t)):(u=S(arguments,!1,!1,1),e=function(n,r,t){return r in t},o=Object(o));for(var a=0,c=u.length;a<c;a++){var f=u[a],l=o[f];e(l,f,o)&&(i[f]=l)}return i},m.omit=function(n,r,t){if(m.isFunction(r))r=m.negate(r);else{var e=m.map(S(arguments,!1,!1,1),String);r=function(n,r){return!m.contains(e,r)}}return m.pick(n,r,t)},m.defaults=_(m.allKeys,!0),m.create=function(n,r){var t=j(n);return r&&m.extendOwn(t,r),t},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,r){return r(n),n},m.isMatch=function(n,r){var t=m.keys(r),e=t.length;if(null==n)return!e;for(var u=Object(n),i=0;i<e;i++){var o=t[i];if(r[o]!==u[o]||!(o in u))return!1}return!0};var N=function(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return n===r;n instanceof m&&(n=n._wrapped),r instanceof m&&(r=r._wrapped);var u=s.call(n);if(u!==s.call(r))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+r;case"[object Number]":return+n!=+n?+r!=+r:0==+n?1/+n==1/r:+n==+r;case"[object Date]":case"[object Boolean]":return+n==+r}var i="[object Array]"===u;if(!i){if("object"!=typeof n||"object"!=typeof r)return!1;var o=n.constructor,a=r.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in r)return!1}t=t||[],e=e||[];for(var c=t.length;c--;)if(t[c]===n)return e[c]===r;if(t.push(n),e.push(r),i){if((c=n.length)!==r.length)return!1;for(;c--;)if(!N(n[c],r[c],t,e))return!1}else{var f,l=m.keys(n);if(c=l.length,m.keys(r).length!==c)return!1;for(;c--;)if(f=l[c],!m.has(r,f)||!N(n[f],r[f],t,e))return!1}return t.pop(),e.pop(),!0};m.isEqual=function(n,r){return N(n,r)},m.isEmpty=function(n){return null==n||(k(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length)},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=h||function(n){return"[object Array]"===s.call(n)},m.isObject=function(n){var r=typeof n;return"function"===r||"object"===r&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(n){m["is"+n]=function(r){return s.call(r)==="[object "+n+"]"}}),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===s.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return void 0===n},m.has=function(n,r){return null!=n&&p.call(n,r)},m.noConflict=function(){return u._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=w,m.propertyOf=function(n){return null==n?function(){}:function(r){return n[r]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(r){return m.isMatch(r,n)}},m.times=function(n,r,t){var e=Array(Math.max(0,n));r=b(r,t,1);for(var u=0;u<n;u++)e[u]=r(u);return e},m.random=function(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=m.invert(B),R=function(n){var r=function(r){return n[r]},t="(?:"+m.keys(n).join("|")+")",e=RegExp(t),u=RegExp(t,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,r):n}};m.escape=R(B),m.unescape=R(T),m.result=function(n,r,t){var e=null==n?void 0:n[r];return void 0===e&&(e=t),m.isFunction(e)?e.call(n):e};var q=0;m.uniqueId=function(n){var r=++q+"";return n?n+r:r},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,L=function(n){return"\\"+z[n]};m.template=function(n,r,t){!r&&t&&(r=t),r=m.defaults({},r,m.templateSettings);var e=RegExp([(r.escape||K).source,(r.interpolate||K).source,(r.evaluate||K).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(r,t,e,o,a){return i+=n.slice(u,a).replace(D,L),u=a+r.length,t?i+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),r}),i+="';\n",r.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(r.variable||"obj","_",i)}catch(n){throw n.source=i,n}var a=function(n){return o.call(this,n,m)},c=r.variable||"obj";return a.source="function("+c+"){\n"+i+"}",a},m.chain=function(n){var r=m(n);return r._chain=!0,r};var P=function(n,r){return n._chain?m(r).chain():r};m.mixin=function(n){m.each(m.functions(n),function(r){var t=m[r]=n[r];m.prototype[r]=function(){var n=[this._wrapped];return f.apply(n,arguments),P(this,t.apply(m,n))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var r=o[n];m.prototype[n]=function(){var t=this._wrapped;return r.apply(t,arguments),"shift"!==n&&"splice"!==n||0!==t.length||delete t[0],P(this,t)}}),m.each(["concat","join","slice"],function(n){var r=o[n];m.prototype[n]=function(){return P(this,r.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);

},{}],362:[function(require,module,exports){
(function (global){
!function(r){function e(r){for(var e,t,n=[],o=0,i=r.length;o<i;)(e=r.charCodeAt(o++))>=55296&&e<=56319&&o<i?56320==(64512&(t=r.charCodeAt(o++)))?n.push(((1023&e)<<10)+(1023&t)+65536):(n.push(e),o--):n.push(e);return n}function t(r){if(r>=55296&&r<=57343)throw Error("Lone surrogate U+"+r.toString(16).toUpperCase()+" is not a scalar value")}function n(r,e){return v(r>>e&63|128)}function o(r){if(0==(4294967168&r))return v(r);var e="";return 0==(4294965248&r)?e=v(r>>6&31|192):0==(4294901760&r)?(t(r),e=v(r>>12&15|224),e+=n(r,6)):0==(4292870144&r)&&(e=v(r>>18&7|240),e+=n(r,12),e+=n(r,6)),e+=v(63&r|128)}function i(){if(h>=c)throw Error("Invalid byte index");var r=255&l[h];if(h++,128==(192&r))return 63&r;throw Error("Invalid continuation byte")}function f(){var r,e,n,o;if(h>c)throw Error("Invalid byte index");if(h==c)return!1;if(r=255&l[h],h++,0==(128&r))return r;if(192==(224&r)){var f;if((o=(31&r)<<6|(f=i()))>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&r)){if(f=i(),e=i(),(o=(15&r)<<12|f<<6|e)>=2048)return t(o),o;throw Error("Invalid continuation byte")}if(240==(248&r)&&(f=i(),e=i(),n=i(),(o=(15&r)<<18|f<<12|e<<6|n)>=65536&&o<=1114111))return o;throw Error("Invalid UTF-8 detected")}var u="object"==typeof exports&&exports,a="object"==typeof module&&module&&module.exports==u&&module,d="object"==typeof global&&global;d.global!==d&&d.window!==d||(r=d);var l,c,h,v=String.fromCharCode,s={version:"2.0.0",encode:function(r){for(var t=e(r),n=t.length,i=-1,f="";++i<n;)f+=o(t[i]);return f},decode:function(r){l=e(r),c=l.length,h=0;for(var t,n=[];!1!==(t=f());)n.push(t);return function(r){for(var e,t=r.length,n=-1,o="";++n<t;)(e=r[n])>65535&&(o+=v((e-=65536)>>>10&1023|55296),e=56320|1023&e),o+=v(e);return o}(n)}};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return s});else if(u&&!u.nodeType)if(a)a.exports=s;else{var p={}.hasOwnProperty;for(var b in s)p.call(s,b)&&(u[b]=s[b])}else r.utf8=s}(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],363:[function(require,module,exports){
(function (global){
function deprecate(r,e){if(config("noDeprecation"))return r;var o=!1;return function(){if(!o){if(config("throwDeprecation"))throw new Error(e);config("traceDeprecation")?console.trace(e):console.warn(e),o=!0}return r.apply(this,arguments)}}function config(r){try{if(!global.localStorage)return!1}catch(r){return!1}var e=global.localStorage[r];return null!=e&&"true"===String(e).toLowerCase()}module.exports=deprecate;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],364:[function(require,module,exports){
function bytesToUuid(e,t){var o=t||0,i=byteToHex;return i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]}for(var byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);module.exports=bytesToUuid;

},{}],365:[function(require,module,exports){
(function (global){
var rng,crypto=global.crypto||global.msCrypto;if(crypto&&crypto.getRandomValues){var rnds8=new Uint8Array(16);rng=function(){return crypto.getRandomValues(rnds8),rnds8}}if(!rng){var rnds=new Array(16);rng=function(){for(var r,n=0;n<16;n++)0==(3&n)&&(r=4294967296*Math.random()),rnds[n]=r>>>((3&n)<<3)&255;return rnds}}module.exports=rng;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],366:[function(require,module,exports){
function v1(e,s,t){var c=s&&t||0,d=s||[],o=void 0!==(e=e||{}).clockseq?e.clockseq:_clockseq,r=void 0!==e.msecs?e.msecs:(new Date).getTime(),_=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,a=r-_lastMSecs+(_-_lastNSecs)/1e4;if(a<0&&void 0===e.clockseq&&(o=o+1&16383),(a<0||r>_lastMSecs)&&void 0===e.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=r,_lastNSecs=_,_clockseq=o;var i=(1e4*(268435455&(r+=122192928e5))+_)%4294967296;d[c++]=i>>>24&255,d[c++]=i>>>16&255,d[c++]=i>>>8&255,d[c++]=255&i;var l=r/4294967296*1e4&268435455;d[c++]=l>>>8&255,d[c++]=255&l,d[c++]=l>>>24&15|16,d[c++]=l>>>16&255,d[c++]=o>>>8|128,d[c++]=255&o;for(var n=e.node||_nodeId,v=0;v<6;++v)d[c+v]=n[v];return s||bytesToUuid(d)}var rng=require("./lib/rng"),bytesToUuid=require("./lib/bytesToUuid"),_seedBytes=rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0;module.exports=v1;

},{"./lib/bytesToUuid":364,"./lib/rng":365}]},{},[2])

//# sourceMappingURL=aeontimeline_bundle.js.map
